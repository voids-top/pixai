import{j as e}from"./vendor-motion-Bl2lDopP.js";import{m as p,U as _,t as b,L as V,p as f,ce as A,al as C,dl as E,bc as B,dm as D,dn as T,v as z,bN as L}from"./index-JhqgbpkX.js";import{r as u}from"./vendor-apollo-B9XqHIAo.js";import{G as P,I as U}from"./vendor-photoswipe-UqzIRFho.js";import{L as R}from"./vendor-react-router-Bm0RsDwP.js";import{u as y}from"./vendor-i18next-TC5y0B3W.js";import{B as N,U as O,L as H,k as w,V as v,M as F,H as G,d as $}from"./vendor-mui-DTp04zm4.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};s.SENTRY_RELEASE={id:"0ec442be81a4ee21bfcf5745e8ef10bc76836958"}}catch{}})();try{(function(){var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new s.Error().stack;n&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[n]="31890c1b-8413-4e81-a21c-295ded46d90d",s._sentryDebugIdIdentifier="sentry-dbid-31890c1b-8413-4e81-a21c-295ded46d90d")})()}catch{}(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};s._sentryModuleMetadata=s._sentryModuleMetadata||{},s._sentryModuleMetadata[new s.Error().stack]=function(n){for(var i=1;i<arguments.length;i++){var t=arguments[i];if(t!=null)for(var o in t)t.hasOwnProperty(o)&&(n[o]=t[o])}return n}({},s._sentryModuleMetadata[new s.Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}catch{}})();const k=s=>e.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...s,children:e.jsx("path",{fill:"currentColor",d:"M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2h-4zM4 6h16v10H4V6z"})}),I=s=>e.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...s,children:e.jsx("path",{fill:"currentColor",d:"M17 1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14z"})}),q={"discord-icon":"_discord-icon_31qze_1"},ne=s=>{const{t:n}=y(["common","action","market"]),[i,t]=u.useState(!1),[o,x]=u.useState(!1),[l,a]=u.useState(""),[d,r]=u.useState(!1),[h,m]=u.useState(),g=e.jsxs(N,{variant:"outlined",className:"w-fit px-3 h-10 text-base font-bold rounded-2xl gap-2 border-2",onClick:async()=>{const c=document.createElement("a");c.href=l,c.download="pixai-snapshot.png",c.click(),p("poster_download_click",{value:d?"vertical":"horizontal",...s.trackingProps})},children:[d?e.jsx(I,{className:"size-6"}):e.jsx(k,{className:"size-6"}),n("market:model.download")]}),j=d?{width:782,height:3488}:{width:2284,height:1330},S=e.jsx(C,{open:i,onClose:()=>{t(!1)},dialogProps:{maxWidth:d?"sm":"lg",scroll:"body"},children:e.jsxs("div",{className:"flex flex-col justify-center items-center p-5 bg-background-light gap-4",children:[e.jsx(P,{children:e.jsx(U,{original:l,width:j.width,height:j.height,children:({ref:c,open:M})=>e.jsx("img",{className:"drop-shadow max-h-[75vh]",src:l,crossOrigin:"anonymous",ref:c,onClick:M})})}),g]})});return e.jsxs(e.Fragment,{children:[e.jsx(_,{busy:o,onPress:c=>{s.artworks.length>0&&(p("share_these_artworks_click",{...s.trackingProps}),m(c.target))},...s.btnProps}),e.jsx(Y,{anchorEl:h,setAnchorEl:m,onClose:c=>{p("poster_style_select",{value:c?"vertical":"horizontal",...s.trackingProps}),r(c),x(!0),b.loading(n("action:creating-snapshot"),{toastId:"snapshot"})}}),e.jsx(u.Suspense,{fallback:e.jsx(V,{}),children:e.jsx(K,{isVertical:d,artworks:s.artworks,snap:o,onSnapshot:c=>{x(!1),b.dismiss("snapshot"),c&&(a(c),t(!0))},title:s.title})}),S]})},J=s=>{const[n,i]=u.useState({}),t=async()=>{const a=s.artworks.map(async r=>{const h=L(r.media),m=await fetch(h).then(g=>g.blob());return{[r.id]:m}});return(await Promise.all(a)).reduce((r,h)=>({...r,...h}),{})},o=async()=>{try{const a=await t();i(a),setTimeout(()=>{s.loadingDone?.(!0)},200),console.log("fetchBlobmap success")}catch(a){console.log("fetchBlobmap error: ",a?.message),s.loadingDone?.(!1),b.error(`${a?.message}`)}};u.useEffect(()=>{o()},[s.artworks]);const x=(a,d,r,h,m)=>e.jsxs("div",{className:f("absolute bottom-0 bg-gradient-to-t from-black/70 to-black/0 w-full h-1/2 flex flex-col"),children:[e.jsx("div",{className:"grow"}),e.jsx("div",{className:"flex items-center gap-1.5 w-full relative px-6 pb-4",children:e.jsxs("div",{className:"flex flex-col text-white w-full",children:[e.jsxs("div",{className:"flex flex-row items-baseline gap-2",children:[e.jsx("div",{className:f("text-left opacity-80 font-extrabold text-7xl",a===0?"text-orange-400":""),children:a+1}),e.jsx(T,{artworkId:m?.id??"",initialCount:m?.likedCount,initialValue:!0,hideValueOnZero:!0,trackingArgs:{scene:"share-top-artworks"}})]}),e.jsx("div",{className:f("text-left truncate font-extrabold text-3xl"),children:d}),e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx("div",{className:"text-left w-auto truncate text-base font-bold grow",children:r||(h?$(h).format("lll"):"")}),e.jsx(z,{user:m?.author,style:{width:"40px",height:"40px",flexShrink:0}})]})]})})]}),l=e.jsxs("div",{className:"flex flex-col items-start w-fit flex-shrink-0 gap-1",children:[e.jsxs("div",{className:"flex flex-row gap-1",children:[e.jsx("div",{className:f(q["discord-icon"],"w-6 h-6 object-fill")}),e.jsx("div",{className:"text-base",children:"Search for"})]}),e.jsx("div",{className:"text-3xl font-extrabold ",children:"PixAI.Art"}),e.jsx("div",{children:"Join our community"})]});return e.jsxs("div",{className:f("flex flex-col gap-2 px-8 items-start w-full bg-background",s.isVertical?"pb-12 pt-36":"pb-10 pt-16"),children:[e.jsxs("div",{className:"items-start flex flex-col mt-5 py-2",children:[e.jsx("h1",{className:"block text-6xl font-extrabold relative",children:"PixAI.Art"}),e.jsx("h2",{className:"font-medium text-base leading-none uppercase tracking-widest opacity-60",children:"The AI Character Engine"})]}),e.jsxs("div",{className:"w-full py-4 flex flex-row justify-center items-bottom",children:[e.jsxs("div",{className:"w-full flex flex-col justify-center gap-2",children:[e.jsx("label",{className:"text-3xl font-extrabold",children:E()}),e.jsx("p",{className:"text-6xl font-extrabold",children:s.title})]}),e.jsx("div",{className:"grow"}),!s.isVertical&&l]}),e.jsx("div",{className:f("w-full grid content-start",s.isVertical?"grid-cols-2 gap-5":"grid-cols-6 gap-5"),children:s.artworks.map((a,d)=>{const{title:r,prompts:h,createdAt:m}=a||{},g=B(a?.author);return e.jsx("div",{className:"w-full aspect-[3/4] overflow-hidden relative bg-active group-focus-within:outline transition duration-500 group-hover:shadow-2xl",children:n[a.id]&&e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("img",{className:f("object-cover bg-top w-full h-full"),src:URL.createObjectURL(n[a.id])}),x(d,r?e.jsx("span",{title:r,children:r}):e.jsx("span",{title:h,children:h}),g??"",m,a),e.jsx("div",{className:f("absolute bottom-0 w-full h-full",d===0?"border-[10px] border-orange-400":"")})]})},a.id)})}),s.isVertical&&e.jsx("div",{className:"flex flex-col items-center justify-center w-full pt-10",children:l})]})};function K(s){const n=async()=>{const t=document.getElementById("snapshot");if(t)try{const o=await D(t);s.onSnapshot?.(o.toDataURL())}catch(o){b.error(`${o?.message}`),s.onSnapshot?.()}},i=e.jsx("div",{id:"snapshot",className:f(s.isVertical?"w-[782px]":"w-[2284px]"),children:e.jsx(J,{...s,isVertical:s.isVertical,loadingDone:t=>{t?n():s.onSnapshot?.()}})});return e.jsx("div",{style:{position:"absolute",left:-99999,top:-99999,pointerEvents:"none"},children:s.snap?i:null})}const W=s=>[{icon:e.jsx(k,{className:"size-6"}),name:s("common:horizontal-poster"),value:!1},{icon:e.jsx(I,{className:"size-6"}),name:s("common:vertical-poster"),value:!0}],Y=s=>{const{t:n}=y(["common","action"]),{anchorEl:i,setAnchorEl:t}=s,o=A(),x=W(n);return o?e.jsx(O,{anchor:"bottom",open:!!i,onClose:()=>t(void 0),elevation:4,children:e.jsxs(H,{className:"bg-background-secondary",children:[x.map(l=>e.jsx(w,{onClick:()=>{s.onClose(l.value),t(void 0)},children:e.jsx(v,{component:a=>e.jsx(N,{component:R,...a}),className:f("h-full text-base font-medium"),children:l.name})},l.name)),e.jsx(w,{children:e.jsx(v,{onClick:()=>t(void 0),children:n("action:cancel")})})]})}):e.jsx(F,{open:!!i,anchorEl:i,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},onClose:()=>t(void 0),disableScrollLock:!0,elevation:2,PaperProps:{className:"bg-background-secondary"},children:x.map(l=>e.jsx(G,{onClick:()=>{s.onClose(l.value),t(void 0)},className:f("h-10 text-primary"),children:e.jsxs("div",{className:"flex flex-row gap-2 justify-center items-center",children:[e.jsx("div",{className:"opacity-50",children:l.icon}),e.jsx("div",{children:l.name})]})},l.name))})};export{ne as S};
