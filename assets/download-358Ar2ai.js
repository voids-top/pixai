var Pr=Object.defineProperty;var Gr=(r,e,a)=>e in r?Pr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[e]=a;var Tr=(r,e,a)=>Gr(r,typeof e!="symbol"?e+"":e,a);import{b as Cr}from"./utils-CORjiwlf.js";import{c4 as br,ca as wr,jY as $r,i as re,b1 as Rr,a1 as ee}from"./index-BTMYyhc6.js";import{U as Hr}from"./unFile-B3RwQvIR.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[e]="61ba55f1-e36c-4df5-aea5-e53b26d1ad35",r._sentryDebugIdIdentifier="sentry-dbid-61ba55f1-e36c-4df5-aea5-e53b26d1ad35")}catch{}})();{var rr=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};rr._sentryModuleMetadata=rr._sentryModuleMetadata||{},rr._sentryModuleMetadata[new Error().stack]=Object.assign({},rr._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}var zr={},ae=function(r,e,a,n,f){var t=new Worker(zr[e]||(zr[e]=URL.createObjectURL(new Blob([r+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return t.onmessage=function(o){var i=o.data,v=i.$e$;if(v){var u=new Error(v[0]);u.code=v[1],u.stack=v[2],f(u,null)}else f(null,i)},t.postMessage(a,n),t},E=Uint8Array,L=Uint16Array,or=Int32Array,ir=new E([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vr=new E([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),hr=new E([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_r=function(r,e){for(var a=new L(31),n=0;n<31;++n)a[n]=e+=1<<r[n-1];for(var f=new or(a[30]),n=1;n<30;++n)for(var t=a[n];t<a[n+1];++t)f[t]=t-a[n]<<5|n;return{b:a,r:f}},qr=_r(ir,2),ne=qr.b,nr=qr.r;ne[28]=258,nr[258]=28;var te=_r(vr,0),gr=te.r,tr=new L(32768);for(var g=0;g<32768;++g){var N=(g&43690)>>1|(g&21845)<<1;N=(N&52428)>>2|(N&13107)<<2,N=(N&61680)>>4|(N&3855)<<4,tr[g]=((N&65280)>>8|(N&255)<<8)>>1}var X=function(r,e,a){for(var n=r.length,f=0,t=new L(e);f<n;++f)r[f]&&++t[r[f]-1];var o=new L(e);for(f=1;f<e;++f)o[f]=o[f-1]+t[f-1]<<1;var i;if(a){i=new L(1<<e);var v=15-e;for(f=0;f<n;++f)if(r[f])for(var u=f<<4|r[f],l=e-r[f],y=o[r[f]-1]++<<l,m=y|(1<<l)-1;y<=m;++y)i[tr[y]>>v]=u}else for(i=new L(n),f=0;f<n;++f)r[f]&&(i[f]=tr[o[r[f]-1]++]>>15-r[f]);return i},W=new E(288);for(var g=0;g<144;++g)W[g]=8;for(var g=144;g<256;++g)W[g]=9;for(var g=256;g<280;++g)W[g]=7;for(var g=280;g<288;++g)W[g]=8;var b=new E(32);for(var g=0;g<32;++g)b[g]=5;var Sr=X(W,9,0),Kr=X(b,5,0),Mr=function(r){return(r+7)/8|0},pr=function(r,e,a){return(e==null||e<0)&&(e=0),(a==null||a>r.length)&&(a=r.length),new E(r.subarray(e,a))},fe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],P=function(r,e,a){var n=new Error(e||fe[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,P),!a)throw n;return n},_=function(r,e,a){a<<=e&7;var n=e/8|0;r[n]|=a,r[n+1]|=a>>8},Q=function(r,e,a){a<<=e&7;var n=e/8|0;r[n]|=a,r[n+1]|=a>>8,r[n+2]|=a>>16},ar=function(r,e){for(var a=[],n=0;n<r.length;++n)r[n]&&a.push({s:n,f:r[n]});var f=a.length,t=a.slice();if(!f)return{t:kr,l:0};if(f==1){var o=new E(a[0].s+1);return o[a[0].s]=1,{t:o,l:1}}a.sort(function(k,O){return k.f-O.f}),a.push({s:-1,f:25001});var i=a[0],v=a[1],u=0,l=1,y=2;for(a[0]={s:-1,f:i.f+v.f,l:i,r:v};l!=f-1;)i=a[a[u].f<a[y].f?u++:y++],v=a[u!=l&&a[u].f<a[y].f?u++:y++],a[l++]={s:-1,f:i.f+v.f,l:i,r:v};for(var m=t[0].s,n=1;n<f;++n)t[n].s>m&&(m=t[n].s);var M=new L(m+1),T=fr(a[l-1],M,0);if(T>e){var n=0,x=0,h=T-e,Y=1<<h;for(t.sort(function(O,p){return M[p.s]-M[O.s]||O.f-p.f});n<f;++n){var B=t[n].s;if(M[B]>e)x+=Y-(1<<T-M[B]),M[B]=e;else break}for(x>>=h;x>0;){var F=t[n].s;M[F]<e?x-=1<<e-M[F]++-1:++n}for(;n>=0&&x;--n){var w=t[n].s;M[w]==e&&(--M[w],++x)}T=e}return{t:new E(M),l:T}},fr=function(r,e,a){return r.s==-1?Math.max(fr(r.l,e,a+1),fr(r.r,e,a+1)):e[r.s]=a},yr=function(r){for(var e=r.length;e&&!r[--e];);for(var a=new L(++e),n=0,f=r[0],t=1,o=function(v){a[n++]=v},i=1;i<=e;++i)if(r[i]==f&&i!=e)++t;else{if(!f&&t>2){for(;t>138;t-=138)o(32754);t>2&&(o(t>10?t-11<<5|28690:t-3<<5|12305),t=0)}else if(t>3){for(o(f),--t;t>6;t-=6)o(8304);t>2&&(o(t-3<<5|8208),t=0)}for(;t--;)o(f);t=1,f=r[i]}return{c:a.subarray(0,n),n:e}},V=function(r,e){for(var a=0,n=0;n<e.length;++n)a+=r[n]*e[n];return a},dr=function(r,e,a){var n=a.length,f=Mr(e+2);r[f]=n&255,r[f+1]=n>>8,r[f+2]=r[f]^255,r[f+3]=r[f+1]^255;for(var t=0;t<n;++t)r[f+t+4]=a[t];return(f+4+n)*8},mr=function(r,e,a,n,f,t,o,i,v,u,l){_(e,l++,a),++f[256];for(var y=ar(f,15),m=y.t,M=y.l,T=ar(t,15),x=T.t,h=T.l,Y=yr(m),B=Y.c,F=Y.n,w=yr(x),k=w.c,O=w.n,p=new L(19),c=0;c<B.length;++c)++p[B[c]&31];for(var c=0;c<k.length;++c)++p[k[c]&31];for(var s=ar(p,7),A=s.t,q=s.l,$=19;$>4&&!A[hr[$-1]];--$);var S=u+5<<3,U=V(f,W)+V(t,b)+o,z=V(f,m)+V(t,x)+o+14+3*$+V(p,A)+2*p[16]+3*p[17]+7*p[18];if(v>=0&&S<=U&&S<=z)return dr(e,l,r.subarray(v,v+u));var j,d,C,K;if(_(e,l,1+(z<U)),l+=2,z<U){j=X(m,M,0),d=m,C=X(x,h,0),K=x;var lr=X(A,q,0);_(e,l,F-257),_(e,l+5,O-1),_(e,l+10,$-4),l+=14;for(var c=0;c<$;++c)_(e,l+3*c,A[hr[c]]);l+=3*$;for(var R=[B,k],G=0;G<2;++G)for(var Z=R[G],c=0;c<Z.length;++c){var H=Z[c]&31;_(e,l,lr[H]),l+=A[H],H>15&&(_(e,l,Z[c]>>5&127),l+=Z[c]>>12)}}else j=Sr,d=W,C=Kr,K=b;for(var c=0;c<i;++c){var I=n[c];if(I>255){var H=I>>18&31;Q(e,l,j[H+257]),l+=d[H+257],H>7&&(_(e,l,I>>23&31),l+=ir[H]);var J=I&31;Q(e,l,C[J]),l+=K[J],J>3&&(Q(e,l,I>>5&8191),l+=vr[J])}else Q(e,l,j[I]),l+=d[I]}return Q(e,l,j[256]),l+d[256]},Nr=new or([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),kr=new E(0),Wr=function(r,e,a,n,f,t){var o=t.z||r.length,i=new E(n+o+5*(1+Math.ceil(o/7e3))+f),v=i.subarray(n,i.length-f),u=t.l,l=(t.r||0)&7;if(e){l&&(v[0]=t.r>>3);for(var y=Nr[e-1],m=y>>13,M=y&8191,T=(1<<a)-1,x=t.p||new L(32768),h=t.h||new L(T+1),Y=Math.ceil(a/3),B=2*Y,F=function(cr){return(r[cr]^r[cr+1]<<Y^r[cr+2]<<B)&T},w=new or(25e3),k=new L(288),O=new L(32),p=0,c=0,s=t.i||0,A=0,q=t.w||0,$=0;s+2<o;++s){var S=F(s),U=s&32767,z=h[S];if(x[U]=z,h[S]=U,q<=s){var j=o-s;if((p>7e3||A>24576)&&(j>423||!u)){l=mr(r,v,0,w,k,O,c,A,$,s-$,l),A=p=c=0,$=s;for(var d=0;d<286;++d)k[d]=0;for(var d=0;d<30;++d)O[d]=0}var C=2,K=0,lr=M,R=U-z&32767;if(j>2&&S==F(s-R))for(var G=Math.min(m,j)-1,Z=Math.min(32767,s),H=Math.min(258,j);R<=Z&&--lr&&U!=z;){if(r[s+C]==r[s+C-R]){for(var I=0;I<H&&r[s+I]==r[s+I-R];++I);if(I>C){if(C=I,K=R,I>G)break;for(var J=Math.min(R,I-2),Or=0,d=0;d<J;++d){var ur=s-R+d&32767,Xr=x[ur],Ur=ur-Xr&32767;Ur>Or&&(Or=Ur,z=ur)}}}U=z,z=x[U],R+=U-z&32767}if(K){w[A++]=268435456|nr[C]<<18|gr[K];var Dr=nr[C]&31,Er=gr[K]&31;c+=ir[Dr]+vr[Er],++k[257+Dr],++O[Er],q=s+C,++p}else w[A++]=r[s],++k[r[s]]}}for(s=Math.max(s,q);s<o;++s)w[A++]=r[s],++k[r[s]];l=mr(r,v,u,w,k,O,c,A,$,s-$,l),u||(t.r=l&7|v[l/8|0]<<3,l-=7,t.h=h,t.p=x,t.i=s,t.w=q)}else{for(var s=t.w||0;s<o+u;s+=65535){var sr=s+65535;sr>=o&&(v[l/8|0]=u,sr=o),l=dr(v,l+1,r.subarray(s,sr))}t.i=o}return pr(i,0,n+Mr(l)+f)},oe=function(){for(var r=new Int32Array(256),e=0;e<256;++e){for(var a=e,n=9;--n;)a=(a&1&&-306674912)^a>>>1;r[e]=a}return r}(),ie=function(){var r=-1;return{p:function(e){for(var a=r,n=0;n<e.length;++n)a=oe[a&255^e[n]]^a>>>8;r=a},d:function(){return~r}}},Zr=function(r,e,a,n,f){if(!f&&(f={l:1},e.dictionary)){var t=e.dictionary.subarray(-32768),o=new E(t.length+r.length);o.set(t),o.set(r,t.length),r=o,f.w=t.length}return Wr(r,e.level==null?6:e.level,e.mem==null?f.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,a,n,f)},Ar=function(r,e){var a={};for(var n in r)a[n]=r[n];for(var n in e)a[n]=e[n];return a},Ir=function(r,e,a){for(var n=r(),f=r.toString(),t=f.slice(f.indexOf("[")+1,f.lastIndexOf("]")).replace(/\s+/g,"").split(","),o=0;o<n.length;++o){var i=n[o],v=t[o];if(typeof i=="function"){e+=";"+v+"=";var u=i.toString();if(i.prototype)if(u.indexOf("[native code]")!=-1){var l=u.indexOf(" ",8)+1;e+=u.slice(l,u.indexOf("(",l))}else{e+=u;for(var y in i.prototype)e+=";"+v+".prototype."+y+"="+i.prototype[y].toString()}else e+=u}else a[v]=i}return e},er=[],ve=function(r){var e=[];for(var a in r)r[a].buffer&&e.push((r[a]=new r[a].constructor(r[a])).buffer);return e},le=function(r,e,a,n){if(!er[a]){for(var f="",t={},o=r.length-1,i=0;i<o;++i)f=Ir(r[i],f,t);er[a]={c:Ir(r[o],f,t),e:t}}var v=Ar({},er[a].e);return ae(er[a].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",a,v,ve(v),n)},ue=function(){return[E,L,or,ir,vr,hr,nr,gr,Sr,W,Kr,b,tr,Nr,kr,X,_,Q,ar,fr,yr,V,dr,mr,Mr,pr,Wr,Zr,Fr,Jr]},Jr=function(r){return postMessage(r,[r.buffer])},se=function(r,e,a,n,f,t){var o=le(a,n,f,function(i,v){o.terminate(),t(i,v)});return o.postMessage([r,e],e.consume?[r.buffer]:[]),function(){o.terminate()}},D=function(r,e,a){for(;a;++e)r[e]=a,a>>>=8};function ce(r,e,a){return a||(a=e,e={}),typeof a!="function"&&P(7),se(r,e,[ue],function(n){return Jr(Fr(n.data[0],n.data[1]))},0,a)}function Fr(r,e){return Zr(r,e||{},0,0)}var Qr=function(r,e,a,n){for(var f in r){var t=r[f],o=e+f,i=n;Array.isArray(t)&&(i=Ar(n,t[1]),t=t[0]),t instanceof E?a[o]=[t,i]:(a[o+="/"]=[new E(0),i],Qr(t,o,a,n))}},Yr=typeof TextEncoder<"u"&&new TextEncoder,we=typeof TextDecoder<"u"&&new TextDecoder,he=0;try{we.decode(kr,{stream:!0}),he=1}catch{}function Br(r,e){var a;if(Yr)return Yr.encode(r);for(var n=r.length,f=new E(r.length+(r.length>>1)),t=0,o=function(u){f[t++]=u},a=0;a<n;++a){if(t+5>f.length){var i=new E(t+8+(n-a<<1));i.set(f),f=i}var v=r.charCodeAt(a);v<128||e?o(v):v<2048?(o(192|v>>6),o(128|v&63)):v>55295&&v<57344?(v=65536+(v&1047552)|r.charCodeAt(++a)&1023,o(240|v>>18),o(128|v>>12&63),o(128|v>>6&63),o(128|v&63)):(o(224|v>>12),o(128|v>>6&63),o(128|v&63))}return pr(f,0,t)}var xr=function(r){var e=0;if(r)for(var a in r){var n=r[a].length;n>65535&&P(9),e+=n+4}return e},Lr=function(r,e,a,n,f,t,o,i){var v=n.length,u=a.extra,l=i&&i.length,y=xr(u);D(r,e,o!=null?33639248:67324752),e+=4,o!=null&&(r[e++]=20,r[e++]=a.os),r[e]=20,e+=2,r[e++]=a.flag<<1|(t<0&&8),r[e++]=f&&8,r[e++]=a.compression&255,r[e++]=a.compression>>8;var m=new Date(a.mtime==null?Date.now():a.mtime),M=m.getFullYear()-1980;if((M<0||M>119)&&P(10),D(r,e,M<<25|m.getMonth()+1<<21|m.getDate()<<16|m.getHours()<<11|m.getMinutes()<<5|m.getSeconds()>>1),e+=4,t!=-1&&(D(r,e,a.crc),D(r,e+4,t<0?-t-2:t),D(r,e+8,a.size)),D(r,e+12,v),D(r,e+14,y),e+=16,o!=null&&(D(r,e,l),D(r,e+6,a.attrs),D(r,e+10,o),e+=14),r.set(n,e),e+=v,y)for(var T in u){var x=u[T],h=x.length;D(r,e,+T),D(r,e+2,h),r.set(x,e+4),e+=4+h}return l&&(r.set(i,e),e+=l),e},ge=function(r,e,a,n,f){D(r,e,101010256),D(r,e+8,a),D(r,e+10,a),D(r,e+12,n),D(r,e+16,f)};function ye(r,e,a){a||(a=e,e={}),typeof a!="function"&&P(7);var n={};Qr(r,"",n,e);var f=Object.keys(n),t=f.length,o=0,i=0,v=t,u=new Array(t),l=[],y=function(){for(var h=0;h<l.length;++h)l[h]()},m=function(h,Y){jr(function(){a(h,Y)})};jr(function(){m=a});var M=function(){var h=new E(i+22),Y=o,B=i-o;i=0;for(var F=0;F<v;++F){var w=u[F];try{var k=w.c.length;Lr(h,i,w,w.f,w.u,k);var O=30+w.f.length+xr(w.extra),p=i+O;h.set(w.c,p),Lr(h,o,w,w.f,w.u,k,i,w.m),o+=16+O+(w.m?w.m.length:0),i=p+k}catch(c){return m(c,null)}}ge(h,o,u.length,B,Y),m(null,h)};t||M();for(var T=function(h){var Y=f[h],B=n[Y],F=B[0],w=B[1],k=ie(),O=F.length;k.p(F);var p=Br(Y),c=p.length,s=w.comment,A=s&&Br(s),q=A&&A.length,$=xr(w.extra),S=w.level==0?0:8,U=function(z,j){if(z)y(),m(z,null);else{var d=j.length;u[h]=Ar(w,{size:O,crc:k.d(),c:j,f:p,m:A,u:c!=Y.length||A&&s.length!=q,compression:S}),o+=30+c+$+d,i+=76+2*(c+$)+(q||0)+d,--t||M()}};if(c>65535&&U(P(11,0,1),null),!S)U(null,F);else if(O<16e4)try{U(null,Fr(F,w))}catch(z){U(z,null)}else l.push(ce(F,w,U))},x=0;x<v;++x)T(x);return y}var jr=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(r){r()};class me{constructor(){Tr(this,"files",[])}async prepareFile(e){return await br(e).with(wr.instanceOf(Uint8Array),a=>a).with(wr.instanceOf(ArrayBuffer),a=>new Uint8Array(a)).with(wr.instanceOf(Blob),a=>a.arrayBuffer().then(n=>new Uint8Array(n))).exhaustive()}file(e,a){return this.files.push([e,a]),this}async generateAsync(e){const a=await Promise.all(this.files.map(([f,t])=>this.prepareFile(t).then(o=>[f,o]))),n=await new Promise((f,t)=>{ye(Object.fromEntries(a),e??{},(o,i)=>{o?t(o):f(i)})});return new Blob([n])}}function xe(r,e){const a=typeof r=="string",n=document.createElement("a");n.href=a?r:URL.createObjectURL(r),n.download=e,n.click(),a||URL.revokeObjectURL(n.href)}async function Vr(r,e,a){const n=r.length,f=new me;for(const[t,o]of r.entries())f.file(o.name,await o.toFile()),a==null||a({progress:t+1,total:n});xe(await f.generateAsync({level:0}),e)}async function Ae(r,e){const a=ee(r.map(({id:n,media:f})=>{if(f)return Hr.fromMedia(f,`pixai-artwork_${n}.${Cr({media:f})}`)}));await Vr(a,`pixai-artworks_${Rr().format("YYYY-MM-DD-HH-mm-ss")}.zip`,e)}async function Fe(r,e){const a=$r(r),n=new Map;for(const t of a){const o=await re.getMedia({id:t}).then(i=>i.media);n.set(t,o)}const f=[];for(const t of r){const o=$r([t]);for(const[i,v]of o.entries()){const u=n.get(v);u&&f.push(Hr.fromMedia(u,`pixai-task_${t.id}${o.length>1?`_${i+1}`:""}.${Cr({media:u})}`))}}await Vr(f,`pixai-tasks_${Rr().format("YYYY-MM-DD-HH-mm-ss")}.zip`,e)}export{Fe as a,xe as b,Ae as d};
//# sourceMappingURL=download-358Ar2ai.js.map
