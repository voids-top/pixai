import{j as t,A as L,m as _}from"./vendor-motion-Bl2lDopP.js";import{r as s}from"./vendor-apollo-B9XqHIAo.js";import{gm as F,gn as d,e2 as k,go as G,gp as x,e1 as H,gq as W,gr as z,eS as K,m as p,p as y,gs as B,P as M,gt as $,e6 as A,T as I,gu as q,dE as N,gv as Q,eV as Y,b0 as J,b8 as X,b9 as Z}from"./index-JhqgbpkX.js";import{r as ee}from"./vendor-mui-DTp04zm4.js";import{G as te,I as ae}from"./vendor-photoswipe-UqzIRFho.js";import{p as h,$ as V,a1 as m}from"./vendor-firebase-BKQqa5bK.js";import{bb as j}from"./vendor-graphql-DeSYh9DC.js";import{u as ne}from"./vendor-i18next-TC5y0B3W.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"0ec442be81a4ee21bfcf5745e8ef10bc76836958"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new e.Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="aad425fa-2088-4fb6-a8fe-06bb8d14452a",e._sentryDebugIdIdentifier="sentry-dbid-aad425fa-2088-4fb6-a8fe-06bb8d14452a")})()}catch{}(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=function(a){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r!=null)for(var i in r)r.hasOwnProperty(i)&&(a[i]=r[i])}return a}({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}catch{}})();const re=Object.values(F).map(e=>e.code),ie=d({lang:z(re),text:k()}),R=W(ie),T=d({name:R}),b=d({media:k(),mediaType:G([x(h.Image),x(h.Video),x(h.VideoHls),x(h.VideoStream)])}),D=d({...T.entries,...b.entries}),oe=d({...T.entries,...b.entries,live:d({...b.entries})}),se=d({...T.entries,...b.entries,audio:d({description:H(k())})});function O(e){return V(e).with(m.Static,()=>D).with(m.Live,()=>oe).with(m.Audio,()=>se).otherwise(()=>D)}const ke=d({name:R});function Ne(e){return U(e).find(n=>n.rarity===j.Ssr||n.rarity===j.Sr||n.rarity===j.N)}function le(e,a){return a.find(n=>n.lang===e)?.text}function w(){const{i18n:e}=ne(),a=e.resolvedLanguage;return s.useCallback((n,r)=>le(r??a,n),[a])}function ce(e){const{ownedCollectionCards:a,totalCollectionCards:n,collectionCardSet:r}=e;return`${a.length} / ${n.length}`}function U(e){return Array.from(e).sort((n,r)=>(n.collectionCardSetOrder??999)-(r.collectionCardSetOrder??999))}function de(e){const a=w(),{collectionCard:n}=e,r=n.type,i=A(O(r),n.data);if(!i.success)return t.jsx("article",{className:"relative aspect-[3/5] bg-gray-50 dark:bg-gray-800 flex items-center justify-center",children:t.jsx("p",{className:"italic opacity-50 items-center",children:t.jsx(I,{i18nKey:"user:user-decoration.collection-card.invalid-card"})})});const o={name:a(i.output.name,"en"),...e.trackingArgs},l=V(r).with(m.Live,()=>t.jsx(me,{owned:e.owned,data:i.output,trackingArgs:o})).otherwise(()=>t.jsx(ue,{owned:e.owned,data:i.output,trackingArgs:o}));return t.jsxs("article",{className:"relative aspect-[3/5] bg-gray-50 dark:bg-gray-800",children:[l,e.showOverlay&&t.jsx(ge,{owned:e.owned,collectionCardData:i.output,rarity:e.collectionCard.rarity,className:"absolute bottom-0 w-full"})]})}function ue(e){const n=e.data.mediaType==="IMAGE"&&q(e.data.media),r=N(e.data.media),i={width:768,height:1280};return t.jsx("div",{className:y("relative",!e.owned&&"after:content-[''] after:absolute after:inset-0 after:bg-neutral-200/80 after:dark:bg-neutral-600/80 pointer-events-none"),children:n&&t.jsx(te,{children:t.jsx(ae,{original:n,width:i.width,height:i.height,children:({ref:c,open:o})=>t.jsx(P,{className:"",src:r,ref:c,onClick:l=>{p("collection_card_media_click",{type:m.Static,mediaType:e.data.mediaType,...e.trackingArgs}),o(l)}})})})})}function me(e){const{mediaType:a,media:n,live:r}=e.data,i={width:768,height:1280},o=a==="IMAGE"?N(n):void 0,l=Q(),u=s.useRef(null),g=s.useCallback(()=>{l&&u.current.playVideo()},[l]),C=s.useCallback(()=>{l&&u.current.stopVideo()},[l]),S=s.useCallback(f=>{(f.target instanceof HTMLVideoElement||f.target instanceof HTMLImageElement)&&u.current.playVideo({fullscreen:!0})},[l]);return t.jsxs("div",{className:y("relative",!e.owned&&"after:content-[''] after:absolute after:inset-0 after:bg-neutral-200/80 after:dark:bg-neutral-600/80 pointer-events-none"),onMouseEnter:g,onMouseLeave:C,onClick:S,children:[o&&t.jsx(P,{src:o,height:i.height,width:i.width}),t.jsx(ye,{ref:u,className:"absolute inset-0 aspect-[3/5] object-cover",mediaSpec:r.media,mediaType:r.mediaType,trackingArgs:e.trackingArgs})]})}const E=K({slots:{wrapper:"px-2 py-4 min-h-[5em] backdrop-blur bg-neutral-100/70 dark:bg-neutral-800/70 content-center",text:"text-sm text-center font-medium"},variants:{owned:{true:{},false:{text:"text-black/20 dark:text-white/20"}},rarity:{N:{},SR:{text:"text-violet-600 dark:text-violet-300"},SSR:{text:"text-orange-700 dark:text-orange-300"}}}});function ge(e){const a=w();return t.jsx("footer",{className:E({owned:e.owned,rarity:e.rarity}).wrapper({className:e.className}),children:t.jsx("h3",{className:E({owned:e.owned,rarity:e.rarity}).text(),children:a(e.collectionCardData.name)})})}function Te(e){const a=e.collectionCard,n=A(O(a?.type),a?.data);if(!n.success)return null;const r=N(n.output.media);return t.jsx(P,{src:r,wrapperProps:{className:"aspect-[3/5]"}})}const fe="max-w-full max-h-screen object-contain",ye=s.forwardRef(function(a,n){const[r,i]=s.useState(!1),[c,o]=s.useState(!1),[l,u]=s.useState(!1),g=s.useCallback(v=>{u(v)},[]),C=l;s.useImperativeHandle(n,()=>({playVideo:v=>{o(!0),v?.fullscreen&&(p("collection_card_media_click",{type:m.Live,mediaType:a.mediaType,...a.trackingArgs}),i(!0))},stopVideo:()=>{o(!1),i(!1),g(!1)}}));const S=s.useCallback(()=>{p("collection_card_live_play",{fullscreen:r,...a.trackingArgs}),g(!1)},[r]),f=!c||!a.mediaSpec?null:a.mediaType==="IMAGE"?t.jsx("img",{className:y(a.className),src:a.mediaSpec}):t.jsx(B,{mediaType:a.mediaType,mediaSpec:a.mediaSpec,className:r?fe:a.className,commonProps:{onCanPlay:S,onLoadStart:()=>g(!0)}});return t.jsxs(t.Fragment,{children:[r?t.jsx(Ce,{onClose:()=>{u(!1),o(!1),i(!1)},videoContent:f,showPreloader:C}):t.jsx(t.Fragment,{children:f}),t.jsx(L,{children:C?t.jsx(_.div,{className:"absolute inset-0 bg-white/40 flex justify-center items-center",initial:{opacity:0},animate:{opacity:1,transition:{delay:.2,duration:.5,ease:"easeOut"}},exit:{opacity:0,transition:{duration:.5,ease:"easeIn"}},children:t.jsx(M,{})}):null})]})});function Ce(e){return ee.createPortal(t.jsxs("div",{className:"left-0 top-0 fixed w-full h-full z-[100000] grid place-content-center bg-black/80 isolate",tabIndex:-1,role:"dialog",onClick:()=>e.onClose(),children:[e.videoContent,t.jsx(L,{children:e.showPreloader?t.jsx(_.div,{className:"absolute inset-0 flex justify-center items-center",initial:{opacity:0},animate:{opacity:1,transition:{delay:.2,duration:.5,ease:"easeOut"}},exit:{opacity:0,transition:{duration:.5,ease:"easeIn"}},children:t.jsx(M,{dark:!0})}):null}),t.jsx("div",{className:"p-3 absolute top-0 right-0 flex items-center gap-4 text-white",children:t.jsx("button",{onClick:()=>e.onClose(),children:t.jsx($,{"aria-hidden":"true",className:"size-8"})})})]}),document.body)}const P=s.forwardRef(function({className:a,wrapperProps:n,...r},i){const[c,o]=s.useState(!0);return t.jsx("div",{...n,className:y("relative isolate bg-skeleton",n?.className),children:t.jsx("img",{...r,className:y(c?"opacity-0":""),onLoadStart:()=>o(!0),onLoad:()=>o(!1),ref:i})})});function Pe(e){const{collectionCardSetProgress:a,collectionCardSetData:n}=e,r=w(),i=ce(e.collectionCardSetProgress),c=Y(),o=s.useRef(c);return o.current=c,s.useEffect(()=>{e.open&&o.current({scene:"collection-card",modal:!0,section:r(e.collectionCardSetData.name,"en")})},[e.open]),t.jsxs(J,{dismissable:!0,open:e.open,onClose:e.onClose,className:"max-w-[900px] w-screen",children:[t.jsx(X,{heading:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{children:r(n.name)}),t.jsxs("span",{className:"text-neutral-500 dark:text-neutral-300 text-sm",children:[t.jsx(I,{i18nKey:"user:user-decoration.collection-card.card-set.progress"}),t.jsx(I,{i18nKey:"common:punctuations.colon"})," ",i]})]})}),t.jsx(Z,{children:t.jsx(xe,{collectionCardSetProgress:a,collectionCardSetData:n})})]})}function xe(e){const{collectionCardSetProgress:a}=e,{totalCollectionCards:n,ownedCollectionCards:r}=a,i=U(n),c=w();return t.jsx("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(160px,1fr))] gap-x-6 gap-y-8",children:i.map(o=>t.jsx(de,{collectionCard:o,owned:r.some(l=>l.id===o.id),showOverlay:!0,trackingArgs:{cardSetName:c(e.collectionCardSetData.name,"en")}},o.id))})}export{ke as C,Te as a,Pe as b,ce as c,de as d,Ne as g,w as u};
