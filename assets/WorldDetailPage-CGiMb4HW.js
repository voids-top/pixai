import{j as e}from"./vendor-motion-Bl2lDopP.js";import{cU as b,cV as j,cW as k,aP as v,cX as N,aj as c,cY as P,ce as C,ag as W,cM as f,cN as T,cO as I,cP as A,w as M,aG as E,cZ as g,c_ as Y,c1 as L,b7 as _,ak as x,c$ as B,d0 as F,P as G}from"./index-JhqgbpkX.js";import{r as p}from"./vendor-apollo-B9XqHIAo.js";import{m as H,W as S}from"./WorldFollowButton-BYKmQ9zF.js";import{C as z}from"./CharacterList-Djcy-68i.js";import{B as R,H as a}from"./vendor-mui-DTp04zm4.js";import{u as O}from"./vendor-i18next-TC5y0B3W.js";import{c as Q}from"./vendor-react-router-Bm0RsDwP.js";import"./vendor-amplitude-core-CQMkGYFj.js";import"./vendor-firebase-BKQqa5bK.js";import"./vendor-axios-CFwfAwt2.js";import"./vendor-lodash-992l3ZN7.js";import"./vendor-graphql-DeSYh9DC.js";import"./vendor-sentry-BZZLy1DV.js";import"./vendor-react-aria-BW9JtD2p.js";import"./vendor-markdown-1uD3znr6.js";import"./i18n-resources-43uzMSBc.js";import"./vendor-hls-cbDBXQj9.js";import"./vendor-tldraw-CaaMemrL.js";import"./vendor-fabric-Bg02ktlP.js";import"./vendor-radix-ui-DX5JiNHB.js";import"./vendor-photoswipe-UqzIRFho.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"0ec442be81a4ee21bfcf5745e8ef10bc76836958"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new t.Error().stack;n&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[n]="1face3c5-7150-4fe1-94d0-205c5906f120",t._sentryDebugIdIdentifier="sentry-dbid-1face3c5-7150-4fe1-94d0-205c5906f120")})()}catch{}(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t._sentryModuleMetadata=t._sentryModuleMetadata||{},t._sentryModuleMetadata[new t.Error().stack]=function(n){for(var s=1;s<arguments.length;s++){var i=arguments[s];if(i!=null)for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])}return n}({},t._sentryModuleMetadata[new t.Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}catch{}})();function U({world:t}){const n=()=>{k(t)},s=()=>{const r=v({children:e.jsx(N,{world:t,onSubmit:async l=>{await c.upsertWorld({id:t.id,input:l}),r.current?.close()}}),fullWidth:!0,maxWidth:"lg",onClose:()=>{r.current?.close()}})},i=()=>{P(async()=>{await c.deleteWorld({id:t.id})},e.jsxs("div",{children:[e.jsx("div",{className:"py-4",children:"Are you sure to delete this world?"}),t.name]}))},o=async()=>{const r=await c.upsertCharacter({input:{name:[{lang:"en",text:"Test"}],description:[{lang:"en",text:`In Liyue, most citizens yearn for the lifestyle of Yujing Terrace but know very little about its inner workings. People know that the "Liyue Qixing" are the elite, controlling the city's lifeblood. However, they find it difficult to understand how the data supporting each decision is established. People know that the new regulations issued each year bring new changes to the market, but they do not know how these regulations are extracted from the complex meeting minutes and gradually compiled into clear text. Ganyu, the secretary at Yuehai Pavilion, handles many unseen tasks. Even if people knew Ganyu's status, it would be hard for them to associate the secretary of Yuehai Pavilion with the girl quietly enjoying breakfast at the pier at dawn. However, before sunrise, she always returns to Yuehai Pavilion, perched high above Yujing Terrace, to continue fulfilling her "contract." This contract was signed three thousand years ago with the "Geo Archon." In Liyue, most citizens yearn for the lifestyle of Yujing Terrace but know very little about its inner workings. People know that the "Liyue Qixing" are the elite, controlling the city's lifeblood. However, they find it difficult to understand how the data supporting each decision is established. People know that the new regulations issued each year bring new changes to the market, but they do not know how these regulations are extracted from the complex meeting minutes and gradually compiled into clear text. In Liyue, most citizens yearn for the lifestyle of Yujing Terrace but know very little about its inner workings. People know that the "Liyue Qixing" are the elite, controlling the city's lifeblood. However, they find it difficult to understand how the data supporting each decision is established. People know that the new regulations issued each year bring new changes to the market, but they do not know how these regulations are extracted from the complex meeting minutes and gradually compiled into clear text. Ganyu, the secretary at Yuehai Pavilion, handles many unseen tasks. Even if people knew Ganyu's status, it would be hard for them to associate the secretary of Yuehai Pavilion with the girl quietly enjoying breakfast at the pier at dawn. However, before sunrise, she always returns to Yuehai Pavilion, perched high above Yujing Terrace, to continue fulfilling her "contract." This contract was signed three thousand years ago with the "Geo Archon."`}],mediaId:"492975307761920154",artwork:{},worlds:[t.id]}});console.log(r)};return e.jsxs(b,{anchor:e.jsx(R,{startIcon:e.jsx(j,{}),variant:"outlined",color:"warning",className:"ml-4 rounded-md",children:"Admin"}),children:[e.jsx(a,{onClick:n,children:e.jsx("span",{className:"normal-case",children:"inspect"})}),e.jsx(a,{onClick:s,children:e.jsx("span",{className:"normal-case",children:"edit"})}),e.jsx(a,{onClick:o,children:e.jsx("span",{className:"normal-case",children:"Add test character"})}),e.jsx(a,{className:"bg-red-100 text-red-500 hover:bg-red-200 transition duration-75",onClick:i,children:e.jsx("span",{className:"normal-case",children:"delete"})})]})}function V({artwork:t,world:n}){const{t:s}=O("worlds"),i=C(),{beingAdmin:o}=W(),r=p.useRef(null),[l,d]=p.useState(0),w=f(n.locales,"name",n.name),y=f(n.locales,"description",n.description),h=e.jsxs("div",{className:"md:mb-6",children:[e.jsxs("h2",{className:"text-2xl md:text-4xl lg:text-6xl font-semibold font-roboto overflow-ellipsis mb-3",children:[w,o&&e.jsx(U,{world:n})]}),(t.tags?.length||0)>0&&e.jsx(T,{tags:t.tags}),e.jsx(I,{className:"my-4",size:32,user:n.user,scene:"world"}),e.jsx(A,{title:s("worlds:world.introduction"),text:y,lines:i?2:7,expandPosition:i?"inline":"bottom"})]}),u=e.jsxs("div",{className:"md:min-w-[30%] mb-5",children:[e.jsx("div",{className:"flex mb-4 justify-between items-center text-nowrap",children:e.jsxs("div",{className:"text-xs lg:text-base",children:[e.jsx(H,{className:"inline mr-0.5"}),e.jsx("span",{children:M(n.followerCount+l,{uppercase:!0})})]})}),e.jsx(S,{world:n,className:"w-full h-10 text-base font-semibold rounded-xl",followingClassName:"bg-background-secondary hover:bg-gray-300 text-[#666666]",notFollowingClassName:"bg-theme-primary hover:bg-purple-600 text-white",showFollowingText:!0,scene:"world-detail",onClick:m=>{n.followedByMe&&!m?d(-1):!n.followedByMe&&m?d(1):d(0)}})]});return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-[60px]",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:gap-24 md:items-end px-[10%] h-[213px] md:h-[500px] bg-cover bg-top md:bg-center md:bg-auto text-white",style:{background:`linear-gradient(180deg, rgba(0, 0, 0, 0.00) 0%, rgba(0, 0, 0, 0.80) 100%), url(${E(n.media)}) lightgray 50% / cover no-repeat`},children:!i&&e.jsxs(e.Fragment,{children:[h,u]})}),i&&e.jsxs("div",{className:"mt-3 px-3",children:[h,e.jsx("hr",{className:"my-4"}),u]})]}),e.jsxs("div",{className:"flex flex-col gap-[60px] w-full mlg:max-w-[1200px] mx-auto px-3",children:[e.jsx(z,{id:n.id}),e.jsxs("div",{children:[e.jsx(g,{heading:s("worlds:heading.discussion"),trailing:t.commentCount??0}),e.jsx(Y,{artworkId:n.artworkId})]}),e.jsxs("div",{ref:r,children:[e.jsx(g,{heading:s("worlds:heading.artwork"),trailing:""}),e.jsx(L,{worldId:n.id,order:_.trending,renderEmpty:()=>e.jsx(x,{description:s("worlds:artwork.no-artwork")}),showSpeedDial:!1,containerProps:{className:"!min-h-fit"}})]})]})]})}function q(){const{id:t}=Q(),{data:n,isValidating:s}=B(t),{data:i,isValidating:o}=F(n?.artworkId);return!n||!i?s||o?e.jsx(G,{}):e.jsx(x,{description:"error"}):e.jsx(V,{artwork:i,world:n})}const pe=q;export{pe as Component};
