const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/de-BEYUbezi.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-amplitude-core-CQMkGYFj.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-mui-DTp04zm4.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-apollo-B9XqHIAo.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-graphql-DeSYh9DC.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-motion-Bl2lDopP.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-i18next-TC5y0B3W.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/es-Bm0E-1vI.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/fr-Br475m_v.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/id-vKprXaVD.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/it-BsCVgUKM.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ja-BooSVADZ.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ko-D9gPkKta.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ms-kIPHjXgu.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/pl-C_avfaHn.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/pt-Diu13Hj0.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/th-ahf7q4rV.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/tr-wdUGYCUV.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/uk-EPeFLJ4B.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vi-nWs4tal8.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/zh-CH-qxfqT.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/clown-wlHXvNZI.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/chip-B6bSLI_A.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/jackpot-CLMivLm8.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/primrose-b67mAatV.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/tulip-BVg-nxiH.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/cherry_blossom-DlsSou9N.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/index-_8yKFzX7.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/objectDestructuringEmpty-YVl7faCL.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/intl_segmenter_polyfill_rs-CyBj4KCD.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/EventPage-zZC1W6VE.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-react-aria-BW9JtD2p.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/time-line-DqQiT1u4.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-lodash-992l3ZN7.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-firebase-BKQqa5bK.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-axios-CFwfAwt2.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-react-router-Bm0RsDwP.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/TaskPublishDialog-C6g-yNPm.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/checkmark-circle-20-filled-Cc07OaOz.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/confetti.module-84Rp1PKD.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-markdown-1uD3znr6.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/JsBridgeContext-D4_0X_im.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-sentry-BZZLy1DV.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/i18n-resources-43uzMSBc.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-hls-cbDBXQj9.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-tldraw-CaaMemrL.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-fabric-Bg02ktlP.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-radix-ui-DX5JiNHB.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-tldraw-DkB09obf.css","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-photoswipe-UqzIRFho.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-photoswipe-Nx4y_V0V.css","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/EventPage-cs9QPkfS.css","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/index-Cbqhs0-u.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/EventCountdown-BuJnrndN.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/proxy-NoNVjFTQ.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/outline-info-C4eOIxV8.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/CollectionCardSetModal-BMT3xbWe.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/index-Ddf38TJy.css","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/SignPage-CV5cZKBK.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/VerifyEmail-CAdG--yM.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/useRaf-D50-5myI.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/AuthLayout-D0rtJlIT.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ResetPassword-DD44OLQE.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ChangeEmail-CVKJWKwK.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ForgetPassword-Bw4hDF-v.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/UserRevivalPage-BEMIEgIj.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/index-Ds8jOqME.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/HomePageWrapper-BPtgAhQv.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/index-BzVQ0Lfs.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/CodeRedeem-DhkeZqJ3.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/DiscordBotEntrypoint-lsDasrgT.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ProfileEditPage-BFY2U6kd.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/BasicProfile-Iq2K3Os8.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ProfileCoverEdit-BNRHf3Ip.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ProfileEditSection-DYLqWFBC.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/Accounts-TrwfNUwO.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ApiPlatform-9qvmRv0B.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/baseline-delete-Dbq3-3Bm.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/add-20-filled-BLwBa5AZ.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/AccountSecurity-DcUY3l1S.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/Notification-B01AvCtt.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ContentSettings-hE-BLOTH.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/MiscSettings-CGeKiSQp.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/UserReferralPage-Cetrk9bt.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/UserReferralFeatures-BE0j25ko.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ReferralOnboardingPage-DcUBIgk0.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ArtworkMasonrySection-B_fRpzbN.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ArtworkMasonrySection-CgaUhZpj.css","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/arrow-right-DJCRfyiv.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ArtworkSubmitUploadPage-mUHQ2zon.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/artwork-modal-BDpmcTXJ.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ArtworkDetailPage-D5V4rIhb.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ArtworkRelevantArtworksPage-CNh7AKZ1.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/TagListPage-D8IYDc4a.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/TagPage-UW8Er3a2.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ModelGrid-pbezVJd1.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ModelCard-BbPEsrCH.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/MarketPage-pZFadfWN.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/TrainLoraEvent-YJOi9HOY.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/SearchForm-BZr1F1ci.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ModelDetailPage-DYGQuOUP.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/WorldsPage-D8VqTcBK.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/WorldFollowButton-BYKmQ9zF.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/WorldDetailPage-CGiMb4HW.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/CharacterList-Djcy-68i.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/CharacterDetailPage-Cwne6wER.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ModelSubmitPage-rA_ODDYA.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ModelUploadStepOne-gTml6LXE.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/validator-C-4wpX4q.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ModelUploadStepTwo-XG3YzzgG.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ModelUploadStepThree-CxObHiWC.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/RankingPage-DJAzgPg2.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ShareTopArtworks-BOuTPYe4.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ShareTopArtworks-DQCKYVg6.css","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/SearchResultPage-C0w5BJlj.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/UserRecentArtworksPreviewList-Bcd_RU58.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/TrainLoraPage-BXeyTroo.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/index-DDDieZ2E.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/rand-CeqwHrxf.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/UserRankPage-Diw15Tu1.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/MembershipPlansPage-CAYfpOGB.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/MembershipPlansPage-DsKI8Ail.css","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/SubscriptionLanding-DVyhbKa7.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/PixchanImages-CHScxbbG.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/SubscriptionUpdateResult-Cx_onueK.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/PaymentLanding-CZ195HHm.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/UserProfilePage-BCBnIA8O.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/download-BM-WjQMK.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/DropdownMenu-CzLyA4B-.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/useCopyToClipboard-BBBtjKLj.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/UserProfilePage-BCEgR6tf.css","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/MeRoute-CeVz45ST.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/NewsListPage-gdIwKXBs.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/PaperLayout-MMne1hCa.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/baseline-arrow-downward-zIQhHbGH.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/NewsListPage-pgpIE51w.css","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/NewsDetailPage-DHH91MtH.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/NewsArticle-nwCbYty7.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ContestPage-D7pDN-a6.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/EventsPage-CblmSIHf.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/MultiColumnSubmitPage-DYKH2et2.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/GenerationModeNavigation-BeGzJJIs.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/outline-download-B1qcKnqG.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/LCMRealtime-hph6rUCz.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/LCMRealtime-Dzzp4BTj.css","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/LoraSelectContext-DhHbgVG-.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/LCMRealtime-CjIgWAXP.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/WorkflowGeneratorPage-Bs0INI1F.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/AgentGeneratorPage-Dplqby9n.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/UpscalePage-Bm0T08hh.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ImageStitchPage-Dv1493iR.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/vendor-jimp-CkzCxiND.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ChatEditingPresetPage-B0SgH-KA.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ConversationalEditPage-DDIqJQBf.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/TermsLayout-CWjdGcMu.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/Terms-DQljyAu-.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/LegalEntity-BFoRF4vg.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/Privacy-DZGOLhRm.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/LegalForPayment-Dt5mzLE1.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/CopyrightPolicyPage-B0urCN5k.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/Feedback-Ch5kQkNw.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/EmbeddedPage-By3spNz2.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/EmbeddedEventPage-DPeP2oLI.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/EmbeddedReferralPage-YywyMZYf.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/EmbeddedConversationalEditPage-QcQZqjJG.js","https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/EmbeddedNewsPage-DduqRqca.js"])))=>i.map(i=>d[i]);
import{j as jsxRuntimeExports,m as motion,u as useDragControls,a as useMotionValue,A as AnimatePresence,b as animate$1,c as motionValue}from"./vendor-motion-Bl2lDopP.js";import{R as React,r as reactExports,A as ApolloError,d as __values$2,c as __spreadArray,e as __read$1,f as __extends$2,_ as __assign$1,s as skipToken,N as NetworkStatus,u as useQuery,g as useMutation,h as createHttpLink,i as createPersistedQueryLink,j as RetryLink,k as getMainDefinition,I as InMemoryCache,l as ApolloClient,m as from,n as setContext,o as onError,p as ApolloLink,O as Observable$1,q as relayStylePagination,t as ApolloProvider}from"./vendor-apollo-B9XqHIAo.js";import{r as reactDomExports,d as defaultDayjs,l as localizedFormatPlugin,i as isBetweenPlugin,C as CircularProgress,S as SwipeableDrawer,D as Dialog,a as Popover,I as IconButton,b as DialogTitle,e as DialogContent,f as DialogContentText,g as DialogActions,B as Button,F as FormGroup,h as FormControlLabel,j as Checkbox,O as OutlinedInput,c as clsx$1,L as List,k as ListItem$3,m as ListItemAvatar,A as Avatar,n as ListItemText,s as styled,o as InputBase,p as createMuiStrictModeTheme,T as ThemeProvider,q as FormControl,t as InputLabel,u as Divider,v as Alert,w as Badge,x as ButtonBase,y as InputAdornment,G as Grow,M as Menu,z as RadioGroup,E as Radio,H as MenuItem$1,J as ListSubheader,K as Fab,$ as $7SXl2$reactdom,P as PropTypes,N as Autocomplete,Q as TextField,U as Drawer,V as ListItemButton,W as Container$1,X as Chip,Y as Slider,Z as Input,a0 as Select,a1 as TableContainer,a2 as Table,a3 as TableHead,a4 as TableRow,a5 as TableCell,a6 as TableBody,a7 as TableFooter,a8 as Skeleton,a9 as ButtonGroup,aa as Switch,ab as Tooltip,ac as FormLabel,ad as Box,ae as ToggleButtonGroup,af as ToggleButton,ag as Tabs,ah as Tab,ai as StyledEngineProvider}from"./vendor-mui-DTp04zm4.js";import{g as getDefaultExportFromCjs,c as commonjsGlobal,_ as __vitePreload,B as Buffer,d as getDeviceId,E as Experiment,s as sessionReplayPlugin,i as init,t as track$1,e as setUserId,f as identify,h as getUserId,j as add,r as remove,I as Identify,b as getAugmentedNamespace,a as global}from"./vendor-amplitude-core-CQMkGYFj.js";import{u as useSearchParams,a as useLocation,b as useMatches,c as useParams,d as useNavigate,L as Link,S as ScrollRestoration,e as useHref,N as Navigate,f as useRouteError,O as Outlet,g as createBrowserRouter,r as redirect,R as RouterProvider}from"./vendor-react-router-Bm0RsDwP.js";import{u as useTranslation,T as Trans,c as createInstance,B as Backend,d as Browser,i as initReactI18next,e as Backend$1}from"./vendor-i18next-TC5y0B3W.js";import{a as atomWithStorage,b as atom,R as RESET,g as getDefaultStore,c as getApiUrl,u as useAtom,N as N$4,G as GenerationModelType,e as a$3,M as ModerationStatus,$ as $$3,f as config$1,h as useAtomValue,i as getWebsocketUrl,j as getSdk,k as useSetAtom,I as Interval,l as getAppEnv,m as getApiEnv,C as Currency,n as useStore,T as TaskCharacteristics,p as CampaignMediaType,A as AgeVerificationStatus,q as getFirebaseMessaging,r as onMessage,s as getFirebaseToken,t as TurnstileWidgetMode,v as getTurnstileSiteKey,D as DecorationType,w as ArtworkType,x as RefType,y as MarkType,z as MangaType,B as ReportReason,E as MediaType,F as MediaProvider,H as NotificationType,J as RankMediaType,P as Provider,K as createStore$1,L as ExtraPackageCampaignCategory,O as ExtraPackageBoostType,Q as selectAtom,U as UploadMultiPartStep,S as atomWithRefresh,V as UserSettingType,W as GenerationModelMarkType,X as ReviewRating,Y as turnstileSiteKeyTypeAtom}from"./vendor-firebase-BKQqa5bK.js";import{p as process$1,a as axios,C as CanceledError}from"./vendor-axios-CFwfAwt2.js";import{a as isPlainObject$1,c as cloneDeepWith,p as pick$1,m as memoize$1,k as kebabCase,b as mapValues$1,d as pickBy,u as update,e as uniqueId,f as debounce,n as noop$6,g as compact,r as round,h as isEqual$1,s as set$5,j as get$3,l as snakeCase,o as isFunction$3,q as uniqBy,v as defaults$2,w as uniq,x as groupBy$1,y as omit,z as omitBy,A as isNil,B as throttle,C as camelCase,D as clamp$1,E as chunk,F as cloneDeep$1,G as range$1,H as random}from"./vendor-lodash-992l3ZN7.js";import{c as createClient,G as GetMyMembershipDocument,a as GetUserMembershipDocument,C as CancelSubscriptionDocument,R as ResumeSubscriptionDocument,b as GetMyQuotaDocument,d as GetMeWithQuotaForCurrencyDocument,L as ListUserQuotaLogsDocument,e as ListMyQuotaLogsDocument,f as ClaimShareCreditDocument,V as VerifyCreditCouponDocument,g as getNodesFromConnection,h as ListQuestsDocument,j as GetDailyClaimAvailableDocument,D as DailyClaimQuotaDocument,k as ClaimQuestRewardDocument,l as GetAllPaymentItemsDocument,m as GetOrderByIdDocument,n as GetCouponDocument,I as IntentToPayDocument,o as GetMyPreferencesDocument,S as SetPreferencesDocument,P as PaymentItemType,q as ListCampaignAdsDocument,r as CampaignMediaType$1,s as GetMyReferralCodeDocument,t as GetUserReferralLogsDocument,u as GetMyReferrerIdDocument,w as GetReferralCodeInfoDocument,x as GenerateReferralCodeDocument,y as SetReferrerDocument,z as ListUsersDocument,A as GetUserInfoByIdDocument,E as GetUserInfoByUsernameDocument,F as ListUserDecorationsDocument,H as ListUserActiveDecorationsDocument,J as ListUserCollectionCardsDocument,M as ListActiveCollectionCardSetsDocument,N as GetUserCardSetProgressDocument,O as ListUserCardSetProgressDocument,K as Kind,Q as OperationTypeNode,T as GetUserInfoDocument,U as ListMyMfaListDocument,W as GetMyExternalProfilesDocument,X as GetUserWithExternalProfilesDocument,Y as RegisterDocument,Z as LoginDocument,_ as RefreshTokenDocument,$ as ForgetPasswordDocument,a0 as GenCodeDocument,a1 as VerifyEmailDocument,a2 as UpdateUserInfoDocument,a3 as UpdateUserSensitiveInfosDocument,a4 as SetPushTokenDocument,a5 as SetupMfaDocument,a6 as WithdrawAccountDocument,a7 as UnlinkExternalDocument,a8 as GetArtworkDocument,a9 as GetArtworkWithTaskDetailDocument,aa as ListArtworksDocument,ab as ListUserLikedArtworksDocument,ac as DeleteArtworkDocument,ad as MarkArtworkDocument,ae as UpsertArtworkDocument,af as GetMangaDocument,ag as GetMangaChapterDocument,ah as ListUserLikedMangaListDocument,ai as MarkMangaDocument,aj as DeleteMangaDocument,ak as GetMediaDocument,al as UploadMediaDocument,am as GetMessageDocument,an as ListMessagesDocument,ao as SendMessageDocument,ap as MessageBaseFragmentDoc,aq as DeleteMessageDocument,ar as GetTaskByIdDocument,as as ListMyTasksDocument,at as ListUserTasksDocument,au as ListUserTaskSummariesDocument,av as CreateGenerationTaskDocument,aw as CreateArtworkFromTaskV2Document,ax as CancelGenerationTaskDocument,ay as DeleteGenerationTaskDocument,az as RerunGenerationTaskDocument,aA as UpdateGenerationTaskDocument,aB as CreateTrainingTaskDocument,aC as CreateGrowthEventTaskDocument,aD as GetTagDocument,aE as ListTagsDocument,aF as GetContestDocument,aG as ListContestsDocument,aH as GetNotificationDocument,aI as ListNotificationsDocument,aJ as ListMyNotificationsDocument,aK as GetMyUnreadNotiCountDocument,aL as MarkNotificationReadDocument,aM as ListFilesDocument,aN as GetFileDocument,aO as GetFileStatisticsDocument,aP as DeleteFileDocument,aQ as UploadFileMultiPartDocument,aR as GetMySettingDocument,aS as ListMySettingsDocument,aT as GetMySettingLimitDocument,aU as UpsertMySettingDocument,aV as DeleteMySettingDocument,aW as GetUserProfilesDocument,aX as SetProfilesDocument,aY as ToggleDecorationDocument,aZ as ListWorkflowArtworksForMeDocument,a_ as ListWorkflowsDocument,a$ as GetWorkflowDocument,b0 as GetWorkflowForMarketDocument,b1 as GetWorkflowForMarketByWorkflowIdDocument,b2 as GetWorkflowForRunnerDocument,b3 as ListWorkflowVersionsDocument,b4 as UpsertWorkflowDocument,b5 as DeleteWorkflowDocument,b6 as UpsertWorkflowVersionDocument,b7 as ListChatEditingScenesDocument,b8 as GetChatEditingSceneDocument,b9 as CreateChatEditingSceneTaskDocument,ba as AgeVerificationStatus$1}from"./vendor-graphql-DeSYh9DC.js";import{s as setUser,c as captureException,i as init$1,t as thirdPartyErrorFilterIntegration}from"./vendor-sentry-BZZLy1DV.js";import{$ as $d2b4bc8c273e7be6$export$353f5b6fc5456de1,a as $f3f84453ead64de5$export$8948f78d83984c69,b as $f3f84453ead64de5$export$2b77a92f1a5ad772,c as $de32f1b87079253c$export$3ddf2d174ce01153,d as $3ef42575df84b30b$export$9d1611c77c2fe928,e as $5cb03073d3f54797$export$a8a3e93435678ff9,f as $f3f84453ead64de5$export$ab57792b9b6974a6,g as $4e3b923658d69c60$export$8c610744efcf8a1d,h as $4e3b923658d69c60$export$28c660c63b792dea,i as $64fa3d84918910a7$export$c245e6201fed2f75,j as $44f671af83e7d9e0$export$746d02f47f4d381,k as $298d61e98472621b$export$dcf14c9974fe2767,l as $8e59e948500a8fe1$export$b5d5cf8927ab7262,m as $3985021b0ad6602f$export$f5b8910cec6cf069,n as $216918bed6669f72$export$f5c9f3c2c4054eec,o as $3674c52c6b3c5bce$export$c7e742effb1c51e2,p as $3674c52c6b3c5bce$export$ecabc99eeffab7ca,q as $3674c52c6b3c5bce$export$27d2ad3c5815583e,r as $07b14b47974efb58$export$9b9a0cd73afb7ca4,s as $07b14b47974efb58$export$5b6b19405a83ff9d,t as $3674c52c6b3c5bce$export$d9b273488cd8ce6f,u as $3674c52c6b3c5bce$export$2ce376c2cc3355c8,v as $514c0188e459b4c0$export$5f1af8db9871e1d6,w as $431f98aba6844401$export$1ff3c3f08ae963c0,x as $72a5793c14baf454$export$8b251419efc915eb,y as $1e2864c73f66a4da$export$6fb4a10d2c950550,z as $d3e0e05bdfcf66bd$export$a7fed597f4b8afd8,A as $01b77f81d0f07f68$export$b04be29aa201d4f5,B as $bcdf0525bf22703d$export$2c73285ae9390cec,C as $b6c3ddc6086f204d$export$a98f0dcb43a68a25,D as $ee014567cb39d3f0$export$f551688fc98f2e09,E as $eaf9e70818b436db$export$67ea30858aaf75e3,F as $eaf9e70818b436db$export$f9fef0f55402315b,G as $eaf9e70818b436db$export$3288d34c523a1192,H as $eed445e0843c11d0$export$41f133550aa26f48,I as $eed445e0843c11d0$export$a11e76429ed99b4,J as $bc237834342dbd75$export$48513f6b9f8ce62d,K as $28f4fd908f0de97f$export$74a362b31437ec83,L as $28f4fd908f0de97f$export$feabaa331e1d464c,M as $4f118338184dc1d9$export$a6c7ac8248d6e38a,N as $ea8dcbcb9ea1b556$export$323e4fc2fa4753fb,O as $5e8ad37a45e1c704$export$3e41faf802a29e71,P as $5e8ad37a45e1c704$export$e51a686c67fdaa2d,Q as $5e8ad37a45e1c704$export$b2539bed5023c21c,R as $5e8ad37a45e1c704$export$3d96ec278d3efce4,S as $b6c3ddc6086f204d$export$d7b12c4107be0d61,T as $82d7e5349645de74$export$ef9b1a59e592288f,U as $82d7e5349645de74$export$e288731fd71264f0,V as $6f909507e6374d18$export$472062a354075cee,W as $6f909507e6374d18$export$a590f758a961cb5b,X as $6f909507e6374d18$export$105594979f116971,Y as $6f909507e6374d18$export$2c1b491743890dec,Z as $de32f1b87079253c$export$2e1e1122cf0cba88,_ as $7135fc7d473fd974$export$6e2c8f0811a474ce,a0 as $2a41e45df1593e64$export$d39e1813b3bdd0e1,a1 as $f645667febf57a63$export$4c014de7c8940b4c,a2 as $f39a9eba43920ace$export$86427a43e3e48ebb}from"./vendor-react-aria-BW9JtD2p.js";import{M as MarkdownIt,c as collapsiblePlugin,a as Markdown}from"./vendor-markdown-1uD3znr6.js";import{e as enAuth,a as enCommon,b as enAction,c as enError,d as enManga,f as enArtwork,g as enUser,h as enComment,i as enMarket,j as enGrowth,k as enGeneration,l as enMembership,m as enWorkflow,n as enPlatform,o as enWorlds,p as jaAuth,q as jaCommon,r as jaAction,s as jaError,t as jaArtwork,u as jaUser,v as jaComment,w as jaMarket,x as jaGrowth,y as jaGeneration,z as jaMembership,A as jaWorlds}from"./i18n-resources-43uzMSBc.js";import{H as Hls}from"./vendor-hls-cbDBXQj9.js";import{A as AssetRecordType,c as createShapeId}from"./vendor-tldraw-CaaMemrL.js";import{G as Gallery,I as Item}from"./vendor-photoswipe-UqzIRFho.js";import"./vendor-fabric-Bg02ktlP.js";import"./vendor-radix-ui-DX5JiNHB.js";(function(){try{var He=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};He.SENTRY_RELEASE={id:"0ec442be81a4ee21bfcf5745e8ef10bc76836958"}}catch{}})();try{(function(){var He=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},Qe=new He.Error().stack;Qe&&(He._sentryDebugIds=He._sentryDebugIds||{},He._sentryDebugIds[Qe]="a99f307e-29ee-49d4-acee-790ccd8c2b15",He._sentryDebugIdIdentifier="sentry-dbid-a99f307e-29ee-49d4-acee-790ccd8c2b15")})()}catch{}(function(){try{var He=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};He._sentryModuleMetadata=He._sentryModuleMetadata||{},He._sentryModuleMetadata[new He.Error().stack]=function(Qe){for(var it=1;it<arguments.length;it++){var lt=arguments[it];if(lt!=null)for(var ut in lt)lt.hasOwnProperty(ut)&&(Qe[ut]=lt[ut])}return Qe}({},He._sentryModuleMetadata[new He.Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}catch{}})();(function(){const Qe=document.createElement("link").relList;if(Qe&&Qe.supports&&Qe.supports("modulepreload"))return;for(const ut of document.querySelectorAll('link[rel="modulepreload"]'))lt(ut);new MutationObserver(ut=>{for(const dt of ut)if(dt.type==="childList")for(const xt of dt.addedNodes)xt.tagName==="LINK"&&xt.rel==="modulepreload"&&lt(xt)}).observe(document,{childList:!0,subtree:!0});function it(ut){const dt={};return ut.integrity&&(dt.integrity=ut.integrity),ut.referrerPolicy&&(dt.referrerPolicy=ut.referrerPolicy),ut.crossOrigin==="use-credentials"?dt.credentials="include":ut.crossOrigin==="anonymous"?dt.credentials="omit":dt.credentials="same-origin",dt}function lt(ut){if(ut.ep)return;ut.ep=!0;const dt=it(ut);fetch(ut.href,dt)}})();var client$1={},m$4=reactDomExports;client$1.createRoot=m$4.createRoot,client$1.hydrateRoot=m$4.hydrateRoot;var hasElementType=typeof Element<"u",hasMap=typeof Map=="function",hasSet=typeof Set=="function",hasArrayBuffer=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function equal(He,Qe){if(He===Qe)return!0;if(He&&Qe&&typeof He=="object"&&typeof Qe=="object"){if(He.constructor!==Qe.constructor)return!1;var it,lt,ut;if(Array.isArray(He)){if(it=He.length,it!=Qe.length)return!1;for(lt=it;lt--!==0;)if(!equal(He[lt],Qe[lt]))return!1;return!0}var dt;if(hasMap&&He instanceof Map&&Qe instanceof Map){if(He.size!==Qe.size)return!1;for(dt=He.entries();!(lt=dt.next()).done;)if(!Qe.has(lt.value[0]))return!1;for(dt=He.entries();!(lt=dt.next()).done;)if(!equal(lt.value[1],Qe.get(lt.value[0])))return!1;return!0}if(hasSet&&He instanceof Set&&Qe instanceof Set){if(He.size!==Qe.size)return!1;for(dt=He.entries();!(lt=dt.next()).done;)if(!Qe.has(lt.value[0]))return!1;return!0}if(hasArrayBuffer&&ArrayBuffer.isView(He)&&ArrayBuffer.isView(Qe)){if(it=He.length,it!=Qe.length)return!1;for(lt=it;lt--!==0;)if(He[lt]!==Qe[lt])return!1;return!0}if(He.constructor===RegExp)return He.source===Qe.source&&He.flags===Qe.flags;if(He.valueOf!==Object.prototype.valueOf&&typeof He.valueOf=="function"&&typeof Qe.valueOf=="function")return He.valueOf()===Qe.valueOf();if(He.toString!==Object.prototype.toString&&typeof He.toString=="function"&&typeof Qe.toString=="function")return He.toString()===Qe.toString();if(ut=Object.keys(He),it=ut.length,it!==Object.keys(Qe).length)return!1;for(lt=it;lt--!==0;)if(!Object.prototype.hasOwnProperty.call(Qe,ut[lt]))return!1;if(hasElementType&&He instanceof Element)return!1;for(lt=it;lt--!==0;)if(!((ut[lt]==="_owner"||ut[lt]==="__v"||ut[lt]==="__o")&&He.$$typeof)&&!equal(He[ut[lt]],Qe[ut[lt]]))return!1;return!0}return He!==He&&Qe!==Qe}var reactFastCompare=function(Qe,it){try{return equal(Qe,it)}catch(lt){if((lt.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw lt}};const fastCompare=getDefaultExportFromCjs(reactFastCompare);var invariant$1=function(He,Qe,it,lt,ut,dt,xt,ft){if(!He){var vt;if(Qe===void 0)vt=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var kt=[it,lt,ut,dt,xt,ft],St=0;vt=new Error(Qe.replace(/%s/g,function(){return kt[St++]})),vt.name="Invariant Violation"}throw vt.framesToPop=1,vt}},browser$1=invariant$1;const invariant$2=getDefaultExportFromCjs(browser$1);var shallowequal=function(Qe,it,lt,ut){var dt=lt?lt.call(ut,Qe,it):void 0;if(dt!==void 0)return!!dt;if(Qe===it)return!0;if(typeof Qe!="object"||!Qe||typeof it!="object"||!it)return!1;var xt=Object.keys(Qe),ft=Object.keys(it);if(xt.length!==ft.length)return!1;for(var vt=Object.prototype.hasOwnProperty.bind(it),kt=0;kt<xt.length;kt++){var St=xt[kt];if(!vt(St))return!1;var Tt=Qe[St],Mt=it[St];if(dt=lt?lt.call(ut,Tt,Mt,St):void 0,dt===!1||dt===void 0&&Tt!==Mt)return!1}return!0};const shallowEqual=getDefaultExportFromCjs(shallowequal);var TAG_NAMES=(He=>(He.BASE="base",He.BODY="body",He.HEAD="head",He.HTML="html",He.LINK="link",He.META="meta",He.NOSCRIPT="noscript",He.SCRIPT="script",He.STYLE="style",He.TITLE="title",He.FRAGMENT="Symbol(react.fragment)",He))(TAG_NAMES||{}),SEO_PRIORITY_TAGS={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},VALID_TAG_NAMES=Object.values(TAG_NAMES),REACT_TAG_MAP={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},HTML_TAG_MAP=Object.entries(REACT_TAG_MAP).reduce((He,[Qe,it])=>(He[it]=Qe,He),{}),HELMET_ATTRIBUTE="data-rh",HELMET_PROPS={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},getInnermostProperty=(He,Qe)=>{for(let it=He.length-1;it>=0;it-=1){const lt=He[it];if(Object.prototype.hasOwnProperty.call(lt,Qe))return lt[Qe]}return null},getTitleFromPropsList=He=>{let Qe=getInnermostProperty(He,"title");const it=getInnermostProperty(He,HELMET_PROPS.TITLE_TEMPLATE);if(Array.isArray(Qe)&&(Qe=Qe.join("")),it&&Qe)return it.replace(/%s/g,()=>Qe);const lt=getInnermostProperty(He,HELMET_PROPS.DEFAULT_TITLE);return Qe||lt||void 0},getOnChangeClientState=He=>getInnermostProperty(He,HELMET_PROPS.ON_CHANGE_CLIENT_STATE)||(()=>{}),getAttributesFromPropsList=(He,Qe)=>Qe.filter(it=>typeof it[He]<"u").map(it=>it[He]).reduce((it,lt)=>({...it,...lt}),{}),getBaseTagFromPropsList=(He,Qe)=>Qe.filter(it=>typeof it.base<"u").map(it=>it.base).reverse().reduce((it,lt)=>{if(!it.length){const ut=Object.keys(lt);for(let dt=0;dt<ut.length;dt+=1){const ft=ut[dt].toLowerCase();if(He.indexOf(ft)!==-1&&lt[ft])return it.concat(lt)}}return it},[]),warn=He=>console&&typeof console.warn=="function"&&console.warn(He),getTagsFromPropsList=(He,Qe,it)=>{const lt={};return it.filter(ut=>Array.isArray(ut[He])?!0:(typeof ut[He]<"u"&&warn(`Helmet: ${He} should be of type "Array". Instead found type "${typeof ut[He]}"`),!1)).map(ut=>ut[He]).reverse().reduce((ut,dt)=>{const xt={};dt.filter(vt=>{let kt;const St=Object.keys(vt);for(let Mt=0;Mt<St.length;Mt+=1){const Nt=St[Mt],At=Nt.toLowerCase();Qe.indexOf(At)!==-1&&!(kt==="rel"&&vt[kt].toLowerCase()==="canonical")&&!(At==="rel"&&vt[At].toLowerCase()==="stylesheet")&&(kt=At),Qe.indexOf(Nt)!==-1&&(Nt==="innerHTML"||Nt==="cssText"||Nt==="itemprop")&&(kt=Nt)}if(!kt||!vt[kt])return!1;const Tt=vt[kt].toLowerCase();return lt[kt]||(lt[kt]={}),xt[kt]||(xt[kt]={}),lt[kt][Tt]?!1:(xt[kt][Tt]=!0,!0)}).reverse().forEach(vt=>ut.push(vt));const ft=Object.keys(xt);for(let vt=0;vt<ft.length;vt+=1){const kt=ft[vt],St={...lt[kt],...xt[kt]};lt[kt]=St}return ut},[]).reverse()},getAnyTrueFromPropsList=(He,Qe)=>{if(Array.isArray(He)&&He.length){for(let it=0;it<He.length;it+=1)if(He[it][Qe])return!0}return!1},reducePropsToState=He=>({baseTag:getBaseTagFromPropsList(["href"],He),bodyAttributes:getAttributesFromPropsList("bodyAttributes",He),defer:getInnermostProperty(He,HELMET_PROPS.DEFER),encode:getInnermostProperty(He,HELMET_PROPS.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:getAttributesFromPropsList("htmlAttributes",He),linkTags:getTagsFromPropsList("link",["rel","href"],He),metaTags:getTagsFromPropsList("meta",["name","charset","http-equiv","property","itemprop"],He),noscriptTags:getTagsFromPropsList("noscript",["innerHTML"],He),onChangeClientState:getOnChangeClientState(He),scriptTags:getTagsFromPropsList("script",["src","innerHTML"],He),styleTags:getTagsFromPropsList("style",["cssText"],He),title:getTitleFromPropsList(He),titleAttributes:getAttributesFromPropsList("titleAttributes",He),prioritizeSeoTags:getAnyTrueFromPropsList(He,HELMET_PROPS.PRIORITIZE_SEO_TAGS)}),flattenArray=He=>Array.isArray(He)?He.join(""):He,checkIfPropsMatch=(He,Qe)=>{const it=Object.keys(He);for(let lt=0;lt<it.length;lt+=1)if(Qe[it[lt]]&&Qe[it[lt]].includes(He[it[lt]]))return!0;return!1},prioritizer=(He,Qe)=>Array.isArray(He)?He.reduce((it,lt)=>(checkIfPropsMatch(lt,Qe)?it.priority.push(lt):it.default.push(lt),it),{priority:[],default:[]}):{default:He,priority:[]},without=(He,Qe)=>({...He,[Qe]:void 0}),SELF_CLOSING_TAGS=["noscript","script","style"],encodeSpecialCharacters=(He,Qe=!0)=>Qe===!1?String(He):String(He).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),generateElementAttributesAsString=He=>Object.keys(He).reduce((Qe,it)=>{const lt=typeof He[it]<"u"?`${it}="${He[it]}"`:`${it}`;return Qe?`${Qe} ${lt}`:lt},""),generateTitleAsString=(He,Qe,it,lt)=>{const ut=generateElementAttributesAsString(it),dt=flattenArray(Qe);return ut?`<${He} ${HELMET_ATTRIBUTE}="true" ${ut}>${encodeSpecialCharacters(dt,lt)}</${He}>`:`<${He} ${HELMET_ATTRIBUTE}="true">${encodeSpecialCharacters(dt,lt)}</${He}>`},generateTagsAsString=(He,Qe,it=!0)=>Qe.reduce((lt,ut)=>{const dt=ut,xt=Object.keys(dt).filter(kt=>!(kt==="innerHTML"||kt==="cssText")).reduce((kt,St)=>{const Tt=typeof dt[St]>"u"?St:`${St}="${encodeSpecialCharacters(dt[St],it)}"`;return kt?`${kt} ${Tt}`:Tt},""),ft=dt.innerHTML||dt.cssText||"",vt=SELF_CLOSING_TAGS.indexOf(He)===-1;return`${lt}<${He} ${HELMET_ATTRIBUTE}="true" ${xt}${vt?"/>":`>${ft}</${He}>`}`},""),convertElementAttributesToReactProps=(He,Qe={})=>Object.keys(He).reduce((it,lt)=>{const ut=REACT_TAG_MAP[lt];return it[ut||lt]=He[lt],it},Qe),generateTitleAsReactComponent=(He,Qe,it)=>{const lt={key:Qe,[HELMET_ATTRIBUTE]:!0},ut=convertElementAttributesToReactProps(it,lt);return[React.createElement("title",ut,Qe)]},generateTagsAsReactComponent=(He,Qe)=>Qe.map((it,lt)=>{const ut={key:lt,[HELMET_ATTRIBUTE]:!0};return Object.keys(it).forEach(dt=>{const ft=REACT_TAG_MAP[dt]||dt;if(ft==="innerHTML"||ft==="cssText"){const vt=it.innerHTML||it.cssText;ut.dangerouslySetInnerHTML={__html:vt}}else ut[ft]=it[dt]}),React.createElement(He,ut)}),getMethodsForTag=(He,Qe,it=!0)=>{switch(He){case"title":return{toComponent:()=>generateTitleAsReactComponent(He,Qe.title,Qe.titleAttributes),toString:()=>generateTitleAsString(He,Qe.title,Qe.titleAttributes,it)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>convertElementAttributesToReactProps(Qe),toString:()=>generateElementAttributesAsString(Qe)};default:return{toComponent:()=>generateTagsAsReactComponent(He,Qe),toString:()=>generateTagsAsString(He,Qe,it)}}},getPriorityMethods=({metaTags:He,linkTags:Qe,scriptTags:it,encode:lt})=>{const ut=prioritizer(He,SEO_PRIORITY_TAGS.meta),dt=prioritizer(Qe,SEO_PRIORITY_TAGS.link),xt=prioritizer(it,SEO_PRIORITY_TAGS.script);return{priorityMethods:{toComponent:()=>[...generateTagsAsReactComponent("meta",ut.priority),...generateTagsAsReactComponent("link",dt.priority),...generateTagsAsReactComponent("script",xt.priority)],toString:()=>`${getMethodsForTag("meta",ut.priority,lt)} ${getMethodsForTag("link",dt.priority,lt)} ${getMethodsForTag("script",xt.priority,lt)}`},metaTags:ut.default,linkTags:dt.default,scriptTags:xt.default}},mapStateOnServer=He=>{const{baseTag:Qe,bodyAttributes:it,encode:lt=!0,htmlAttributes:ut,noscriptTags:dt,styleTags:xt,title:ft="",titleAttributes:vt,prioritizeSeoTags:kt}=He;let{linkTags:St,metaTags:Tt,scriptTags:Mt}=He,Nt={toComponent:()=>{},toString:()=>""};return kt&&({priorityMethods:Nt,linkTags:St,metaTags:Tt,scriptTags:Mt}=getPriorityMethods(He)),{priority:Nt,base:getMethodsForTag("base",Qe,lt),bodyAttributes:getMethodsForTag("bodyAttributes",it,lt),htmlAttributes:getMethodsForTag("htmlAttributes",ut,lt),link:getMethodsForTag("link",St,lt),meta:getMethodsForTag("meta",Tt,lt),noscript:getMethodsForTag("noscript",dt,lt),script:getMethodsForTag("script",Mt,lt),style:getMethodsForTag("style",xt,lt),title:getMethodsForTag("title",{title:ft,titleAttributes:vt},lt)}},server_default=mapStateOnServer,instances=[],isDocument=!!(typeof window<"u"&&window.document&&window.document.createElement),HelmetData=class{instances=[];canUseDOM=isDocument;context;value={setHelmet:He=>{this.context.helmet=He},helmetInstances:{get:()=>this.canUseDOM?instances:this.instances,add:He=>{(this.canUseDOM?instances:this.instances).push(He)},remove:He=>{const Qe=(this.canUseDOM?instances:this.instances).indexOf(He);(this.canUseDOM?instances:this.instances).splice(Qe,1)}}};constructor(He,Qe){this.context=He,this.canUseDOM=Qe||!1,Qe||(He.helmet=server_default({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},defaultValue$1={},Context=React.createContext(defaultValue$1),HelmetProvider=class ks extends reactExports.Component{static canUseDOM=isDocument;helmetData;constructor(Qe){super(Qe),this.helmetData=new HelmetData(this.props.context||{},ks.canUseDOM)}render(){return React.createElement(Context.Provider,{value:this.helmetData.value},this.props.children)}},updateTags=(He,Qe)=>{const it=document.head||document.querySelector("head"),lt=it.querySelectorAll(`${He}[${HELMET_ATTRIBUTE}]`),ut=[].slice.call(lt),dt=[];let xt;return Qe&&Qe.length&&Qe.forEach(ft=>{const vt=document.createElement(He);for(const kt in ft)if(Object.prototype.hasOwnProperty.call(ft,kt))if(kt==="innerHTML")vt.innerHTML=ft.innerHTML;else if(kt==="cssText")vt.styleSheet?vt.styleSheet.cssText=ft.cssText:vt.appendChild(document.createTextNode(ft.cssText));else{const St=kt,Tt=typeof ft[St]>"u"?"":ft[St];vt.setAttribute(kt,Tt)}vt.setAttribute(HELMET_ATTRIBUTE,"true"),ut.some((kt,St)=>(xt=St,vt.isEqualNode(kt)))?ut.splice(xt,1):dt.push(vt)}),ut.forEach(ft=>ft.parentNode?.removeChild(ft)),dt.forEach(ft=>it.appendChild(ft)),{oldTags:ut,newTags:dt}},updateAttributes=(He,Qe)=>{const it=document.getElementsByTagName(He)[0];if(!it)return;const lt=it.getAttribute(HELMET_ATTRIBUTE),ut=lt?lt.split(","):[],dt=[...ut],xt=Object.keys(Qe);for(const ft of xt){const vt=Qe[ft]||"";it.getAttribute(ft)!==vt&&it.setAttribute(ft,vt),ut.indexOf(ft)===-1&&ut.push(ft);const kt=dt.indexOf(ft);kt!==-1&&dt.splice(kt,1)}for(let ft=dt.length-1;ft>=0;ft-=1)it.removeAttribute(dt[ft]);ut.length===dt.length?it.removeAttribute(HELMET_ATTRIBUTE):it.getAttribute(HELMET_ATTRIBUTE)!==xt.join(",")&&it.setAttribute(HELMET_ATTRIBUTE,xt.join(","))},updateTitle=(He,Qe)=>{typeof He<"u"&&document.title!==He&&(document.title=flattenArray(He)),updateAttributes("title",Qe)},commitTagChanges=(He,Qe)=>{const{baseTag:it,bodyAttributes:lt,htmlAttributes:ut,linkTags:dt,metaTags:xt,noscriptTags:ft,onChangeClientState:vt,scriptTags:kt,styleTags:St,title:Tt,titleAttributes:Mt}=He;updateAttributes("body",lt),updateAttributes("html",ut),updateTitle(Tt,Mt);const Nt={baseTag:updateTags("base",it),linkTags:updateTags("link",dt),metaTags:updateTags("meta",xt),noscriptTags:updateTags("noscript",ft),scriptTags:updateTags("script",kt),styleTags:updateTags("style",St)},At={},$t={};Object.keys(Nt).forEach(Dt=>{const{newTags:Ft,oldTags:Bt}=Nt[Dt];Ft.length&&(At[Dt]=Ft),Bt.length&&($t[Dt]=Nt[Dt].oldTags)}),Qe&&Qe(),vt(He,At,$t)},_helmetCallback=null,handleStateChangeOnClient=He=>{_helmetCallback&&cancelAnimationFrame(_helmetCallback),He.defer?_helmetCallback=requestAnimationFrame(()=>{commitTagChanges(He,()=>{_helmetCallback=null})}):(commitTagChanges(He),_helmetCallback=null)},client_default=handleStateChangeOnClient,HelmetDispatcher=class extends reactExports.Component{rendered=!1;shouldComponentUpdate(He){return!shallowEqual(He,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:He}=this.props.context;He.remove(this),this.emitChange()}emitChange(){const{helmetInstances:He,setHelmet:Qe}=this.props.context;let it=null;const lt=reducePropsToState(He.get().map(ut=>{const dt={...ut.props};return delete dt.context,dt}));HelmetProvider.canUseDOM?client_default(lt):it=server_default(lt),Qe(it)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:He}=this.props.context;He.add(this),this.emitChange()}render(){return this.init(),null}},Helmet=class extends reactExports.Component{static defaultProps={defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1};shouldComponentUpdate(He){return!fastCompare(without(this.props,"helmetData"),without(He,"helmetData"))}mapNestedChildrenToProps(He,Qe){if(!Qe)return null;switch(He.type){case"script":case"noscript":return{innerHTML:Qe};case"style":return{cssText:Qe};default:throw new Error(`<${He.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(He,Qe,it,lt){return{...Qe,[He.type]:[...Qe[He.type]||[],{...it,...this.mapNestedChildrenToProps(He,lt)}]}}mapObjectTypeChildren(He,Qe,it,lt){switch(He.type){case"title":return{...Qe,[He.type]:lt,titleAttributes:{...it}};case"body":return{...Qe,bodyAttributes:{...it}};case"html":return{...Qe,htmlAttributes:{...it}};default:return{...Qe,[He.type]:{...it}}}}mapArrayTypeChildrenToProps(He,Qe){let it={...Qe};return Object.keys(He).forEach(lt=>{it={...it,[lt]:He[lt]}}),it}warnOnInvalidChildren(He,Qe){return invariant$2(VALID_TAG_NAMES.some(it=>He.type===it),typeof He.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${VALID_TAG_NAMES.join(", ")} are allowed. Helmet does not support rendering <${He.type}> elements. Refer to our API for more information.`),invariant$2(!Qe||typeof Qe=="string"||Array.isArray(Qe)&&!Qe.some(it=>typeof it!="string"),`Helmet expects a string as a child of <${He.type}>. Did you forget to wrap your children in braces? ( <${He.type}>{\`\`}</${He.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(He,Qe){let it={};return React.Children.forEach(He,lt=>{if(!lt||!lt.props)return;const{children:ut,...dt}=lt.props,xt=Object.keys(dt).reduce((vt,kt)=>(vt[HTML_TAG_MAP[kt]||kt]=dt[kt],vt),{});let{type:ft}=lt;switch(typeof ft=="symbol"?ft=ft.toString():this.warnOnInvalidChildren(lt,ut),ft){case"Symbol(react.fragment)":Qe=this.mapChildrenToProps(ut,Qe);break;case"link":case"meta":case"noscript":case"script":case"style":it=this.flattenArrayTypeChildren(lt,it,xt,ut);break;default:Qe=this.mapObjectTypeChildren(lt,Qe,xt,ut);break}}),this.mapArrayTypeChildrenToProps(it,Qe)}render(){const{children:He,...Qe}=this.props;let it={...Qe},{helmetData:lt}=Qe;if(He&&(it=this.mapChildrenToProps(He,it)),lt&&!(lt instanceof HelmetData)){const ut=lt;lt=new HelmetData(ut.context,!0),delete it.helmetData}return lt?React.createElement(HelmetDispatcher,{...it,context:lt.value}):React.createElement(Context.Consumer,null,ut=>React.createElement(HelmetDispatcher,{...it,context:ut}))}};function r$2(He){var Qe,it,lt="";if(typeof He=="string"||typeof He=="number")lt+=He;else if(typeof He=="object")if(Array.isArray(He))for(Qe=0;Qe<He.length;Qe++)He[Qe]&&(it=r$2(He[Qe]))&&(lt&&(lt+=" "),lt+=it);else for(Qe in He)He[Qe]&&(lt&&(lt+=" "),lt+=Qe);return lt}function clsx(){for(var He,Qe,it=0,lt="";it<arguments.length;)(He=arguments[it++])&&(Qe=r$2(He))&&(lt&&(lt+=" "),lt+=Qe);return lt}function isNum(He){return typeof He=="number"&&!isNaN(He)}function isBool(He){return typeof He=="boolean"}function isStr(He){return typeof He=="string"}function isFn(He){return typeof He=="function"}function parseClassName(He){return isStr(He)||isFn(He)?He:null}function isToastIdValid(He){return He!=null}function getAutoCloseDelay(He,Qe){return He===!1||isNum(He)&&He>0?He:Qe}function canBeRendered(He){return reactExports.isValidElement(He)||isStr(He)||isFn(He)||isNum(He)}const POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"};function collapseToast(He,Qe,it){it===void 0&&(it=300);const{scrollHeight:lt,style:ut}=He;requestAnimationFrame(()=>{ut.minHeight="initial",ut.height=lt+"px",ut.transition="all "+it+"ms",requestAnimationFrame(()=>{ut.height="0",ut.padding="0",ut.margin="0",setTimeout(Qe,it)})})}function cssTransition(He){let{enter:Qe,exit:it,appendPosition:lt=!1,collapse:ut=!0,collapseDuration:dt=300}=He;return function(ft){let{children:vt,position:kt,preventExitTransition:St,done:Tt,nodeRef:Mt,isIn:Nt}=ft;const At=lt?Qe+"--"+kt:Qe,$t=lt?it+"--"+kt:it,Dt=reactExports.useRef(0);return reactExports.useLayoutEffect(()=>{const Ft=Mt.current,Bt=At.split(" "),Ot=Wt=>{Wt.target===Mt.current&&(Ft.dispatchEvent(new Event("d")),Ft.removeEventListener("animationend",Ot),Ft.removeEventListener("animationcancel",Ot),Dt.current===0&&Wt.type!=="animationcancel"&&Ft.classList.remove(...Bt))};(()=>{Ft.classList.add(...Bt),Ft.addEventListener("animationend",Ot),Ft.addEventListener("animationcancel",Ot)})()},[]),reactExports.useEffect(()=>{const Ft=Mt.current,Bt=()=>{Ft.removeEventListener("animationend",Bt),ut?collapseToast(Ft,Tt,dt):Tt()};Nt||(St?Bt():(()=>{Dt.current=1,Ft.className+=" "+$t,Ft.addEventListener("animationend",Bt)})())},[Nt]),React.createElement(React.Fragment,null,vt)}}function toToastItem(He,Qe){return{content:He.content,containerId:He.props.containerId,id:He.props.toastId,theme:He.props.theme,type:He.props.type,data:He.props.data||{},isLoading:He.props.isLoading,icon:He.props.icon,status:Qe}}const eventManager={list:new Map,emitQueue:new Map,on(He,Qe){return this.list.has(He)||this.list.set(He,[]),this.list.get(He).push(Qe),this},off(He,Qe){if(Qe){const it=this.list.get(He).filter(lt=>lt!==Qe);return this.list.set(He,it),this}return this.list.delete(He),this},cancelEmit(He){const Qe=this.emitQueue.get(He);return Qe&&(Qe.forEach(clearTimeout),this.emitQueue.delete(He)),this},emit(He){this.list.has(He)&&this.list.get(He).forEach(Qe=>{const it=setTimeout(()=>{Qe(...[].slice.call(arguments,1))},0);this.emitQueue.has(He)||this.emitQueue.set(He,[]),this.emitQueue.get(He).push(it)})}},Svg=He=>{let{theme:Qe,type:it,...lt}=He;return React.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:Qe==="colored"?"currentColor":"var(--toastify-icon-color-"+it+")",...lt})};function Warning(He){return React.createElement(Svg,{...He},React.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function Info(He){return React.createElement(Svg,{...He},React.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function Success(He){return React.createElement(Svg,{...He},React.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function Error$1(He){return React.createElement(Svg,{...He},React.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function Spinner(){return React.createElement("div",{className:"Toastify__spinner"})}const Icons={info:Info,warning:Warning,success:Success,error:Error$1,spinner:Spinner},maybeIcon=He=>He in Icons;function getIcon$1(He){let{theme:Qe,type:it,isLoading:lt,icon:ut}=He,dt=null;const xt={theme:Qe,type:it};return ut===!1||(isFn(ut)?dt=ut(xt):reactExports.isValidElement(ut)?dt=reactExports.cloneElement(ut,xt):isStr(ut)||isNum(ut)?dt=ut:lt?dt=Icons.spinner():maybeIcon(it)&&(dt=Icons[it](xt))),dt}function useToastContainer(He){const[,Qe]=reactExports.useReducer($t=>$t+1,0),[it,lt]=reactExports.useState([]),ut=reactExports.useRef(null),dt=reactExports.useRef(new Map).current,xt=$t=>it.indexOf($t)!==-1,ft=reactExports.useRef({toastKey:1,displayedToast:0,count:0,queue:[],props:He,containerId:null,isToastActive:xt,getToast:$t=>dt.get($t)}).current;reactExports.useEffect(()=>(ft.containerId=He.containerId,eventManager.cancelEmit(3).on(0,Mt).on(1,$t=>ut.current&&kt($t)).on(5,vt).emit(2,ft),()=>{dt.clear(),eventManager.emit(3,ft)}),[]),reactExports.useEffect(()=>{ft.props=He,ft.isToastActive=xt,ft.displayedToast=it.length});function vt($t){let{containerId:Dt}=$t;const{limit:Ft}=ft.props;Ft&&(!Dt||ft.containerId===Dt)&&(ft.count-=ft.queue.length,ft.queue=[])}function kt($t){lt(Dt=>isToastIdValid($t)?Dt.filter(Ft=>Ft!==$t):[])}function St(){const{toastContent:$t,toastProps:Dt,staleId:Ft}=ft.queue.shift();Nt($t,Dt,Ft)}function Tt($t){return!ut.current||ft.props.enableMultiContainer&&$t.containerId!==ft.props.containerId||dt.has($t.toastId)&&$t.updateId==null}function Mt($t,Dt){let{delay:Ft,staleId:Bt,...Ot}=Dt;if(!canBeRendered($t)||Tt(Ot))return;const{toastId:Qt,updateId:Wt,data:Xt}=Ot,{props:Kt}=ft,Jt=()=>kt(Qt),hr=Wt==null;hr&&ft.count++;const xr={toastId:Qt,updateId:Wt,data:Xt,containerId:Ot.containerId,isLoading:Ot.isLoading,theme:Ot.theme||Kt.theme,icon:Ot.icon!=null?Ot.icon:Kt.icon,isIn:!1,key:Ot.key||ft.toastKey++,type:Ot.type,closeToast:Jt,closeButton:Ot.closeButton,rtl:Kt.rtl,position:Ot.position||Kt.position,transition:Ot.transition||Kt.transition,className:parseClassName(Ot.className||Kt.toastClassName),bodyClassName:parseClassName(Ot.bodyClassName||Kt.bodyClassName),style:Ot.style||Kt.toastStyle,bodyStyle:Ot.bodyStyle||Kt.bodyStyle,onClick:Ot.onClick||Kt.onClick,pauseOnHover:isBool(Ot.pauseOnHover)?Ot.pauseOnHover:Kt.pauseOnHover,pauseOnFocusLoss:isBool(Ot.pauseOnFocusLoss)?Ot.pauseOnFocusLoss:Kt.pauseOnFocusLoss,draggable:isBool(Ot.draggable)?Ot.draggable:Kt.draggable,draggablePercent:Ot.draggablePercent||Kt.draggablePercent,draggableDirection:Ot.draggableDirection||Kt.draggableDirection,closeOnClick:isBool(Ot.closeOnClick)?Ot.closeOnClick:Kt.closeOnClick,progressClassName:parseClassName(Ot.progressClassName||Kt.progressClassName),progressStyle:Ot.progressStyle||Kt.progressStyle,autoClose:Ot.isLoading?!1:getAutoCloseDelay(Ot.autoClose,Kt.autoClose),hideProgressBar:isBool(Ot.hideProgressBar)?Ot.hideProgressBar:Kt.hideProgressBar,progress:Ot.progress,role:Ot.role||Kt.role,deleteToast(){const br=toToastItem(dt.get(Qt),"removed");dt.delete(Qt),eventManager.emit(4,br);const vr=ft.queue.length;if(ft.count=isToastIdValid(Qt)?ft.count-1:ft.count-ft.displayedToast,ft.count<0&&(ft.count=0),vr>0){const yr=isToastIdValid(Qt)?1:ft.props.limit;if(vr===1||yr===1)ft.displayedToast++,St();else{const Cr=yr>vr?vr:yr;ft.displayedToast=Cr;for(let Rr=0;Rr<Cr;Rr++)St()}}else Qe()}};xr.iconOut=getIcon$1(xr),isFn(Ot.onOpen)&&(xr.onOpen=Ot.onOpen),isFn(Ot.onClose)&&(xr.onClose=Ot.onClose),xr.closeButton=Kt.closeButton,Ot.closeButton===!1||canBeRendered(Ot.closeButton)?xr.closeButton=Ot.closeButton:Ot.closeButton===!0&&(xr.closeButton=canBeRendered(Kt.closeButton)?Kt.closeButton:!0);let gr=$t;reactExports.isValidElement($t)&&!isStr($t.type)?gr=reactExports.cloneElement($t,{closeToast:Jt,toastProps:xr,data:Xt}):isFn($t)&&(gr=$t({closeToast:Jt,toastProps:xr,data:Xt})),Kt.limit&&Kt.limit>0&&ft.count>Kt.limit&&hr?ft.queue.push({toastContent:gr,toastProps:xr,staleId:Bt}):isNum(Ft)?setTimeout(()=>{Nt(gr,xr,Bt)},Ft):Nt(gr,xr,Bt)}function Nt($t,Dt,Ft){const{toastId:Bt}=Dt;Ft&&dt.delete(Ft);const Ot={content:$t,props:Dt};dt.set(Bt,Ot),lt(Qt=>[...Qt,Bt].filter(Wt=>Wt!==Ft)),eventManager.emit(4,toToastItem(Ot,Ot.props.updateId==null?"added":"updated"))}function At($t){const Dt=new Map,Ft=Array.from(dt.values());return He.newestOnTop&&Ft.reverse(),Ft.forEach(Bt=>{const{position:Ot}=Bt.props;Dt.has(Ot)||Dt.set(Ot,[]),Dt.get(Ot).push(Bt)}),Array.from(Dt,Bt=>$t(Bt[0],Bt[1]))}return{getToastToRender:At,containerRef:ut,isToastActive:xt}}function getX(He){return He.targetTouches&&He.targetTouches.length>=1?He.targetTouches[0].clientX:He.clientX}function getY(He){return He.targetTouches&&He.targetTouches.length>=1?He.targetTouches[0].clientY:He.clientY}function useToast(He){const[Qe,it]=reactExports.useState(!1),[lt,ut]=reactExports.useState(!1),dt=reactExports.useRef(null),xt=reactExports.useRef({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,ft=reactExports.useRef(He),{autoClose:vt,pauseOnHover:kt,closeToast:St,onClick:Tt,closeOnClick:Mt}=He;reactExports.useEffect(()=>{ft.current=He}),reactExports.useEffect(()=>(dt.current&&dt.current.addEventListener("d",$t,{once:!0}),isFn(He.onOpen)&&He.onOpen(reactExports.isValidElement(He.children)&&He.children.props),()=>{const Jt=ft.current;isFn(Jt.onClose)&&Jt.onClose(reactExports.isValidElement(Jt.children)&&Jt.children.props)}),[]),reactExports.useEffect(()=>(He.pauseOnFocusLoss&&Ft(),()=>{He.pauseOnFocusLoss&&Bt()}),[He.pauseOnFocusLoss]);function Nt(Jt){if(He.draggable){Ot();const hr=dt.current;xt.canCloseOnClick=!0,xt.canDrag=!0,xt.boundingRect=hr.getBoundingClientRect(),hr.style.transition="",xt.x=getX(Jt.nativeEvent),xt.y=getY(Jt.nativeEvent),He.draggableDirection==="x"?(xt.start=xt.x,xt.removalDistance=hr.offsetWidth*(He.draggablePercent/100)):(xt.start=xt.y,xt.removalDistance=hr.offsetHeight*(He.draggablePercent===80?He.draggablePercent*1.5:He.draggablePercent/100))}}function At(){if(xt.boundingRect){const{top:Jt,bottom:hr,left:xr,right:gr}=xt.boundingRect;He.pauseOnHover&&xt.x>=xr&&xt.x<=gr&&xt.y>=Jt&&xt.y<=hr?Dt():$t()}}function $t(){it(!0)}function Dt(){it(!1)}function Ft(){document.hasFocus()||Dt(),window.addEventListener("focus",$t),window.addEventListener("blur",Dt)}function Bt(){window.removeEventListener("focus",$t),window.removeEventListener("blur",Dt)}function Ot(){xt.didMove=!1,document.addEventListener("mousemove",Wt),document.addEventListener("mouseup",Xt),document.addEventListener("touchmove",Wt),document.addEventListener("touchend",Xt)}function Qt(){document.removeEventListener("mousemove",Wt),document.removeEventListener("mouseup",Xt),document.removeEventListener("touchmove",Wt),document.removeEventListener("touchend",Xt)}function Wt(Jt){const hr=dt.current;xt.canDrag&&hr&&(xt.didMove=!0,Qe&&Dt(),xt.x=getX(Jt),xt.y=getY(Jt),He.draggableDirection==="x"?xt.delta=xt.x-xt.start:xt.delta=xt.y-xt.start,xt.start!==xt.x&&(xt.canCloseOnClick=!1),hr.style.transform="translate"+He.draggableDirection+"("+xt.delta+"px)",hr.style.opacity=""+(1-Math.abs(xt.delta/xt.removalDistance)))}function Xt(){Qt();const Jt=dt.current;if(xt.canDrag&&xt.didMove&&Jt){if(xt.canDrag=!1,Math.abs(xt.delta)>xt.removalDistance){ut(!0),He.closeToast();return}Jt.style.transition="transform 0.2s, opacity 0.2s",Jt.style.transform="translate"+He.draggableDirection+"(0)",Jt.style.opacity="1"}}const Kt={onMouseDown:Nt,onTouchStart:Nt,onMouseUp:At,onTouchEnd:At};return vt&&kt&&(Kt.onMouseEnter=Dt,Kt.onMouseLeave=$t),Mt&&(Kt.onClick=Jt=>{Tt&&Tt(Jt),xt.canCloseOnClick&&St()}),{playToast:$t,pauseToast:Dt,isRunning:Qe,preventExitTransition:lt,toastRef:dt,eventHandlers:Kt}}function CloseButton(He){let{closeToast:Qe,theme:it,ariaLabel:lt="close"}=He;return React.createElement("button",{className:"Toastify__close-button Toastify__close-button--"+it,type:"button",onClick:ut=>{ut.stopPropagation(),Qe(ut)},"aria-label":lt},React.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},React.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function ProgressBar(He){let{delay:Qe,isRunning:it,closeToast:lt,type:ut,hide:dt,className:xt,style:ft,controlledProgress:vt,progress:kt,rtl:St,isIn:Tt,theme:Mt}=He;const Nt={...ft,animationDuration:Qe+"ms",animationPlayState:it?"running":"paused",opacity:dt?0:1};vt&&(Nt.transform="scaleX("+kt+")");const At=clsx("Toastify__progress-bar",vt?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated","Toastify__progress-bar-theme--"+Mt,"Toastify__progress-bar--"+ut,{"Toastify__progress-bar--rtl":St}),$t=isFn(xt)?xt({rtl:St,type:ut,defaultClassName:At}):clsx(At,xt),Dt={[vt&&kt>=1?"onTransitionEnd":"onAnimationEnd"]:vt&&kt<1?null:()=>{Tt&&lt()}};return React.createElement("div",{role:"progressbar","aria-hidden":dt?"true":"false","aria-label":"notification timer",className:$t,style:Nt,...Dt})}ProgressBar.defaultProps={type:TYPE.DEFAULT,hide:!1};const Toast=He=>{const{isRunning:Qe,preventExitTransition:it,toastRef:lt,eventHandlers:ut}=useToast(He),{closeButton:dt,children:xt,autoClose:ft,onClick:vt,type:kt,hideProgressBar:St,closeToast:Tt,transition:Mt,position:Nt,className:At,style:$t,bodyClassName:Dt,bodyStyle:Ft,progressClassName:Bt,progressStyle:Ot,updateId:Qt,role:Wt,progress:Xt,rtl:Kt,toastId:Jt,deleteToast:hr,isIn:xr,isLoading:gr,iconOut:br,theme:vr}=He,yr=clsx("Toastify__toast","Toastify__toast-theme--"+vr,"Toastify__toast--"+kt,{"Toastify__toast--rtl":Kt}),Cr=isFn(At)?At({rtl:Kt,position:Nt,type:kt,defaultClassName:yr}):clsx(yr,At),Rr=!!Xt,Ir={closeToast:Tt,type:kt,theme:vr};let Tr=null;return dt===!1||(isFn(dt)?Tr=dt(Ir):React.isValidElement(dt)?Tr=React.cloneElement(dt,Ir):Tr=CloseButton(Ir)),React.createElement(Mt,{isIn:xr,done:hr,position:Nt,preventExitTransition:it,nodeRef:lt},React.createElement("div",{id:Jt,onClick:vt,className:Cr,...ut,style:$t,ref:lt},React.createElement("div",{...xr&&{role:Wt},className:isFn(Dt)?Dt({type:kt}):clsx("Toastify__toast-body",Dt),style:Ft},br!=null&&React.createElement("div",{className:clsx("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!gr})},br),React.createElement("div",null,xt)),Tr,(ft||Rr)&&React.createElement(ProgressBar,{...Qt&&!Rr?{key:"pb-"+Qt}:{},rtl:Kt,theme:vr,delay:ft,isRunning:Qe,isIn:xr,closeToast:Tt,hide:St,type:kt,style:Ot,className:Bt,controlledProgress:Rr,progress:Xt})))},Bounce=cssTransition({enter:"Toastify--animate Toastify__bounce-enter",exit:"Toastify--animate Toastify__bounce-exit",appendPosition:!0}),ToastContainer=reactExports.forwardRef((He,Qe)=>{const{getToastToRender:it,containerRef:lt,isToastActive:ut}=useToastContainer(He),{className:dt,style:xt,rtl:ft,containerId:vt}=He;function kt(St){const Tt=clsx("Toastify__toast-container","Toastify__toast-container--"+St,{"Toastify__toast-container--rtl":ft});return isFn(dt)?dt({position:St,rtl:ft,defaultClassName:Tt}):clsx(Tt,parseClassName(dt))}return reactExports.useEffect(()=>{Qe&&(Qe.current=lt.current)},[]),React.createElement("div",{ref:lt,className:"Toastify",id:vt},it((St,Tt)=>{const Mt=Tt.length?{...xt}:{...xt,pointerEvents:"none"};return React.createElement("div",{className:kt(St),style:Mt,key:"container-"+St},Tt.map((Nt,At)=>{let{content:$t,props:Dt}=Nt;return React.createElement(Toast,{...Dt,isIn:ut(Dt.toastId),style:{...Dt.style,"--nth":At+1,"--len":Tt.length},key:"toast-"+Dt.key},$t)}))}))});ToastContainer.displayName="ToastContainer";ToastContainer.defaultProps={position:POSITION.TOP_RIGHT,transition:Bounce,rtl:!1,autoClose:5e3,hideProgressBar:!1,closeButton:CloseButton,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,newestOnTop:!1,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let containers=new Map,latestInstance,queue$2=[];function getToast(He,Qe){let{containerId:it}=Qe;const lt=containers.get(it||latestInstance);return lt?lt.getToast(He):null}function generateToastId(){return Math.random().toString(36).substring(2,9)}function getToastId(He){return He&&(isStr(He.toastId)||isNum(He.toastId))?He.toastId:generateToastId()}function dispatchToast(He,Qe){return containers.size>0?eventManager.emit(0,He,Qe):queue$2.push({content:He,options:Qe}),Qe.toastId}function mergeOptions(He,Qe){return{...Qe,type:Qe&&Qe.type||He,toastId:getToastId(Qe)}}function createToastByType(He){return(Qe,it)=>dispatchToast(Qe,mergeOptions(He,it))}function toast(He,Qe){return dispatchToast(He,mergeOptions(TYPE.DEFAULT,Qe))}toast.loading=(He,Qe)=>dispatchToast(He,mergeOptions(TYPE.DEFAULT,{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...Qe}));function handlePromise$1(He,Qe,it){let{pending:lt,error:ut,success:dt}=Qe,xt;lt&&(xt=isStr(lt)?toast.loading(lt,it):toast.loading(lt.render,{...it,...lt}));const ft={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null,delay:100},vt=(St,Tt,Mt)=>{if(Tt==null){toast.dismiss(xt);return}const Nt={type:St,...ft,...it,data:Mt},At=isStr(Tt)?{render:Tt}:Tt;return xt?toast.update(xt,{...Nt,...At}):toast(At.render,{...Nt,...At}),Mt},kt=isFn(He)?He():He;return kt.then(St=>vt("success",dt,St)).catch(St=>vt("error",ut,St)),kt}toast.promise=handlePromise$1;toast.success=createToastByType(TYPE.SUCCESS);toast.info=createToastByType(TYPE.INFO);toast.error=createToastByType(TYPE.ERROR);toast.warning=createToastByType(TYPE.WARNING);toast.warn=toast.warning;toast.dark=(He,Qe)=>dispatchToast(He,mergeOptions(TYPE.DEFAULT,{theme:"dark",...Qe}));toast.dismiss=He=>{containers.size>0?eventManager.emit(1,He):queue$2=queue$2.filter(Qe=>isToastIdValid(He)&&Qe.options.toastId!==He)};toast.clearWaitingQueue=function(He){return He===void 0&&(He={}),eventManager.emit(5,He)};toast.isActive=He=>{let Qe=!1;return containers.forEach(it=>{it.isToastActive&&it.isToastActive(He)&&(Qe=!0)}),Qe};toast.update=function(He,Qe){Qe===void 0&&(Qe={}),setTimeout(()=>{const it=getToast(He,Qe);if(it){const{props:lt,content:ut}=it,dt={...lt,...Qe,toastId:Qe.toastId||He,updateId:generateToastId()};dt.toastId!==He&&(dt.staleId=He);const xt=dt.render||ut;delete dt.render,dispatchToast(xt,dt)}},0)};toast.done=He=>{toast.update(He,{progress:1})};toast.onChange=He=>(eventManager.on(4,He),()=>{eventManager.off(4,He)});toast.POSITION=POSITION;toast.TYPE=TYPE;eventManager.on(2,He=>{latestInstance=He.containerId||He,containers.set(latestInstance,He),queue$2.forEach(Qe=>{eventManager.emit(0,Qe.content,Qe.options)}),queue$2=[]}).on(3,He=>{containers.delete(He.containerId||He),containers.size===0&&eventManager.off(0).off(1).off(5)});var duration={exports:{}};(function(He,Qe){(function(it,lt){He.exports=lt()})(commonjsGlobal,function(){var it,lt,ut=1e3,dt=6e4,xt=36e5,ft=864e5,vt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,kt=31536e6,St=2592e6,Tt=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,Mt={years:kt,months:St,days:ft,hours:xt,minutes:dt,seconds:ut,milliseconds:1,weeks:6048e5},Nt=function(Wt){return Wt instanceof Qt},At=function(Wt,Xt,Kt){return new Qt(Wt,Kt,Xt.$l)},$t=function(Wt){return lt.p(Wt)+"s"},Dt=function(Wt){return Wt<0},Ft=function(Wt){return Dt(Wt)?Math.ceil(Wt):Math.floor(Wt)},Bt=function(Wt){return Math.abs(Wt)},Ot=function(Wt,Xt){return Wt?Dt(Wt)?{negative:!0,format:""+Bt(Wt)+Xt}:{negative:!1,format:""+Wt+Xt}:{negative:!1,format:""}},Qt=function(){function Wt(Kt,Jt,hr){var xr=this;if(this.$d={},this.$l=hr,Kt===void 0&&(this.$ms=0,this.parseFromMilliseconds()),Jt)return At(Kt*Mt[$t(Jt)],this);if(typeof Kt=="number")return this.$ms=Kt,this.parseFromMilliseconds(),this;if(typeof Kt=="object")return Object.keys(Kt).forEach(function(vr){xr.$d[$t(vr)]=Kt[vr]}),this.calMilliseconds(),this;if(typeof Kt=="string"){var gr=Kt.match(Tt);if(gr){var br=gr.slice(2).map(function(vr){return vr!=null?Number(vr):0});return this.$d.years=br[0],this.$d.months=br[1],this.$d.weeks=br[2],this.$d.days=br[3],this.$d.hours=br[4],this.$d.minutes=br[5],this.$d.seconds=br[6],this.calMilliseconds(),this}}return this}var Xt=Wt.prototype;return Xt.calMilliseconds=function(){var Kt=this;this.$ms=Object.keys(this.$d).reduce(function(Jt,hr){return Jt+(Kt.$d[hr]||0)*Mt[hr]},0)},Xt.parseFromMilliseconds=function(){var Kt=this.$ms;this.$d.years=Ft(Kt/kt),Kt%=kt,this.$d.months=Ft(Kt/St),Kt%=St,this.$d.days=Ft(Kt/ft),Kt%=ft,this.$d.hours=Ft(Kt/xt),Kt%=xt,this.$d.minutes=Ft(Kt/dt),Kt%=dt,this.$d.seconds=Ft(Kt/ut),Kt%=ut,this.$d.milliseconds=Kt},Xt.toISOString=function(){var Kt=Ot(this.$d.years,"Y"),Jt=Ot(this.$d.months,"M"),hr=+this.$d.days||0;this.$d.weeks&&(hr+=7*this.$d.weeks);var xr=Ot(hr,"D"),gr=Ot(this.$d.hours,"H"),br=Ot(this.$d.minutes,"M"),vr=this.$d.seconds||0;this.$d.milliseconds&&(vr+=this.$d.milliseconds/1e3);var yr=Ot(vr,"S"),Cr=Kt.negative||Jt.negative||xr.negative||gr.negative||br.negative||yr.negative,Rr=gr.format||br.format||yr.format?"T":"",Ir=(Cr?"-":"")+"P"+Kt.format+Jt.format+xr.format+Rr+gr.format+br.format+yr.format;return Ir==="P"||Ir==="-P"?"P0D":Ir},Xt.toJSON=function(){return this.toISOString()},Xt.format=function(Kt){var Jt=Kt||"YYYY-MM-DDTHH:mm:ss",hr={Y:this.$d.years,YY:lt.s(this.$d.years,2,"0"),YYYY:lt.s(this.$d.years,4,"0"),M:this.$d.months,MM:lt.s(this.$d.months,2,"0"),D:this.$d.days,DD:lt.s(this.$d.days,2,"0"),H:this.$d.hours,HH:lt.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:lt.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:lt.s(this.$d.seconds,2,"0"),SSS:lt.s(this.$d.milliseconds,3,"0")};return Jt.replace(vt,function(xr,gr){return gr||String(hr[xr])})},Xt.as=function(Kt){return this.$ms/Mt[$t(Kt)]},Xt.get=function(Kt){var Jt=this.$ms,hr=$t(Kt);return hr==="milliseconds"?Jt%=1e3:Jt=hr==="weeks"?Ft(Jt/Mt[hr]):this.$d[hr],Jt===0?0:Jt},Xt.add=function(Kt,Jt,hr){var xr;return xr=Jt?Kt*Mt[$t(Jt)]:Nt(Kt)?Kt.$ms:At(Kt,this).$ms,At(this.$ms+xr*(hr?-1:1),this)},Xt.subtract=function(Kt,Jt){return this.add(Kt,Jt,!0)},Xt.locale=function(Kt){var Jt=this.clone();return Jt.$l=Kt,Jt},Xt.clone=function(){return At(this.$ms,this)},Xt.humanize=function(Kt){return it().add(this.$ms,"ms").locale(this.$l).fromNow(!Kt)},Xt.milliseconds=function(){return this.get("milliseconds")},Xt.asMilliseconds=function(){return this.as("milliseconds")},Xt.seconds=function(){return this.get("seconds")},Xt.asSeconds=function(){return this.as("seconds")},Xt.minutes=function(){return this.get("minutes")},Xt.asMinutes=function(){return this.as("minutes")},Xt.hours=function(){return this.get("hours")},Xt.asHours=function(){return this.as("hours")},Xt.days=function(){return this.get("days")},Xt.asDays=function(){return this.as("days")},Xt.weeks=function(){return this.get("weeks")},Xt.asWeeks=function(){return this.as("weeks")},Xt.months=function(){return this.get("months")},Xt.asMonths=function(){return this.as("months")},Xt.years=function(){return this.get("years")},Xt.asYears=function(){return this.as("years")},Wt}();return function(Wt,Xt,Kt){it=Kt,lt=Kt().$utils(),Kt.duration=function(xr,gr){var br=Kt.locale();return At(xr,{$l:br},gr)},Kt.isDuration=Nt;var Jt=Xt.prototype.add,hr=Xt.prototype.subtract;Xt.prototype.add=function(xr,gr){return Nt(xr)&&(xr=xr.asMilliseconds()),Jt.bind(this)(xr,gr)},Xt.prototype.subtract=function(xr,gr){return Nt(xr)&&(xr=xr.asMilliseconds()),hr.bind(this)(xr,gr)}}})})(duration);var durationExports=duration.exports;const Duration=getDefaultExportFromCjs(durationExports);var isSameOrBefore={exports:{}};(function(He,Qe){(function(it,lt){He.exports=lt()})(commonjsGlobal,function(){return function(it,lt){lt.prototype.isSameOrBefore=function(ut,dt){return this.isSame(ut,dt)||this.isBefore(ut,dt)}}})})(isSameOrBefore);var isSameOrBeforeExports=isSameOrBefore.exports;const IsSameOrBefore=getDefaultExportFromCjs(isSameOrBeforeExports);var relativeTime={exports:{}};(function(He,Qe){(function(it,lt){He.exports=lt()})(commonjsGlobal,function(){return function(it,lt,ut){it=it||{};var dt=lt.prototype,xt={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ft(kt,St,Tt,Mt){return dt.fromToBase(kt,St,Tt,Mt)}ut.en.relativeTime=xt,dt.fromToBase=function(kt,St,Tt,Mt,Nt){for(var At,$t,Dt,Ft=Tt.$locale().relativeTime||xt,Bt=it.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],Ot=Bt.length,Qt=0;Qt<Ot;Qt+=1){var Wt=Bt[Qt];Wt.d&&(At=Mt?ut(kt).diff(Tt,Wt.d,!0):Tt.diff(kt,Wt.d,!0));var Xt=(it.rounding||Math.round)(Math.abs(At));if(Dt=At>0,Xt<=Wt.r||!Wt.r){Xt<=1&&Qt>0&&(Wt=Bt[Qt-1]);var Kt=Ft[Wt.l];Nt&&(Xt=Nt(""+Xt)),$t=typeof Kt=="string"?Kt.replace("%d",Xt):Kt(Xt,St,Wt.l,Dt);break}}if(St)return $t;var Jt=Dt?Ft.future:Ft.past;return typeof Jt=="function"?Jt($t):Jt.replace("%s",$t)},dt.to=function(kt,St){return ft(kt,St,this,!0)},dt.from=function(kt,St){return ft(kt,St,this)};var vt=function(kt){return kt.$u?ut.utc():ut()};dt.toNow=function(kt){return this.to(vt(this),kt)},dt.fromNow=function(kt){return this.from(vt(this),kt)}}})})(relativeTime);var relativeTimeExports=relativeTime.exports;const RelativeTime=getDefaultExportFromCjs(relativeTimeExports);var utc={exports:{}};(function(He,Qe){(function(it,lt){He.exports=lt()})(commonjsGlobal,function(){var it="minute",lt=/[+-]\d\d(?::?\d\d)?/g,ut=/([+-]|\d\d)/g;return function(dt,xt,ft){var vt=xt.prototype;ft.utc=function($t){var Dt={date:$t,utc:!0,args:arguments};return new xt(Dt)},vt.utc=function($t){var Dt=ft(this.toDate(),{locale:this.$L,utc:!0});return $t?Dt.add(this.utcOffset(),it):Dt},vt.local=function(){return ft(this.toDate(),{locale:this.$L,utc:!1})};var kt=vt.parse;vt.parse=function($t){$t.utc&&(this.$u=!0),this.$utils().u($t.$offset)||(this.$offset=$t.$offset),kt.call(this,$t)};var St=vt.init;vt.init=function(){if(this.$u){var $t=this.$d;this.$y=$t.getUTCFullYear(),this.$M=$t.getUTCMonth(),this.$D=$t.getUTCDate(),this.$W=$t.getUTCDay(),this.$H=$t.getUTCHours(),this.$m=$t.getUTCMinutes(),this.$s=$t.getUTCSeconds(),this.$ms=$t.getUTCMilliseconds()}else St.call(this)};var Tt=vt.utcOffset;vt.utcOffset=function($t,Dt){var Ft=this.$utils().u;if(Ft($t))return this.$u?0:Ft(this.$offset)?Tt.call(this):this.$offset;if(typeof $t=="string"&&($t=function(Wt){Wt===void 0&&(Wt="");var Xt=Wt.match(lt);if(!Xt)return null;var Kt=(""+Xt[0]).match(ut)||["-",0,0],Jt=Kt[0],hr=60*+Kt[1]+ +Kt[2];return hr===0?0:Jt==="+"?hr:-hr}($t),$t===null))return this;var Bt=Math.abs($t)<=16?60*$t:$t,Ot=this;if(Dt)return Ot.$offset=Bt,Ot.$u=$t===0,Ot;if($t!==0){var Qt=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(Ot=this.local().add(Bt+Qt,it)).$offset=Bt,Ot.$x.$localOffset=Qt}else Ot=this.utc();return Ot};var Mt=vt.format;vt.format=function($t){var Dt=$t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return Mt.call(this,Dt)},vt.valueOf=function(){var $t=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*$t},vt.isUTC=function(){return!!this.$u},vt.toISOString=function(){return this.toDate().toISOString()},vt.toString=function(){return this.toDate().toUTCString()};var Nt=vt.toDate;vt.toDate=function($t){return $t==="s"&&this.$offset?ft(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():Nt.call(this)};var At=vt.diff;vt.diff=function($t,Dt,Ft){if($t&&this.$u===$t.$u)return At.call(this,$t,Dt,Ft);var Bt=this.local(),Ot=ft($t).local();return At.call(Bt,Ot,Dt,Ft)}}})})(utc);var utcExports=utc.exports;const Utc=getDefaultExportFromCjs(utcExports);defaultDayjs.extend(localizedFormatPlugin);defaultDayjs.extend(RelativeTime);defaultDayjs.extend(Duration);defaultDayjs.extend(Utc);defaultDayjs.extend(isBetweenPlugin);defaultDayjs.extend(IsSameOrBefore);const formatTime=He=>{if(!He)return;const Qe=defaultDayjs(He);return Qe.isAfter(defaultDayjs().subtract(1,"d"))?Qe.fromNow():Qe.format("lll")};function createTimeRange(He,Qe){const it=defaultDayjs();switch(He){case"today-exact":return{gt:it.startOf("day").toISOString()};case"today":return{gt:it.subtract(1,"day").startOf("day").toISOString()};case"this-week":return{gt:it.subtract(1,"week").startOf("day").toISOString()};case"this-month":return{gt:it.subtract(1,"month").startOf("day").toISOString()};default:return}}const localeData={de:()=>__vitePreload(()=>import("./de-BEYUbezi.js").then(He=>He.d),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url),es:()=>__vitePreload(()=>import("./es-Bm0E-1vI.js").then(He=>He.e),__vite__mapDeps([7,1,2,3,4,5,6]),import.meta.url),fr:()=>__vitePreload(()=>import("./fr-Br475m_v.js").then(He=>He.f),__vite__mapDeps([8,1,2,3,4,5,6]),import.meta.url),id:()=>__vitePreload(()=>import("./id-vKprXaVD.js").then(He=>He.i),__vite__mapDeps([9,1,2,3,4,5,6]),import.meta.url),it:()=>__vitePreload(()=>import("./it-BsCVgUKM.js").then(He=>He.i),__vite__mapDeps([10,1,2,3,4,5,6]),import.meta.url),ja:()=>__vitePreload(()=>import("./ja-BooSVADZ.js").then(He=>He.j),__vite__mapDeps([11,1,2,3,4,5,6]),import.meta.url),kr:()=>__vitePreload(()=>import("./ko-D9gPkKta.js").then(He=>He.k),__vite__mapDeps([12,1,2,3,4,5,6]),import.meta.url),ms:()=>__vitePreload(()=>import("./ms-kIPHjXgu.js").then(He=>He.m),__vite__mapDeps([13,1,2,3,4,5,6]),import.meta.url),pl:()=>__vitePreload(()=>import("./pl-C_avfaHn.js").then(He=>He.p),__vite__mapDeps([14,1,2,3,4,5,6]),import.meta.url),pt:()=>__vitePreload(()=>import("./pt-Diu13Hj0.js").then(He=>He.p),__vite__mapDeps([15,1,2,3,4,5,6]),import.meta.url),th:()=>__vitePreload(()=>import("./th-ahf7q4rV.js").then(He=>He.t),__vite__mapDeps([16,1,2,3,4,5,6]),import.meta.url),tr:()=>__vitePreload(()=>import("./tr-wdUGYCUV.js").then(He=>He.t),__vite__mapDeps([17,1,2,3,4,5,6]),import.meta.url),uk:()=>__vitePreload(()=>import("./uk-EPeFLJ4B.js").then(He=>He.u),__vite__mapDeps([18,1,2,3,4,5,6]),import.meta.url),vi:()=>__vitePreload(()=>import("./vi-nWs4tal8.js").then(He=>He.v),__vite__mapDeps([19,1,2,3,4,5,6]),import.meta.url),zh:()=>__vitePreload(()=>import("./zh-CH-qxfqT.js").then(He=>He.z),__vite__mapDeps([20,1,2,3,4,5,6]),import.meta.url)},DayjsLocaleEffectApplier=()=>{const{i18n:He}=useTranslation(),Qe=He.language;return reactExports.useEffect(()=>{Qe in localeData?localeData[Qe]().then(({default:it})=>defaultDayjs.locale(it)):defaultDayjs.locale("en")},[Qe]),null};var shim={exports:{}},useSyncExternalStoreShim_production_min={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e$1=reactExports;function h$1(He,Qe){return He===Qe&&(He!==0||1/He===1/Qe)||He!==He&&Qe!==Qe}var k$3=typeof Object.is=="function"?Object.is:h$1,l$4=e$1.useState,m$3=e$1.useEffect,n$1=e$1.useLayoutEffect,p$3=e$1.useDebugValue;function q$4(He,Qe){var it=Qe(),lt=l$4({inst:{value:it,getSnapshot:Qe}}),ut=lt[0].inst,dt=lt[1];return n$1(function(){ut.value=it,ut.getSnapshot=Qe,r$1(ut)&&dt({inst:ut})},[He,it,Qe]),m$3(function(){return r$1(ut)&&dt({inst:ut}),He(function(){r$1(ut)&&dt({inst:ut})})},[He]),p$3(it),it}function r$1(He){var Qe=He.getSnapshot;He=He.value;try{var it=Qe();return!k$3(He,it)}catch{return!0}}function t$1(He,Qe){return Qe()}var u$3=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?t$1:q$4;useSyncExternalStoreShim_production_min.useSyncExternalStore=e$1.useSyncExternalStore!==void 0?e$1.useSyncExternalStore:u$3;shim.exports=useSyncExternalStoreShim_production_min;var shimExports=shim.exports;const noop$5=()=>{},UNDEFINED=noop$5(),OBJECT=Object,isUndefined=He=>He===UNDEFINED,isFunction$2=He=>typeof He=="function",mergeObjects=(He,Qe)=>({...He,...Qe}),isPromiseLike=He=>isFunction$2(He.then),table=new WeakMap;let counter=0;const stableHash=He=>{const Qe=typeof He,it=He&&He.constructor,lt=it==Date;let ut,dt;if(OBJECT(He)===He&&!lt&&it!=RegExp){if(ut=table.get(He),ut)return ut;if(ut=++counter+"~",table.set(He,ut),it==Array){for(ut="@",dt=0;dt<He.length;dt++)ut+=stableHash(He[dt])+",";table.set(He,ut)}if(it==OBJECT){ut="#";const xt=OBJECT.keys(He).sort();for(;!isUndefined(dt=xt.pop());)isUndefined(He[dt])||(ut+=dt+":"+stableHash(He[dt])+",");table.set(He,ut)}}else ut=lt?He.toJSON():Qe=="symbol"?He.toString():Qe=="string"?JSON.stringify(He):""+He;return ut},SWRGlobalState=new WeakMap,EMPTY_CACHE={},INITIAL_CACHE={},STR_UNDEFINED="undefined",isWindowDefined=typeof window!=STR_UNDEFINED,isDocumentDefined=typeof document!=STR_UNDEFINED,hasRequestAnimationFrame=()=>isWindowDefined&&typeof window.requestAnimationFrame!=STR_UNDEFINED,createCacheHelper=(He,Qe)=>{const it=SWRGlobalState.get(He);return[()=>!isUndefined(Qe)&&He.get(Qe)||EMPTY_CACHE,lt=>{if(!isUndefined(Qe)){const ut=He.get(Qe);Qe in INITIAL_CACHE||(INITIAL_CACHE[Qe]=ut),it[5](Qe,mergeObjects(ut,lt),ut||EMPTY_CACHE)}},it[6],()=>!isUndefined(Qe)&&Qe in INITIAL_CACHE?INITIAL_CACHE[Qe]:!isUndefined(Qe)&&He.get(Qe)||EMPTY_CACHE]};let online=!0;const isOnline=()=>online,[onWindowEvent,offWindowEvent]=isWindowDefined&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[noop$5,noop$5],isVisible=()=>{const He=isDocumentDefined&&document.visibilityState;return isUndefined(He)||He!=="hidden"},initFocus=He=>(isDocumentDefined&&document.addEventListener("visibilitychange",He),onWindowEvent("focus",He),()=>{isDocumentDefined&&document.removeEventListener("visibilitychange",He),offWindowEvent("focus",He)}),initReconnect=He=>{const Qe=()=>{online=!0,He()},it=()=>{online=!1};return onWindowEvent("online",Qe),onWindowEvent("offline",it),()=>{offWindowEvent("online",Qe),offWindowEvent("offline",it)}},preset={isOnline,isVisible},defaultConfigOptions={initFocus,initReconnect},IS_REACT_LEGACY=!React.useId,IS_SERVER=!isWindowDefined||"Deno"in window,rAF=He=>hasRequestAnimationFrame()?window.requestAnimationFrame(He):setTimeout(He,1),useIsomorphicLayoutEffect$1=IS_SERVER?reactExports.useEffect:reactExports.useLayoutEffect,navigatorConnection=typeof navigator<"u"&&navigator.connection,slowConnection=!IS_SERVER&&navigatorConnection&&(["slow-2g","2g"].includes(navigatorConnection.effectiveType)||navigatorConnection.saveData),serialize$1=He=>{if(isFunction$2(He))try{He=He()}catch{He=""}const Qe=He;return He=typeof He=="string"?He:(Array.isArray(He)?He.length:He)?stableHash(He):"",[He,Qe]};let __timestamp=0;const getTimestamp=()=>++__timestamp,FOCUS_EVENT=0,RECONNECT_EVENT=1,MUTATE_EVENT=2,ERROR_REVALIDATE_EVENT=3;var events={__proto__:null,ERROR_REVALIDATE_EVENT,FOCUS_EVENT,MUTATE_EVENT,RECONNECT_EVENT};async function internalMutate(...He){const[Qe,it,lt,ut]=He,dt=mergeObjects({populateCache:!0,throwOnError:!0},typeof ut=="boolean"?{revalidate:ut}:ut||{});let xt=dt.populateCache;const ft=dt.rollbackOnError;let vt=dt.optimisticData;const kt=Mt=>typeof ft=="function"?ft(Mt):ft!==!1,St=dt.throwOnError;if(isFunction$2(it)){const Mt=it,Nt=[],At=Qe.keys();for(const $t of At)!/^\$(inf|sub)\$/.test($t)&&Mt(Qe.get($t)._k)&&Nt.push($t);return Promise.all(Nt.map(Tt))}return Tt(it);async function Tt(Mt){const[Nt]=serialize$1(Mt);if(!Nt)return;const[At,$t]=createCacheHelper(Qe,Nt),[Dt,Ft,Bt,Ot]=SWRGlobalState.get(Qe),Qt=()=>{const vr=Dt[Nt];return(isFunction$2(dt.revalidate)?dt.revalidate(At().data,Mt):dt.revalidate!==!1)&&(delete Bt[Nt],delete Ot[Nt],vr&&vr[0])?vr[0](MUTATE_EVENT).then(()=>At().data):At().data};if(He.length<3)return Qt();let Wt=lt,Xt;const Kt=getTimestamp();Ft[Nt]=[Kt,0];const Jt=!isUndefined(vt),hr=At(),xr=hr.data,gr=hr._c,br=isUndefined(gr)?xr:gr;if(Jt&&(vt=isFunction$2(vt)?vt(br,xr):vt,$t({data:vt,_c:br})),isFunction$2(Wt))try{Wt=Wt(br)}catch(vr){Xt=vr}if(Wt&&isPromiseLike(Wt))if(Wt=await Wt.catch(vr=>{Xt=vr}),Kt!==Ft[Nt][0]){if(Xt)throw Xt;return Wt}else Xt&&Jt&&kt(Xt)&&(xt=!0,$t({data:br,_c:UNDEFINED}));if(xt&&!Xt)if(isFunction$2(xt)){const vr=xt(Wt,br);$t({data:vr,error:UNDEFINED,_c:UNDEFINED})}else $t({data:Wt,error:UNDEFINED,_c:UNDEFINED});if(Ft[Nt][1]=getTimestamp(),Promise.resolve(Qt()).then(()=>{$t({_c:UNDEFINED})}),Xt){if(St)throw Xt;return}return Wt}}const revalidateAllKeys=(He,Qe)=>{for(const it in He)He[it][0]&&He[it][0](Qe)},initCache=(He,Qe)=>{if(!SWRGlobalState.has(He)){const it=mergeObjects(defaultConfigOptions,Qe),lt={},ut=internalMutate.bind(UNDEFINED,He);let dt=noop$5;const xt={},ft=(St,Tt)=>{const Mt=xt[St]||[];return xt[St]=Mt,Mt.push(Tt),()=>Mt.splice(Mt.indexOf(Tt),1)},vt=(St,Tt,Mt)=>{He.set(St,Tt);const Nt=xt[St];if(Nt)for(const At of Nt)At(Tt,Mt)},kt=()=>{if(!SWRGlobalState.has(He)&&(SWRGlobalState.set(He,[lt,{},{},{},ut,vt,ft]),!IS_SERVER)){const St=it.initFocus(setTimeout.bind(UNDEFINED,revalidateAllKeys.bind(UNDEFINED,lt,FOCUS_EVENT))),Tt=it.initReconnect(setTimeout.bind(UNDEFINED,revalidateAllKeys.bind(UNDEFINED,lt,RECONNECT_EVENT)));dt=()=>{St&&St(),Tt&&Tt(),SWRGlobalState.delete(He)}}};return kt(),[He,ut,kt,dt]}return[He,SWRGlobalState.get(He)[4]]},onErrorRetry=(He,Qe,it,lt,ut)=>{const dt=it.errorRetryCount,xt=ut.retryCount,ft=~~((Math.random()+.5)*(1<<(xt<8?xt:8)))*it.errorRetryInterval;!isUndefined(dt)&&xt>dt||setTimeout(lt,ft,ut)},compare=(He,Qe)=>stableHash(He)==stableHash(Qe),[cache$2,mutate]=initCache(new Map),defaultConfig=mergeObjects({onLoadingSlow:noop$5,onSuccess:noop$5,onError:noop$5,onErrorRetry,onDiscarded:noop$5,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:slowConnection?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:slowConnection?5e3:3e3,compare,isPaused:()=>!1,cache:cache$2,mutate,fallback:{}},preset),mergeConfigs$1=(He,Qe)=>{const it=mergeObjects(He,Qe);if(Qe){const{use:lt,fallback:ut}=He,{use:dt,fallback:xt}=Qe;lt&&dt&&(it.use=lt.concat(dt)),ut&&xt&&(it.fallback=mergeObjects(ut,xt))}return it},SWRConfigContext=reactExports.createContext({}),SWRConfig$1=He=>{const{value:Qe}=He,it=reactExports.useContext(SWRConfigContext),lt=isFunction$2(Qe),ut=reactExports.useMemo(()=>lt?Qe(it):Qe,[lt,it,Qe]),dt=reactExports.useMemo(()=>lt?ut:mergeConfigs$1(it,ut),[lt,it,ut]),xt=ut&&ut.provider,ft=reactExports.useRef(UNDEFINED);xt&&!ft.current&&(ft.current=initCache(xt(dt.cache||cache$2),ut));const vt=ft.current;return vt&&(dt.cache=vt[0],dt.mutate=vt[1]),useIsomorphicLayoutEffect$1(()=>{if(vt)return vt[2]&&vt[2](),vt[3]},[]),reactExports.createElement(SWRConfigContext.Provider,mergeObjects(He,{value:dt}))},INFINITE_PREFIX="$inf$",enableDevtools=isWindowDefined&&window.__SWR_DEVTOOLS_USE__,use$2=enableDevtools?window.__SWR_DEVTOOLS_USE__:[],setupDevTools=()=>{enableDevtools&&(window.__SWR_DEVTOOLS_REACT__=React)},normalize=He=>isFunction$2(He[1])?[He[0],He[1],He[2]||{}]:[He[0],null,(He[1]===null?He[2]:He[1])||{}],useSWRConfig=()=>mergeObjects(defaultConfig,reactExports.useContext(SWRConfigContext)),middleware=He=>(Qe,it,lt)=>He(Qe,it&&((...dt)=>{const[xt]=serialize$1(Qe),[,,,ft]=SWRGlobalState.get(cache$2);if(xt.startsWith(INFINITE_PREFIX))return it(...dt);const vt=ft[xt];return isUndefined(vt)?it(...dt):(delete ft[xt],vt)}),lt),BUILT_IN_MIDDLEWARE=use$2.concat(middleware),withArgs=He=>function(...it){const lt=useSWRConfig(),[ut,dt,xt]=normalize(it),ft=mergeConfigs$1(lt,xt);let vt=He;const{use:kt}=ft,St=(kt||[]).concat(BUILT_IN_MIDDLEWARE);for(let Tt=St.length;Tt--;)vt=St[Tt](vt);return vt(ut,dt||ft.fetcher||null,ft)},subscribeCallback=(He,Qe,it)=>{const lt=Qe[He]||(Qe[He]=[]);return lt.push(it),()=>{const ut=lt.indexOf(it);ut>=0&&(lt[ut]=lt[lt.length-1],lt.pop())}},withMiddleware=(He,Qe)=>(...it)=>{const[lt,ut,dt]=normalize(it),xt=(dt.use||[]).concat(Qe);return He(lt,ut,{...dt,use:xt})};setupDevTools();const use$1=React.use||(He=>{if(He.status==="pending")throw He;if(He.status==="fulfilled")return He.value;throw He.status==="rejected"?He.reason:(He.status="pending",He.then(Qe=>{He.status="fulfilled",He.value=Qe},Qe=>{He.status="rejected",He.reason=Qe}),He)}),WITH_DEDUPE$1={dedupe:!0},useSWRHandler$1=(He,Qe,it)=>{const{cache:lt,compare:ut,suspense:dt,fallbackData:xt,revalidateOnMount:ft,revalidateIfStale:vt,refreshInterval:kt,refreshWhenHidden:St,refreshWhenOffline:Tt,keepPreviousData:Mt}=it,[Nt,At,$t,Dt]=SWRGlobalState.get(lt),[Ft,Bt]=serialize$1(He),Ot=reactExports.useRef(!1),Qt=reactExports.useRef(!1),Wt=reactExports.useRef(Ft),Xt=reactExports.useRef(Qe),Kt=reactExports.useRef(it),Jt=()=>Kt.current,hr=()=>Jt().isVisible()&&Jt().isOnline(),[xr,gr,br,vr]=createCacheHelper(lt,Ft),yr=reactExports.useRef({}).current,Cr=isUndefined(xt)?it.fallback[Ft]:xt,Rr=(Xr,en)=>{for(const rn in yr){const sn=rn;if(sn==="data"){if(!ut(Xr[sn],en[sn])&&(!isUndefined(Xr[sn])||!ut(Nr,en[sn])))return!1}else if(en[sn]!==Xr[sn])return!1}return!0},Ir=reactExports.useMemo(()=>{const Xr=!Ft||!Qe?!1:isUndefined(ft)?Jt().isPaused()||dt?!1:isUndefined(vt)?!0:vt:ft,en=ss=>{const cs=mergeObjects(ss);return delete cs._k,Xr?{isValidating:!0,isLoading:!0,...cs}:cs},rn=xr(),sn=vr(),os=en(rn),ls=rn===sn?os:en(sn);let rs=os;return[()=>{const ss=en(xr());return Rr(ss,rs)?(rs.data=ss.data,rs.isLoading=ss.isLoading,rs.isValidating=ss.isValidating,rs.error=ss.error,rs):(rs=ss,ss)},()=>ls]},[lt,Ft]),Tr=shimExports.useSyncExternalStore(reactExports.useCallback(Xr=>br(Ft,(en,rn)=>{Rr(rn,en)||Xr()}),[lt,Ft]),Ir[0],Ir[1]),$r=!Ot.current,Zr=Nt[Ft]&&Nt[Ft].length>0,Sr=Tr.data,Dr=isUndefined(Sr)?Cr:Sr,wr=Tr.error,qr=reactExports.useRef(Dr),Nr=Mt?isUndefined(Sr)?qr.current:Sr:Dr,Jr=Zr&&!isUndefined(wr)?!1:$r&&!isUndefined(ft)?ft:Jt().isPaused()?!1:dt?isUndefined(Dr)?!1:vt:isUndefined(Dr)||vt,Qr=!!(Ft&&Qe&&$r&&Jr),Ur=isUndefined(Tr.isValidating)?Qr:Tr.isValidating,nn=isUndefined(Tr.isLoading)?Qr:Tr.isLoading,Cn=reactExports.useCallback(async Xr=>{const en=Xt.current;if(!Ft||!en||Qt.current||Jt().isPaused())return!1;let rn,sn,os=!0;const ls=Xr||{},rs=!$t[Ft]||!ls.dedupe,ss=()=>IS_REACT_LEGACY?!Qt.current&&Ft===Wt.current&&Ot.current:Ft===Wt.current,cs={isValidating:!1,isLoading:!1},ps=()=>{gr(cs)},hs=()=>{const tn=$t[Ft];tn&&tn[1]===sn&&delete $t[Ft]},ns={isValidating:!0};isUndefined(xr().data)&&(ns.isLoading=!0);try{if(rs&&(gr(ns),it.loadingTimeout&&isUndefined(xr().data)&&setTimeout(()=>{os&&ss()&&Jt().onLoadingSlow(Ft,it)},it.loadingTimeout),$t[Ft]=[en(Bt),getTimestamp()]),[rn,sn]=$t[Ft],rn=await rn,rs&&setTimeout(hs,it.dedupingInterval),!$t[Ft]||$t[Ft][1]!==sn)return rs&&ss()&&Jt().onDiscarded(Ft),!1;cs.error=UNDEFINED;const tn=At[Ft];if(!isUndefined(tn)&&(sn<=tn[0]||sn<=tn[1]||tn[1]===0))return ps(),rs&&ss()&&Jt().onDiscarded(Ft),!1;const ts=xr().data;cs.data=ut(ts,rn)?ts:rn,rs&&ss()&&Jt().onSuccess(rn,Ft,it)}catch(tn){hs();const ts=Jt(),{shouldRetryOnError:as}=ts;ts.isPaused()||(cs.error=tn,rs&&ss()&&(ts.onError(tn,Ft,ts),(as===!0||isFunction$2(as)&&as(tn))&&(!Jt().revalidateOnFocus||!Jt().revalidateOnReconnect||hr())&&ts.onErrorRetry(tn,Ft,ts,us=>{const ds=Nt[Ft];ds&&ds[0]&&ds[0](events.ERROR_REVALIDATE_EVENT,us)},{retryCount:(ls.retryCount||0)+1,dedupe:!0})))}return os=!1,ps(),!0},[Ft,lt]),es=reactExports.useCallback((...Xr)=>internalMutate(lt,Wt.current,...Xr),[]);if(useIsomorphicLayoutEffect$1(()=>{Xt.current=Qe,Kt.current=it,isUndefined(Sr)||(qr.current=Sr)}),useIsomorphicLayoutEffect$1(()=>{if(!Ft)return;const Xr=Cn.bind(UNDEFINED,WITH_DEDUPE$1);let en=0;const sn=subscribeCallback(Ft,Nt,(os,ls={})=>{if(os==events.FOCUS_EVENT){const rs=Date.now();Jt().revalidateOnFocus&&rs>en&&hr()&&(en=rs+Jt().focusThrottleInterval,Xr())}else if(os==events.RECONNECT_EVENT)Jt().revalidateOnReconnect&&hr()&&Xr();else{if(os==events.MUTATE_EVENT)return Cn();if(os==events.ERROR_REVALIDATE_EVENT)return Cn(ls)}});return Qt.current=!1,Wt.current=Ft,Ot.current=!0,gr({_k:Bt}),Jr&&(isUndefined(Dr)||IS_SERVER?Xr():rAF(Xr)),()=>{Qt.current=!0,sn()}},[Ft]),useIsomorphicLayoutEffect$1(()=>{let Xr;function en(){const sn=isFunction$2(kt)?kt(xr().data):kt;sn&&Xr!==-1&&(Xr=setTimeout(rn,sn))}function rn(){!xr().error&&(St||Jt().isVisible())&&(Tt||Jt().isOnline())?Cn(WITH_DEDUPE$1).then(en):en()}return en(),()=>{Xr&&(clearTimeout(Xr),Xr=-1)}},[kt,St,Tt,Ft]),reactExports.useDebugValue(Nr),dt&&isUndefined(Dr)&&Ft){if(!IS_REACT_LEGACY&&IS_SERVER)throw new Error("Fallback data is required when using suspense in SSR.");Xt.current=Qe,Kt.current=it,Qt.current=!1;const Xr=Dt[Ft];if(!isUndefined(Xr)){const en=es(Xr);use$1(en)}if(isUndefined(wr)){const en=Cn(WITH_DEDUPE$1);isUndefined(Nr)||(en.status="fulfilled",en.value=!0),use$1(en)}else throw wr}return{mutate:es,get data(){return yr.data=!0,Nr},get error(){return yr.error=!0,wr},get isValidating(){return yr.isValidating=!0,Ur},get isLoading(){return yr.isLoading=!0,nn}}},SWRConfig=OBJECT.defineProperty(SWRConfig$1,"defaultValue",{value:defaultConfig}),useSWR$1=withArgs(useSWRHandler$1);function MembershipPurplePinkGradient(){return jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",className:"invisible w-0 h-0",children:jsxRuntimeExports.jsx("defs",{children:jsxRuntimeExports.jsxs("linearGradient",{id:"member-purple-pink-gradient",x1:"0",x2:"1",y1:"1",y2:"1",children:[jsxRuntimeExports.jsx("stop",{offset:"0%",className:"[stopColor:theme('colors.membership-gradient-stop.0')] dark:[stopColor:theme('colors.membership-gradient-stop-dark.0')]"}),jsxRuntimeExports.jsx("stop",{offset:"50%",className:"[stopColor:theme('colors.membership-gradient-stop.0')] dark:[stopColor:theme('colors.membership-gradient-stop-dark.1')]"}),jsxRuntimeExports.jsx("stop",{offset:"100%",className:"[stopColor:theme('colors.membership-gradient-stop.0')] dark:[stopColor:theme('colors.membership-gradient-stop-dark.2')]"})]})})})}function useCallbackRef(He){const Qe=reactExports.useRef(He);return reactExports.useEffect(()=>{Qe.current=He}),reactExports.useMemo(()=>(...it)=>Qe.current?.(...it),[])}function attachMediaListener(He,Qe){try{return He.addEventListener("change",Qe),()=>He.removeEventListener("change",Qe)}catch{return He.addListener(Qe),()=>He.removeListener(Qe)}}function getInitialValue(He,Qe){return typeof window<"u"&&"matchMedia"in window?window.matchMedia(He).matches:!1}function useMediaQuery(He,Qe,{getInitialValueInEffect:it}={getInitialValueInEffect:!0}){const[lt,ut]=reactExports.useState(it?Qe:getInitialValue(He)),dt=reactExports.useRef(null);return reactExports.useEffect(()=>{if("matchMedia"in window)return dt.current=window.matchMedia(He),ut(dt.current.matches),attachMediaListener(dt.current,xt=>ut(xt.matches))},[He]),lt}function useWindowEvent(He,Qe,it){reactExports.useEffect(()=>(window.addEventListener(He,Qe,it),()=>window.removeEventListener(He,Qe,it)),[He,Qe])}function serializeJSON(He,Qe="use-local-storage"){try{return JSON.stringify(He)}catch{throw new Error(`@mantine/hooks ${Qe}: Failed to serialize the value`)}}function deserializeJSON(He){try{return He&&JSON.parse(He)}catch{return He}}function createStorageHandler(He){return{getItem:ut=>{try{return window[He].getItem(ut)}catch{return console.warn("use-local-storage: Failed to get value from storage, localStorage is blocked"),null}},setItem:(ut,dt)=>{try{window[He].setItem(ut,dt)}catch{console.warn("use-local-storage: Failed to set value to storage, localStorage is blocked")}},removeItem:ut=>{try{window[He].removeItem(ut)}catch{console.warn("use-local-storage: Failed to remove value from storage, localStorage is blocked")}}}}function createStorage(He,Qe){const it="mantine-local-storage",{getItem:lt,setItem:ut,removeItem:dt}=createStorageHandler(He);return function({key:ft,defaultValue:vt,getInitialValueInEffect:kt=!0,sync:St=!0,deserialize:Tt=deserializeJSON,serialize:Mt=Nt=>serializeJSON(Nt,Qe)}){const Nt=reactExports.useCallback(Bt=>{let Ot;try{Ot=typeof window>"u"||!(He in window)||window[He]===null||!!Bt}catch{Ot=!0}if(Ot)return vt;const Qt=lt(ft);return Qt!==null?Tt(Qt):vt},[ft,vt]),[At,$t]=reactExports.useState(Nt(kt)),Dt=reactExports.useCallback(Bt=>{Bt instanceof Function?$t(Ot=>{const Qt=Bt(Ot);return ut(ft,Mt(Qt)),window.dispatchEvent(new CustomEvent(it,{detail:{key:ft,value:Bt(Ot)}})),Qt}):(ut(ft,Mt(Bt)),window.dispatchEvent(new CustomEvent(it,{detail:{key:ft,value:Bt}})),$t(Bt))},[ft]),Ft=reactExports.useCallback(()=>{dt(ft),window.dispatchEvent(new CustomEvent(it,{detail:{key:ft,value:vt}}))},[]);return useWindowEvent("storage",Bt=>{St&&Bt.storageArea===window[He]&&Bt.key===ft&&$t(Tt(Bt.newValue??void 0))}),useWindowEvent(it,Bt=>{St&&Bt.detail.key===ft&&$t(Bt.detail.value)}),reactExports.useEffect(()=>{vt!==void 0&&At===void 0&&Dt(vt)},[vt,At,Dt]),reactExports.useEffect(()=>{const Bt=Nt();Bt!==void 0&&Dt(Bt)},[ft]),[At===void 0?vt:At,Dt,Ft]}}function useLocalStorage(He){return createStorage("localStorage","use-local-storage")(He)}function assignRef(He,Qe){if(typeof He=="function")return He(Qe);typeof He=="object"&&He!==null&&"current"in He&&(He.current=Qe)}function mergeRefs(...He){const Qe=new Map;return it=>{if(He.forEach(lt=>{const ut=assignRef(lt,it);ut&&Qe.set(lt,ut)}),Qe.size>0)return()=>{He.forEach(lt=>{const ut=Qe.get(lt);ut?ut():assignRef(lt,null)}),Qe.clear()}}}function useMergedRef(...He){return reactExports.useCallback(mergeRefs(...He),He)}function useUncontrolled({value:He,defaultValue:Qe,finalValue:it,onChange:lt=()=>{}}){const[ut,dt]=reactExports.useState(Qe!==void 0?Qe:it),xt=(ft,...vt)=>{dt(ft),lt?.(ft,...vt)};return He!==void 0?[He,lt,!0]:[ut,xt,!1]}const defaultState$1={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};function useResizeObserver(He){const Qe=reactExports.useRef(0),it=reactExports.useRef(null),[lt,ut]=reactExports.useState(defaultState$1),dt=reactExports.useMemo(()=>typeof window<"u"?new ResizeObserver(xt=>{const ft=xt[0];ft&&(cancelAnimationFrame(Qe.current),Qe.current=requestAnimationFrame(()=>{it.current&&ut(ft.contentRect)}))}):null,[]);return reactExports.useEffect(()=>(it.current&&dt?.observe(it.current,He),()=>{dt?.disconnect(),Qe.current&&cancelAnimationFrame(Qe.current)}),[it.current]),[it,lt]}function useIntersection(He){const[Qe,it]=reactExports.useState(null),lt=reactExports.useRef(null);return{ref:reactExports.useCallback(dt=>{if(lt.current&&(lt.current.disconnect(),lt.current=null),dt===null){it(null);return}lt.current=new IntersectionObserver(([xt])=>{it(xt)},He),lt.current.observe(dt)},[He?.rootMargin,He?.root,He?.threshold]),entry:Qe}}function useThrottledCallbackWithClearTimeout(He,Qe){const it=useCallbackRef(He),lt=reactExports.useRef(null),ut=reactExports.useRef(null),dt=reactExports.useRef(!0),xt=reactExports.useRef(Qe),ft=reactExports.useRef(-1),vt=()=>window.clearTimeout(ft.current),kt=reactExports.useCallback((...Mt)=>{it(...Mt),lt.current=Mt,ut.current=Mt,dt.current=!1},[it]),St=reactExports.useCallback(()=>{lt.current&&lt.current!==ut.current?(kt(...lt.current),ft.current=window.setTimeout(St,xt.current)):dt.current=!0},[kt]),Tt=reactExports.useCallback((...Mt)=>{dt.current?(kt(...Mt),ft.current=window.setTimeout(St,xt.current)):lt.current=Mt},[kt,St]);return reactExports.useEffect(()=>{xt.current=Qe},[Qe]),[Tt,vt]}function useThrottledCallback(He,Qe){return useThrottledCallbackWithClearTimeout(He,Qe)[0]}const store$7=getDefaultStore(),_bypassAdminAtom=atomWithStorage("bypass-admin",!1),bypassAdminAtom=atom(He=>He(_bypassAdminAtom),(He,Qe,it)=>{Qe(_bypassAdminAtom,it?!0:RESET)});function bypassAdmin(He){return store$7.get(bypassAdminAtom)}const TOKEN_KEY=`${getApiUrl()}:token`,getToken=()=>localStorage.getItem(TOKEN_KEY)||"a",setToken=He=>{localStorage.setItem(TOKEN_KEY,He),window.dispatchEvent(new Event("storage"))},useToken=()=>{const[He,Qe]=reactExports.useState(getToken());return reactExports.useEffect(()=>{const it=()=>{Qe(getToken())};return window.addEventListener("storage",it),()=>window.removeEventListener("storage",it)},[Qe]),He};function useCheckTokenForArgs(He){if(useToken())return He}function checkTokenForArgs(He){return getToken()?He:void 0}const defaults$1=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});function objectHash(He,Qe){Qe?Qe={...defaults$1,...Qe}:Qe=defaults$1;const it=createHasher(Qe);return it.dispatch(He),it.toString()}const defaultPrototypesKeys=Object.freeze(["prototype","__proto__","constructor"]);function createHasher(He){let Qe="",it=new Map;const lt=ut=>{Qe+=ut};return{toString(){return Qe},getContext(){return it},dispatch(ut){return He.replacer&&(ut=He.replacer(ut)),this[ut===null?"null":typeof ut](ut)},object(ut){if(ut&&typeof ut.toJSON=="function")return this.object(ut.toJSON());const dt=Object.prototype.toString.call(ut);let xt="";const ft=dt.length;ft<10?xt="unknown:["+dt+"]":xt=dt.slice(8,ft-1),xt=xt.toLowerCase();let vt=null;if((vt=it.get(ut))===void 0)it.set(ut,it.size);else return this.dispatch("[CIRCULAR:"+vt+"]");if(typeof Buffer<"u"&&Buffer.isBuffer&&Buffer.isBuffer(ut))return lt("buffer:"),lt(ut.toString("utf8"));if(xt!=="object"&&xt!=="function"&&xt!=="asyncfunction")this[xt]?this[xt](ut):He.ignoreUnknown||this.unkown(ut,xt);else{let kt=Object.keys(ut);He.unorderedObjects&&(kt=kt.sort());let St=[];He.respectType!==!1&&!isNativeFunction(ut)&&(St=defaultPrototypesKeys),He.excludeKeys&&(kt=kt.filter(Mt=>!He.excludeKeys(Mt)),St=St.filter(Mt=>!He.excludeKeys(Mt))),lt("object:"+(kt.length+St.length)+":");const Tt=Mt=>{this.dispatch(Mt),lt(":"),He.excludeValues||this.dispatch(ut[Mt]),lt(",")};for(const Mt of kt)Tt(Mt);for(const Mt of St)Tt(Mt)}},array(ut,dt){if(dt=dt===void 0?He.unorderedArrays!==!1:dt,lt("array:"+ut.length+":"),!dt||ut.length<=1){for(const vt of ut)this.dispatch(vt);return}const xt=new Map,ft=ut.map(vt=>{const kt=createHasher(He);kt.dispatch(vt);for(const[St,Tt]of kt.getContext())xt.set(St,Tt);return kt.toString()});return it=xt,ft.sort(),this.array(ft,!1)},date(ut){return lt("date:"+ut.toJSON())},symbol(ut){return lt("symbol:"+ut.toString())},unkown(ut,dt){if(lt(dt),!!ut&&(lt(":"),ut&&typeof ut.entries=="function"))return this.array(Array.from(ut.entries()),!0)},error(ut){return lt("error:"+ut.toString())},boolean(ut){return lt("bool:"+ut)},string(ut){lt("string:"+ut.length+":"),lt(ut)},function(ut){lt("fn:"),isNativeFunction(ut)?this.dispatch("[native]"):this.dispatch(ut.toString()),He.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(ut.name)),He.respectFunctionProperties&&this.object(ut)},number(ut){return lt("number:"+ut)},xml(ut){return lt("xml:"+ut.toString())},null(){return lt("Null")},undefined(){return lt("Undefined")},regexp(ut){return lt("regex:"+ut.toString())},uint8array(ut){return lt("uint8array:"),this.dispatch(Array.prototype.slice.call(ut))},uint8clampedarray(ut){return lt("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(ut))},int8array(ut){return lt("int8array:"),this.dispatch(Array.prototype.slice.call(ut))},uint16array(ut){return lt("uint16array:"),this.dispatch(Array.prototype.slice.call(ut))},int16array(ut){return lt("int16array:"),this.dispatch(Array.prototype.slice.call(ut))},uint32array(ut){return lt("uint32array:"),this.dispatch(Array.prototype.slice.call(ut))},int32array(ut){return lt("int32array:"),this.dispatch(Array.prototype.slice.call(ut))},float32array(ut){return lt("float32array:"),this.dispatch(Array.prototype.slice.call(ut))},float64array(ut){return lt("float64array:"),this.dispatch(Array.prototype.slice.call(ut))},arraybuffer(ut){return lt("arraybuffer:"),this.dispatch(new Uint8Array(ut))},url(ut){return lt("url:"+ut.toString())},map(ut){lt("map:");const dt=[...ut];return this.array(dt,He.unorderedSets!==!1)},set(ut){lt("set:");const dt=[...ut];return this.array(dt,He.unorderedSets!==!1)},file(ut){return lt("file:"),this.dispatch([ut.name,ut.size,ut.type,ut.lastModfied])},blob(){if(He.ignoreUnknown)return lt("[blob]");throw new Error(`Hashing Blob objects is currently not supported
Use "options.replacer" or "options.ignoreUnknown"
`)},domwindow(){return lt("domwindow")},bigint(ut){return lt("bigint:"+ut.toString())},process(){return lt("process")},timer(){return lt("timer")},pipe(){return lt("pipe")},tcp(){return lt("tcp")},udp(){return lt("udp")},tty(){return lt("tty")},statwatcher(){return lt("statwatcher")},securecontext(){return lt("securecontext")},connection(){return lt("connection")},zlib(){return lt("zlib")},context(){return lt("context")},nodescript(){return lt("nodescript")},httpparser(){return lt("httpparser")},dataview(){return lt("dataview")},signal(){return lt("signal")},fsevent(){return lt("fsevent")},tlswrap(){return lt("tlswrap")}}}const nativeFunc="[native code] }",nativeFuncLength=nativeFunc.length;function isNativeFunction(He){return typeof He!="function"?!1:Function.prototype.toString.call(He).slice(-nativeFuncLength)===nativeFunc}var __defProp$1=Object.defineProperty,__defNormalProp$1=(He,Qe,it)=>Qe in He?__defProp$1(He,Qe,{enumerable:!0,configurable:!0,writable:!0,value:it}):He[Qe]=it,__publicField$1=(He,Qe,it)=>(__defNormalProp$1(He,typeof Qe!="symbol"?Qe+"":Qe,it),it);class WordArray{constructor(Qe,it){__publicField$1(this,"words"),__publicField$1(this,"sigBytes"),Qe=this.words=Qe||[],this.sigBytes=it===void 0?Qe.length*4:it}toString(Qe){return(Qe||Hex).stringify(this)}concat(Qe){if(this.clamp(),this.sigBytes%4)for(let it=0;it<Qe.sigBytes;it++){const lt=Qe.words[it>>>2]>>>24-it%4*8&255;this.words[this.sigBytes+it>>>2]|=lt<<24-(this.sigBytes+it)%4*8}else for(let it=0;it<Qe.sigBytes;it+=4)this.words[this.sigBytes+it>>>2]=Qe.words[it>>>2];return this.sigBytes+=Qe.sigBytes,this}clamp(){this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4)}clone(){return new WordArray([...this.words])}}const Hex={stringify(He){const Qe=[];for(let it=0;it<He.sigBytes;it++){const lt=He.words[it>>>2]>>>24-it%4*8&255;Qe.push((lt>>>4).toString(16),(lt&15).toString(16))}return Qe.join("")}},Base64={stringify(He){const Qe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",it=[];for(let lt=0;lt<He.sigBytes;lt+=3){const ut=He.words[lt>>>2]>>>24-lt%4*8&255,dt=He.words[lt+1>>>2]>>>24-(lt+1)%4*8&255,xt=He.words[lt+2>>>2]>>>24-(lt+2)%4*8&255,ft=ut<<16|dt<<8|xt;for(let vt=0;vt<4&&lt*8+vt*6<He.sigBytes*8;vt++)it.push(Qe.charAt(ft>>>6*(3-vt)&63))}return it.join("")}},Latin1={parse(He){const Qe=He.length,it=[];for(let lt=0;lt<Qe;lt++)it[lt>>>2]|=(He.charCodeAt(lt)&255)<<24-lt%4*8;return new WordArray(it,Qe)}},Utf8={parse(He){return Latin1.parse(unescape(encodeURIComponent(He)))}};class BufferedBlockAlgorithm{constructor(){__publicField$1(this,"_data",new WordArray),__publicField$1(this,"_nDataBytes",0),__publicField$1(this,"_minBufferSize",0),__publicField$1(this,"blockSize",512/32)}reset(){this._data=new WordArray,this._nDataBytes=0}_append(Qe){typeof Qe=="string"&&(Qe=Utf8.parse(Qe)),this._data.concat(Qe),this._nDataBytes+=Qe.sigBytes}_doProcessBlock(Qe,it){}_process(Qe){let it,lt=this._data.sigBytes/(this.blockSize*4);Qe?lt=Math.ceil(lt):lt=Math.max((lt|0)-this._minBufferSize,0);const ut=lt*this.blockSize,dt=Math.min(ut*4,this._data.sigBytes);if(ut){for(let xt=0;xt<ut;xt+=this.blockSize)this._doProcessBlock(this._data.words,xt);it=this._data.words.splice(0,ut),this._data.sigBytes-=dt}return new WordArray(it,dt)}}class Hasher extends BufferedBlockAlgorithm{update(Qe){return this._append(Qe),this._process(),this}finalize(Qe){Qe&&this._append(Qe)}}var __defProp$2=Object.defineProperty,__defNormalProp$2=(He,Qe,it)=>Qe in He?__defProp$2(He,Qe,{enumerable:!0,configurable:!0,writable:!0,value:it}):He[Qe]=it,__publicField=(He,Qe,it)=>(__defNormalProp$2(He,Qe+"",it),it);const H$4=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],K$2=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],W$3=[];class SHA256 extends Hasher{constructor(){super(...arguments),__publicField(this,"_hash",new WordArray([...H$4]))}reset(){super.reset(),this._hash=new WordArray([...H$4])}_doProcessBlock(Qe,it){const lt=this._hash.words;let ut=lt[0],dt=lt[1],xt=lt[2],ft=lt[3],vt=lt[4],kt=lt[5],St=lt[6],Tt=lt[7];for(let Mt=0;Mt<64;Mt++){if(Mt<16)W$3[Mt]=Qe[it+Mt]|0;else{const Ot=W$3[Mt-15],Qt=(Ot<<25|Ot>>>7)^(Ot<<14|Ot>>>18)^Ot>>>3,Wt=W$3[Mt-2],Xt=(Wt<<15|Wt>>>17)^(Wt<<13|Wt>>>19)^Wt>>>10;W$3[Mt]=Qt+W$3[Mt-7]+Xt+W$3[Mt-16]}const Nt=vt&kt^~vt&St,At=ut&dt^ut&xt^dt&xt,$t=(ut<<30|ut>>>2)^(ut<<19|ut>>>13)^(ut<<10|ut>>>22),Dt=(vt<<26|vt>>>6)^(vt<<21|vt>>>11)^(vt<<7|vt>>>25),Ft=Tt+Dt+Nt+K$2[Mt]+W$3[Mt],Bt=$t+At;Tt=St,St=kt,kt=vt,vt=ft+Ft|0,ft=xt,xt=dt,dt=ut,ut=Ft+Bt|0}lt[0]=lt[0]+ut|0,lt[1]=lt[1]+dt|0,lt[2]=lt[2]+xt|0,lt[3]=lt[3]+ft|0,lt[4]=lt[4]+vt|0,lt[5]=lt[5]+kt|0,lt[6]=lt[6]+St|0,lt[7]=lt[7]+Tt|0}finalize(Qe){super.finalize(Qe);const it=this._nDataBytes*8,lt=this._data.sigBytes*8;return this._data.words[lt>>>5]|=128<<24-lt%32,this._data.words[(lt+64>>>9<<4)+14]=Math.floor(it/4294967296),this._data.words[(lt+64>>>9<<4)+15]=it,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}}function sha256$1(He){return new SHA256().finalize(He).toString()}function sha256base64(He){return new SHA256().finalize(He).toString(Base64)}function hash$1(He,Qe={}){const it=typeof He=="string"?He:objectHash(He,Qe);return sha256base64(it).slice(0,10)}function murmurHash(He,Qe=0){typeof He=="string"&&(He=createBuffer(He));let it=0,lt=Qe,ut,dt;const xt=He.length&3,ft=He.length-xt,vt=3432918353,kt=461845907;for(;it<ft;)ut=He[it]&255|(He[++it]&255)<<8|(He[++it]&255)<<16|(He[++it]&255)<<24,++it,ut=(ut&65535)*vt+(((ut>>>16)*vt&65535)<<16)&4294967295,ut=ut<<15|ut>>>17,ut=(ut&65535)*kt+(((ut>>>16)*kt&65535)<<16)&4294967295,lt^=ut,lt=lt<<13|lt>>>19,dt=(lt&65535)*5+(((lt>>>16)*5&65535)<<16)&4294967295,lt=(dt&65535)+27492+(((dt>>>16)+58964&65535)<<16);switch(ut=0,xt){case 3:ut^=(He[it+2]&255)<<16;case 2:ut^=(He[it+1]&255)<<8;case 1:ut^=He[it]&255,ut=(ut&65535)*vt+(((ut>>>16)*vt&65535)<<16)&4294967295,ut=ut<<15|ut>>>17,ut=(ut&65535)*kt+(((ut>>>16)*kt&65535)<<16)&4294967295,lt^=ut}return lt^=He.length,lt^=lt>>>16,lt=(lt&65535)*2246822507+(((lt>>>16)*2246822507&65535)<<16)&4294967295,lt^=lt>>>13,lt=(lt&65535)*3266489909+(((lt>>>16)*3266489909&65535)<<16)&4294967295,lt^=lt>>>16,lt>>>0}function createBuffer(He){return new TextEncoder().encode(He)}function e(He,Qe,it,lt){return new(it||(it=Promise))(function(ut,dt){function xt(kt){try{vt(lt.next(kt))}catch(St){dt(St)}}function ft(kt){try{vt(lt.throw(kt))}catch(St){dt(St)}}function vt(kt){var St;kt.done?ut(kt.value):(St=kt.value,St instanceof it?St:new it(function(Tt){Tt(St)})).then(xt,ft)}vt((lt=lt.apply(He,[])).next())})}function n(He,Qe){var it,lt,ut,dt,xt={label:0,sent:function(){if(1&ut[0])throw ut[1];return ut[1]},trys:[],ops:[]};return dt={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(dt[Symbol.iterator]=function(){return this}),dt;function ft(vt){return function(kt){return function(St){if(it)throw new TypeError("Generator is already executing.");for(;dt&&(dt=0,St[0]&&(xt=0)),xt;)try{if(it=1,lt&&(ut=2&St[0]?lt.return:St[0]?lt.throw||((ut=lt.return)&&ut.call(lt),0):lt.next)&&!(ut=ut.call(lt,St[1])).done)return ut;switch(lt=0,ut&&(St=[2&St[0],ut.value]),St[0]){case 0:case 1:ut=St;break;case 4:return xt.label++,{value:St[1],done:!1};case 5:xt.label++,lt=St[1],St=[0];continue;case 7:St=xt.ops.pop(),xt.trys.pop();continue;default:if(ut=xt.trys,!((ut=ut.length>0&&ut[ut.length-1])||St[0]!==6&&St[0]!==2)){xt=0;continue}if(St[0]===3&&(!ut||St[1]>ut[0]&&St[1]<ut[3])){xt.label=St[1];break}if(St[0]===6&&xt.label<ut[1]){xt.label=ut[1],ut=St;break}if(ut&&xt.label<ut[2]){xt.label=ut[2],xt.ops.push(St);break}ut[2]&&xt.ops.pop(),xt.trys.pop();continue}St=Qe.call(He,xt)}catch(Tt){St=[6,Tt],lt=0}finally{it=ut=0}if(5&St[0])throw St[1];return{value:St[0]?St[1]:void 0,done:!0}}([vt,kt])}}}var r={exclude:[],include:[],logging:!0};function t(He,Qe){if(!["include","exclude","permissions_to_check","retries","timeout","logging"].includes(He))throw new Error("Unknown option "+He);if(["include","exclude","permissions_to_check"].includes(He)&&(!Array.isArray(Qe)||!Qe.every(function(it){return typeof it=="string"})))throw new Error("The value of the include, exclude and permissions_to_check must be an array of strings");if(["retries","timeout"].includes(He))throw new Error("The value of retries must be a number");r[He]=Qe}var o={},a$2={timeout:"true"},i$2=function(He,Qe){typeof window<"u"&&(o[He]=Qe)},u$2=function(){return Object.fromEntries(Object.entries(o).filter(function(He){var Qe,it=He[0];return!(!((Qe=r?.exclude)===null||Qe===void 0)&&Qe.includes(it))}).filter(function(He){var Qe,it,lt,ut,dt=He[0];return!((Qe=r?.include)===null||Qe===void 0)&&Qe.some(function(xt){return xt.includes(".")})?(it=r?.include)===null||it===void 0?void 0:it.some(function(xt){return xt.startsWith(dt)}):((lt=r?.include)===null||lt===void 0?void 0:lt.length)===0||((ut=r?.include)===null||ut===void 0?void 0:ut.includes(dt))}).map(function(He){return[He[0],(0,He[1])()]}))};function c(He){return He^=He>>>16,He=Math.imul(He,2246822507),He^=He>>>13,He=Math.imul(He,3266489909),(He^=He>>>16)>>>0}var s$1=new Uint32Array([597399067,2869860233,951274213,2716044179]);function l$3(He,Qe){return He<<Qe|He>>>32-Qe}function d$1(He,Qe){var it;if(Qe===void 0&&(Qe=0),Qe=Qe?0|Qe:0,typeof He=="string"&&(it=He,He=new TextEncoder().encode(it).buffer),!(He instanceof ArrayBuffer))throw new TypeError("Expected key to be ArrayBuffer or string");var lt=new Uint32Array([Qe,Qe,Qe,Qe]);(function(dt,xt){for(var ft=dt.byteLength/16|0,vt=new Uint32Array(dt,0,4*ft),kt=0;kt<ft;kt++){var St=vt.subarray(4*kt,4*(kt+1));St[0]=Math.imul(St[0],s$1[0]),St[0]=l$3(St[0],15),St[0]=Math.imul(St[0],s$1[1]),xt[0]=xt[0]^St[0],xt[0]=l$3(xt[0],19),xt[0]=xt[0]+xt[1],xt[0]=Math.imul(xt[0],5)+1444728091,St[1]=Math.imul(St[1],s$1[1]),St[1]=l$3(St[1],16),St[1]=Math.imul(St[1],s$1[2]),xt[1]=xt[1]^St[1],xt[1]=l$3(xt[1],17),xt[1]=xt[1]+xt[2],xt[1]=Math.imul(xt[1],5)+197830471,St[2]=Math.imul(St[2],s$1[2]),St[2]=l$3(St[2],17),St[2]=Math.imul(St[2],s$1[3]),xt[2]=xt[2]^St[2],xt[2]=l$3(xt[2],15),xt[2]=xt[2]+xt[3],xt[2]=Math.imul(xt[2],5)+2530024501,St[3]=Math.imul(St[3],s$1[3]),St[3]=l$3(St[3],18),St[3]=Math.imul(St[3],s$1[0]),xt[3]=xt[3]^St[3],xt[3]=l$3(xt[3],13),xt[3]=xt[3]+xt[0],xt[3]=Math.imul(xt[3],5)+850148119}})(He,lt),function(dt,xt){var ft=dt.byteLength/16|0,vt=dt.byteLength%16,kt=new Uint32Array(4),St=new Uint8Array(dt,16*ft,vt);switch(vt){case 15:kt[3]=kt[3]^St[14]<<16;case 14:kt[3]=kt[3]^St[13]<<8;case 13:kt[3]=kt[3]^St[12]<<0,kt[3]=Math.imul(kt[3],s$1[3]),kt[3]=l$3(kt[3],18),kt[3]=Math.imul(kt[3],s$1[0]),xt[3]=xt[3]^kt[3];case 12:kt[2]=kt[2]^St[11]<<24;case 11:kt[2]=kt[2]^St[10]<<16;case 10:kt[2]=kt[2]^St[9]<<8;case 9:kt[2]=kt[2]^St[8]<<0,kt[2]=Math.imul(kt[2],s$1[2]),kt[2]=l$3(kt[2],17),kt[2]=Math.imul(kt[2],s$1[3]),xt[2]=xt[2]^kt[2];case 8:kt[1]=kt[1]^St[7]<<24;case 7:kt[1]=kt[1]^St[6]<<16;case 6:kt[1]=kt[1]^St[5]<<8;case 5:kt[1]=kt[1]^St[4]<<0,kt[1]=Math.imul(kt[1],s$1[1]),kt[1]=l$3(kt[1],16),kt[1]=Math.imul(kt[1],s$1[2]),xt[1]=xt[1]^kt[1];case 4:kt[0]=kt[0]^St[3]<<24;case 3:kt[0]=kt[0]^St[2]<<16;case 2:kt[0]=kt[0]^St[1]<<8;case 1:kt[0]=kt[0]^St[0]<<0,kt[0]=Math.imul(kt[0],s$1[0]),kt[0]=l$3(kt[0],15),kt[0]=Math.imul(kt[0],s$1[1]),xt[0]=xt[0]^kt[0]}}(He,lt),function(dt,xt){xt[0]=xt[0]^dt.byteLength,xt[1]=xt[1]^dt.byteLength,xt[2]=xt[2]^dt.byteLength,xt[3]=xt[3]^dt.byteLength,xt[0]=xt[0]+xt[1]|0,xt[0]=xt[0]+xt[2]|0,xt[0]=xt[0]+xt[3]|0,xt[1]=xt[1]+xt[0]|0,xt[2]=xt[2]+xt[0]|0,xt[3]=xt[3]+xt[0]|0,xt[0]=c(xt[0]),xt[1]=c(xt[1]),xt[2]=c(xt[2]),xt[3]=c(xt[3]),xt[0]=xt[0]+xt[1]|0,xt[0]=xt[0]+xt[2]|0,xt[0]=xt[0]+xt[3]|0,xt[1]=xt[1]+xt[0]|0,xt[2]=xt[2]+xt[0]|0,xt[3]=xt[3]+xt[0]|0}(He,lt);var ut=new Uint8Array(lt.buffer);return Array.from(ut).map(function(dt){return dt.toString(16).padStart(2,"0")}).join("")}function f$3(He,Qe){return new Promise(function(it){setTimeout(function(){return it(Qe)},He)})}function m$2(He,Qe,it){return Promise.all(He.map(function(lt){return Promise.race([lt,f$3(Qe,it)])}))}var v$4="0.19.1";function g$2(){return v$4}function p$2(){return e(this,void 0,void 0,function(){var He,Qe,it,lt,ut;return n(this,function(dt){switch(dt.label){case 0:return dt.trys.push([0,2,,3]),He=u$2(),Qe=Object.keys(He),[4,m$2(Object.values(He),r?.timeout||1e3,a$2)];case 1:return it=dt.sent(),lt=it.filter(function(xt){return xt!==void 0}),ut={},lt.forEach(function(xt,ft){ut[Qe[ft]]=xt}),[2,w$3(ut,r.exclude||[],r.include||[],"")];case 2:throw dt.sent();case 3:return[2]}})})}function w$3(He,Qe,it,lt){lt===void 0&&(lt="");for(var ut={},dt=function(kt,St){var Tt=lt+kt+".";if(typeof St!="object"||Array.isArray(St)){var Mt=Qe.some(function($t){return Tt.startsWith($t)}),Nt=it.some(function($t){return Tt.startsWith($t)});Mt&&!Nt||(ut[kt]=St)}else{var At=w$3(St,Qe,it,Tt);Object.keys(At).length>0&&(ut[kt]=At)}},xt=0,ft=Object.entries(He);xt<ft.length;xt++){var vt=ft[xt];dt(vt[0],vt[1])}return ut}function y$2(He){return e(this,void 0,void 0,function(){var Qe,it;return n(this,function(lt){switch(lt.label){case 0:return lt.trys.push([0,2,,3]),[4,p$2()];case 1:return Qe=lt.sent(),it=d$1(JSON.stringify(Qe)),Math.random()<.001&&r.logging&&function(ut,dt){e(this,void 0,void 0,function(){var xt,ft;return n(this,function(vt){switch(vt.label){case 0:if(xt="https://logging.thumbmarkjs.com/v1/log",ft={thumbmark:ut,components:dt,version:g$2()},sessionStorage.getItem("_tmjs_l"))return[3,4];sessionStorage.setItem("_tmjs_l","1"),vt.label=1;case 1:return vt.trys.push([1,3,,4]),[4,fetch(xt,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ft)})];case 2:case 3:return vt.sent(),[3,4];case 4:return[2]}})})}(it,Qe),[2,it.toString()];case 2:throw lt.sent();case 3:return[2]}})})}function S$2(He){for(var Qe=0,it=0;it<He.length;++it)Qe+=Math.abs(He[it]);return Qe}function M$4(He,Qe,it){for(var lt=[],ut=0;ut<He[0].data.length;ut++){for(var dt=[],xt=0;xt<He.length;xt++)dt.push(He[xt].data[ut]);lt.push(E$3(dt))}var ft=new Uint8ClampedArray(lt);return new ImageData(ft,Qe,it)}function E$3(He){if(He.length===0)return 0;for(var Qe={},it=0,lt=He;it<lt.length;it++)Qe[dt=lt[it]]=(Qe[dt]||0)+1;var ut=He[0];for(var dt in Qe)Qe[dt]>Qe[ut]&&(ut=parseInt(dt,10));return ut}function P$3(){if(typeof navigator>"u")return{name:"unknown",version:"unknown"};for(var He=navigator.userAgent,Qe={Edg:"Edge",OPR:"Opera"},it=0,lt=[/(?<name>Edge|Edg)\/(?<version>\d+(?:\.\d+)?)/,/(?<name>(?:Chrome|Chromium|OPR|Opera|Vivaldi|Brave))\/(?<version>\d+(?:\.\d+)?)/,/(?<name>(?:Firefox|Waterfox|Iceweasel|IceCat))\/(?<version>\d+(?:\.\d+)?)/,/(?<name>Safari)\/(?<version>\d+(?:\.\d+)?)/,/(?<name>MSIE|Trident|IEMobile).+?(?<version>\d+(?:\.\d+)?)/,/(?<name>[A-Za-z]+)\/(?<version>\d+(?:\.\d+)?)/,/(?<name>SamsungBrowser)\/(?<version>\d+(?:\.\d+)?)/];it<lt.length;it++){var ut=lt[it],dt=He.match(ut);if(dt&&dt.groups)return{name:Qe[dt.groups.name]||dt.groups.name,version:dt.groups.version}}return{name:"unknown",version:"unknown"}}i$2("audio",function(){return e(this,void 0,void 0,function(){return n(this,function(He){return[2,new Promise(function(Qe,it){try{var lt=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,5e3,44100),ut=lt.createBufferSource(),dt=lt.createOscillator();dt.frequency.value=1e3;var xt,ft=lt.createDynamicsCompressor();ft.threshold.value=-50,ft.knee.value=40,ft.ratio.value=12,ft.attack.value=0,ft.release.value=.2,dt.connect(ft),ft.connect(lt.destination),dt.start(),lt.oncomplete=function(vt){xt=vt.renderedBuffer.getChannelData(0),Qe({sampleHash:S$2(xt),oscillator:dt.type,maxChannels:lt.destination.maxChannelCount,channelCountMode:ut.channelCountMode})},lt.startRendering()}catch(vt){console.error("Error creating audio fingerprint:",vt),it(vt)}})]})})});var A$5=P$3().name!=="SamsungBrowser"?1:3,C$2=280,x$3=20;P$3().name!="Firefox"&&i$2("canvas",function(){return document.createElement("canvas").getContext("2d"),new Promise(function(He){var Qe=Array.from({length:A$5},function(){return function(){var it=document.createElement("canvas"),lt=it.getContext("2d");if(!lt)return new ImageData(1,1);it.width=C$2,it.height=x$3;var ut=lt.createLinearGradient(0,0,it.width,it.height);ut.addColorStop(0,"red"),ut.addColorStop(.16666666666666666,"orange"),ut.addColorStop(.3333333333333333,"yellow"),ut.addColorStop(.5,"green"),ut.addColorStop(.6666666666666666,"blue"),ut.addColorStop(.8333333333333334,"indigo"),ut.addColorStop(1,"violet"),lt.fillStyle=ut,lt.fillRect(0,0,it.width,it.height);var dt="Random Text WMwmil10Oo";lt.font="23.123px Arial",lt.fillStyle="black",lt.fillText(dt,-5,15),lt.fillStyle="rgba(0, 0, 255, 0.5)",lt.fillText(dt,-3.3,17.7),lt.beginPath(),lt.moveTo(0,0),lt.lineTo(2*it.width/7,it.height),lt.strokeStyle="white",lt.lineWidth=2,lt.stroke();var xt=lt.getImageData(0,0,it.width,it.height);return xt}()});He({commonImageDataHash:d$1(M$4(Qe,C$2,x$3).data.toString()).toString()})})});var T$1,k$2=["Arial","Arial Black","Arial Narrow","Arial Rounded MT","Arimo","Archivo","Barlow","Bebas Neue","Bitter","Bookman","Calibri","Cabin","Candara","Century","Century Gothic","Comic Sans MS","Constantia","Courier","Courier New","Crimson Text","DM Mono","DM Sans","DM Serif Display","DM Serif Text","Dosis","Droid Sans","Exo","Fira Code","Fira Sans","Franklin Gothic Medium","Garamond","Geneva","Georgia","Gill Sans","Helvetica","Impact","Inconsolata","Indie Flower","Inter","Josefin Sans","Karla","Lato","Lexend","Lucida Bright","Lucida Console","Lucida Sans Unicode","Manrope","Merriweather","Merriweather Sans","Montserrat","Myriad","Noto Sans","Nunito","Nunito Sans","Open Sans","Optima","Orbitron","Oswald","Pacifico","Palatino","Perpetua","PT Sans","PT Serif","Poppins","Prompt","Public Sans","Quicksand","Rajdhani","Recursive","Roboto","Roboto Condensed","Rockwell","Rubik","Segoe Print","Segoe Script","Segoe UI","Sora","Source Sans Pro","Space Mono","Tahoma","Taviraj","Times","Times New Roman","Titillium Web","Trebuchet MS","Ubuntu","Varela Round","Verdana","Work Sans"],R$3=["monospace","sans-serif","serif"];function I$2(He,Qe){if(!He)throw new Error("Canvas context not supported");return He.font,He.font="72px ".concat(Qe),He.measureText("WwMmLli0Oo").width}function O$4(){var He,Qe=document.createElement("canvas"),it=(He=Qe.getContext("webgl"))!==null&&He!==void 0?He:Qe.getContext("experimental-webgl");if(it&&"getParameter"in it)try{var lt=(it.getParameter(it.VENDOR)||"").toString(),ut=(it.getParameter(it.RENDERER)||"").toString(),dt={vendor:lt,renderer:ut,version:(it.getParameter(it.VERSION)||"").toString(),shadingLanguageVersion:(it.getParameter(it.SHADING_LANGUAGE_VERSION)||"").toString()};if(!ut.length||!lt.length){var xt=it.getExtension("WEBGL_debug_renderer_info");if(xt){var ft=(it.getParameter(xt.UNMASKED_VENDOR_WEBGL)||"").toString(),vt=(it.getParameter(xt.UNMASKED_RENDERER_WEBGL)||"").toString();ft&&(dt.vendorUnmasked=ft),vt&&(dt.rendererUnmasked=vt)}}return dt}catch{}return"undefined"}function _$3(){var He=new Float32Array(1),Qe=new Uint8Array(He.buffer);return He[0]=1/0,He[0]=He[0]-He[0],Qe[3]}function L$2(He,Qe){var it={};return Qe.forEach(function(lt){var ut=function(dt){if(dt.length===0)return null;var xt={};dt.forEach(function(kt){var St=String(kt);xt[St]=(xt[St]||0)+1});var ft=dt[0],vt=1;return Object.keys(xt).forEach(function(kt){xt[kt]>vt&&(ft=kt,vt=xt[kt])}),ft}(He.map(function(dt){return lt in dt?dt[lt]:void 0}).filter(function(dt){return dt!==void 0}));ut&&(it[lt]=ut)}),it}function D$3(){var He=[],Qe={"prefers-contrast":["high","more","low","less","forced","no-preference"],"any-hover":["hover","none"],"any-pointer":["none","coarse","fine"],pointer:["none","coarse","fine"],hover:["hover","none"],update:["fast","slow"],"inverted-colors":["inverted","none"],"prefers-reduced-motion":["reduce","no-preference"],"prefers-reduced-transparency":["reduce","no-preference"],scripting:["none","initial-only","enabled"],"forced-colors":["active","none"]};return Object.keys(Qe).forEach(function(it){Qe[it].forEach(function(lt){matchMedia("(".concat(it,": ").concat(lt,")")).matches&&He.push("".concat(it,": ").concat(lt))})}),He}function B$2(){if(window.location.protocol==="https:"&&typeof window.ApplePaySession=="function")try{for(var He=window.ApplePaySession.supportsVersion,Qe=15;Qe>0;Qe--)if(He(Qe))return Qe}catch{return 0}return 0}P$3().name!="Firefox"&&i$2("fonts",function(){var He=this;return new Promise(function(Qe,it){try{(function(lt){var ut;e(this,void 0,void 0,function(){var dt,xt,ft;return n(this,function(vt){switch(vt.label){case 0:return document.body?[3,2]:[4,(kt=50,new Promise(function(Tt){return setTimeout(Tt,kt,St)}))];case 1:return vt.sent(),[3,0];case 2:if((dt=document.createElement("iframe")).setAttribute("frameBorder","0"),(xt=dt.style).setProperty("position","fixed"),xt.setProperty("display","block","important"),xt.setProperty("visibility","visible"),xt.setProperty("border","0"),xt.setProperty("opacity","0"),dt.src="about:blank",document.body.appendChild(dt),!(ft=dt.contentDocument||((ut=dt.contentWindow)===null||ut===void 0?void 0:ut.document)))throw new Error("Iframe document is not accessible");return lt({iframe:ft}),setTimeout(function(){document.body.removeChild(dt)},0),[2]}var kt,St})})})(function(lt){var ut=lt.iframe;return e(He,void 0,void 0,function(){var dt,xt,ft,vt;return n(this,function(kt){return dt=ut.createElement("canvas"),xt=dt.getContext("2d"),ft=R$3.map(function(St){return I$2(xt,St)}),vt={},k$2.forEach(function(St){var Tt=I$2(xt,St);ft.includes(Tt)||(vt[St]=Tt)}),Qe(vt),[2]})})})}catch{it({error:"unsupported"})}})}),i$2("hardware",function(){return new Promise(function(He,Qe){var it=navigator.deviceMemory!==void 0?navigator.deviceMemory:0,lt=window.performance&&window.performance.memory?window.performance.memory:0;He({videocard:O$4(),architecture:_$3(),deviceMemory:it.toString()||"undefined",jsHeapSizeLimit:lt.jsHeapSizeLimit||0})})}),i$2("locales",function(){return new Promise(function(He){He({languages:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone})})}),i$2("permissions",function(){return e(this,void 0,void 0,function(){var He;return n(this,function(Qe){return T$1=r?.permissions_to_check||["accelerometer","accessibility","accessibility-events","ambient-light-sensor","background-fetch","background-sync","bluetooth","camera","clipboard-read","clipboard-write","device-info","display-capture","gyroscope","geolocation","local-fonts","magnetometer","microphone","midi","nfc","notifications","payment-handler","persistent-storage","push","speaker","storage-access","top-level-storage-access","window-management","query"],He=Array.from({length:r?.retries||3},function(){return function(){return e(this,void 0,void 0,function(){var it,lt,ut,dt,xt;return n(this,function(ft){switch(ft.label){case 0:it={},lt=0,ut=T$1,ft.label=1;case 1:if(!(lt<ut.length))return[3,6];dt=ut[lt],ft.label=2;case 2:return ft.trys.push([2,4,,5]),[4,navigator.permissions.query({name:dt})];case 3:return xt=ft.sent(),it[dt]=xt.state.toString(),[3,5];case 4:return ft.sent(),[3,5];case 5:return lt++,[3,1];case 6:return[2,it]}})})}()}),[2,Promise.all(He).then(function(it){return L$2(it,T$1)})]})})}),i$2("plugins",function(){var He=[];if(navigator.plugins)for(var Qe=0;Qe<navigator.plugins.length;Qe++){var it=navigator.plugins[Qe];He.push([it.name,it.filename,it.description].join("|"))}return new Promise(function(lt){lt({plugins:He})})}),i$2("screen",function(){return new Promise(function(He){He({is_touchscreen:navigator.maxTouchPoints>0,maxTouchPoints:navigator.maxTouchPoints,colorDepth:screen.colorDepth,mediaMatches:D$3()})})}),i$2("system",function(){return new Promise(function(He){var Qe=P$3();He({platform:window.navigator.platform,cookieEnabled:window.navigator.cookieEnabled,productSub:navigator.productSub,product:navigator.product,useragent:navigator.userAgent,hardwareConcurrency:navigator.hardwareConcurrency,browser:{name:Qe.name,version:Qe.version},applePayVersion:B$2()})})});var U$2,F$2=P$3().name!=="SamsungBrowser"?1:3,N$3=null;i$2("webgl",function(){return e(this,void 0,void 0,function(){var He;return n(this,function(Qe){typeof document<"u"&&((U$2=document.createElement("canvas")).width=200,U$2.height=100,N$3=U$2.getContext("webgl"));try{if(!N$3)throw new Error("WebGL not supported");return He=Array.from({length:F$2},function(){return function(){try{if(!N$3)throw new Error("WebGL not supported");var it=`
          attribute vec2 position;
          void main() {
              gl_Position = vec4(position, 0.0, 1.0);
          }
      `,lt=`
          precision mediump float;
          void main() {
              gl_FragColor = vec4(0.812, 0.195, 0.553, 0.921); // Set line color
          }
      `,ut=N$3.createShader(N$3.VERTEX_SHADER),dt=N$3.createShader(N$3.FRAGMENT_SHADER);if(!ut||!dt)throw new Error("Failed to create shaders");if(N$3.shaderSource(ut,it),N$3.shaderSource(dt,lt),N$3.compileShader(ut),!N$3.getShaderParameter(ut,N$3.COMPILE_STATUS))throw new Error("Vertex shader compilation failed: "+N$3.getShaderInfoLog(ut));if(N$3.compileShader(dt),!N$3.getShaderParameter(dt,N$3.COMPILE_STATUS))throw new Error("Fragment shader compilation failed: "+N$3.getShaderInfoLog(dt));var xt=N$3.createProgram();if(!xt)throw new Error("Failed to create shader program");if(N$3.attachShader(xt,ut),N$3.attachShader(xt,dt),N$3.linkProgram(xt),!N$3.getProgramParameter(xt,N$3.LINK_STATUS))throw new Error("Shader program linking failed: "+N$3.getProgramInfoLog(xt));N$3.useProgram(xt);for(var ft=137,vt=new Float32Array(4*ft),kt=2*Math.PI/ft,St=0;St<ft;St++){var Tt=St*kt;vt[4*St]=0,vt[4*St+1]=0,vt[4*St+2]=Math.cos(Tt)*(U$2.width/2),vt[4*St+3]=Math.sin(Tt)*(U$2.height/2)}var Mt=N$3.createBuffer();N$3.bindBuffer(N$3.ARRAY_BUFFER,Mt),N$3.bufferData(N$3.ARRAY_BUFFER,vt,N$3.STATIC_DRAW);var Nt=N$3.getAttribLocation(xt,"position");N$3.enableVertexAttribArray(Nt),N$3.vertexAttribPointer(Nt,2,N$3.FLOAT,!1,0,0),N$3.viewport(0,0,U$2.width,U$2.height),N$3.clearColor(0,0,0,1),N$3.clear(N$3.COLOR_BUFFER_BIT),N$3.drawArrays(N$3.LINES,0,2*ft);var At=new Uint8ClampedArray(U$2.width*U$2.height*4);return N$3.readPixels(0,0,U$2.width,U$2.height,N$3.RGBA,N$3.UNSIGNED_BYTE,At),new ImageData(At,U$2.width,U$2.height)}catch{return new ImageData(1,1)}finally{N$3&&(N$3.bindBuffer(N$3.ARRAY_BUFFER,null),N$3.useProgram(null),N$3.viewport(0,0,N$3.drawingBufferWidth,N$3.drawingBufferHeight),N$3.clearColor(0,0,0,0))}}()}),[2,{commonImageHash:d$1(M$4(He,U$2.width,U$2.height).data.toString()).toString()}]}catch{return[2,{webgl:"unsupported"}]}return[2]})})});var j$4=function(He,Qe,it,lt){for(var ut=(it-Qe)/lt,dt=0,xt=0;xt<lt;xt++)dt+=He(Qe+(xt+.5)*ut);return dt*ut};i$2("math",function(){return e(void 0,void 0,void 0,function(){return n(this,function(He){return[2,{acos:Math.acos(.5),asin:j$4(Math.asin,-1,1,97),atan:j$4(Math.atan,-1,1,97),cos:j$4(Math.cos,0,Math.PI,97),cosh:Math.cosh(9/7),e:Math.E,largeCos:Math.cos(1e20),largeSin:Math.sin(1e20),largeTan:Math.tan(1e20),log:Math.log(1e3),pi:Math.PI,sin:j$4(Math.sin,-Math.PI,Math.PI,97),sinh:j$4(Math.sinh,-9/7,7/9,97),sqrt:Math.sqrt(2),tan:j$4(Math.tan,0,2*Math.PI,97),tanh:j$4(Math.tanh,-9/7,7/9,97)}]})})});t("logging",!1);function getFingerprint(){const He=localStorage.getItem("browser-id");return He||(y$2().then(Qe=>{localStorage.setItem("browser-id",Qe)}),null)}var se$2=Object.defineProperty,v$3=Object.getOwnPropertySymbols,G$3=Object.prototype.hasOwnProperty,Q$2=Object.prototype.propertyIsEnumerable,K$1=(He,Qe,it)=>Qe in He?se$2(He,Qe,{enumerable:!0,configurable:!0,writable:!0,value:it}):He[Qe]=it,l$2=(He,Qe)=>{for(var it in Qe||(Qe={}))G$3.call(Qe,it)&&K$1(He,it,Qe[it]);if(v$3)for(var it of v$3(Qe))Q$2.call(Qe,it)&&K$1(He,it,Qe[it]);return He},X$2=(He,Qe)=>{var it={};for(var lt in He)G$3.call(He,lt)&&Qe.indexOf(lt)<0&&(it[lt]=He[lt]);if(He!=null&&v$3)for(var lt of v$3(He))Qe.indexOf(lt)<0&&Q$2.call(He,lt)&&(it[lt]=He[lt]);return it},f$2=(He,Qe)=>{let it="[react-use-intercom]";switch(He){case"info":console.log(`${it} ${Qe}`);break;case"warn":console.warn(`${it} ${Qe}`);break;case"error":console.error(`${it} ${Qe}`);break;default:console.log(`${it} ${Qe}`)}},I$1=typeof window>"u",C$1=He=>(Object.keys(He).forEach(Qe=>{He[Qe]&&typeof He[Qe]=="object"?C$1(He[Qe]):He[Qe]===void 0&&delete He[Qe]}),He),ce$2=(He,...Qe)=>{if(!I$1&&window.Intercom)return window.Intercom.apply(null,[He,...Qe]);f$2("error",`${He} Intercom instance is not initalized yet`)},a$1=ce$2,ie$2=reactExports.createContext(void 0),A$4=ie$2,me$1=(He,Qe=0,it)=>{var lt=window,ut=lt.Intercom;if(typeof ut=="function")ut("reattach_activator"),ut("update",lt.intercomSettings);else{var dt=document,xt=function(){xt.c(arguments)};xt.q=[],xt.c=function(vt){xt.q.push(vt)},lt.Intercom=xt;var ft=function(){setTimeout(function(){var vt=dt.createElement("script");vt.type="text/javascript",vt.async=!0,it&&vt.setAttribute("nonce",it),vt.src="https://widget.intercom.io/widget/"+He;var kt=dt.getElementsByTagName("script")[0];kt.parentNode.insertBefore(vt,kt)},Qe)};document.readyState==="complete"?ft():lt.attachEvent?lt.attachEvent("onload",ft):lt.addEventListener("load",ft,!1)}},H$3=me$1,le$1=He=>({custom_launcher_selector:He.customLauncherSelector,alignment:He.alignment,vertical_padding:He.verticalPadding,horizontal_padding:He.horizontalPadding,z_index:He.zIndex,hide_default_launcher:He.hideDefaultLauncher,session_duration:He.sessionDuration,action_color:He.actionColor,background_color:He.backgroundColor}),ee$1=He=>l$2({company_id:He.companyId,name:He.name,created_at:He.createdAt,plan:He.plan,monthly_spend:He.monthlySpend,user_count:He.userCount,size:He.size,website:He.website,industry:He.industry},He.customAttributes),ue$1=He=>({type:He.type,image_url:He.imageUrl}),de=He=>{var Qe;return l$2({email:He.email,user_id:He.userId,created_at:He.createdAt,name:He.name,phone:He.phone,last_request_at:He.lastRequestAt,unsubscribed_from_emails:He.unsubscribedFromEmails,language_override:He.languageOverride,utm_campaign:He.utmCampaign,utm_content:He.utmContent,utm_medium:He.utmMedium,utm_source:He.utmSource,utm_term:He.utmTerm,avatar:He.avatar&&ue$1(He.avatar),user_hash:He.userHash,company:He.company&&ee$1(He.company),companies:(Qe=He.companies)==null?void 0:Qe.map(ee$1),intercom_user_jwt:He.intercomUserJwt},He.customAttributes)},b$2=He=>C$1(l$2(l$2({},le$1(He)),de(He))),pe$1=He=>{var Qe=He,{appId:it,autoBoot:lt=!1,autoBootProps:ut,children:dt,onHide:xt,onShow:ft,onUnreadCountChange:vt,onUserEmailSupplied:kt,shouldInitialize:St=!I$1,apiBase:Tt,initializeDelay:Mt,cspNonce:Nt}=Qe,At=X$2(Qe,["appId","autoBoot","autoBootProps","children","onHide","onShow","onUnreadCountChange","onUserEmailSupplied","shouldInitialize","apiBase","initializeDelay","cspNonce"]);let $t=reactExports.useRef(!1),Dt=reactExports.useRef(!1),[Ft,Bt]=reactExports.useState(!1),Ot=Object.keys(At).filter(Nr=>!Nr.startsWith("data-"));Ot.length>0&&f$2("warn",["some invalid props were passed to IntercomProvider. ",`Please check following props: ${Ot.join(", ")}.`].join(""));let Qt=reactExports.useCallback(Nr=>{if(!window.Intercom&&!St){f$2("warn","Intercom instance is not initialized because `shouldInitialize` is set to `false` in `IntercomProvider`");return}if($t.current)return;a$1("onHide",()=>{Bt(!1),xt?.()}),a$1("onShow",()=>{Bt(!0),ft?.()}),a$1("onUserEmailSupplied",kt),vt&&a$1("onUnreadCountChange",vt);let Jr=l$2(l$2({app_id:it},Tt&&{api_base:Tt}),Nr&&b$2(Nr));window.intercomSettings=Jr,a$1("boot",Jr),$t.current=!0},[Tt,it,xt,ft,vt,kt,St]);!I$1&&St&&!Dt.current&&(H$3(it,Mt,Nt),lt&&Qt(ut),Dt.current=!0);let Wt=reactExports.useCallback((Nr,Jr)=>{if(!window.Intercom&&!St){f$2("warn","Intercom instance is not initialized because `shouldInitialize` is set to `false` in `IntercomProvider`");return}if(!$t.current){f$2("warn",[`"${Nr}" was called but Intercom has not booted yet. `,`Please call 'boot' before calling '${Nr}' or `,"set 'autoBoot' to true in the IntercomProvider."].join(""));return}return Jr()},[St]),Xt=reactExports.useCallback(()=>{$t.current&&(a$1("shutdown"),delete window.intercomSettings,$t.current=!1)},[]),Kt=reactExports.useCallback(()=>{$t.current&&(a$1("shutdown"),delete window.Intercom,delete window.intercomSettings,$t.current=!1)},[]),Jt=reactExports.useCallback(()=>{Wt("update",()=>{let Nr=Math.floor(new Date().getTime()/1e3);a$1("update",{last_request_at:Nr})})},[Wt]),hr=reactExports.useCallback(Nr=>{Wt("update",()=>{if(!Nr){Jt();return}let Jr=b$2(Nr);window.intercomSettings=l$2(l$2({},window.intercomSettings),Jr),a$1("update",Jr)})},[Wt,Jt]),xr=reactExports.useCallback(()=>{Wt("hide",()=>{a$1("hide")})},[Wt]),gr=reactExports.useCallback(()=>{Wt("show",()=>a$1("show"))},[Wt]),br=reactExports.useCallback(()=>{Wt("showMessages",()=>{a$1("showMessages")})},[Wt]),vr=reactExports.useCallback(Nr=>{Wt("showNewMessage",()=>{Nr?a$1("showNewMessage",Nr):a$1("showNewMessage")})},[Wt]),yr=reactExports.useCallback(()=>Wt("getVisitorId",()=>a$1("getVisitorId")),[Wt]),Cr=reactExports.useCallback(Nr=>{Wt("startTour",()=>{a$1("startTour",Nr)})},[Wt]),Rr=reactExports.useCallback(Nr=>{Wt("startChecklist",()=>{a$1("startChecklist",Nr)})},[Wt]),Ir=reactExports.useCallback((Nr,Jr)=>{Wt("trackEvent",()=>{Jr?a$1("trackEvent",Nr,Jr):a$1("trackEvent",Nr)})},[Wt]),Tr=reactExports.useCallback(Nr=>Wt("showArticle",()=>{a$1("showArticle",Nr)}),[Wt]),$r=reactExports.useCallback(Nr=>Wt("showSpace",()=>{a$1("showSpace",Nr)}),[Wt]),Zr=reactExports.useCallback(Nr=>{Wt("startSurvey",()=>{a$1("startSurvey",Nr)})},[Wt]),Sr=reactExports.useCallback(Nr=>Wt("showNews",()=>{a$1("showNews",Nr)}),[Wt]),Dr=reactExports.useCallback(Nr=>Wt("showTicket",()=>{a$1("showTicket",Nr)}),[Wt]),wr=reactExports.useCallback(Nr=>Wt("showConversation",()=>{a$1("showConversation",Nr)}),[Wt]),qr=reactExports.useMemo(()=>({boot:Qt,shutdown:Xt,hardShutdown:Kt,update:hr,hide:xr,show:gr,isOpen:Ft,showMessages:br,showNewMessage:vr,getVisitorId:yr,startTour:Cr,startChecklist:Rr,trackEvent:Ir,showArticle:Tr,startSurvey:Zr,showSpace:$r,showNews:Sr,showTicket:Dr,showConversation:wr}),[Qt,Xt,Kt,hr,xr,gr,Ft,br,vr,yr,Cr,Rr,Ir,Tr,Zr,$r,Sr,Dr,wr]);return reactExports.createElement(A$4.Provider,{value:qr},dt)},te$1=()=>{let He=reactExports.useContext(A$4);if(He===void 0)throw new Error('"useIntercom" must be used within `IntercomProvider`.');return He},we$1=()=>te$1(),browser={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var He=1e3,Qe=He*60,it=Qe*60,lt=it*24,ut=lt*7,dt=lt*365.25;ms=function(St,Tt){Tt=Tt||{};var Mt=typeof St;if(Mt==="string"&&St.length>0)return xt(St);if(Mt==="number"&&isFinite(St))return Tt.long?vt(St):ft(St);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(St))};function xt(St){if(St=String(St),!(St.length>100)){var Tt=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(St);if(Tt){var Mt=parseFloat(Tt[1]),Nt=(Tt[2]||"ms").toLowerCase();switch(Nt){case"years":case"year":case"yrs":case"yr":case"y":return Mt*dt;case"weeks":case"week":case"w":return Mt*ut;case"days":case"day":case"d":return Mt*lt;case"hours":case"hour":case"hrs":case"hr":case"h":return Mt*it;case"minutes":case"minute":case"mins":case"min":case"m":return Mt*Qe;case"seconds":case"second":case"secs":case"sec":case"s":return Mt*He;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return Mt;default:return}}}}function ft(St){var Tt=Math.abs(St);return Tt>=lt?Math.round(St/lt)+"d":Tt>=it?Math.round(St/it)+"h":Tt>=Qe?Math.round(St/Qe)+"m":Tt>=He?Math.round(St/He)+"s":St+"ms"}function vt(St){var Tt=Math.abs(St);return Tt>=lt?kt(St,Tt,lt,"day"):Tt>=it?kt(St,Tt,it,"hour"):Tt>=Qe?kt(St,Tt,Qe,"minute"):Tt>=He?kt(St,Tt,He,"second"):St+" ms"}function kt(St,Tt,Mt,Nt){var At=Tt>=Mt*1.5;return Math.round(St/Mt)+" "+Nt+(At?"s":"")}return ms}function setup(He){it.debug=it,it.default=it,it.coerce=vt,it.disable=dt,it.enable=ut,it.enabled=xt,it.humanize=requireMs(),it.destroy=kt,Object.keys(He).forEach(St=>{it[St]=He[St]}),it.names=[],it.skips=[],it.formatters={};function Qe(St){let Tt=0;for(let Mt=0;Mt<St.length;Mt++)Tt=(Tt<<5)-Tt+St.charCodeAt(Mt),Tt|=0;return it.colors[Math.abs(Tt)%it.colors.length]}it.selectColor=Qe;function it(St){let Tt,Mt=null,Nt,At;function $t(...Dt){if(!$t.enabled)return;const Ft=$t,Bt=Number(new Date),Ot=Bt-(Tt||Bt);Ft.diff=Ot,Ft.prev=Tt,Ft.curr=Bt,Tt=Bt,Dt[0]=it.coerce(Dt[0]),typeof Dt[0]!="string"&&Dt.unshift("%O");let Qt=0;Dt[0]=Dt[0].replace(/%([a-zA-Z%])/g,(Xt,Kt)=>{if(Xt==="%%")return"%";Qt++;const Jt=it.formatters[Kt];if(typeof Jt=="function"){const hr=Dt[Qt];Xt=Jt.call(Ft,hr),Dt.splice(Qt,1),Qt--}return Xt}),it.formatArgs.call(Ft,Dt),(Ft.log||it.log).apply(Ft,Dt)}return $t.namespace=St,$t.useColors=it.useColors(),$t.color=it.selectColor(St),$t.extend=lt,$t.destroy=it.destroy,Object.defineProperty($t,"enabled",{enumerable:!0,configurable:!1,get:()=>Mt!==null?Mt:(Nt!==it.namespaces&&(Nt=it.namespaces,At=it.enabled(St)),At),set:Dt=>{Mt=Dt}}),typeof it.init=="function"&&it.init($t),$t}function lt(St,Tt){const Mt=it(this.namespace+(typeof Tt>"u"?":":Tt)+St);return Mt.log=this.log,Mt}function ut(St){it.save(St),it.namespaces=St,it.names=[],it.skips=[];let Tt;const Mt=(typeof St=="string"?St:"").split(/[\s,]+/),Nt=Mt.length;for(Tt=0;Tt<Nt;Tt++)Mt[Tt]&&(St=Mt[Tt].replace(/\*/g,".*?"),St[0]==="-"?it.skips.push(new RegExp("^"+St.slice(1)+"$")):it.names.push(new RegExp("^"+St+"$")))}function dt(){const St=[...it.names.map(ft),...it.skips.map(ft).map(Tt=>"-"+Tt)].join(",");return it.enable(""),St}function xt(St){if(St[St.length-1]==="*")return!0;let Tt,Mt;for(Tt=0,Mt=it.skips.length;Tt<Mt;Tt++)if(it.skips[Tt].test(St))return!1;for(Tt=0,Mt=it.names.length;Tt<Mt;Tt++)if(it.names[Tt].test(St))return!0;return!1}function ft(St){return St.toString().substring(2,St.toString().length-2).replace(/\.\*\?$/,"*")}function vt(St){return St instanceof Error?St.stack||St.message:St}function kt(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return it.enable(it.load()),it}var common$1=setup;(function(He,Qe){var it={};Qe.formatArgs=ut,Qe.save=dt,Qe.load=xt,Qe.useColors=lt,Qe.storage=ft(),Qe.destroy=(()=>{let kt=!1;return()=>{kt||(kt=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),Qe.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function lt(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function ut(kt){if(kt[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+kt[0]+(this.useColors?"%c ":" ")+"+"+He.exports.humanize(this.diff),!this.useColors)return;const St="color: "+this.color;kt.splice(1,0,St,"color: inherit");let Tt=0,Mt=0;kt[0].replace(/%[a-zA-Z%]/g,Nt=>{Nt!=="%%"&&(Tt++,Nt==="%c"&&(Mt=Tt))}),kt.splice(Mt,0,St)}Qe.log=console.debug||console.log||(()=>{});function dt(kt){try{kt?Qe.storage.setItem("debug",kt):Qe.storage.removeItem("debug")}catch{}}function xt(){let kt;try{kt=Qe.storage.getItem("debug")}catch{}return!kt&&typeof process$1<"u"&&"env"in process$1&&(kt=it.DEBUG),kt}function ft(){try{return localStorage}catch{}}He.exports=common$1(Qe);const{formatters:vt}=He.exports;vt.j=function(kt){try{return JSON.stringify(kt)}catch(St){return"[UnexpectedJSONParseError]: "+St.message}}})(browser,browser.exports);var browserExports=browser.exports;const debug=getDefaultExportFromCjs(browserExports),defaultStore$3=getDefaultStore(),TAG_AUTO_COMPLETE_STORAGE_KEY="generator::tag-complete",tagCompleteAtom=atomWithStorage(TAG_AUTO_COMPLETE_STORAGE_KEY,!0),useTagComplete=()=>useAtom(tagCompleteAtom,{store:defaultStore$3});function hasUsedTagComplete(){return window.localStorage?.getItem(TAG_AUTO_COMPLETE_STORAGE_KEY)==="true"}const modelPermissions=["shareImagesOnline","personalUses","commercialUses","shouldCreditAuthor"],ALL_OPTION={value:"",label:"common:visibility.all"},MODEL_USAGE_OPTIONS=[ALL_OPTION,{value:"model",label:"generation:model.label"},{value:"lora",label:"LoRA"}],BASE_MODEL_TYPE_OPTIONS=[ALL_OPTION,{value:"sdv1",label:"SD 1.5"},{value:"sdxl",label:"SDXL"},{value:"dit7",label:"DiT"}],MODEL_SOURCE_OPTIONS=[ALL_OPTION,{value:"pixai",label:"PixAI"},{value:"external",label:"common:sources.external.label"}],TIME_RANGE_OPTIONS=[{value:"",label:"market:search.all-time"},{value:"today",label:"market:search.today"},{value:"this-week",label:"market:search.this-week"},{value:"this-month",label:"market:search.this-month"}],MODEL_ALPHA_TESTER_USER_ROLE="ModelAlphaTester";var GeneratorMode=(He=>(He.Generate="gen",He.Fill="fill",He.EnhanceImage="enhance-image",He.ImageToVideo="image-to-video",He))(GeneratorMode||{});const ALLOWED_GENERATOR_TABS=["editor","enhancement","animation"],DEFAULT_SIZE$2={width:512,height:768},DEFAULT_XL_SIZE={width:768,height:1280},DEFAULT_DITV1_SIZE=DEFAULT_XL_SIZE;function isValidUrl(He){if(!He)return!1;try{return!!new URL(He)}catch{return!1}}function slugify(He){return He.replaceAll(/[^0-9a-zA-Z-\s]/g,"").replaceAll(/\s+/g,"-").replaceAll(/-+/g,"-").slice(0,80).replaceAll(/^-|-$/g,"")}const HASH_RE=/#/g,AMPERSAND_RE=/&/g,SLASH_RE=/\//g,EQUAL_RE=/=/g,PLUS_RE=/\+/g,ENC_CARET_RE=/%5e/gi,ENC_BACKTICK_RE=/%60/gi,ENC_CURLY_OPEN_RE=/%7b/gi,ENC_PIPE_RE=/%7c/gi,ENC_CURLY_CLOSE_RE=/%7d/gi,ENC_SPACE_RE=/%20/gi;function encode(He){return encodeURI(""+He).replace(ENC_PIPE_RE,"|")}function encodeHash(He){return encode(He).replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryValue(He){return encode(typeof He=="string"?He:JSON.stringify(He)).replace(PLUS_RE,"%2B").replace(ENC_SPACE_RE,"+").replace(HASH_RE,"%23").replace(AMPERSAND_RE,"%26").replace(ENC_BACKTICK_RE,"`").replace(ENC_CARET_RE,"^").replace(SLASH_RE,"%2F")}function encodeQueryKey(He){return encodeQueryValue(He).replace(EQUAL_RE,"%3D")}function decode(He=""){try{return decodeURIComponent(""+He)}catch{return""+He}}function decodeQueryKey(He){return decode(He.replace(PLUS_RE," "))}function decodeQueryValue(He){return decode(He.replace(PLUS_RE," "))}function parseQuery(He=""){const Qe={};He[0]==="?"&&(He=He.slice(1));for(const it of He.split("&")){const lt=it.match(/([^=]+)=?(.*)/)||[];if(lt.length<2)continue;const ut=decodeQueryKey(lt[1]);if(ut==="__proto__"||ut==="constructor")continue;const dt=decodeQueryValue(lt[2]||"");Qe[ut]===void 0?Qe[ut]=dt:Array.isArray(Qe[ut])?Qe[ut].push(dt):Qe[ut]=[Qe[ut],dt]}return Qe}function encodeQueryItem(He,Qe){return(typeof Qe=="number"||typeof Qe=="boolean")&&(Qe=String(Qe)),Qe?Array.isArray(Qe)?Qe.map(it=>`${encodeQueryKey(He)}=${encodeQueryValue(it)}`).join("&"):`${encodeQueryKey(He)}=${encodeQueryValue(Qe)}`:encodeQueryKey(He)}function stringifyQuery(He){return Object.keys(He).filter(Qe=>He[Qe]!==void 0).map(Qe=>encodeQueryItem(Qe,He[Qe])).filter(Boolean).join("&")}const PROTOCOL_STRICT_REGEX=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,PROTOCOL_REGEX=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,PROTOCOL_RELATIVE_REGEX=/^([/\\]\s*){2,}[^/\\]/,JOIN_LEADING_SLASH_RE=/^\.?\//;function hasProtocol(He,Qe={}){return typeof Qe=="boolean"&&(Qe={acceptRelative:Qe}),Qe.strict?PROTOCOL_STRICT_REGEX.test(He):PROTOCOL_REGEX.test(He)||(Qe.acceptRelative?PROTOCOL_RELATIVE_REGEX.test(He):!1)}function hasTrailingSlash(He="",Qe){return He.endsWith("/")}function withoutTrailingSlash(He="",Qe){return(hasTrailingSlash(He)?He.slice(0,-1):He)||"/"}function withTrailingSlash(He="",Qe){return He.endsWith("/")?He:He+"/"}function hasLeadingSlash(He=""){return He.startsWith("/")}function withoutLeadingSlash(He=""){return(hasLeadingSlash(He)?He.slice(1):He)||"/"}function withBase(He,Qe){if(isEmptyURL(Qe)||hasProtocol(He))return He;const it=withoutTrailingSlash(Qe);return He.startsWith(it)?He:joinURL(it,He)}function withoutBase(He,Qe){if(isEmptyURL(Qe))return He;const it=withoutTrailingSlash(Qe);if(!He.startsWith(it))return He;const lt=He.slice(it.length);return lt[0]==="/"?lt:"/"+lt}function withQuery(He,Qe){const it=parseURL(He),lt={...parseQuery(it.search),...Qe};return it.search=stringifyQuery(lt),stringifyParsedURL(it)}function isEmptyURL(He){return!He||He==="/"}function isNonEmptyURL(He){return He&&He!=="/"}function joinURL(He,...Qe){let it=He||"";for(const lt of Qe.filter(ut=>isNonEmptyURL(ut)))if(it){const ut=lt.replace(JOIN_LEADING_SLASH_RE,"");it=withTrailingSlash(it)+ut}else it=lt;return it}function joinRelativeURL(...He){const Qe=/\/(?!\/)/,it=He.filter(Boolean),lt=[];let ut=0;for(const xt of it)if(!(!xt||xt==="/")){for(const[ft,vt]of xt.split(Qe).entries())if(!(!vt||vt===".")){if(vt===".."){if(lt.length===1&&hasProtocol(lt[0]))continue;lt.pop(),ut--;continue}if(ft===1&&lt[lt.length-1]?.endsWith(":/")){lt[lt.length-1]+="/"+vt;continue}lt.push(vt),ut++}}let dt=lt.join("/");return ut>=0?it[0]?.startsWith("/")&&!dt.startsWith("/")?dt="/"+dt:it[0]?.startsWith("./")&&!dt.startsWith("./")&&(dt="./"+dt):dt="../".repeat(-1*ut)+dt,it[it.length-1]?.endsWith("/")&&!dt.endsWith("/")&&(dt+="/"),dt}function resolveURL(He="",...Qe){if(typeof He!="string")throw new TypeError(`URL input should be string received ${typeof He} (${He})`);const it=Qe.filter(ut=>isNonEmptyURL(ut));if(it.length===0)return He;const lt=parseURL(He);for(const ut of it){const dt=parseURL(ut);if(dt.pathname&&(lt.pathname=withTrailingSlash(lt.pathname)+withoutLeadingSlash(dt.pathname)),dt.hash&&dt.hash!=="#"&&(lt.hash=dt.hash),dt.search&&dt.search!=="?")if(lt.search&&lt.search!=="?"){const xt=stringifyQuery({...parseQuery(lt.search),...parseQuery(dt.search)});lt.search=xt.length>0?"?"+xt:""}else lt.search=dt.search}return stringifyParsedURL(lt)}function withFragment(He,Qe){if(!Qe||Qe==="#")return He;const it=parseURL(He);return it.hash=Qe===""?"":"#"+encodeHash(Qe),stringifyParsedURL(it)}function withoutHost(He){const Qe=parseURL(He);return(Qe.pathname||"/")+Qe.search+Qe.hash}const protocolRelative=Symbol.for("ufo:protocolRelative");function parseURL(He="",Qe){const it=He.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(it){const[,Tt,Mt=""]=it;return{protocol:Tt.toLowerCase(),pathname:Mt,href:Tt+Mt,auth:"",host:"",search:"",hash:""}}if(!hasProtocol(He,{acceptRelative:!0}))return parsePath(He);const[,lt="",ut,dt=""]=He.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[],[,xt="",ft=""]=dt.match(/([^#/?]*)(.*)?/)||[],{pathname:vt,search:kt,hash:St}=parsePath(ft.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:lt.toLowerCase(),auth:ut?ut.slice(0,Math.max(0,ut.length-1)):"",host:xt,pathname:vt,search:kt,hash:St,[protocolRelative]:!lt}}function parsePath(He=""){const[Qe="",it="",lt=""]=(He.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:Qe,search:it,hash:lt}}function stringifyParsedURL(He){const Qe=He.pathname||"",it=He.search?(He.search.startsWith("?")?"":"?")+He.search:"",lt=He.hash||"",ut=He.auth?He.auth+"@":"",dt=He.host||"";return(He.protocol||He[protocolRelative]?(He.protocol||"")+"//":"")+ut+dt+Qe+it+lt}const attemptParseJSON=He=>{if(He)try{return JSON.parse(He)}catch{}},flattenObject=(He,Qe={},it=[],lt=".")=>{for(const[ut,dt]of Object.entries(He)){if(isPlainObject$1(dt)){flattenObject(dt,Qe,[...it,ut],lt);continue}Qe[[...it,ut].join(lt)]=dt}return Qe},clonePlainObjectDeep=He=>cloneDeepWith(He,Qe=>isPlainObject$1(Qe)?void 0:Qe),isServiceWorkerAvailable=typeof navigator<"u"&&"serviceWorker"in navigator,isNotificationAvailable=typeof window<"u"&&"Notification"in window,isSDModelUnion=N$4.union(GenerationModelType.Sd3MediumModel,GenerationModelType.SdV1Model,GenerationModelType.SdxlModel,GenerationModelType.UnknownModel),isSDModel=a$3(isSDModelUnion),isSDV1Model=a$3(GenerationModelType.SdV1Model),isSD3Model=a$3(GenerationModelType.Sd3MediumModel),isXLModel=a$3(GenerationModelType.SdxlModel),isDitV1Model=a$3(N$4.union(GenerationModelType.Dit7BModel,GenerationModelType.Dit7Model)),isChatModel=a$3(GenerationModelType.Chat),isLoraUnion=N$4.union(GenerationModelType.Lora,GenerationModelType.SdxlLora,GenerationModelType.UserLora,GenerationModelType.UserSdxlLora,GenerationModelType.UnknownLora,GenerationModelType.MultiLora,GenerationModelType.UserMultiLora),isLora=a$3(isLoraUnion),isUserLoraUnion=N$4.union(GenerationModelType.UserLora,GenerationModelType.UserSdxlLora,GenerationModelType.UserMultiLora),isUserLora=a$3(isUserLoraUnion),isUserMultiLora=a$3(GenerationModelType.UserMultiLora);a$3(GenerationModelType.MultiLora);const isMultiUnionLoraUnion=N$4.union(GenerationModelType.UserMultiLora,GenerationModelType.MultiLora),isMultiUnionLora=a$3(isMultiUnionLoraUnion),isXLLora=a$3(N$4.union(GenerationModelType.SdxlLora,GenerationModelType.UserSdxlLora)),isDitV1Lora=a$3(N$4.union(GenerationModelType.Dit7BLora,GenerationModelType.Dit7Lora)),isSDV1Lora=a$3(N$4.union(GenerationModelType.Lora,GenerationModelType.UserLora)),hasModelTypeDisabledAddVersion=a$3(N$4.union(GenerationModelType.UserLora,GenerationModelType.UserSdxlLora)),isModelCompatibleWithVae=a$3(N$4.union(GenerationModelType.SdV1Model,GenerationModelType.SdxlModel)),isModelCompatibleWithIPAdapter=a$3(N$4.union(GenerationModelType.SdV1Model,GenerationModelType.SdxlModel));function isModelCoverAppealable(He){return He?.flag?.isAppealable??!1}function shouldModelBeBlurred(He){return He?.flag?.shouldBlur??!1}function isModelCoverUnderReview(He){return He?.flag?.status===ModerationStatus.Human}function isModelCoverWarned(He){return(isModelCoverUnderReview(He)||He?.flag?.isWarned)??!1}function isLoraCompatWithModel(He,Qe){return!!(isXLModel(He)&&isXLLora(Qe)||isSDV1Model(He)&&isSDV1Lora(Qe)||isDitV1Model(He)&&isDitV1Lora(Qe))}const PIXAI_INHOUSE_TAG_ID="1789814786070330607";function isModelPixaiInhouse(He){return He?He.some(Qe=>Qe.id===PIXAI_INHOUSE_TAG_ID):!1}function hasModelDisabledLowPrio(He){return He?.compatibility?.lowPriority===!1}function hasModelDisabledCnet(He){return He?.compatibility?.controlnet===!1}function hasModelDisabledUpscale(He){return He?.compatibility?.upscale===!1}function hasModelDisabledLora(He){return He?.compatibility?.lora===!1}function hasModelDisabledFaceFix(He){return He?.compatibility?.enableADetailer===!1}function canModelUseStyleMix(He){return He?.compatibility?.styleMix===!0}function hasModelEnabledLightning(He){return He?.compatibility?.lightning===!0}function hasModelEnabledShiftValue(He){return He?.compatibility?.shift===!0}function hasModelEnabledRescaleCfg(He){return He?.compatibility?.rescaleCfg===!0}function hasModelEnabledInferenceConfig(He){return hasModelEnabledRescaleCfg(He)||hasModelEnabledShiftValue(He)}const LIGHTNING_MODE_DEFAULT_PARAMS={lightning:!0,cfgScale:5.5,samplingSteps:8};function isModelEarlyAccess(He){return!!He?.isEarlyAccess}function getModelEarlyAccessRoles(He){const Qe=He?.accessRoleList;return Array.isArray(Qe)?Qe:[]}function isAlphaTestModel(He){return getModelEarlyAccessRoles(He).includes(MODEL_ALPHA_TESTER_USER_ROLE)}const DEFAULT_STYLE_MIX_WEIGHT=1;function getRandomStyleMixRaw(){return Math.floor(Math.random()*99999)}const PROMPT_IN_QUALITY_TAG="__PROMPT__",formatQualityTag=He=>{const Qe=He.prefix??"",it=He.suffix??"";return[Qe,PROMPT_IN_QUALITY_TAG,it].filter(Boolean).join(", ")},USED_MODEL_QUALITY_TAGS_STORAGE_KEY="generator::used-model-quality-tags";function getModelQualityTags(He){const Qe=He?.qualityTags;if(Array.isArray(Qe))return Qe}function canModelUsePresetQualityTags(He){const Qe=getModelQualityTags(He);return Array.isArray(Qe)&&Qe?.length>0}function retrieveQualityTagFromLocalStorage(He){if(!He)return;const Qe=localStorage.getItem(USED_MODEL_QUALITY_TAGS_STORAGE_KEY),it=attemptParseJSON(Qe);if(it?.tags)return it.tags?.[He]}function getDefaultModelForLora(He,Qe){return isDitV1Lora(Qe)?He?.find(it=>it.type===GenerationModelType.Dit7BModel):isXLLora(Qe)?He?.find(it=>it.type===GenerationModelType.SdxlModel&&it.latestAvailableVersion?.extra?.compatibility?.styleMix!==!0):isSDV1Lora(Qe)?He?.find(it=>it.type===GenerationModelType.SdV1Model):He?.[0]}function createModelUrl(He,Qe,it){const lt=typeof He=="string"?He:He.id,ut=typeof Qe=="boolean"?void 0:Qe,dt=typeof ut=="string"?ut:ut?.id;return it=typeof Qe=="boolean"?Qe:it,joinURL(it?window.origin:"",`/model/${lt}-${typeof He=="object"?slugify(He.title):""}`.replace(/-+$/,""),dt||"")}const isLoraCategoryNotSet=a$3({type:N$4.when(isLora),category:N$4.optional(N$4.union(N$4.nullish,""))});a$3({tags:N$4.optional(N$4.union(N$4.nullish,[]))});function isLoraFeatureEnabled(He){return He!=null&&Object.keys(He).length>0}function getDefaultSizeByModelType(He){return isXLModel(He)?DEFAULT_XL_SIZE:isDitV1Model(He)?DEFAULT_DITV1_SIZE:DEFAULT_SIZE$2}function getBaseModelTypeFromLoraVersion(He){return He?.loraBaseModelType}function getModelTypeFromVersion(He){return isMultiUnionLora(He?.modelType)?getBaseModelTypeFromLoraVersion(He):He?.modelType}function getCorrespondingLoraType(He){return $$3(He).with(GenerationModelType.SdV1Model,()=>GenerationModelType.Lora).with(GenerationModelType.SdxlModel,()=>GenerationModelType.SdxlLora).with(GenerationModelType.Dit7BModel,()=>GenerationModelType.Dit7Lora).otherwise(()=>{})}function getLoraTypeFromModelVersion(He){if(!isMultiUnionLora(He?.modelType))return He?.modelType;const Qe=getBaseModelTypeFromLoraVersion(He);return getCorrespondingLoraType(Qe)}function parseModelTypeForSizeSelection(He){return He===GenerationModelType.Dit7BModel?GenerationModelType.Dit7Model:He===GenerationModelType.Chat?GenerationModelType.SdxlModel:He}const OrderOption={challenge:"challenge",random:"random",newest:"newest",oldest:"oldest",dailyRanking:"daily-ranking",followingNews:"following-news",mostLiked:"most-liked",mostUsed:"most-used",trending:"trending",recommended:"recommended"};function isOrderOptionPosSeq(He){return He?[OrderOption.oldest,OrderOption.mostLiked,OrderOption.random,OrderOption.challenge,OrderOption.dailyRanking,OrderOption.followingNews,OrderOption.recommended,OrderOption.mostUsed].includes(He):!1}function isBookmarkOrderOptionPosSeq(He){return He?[OrderOption.newest].includes(He):!1}function translateOrderOptionToQueryOrderBy(He){return $$3(He).with(OrderOption.newest,()=>"-createdAt").with(OrderOption.oldest,()=>"+createdAt").with(OrderOption.mostLiked,()=>"-markInfo.likedCount").with(OrderOption.mostUsed,()=>"-markInfo.refCount").otherwise(()=>{})}function translateOrderOptionToModelListQuery(He){return $$3(He).with({order:OrderOption.newest,keyword:N$4.union(N$4.nullish,"")},()=>"latest").with({order:OrderOption.trending,keyword:N$4.union(N$4.nullish,"")},()=>"trending").otherwise(()=>"meilisearch")}function getPosSeqAndFeedForModelListQuery(He){const Qe=translateOrderOptionToModelListQuery(He);return{posSeq:Qe==="meilisearch"?!0:isOrderOptionPosSeq(He.order),feed:Qe}}function translateOrderOptionForArtworkListQuery(He){return $$3(He).with(OrderOption.trending,()=>OrderOption.random).otherwise(()=>He)}const taskParameterFieldsCollection={common:["extra","priority"],generatorAndI2vProBase:["width","height","prompts","modelId"],workflow:["workflowVersionId","workflowName","workflowId"],i2vPro:["i2vPro"],t2i2v:["t2i2v"],i2vChannel:["channel"],generatorBase:["negativePrompts","samplingSteps","samplingMethod","cfgScale","seed","clipSkip"],batchGen:["batchSize"],i2iPreProcess:["strength"],i2iPostProcess:["strength","mediaId","maskMediaId"],enlarge:["enlarge","enlargeModel"],upscale:["upscale","upscaleDenoisingStrength","upscaleDenoisingSteps","upscaleSampler","enableTile"],lora:["lora","loraParameters"],latentCouple:["latentCouple"],aDetailer:["enableADetailer"],vaeModel:["vaeModelId"],animateDiff:["animateDiff"],inferenceConfig:["inferenceConfig"],chat:["chat"],promptHelperConfig:["promptHelper"],extraFeatures:["lora","controlNets","ipAdapter","qualityTag","styleMix","lightning"]},taskParameterFieldsForTaskList=[...taskParameterFieldsCollection.common,...taskParameterFieldsCollection.generatorAndI2vProBase,...taskParameterFieldsCollection.workflow,...taskParameterFieldsCollection.generatorBase,...taskParameterFieldsCollection.i2vPro,...taskParameterFieldsCollection.t2i2v,...taskParameterFieldsCollection.i2vChannel,...taskParameterFieldsCollection.chat,...taskParameterFieldsCollection.i2iPostProcess,...taskParameterFieldsCollection.lora,...taskParameterFieldsCollection.batchGen,...taskParameterFieldsCollection.enlarge,...taskParameterFieldsCollection.upscale,...taskParameterFieldsCollection.latentCouple,...taskParameterFieldsCollection.aDetailer,...taskParameterFieldsCollection.animateDiff,...taskParameterFieldsCollection.vaeModel,...taskParameterFieldsCollection.inferenceConfig,...taskParameterFieldsCollection.promptHelperConfig,...taskParameterFieldsCollection.extraFeatures],normalizeTags=He=>He?.map(Qe=>typeof Qe=="string"?Qe:Qe.name),taskFieldsToTrack=["samplingSteps","cfgScale","hidePrompts","isPrivate","priority","modelId","batchSize","taskId","activityId"],getTrackAttributes=He=>({...pick$1(He,taskFieldsToTrack),...He?.extra,size:`${He.width??0}x${He.height??0}`,chterId:He.characterId}),getUpsertArtworkTrackAttrs=He=>({...getTrackAttributes(He),isEdit:!!He?.artworkId,hasTitle:!!He?.title?.trim()}),getCreateTaskTrackAttrs=He=>{const Qe=isValuesCnetGenerativeFill(He)||He.isWorkflowGenerativeFill;return{...getTrackAttributes(He),hasQualityTag:He?.qualityTag!=null,hasIPA:He?.ipAdapter?.enabled??!1,hasBaseImage:He?.baseImage!=null,hasBaseInpaint:He?.inpaintMaskImage!=null,isHomepage:!!He?.isHomepage,hasBaseControl:He.controlNets!=null&&He.controlNets.length>0,hasBaseLoRA:isLoraFeatureEnabled(He.lora),hasBaseCompo:He?.latentCouple!=null&&Object.keys(He.latentCouple).length>0,hasBaseHires:He?.upscaleDenoisingStrength!=null,hasEnableTile:!!He?.enableTile,hasEnableADetailer:!!He?.enableADetailer,hasCustomizedClipSkip:He.clipSkip!=null&&He.clipSkip!==2,vaeModelId:He?.vaeModelId,upscaleMethod:(He.enlarge??0)>=1&&He.enlargeModel?"upscale":(He.upscale??0)>=1?"enhance":"none",fillEditorType:Qe?He.fillEditorType:void 0,hasBaseFill:isValuesCnetGenerativeFill(He),generativeFillType:isValuesCnetGenerativeFill(He)?He.generativeFillType:void 0,isWorkflowGenerativeFill:He.isWorkflowGenerativeFill,hasBrush:He.isWorkflowGenerativeFill&&He.fillEditorType==="inpaint"?He.hasBrush:void 0,hasBox:He.isWorkflowGenerativeFill&&He.fillEditorType==="inpaint"?He.hasBox:void 0,hasLasso:He.isWorkflowGenerativeFill&&He.fillEditorType==="inpaint"?He.hasLasso:void 0,enablePromptsRewrite:He.enablePromptsRewrite,hasAutoComplete:hasUsedTagComplete(),hasStyleMix:!!He.styleMix?.enabled,hasT2i2v:!!He.t2i2v?.enabled,t2i2vDuration:He.t2i2v?.enabled?He.t2i2v?.i2vPro?.duration:void 0}},artworkBaseInfoFields=["prompts","hidePrompts","isPrivate","title","extra"],getArtworkBaseInfoInputValues=He=>{const{tags:Qe,media:it}=He;return{...pick$1(He,artworkBaseInfoFields),mediaId:it?.id,tags:normalizeTags(Qe)}},getUpsertArtworkInput=He=>getArtworkBaseInfoInputValues(He),taskParameterFields=[...taskParameterFieldsCollection.common,...taskParameterFieldsCollection.generatorAndI2vProBase,...taskParameterFieldsCollection.generatorBase],getCreateTaskParameters=(He,{baseImageMedia:Qe,maskImageMedia:it,naturalPrompts:lt,modelVersion:ut}={})=>{const{width:dt,height:xt,lora:ft,latentCouple:vt,batchSize:kt,enlarge:St,enlargeModel:Tt,upscale:Mt}=He,Nt=isValuesI2i(He),At=isValuesControlNet(He),$t=isValuesCnetGenerativeFill(He),Dt=it!=null,Ft=ft!=null&&Object.keys(ft).length>0,Bt=vt!=null&&Object.keys(vt).length>0,Ot=(kt??1)>1,Qt=(St??0)>=1&&Tt,Wt=(Mt??0)>1,Xt=At?He.controlNets:[],Kt=!!He.vaeModelId,Jt={...getUpsertArtworkInput(He),...pick$1(He,[...taskParameterFields,...Nt?taskParameterFieldsCollection.i2iPreProcess:[],...Ft?taskParameterFieldsCollection.lora:[],...Bt?taskParameterFieldsCollection.latentCouple:[],...Qt?taskParameterFieldsCollection.enlarge:Wt?taskParameterFieldsCollection.upscale:[],...Ot?taskParameterFieldsCollection.batchGen:[],...Dt?[]:taskParameterFieldsCollection.aDetailer,...Kt?taskParameterFieldsCollection.vaeModel:[]]),...Nt||$t?{}:{width:dt,height:xt},mediaId:Nt?Qe?.id??"STUB":void 0,maskMediaId:it?.id,controlNets:Xt,ipAdapter:He.ipAdapter?.enabled?{enabled:!0,referenceImages:He.ipAdapter?.referenceImages}:void 0,qualityTag:He.qualityTag,characterId:He.characterId,styleMix:He.styleMix?.enabled?He.styleMix:void 0,lightning:He.lightning,t2i2v:He.t2i2v?.enabled?He.t2i2v.i2vPro??{}:void 0,channel:He.t2i2v?.enabled?He.t2i2v.channel??"normal":void 0,...He.extra||lt?{extra:{...He.extra,naturalPrompts:lt}}:{},...lt?{promptHelper:{withStage:!0,userWantToEnable:void 0,enable:void 0}}:{}};return{...Jt,...!Jt.width||!Jt.height?{width:512,height:512}:{},...parseInferenceControl(He,ut)}};function parseInferenceControl(He,Qe){if(!Qe?.extra)return{};const it=hasModelEnabledShiftValue(Qe.extra),lt=hasModelEnabledRescaleCfg(Qe.extra),ut={...He.inferenceConfig};if((!it||!He.inferenceConfig?.modelSampling?.inputs?.shift)&&delete ut.modelSampling,(!lt||He.inferenceConfig?.rescaleCFG!==null&&!He.inferenceConfig?.rescaleCFG)&&delete ut.rescaleCFG,!(Object.keys(ut).length<1))return{inferenceConfig:ut}}const isValuesI2i=He=>He.baseImage!=null,isValuesControlNet=He=>He.controlNets?.some(Qe=>Qe.type==="inpaint")?!0:He.baseImage==null&&He.controlNets!=null&&He.controlNets.length>0,DEFAULT_DIM={width:512,height:768},DIMS=[512,768,1024,1280],replaceDisabledSizes=({width:He,height:Qe})=>He===1024&&Qe===512?{width:768,height:512}:He===512&&Qe===1024?{width:512,height:768}:{width:He,height:Qe},getNearestPresetSize=({width:He,height:Qe})=>{if(!He||!Qe)return DEFAULT_DIM;function it(lt){const ut=DIMS.map(ft=>Math.abs(ft-lt)),dt=Math.min(...ut),xt=ut.indexOf(dt);return xt>-1?xt:0}return replaceDisabledSizes({width:DIMS[it(He)],height:DIMS[it(Qe)]})},isValuesCnetGenerativeFill=He=>!!(He.controlNets??[]).some(Qe=>Qe.type==="inpaint"),isValuesLatentCouple=He=>Object.entries(He.latentCouple??{}).length>0||(He.prompts??"").includes("AND");function getListArtworkFeedFromArgs(He){return $$3(He).with({order:N$4.union(OrderOption.random,OrderOption.trending)},()=>"trending1").with({order:OrderOption.recommended},()=>"recommend-v1").with({order:OrderOption.followingNews},()=>"following_news").with({order:OrderOption.newest},()=>"latest").with({relevantArtworkId:N$4.string.minLength(1)},()=>"relevant-v2").otherwise(()=>{})}function genIdAsNumber(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)}function genId(){return genIdAsNumber().toString()}const genUuid=async()=>{if(typeof self.crypto.randomUUID=="function")return self.crypto.randomUUID();const He=(await __vitePreload(async()=>{const{v4:Qe}=await import("./index-Bodq1MNb.js");return{v4:Qe}},[],import.meta.url)).v4;return He()},genRandomString=(He,Qe="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ")=>{let it="";for(let lt=He;lt>0;--lt)it+=Qe[Math.floor(Math.random()*Qe.length)];return it},enc=new TextEncoder,getKey=memoize$1(He=>crypto.subtle.importKey("raw",enc.encode(He),{name:"HMAC",hash:"SHA-256"},!1,["sign"])),arrayBufferToHex=He=>[...new Uint8Array(He)].map(Qe=>Qe.toString(16).padStart(2,"0")).join(""),hmacSha256Hex=async(He,Qe)=>{const it=await crypto.subtle.sign("HMAC",await getKey(He),enc.encode(Qe));return arrayBufferToHex(it)},sha256Hex=async He=>{const Qe=await crypto.subtle.digest("SHA-256",He);return arrayBufferToHex(Qe)};class DataTracker{constructor(Qe,it){this.ak=Qe,this.sk=it}queue=[];flushDebounce=0;userId;deviceId;async sign(Qe){const it=this.ak,lt=this.sk,ut=new Date().toISOString(),xt=`pixai-auth-v1/${it}/${ut}/60`,ft=await hmacSha256Hex(lt,xt),vt=await Qe.clone().arrayBuffer(),kt=await sha256Hex(vt),St=new URL(Qe.url),Tt=`${Qe.method}
${St.host}${St.pathname}${St.search}
${kt}`,Mt=await hmacSha256Hex(ft,Tt);Qe.headers.set("Authorization",`${xt}/${Mt}`)}async postBatch(Qe){const it=new Request("https://data-getway.pixai.art/v1/batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({batch:Qe})});try{await this.sign(it),await fetch(it)}catch{}}setUserId(Qe){this.userId=Qe}getDeviceId(){if(this.deviceId)return this.deviceId;const Qe=typeof window<"u"?window.localStorage.getItem("did"):null;if(Qe)return this.deviceId=Qe;const it=getDeviceId()??genId();return typeof window<"u"&&window.localStorage.setItem("did",it),this.deviceId=it}async flush(){this.flushDebounce&&clearTimeout(this.flushDebounce),this.flushDebounce=0;const Qe=this.queue;Qe.length&&(this.queue=[],await this.postBatch(Qe))}track(Qe,it){this.flushDebounce||(this.flushDebounce=setTimeout(()=>this.flush(),1e3)),this.queue.push({event:Qe,properties:it,distinct_id:this.userId,timestamp:Date.now(),device_id:this.getDeviceId(),app_version:config$1.appVersion,platform:"Web"})}setUserProperties(Qe){this.track("set_user_properties",Qe)}}class ApiError extends Error{errors;status;res}class CaptchaError extends Error{}function errorIsApiError(He){return He instanceof ApolloError?He.protocolErrors.length===0&&He.networkError==null:He instanceof ApiError}function errorIsUnknownError(He){return!(errorIsApiError(He)||He instanceof CaptchaError)}function throwError(He){throw new Error(He)}function shouldNotHappen(He){throw new Error("This should not happen")}function missingArgumentError(He){throw new Error(`Missing required argument: ${He}`)}function getErrorMessage(He,Qe){const{errName:it,i18nKeyPrefix:lt}=Qe;return He(`${lt}errors.${kebabCase(it).toLowerCase()}`)}const hash=He=>{if(typeof He=="number")return He;let Qe=0;for(let it=0;it<He.length;it++){const lt=He.charCodeAt(it);Qe=(Qe<<5)-Qe+lt,Qe|=0}return Math.abs(Qe)};function isFunction$1(He){return typeof He=="function"}function createErrorClass(He){var Qe=function(lt){Error.call(lt),lt.stack=new Error().stack},it=He(Qe);return it.prototype=Object.create(Error.prototype),it.prototype.constructor=it,it}var UnsubscriptionError=createErrorClass(function(He){return function(it){He(this),this.message=it?it.length+` errors occurred during unsubscription:
`+it.map(function(lt,ut){return ut+1+") "+lt.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=it}});function arrRemove(He,Qe){if(He){var it=He.indexOf(Qe);0<=it&&He.splice(it,1)}}var Subscription=function(){function He(Qe){this.initialTeardown=Qe,this.closed=!1,this._parentage=null,this._finalizers=null}return He.prototype.unsubscribe=function(){var Qe,it,lt,ut,dt;if(!this.closed){this.closed=!0;var xt=this._parentage;if(xt)if(this._parentage=null,Array.isArray(xt))try{for(var ft=__values$2(xt),vt=ft.next();!vt.done;vt=ft.next()){var kt=vt.value;kt.remove(this)}}catch($t){Qe={error:$t}}finally{try{vt&&!vt.done&&(it=ft.return)&&it.call(ft)}finally{if(Qe)throw Qe.error}}else xt.remove(this);var St=this.initialTeardown;if(isFunction$1(St))try{St()}catch($t){dt=$t instanceof UnsubscriptionError?$t.errors:[$t]}var Tt=this._finalizers;if(Tt){this._finalizers=null;try{for(var Mt=__values$2(Tt),Nt=Mt.next();!Nt.done;Nt=Mt.next()){var At=Nt.value;try{execFinalizer(At)}catch($t){dt=dt??[],$t instanceof UnsubscriptionError?dt=__spreadArray(__spreadArray([],__read$1(dt)),__read$1($t.errors)):dt.push($t)}}}catch($t){lt={error:$t}}finally{try{Nt&&!Nt.done&&(ut=Mt.return)&&ut.call(Mt)}finally{if(lt)throw lt.error}}}if(dt)throw new UnsubscriptionError(dt)}},He.prototype.add=function(Qe){var it;if(Qe&&Qe!==this)if(this.closed)execFinalizer(Qe);else{if(Qe instanceof He){if(Qe.closed||Qe._hasParent(this))return;Qe._addParent(this)}(this._finalizers=(it=this._finalizers)!==null&&it!==void 0?it:[]).push(Qe)}},He.prototype._hasParent=function(Qe){var it=this._parentage;return it===Qe||Array.isArray(it)&&it.includes(Qe)},He.prototype._addParent=function(Qe){var it=this._parentage;this._parentage=Array.isArray(it)?(it.push(Qe),it):it?[it,Qe]:Qe},He.prototype._removeParent=function(Qe){var it=this._parentage;it===Qe?this._parentage=null:Array.isArray(it)&&arrRemove(it,Qe)},He.prototype.remove=function(Qe){var it=this._finalizers;it&&arrRemove(it,Qe),Qe instanceof He&&Qe._removeParent(this)},He.EMPTY=function(){var Qe=new He;return Qe.closed=!0,Qe}(),He}(),EMPTY_SUBSCRIPTION=Subscription.EMPTY;function isSubscription(He){return He instanceof Subscription||He&&"closed"in He&&isFunction$1(He.remove)&&isFunction$1(He.add)&&isFunction$1(He.unsubscribe)}function execFinalizer(He){isFunction$1(He)?He():He.unsubscribe()}var config={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},timeoutProvider={setTimeout:function(He,Qe){for(var it=[],lt=2;lt<arguments.length;lt++)it[lt-2]=arguments[lt];return setTimeout.apply(void 0,__spreadArray([He,Qe],__read$1(it)))},clearTimeout:function(He){return clearTimeout(He)},delegate:void 0};function reportUnhandledError(He){timeoutProvider.setTimeout(function(){throw He})}function noop$4(){}function errorContext(He){He()}var Subscriber=function(He){__extends$2(Qe,He);function Qe(it){var lt=He.call(this)||this;return lt.isStopped=!1,it?(lt.destination=it,isSubscription(it)&&it.add(lt)):lt.destination=EMPTY_OBSERVER,lt}return Qe.create=function(it,lt,ut){return new SafeSubscriber(it,lt,ut)},Qe.prototype.next=function(it){this.isStopped||this._next(it)},Qe.prototype.error=function(it){this.isStopped||(this.isStopped=!0,this._error(it))},Qe.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},Qe.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,He.prototype.unsubscribe.call(this),this.destination=null)},Qe.prototype._next=function(it){this.destination.next(it)},Qe.prototype._error=function(it){try{this.destination.error(it)}finally{this.unsubscribe()}},Qe.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},Qe}(Subscription),ConsumerObserver=function(){function He(Qe){this.partialObserver=Qe}return He.prototype.next=function(Qe){var it=this.partialObserver;if(it.next)try{it.next(Qe)}catch(lt){handleUnhandledError(lt)}},He.prototype.error=function(Qe){var it=this.partialObserver;if(it.error)try{it.error(Qe)}catch(lt){handleUnhandledError(lt)}else handleUnhandledError(Qe)},He.prototype.complete=function(){var Qe=this.partialObserver;if(Qe.complete)try{Qe.complete()}catch(it){handleUnhandledError(it)}},He}(),SafeSubscriber=function(He){__extends$2(Qe,He);function Qe(it,lt,ut){var dt=He.call(this)||this,xt;return isFunction$1(it)||!it?xt={next:it??void 0,error:lt??void 0,complete:ut??void 0}:xt=it,dt.destination=new ConsumerObserver(xt),dt}return Qe}(Subscriber);function handleUnhandledError(He){reportUnhandledError(He)}function defaultErrorHandler(He){throw He}var EMPTY_OBSERVER={closed:!0,next:noop$4,error:defaultErrorHandler,complete:noop$4},observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function identity(He){return He}function pipeFromArray(He){return He.length===0?identity:He.length===1?He[0]:function(it){return He.reduce(function(lt,ut){return ut(lt)},it)}}var Observable=function(){function He(Qe){Qe&&(this._subscribe=Qe)}return He.prototype.lift=function(Qe){var it=new He;return it.source=this,it.operator=Qe,it},He.prototype.subscribe=function(Qe,it,lt){var ut=this,dt=isSubscriber(Qe)?Qe:new SafeSubscriber(Qe,it,lt);return errorContext(function(){var xt=ut,ft=xt.operator,vt=xt.source;dt.add(ft?ft.call(dt,vt):vt?ut._subscribe(dt):ut._trySubscribe(dt))}),dt},He.prototype._trySubscribe=function(Qe){try{return this._subscribe(Qe)}catch(it){Qe.error(it)}},He.prototype.forEach=function(Qe,it){var lt=this;return it=getPromiseCtor(it),new it(function(ut,dt){var xt=new SafeSubscriber({next:function(ft){try{Qe(ft)}catch(vt){dt(vt),xt.unsubscribe()}},error:dt,complete:ut});lt.subscribe(xt)})},He.prototype._subscribe=function(Qe){var it;return(it=this.source)===null||it===void 0?void 0:it.subscribe(Qe)},He.prototype[observable]=function(){return this},He.prototype.pipe=function(){for(var Qe=[],it=0;it<arguments.length;it++)Qe[it]=arguments[it];return pipeFromArray(Qe)(this)},He.prototype.toPromise=function(Qe){var it=this;return Qe=getPromiseCtor(Qe),new Qe(function(lt,ut){var dt;it.subscribe(function(xt){return dt=xt},function(xt){return ut(xt)},function(){return lt(dt)})})},He.create=function(Qe){return new He(Qe)},He}();function getPromiseCtor(He){var Qe;return(Qe=He??config.Promise)!==null&&Qe!==void 0?Qe:Promise}function isObserver(He){return He&&isFunction$1(He.next)&&isFunction$1(He.error)&&isFunction$1(He.complete)}function isSubscriber(He){return He&&He instanceof Subscriber||isObserver(He)&&isSubscription(He)}function hasLift(He){return isFunction$1(He?.lift)}function operate(He){return function(Qe){if(hasLift(Qe))return Qe.lift(function(it){try{return He(it,this)}catch(lt){this.error(lt)}});throw new TypeError("Unable to lift unknown Observable type")}}function createOperatorSubscriber(He,Qe,it,lt,ut){return new OperatorSubscriber(He,Qe,it,lt,ut)}var OperatorSubscriber=function(He){__extends$2(Qe,He);function Qe(it,lt,ut,dt,xt,ft){var vt=He.call(this,it)||this;return vt.onFinalize=xt,vt.shouldUnsubscribe=ft,vt._next=lt?function(kt){try{lt(kt)}catch(St){it.error(St)}}:He.prototype._next,vt._error=dt?function(kt){try{dt(kt)}catch(St){it.error(St)}finally{this.unsubscribe()}}:He.prototype._error,vt._complete=ut?function(){try{ut()}catch(kt){it.error(kt)}finally{this.unsubscribe()}}:He.prototype._complete,vt}return Qe.prototype.unsubscribe=function(){var it;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var lt=this.closed;He.prototype.unsubscribe.call(this),!lt&&((it=this.onFinalize)===null||it===void 0||it.call(this))}},Qe}(Subscriber),ObjectUnsubscribedError=createErrorClass(function(He){return function(){He(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Subject=function(He){__extends$2(Qe,He);function Qe(){var it=He.call(this)||this;return it.closed=!1,it.currentObservers=null,it.observers=[],it.isStopped=!1,it.hasError=!1,it.thrownError=null,it}return Qe.prototype.lift=function(it){var lt=new AnonymousSubject(this,this);return lt.operator=it,lt},Qe.prototype._throwIfClosed=function(){if(this.closed)throw new ObjectUnsubscribedError},Qe.prototype.next=function(it){var lt=this;errorContext(function(){var ut,dt;if(lt._throwIfClosed(),!lt.isStopped){lt.currentObservers||(lt.currentObservers=Array.from(lt.observers));try{for(var xt=__values$2(lt.currentObservers),ft=xt.next();!ft.done;ft=xt.next()){var vt=ft.value;vt.next(it)}}catch(kt){ut={error:kt}}finally{try{ft&&!ft.done&&(dt=xt.return)&&dt.call(xt)}finally{if(ut)throw ut.error}}}})},Qe.prototype.error=function(it){var lt=this;errorContext(function(){if(lt._throwIfClosed(),!lt.isStopped){lt.hasError=lt.isStopped=!0,lt.thrownError=it;for(var ut=lt.observers;ut.length;)ut.shift().error(it)}})},Qe.prototype.complete=function(){var it=this;errorContext(function(){if(it._throwIfClosed(),!it.isStopped){it.isStopped=!0;for(var lt=it.observers;lt.length;)lt.shift().complete()}})},Qe.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(Qe.prototype,"observed",{get:function(){var it;return((it=this.observers)===null||it===void 0?void 0:it.length)>0},enumerable:!1,configurable:!0}),Qe.prototype._trySubscribe=function(it){return this._throwIfClosed(),He.prototype._trySubscribe.call(this,it)},Qe.prototype._subscribe=function(it){return this._throwIfClosed(),this._checkFinalizedStatuses(it),this._innerSubscribe(it)},Qe.prototype._innerSubscribe=function(it){var lt=this,ut=this,dt=ut.hasError,xt=ut.isStopped,ft=ut.observers;return dt||xt?EMPTY_SUBSCRIPTION:(this.currentObservers=null,ft.push(it),new Subscription(function(){lt.currentObservers=null,arrRemove(ft,it)}))},Qe.prototype._checkFinalizedStatuses=function(it){var lt=this,ut=lt.hasError,dt=lt.thrownError,xt=lt.isStopped;ut?it.error(dt):xt&&it.complete()},Qe.prototype.asObservable=function(){var it=new Observable;return it.source=this,it},Qe.create=function(it,lt){return new AnonymousSubject(it,lt)},Qe}(Observable),AnonymousSubject=function(He){__extends$2(Qe,He);function Qe(it,lt){var ut=He.call(this)||this;return ut.destination=it,ut.source=lt,ut}return Qe.prototype.next=function(it){var lt,ut;(ut=(lt=this.destination)===null||lt===void 0?void 0:lt.next)===null||ut===void 0||ut.call(lt,it)},Qe.prototype.error=function(it){var lt,ut;(ut=(lt=this.destination)===null||lt===void 0?void 0:lt.error)===null||ut===void 0||ut.call(lt,it)},Qe.prototype.complete=function(){var it,lt;(lt=(it=this.destination)===null||it===void 0?void 0:it.complete)===null||lt===void 0||lt.call(it)},Qe.prototype._subscribe=function(it){var lt,ut;return(ut=(lt=this.source)===null||lt===void 0?void 0:lt.subscribe(it))!==null&&ut!==void 0?ut:EMPTY_SUBSCRIPTION},Qe}(Subject),BehaviorSubject=function(He){__extends$2(Qe,He);function Qe(it){var lt=He.call(this)||this;return lt._value=it,lt}return Object.defineProperty(Qe.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),Qe.prototype._subscribe=function(it){var lt=He.prototype._subscribe.call(this,it);return!lt.closed&&it.next(this._value),lt},Qe.prototype.getValue=function(){var it=this,lt=it.hasError,ut=it.thrownError,dt=it._value;if(lt)throw ut;return this._throwIfClosed(),dt},Qe.prototype.next=function(it){He.prototype.next.call(this,this._value=it)},Qe}(Subject);function map$2(He,Qe){return operate(function(it,lt){var ut=0;it.subscribe(createOperatorSubscriber(lt,function(dt){lt.next(He.call(Qe,dt,ut++))}))})}function filter$3(He,Qe){return operate(function(it,lt){var ut=0;it.subscribe(createOperatorSubscriber(lt,function(dt){return He.call(Qe,dt,ut++)&&lt.next(dt)}))})}function scanInternals(He,Qe,it,lt,ut){return function(dt,xt){var ft=it,vt=Qe,kt=0;dt.subscribe(createOperatorSubscriber(xt,function(St){var Tt=kt++;vt=ft?He(vt,St,Tt):(ft=!0,St),xt.next(vt)},ut))}}function scan(He,Qe){return operate(scanInternals(He,Qe,arguments.length>=2,!0))}const store$6=getDefaultStore(),ipCountryAtom=atom(null),setIPCountry=He=>{store$6.set(ipCountryAtom,He)},useIPCountry=()=>useSWR$1("geoip:country",async()=>{const He=store$6.get(ipCountryAtom);return He||(await(await fetch("https://get.geojs.io/v1/ip/country.json")).json())?.country},{revalidateOnFocus:!1,revalidateOnReconnect:!1,focusThrottleInterval:1e3*60*60*24}),store$5=getDefaultStore(),wsConnectionStatusAtom=atom("closed"),setWsConnectionStatus=He=>store$5.set(wsConnectionStatusAtom,He),getWsConnectionStatus=()=>store$5.get(wsConnectionStatusAtom),isWebsocketConnected=()=>getWsConnectionStatus()==="connected";function useWsConnectionStatus(He){const Qe=useAtomValue(wsConnectionStatusAtom,{store:store$5});return He?.detailed?Qe:Qe==="connected"}const createRestartableClient=He=>{let Qe=!1,it=()=>{Qe=!0};return{...createClient({...He,on:{...He.on,opened:ut=>{He.on?.opened?.(ut);const dt=ut;it=()=>{dt.readyState===WebSocket.OPEN?dt.close(4205,"Client Restart"):Qe=!0},Qe&&(Qe=!1,it())}}}),restart:()=>it()}},graphqlWsClient=createRestartableClient({url:getWebsocketUrl()+"/graphql",connectionParams(){const He=getToken();if(He)return{token:He}},on:{connecting(){setWsConnectionStatus("connecting")},connected(){setWsConnectionStatus("connected")},closed(){setWsConnectionStatus("closed")}}});let lastUserId$1;const resubscribe=He=>{He!==lastUserId$1&&(lastUserId$1=He,graphqlWsClient.restart())},baseClient=axios.create({baseURL:getApiUrl(),validateStatus:null,withCredentials:!0});baseClient.interceptors.request.use(He=>{const Qe=getToken();Qe&&He.headers.set("Authorization",`Bearer ${Qe}`),bypassAdmin()&&He.headers.set("X-Bypass-Admin","1");const it=getFingerprint();return it&&He.headers.set("X-Browser-ID",it),He});baseClient.interceptors.response.use(He=>{if(He.status===401)setToken(""),unsetIntercomUserJwt();else{const Qe=He.headers.token;Qe&&setToken(Qe)}return He});baseClient.interceptors.response.use(He=>{const Qe=He.headers["x-intercom-user-jwt"];Qe&&setIntercomUserJwt(Qe);const it=He.headers["x-country-code"];return it&&setIPCountry(it),He});const controlNetClient=axios.create({baseURL:"https://controlnet.pixai.art"});controlNetClient.interceptors.request.use(He=>{const Qe=getToken();return Qe&&He.headers.set("Authorization",`Bearer ${Qe}`),He});const captioningClient=axios.create({baseURL:"https://captioning.pixai.art"});captioningClient.interceptors.request.use(He=>{const Qe=getToken();return Qe&&He.headers.set("Authorization",`Bearer ${Qe}`),He});const promptsRewriterClient=axios.create({baseURL:getApiUrl()+"/inference/prompts-rewriter"});promptsRewriterClient.interceptors.request.use(He=>{const Qe=getToken();return Qe&&He.headers.set("Authorization",`Bearer ${Qe}`),He});const faceDetectorClient=axios.create({baseURL:"https://capi.voids.top/inference/face-detector"});faceDetectorClient.interceptors.request.use(He=>{const Qe=getToken();return Qe&&He.headers.set("Authorization",`Bearer ${Qe}`),He.headers.set("Accept","application/json"),He});const dynamicConfigClient=axios.create({baseURL:joinURL(getApiUrl(),"/config")});dynamicConfigClient.interceptors.request.use(He=>{const Qe=getToken();return Qe&&He.headers.set("Authorization",`Bearer ${Qe}`),He.headers.set("Accept","application/json"),He});const subscriptionRequester=(He,Qe)=>new Observable(it=>{graphqlWsClient.subscribe({query:He,variables:Qe},{next(lt){if(lt.errors){const ut=new ApiError(lt.errors[0].message);ut.errors=lt.errors,it.error(ut)}else lt.data&&it.next(lt.data)},error(lt){it.error(lt)},complete(){it.complete()}})}),extractOperationName=He=>{const Qe=He.match(/(?:query|mutation|subscription)\s+(\w+)/);return Qe?Qe[1]:null},normalRequester=async(He,Qe,{token:it,headers:lt,signal:ut}={})=>{const dt={...lt};it&&(dt.Authorization=`Bearer ${it}`);const xt=extractOperationName(He);let ft="/graphql";xt!==null&&(ft=withQuery(ft,{operation:xt}));const vt=await baseClient.post(ft,{query:He,variables:Qe},{headers:dt,signal:ut}),kt=vt.data;if(kt.errors?.length){const St=new ApiError(kt.errors[0].message);throw St.status=vt.status,St.res=vt,St.errors=kt.errors,console.error(St),St}return kt.data},requester=(He,Qe,it)=>He.trimStart().startsWith("subscription")?subscriptionRequester(He,Qe):normalRequester(He,Qe,it),client=getSdk(requester);window.client=client;const getSWRKey=He=>(...Qe)=>Qe.filter(it=>it).length?[He,...Qe]:null,fnId=He=>hash(He.toString()).toString(16),createKeyGetter=He=>He.length?getSWRKey(fnId(He)):()=>fnId(He),globalSWRConfig={onErrorRetry(He,Qe,it,lt,{retryCount:ut}){He instanceof TypeError||He instanceof ApiError||ut>=10||setTimeout(()=>lt({retryCount:ut}),5e3)}},createSWR=(He,Qe)=>{const it=createKeyGetter(He);return{[He.name]:(...ut)=>{const dt=it(...ut);return useSWR$1(dt,([xt,...ft])=>He(...ft),{...Qe})}}[He.name]},createMutator=He=>{const Qe=createKeyGetter(He);return(it,lt,ut)=>{const dt=it?Qe(...it):null;mutate(dt,lt,ut)}},createSWRForGQL=(He,{transform:Qe,reduce:it}={},lt)=>{const ut=vt=>["graphql-operation",He,vt],dt=async([vt,kt,St])=>{const Tt=await client[kt](St);return it&&Tt?it(Tt):Tt};return[(vt,kt)=>{const St=Qe?Qe(vt):vt;return useSWR$1(St!==void 0?ut(St):null,dt,{...lt,...kt})},(vt,kt,St)=>{let Tt;switch(typeof vt){case"function":{Tt=vt;break}case"undefined":{Tt=Mt=>Array.isArray(Mt)&&Mt[0]==="graphql-operation"&&Mt[1]===He;break}default:{const Mt=Qe?Qe(vt):vt;Tt=Mt!==void 0?ut(Mt):null;break}}mutate(Tt,kt,St)}]};let experiment;async function initExperimentClient(){return experiment=Experiment.initializeWithAmplitudeAnalytics(config$1.amplitudeExperimentDeploymentKey,{serverUrl:config$1.amplitudeExperimentsServerUrl,automaticFetchOnAmplitudeIdentityChange:!0}),await experiment.start(),experiment}async function getExperimentParam(He){return experiment?await experiment.fetch():experiment=await initExperimentClient(),experiment.variant(He).value}const _useExperimentParam=createSWR(getExperimentParam),_useExperimentParamWithoutRevalidate=createSWR(getExperimentParam,{revalidateOnFocus:!1}),mutateExperimentParam=createMutator(getExperimentParam);function useExperimentParam(He,Qe,it){const lt=Qe??void 0,{data:ut}=_useExperimentParam(He),[dt]=useLocalStorage({key:`exp:${He}`});return it?.remoteOnly?ut:dt??ut??lt}function experimentLogout(){return experiment?.clear()}function useExperimentParamValue(He,Qe){const{data:it,isLoading:lt}=_useExperimentParamWithoutRevalidate(He),[ut]=useLocalStorage({key:`exp:${He}`,getInitialValueInEffect:!1});return{value:ut??it??Qe,loading:lt}}const log$6=debug("pixai:qs"),getQs=(He=new URL(window.location.href).searchParams)=>Object.fromEntries([...He.entries()]),fromQs=(He,Qe)=>{const it=new URLSearchParams(Qe);return Object.entries(He).forEach(([lt,ut])=>{ut===null?it.delete(lt):ut&&it.set(lt,ut)}),it},formatQs=(He,Qe)=>fromQs(He,Qe).toString(),useQs=()=>{const[He,Qe]=useSearchParams(),it=reactExports.useMemo(()=>getQs(He),[He]),lt=reactExports.useCallback(ut=>{const dt=parseQuery(window.location.search),xt=typeof ut=="function"?ut(dt):ut,ft=fromQs(xt);log$6("setQs",dt,xt),Qe(ft,{replace:!0})},[Qe]);return[it,lt]},formatParamURL=(He,Qe)=>{const it=new URL(He);return Object.entries(Qe).forEach(([lt,ut])=>{ut&&it.searchParams.set(lt,ut)}),it.toString()},sleep=He=>new Promise(Qe=>setTimeout(Qe,He)),log$5=debug("pixai:tracker"),sessionReplayTracking=sessionReplayPlugin({sampleRate:1});init(config$1.amplitudeApiKey,void 0,{serverUrl:config$1.amplitudeServerUrl,defaultTracking:{pageViews:{trackOn:"attribution"}},appVersion:config$1.appVersion});const dataTracker=new DataTracker(config$1.getway.ak,config$1.getway.sk),trackerSetUserId=He=>{isServiceWorkerAvailable&&navigator.serviceWorker.controller?.postMessage({type:"user-sync",userId:He}),setUserId(He),dataTracker.setUserId(He),setUser({id:He}),window.dataLayer?.push({event:"set_user_id",user_id:He}),mutateExperimentParam()},trackerLogout=()=>{setUser(null),setUserId(void 0),dataTracker.setUserId(void 0),window.dataLayer?.push({event:"set_user_id",user_id:null}),mutateExperimentParam()},trackerSetUserProperties=async He=>{log$5("set user properties: %o",He);const Qe=new Identify;for(const[it,lt]of Object.entries(He))lt!==void 0&&Qe.set(it,lt);identify(Qe),dataTracker.setUserProperties(He)};let lastEvent;const STORAGE_KEY_EVENT_GROUP="tracker:event-group";let eventGroups=attemptParseJSON(localStorage.getItem(STORAGE_KEY_EVENT_GROUP))||{};function readEventGroupValues(){return mapValues$1(eventGroups,He=>He.value)}const defaultTrackDestinations=["amplitude","getway","gtm"],SAMPLE_FIDELITY=1e5,shouldReportToAmpUnderSampleRate=He=>{if(He==null||He<0||He>=1)return!0;const Qe=getUserId()||getDeviceId();return Qe==null?!1:murmurHash(Qe)%SAMPLE_FIDELITY<He*SAMPLE_FIDELITY},track=(He,Qe,it)=>{lastEvent=He,Qe={...Qe,...readEventGroupValues()},log$5("event: %s attrs: %o",He,Qe);const lt=[...it?.destinations??defaultTrackDestinations,...it?.extraDestinations??[]];if(lt.includes("getway")&&dataTracker.track(He,Qe),lt.includes("amplitude")){const ut=it?.destinationSampleRate?.amplitude;shouldReportToAmpUnderSampleRate(ut)&&track$1(He,Qe)}lt.includes("gtm")&&window.dataLayer?.push({event:He,...Qe})};function writeEventGroups(){localStorage.setItem(STORAGE_KEY_EVENT_GROUP,JSON.stringify(eventGroups))}function startEventGroup(He,Qe,it){eventGroups[He]={value:Qe??lastEvent,...it},writeEventGroups()}var UpdateEventGroupAction=(He=>(He.Increment="Increment",He))(UpdateEventGroupAction||{});function updateEventGroup(He,Qe){switch(Qe){case"Increment":update(eventGroups,He,it=>({...it,value:(typeof it?.value=="number"?it.value:0)+1}));break}writeEventGroups()}function endEventGroup(He){He===!0?eventGroups=pickBy(eventGroups,Qe=>Qe.persistent):delete eventGroups[He],writeEventGroups()}let lastPathname,lastMatches;function trackPageView({location:He,matches:Qe,params:it,data:lt}){trackActionWithPageViewParams({name:"page_view",location:He,matches:Qe,params:it,data:lt})}function trackActionWithPageViewParams({name:He,location:Qe,matches:it,params:lt,data:ut}){const dt=new URLSearchParams(Qe.search).get("ref")??void 0;track(He,{...lt,pathname:Qe.pathname,routeName:getRouteName(it),...getRouteTrackingData(it),fromPathname:lastPathname,fromRouteName:getRouteName(lastMatches),fromScene:getRouteTrackingData(lastMatches)?.scene,ref:dt,documentWidth:document.documentElement.clientWidth,documentHeight:document.documentElement.clientHeight,...ut}),lastPathname=Qe.pathname,lastMatches=it}const getRouteName=He=>He?.at(-1)?.handle?.name,getRouteTrackingData=He=>{const Qe=He?.findLast(lt=>lt.handle?.track),it=Qe?.handle?.track;if(it)return typeof it=="function"?it(Qe):it};function useTrackPageView(){const He=useLocation(),Qe=useMatches(),it=useParams();return reactExports.useCallback(lt=>{trackPageView({location:He,matches:Qe,params:it,data:lt})},[He,Qe,it])}function useTrackWithPageViewParams(He){const Qe=useLocation(),it=useMatches(),lt=useParams();return reactExports.useCallback(ut=>{trackActionWithPageViewParams({name:He,location:Qe,matches:it,params:lt,data:ut})},[Qe,it,lt])}function useAutoTrackPageView(){const He=useLocation(),Qe=useMatches(),it=useParams(),[lt,ut]=useQs();reactExports.useEffect(()=>{if(He.pathname===lastPathname)return;lt.ref&&(He.pathname.startsWith("/@")?setTimeout(()=>{ut({ref:null})},200):ut({ref:null})),trackPageView({location:He,matches:Qe,params:it})},[He.pathname])}const trackUserPreference=({type:He,action:Qe,taskId:it,currentTaskId:lt,taskParams:ut,publishParams:dt,otherParams:xt})=>{const{scene:ft,mediaIdx:vt,mediaId:kt,duration:St}=xt??{},Tt=Nt=>{const At=Nt.mediaId!=null||Nt.baseImage!=null,$t=(Nt.upscale??0)>1;return{batchSize:Nt.batchSize,useI2i:At,useLoRA:Nt.lora!=null&&Object.keys(Nt.lora).length>0,useControlNet:!At&&Nt.controlNets!=null&&Nt.controlNets.length>0,useHires:!At&&$t&&(Nt.upscaleDenoisingStrength!=null||Nt.upscaleDenoisingSteps!=null),useUpscale:At&&Nt.enlarge>1,useImageEnhance:At&&$t,useGenerativeFill:isValuesCnetGenerativeFill(Nt),useAnimate:!!Nt.animateDiff?.enabled,modelName:Nt.model,modelId:Nt.modelId}},Mt=Nt=>({isPrivate:Nt?.isPrivate??!1,hidePrompts:Nt?.hidePrompts??!1,hasTitle:(Nt?.title!=null&&Nt.title.length>0)??!1,hasTag:(Nt?.tags??[]).length>0,hasDescription:Nt?.extra?.description!=null&&Nt?.extra.description.length>0});return track("user_preference",{type:He,scene:ft,taskId:it,currentTaskId:lt,mediaIdx:vt,mediaId:kt,action:Qe,duration:St,...Tt(ut),...Mt(dt)},{destinations:["getway"]})};class AmplitudeSender{queue=[];processRecoViewPromise=null;intervalMs=500;batchSize=8;send(Qe,it,lt){if(Qe==="reco_artwork_view"){const ut={event:Qe,attrs:it,options:lt};this.queue.push(ut),this.processRecoViewPromise||(this.processRecoViewPromise=this.processRecoView())}track(Qe,it,lt)}async processRecoView(){try{for(await sleep(this.intervalMs);this.queue.length>0;){const Qe=this.queue.splice(0,this.batchSize);if(Qe.length>0){const it=Qe[0].attrs,lt=Qe.map(ut=>ut.attrs);track("reco_artwork_view2",{artworksIds:lt.map(ut=>ut.artworkId),retrieverIds:lt.map(ut=>ut.retrieverId),artworkCount:lt.length,indexBegin:Math.min(...lt.map(ut=>ut.index)),indexEnd:Math.max(...lt.map(ut=>ut.index)),indexAvg:lt.reduce((ut,dt)=>ut+dt.index,0)/lt.length,totalCols:it.totalCols,feed:it.feed,feedSession:it.feedSession,scene:it.scene},{destinations:Qe[0].options?.destinations,destinationSampleRate:{amplitude:1}})}}}catch(Qe){console.error("AmplitudeSender processing error:",Qe)}finally{this.processRecoViewPromise=null}}}const amplitudeSender=new AmplitudeSender;let recoTrackingFeedUuid=null;const RECO_EVENTS_AMPLITUDE_SAMPLE_RATE=.24;async function trackImageForRec(He,Qe,it){try{(recoTrackingFeedUuid==null||it?.regenFeedUuid)&&(recoTrackingFeedUuid=await genUuid())}catch{return}const lt=["getway"],ut={};it?.amplitudeSampleRate!=null&&it.amplitudeSampleRate>0&&(lt.push("amplitude"),ut.amplitude=it.amplitudeSampleRate);const dt={...Qe,feedSession:recoTrackingFeedUuid},xt={destinations:lt,destinationSampleRate:ut};amplitudeSender.send(He,dt,xt)}const RECORD_SESSION_FOR_I2V_EXPERIMENT_NAME="2506-record-session-for-i2v";function SessionReplayExperiment(){const He=useExperimentParam(RECORD_SESSION_FOR_I2V_EXPERIMENT_NAME);return reactExports.useEffect(()=>{let Qe;return He&&(Qe=add(sessionReplayTracking).promise),()=>{Qe&&Qe.then(()=>{remove(sessionReplayTracking.name)})}},[He]),null}const icBaselineAccountCircle=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88a9.947 9.947 0 0 1 12.28 0C16.43 19.18 14.03 20 12 20z"})}),CLASS_PART_SEPARATOR="-",createClassGroupUtils=He=>{const Qe=createClassMap(He),{conflictingClassGroups:it,conflictingClassGroupModifiers:lt}=He;return{getClassGroupId:xt=>{const ft=xt.split(CLASS_PART_SEPARATOR);return ft[0]===""&&ft.length!==1&&ft.shift(),getGroupRecursive(ft,Qe)||getGroupIdForArbitraryProperty(xt)},getConflictingClassGroupIds:(xt,ft)=>{const vt=it[xt]||[];return ft&&lt[xt]?[...vt,...lt[xt]]:vt}}},getGroupRecursive=(He,Qe)=>{if(He.length===0)return Qe.classGroupId;const it=He[0],lt=Qe.nextPart.get(it),ut=lt?getGroupRecursive(He.slice(1),lt):void 0;if(ut)return ut;if(Qe.validators.length===0)return;const dt=He.join(CLASS_PART_SEPARATOR);return Qe.validators.find(({validator:xt})=>xt(dt))?.classGroupId},arbitraryPropertyRegex=/^\[(.+)\]$/,getGroupIdForArbitraryProperty=He=>{if(arbitraryPropertyRegex.test(He)){const Qe=arbitraryPropertyRegex.exec(He)[1],it=Qe?.substring(0,Qe.indexOf(":"));if(it)return"arbitrary.."+it}},createClassMap=He=>{const{theme:Qe,prefix:it}=He,lt={nextPart:new Map,validators:[]};return getPrefixedClassGroupEntries(Object.entries(He.classGroups),it).forEach(([dt,xt])=>{processClassesRecursively(xt,lt,dt,Qe)}),lt},processClassesRecursively=(He,Qe,it,lt)=>{He.forEach(ut=>{if(typeof ut=="string"){const dt=ut===""?Qe:getPart(Qe,ut);dt.classGroupId=it;return}if(typeof ut=="function"){if(isThemeGetter(ut)){processClassesRecursively(ut(lt),Qe,it,lt);return}Qe.validators.push({validator:ut,classGroupId:it});return}Object.entries(ut).forEach(([dt,xt])=>{processClassesRecursively(xt,getPart(Qe,dt),it,lt)})})},getPart=(He,Qe)=>{let it=He;return Qe.split(CLASS_PART_SEPARATOR).forEach(lt=>{it.nextPart.has(lt)||it.nextPart.set(lt,{nextPart:new Map,validators:[]}),it=it.nextPart.get(lt)}),it},isThemeGetter=He=>He.isThemeGetter,getPrefixedClassGroupEntries=(He,Qe)=>Qe?He.map(([it,lt])=>{const ut=lt.map(dt=>typeof dt=="string"?Qe+dt:typeof dt=="object"?Object.fromEntries(Object.entries(dt).map(([xt,ft])=>[Qe+xt,ft])):dt);return[it,ut]}):He,createLruCache=He=>{if(He<1)return{get:()=>{},set:()=>{}};let Qe=0,it=new Map,lt=new Map;const ut=(dt,xt)=>{it.set(dt,xt),Qe++,Qe>He&&(Qe=0,lt=it,it=new Map)};return{get(dt){let xt=it.get(dt);if(xt!==void 0)return xt;if((xt=lt.get(dt))!==void 0)return ut(dt,xt),xt},set(dt,xt){it.has(dt)?it.set(dt,xt):ut(dt,xt)}}},IMPORTANT_MODIFIER="!",createParseClassName=He=>{const{separator:Qe,experimentalParseClassName:it}=He,lt=Qe.length===1,ut=Qe[0],dt=Qe.length,xt=ft=>{const vt=[];let kt=0,St=0,Tt;for(let Dt=0;Dt<ft.length;Dt++){let Ft=ft[Dt];if(kt===0){if(Ft===ut&&(lt||ft.slice(Dt,Dt+dt)===Qe)){vt.push(ft.slice(St,Dt)),St=Dt+dt;continue}if(Ft==="/"){Tt=Dt;continue}}Ft==="["?kt++:Ft==="]"&&kt--}const Mt=vt.length===0?ft:ft.substring(St),Nt=Mt.startsWith(IMPORTANT_MODIFIER),At=Nt?Mt.substring(1):Mt,$t=Tt&&Tt>St?Tt-St:void 0;return{modifiers:vt,hasImportantModifier:Nt,baseClassName:At,maybePostfixModifierPosition:$t}};return it?ft=>it({className:ft,parseClassName:xt}):xt},sortModifiers=He=>{if(He.length<=1)return He;const Qe=[];let it=[];return He.forEach(lt=>{lt[0]==="["?(Qe.push(...it.sort(),lt),it=[]):it.push(lt)}),Qe.push(...it.sort()),Qe},createConfigUtils=He=>({cache:createLruCache(He.cacheSize),parseClassName:createParseClassName(He),...createClassGroupUtils(He)}),SPLIT_CLASSES_REGEX=/\s+/,mergeClassList=(He,Qe)=>{const{parseClassName:it,getClassGroupId:lt,getConflictingClassGroupIds:ut}=Qe,dt=[],xt=He.trim().split(SPLIT_CLASSES_REGEX);let ft="";for(let vt=xt.length-1;vt>=0;vt-=1){const kt=xt[vt],{modifiers:St,hasImportantModifier:Tt,baseClassName:Mt,maybePostfixModifierPosition:Nt}=it(kt);let At=!!Nt,$t=lt(At?Mt.substring(0,Nt):Mt);if(!$t){if(!At){ft=kt+(ft.length>0?" "+ft:ft);continue}if($t=lt(Mt),!$t){ft=kt+(ft.length>0?" "+ft:ft);continue}At=!1}const Dt=sortModifiers(St).join(":"),Ft=Tt?Dt+IMPORTANT_MODIFIER:Dt,Bt=Ft+$t;if(dt.includes(Bt))continue;dt.push(Bt);const Ot=ut($t,At);for(let Qt=0;Qt<Ot.length;++Qt){const Wt=Ot[Qt];dt.push(Ft+Wt)}ft=kt+(ft.length>0?" "+ft:ft)}return ft};function twJoin(){let He=0,Qe,it,lt="";for(;He<arguments.length;)(Qe=arguments[He++])&&(it=toValue(Qe))&&(lt&&(lt+=" "),lt+=it);return lt}const toValue=He=>{if(typeof He=="string")return He;let Qe,it="";for(let lt=0;lt<He.length;lt++)He[lt]&&(Qe=toValue(He[lt]))&&(it&&(it+=" "),it+=Qe);return it};function createTailwindMerge(He,...Qe){let it,lt,ut,dt=xt;function xt(vt){const kt=Qe.reduce((St,Tt)=>Tt(St),He());return it=createConfigUtils(kt),lt=it.cache.get,ut=it.cache.set,dt=ft,ft(vt)}function ft(vt){const kt=lt(vt);if(kt)return kt;const St=mergeClassList(vt,it);return ut(vt,St),St}return function(){return dt(twJoin.apply(null,arguments))}}const fromTheme=He=>{const Qe=it=>it[He]||[];return Qe.isThemeGetter=!0,Qe},arbitraryValueRegex=/^\[(?:([a-z-]+):)?(.+)\]$/i,fractionRegex=/^\d+\/\d+$/,stringLengths=new Set(["px","full","screen"]),tshirtUnitRegex=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lengthUnitRegex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,colorFunctionRegex=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,shadowRegex=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,imageRegex=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,isLength=He=>isNumber(He)||stringLengths.has(He)||fractionRegex.test(He),isArbitraryLength=He=>getIsArbitraryValue(He,"length",isLengthOnly),isNumber=He=>!!He&&!Number.isNaN(Number(He)),isArbitraryNumber=He=>getIsArbitraryValue(He,"number",isNumber),isInteger=He=>!!He&&Number.isInteger(Number(He)),isPercent=He=>He.endsWith("%")&&isNumber(He.slice(0,-1)),isArbitraryValue=He=>arbitraryValueRegex.test(He),isTshirtSize=He=>tshirtUnitRegex.test(He),sizeLabels=new Set(["length","size","percentage"]),isArbitrarySize=He=>getIsArbitraryValue(He,sizeLabels,isNever),isArbitraryPosition=He=>getIsArbitraryValue(He,"position",isNever),imageLabels=new Set(["image","url"]),isArbitraryImage=He=>getIsArbitraryValue(He,imageLabels,isImage),isArbitraryShadow=He=>getIsArbitraryValue(He,"",isShadow),isAny=()=>!0,getIsArbitraryValue=(He,Qe,it)=>{const lt=arbitraryValueRegex.exec(He);return lt?lt[1]?typeof Qe=="string"?lt[1]===Qe:Qe.has(lt[1]):it(lt[2]):!1},isLengthOnly=He=>lengthUnitRegex.test(He)&&!colorFunctionRegex.test(He),isNever=()=>!1,isShadow=He=>shadowRegex.test(He),isImage=He=>imageRegex.test(He),getDefaultConfig=()=>{const He=fromTheme("colors"),Qe=fromTheme("spacing"),it=fromTheme("blur"),lt=fromTheme("brightness"),ut=fromTheme("borderColor"),dt=fromTheme("borderRadius"),xt=fromTheme("borderSpacing"),ft=fromTheme("borderWidth"),vt=fromTheme("contrast"),kt=fromTheme("grayscale"),St=fromTheme("hueRotate"),Tt=fromTheme("invert"),Mt=fromTheme("gap"),Nt=fromTheme("gradientColorStops"),At=fromTheme("gradientColorStopPositions"),$t=fromTheme("inset"),Dt=fromTheme("margin"),Ft=fromTheme("opacity"),Bt=fromTheme("padding"),Ot=fromTheme("saturate"),Qt=fromTheme("scale"),Wt=fromTheme("sepia"),Xt=fromTheme("skew"),Kt=fromTheme("space"),Jt=fromTheme("translate"),hr=()=>["auto","contain","none"],xr=()=>["auto","hidden","clip","visible","scroll"],gr=()=>["auto",isArbitraryValue,Qe],br=()=>[isArbitraryValue,Qe],vr=()=>["",isLength,isArbitraryLength],yr=()=>["auto",isNumber,isArbitraryValue],Cr=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Rr=()=>["solid","dashed","dotted","double","none"],Ir=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Tr=()=>["start","end","center","between","around","evenly","stretch"],$r=()=>["","0",isArbitraryValue],Zr=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Sr=()=>[isNumber,isArbitraryValue];return{cacheSize:500,separator:":",theme:{colors:[isAny],spacing:[isLength,isArbitraryLength],blur:["none","",isTshirtSize,isArbitraryValue],brightness:Sr(),borderColor:[He],borderRadius:["none","","full",isTshirtSize,isArbitraryValue],borderSpacing:br(),borderWidth:vr(),contrast:Sr(),grayscale:$r(),hueRotate:Sr(),invert:$r(),gap:br(),gradientColorStops:[He],gradientColorStopPositions:[isPercent,isArbitraryLength],inset:gr(),margin:gr(),opacity:Sr(),padding:br(),saturate:Sr(),scale:Sr(),sepia:$r(),skew:Sr(),space:br(),translate:br()},classGroups:{aspect:[{aspect:["auto","square","video",isArbitraryValue]}],container:["container"],columns:[{columns:[isTshirtSize]}],"break-after":[{"break-after":Zr()}],"break-before":[{"break-before":Zr()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Cr(),isArbitraryValue]}],overflow:[{overflow:xr()}],"overflow-x":[{"overflow-x":xr()}],"overflow-y":[{"overflow-y":xr()}],overscroll:[{overscroll:hr()}],"overscroll-x":[{"overscroll-x":hr()}],"overscroll-y":[{"overscroll-y":hr()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[$t]}],"inset-x":[{"inset-x":[$t]}],"inset-y":[{"inset-y":[$t]}],start:[{start:[$t]}],end:[{end:[$t]}],top:[{top:[$t]}],right:[{right:[$t]}],bottom:[{bottom:[$t]}],left:[{left:[$t]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",isInteger,isArbitraryValue]}],basis:[{basis:gr()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",isArbitraryValue]}],grow:[{grow:$r()}],shrink:[{shrink:$r()}],order:[{order:["first","last","none",isInteger,isArbitraryValue]}],"grid-cols":[{"grid-cols":[isAny]}],"col-start-end":[{col:["auto",{span:["full",isInteger,isArbitraryValue]},isArbitraryValue]}],"col-start":[{"col-start":yr()}],"col-end":[{"col-end":yr()}],"grid-rows":[{"grid-rows":[isAny]}],"row-start-end":[{row:["auto",{span:[isInteger,isArbitraryValue]},isArbitraryValue]}],"row-start":[{"row-start":yr()}],"row-end":[{"row-end":yr()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",isArbitraryValue]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",isArbitraryValue]}],gap:[{gap:[Mt]}],"gap-x":[{"gap-x":[Mt]}],"gap-y":[{"gap-y":[Mt]}],"justify-content":[{justify:["normal",...Tr()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Tr(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Tr(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[Bt]}],px:[{px:[Bt]}],py:[{py:[Bt]}],ps:[{ps:[Bt]}],pe:[{pe:[Bt]}],pt:[{pt:[Bt]}],pr:[{pr:[Bt]}],pb:[{pb:[Bt]}],pl:[{pl:[Bt]}],m:[{m:[Dt]}],mx:[{mx:[Dt]}],my:[{my:[Dt]}],ms:[{ms:[Dt]}],me:[{me:[Dt]}],mt:[{mt:[Dt]}],mr:[{mr:[Dt]}],mb:[{mb:[Dt]}],ml:[{ml:[Dt]}],"space-x":[{"space-x":[Kt]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Kt]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",isArbitraryValue,Qe]}],"min-w":[{"min-w":[isArbitraryValue,Qe,"min","max","fit"]}],"max-w":[{"max-w":[isArbitraryValue,Qe,"none","full","min","max","fit","prose",{screen:[isTshirtSize]},isTshirtSize]}],h:[{h:[isArbitraryValue,Qe,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[isArbitraryValue,Qe,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[isArbitraryValue,Qe,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[isArbitraryValue,Qe,"auto","min","max","fit"]}],"font-size":[{text:["base",isTshirtSize,isArbitraryLength]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",isArbitraryNumber]}],"font-family":[{font:[isAny]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",isArbitraryValue]}],"line-clamp":[{"line-clamp":["none",isNumber,isArbitraryNumber]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",isLength,isArbitraryValue]}],"list-image":[{"list-image":["none",isArbitraryValue]}],"list-style-type":[{list:["none","disc","decimal",isArbitraryValue]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[He]}],"placeholder-opacity":[{"placeholder-opacity":[Ft]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[He]}],"text-opacity":[{"text-opacity":[Ft]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Rr(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",isLength,isArbitraryLength]}],"underline-offset":[{"underline-offset":["auto",isLength,isArbitraryValue]}],"text-decoration-color":[{decoration:[He]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:br()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",isArbitraryValue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",isArbitraryValue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[Ft]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Cr(),isArbitraryPosition]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",isArbitrarySize]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},isArbitraryImage]}],"bg-color":[{bg:[He]}],"gradient-from-pos":[{from:[At]}],"gradient-via-pos":[{via:[At]}],"gradient-to-pos":[{to:[At]}],"gradient-from":[{from:[Nt]}],"gradient-via":[{via:[Nt]}],"gradient-to":[{to:[Nt]}],rounded:[{rounded:[dt]}],"rounded-s":[{"rounded-s":[dt]}],"rounded-e":[{"rounded-e":[dt]}],"rounded-t":[{"rounded-t":[dt]}],"rounded-r":[{"rounded-r":[dt]}],"rounded-b":[{"rounded-b":[dt]}],"rounded-l":[{"rounded-l":[dt]}],"rounded-ss":[{"rounded-ss":[dt]}],"rounded-se":[{"rounded-se":[dt]}],"rounded-ee":[{"rounded-ee":[dt]}],"rounded-es":[{"rounded-es":[dt]}],"rounded-tl":[{"rounded-tl":[dt]}],"rounded-tr":[{"rounded-tr":[dt]}],"rounded-br":[{"rounded-br":[dt]}],"rounded-bl":[{"rounded-bl":[dt]}],"border-w":[{border:[ft]}],"border-w-x":[{"border-x":[ft]}],"border-w-y":[{"border-y":[ft]}],"border-w-s":[{"border-s":[ft]}],"border-w-e":[{"border-e":[ft]}],"border-w-t":[{"border-t":[ft]}],"border-w-r":[{"border-r":[ft]}],"border-w-b":[{"border-b":[ft]}],"border-w-l":[{"border-l":[ft]}],"border-opacity":[{"border-opacity":[Ft]}],"border-style":[{border:[...Rr(),"hidden"]}],"divide-x":[{"divide-x":[ft]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[ft]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[Ft]}],"divide-style":[{divide:Rr()}],"border-color":[{border:[ut]}],"border-color-x":[{"border-x":[ut]}],"border-color-y":[{"border-y":[ut]}],"border-color-t":[{"border-t":[ut]}],"border-color-r":[{"border-r":[ut]}],"border-color-b":[{"border-b":[ut]}],"border-color-l":[{"border-l":[ut]}],"divide-color":[{divide:[ut]}],"outline-style":[{outline:["",...Rr()]}],"outline-offset":[{"outline-offset":[isLength,isArbitraryValue]}],"outline-w":[{outline:[isLength,isArbitraryLength]}],"outline-color":[{outline:[He]}],"ring-w":[{ring:vr()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[He]}],"ring-opacity":[{"ring-opacity":[Ft]}],"ring-offset-w":[{"ring-offset":[isLength,isArbitraryLength]}],"ring-offset-color":[{"ring-offset":[He]}],shadow:[{shadow:["","inner","none",isTshirtSize,isArbitraryShadow]}],"shadow-color":[{shadow:[isAny]}],opacity:[{opacity:[Ft]}],"mix-blend":[{"mix-blend":[...Ir(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Ir()}],filter:[{filter:["","none"]}],blur:[{blur:[it]}],brightness:[{brightness:[lt]}],contrast:[{contrast:[vt]}],"drop-shadow":[{"drop-shadow":["","none",isTshirtSize,isArbitraryValue]}],grayscale:[{grayscale:[kt]}],"hue-rotate":[{"hue-rotate":[St]}],invert:[{invert:[Tt]}],saturate:[{saturate:[Ot]}],sepia:[{sepia:[Wt]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[it]}],"backdrop-brightness":[{"backdrop-brightness":[lt]}],"backdrop-contrast":[{"backdrop-contrast":[vt]}],"backdrop-grayscale":[{"backdrop-grayscale":[kt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[St]}],"backdrop-invert":[{"backdrop-invert":[Tt]}],"backdrop-opacity":[{"backdrop-opacity":[Ft]}],"backdrop-saturate":[{"backdrop-saturate":[Ot]}],"backdrop-sepia":[{"backdrop-sepia":[Wt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[xt]}],"border-spacing-x":[{"border-spacing-x":[xt]}],"border-spacing-y":[{"border-spacing-y":[xt]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",isArbitraryValue]}],duration:[{duration:Sr()}],ease:[{ease:["linear","in","out","in-out",isArbitraryValue]}],delay:[{delay:Sr()}],animate:[{animate:["none","spin","ping","pulse","bounce",isArbitraryValue]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[Qt]}],"scale-x":[{"scale-x":[Qt]}],"scale-y":[{"scale-y":[Qt]}],rotate:[{rotate:[isInteger,isArbitraryValue]}],"translate-x":[{"translate-x":[Jt]}],"translate-y":[{"translate-y":[Jt]}],"skew-x":[{"skew-x":[Xt]}],"skew-y":[{"skew-y":[Xt]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",isArbitraryValue]}],accent:[{accent:["auto",He]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",isArbitraryValue]}],"caret-color":[{caret:[He]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":br()}],"scroll-mx":[{"scroll-mx":br()}],"scroll-my":[{"scroll-my":br()}],"scroll-ms":[{"scroll-ms":br()}],"scroll-me":[{"scroll-me":br()}],"scroll-mt":[{"scroll-mt":br()}],"scroll-mr":[{"scroll-mr":br()}],"scroll-mb":[{"scroll-mb":br()}],"scroll-ml":[{"scroll-ml":br()}],"scroll-p":[{"scroll-p":br()}],"scroll-px":[{"scroll-px":br()}],"scroll-py":[{"scroll-py":br()}],"scroll-ps":[{"scroll-ps":br()}],"scroll-pe":[{"scroll-pe":br()}],"scroll-pt":[{"scroll-pt":br()}],"scroll-pr":[{"scroll-pr":br()}],"scroll-pb":[{"scroll-pb":br()}],"scroll-pl":[{"scroll-pl":br()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",isArbitraryValue]}],fill:[{fill:[He,"none"]}],"stroke-w":[{stroke:[isLength,isArbitraryLength,isArbitraryNumber]}],stroke:[{stroke:[He,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},mergeConfigs=(He,{cacheSize:Qe,prefix:it,separator:lt,experimentalParseClassName:ut,extend:dt={},override:xt={}})=>{overrideProperty(He,"cacheSize",Qe),overrideProperty(He,"prefix",it),overrideProperty(He,"separator",lt),overrideProperty(He,"experimentalParseClassName",ut);for(const ft in xt)overrideConfigProperties(He[ft],xt[ft]);for(const ft in dt)mergeConfigProperties(He[ft],dt[ft]);return He},overrideProperty=(He,Qe,it)=>{it!==void 0&&(He[Qe]=it)},overrideConfigProperties=(He,Qe)=>{if(Qe)for(const it in Qe)overrideProperty(He,it,Qe[it])},mergeConfigProperties=(He,Qe)=>{if(Qe)for(const it in Qe){const lt=Qe[it];lt!==void 0&&(He[it]=(He[it]||[]).concat(lt))}},extendTailwindMerge=(He,...Qe)=>typeof He=="function"?createTailwindMerge(getDefaultConfig,He,...Qe):createTailwindMerge(()=>mergeConfigs(getDefaultConfig(),He),...Qe),twMerge=createTailwindMerge(getDefaultConfig),cx=(...He)=>He.filter(Qe=>Qe).flatMap(Qe=>typeof Qe=="string"?Qe.split(`
`).filter(it=>!it.trim().startsWith("//")):Object.entries(Qe).filter(([,it])=>it).map(([it])=>it)).join(" ").split(/\s/).filter(Qe=>Qe.trim()).join(" "),gameIconsCrystalBars=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 512 512",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m196.844 14.125l-8.75 2.906l-43.22 13.44l-3.5 1.155l-1.75 2.938L30.75 206.593l-14 21.032l5.344 15.156L41.5 308.47l2.344 7l7.594-.595l74.156-4.687l6.437-.563l1.75-5.844l77.095-239.436l1.156-2.938l-1.155-2.906l-11.125-35.625l-2.03-6.094l-.032-.25h-.032l-.812-2.405zm123.812 5.25l-2.906 5.844l-18.125 40.874l-1.75 3.5l1.188 4.094L383.156 274l1.75 4.656l4.657 1.188l64.843 14.03l7.594 1.157V295l2.906-7l26.875-60.72l1.75-4.092l-1.75-4.094L390.157 28.688l-2.343-4.657l-5.25-.592l-55.47-3.5zM184.594 37.47l7.562 23.936l-.906 2.844l-89.594 174.125l23.625 31.094l-6.874 21.31l-32.78-42.5l-42.563-.842L38 230.188l1-1.563l46.094.938L183.72 37.75zm147.156 1.75l16.47.874l76.343 153.22l36.5 8.374l11.53 21.718l-48.468-10.656l-7.22 53.438l-18.436-3.844L407.093 201l-77.53-156.72l2.186-5.06zm-79.437 85.28l-5.25 3.5l-37.375 25.094l-3.5 2.344l-.594 4.093L166.47 416.5l-.564 5.25l4.063 3.5l76.53 63.656l6.406 5.282l5.844-5.282l75.344-66.562l4.094-2.938l-.594-4.656l-28.625-251.125l-.564-4.094l-4.093-2.342l-46.72-29.782l-5.28-2.906zm.562 22.53l19.5 12.095l12.25 202.406l30.844 24.908l2.843 24.812l-.875.78l-40.594-32.905l-75.156 48.188l-15.094-12.47l79.437-50.687l-13.155-217.125zm108.438 148.345l-7.5 37.563l32.218 94l33.595 14.968l19.438-39.375l-48.094-85.155zM108.625 350.5l-29.687 10.813L32 431.47l2.625 34.593l31.188-12.75l46.937-70.188z"})});function MembershipIcon(He){return jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M14 5c0 .53-.206 1.012-.543 1.37l2.624 3.28a.25.25 0 0 0 .307.068l2.65-1.326A2.004 2.004 0 0 1 21 6a2 2 0 0 1 .444 3.95l-1.804 9.623A1.75 1.75 0 0 1 17.92 21H6.08a1.75 1.75 0 0 1-1.72-1.427L2.556 9.95a2 2 0 1 1 2.406-1.558l2.65 1.326a.25.25 0 0 0 .307-.068l2.624-3.28A2 2 0 1 1 14 5Zm-2 12a2 2 0 1 0 0-4a2 2 0 0 0 0 4Z"})})}function CreditsIcon(He){return jsxRuntimeExports.jsx(gameIconsCrystalBars,{...He})}function MembershipIconCircled(He){return jsxRuntimeExports.jsx("span",{...He,className:twMerge("grid grid-rows-1 grid-cols-1 place-items-center bg-gradient-purple-pink rounded-full","size-[1em]",He.className),children:jsxRuntimeExports.jsx(MembershipIcon,{...He.svgProps,className:twMerge("size-full scale-75 text-white",He.svgProps?.className)})})}const IMG_ICE_CREAM_2025="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ice_cream_2025-D3lNvft2.webp",IMG_SODA_FLOAT_2025="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/soda_float_2025-CW8VIgoJ.webp";var NOTHING=Symbol.for("immer-nothing"),DRAFTABLE=Symbol.for("immer-draftable"),DRAFT_STATE=Symbol.for("immer-state");function die(He,...Qe){throw new Error(`[Immer] minified error nr: ${He}. Full error at: https://bit.ly/3cXEKWf`)}var getPrototypeOf=Object.getPrototypeOf;function isDraft(He){return!!He&&!!He[DRAFT_STATE]}function isDraftable(He){return He?isPlainObject(He)||Array.isArray(He)||!!He[DRAFTABLE]||!!He.constructor?.[DRAFTABLE]||isMap(He)||isSet(He):!1}var objectCtorString=Object.prototype.constructor.toString();function isPlainObject(He){if(!He||typeof He!="object")return!1;const Qe=getPrototypeOf(He);if(Qe===null)return!0;const it=Object.hasOwnProperty.call(Qe,"constructor")&&Qe.constructor;return it===Object?!0:typeof it=="function"&&Function.toString.call(it)===objectCtorString}function each$1(He,Qe){getArchtype(He)===0?Reflect.ownKeys(He).forEach(it=>{Qe(it,He[it],He)}):He.forEach((it,lt)=>Qe(lt,it,He))}function getArchtype(He){const Qe=He[DRAFT_STATE];return Qe?Qe.type_:Array.isArray(He)?1:isMap(He)?2:isSet(He)?3:0}function has(He,Qe){return getArchtype(He)===2?He.has(Qe):Object.prototype.hasOwnProperty.call(He,Qe)}function set$4(He,Qe,it){const lt=getArchtype(He);lt===2?He.set(Qe,it):lt===3?He.add(it):He[Qe]=it}function is(He,Qe){return He===Qe?He!==0||1/He===1/Qe:He!==He&&Qe!==Qe}function isMap(He){return He instanceof Map}function isSet(He){return He instanceof Set}function latest(He){return He.copy_||He.base_}function shallowCopy(He,Qe){if(isMap(He))return new Map(He);if(isSet(He))return new Set(He);if(Array.isArray(He))return Array.prototype.slice.call(He);const it=isPlainObject(He);if(Qe===!0||Qe==="class_only"&&!it){const lt=Object.getOwnPropertyDescriptors(He);delete lt[DRAFT_STATE];let ut=Reflect.ownKeys(lt);for(let dt=0;dt<ut.length;dt++){const xt=ut[dt],ft=lt[xt];ft.writable===!1&&(ft.writable=!0,ft.configurable=!0),(ft.get||ft.set)&&(lt[xt]={configurable:!0,writable:!0,enumerable:ft.enumerable,value:He[xt]})}return Object.create(getPrototypeOf(He),lt)}else{const lt=getPrototypeOf(He);if(lt!==null&&it)return{...He};const ut=Object.create(lt);return Object.assign(ut,He)}}function freeze(He,Qe=!1){return isFrozen(He)||isDraft(He)||!isDraftable(He)||(getArchtype(He)>1&&(He.set=He.add=He.clear=He.delete=dontMutateFrozenCollections),Object.freeze(He),Qe&&Object.entries(He).forEach(([it,lt])=>freeze(lt,!0))),He}function dontMutateFrozenCollections(){die(2)}function isFrozen(He){return Object.isFrozen(He)}var plugins={};function getPlugin(He){const Qe=plugins[He];return Qe||die(0,He),Qe}function loadPlugin(He,Qe){plugins[He]||(plugins[He]=Qe)}var currentScope;function getCurrentScope(){return currentScope}function createScope(He,Qe){return{drafts_:[],parent_:He,immer_:Qe,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function usePatchesInScope(He,Qe){Qe&&(getPlugin("Patches"),He.patches_=[],He.inversePatches_=[],He.patchListener_=Qe)}function revokeScope(He){leaveScope(He),He.drafts_.forEach(revokeDraft),He.drafts_=null}function leaveScope(He){He===currentScope&&(currentScope=He.parent_)}function enterScope(He){return currentScope=createScope(currentScope,He)}function revokeDraft(He){const Qe=He[DRAFT_STATE];Qe.type_===0||Qe.type_===1?Qe.revoke_():Qe.revoked_=!0}function processResult(He,Qe){Qe.unfinalizedDrafts_=Qe.drafts_.length;const it=Qe.drafts_[0];return He!==void 0&&He!==it?(it[DRAFT_STATE].modified_&&(revokeScope(Qe),die(4)),isDraftable(He)&&(He=finalize(Qe,He),Qe.parent_||maybeFreeze(Qe,He)),Qe.patches_&&getPlugin("Patches").generateReplacementPatches_(it[DRAFT_STATE].base_,He,Qe.patches_,Qe.inversePatches_)):He=finalize(Qe,it,[]),revokeScope(Qe),Qe.patches_&&Qe.patchListener_(Qe.patches_,Qe.inversePatches_),He!==NOTHING?He:void 0}function finalize(He,Qe,it){if(isFrozen(Qe))return Qe;const lt=Qe[DRAFT_STATE];if(!lt)return each$1(Qe,(ut,dt)=>finalizeProperty(He,lt,Qe,ut,dt,it)),Qe;if(lt.scope_!==He)return Qe;if(!lt.modified_)return maybeFreeze(He,lt.base_,!0),lt.base_;if(!lt.finalized_){lt.finalized_=!0,lt.scope_.unfinalizedDrafts_--;const ut=lt.copy_;let dt=ut,xt=!1;lt.type_===3&&(dt=new Set(ut),ut.clear(),xt=!0),each$1(dt,(ft,vt)=>finalizeProperty(He,lt,ut,ft,vt,it,xt)),maybeFreeze(He,ut,!1),it&&He.patches_&&getPlugin("Patches").generatePatches_(lt,it,He.patches_,He.inversePatches_)}return lt.copy_}function finalizeProperty(He,Qe,it,lt,ut,dt,xt){if(isDraft(ut)){const ft=dt&&Qe&&Qe.type_!==3&&!has(Qe.assigned_,lt)?dt.concat(lt):void 0,vt=finalize(He,ut,ft);if(set$4(it,lt,vt),isDraft(vt))He.canAutoFreeze_=!1;else return}else xt&&it.add(ut);if(isDraftable(ut)&&!isFrozen(ut)){if(!He.immer_.autoFreeze_&&He.unfinalizedDrafts_<1)return;finalize(He,ut),(!Qe||!Qe.scope_.parent_)&&typeof lt!="symbol"&&Object.prototype.propertyIsEnumerable.call(it,lt)&&maybeFreeze(He,ut)}}function maybeFreeze(He,Qe,it=!1){!He.parent_&&He.immer_.autoFreeze_&&He.canAutoFreeze_&&freeze(Qe,it)}function createProxyProxy(He,Qe){const it=Array.isArray(He),lt={type_:it?1:0,scope_:Qe?Qe.scope_:getCurrentScope(),modified_:!1,finalized_:!1,assigned_:{},parent_:Qe,base_:He,draft_:null,copy_:null,revoke_:null,isManual_:!1};let ut=lt,dt=objectTraps;it&&(ut=[lt],dt=arrayTraps);const{revoke:xt,proxy:ft}=Proxy.revocable(ut,dt);return lt.draft_=ft,lt.revoke_=xt,ft}var objectTraps={get(He,Qe){if(Qe===DRAFT_STATE)return He;const it=latest(He);if(!has(it,Qe))return readPropFromProto(He,it,Qe);const lt=it[Qe];return He.finalized_||!isDraftable(lt)?lt:lt===peek(He.base_,Qe)?(prepareCopy(He),He.copy_[Qe]=createProxy(lt,He)):lt},has(He,Qe){return Qe in latest(He)},ownKeys(He){return Reflect.ownKeys(latest(He))},set(He,Qe,it){const lt=getDescriptorFromProto(latest(He),Qe);if(lt?.set)return lt.set.call(He.draft_,it),!0;if(!He.modified_){const ut=peek(latest(He),Qe),dt=ut?.[DRAFT_STATE];if(dt&&dt.base_===it)return He.copy_[Qe]=it,He.assigned_[Qe]=!1,!0;if(is(it,ut)&&(it!==void 0||has(He.base_,Qe)))return!0;prepareCopy(He),markChanged(He)}return He.copy_[Qe]===it&&(it!==void 0||Qe in He.copy_)||Number.isNaN(it)&&Number.isNaN(He.copy_[Qe])||(He.copy_[Qe]=it,He.assigned_[Qe]=!0),!0},deleteProperty(He,Qe){return peek(He.base_,Qe)!==void 0||Qe in He.base_?(He.assigned_[Qe]=!1,prepareCopy(He),markChanged(He)):delete He.assigned_[Qe],He.copy_&&delete He.copy_[Qe],!0},getOwnPropertyDescriptor(He,Qe){const it=latest(He),lt=Reflect.getOwnPropertyDescriptor(it,Qe);return lt&&{writable:!0,configurable:He.type_!==1||Qe!=="length",enumerable:lt.enumerable,value:it[Qe]}},defineProperty(){die(11)},getPrototypeOf(He){return getPrototypeOf(He.base_)},setPrototypeOf(){die(12)}},arrayTraps={};each$1(objectTraps,(He,Qe)=>{arrayTraps[He]=function(){return arguments[0]=arguments[0][0],Qe.apply(this,arguments)}});arrayTraps.deleteProperty=function(He,Qe){return arrayTraps.set.call(this,He,Qe,void 0)};arrayTraps.set=function(He,Qe,it){return objectTraps.set.call(this,He[0],Qe,it,He[0])};function peek(He,Qe){const it=He[DRAFT_STATE];return(it?latest(it):He)[Qe]}function readPropFromProto(He,Qe,it){const lt=getDescriptorFromProto(Qe,it);return lt?"value"in lt?lt.value:lt.get?.call(He.draft_):void 0}function getDescriptorFromProto(He,Qe){if(!(Qe in He))return;let it=getPrototypeOf(He);for(;it;){const lt=Object.getOwnPropertyDescriptor(it,Qe);if(lt)return lt;it=getPrototypeOf(it)}}function markChanged(He){He.modified_||(He.modified_=!0,He.parent_&&markChanged(He.parent_))}function prepareCopy(He){He.copy_||(He.copy_=shallowCopy(He.base_,He.scope_.immer_.useStrictShallowCopy_))}var Immer2=class{constructor(He){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(Qe,it,lt)=>{if(typeof Qe=="function"&&typeof it!="function"){const dt=it;it=Qe;const xt=this;return function(vt=dt,...kt){return xt.produce(vt,St=>it.call(this,St,...kt))}}typeof it!="function"&&die(6),lt!==void 0&&typeof lt!="function"&&die(7);let ut;if(isDraftable(Qe)){const dt=enterScope(this),xt=createProxy(Qe,void 0);let ft=!0;try{ut=it(xt),ft=!1}finally{ft?revokeScope(dt):leaveScope(dt)}return usePatchesInScope(dt,lt),processResult(ut,dt)}else if(!Qe||typeof Qe!="object"){if(ut=it(Qe),ut===void 0&&(ut=Qe),ut===NOTHING&&(ut=void 0),this.autoFreeze_&&freeze(ut,!0),lt){const dt=[],xt=[];getPlugin("Patches").generateReplacementPatches_(Qe,ut,dt,xt),lt(dt,xt)}return ut}else die(1,Qe)},this.produceWithPatches=(Qe,it)=>{if(typeof Qe=="function")return(xt,...ft)=>this.produceWithPatches(xt,vt=>Qe(vt,...ft));let lt,ut;return[this.produce(Qe,it,(xt,ft)=>{lt=xt,ut=ft}),lt,ut]},typeof He?.autoFreeze=="boolean"&&this.setAutoFreeze(He.autoFreeze),typeof He?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(He.useStrictShallowCopy)}createDraft(He){isDraftable(He)||die(8),isDraft(He)&&(He=current(He));const Qe=enterScope(this),it=createProxy(He,void 0);return it[DRAFT_STATE].isManual_=!0,leaveScope(Qe),it}finishDraft(He,Qe){const it=He&&He[DRAFT_STATE];(!it||!it.isManual_)&&die(9);const{scope_:lt}=it;return usePatchesInScope(lt,Qe),processResult(void 0,lt)}setAutoFreeze(He){this.autoFreeze_=He}setUseStrictShallowCopy(He){this.useStrictShallowCopy_=He}applyPatches(He,Qe){let it;for(it=Qe.length-1;it>=0;it--){const ut=Qe[it];if(ut.path.length===0&&ut.op==="replace"){He=ut.value;break}}it>-1&&(Qe=Qe.slice(it+1));const lt=getPlugin("Patches").applyPatches_;return isDraft(He)?lt(He,Qe):this.produce(He,ut=>lt(ut,Qe))}};function createProxy(He,Qe){const it=isMap(He)?getPlugin("MapSet").proxyMap_(He,Qe):isSet(He)?getPlugin("MapSet").proxySet_(He,Qe):createProxyProxy(He,Qe);return(Qe?Qe.scope_:getCurrentScope()).drafts_.push(it),it}function current(He){return isDraft(He)||die(10,He),currentImpl(He)}function currentImpl(He){if(!isDraftable(He)||isFrozen(He))return He;const Qe=He[DRAFT_STATE];let it;if(Qe){if(!Qe.modified_)return Qe.base_;Qe.finalized_=!0,it=shallowCopy(He,Qe.scope_.immer_.useStrictShallowCopy_)}else it=shallowCopy(He,!0);return each$1(it,(lt,ut)=>{set$4(it,lt,currentImpl(ut))}),Qe&&(Qe.finalized_=!1),it}function enableMapSet(){class He extends Map{constructor(vt,kt){super(),this[DRAFT_STATE]={type_:2,parent_:kt,scope_:kt?kt.scope_:getCurrentScope(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:vt,draft_:this,isManual_:!1,revoked_:!1}}get size(){return latest(this[DRAFT_STATE]).size}has(vt){return latest(this[DRAFT_STATE]).has(vt)}set(vt,kt){const St=this[DRAFT_STATE];return xt(St),(!latest(St).has(vt)||latest(St).get(vt)!==kt)&&(it(St),markChanged(St),St.assigned_.set(vt,!0),St.copy_.set(vt,kt),St.assigned_.set(vt,!0)),this}delete(vt){if(!this.has(vt))return!1;const kt=this[DRAFT_STATE];return xt(kt),it(kt),markChanged(kt),kt.base_.has(vt)?kt.assigned_.set(vt,!1):kt.assigned_.delete(vt),kt.copy_.delete(vt),!0}clear(){const vt=this[DRAFT_STATE];xt(vt),latest(vt).size&&(it(vt),markChanged(vt),vt.assigned_=new Map,each$1(vt.base_,kt=>{vt.assigned_.set(kt,!1)}),vt.copy_.clear())}forEach(vt,kt){const St=this[DRAFT_STATE];latest(St).forEach((Tt,Mt,Nt)=>{vt.call(kt,this.get(Mt),Mt,this)})}get(vt){const kt=this[DRAFT_STATE];xt(kt);const St=latest(kt).get(vt);if(kt.finalized_||!isDraftable(St)||St!==kt.base_.get(vt))return St;const Tt=createProxy(St,kt);return it(kt),kt.copy_.set(vt,Tt),Tt}keys(){return latest(this[DRAFT_STATE]).keys()}values(){const vt=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const kt=vt.next();return kt.done?kt:{done:!1,value:this.get(kt.value)}}}}entries(){const vt=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const kt=vt.next();if(kt.done)return kt;const St=this.get(kt.value);return{done:!1,value:[kt.value,St]}}}}[Symbol.iterator](){return this.entries()}}function Qe(ft,vt){return new He(ft,vt)}function it(ft){ft.copy_||(ft.assigned_=new Map,ft.copy_=new Map(ft.base_))}class lt extends Set{constructor(vt,kt){super(),this[DRAFT_STATE]={type_:3,parent_:kt,scope_:kt?kt.scope_:getCurrentScope(),modified_:!1,finalized_:!1,copy_:void 0,base_:vt,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return latest(this[DRAFT_STATE]).size}has(vt){const kt=this[DRAFT_STATE];return xt(kt),kt.copy_?!!(kt.copy_.has(vt)||kt.drafts_.has(vt)&&kt.copy_.has(kt.drafts_.get(vt))):kt.base_.has(vt)}add(vt){const kt=this[DRAFT_STATE];return xt(kt),this.has(vt)||(dt(kt),markChanged(kt),kt.copy_.add(vt)),this}delete(vt){if(!this.has(vt))return!1;const kt=this[DRAFT_STATE];return xt(kt),dt(kt),markChanged(kt),kt.copy_.delete(vt)||(kt.drafts_.has(vt)?kt.copy_.delete(kt.drafts_.get(vt)):!1)}clear(){const vt=this[DRAFT_STATE];xt(vt),latest(vt).size&&(dt(vt),markChanged(vt),vt.copy_.clear())}values(){const vt=this[DRAFT_STATE];return xt(vt),dt(vt),vt.copy_.values()}entries(){const vt=this[DRAFT_STATE];return xt(vt),dt(vt),vt.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(vt,kt){const St=this.values();let Tt=St.next();for(;!Tt.done;)vt.call(kt,Tt.value,Tt.value,this),Tt=St.next()}}function ut(ft,vt){return new lt(ft,vt)}function dt(ft){ft.copy_||(ft.copy_=new Set,ft.base_.forEach(vt=>{if(isDraftable(vt)){const kt=createProxy(vt,ft);ft.drafts_.set(vt,kt),ft.copy_.add(kt)}else ft.copy_.add(vt)}))}function xt(ft){ft.revoked_&&die(3,JSON.stringify(latest(ft)))}loadPlugin("MapSet",{proxyMap_:Qe,proxySet_:ut})}var immer=new Immer2,produce=immer.produce;immer.produceWithPatches.bind(immer);immer.setAutoFreeze.bind(immer);immer.setUseStrictShallowCopy.bind(immer);immer.applyPatches.bind(immer);immer.createDraft.bind(immer);immer.finishDraft.bind(immer);function atomWithImmer(He){const Qe=atom(He,(it,lt,ut)=>lt(Qe,produce(it(Qe),typeof ut=="function"?ut:()=>ut)));return Qe}function useSetImmerAtom(He,Qe){const it=useSetAtom(He,Qe);return reactExports.useCallback(lt=>it(produce(lt)),[it])}function useImmerAtom(He,Qe){return[useAtomValue(He,Qe),useSetImmerAtom(He,Qe)]}const DIT_MODEL_RELEASE_EVENT_NAME="ditModelReleaseEvent",DIT_MODEL_RELEASE_EVENT_DIALOG_STORAGE_KEY="growth:dit-model-release-event-dialog-shown";function usePublicDynamicConfig(He,Qe){return useSWR$1(He?`dynamicConfig:${He}`:null,async()=>{if(!He)return;const{data:it}=await dynamicConfigClient({method:"get",url:He});return it},Qe)}const useDynamicConstants=He=>usePublicDynamicConfig("constants",He),useEnhancementPlugins=()=>{const{data:He,...Qe}=useDynamicConstants();return{data:He?.imageEnhancementPlugins,...Qe}},useDynamicDefaultParameters=()=>usePublicDynamicConfig("defaultParameters"),useDynamicTrainLoraModels=()=>usePublicDynamicConfig("trainLoraModels"),allContainers=new Map,dynamicCreateElement=(He,Qe)=>{const it=Qe&&allContainers.has(Qe)?allContainers.get(Qe):allContainers.values().next().value;if(!it)throw new Error("dynamicCreateElement must be used with DynamicCreateElementContainer for now.");return it.createElement(He,Qe)},DynamicCreateElementContext=reactExports.createContext({child:new Set,createElement:void 0}),useForceUpdate=()=>{const[,He]=reactExports.useState(0);return reactExports.useCallback(()=>He(Qe=>Qe+1),[])},DynamicCreateElementContainer=({children:He,name:Qe=Math.random()+""})=>{const it=useForceUpdate(),lt=reactExports.useMemo(()=>new Set,[]),ut=reactExports.useContext(DynamicCreateElementContext),dt=reactExports.useMemo(()=>new Set,[]),xt=reactExports.useCallback((vt,kt)=>{if(Qe!==kt&&dt.size){const[Tt]=[...dt.values()];return Tt?.createElement?.(vt)||(()=>{})}const St=reactExports.cloneElement(vt,{key:`dynamic-create-element-${Math.random()}`});return lt.add(St),it(),()=>{lt.delete(St),it()}},[]),ft=reactExports.useMemo(()=>({child:dt,createElement:xt}),[]);return reactExports.useEffect(()=>(ut.child.add(ft),allContainers.set(Qe,ft),()=>{ut.child.delete(ft),allContainers.delete(Qe)}),[]),jsxRuntimeExports.jsxs(DynamicCreateElementContext.Provider,{value:ft,children:[He,[...lt.values()]]})};var defaultTheme$2={},cloneDeep={};(function(He){Object.defineProperty(He,"__esModule",{value:!0}),Object.defineProperty(He,"cloneDeep",{enumerable:!0,get:function(){return Qe}});function Qe(it){return Array.isArray(it)?it.map(lt=>Qe(lt)):typeof it=="object"&&it!==null?Object.fromEntries(Object.entries(it).map(([lt,ut])=>[lt,Qe(ut)])):it}})(cloneDeep);var config_full={content:[],presets:[],darkMode:"media",theme:{accentColor:({theme:He})=>({...He("colors"),auto:"auto"}),animation:{none:"none",spin:"spin 1s linear infinite",ping:"ping 1s cubic-bezier(0, 0, 0.2, 1) infinite",pulse:"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite",bounce:"bounce 1s infinite"},aria:{busy:'busy="true"',checked:'checked="true"',disabled:'disabled="true"',expanded:'expanded="true"',hidden:'hidden="true"',pressed:'pressed="true"',readonly:'readonly="true"',required:'required="true"',selected:'selected="true"'},aspectRatio:{auto:"auto",square:"1 / 1",video:"16 / 9"},backdropBlur:({theme:He})=>He("blur"),backdropBrightness:({theme:He})=>He("brightness"),backdropContrast:({theme:He})=>He("contrast"),backdropGrayscale:({theme:He})=>He("grayscale"),backdropHueRotate:({theme:He})=>He("hueRotate"),backdropInvert:({theme:He})=>He("invert"),backdropOpacity:({theme:He})=>He("opacity"),backdropSaturate:({theme:He})=>He("saturate"),backdropSepia:({theme:He})=>He("sepia"),backgroundColor:({theme:He})=>He("colors"),backgroundImage:{none:"none","gradient-to-t":"linear-gradient(to top, var(--tw-gradient-stops))","gradient-to-tr":"linear-gradient(to top right, var(--tw-gradient-stops))","gradient-to-r":"linear-gradient(to right, var(--tw-gradient-stops))","gradient-to-br":"linear-gradient(to bottom right, var(--tw-gradient-stops))","gradient-to-b":"linear-gradient(to bottom, var(--tw-gradient-stops))","gradient-to-bl":"linear-gradient(to bottom left, var(--tw-gradient-stops))","gradient-to-l":"linear-gradient(to left, var(--tw-gradient-stops))","gradient-to-tl":"linear-gradient(to top left, var(--tw-gradient-stops))"},backgroundOpacity:({theme:He})=>He("opacity"),backgroundPosition:{bottom:"bottom",center:"center",left:"left","left-bottom":"left bottom","left-top":"left top",right:"right","right-bottom":"right bottom","right-top":"right top",top:"top"},backgroundSize:{auto:"auto",cover:"cover",contain:"contain"},blur:{0:"0",none:"",sm:"4px",DEFAULT:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},borderColor:({theme:He})=>({...He("colors"),DEFAULT:He("colors.gray.200","currentColor")}),borderOpacity:({theme:He})=>He("opacity"),borderRadius:{none:"0px",sm:"0.125rem",DEFAULT:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},borderSpacing:({theme:He})=>({...He("spacing")}),borderWidth:{DEFAULT:"1px",0:"0px",2:"2px",4:"4px",8:"8px"},boxShadow:{sm:"0 1px 2px 0 rgb(0 0 0 / 0.05)",DEFAULT:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)",md:"0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)",lg:"0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)",xl:"0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1)","2xl":"0 25px 50px -12px rgb(0 0 0 / 0.25)",inner:"inset 0 2px 4px 0 rgb(0 0 0 / 0.05)",none:"none"},boxShadowColor:({theme:He})=>He("colors"),brightness:{0:"0",50:".5",75:".75",90:".9",95:".95",100:"1",105:"1.05",110:"1.1",125:"1.25",150:"1.5",200:"2"},caretColor:({theme:He})=>He("colors"),colors:({colors:He})=>({inherit:He.inherit,current:He.current,transparent:He.transparent,black:He.black,white:He.white,slate:He.slate,gray:He.gray,zinc:He.zinc,neutral:He.neutral,stone:He.stone,red:He.red,orange:He.orange,amber:He.amber,yellow:He.yellow,lime:He.lime,green:He.green,emerald:He.emerald,teal:He.teal,cyan:He.cyan,sky:He.sky,blue:He.blue,indigo:He.indigo,violet:He.violet,purple:He.purple,fuchsia:He.fuchsia,pink:He.pink,rose:He.rose}),columns:{auto:"auto",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12","3xs":"16rem","2xs":"18rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem"},container:{},content:{none:"none"},contrast:{0:"0",50:".5",75:".75",100:"1",125:"1.25",150:"1.5",200:"2"},cursor:{auto:"auto",default:"default",pointer:"pointer",wait:"wait",text:"text",move:"move",help:"help","not-allowed":"not-allowed",none:"none","context-menu":"context-menu",progress:"progress",cell:"cell",crosshair:"crosshair","vertical-text":"vertical-text",alias:"alias",copy:"copy","no-drop":"no-drop",grab:"grab",grabbing:"grabbing","all-scroll":"all-scroll","col-resize":"col-resize","row-resize":"row-resize","n-resize":"n-resize","e-resize":"e-resize","s-resize":"s-resize","w-resize":"w-resize","ne-resize":"ne-resize","nw-resize":"nw-resize","se-resize":"se-resize","sw-resize":"sw-resize","ew-resize":"ew-resize","ns-resize":"ns-resize","nesw-resize":"nesw-resize","nwse-resize":"nwse-resize","zoom-in":"zoom-in","zoom-out":"zoom-out"},divideColor:({theme:He})=>He("borderColor"),divideOpacity:({theme:He})=>He("borderOpacity"),divideWidth:({theme:He})=>He("borderWidth"),dropShadow:{sm:"0 1px 1px rgb(0 0 0 / 0.05)",DEFAULT:["0 1px 2px rgb(0 0 0 / 0.1)","0 1px 1px rgb(0 0 0 / 0.06)"],md:["0 4px 3px rgb(0 0 0 / 0.07)","0 2px 2px rgb(0 0 0 / 0.06)"],lg:["0 10px 8px rgb(0 0 0 / 0.04)","0 4px 3px rgb(0 0 0 / 0.1)"],xl:["0 20px 13px rgb(0 0 0 / 0.03)","0 8px 5px rgb(0 0 0 / 0.08)"],"2xl":"0 25px 25px rgb(0 0 0 / 0.15)",none:"0 0 #0000"},fill:({theme:He})=>({none:"none",...He("colors")}),flex:{1:"1 1 0%",auto:"1 1 auto",initial:"0 1 auto",none:"none"},flexBasis:({theme:He})=>({auto:"auto",...He("spacing"),"1/2":"50%","1/3":"33.333333%","2/3":"66.666667%","1/4":"25%","2/4":"50%","3/4":"75%","1/5":"20%","2/5":"40%","3/5":"60%","4/5":"80%","1/6":"16.666667%","2/6":"33.333333%","3/6":"50%","4/6":"66.666667%","5/6":"83.333333%","1/12":"8.333333%","2/12":"16.666667%","3/12":"25%","4/12":"33.333333%","5/12":"41.666667%","6/12":"50%","7/12":"58.333333%","8/12":"66.666667%","9/12":"75%","10/12":"83.333333%","11/12":"91.666667%",full:"100%"}),flexGrow:{0:"0",DEFAULT:"1"},flexShrink:{0:"0",DEFAULT:"1"},fontFamily:{sans:["ui-sans-serif","system-ui","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"','"Noto Color Emoji"'],serif:["ui-serif","Georgia","Cambria",'"Times New Roman"',"Times","serif"],mono:["ui-monospace","SFMono-Regular","Menlo","Monaco","Consolas",'"Liberation Mono"','"Courier New"',"monospace"]},fontSize:{xs:["0.75rem",{lineHeight:"1rem"}],sm:["0.875rem",{lineHeight:"1.25rem"}],base:["1rem",{lineHeight:"1.5rem"}],lg:["1.125rem",{lineHeight:"1.75rem"}],xl:["1.25rem",{lineHeight:"1.75rem"}],"2xl":["1.5rem",{lineHeight:"2rem"}],"3xl":["1.875rem",{lineHeight:"2.25rem"}],"4xl":["2.25rem",{lineHeight:"2.5rem"}],"5xl":["3rem",{lineHeight:"1"}],"6xl":["3.75rem",{lineHeight:"1"}],"7xl":["4.5rem",{lineHeight:"1"}],"8xl":["6rem",{lineHeight:"1"}],"9xl":["8rem",{lineHeight:"1"}]},fontWeight:{thin:"100",extralight:"200",light:"300",normal:"400",medium:"500",semibold:"600",bold:"700",extrabold:"800",black:"900"},gap:({theme:He})=>He("spacing"),gradientColorStops:({theme:He})=>He("colors"),gradientColorStopPositions:{"0%":"0%","5%":"5%","10%":"10%","15%":"15%","20%":"20%","25%":"25%","30%":"30%","35%":"35%","40%":"40%","45%":"45%","50%":"50%","55%":"55%","60%":"60%","65%":"65%","70%":"70%","75%":"75%","80%":"80%","85%":"85%","90%":"90%","95%":"95%","100%":"100%"},grayscale:{0:"0",DEFAULT:"100%"},gridAutoColumns:{auto:"auto",min:"min-content",max:"max-content",fr:"minmax(0, 1fr)"},gridAutoRows:{auto:"auto",min:"min-content",max:"max-content",fr:"minmax(0, 1fr)"},gridColumn:{auto:"auto","span-1":"span 1 / span 1","span-2":"span 2 / span 2","span-3":"span 3 / span 3","span-4":"span 4 / span 4","span-5":"span 5 / span 5","span-6":"span 6 / span 6","span-7":"span 7 / span 7","span-8":"span 8 / span 8","span-9":"span 9 / span 9","span-10":"span 10 / span 10","span-11":"span 11 / span 11","span-12":"span 12 / span 12","span-full":"1 / -1"},gridColumnEnd:{auto:"auto",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13"},gridColumnStart:{auto:"auto",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13"},gridRow:{auto:"auto","span-1":"span 1 / span 1","span-2":"span 2 / span 2","span-3":"span 3 / span 3","span-4":"span 4 / span 4","span-5":"span 5 / span 5","span-6":"span 6 / span 6","span-7":"span 7 / span 7","span-8":"span 8 / span 8","span-9":"span 9 / span 9","span-10":"span 10 / span 10","span-11":"span 11 / span 11","span-12":"span 12 / span 12","span-full":"1 / -1"},gridRowEnd:{auto:"auto",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13"},gridRowStart:{auto:"auto",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12",13:"13"},gridTemplateColumns:{none:"none",subgrid:"subgrid",1:"repeat(1, minmax(0, 1fr))",2:"repeat(2, minmax(0, 1fr))",3:"repeat(3, minmax(0, 1fr))",4:"repeat(4, minmax(0, 1fr))",5:"repeat(5, minmax(0, 1fr))",6:"repeat(6, minmax(0, 1fr))",7:"repeat(7, minmax(0, 1fr))",8:"repeat(8, minmax(0, 1fr))",9:"repeat(9, minmax(0, 1fr))",10:"repeat(10, minmax(0, 1fr))",11:"repeat(11, minmax(0, 1fr))",12:"repeat(12, minmax(0, 1fr))"},gridTemplateRows:{none:"none",subgrid:"subgrid",1:"repeat(1, minmax(0, 1fr))",2:"repeat(2, minmax(0, 1fr))",3:"repeat(3, minmax(0, 1fr))",4:"repeat(4, minmax(0, 1fr))",5:"repeat(5, minmax(0, 1fr))",6:"repeat(6, minmax(0, 1fr))",7:"repeat(7, minmax(0, 1fr))",8:"repeat(8, minmax(0, 1fr))",9:"repeat(9, minmax(0, 1fr))",10:"repeat(10, minmax(0, 1fr))",11:"repeat(11, minmax(0, 1fr))",12:"repeat(12, minmax(0, 1fr))"},height:({theme:He})=>({auto:"auto",...He("spacing"),"1/2":"50%","1/3":"33.333333%","2/3":"66.666667%","1/4":"25%","2/4":"50%","3/4":"75%","1/5":"20%","2/5":"40%","3/5":"60%","4/5":"80%","1/6":"16.666667%","2/6":"33.333333%","3/6":"50%","4/6":"66.666667%","5/6":"83.333333%",full:"100%",screen:"100vh",svh:"100svh",lvh:"100lvh",dvh:"100dvh",min:"min-content",max:"max-content",fit:"fit-content"}),hueRotate:{0:"0deg",15:"15deg",30:"30deg",60:"60deg",90:"90deg",180:"180deg"},inset:({theme:He})=>({auto:"auto",...He("spacing"),"1/2":"50%","1/3":"33.333333%","2/3":"66.666667%","1/4":"25%","2/4":"50%","3/4":"75%",full:"100%"}),invert:{0:"0",DEFAULT:"100%"},keyframes:{spin:{to:{transform:"rotate(360deg)"}},ping:{"75%, 100%":{transform:"scale(2)",opacity:"0"}},pulse:{"50%":{opacity:".5"}},bounce:{"0%, 100%":{transform:"translateY(-25%)",animationTimingFunction:"cubic-bezier(0.8,0,1,1)"},"50%":{transform:"none",animationTimingFunction:"cubic-bezier(0,0,0.2,1)"}}},letterSpacing:{tighter:"-0.05em",tight:"-0.025em",normal:"0em",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeight:{none:"1",tight:"1.25",snug:"1.375",normal:"1.5",relaxed:"1.625",loose:"2",3:".75rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem"},listStyleType:{none:"none",disc:"disc",decimal:"decimal"},listStyleImage:{none:"none"},margin:({theme:He})=>({auto:"auto",...He("spacing")}),lineClamp:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6"},maxHeight:({theme:He})=>({...He("spacing"),none:"none",full:"100%",screen:"100vh",svh:"100svh",lvh:"100lvh",dvh:"100dvh",min:"min-content",max:"max-content",fit:"fit-content"}),maxWidth:({theme:He,breakpoints:Qe})=>({...He("spacing"),none:"none",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem",full:"100%",min:"min-content",max:"max-content",fit:"fit-content",prose:"65ch",...Qe(He("screens"))}),minHeight:({theme:He})=>({...He("spacing"),full:"100%",screen:"100vh",svh:"100svh",lvh:"100lvh",dvh:"100dvh",min:"min-content",max:"max-content",fit:"fit-content"}),minWidth:({theme:He})=>({...He("spacing"),full:"100%",min:"min-content",max:"max-content",fit:"fit-content"}),objectPosition:{bottom:"bottom",center:"center",left:"left","left-bottom":"left bottom","left-top":"left top",right:"right","right-bottom":"right bottom","right-top":"right top",top:"top"},opacity:{0:"0",5:"0.05",10:"0.1",15:"0.15",20:"0.2",25:"0.25",30:"0.3",35:"0.35",40:"0.4",45:"0.45",50:"0.5",55:"0.55",60:"0.6",65:"0.65",70:"0.7",75:"0.75",80:"0.8",85:"0.85",90:"0.9",95:"0.95",100:"1"},order:{first:"-9999",last:"9999",none:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12"},outlineColor:({theme:He})=>He("colors"),outlineOffset:{0:"0px",1:"1px",2:"2px",4:"4px",8:"8px"},outlineWidth:{0:"0px",1:"1px",2:"2px",4:"4px",8:"8px"},padding:({theme:He})=>He("spacing"),placeholderColor:({theme:He})=>He("colors"),placeholderOpacity:({theme:He})=>He("opacity"),ringColor:({theme:He})=>({DEFAULT:He("colors.blue.500","#3b82f6"),...He("colors")}),ringOffsetColor:({theme:He})=>He("colors"),ringOffsetWidth:{0:"0px",1:"1px",2:"2px",4:"4px",8:"8px"},ringOpacity:({theme:He})=>({DEFAULT:"0.5",...He("opacity")}),ringWidth:{DEFAULT:"3px",0:"0px",1:"1px",2:"2px",4:"4px",8:"8px"},rotate:{0:"0deg",1:"1deg",2:"2deg",3:"3deg",6:"6deg",12:"12deg",45:"45deg",90:"90deg",180:"180deg"},saturate:{0:"0",50:".5",100:"1",150:"1.5",200:"2"},scale:{0:"0",50:".5",75:".75",90:".9",95:".95",100:"1",105:"1.05",110:"1.1",125:"1.25",150:"1.5"},screens:{sm:"640px",md:"768px",lg:"1024px",xl:"1280px","2xl":"1536px"},scrollMargin:({theme:He})=>({...He("spacing")}),scrollPadding:({theme:He})=>He("spacing"),sepia:{0:"0",DEFAULT:"100%"},skew:{0:"0deg",1:"1deg",2:"2deg",3:"3deg",6:"6deg",12:"12deg"},space:({theme:He})=>({...He("spacing")}),spacing:{px:"1px",0:"0px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",11:"2.75rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"},stroke:({theme:He})=>({none:"none",...He("colors")}),strokeWidth:{0:"0",1:"1",2:"2"},supports:{},data:{},textColor:({theme:He})=>He("colors"),textDecorationColor:({theme:He})=>He("colors"),textDecorationThickness:{auto:"auto","from-font":"from-font",0:"0px",1:"1px",2:"2px",4:"4px",8:"8px"},textIndent:({theme:He})=>({...He("spacing")}),textOpacity:({theme:He})=>He("opacity"),textUnderlineOffset:{auto:"auto",0:"0px",1:"1px",2:"2px",4:"4px",8:"8px"},transformOrigin:{center:"center",top:"top","top-right":"top right",right:"right","bottom-right":"bottom right",bottom:"bottom","bottom-left":"bottom left",left:"left","top-left":"top left"},transitionDelay:{0:"0s",75:"75ms",100:"100ms",150:"150ms",200:"200ms",300:"300ms",500:"500ms",700:"700ms",1e3:"1000ms"},transitionDuration:{DEFAULT:"150ms",0:"0s",75:"75ms",100:"100ms",150:"150ms",200:"200ms",300:"300ms",500:"500ms",700:"700ms",1e3:"1000ms"},transitionProperty:{none:"none",all:"all",DEFAULT:"color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter",colors:"color, background-color, border-color, text-decoration-color, fill, stroke",opacity:"opacity",shadow:"box-shadow",transform:"transform"},transitionTimingFunction:{DEFAULT:"cubic-bezier(0.4, 0, 0.2, 1)",linear:"linear",in:"cubic-bezier(0.4, 0, 1, 1)",out:"cubic-bezier(0, 0, 0.2, 1)","in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},translate:({theme:He})=>({...He("spacing"),"1/2":"50%","1/3":"33.333333%","2/3":"66.666667%","1/4":"25%","2/4":"50%","3/4":"75%",full:"100%"}),size:({theme:He})=>({auto:"auto",...He("spacing"),"1/2":"50%","1/3":"33.333333%","2/3":"66.666667%","1/4":"25%","2/4":"50%","3/4":"75%","1/5":"20%","2/5":"40%","3/5":"60%","4/5":"80%","1/6":"16.666667%","2/6":"33.333333%","3/6":"50%","4/6":"66.666667%","5/6":"83.333333%","1/12":"8.333333%","2/12":"16.666667%","3/12":"25%","4/12":"33.333333%","5/12":"41.666667%","6/12":"50%","7/12":"58.333333%","8/12":"66.666667%","9/12":"75%","10/12":"83.333333%","11/12":"91.666667%",full:"100%",min:"min-content",max:"max-content",fit:"fit-content"}),width:({theme:He})=>({auto:"auto",...He("spacing"),"1/2":"50%","1/3":"33.333333%","2/3":"66.666667%","1/4":"25%","2/4":"50%","3/4":"75%","1/5":"20%","2/5":"40%","3/5":"60%","4/5":"80%","1/6":"16.666667%","2/6":"33.333333%","3/6":"50%","4/6":"66.666667%","5/6":"83.333333%","1/12":"8.333333%","2/12":"16.666667%","3/12":"25%","4/12":"33.333333%","5/12":"41.666667%","6/12":"50%","7/12":"58.333333%","8/12":"66.666667%","9/12":"75%","10/12":"83.333333%","11/12":"91.666667%",full:"100%",screen:"100vw",svw:"100svw",lvw:"100lvw",dvw:"100dvw",min:"min-content",max:"max-content",fit:"fit-content"}),willChange:{auto:"auto",scroll:"scroll-position",contents:"contents",transform:"transform"},zIndex:{auto:"auto",0:"0",10:"10",20:"20",30:"30",40:"40",50:"50"}},plugins:[]};(function(He){Object.defineProperty(He,"__esModule",{value:!0}),Object.defineProperty(He,"default",{enumerable:!0,get:function(){return ut}});const Qe=cloneDeep,it=lt(config_full);function lt(dt){return dt.__esModule?dt:{default:dt}}const ut=(0,Qe.cloneDeep)(it.default.theme)})(defaultTheme$2);let defaultTheme=defaultTheme$2;var defaultTheme_1=(defaultTheme.__esModule?defaultTheme:{default:defaultTheme}).default;const defaultTheme$1=getDefaultExportFromCjs(defaultTheme_1),defaultBreakpoints=defaultTheme$1.screens,customBreakpoints={xs:"340px",msm:"600px",mmd:"900px",mlg:"1200px",xlg:"1400px",mxl:"1536px"},breakpoints={...defaultBreakpoints,...customBreakpoints},useIsMobile=()=>useBreakpoint("mmd","down"),getMediaQueryForBreakpoint=(He,Qe="down")=>{const it=breakpoints[He];return Qe==="down"?`(width < ${it})`:`(width >= ${it})`},useBreakpoint=(He,Qe="down")=>useMediaQuery(getMediaQueryForBreakpoint(He,Qe),void 0,{getInitialValueInEffect:!1});function getIsMobile(){return testMediaQuery(getMediaQueryForBreakpoint("mmd","down"))}function testMediaQuery(He){return window.matchMedia(He).matches}const useIsLg=()=>useBreakpoint("lg","up"),preloader="_preloader_ni6q6_3",animate="_animate_ni6q6_13",styles$e={preloader,"preloader-cube":"_preloader-cube_ni6q6_7",animate,"preloader-cubeGridScaleDelay":"_preloader-cubeGridScaleDelay_ni6q6_1"},Preloader=({className:He,style:Qe,dark:it,inline:lt,duration:ut=1300})=>{const{ref:dt,entry:xt}=useIntersection();return jsxRuntimeExports.jsx("div",{ref:dt,className:cx(styles$e.preloader,it&&styles$e["preloader-dark"],!lt&&"my-24 mx-auto",He),style:Qe,children:[2,3,4,1,2,3,0,1,2].map((ft,vt)=>jsxRuntimeExports.jsx("div",{className:cx(styles$e["preloader-cube"],"dark:bg-[#ddd]",xt?.isIntersecting&&styles$e.animate,it&&"bg-[#ddd]"),style:{animationDelay:`${ft*.1-.2}s`,animationDuration:`${ut}ms`}},vt))})},LoadingIcon=()=>jsxRuntimeExports.jsx(CircularProgress,{size:28}),LoadingPage=({fullscreen:He,fullHeight:Qe})=>jsxRuntimeExports.jsx("div",{className:cx("w-full flex justify-center items-center",He?"h-screen":Qe?"h-full":"min-h-[600px]"),children:jsxRuntimeExports.jsx(Preloader,{})}),ResponsiveDialog=({open:He,onClose:Qe=()=>{},children:it,dialogProps:lt,className:ut,breakpoint:dt,fullHeight:xt=!0,disableScrollLock:ft=!0})=>{const vt=useBreakpoint(dt??"mmd"),kt=He&&jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(LoadingPage,{}),children:it});return vt?jsxRuntimeExports.jsx(SwipeableDrawer,{anchor:"bottom",disableScrollLock:ft,open:He,onClose:Qe,onOpen:()=>{},disableDiscovery:!0,sx:{"& .MuiDrawer-paper":{height:xt?"calc(100% - 4rem)":"auto"}},slotProps:{paper:{sx:{"&":{borderRadius:"28px 28px 0 0"}}}},children:jsxRuntimeExports.jsxs("div",{className:"relative h-full overflow-hidden",children:[Qe&&jsxRuntimeExports.jsx("div",{className:"mx-auto w-full h-[24px] flex justify-center items-center",onClick:Qe,children:jsxRuntimeExports.jsx("div",{className:"w-12 h-[5px] bg-gray-300 rounded-full",style:{opacity:1},children:" "})}),jsxRuntimeExports.jsx("div",{className:cx("overflow-auto h-[calc(100%-24px)] relative",ut),children:kt})]})}):jsxRuntimeExports.jsx(Dialog,{disableEnforceFocus:!0,fullWidth:!0,maxWidth:"lg",open:He,onClose:Qe,PaperProps:{...lt?.PaperProps,sx:{...lt?.PaperProps?.sx},className:cx(lt?.className,ut)},...lt,children:kt})};function useMountedState(){var He=reactExports.useRef(!1),Qe=reactExports.useCallback(function(){return He.current},[]);return reactExports.useEffect(function(){return He.current=!0,function(){He.current=!1}},[]),Qe}function useAsyncFn(He,Qe,it){Qe===void 0&&(Qe=[]),it===void 0&&(it={loading:!1});var lt=reactExports.useRef(0),ut=useMountedState(),dt=reactExports.useState(it),xt=dt[0],ft=dt[1],vt=reactExports.useCallback(function(){for(var kt=[],St=0;St<arguments.length;St++)kt[St]=arguments[St];var Tt=++lt.current;return xt.loading||ft(function(Mt){return __assign$1(__assign$1({},Mt),{loading:!0})}),He.apply(void 0,kt).then(function(Mt){return ut()&&Tt===lt.current&&ft({value:Mt,loading:!1}),Mt},function(Mt){return ut()&&Tt===lt.current&&ft({error:Mt,loading:!1}),Mt})},Qe);return[xt,vt]}function useAsync(He,Qe){Qe===void 0&&(Qe=[]);var it=useAsyncFn(He,Qe,{loading:!0}),lt=it[0],ut=it[1];return reactExports.useEffect(function(){ut()},[ut]),lt}var useSetState=function(He){He===void 0&&(He={});var Qe=reactExports.useState(He),it=Qe[0],lt=Qe[1],ut=reactExports.useCallback(function(dt){lt(function(xt){return Object.assign({},xt,dt instanceof Function?dt(xt):dt)})},[]);return[it,ut]},noop$3=function(){};function on(He){for(var Qe=[],it=1;it<arguments.length;it++)Qe[it-1]=arguments[it];He&&He.addEventListener&&He.addEventListener.apply(He,Qe)}function off(He){for(var Qe=[],it=1;it<arguments.length;it++)Qe[it-1]=arguments[it];He&&He.removeEventListener&&He.removeEventListener.apply(He,Qe)}var isBrowser$1=typeof window<"u",useIsomorphicLayoutEffect=isBrowser$1?reactExports.useLayoutEffect:reactExports.useEffect;function useTimeoutFn(He,Qe){Qe===void 0&&(Qe=0);var it=reactExports.useRef(!1),lt=reactExports.useRef(),ut=reactExports.useRef(He),dt=reactExports.useCallback(function(){return it.current},[]),xt=reactExports.useCallback(function(){it.current=!1,lt.current&&clearTimeout(lt.current),lt.current=setTimeout(function(){it.current=!0,ut.current()},Qe)},[Qe]),ft=reactExports.useCallback(function(){it.current=null,lt.current&&clearTimeout(lt.current)},[]);return reactExports.useEffect(function(){ut.current=He},[He]),reactExports.useEffect(function(){return xt(),ft},[Qe]),[dt,ft,xt]}function useDebounce(He,Qe,it){Qe===void 0&&(Qe=0),it===void 0&&(it=[]);var lt=useTimeoutFn(He,Qe),ut=lt[0],dt=lt[1],xt=lt[2];return reactExports.useEffect(xt,it),[ut,dt]}var useEffectOnce=function(He){reactExports.useEffect(He,[])},defaultTarget=isBrowser$1?window:null,isListenerType1=function(He){return!!He.addEventListener},isListenerType2=function(He){return!!He.on},useEvent$1=function(He,Qe,it,lt){it===void 0&&(it=defaultTarget),reactExports.useEffect(function(){if(Qe&&it)return isListenerType1(it)?on(it,He,Qe,lt):isListenerType2(it)&&it.on(He,Qe,lt),function(){isListenerType1(it)?off(it,He,Qe,lt):isListenerType2(it)&&it.off(He,Qe,lt)}},[He,Qe,it,JSON.stringify(lt)])},useMount=function(He){useEffectOnce(function(){He()})},useUnmount=function(He){var Qe=reactExports.useRef(He);Qe.current=He,useEffectOnce(function(){return function(){return Qe.current()}})};function useObservable(He,Qe){var it=reactExports.useState(Qe),lt=it[0],ut=it[1];return useIsomorphicLayoutEffect(function(){var dt=He.subscribe(ut);return function(){return dt.unsubscribe()}},[He]),lt}var defaultState={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};function useMeasure(){var He=reactExports.useState(null),Qe=He[0],it=He[1],lt=reactExports.useState(defaultState),ut=lt[0],dt=lt[1],xt=reactExports.useMemo(function(){return new window.ResizeObserver(function(ft){if(ft[0]){var vt=ft[0].contentRect,kt=vt.x,St=vt.y,Tt=vt.width,Mt=vt.height,Nt=vt.top,At=vt.left,$t=vt.bottom,Dt=vt.right;dt({x:kt,y:St,width:Tt,height:Mt,top:Nt,left:At,bottom:$t,right:Dt})}})},[]);return useIsomorphicLayoutEffect(function(){if(Qe)return xt.observe(Qe),function(){xt.disconnect()}},[Qe]),[it,ut]}const useMeasure$1=isBrowser$1&&typeof window.ResizeObserver<"u"?useMeasure:function(){return[noop$3,defaultState]};function UseState(He){const[Qe,it]=reactExports.useState(He.initial);return He.children(Qe,it)}var l$1=He=>typeof He=="boolean"?`${He}`:He===0?"0":He,u$1=He=>!He||typeof He!="object"||Object.keys(He).length===0,x$2=(He,Qe)=>JSON.stringify(He)===JSON.stringify(Qe);function i$1(He,Qe){He.forEach(function(it){Array.isArray(it)?i$1(it,Qe):Qe.push(it)})}function y$1(He){let Qe=[];return i$1(He,Qe),Qe}var a=(...He)=>y$1(He).filter(Boolean),p$1=(He,Qe)=>{let it={},lt=Object.keys(He),ut=Object.keys(Qe);for(let dt of lt)if(ut.includes(dt)){let xt=He[dt],ft=Qe[dt];typeof xt=="object"&&typeof ft=="object"?it[dt]=p$1(xt,ft):Array.isArray(xt)||Array.isArray(ft)?it[dt]=a(ft,xt):it[dt]=ft+" "+xt}else it[dt]=He[dt];for(let dt of ut)lt.includes(dt)||(it[dt]=Qe[dt]);return it},g$1=He=>!He||typeof He!="string"?He:He.replace(/\s+/g," ").trim(),ie$1={twMerge:!0,twMergeConfig:{},responsiveVariants:!1},_$2=He=>He||void 0,M$3=(...He)=>_$2(y$1(He).filter(Boolean).join(" ")),R$2=null,v$2={},q$3=!1,j$3=(...He)=>Qe=>Qe.twMerge?((!R$2||q$3)&&(q$3=!1,R$2=u$1(v$2)?twMerge:extendTailwindMerge({...v$2,extend:{theme:v$2.theme,classGroups:v$2.classGroups,conflictingClassGroupModifiers:v$2.conflictingClassGroupModifiers,conflictingClassGroups:v$2.conflictingClassGroups,...v$2.extend}})),_$2(R$2(M$3(He)))):M$3(He),Z$1=(He,Qe)=>{for(let it in Qe)He.hasOwnProperty(it)?He[it]=M$3(He[it],Qe[it]):He[it]=Qe[it];return He},ce$1=(He,Qe)=>{let{extend:it=null,slots:lt={},variants:ut={},compoundVariants:dt=[],compoundSlots:xt=[],defaultVariants:ft={}}=He,vt={...ie$1,...Qe},kt=it!=null&&it.base?M$3(it.base,He?.base):He?.base,St=it!=null&&it.variants&&!u$1(it.variants)?p$1(ut,it.variants):ut,Tt=it!=null&&it.defaultVariants&&!u$1(it.defaultVariants)?{...it.defaultVariants,...ft}:ft;!u$1(vt.twMergeConfig)&&!x$2(vt.twMergeConfig,v$2)&&(q$3=!0,v$2=vt.twMergeConfig);let Mt=u$1(it?.slots),Nt=u$1(lt)?{}:{base:M$3(He?.base,Mt&&it?.base),...lt},At=Mt?Nt:Z$1({...it?.slots},u$1(Nt)?{base:He?.base}:Nt),$t=u$1(it?.compoundVariants)?dt:a(it?.compoundVariants,dt),Dt=Bt=>{if(u$1(St)&&u$1(lt)&&Mt)return j$3(kt,Bt?.class,Bt?.className)(vt);if($t&&!Array.isArray($t))throw new TypeError(`The "compoundVariants" prop must be an array. Received: ${typeof $t}`);if(xt&&!Array.isArray(xt))throw new TypeError(`The "compoundSlots" prop must be an array. Received: ${typeof xt}`);let Ot=(br,vr,yr=[],Cr)=>{let Rr=yr;if(typeof vr=="string")Rr=Rr.concat(g$1(vr).split(" ").map(Ir=>`${br}:${Ir}`));else if(Array.isArray(vr))Rr=Rr.concat(vr.reduce((Ir,Tr)=>Ir.concat(`${br}:${Tr}`),[]));else if(typeof vr=="object"&&typeof Cr=="string"){for(let Ir in vr)if(vr.hasOwnProperty(Ir)&&Ir===Cr){let Tr=vr[Ir];if(Tr&&typeof Tr=="string"){let $r=g$1(Tr);Rr[Cr]?Rr[Cr]=Rr[Cr].concat($r.split(" ").map(Zr=>`${br}:${Zr}`)):Rr[Cr]=$r.split(" ").map(Zr=>`${br}:${Zr}`)}else Array.isArray(Tr)&&Tr.length>0&&(Rr[Cr]=Tr.reduce(($r,Zr)=>$r.concat(`${br}:${Zr}`),[]))}}return Rr},Qt=(br,vr=St,yr=null,Cr=null)=>{var Rr;let Ir=vr[br];if(!Ir||u$1(Ir))return null;let Tr=(Rr=Cr?.[br])!=null?Rr:Bt?.[br];if(Tr===null)return null;let $r=l$1(Tr),Zr=Array.isArray(vt.responsiveVariants)&&vt.responsiveVariants.length>0||vt.responsiveVariants===!0,Sr=Tt?.[br],Dr=[];if(typeof $r=="object"&&Zr)for(let[Nr,Jr]of Object.entries($r)){let Qr=Ir[Jr];if(Nr==="initial"){Sr=Jr;continue}Array.isArray(vt.responsiveVariants)&&!vt.responsiveVariants.includes(Nr)||(Dr=Ot(Nr,Qr,Dr,yr))}let wr=$r!=null&&typeof $r!="object"?$r:l$1(Sr),qr=Ir[wr||"false"];return typeof Dr=="object"&&typeof yr=="string"&&Dr[yr]?Z$1(Dr,qr):Dr.length>0?(Dr.push(qr),Dr):qr},Wt=()=>St?Object.keys(St).map(br=>Qt(br,St)):null,Xt=(br,vr)=>{if(!St||typeof St!="object")return null;let yr=new Array;for(let Cr in St){let Rr=Qt(Cr,St,br,vr),Ir=br==="base"&&typeof Rr=="string"?Rr:Rr&&Rr[br];Ir&&(yr[yr.length]=Ir)}return yr},Kt={};for(let br in Bt)Bt[br]!==void 0&&(Kt[br]=Bt[br]);let Jt=(br,vr)=>{var yr;let Cr=typeof Bt?.[br]=="object"?{[br]:(yr=Bt[br])==null?void 0:yr.initial}:{};return{...Tt,...Kt,...Cr,...vr}},hr=(br=[],vr)=>{let yr=[];for(let{class:Cr,className:Rr,...Ir}of br){let Tr=!0;for(let[$r,Zr]of Object.entries(Ir)){let Sr=Jt($r,vr);if(Array.isArray(Zr)){if(!Zr.includes(Sr[$r])){Tr=!1;break}}else if(Sr[$r]!==Zr){Tr=!1;break}}Tr&&(Cr&&yr.push(Cr),Rr&&yr.push(Rr))}return yr},xr=br=>{let vr=hr($t,br);if(!Array.isArray(vr))return vr;let yr={};for(let Cr of vr)if(typeof Cr=="string"&&(yr.base=j$3(yr.base,Cr)(vt)),typeof Cr=="object")for(let[Rr,Ir]of Object.entries(Cr))yr[Rr]=j$3(yr[Rr],Ir)(vt);return yr},gr=br=>{if(xt.length<1)return null;let vr={};for(let{slots:yr=[],class:Cr,className:Rr,...Ir}of xt){if(!u$1(Ir)){let Tr=!0;for(let $r of Object.keys(Ir)){let Zr=Jt($r,br)[$r];if(Zr===void 0||(Array.isArray(Ir[$r])?!Ir[$r].includes(Zr):Ir[$r]!==Zr)){Tr=!1;break}}if(!Tr)continue}for(let Tr of yr)vr[Tr]=vr[Tr]||[],vr[Tr].push([Cr,Rr])}return vr};if(!u$1(lt)||!Mt){let br={};if(typeof At=="object"&&!u$1(At))for(let vr of Object.keys(At))br[vr]=yr=>{var Cr,Rr;return j$3(At[vr],Xt(vr,yr),((Cr=xr(yr))!=null?Cr:[])[vr],((Rr=gr(yr))!=null?Rr:[])[vr],yr?.class,yr?.className)(vt)};return br}return j$3(kt,Wt(),hr($t),Bt?.class,Bt?.className)(vt)},Ft=()=>{if(!(!St||typeof St!="object"))return Object.keys(St)};return Dt.variantKeys=Ft(),Dt.extend=it,Dt.base=kt,Dt.slots=At,Dt.variants=St,Dt.defaultVariants=Tt,Dt.compoundSlots=xt,Dt.compoundVariants=$t,Dt};const fluentSpinnerIos20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10 3.5A6.5 6.5 0 0 0 3.5 10A.75.75 0 0 1 2 10a8 8 0 1 1 8 8a.75.75 0 0 1 0-1.5a6.5 6.5 0 1 0 0-13"})}),buttonStyles$3=ce$1({slots:{root:"inline-grid grid-cols-[auto_1fr_auto] items-center h-[--ui-size] rounded-md focus:outline outline-2 outline-offset-1 transition duration-75",label:"row-start-1 col-start-2",startIcon:"row-start-1 col-start-1 size-[--ui-size]",endIcon:"row-start-1 col-start-3 size-[--ui-size]",spinner:"place-self-center animate-spin"},variants:{variant:{outlined:{root:["border","disabled:text-black/40 disabled:border-black/20","dark:disabled:text-white/40 dark:disabled:border-white/20"]},filled:{root:["disabled:text-black/50 disabled:bg-black/15","dark:disabled:text-white/50 dark:disabled:bg-white/15"]},ghost:{root:["disabled:text-black/40","dark:disabled:text-white/40"]}},size:{small:{spinner:"size-5"},normal:{spinner:"size-5"},large:{spinner:"size-6"},xl:{spinner:"size-7"}},color:{normal:{},danger:{},admin:{},theme:{},"grayish-sidebar":{}},colorScheme:{auto:{},dark:{},light:{}},hasLabel:{false:{label:"hidden"}},hasStartIcon:{false:{startIcon:"hidden"}},hasEndIcon:{false:{endIcon:"hidden"}},hasBusyLabel:{true:{},false:{}},busy:{false:{spinner:"hidden"}}},compoundVariants:[{variant:["outlined","filled"],size:["small","normal"],className:{root:"text-sm"}},{variant:["outlined","filled"],size:"large",className:{root:"text-base"}},{variant:["outlined","filled"],size:"xl",className:{root:"text-lg"}},{variant:["outlined","filled"],size:"small",className:{root:"[--ui-size:theme(spacing.7)]"}},{variant:["outlined","filled"],size:"normal",className:{root:"[--ui-size:theme(spacing.8)]"}},{variant:["outlined","filled"],size:"large",className:{root:"[--ui-size:theme(spacing.10)]"}},{variant:["outlined","filled"],size:"xl",className:{root:"[--ui-size:theme(spacing.12)]"}},{variant:["outlined","filled"],hasStartIcon:!0,className:{startIcon:"grid place-content-center"}},{variant:["outlined","filled"],hasEndIcon:!0,className:{endIcon:"grid place-content-center"}},{variant:["outlined","filled"],hasStartIcon:!1,size:"small",className:{root:"pl-2"}},{variant:["outlined","filled"],hasLabel:!0,hasEndIcon:!1,size:"small",className:{root:"pr-2"}},{variant:["outlined","filled"],hasStartIcon:!1,size:"normal",className:{root:"pl-2.5"}},{variant:["outlined","filled"],hasLabel:!0,hasEndIcon:!1,size:"normal",className:{root:"pr-2.5"}},{variant:["outlined","filled"],hasStartIcon:!1,size:"large",className:{root:"pl-3"}},{variant:["outlined","filled"],hasLabel:!0,hasEndIcon:!1,size:"large",className:{root:"pr-3"}},{variant:["outlined","filled"],hasStartIcon:!1,size:"xl",className:{root:"pl-4"}},{variant:["outlined","filled"],hasLabel:!0,hasEndIcon:!1,size:"xl",className:{root:"pr-4"}},{variant:"outlined",color:"normal",className:{root:["hover:bg-black/5 border-black/50 focus:border-black/20 outline-black/80","dark:hover:bg-white/5 dark:border-white/50 dark:focus:border-white/20 dark:outline-white/80"]}},{variant:"outlined",color:"theme",className:{root:["text-purple-600 hover:bg-purple-600/10 border-purple-600 focus:border-purple-600/20 outline-purple-600","dark:text-purple-500 dark:hover:bg-purple-500/10 dark:border-purple-500 dark:focus:border-purple-500/20 dark:outline-purple-500"]}},{variant:"outlined",color:"danger",className:{root:["text-red-600 hover:bg-red-600/10 border-red-600 focus:border-red-600/20 outline-red-600","dark:text-red-500 dark:hover:bg-red-500/10 dark:border-red-500 dark:focus:border-red-500/20 dark:outline-red-500"]}},{variant:"outlined",color:"admin",className:{root:["text-amber-700 hover:bg-amber-600/10 border-amber-600 focus:border-amber-600/20 outline-amber-600","dark:text-amber-500 dark:hover:bg-amber-500/10 dark:border-amber-500 dark:focus:border-amber-500/20 dark:outline-amber-500"]}},{variant:"filled",color:"normal",colorScheme:"auto",className:{root:["text-white bg-black hover:bg-[color-mix(in_srgb,#000,#FFF_25%)] outline-black","dark:text-black dark:bg-[color-mix(in_srgb,#FFF,#000_10%)] dark:hover:bg-white dark:outline-white"]}},{variant:"filled",color:"normal",colorScheme:"dark",className:{root:"text-black bg-[color-mix(in_srgb,#FFF,#000_10%)] hover:bg-white outline-white"}},{variant:"filled",color:"theme",className:{root:["text-white bg-purple-600 hover:bg-purple-500 ","outline-purple-600","dark:outline-purple-500"]}},{variant:"filled",color:"grayish-sidebar",className:{root:["font-medium h-9","drop-shadow-sm dark:shadow-black/30 hover:shadow-black/20 dark:hover:shadow-black/60 active:shadow-black/10 dark:active:shadow-black shadow hover:shadow-md active:shadow-md dark:active:shadow disabled:shadow-none","text-black bg-background-light","ring-black/10 dark:ring-black/20 active:ring-black/20 dark:active:ring-black/40","dark:text-white disabled:text-black/50 dark:disabled:text-white/40"]}},{variant:"filled",color:"danger",className:{root:"text-white bg-red-600 hover:bg-red-500 outline-red-500"}},{variant:"filled",color:"admin",className:{root:["text-white outline-amber-600","bg-[color-mix(in_srgb,theme(colors.amber.700),#FFF_20%)] hover:bg-[color-mix(in_srgb,theme(colors.amber.700),#FFF_30%)]","dark:bg-[color-mix(in_srgb,theme(colors.amber.600),#000_20%)] dark:hover:bg-[color-mix(in_srgb,theme(colors.amber.600),#000_10%)]"]}},{variant:"ghost",color:"normal",className:{root:["hover:bg-black/5 outline-black/80","dark:hover:bg-white/5 dark:outline-white/80"]}},{variant:"ghost",color:"danger",className:{root:["text-red-600 hover:bg-red-600/10 outline-red-600","dark:text-red-500 dark:hover:bg-red-500/10 dark:outline-red-500"]}},{variant:"ghost",color:"admin",className:{root:["text-amber-700 hover:bg-amber-600/10 outline-amber-600","dark:text-amber-500 dark:hover:bg-amber-500/10 dark:outline-amber-500"]}},{hasStartIcon:!0,busy:!0,className:{startIcon:"invisible",spinner:"row-start-1 col-start-1"}},{hasStartIcon:!1,hasEndIcon:!0,busy:!0,className:{endIcon:"invisible",spinner:"row-start-1 col-start-3"}},{hasStartIcon:!1,hasEndIcon:!1,hasBusyLabel:!0,busy:!0,className:{spinner:"row-start-1 col-start-3"}},{hasStartIcon:!1,hasEndIcon:!1,hasBusyLabel:!1,busy:!0,className:{label:"invisible",spinner:"row-start-1 col-start-2"}}],compoundSlots:[{slots:["startIcon","endIcon"],variant:["outlined","filled"],className:"h-full aspect-square"}],defaultVariants:{variant:"outlined",size:"normal",color:"normal",hasLabel:!1,hasStartIcon:!1,hasEndIcon:!1}}),UIButton$1=reactExports.forwardRef(function(Qe,it){const[lt,ut]=reactExports.useState(Qe.busy===!0);typeof Qe.busy=="boolean"&&lt!==Qe.busy&&ut(Qe.busy);async function dt(ft){if(Qe.busy==="auto")try{ut(!0),await Qe.onPress?.(ft)}finally{ut(!1)}else Qe.onPress?.(ft)}const xt=buttonStyles$3({variant:Qe.variant,size:Qe.size,color:Qe.color,colorScheme:Qe.colorScheme??"auto",hasLabel:!!Qe.children,hasStartIcon:!!Qe.icon,hasEndIcon:!!Qe.endIcon,hasBusyLabel:!!Qe.busyLabel,busy:lt});return jsxRuntimeExports.jsxs($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{ref:it,isDisabled:Qe.disabled||lt,className:xt.root({className:Qe.className}),style:Qe.style,slot:Qe.slot,onPress:dt,onFocus:Qe.onFocus,type:Qe.type,children:[jsxRuntimeExports.jsx("span",{className:xt.startIcon({className:Qe.startIconClassName}),children:Qe.icon}),jsxRuntimeExports.jsx("span",{className:xt.label({className:Qe.labelClassName}),children:lt?Qe.busyLabel??Qe.children:Qe.children}),jsxRuntimeExports.jsx("span",{className:xt.endIcon({className:Qe.endIconClassName}),children:Qe.endIcon}),jsxRuntimeExports.jsx(fluentSpinnerIos20Filled,{className:xt.spinner()})]})});UIButton$1.displayName="UIButton";function Text(He){return jsxRuntimeExports.jsx(reactExports.Suspense,{children:jsxRuntimeExports.jsx(TransAsText,{...He})})}function TransAsText(He){const Qe=$$3(He).with({ns:N$4.string.minLength(1)},()=>He.ns).with({i18nKey:N$4.select(N$4.string.includes(":"))},lt=>lt.split(":",1)).with({i18nKey:N$4.select(N$4.array(N$4.string.includes(":")))},lt=>lt.map(ut=>ut.split(":",1)).flat()).otherwise(()=>{}),{t:it}=useTranslation(Qe);return jsxRuntimeExports.jsx(Trans,{t:it,...He})}const isMac=()=>/Mac/.test(navigator.platform),isSafari=()=>navigator.vendor==="Apple Computer, Inc.",isIOS$1=()=>/iPad|iPhone|iPod/.test(window.navigator.userAgent)&&!window.MSStream&&isSafari(),isAndroid=()=>/android/i.test(window.navigator.userAgent),ANDROID_BRIDGE_NAME$1="pixaiAppBridge";function isIOSWebview(){return isIOS$1()?typeof window.webkit?.messageHandlers?.nativeBridge?.postMessage=="function":!1}function isAndroidWebview(){return isAndroid()?typeof window[ANDROID_BRIDGE_NAME$1]?.postMessage=="function":!1}function isAppWebview(){return isIOSWebview()||isAndroidWebview()}const MotionAriaModalOverlay=motion($f3f84453ead64de5$export$8948f78d83984c69),MotionAriaModal=motion($f3f84453ead64de5$export$2b77a92f1a5ad772),layerStyle=ce$1({base:"fixed inset-0 z-[1201] [--ui-modal-layer-bg:#0008] dark:[--ui-modal-layer-bg:#000b]",variants:{type:{dialog:["grid place-items-center px-4 overflow-auto","pt-[max(16px,var(--safe-area-inset-top,env(safe-area-inset-top)))]","pb-[max(16px,var(--safe-area-inset-bottom,env(safe-area-inset-bottom)))]"],drawer:"flex flex-col justify-end pt-12 pb-0 overflow-hidden"}},defaultVariants:{type:"dialog"}});function UIModalLayer(He){return jsxRuntimeExports.jsx($f3f84453ead64de5$export$ab57792b9b6974a6.Provider,{value:{isOpen:He.open,onOpenChange:Qe=>{Qe||He.onClose?.()},isDismissable:He.dismissable===!0,isKeyboardDismissDisabled:He.dismissable===!1},children:jsxRuntimeExports.jsx(AnimatePresence,{onExitComplete:He.onExitComplete,children:He.open&&jsxRuntimeExports.jsx(MotionAriaModalOverlay,{isOpen:!0,"data-ui":"modal-layer",className:layerStyle({type:He.type,className:He.className}),style:He.style,initial:{backgroundColor:"#0000"},animate:{backgroundColor:"var(--ui-modal-layer-bg)"},exit:{backgroundColor:"#0000"},transition:{duration:.2},shouldCloseOnInteractOutside:Qe=>!Qe.closest([".Toastify",".MuiPopover-root",".pswp",'[role="dialog"]:not([data-rac])'].join(",")),children:He.children})})})}const modalStyle=ce$1({variants:{type:{dialog:"",drawer:"max-h-full"}},defaultVariants:{type:"dialog"}});function UIModal(He){const{dragControls:Qe}=reactExports.useContext(UIDialogContext),{type:it,className:lt,style:ut,modalLayerProps:dt,...xt}=He,ft=useMotionValue(0);function vt(kt){switch(kt){case"drawer":return{initial:{y:"calc(100% + 14px)"},animate:{y:0},exit:{y:"calc(100% + 14px)"},transition:{duration:.5,ease:[.32,.72,0,1]},drag:"y",dragListener:!1,dragControls:Qe,dragConstraints:{top:0},onDragEnd:(St,{offset:Tt,velocity:Mt})=>{const $t=St.target.closest('[data-ui="modal-layer"]')?.clientHeight||800;Tt.y>$t*.75||Mt.y>10?He.onClose?.():animate$1(ft,0,{type:"inertia",bounceStiffness:300,bounceDamping:40,timeConstant:300,min:0,max:0})}};case"dialog":default:return{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,ease:[.32,.72,0,1]},exit:{opacity:0,scale:.95,transition:{duration:.2,ease:[.32,.72,0,1]}}}}}return jsxRuntimeExports.jsx(UIModalLayer,{...xt,...dt,type:it,children:jsxRuntimeExports.jsxs(MotionAriaModal,{"data-ui":"modal",className:modalStyle({type:it,className:lt}),style:{...ut,y:ft},...vt(it),children:[it==="drawer"&&jsxRuntimeExports.jsx("div",{className:"flex justify-center items-end h-0",onPointerDown:kt=>Qe.start(kt),children:jsxRuntimeExports.jsx("div",{className:"my-1 w-12 h-1.5 bg-white rounded-full shadow-sm shadow-black/50 ring-1 ring-black/10"})}),He.children]})})}const dialogStyles=ce$1({slots:{root:["shadow-xl ring-1 outline-none","bg-white ring-black/10","dark:bg-zinc-800 dark:shadow-black/20 dark:ring-white/10"],header:"p-4 msm:p-6",content:"p-4 msm:p-6",footer:"flex msm:justify-end flex-wrap gap-3 p-3"},variants:{type:{dialog:{root:"min-w-[300px] rounded-xl",footer:"rounded-b-xl"},drawer:{root:"flex flex-col rounded-t-xl relative max-h-full",header:"flex-none",content:"flex-1 overflow-auto min-h-0",footer:"flex-none"}},withHeader:{true:{content:"pt-0 msm:pt-0",footer:"bg-zinc-100 dark:bg-[color-mix(in_srgb,theme(colors.zinc.800),#000_15%)] border-t border-zinc-200 dark:border-white/10"},false:{footer:"gap-3 pt-0"}}},defaultVariants:{type:"dialog",withHeader:!1}}),UIDialogContext=reactExports.createContext({});function UIDialog(He){const{className:Qe,style:it,...lt}=He,[ut,dt]=reactExports.useState(!1),xt=useDragControls(),ft=dialogStyles({type:lt.type,withHeader:ut});return jsxRuntimeExports.jsx(UIDialogContext.Provider,{value:{type:lt.type,styles:ft,setWithHeader:dt,dragControls:xt,onClose:He.onClose},children:jsxRuntimeExports.jsx(UIModal,{...lt,children:jsxRuntimeExports.jsx($de32f1b87079253c$export$3ddf2d174ce01153,{"data-ui":"dialog",className:ft.root({className:Qe}),style:it,children:He.children})})})}UIDialog.create=async function(He){const{heading:Qe,content:it,footer:lt,children:ut,...dt}=He;return new Promise((xt,ft)=>{const vt=dynamicCreateElement(jsxRuntimeExports.jsx(UseState,{initial:!0,children:(kt,St)=>{const Tt=()=>{xt(void 0),St(!1)};return jsxRuntimeExports.jsx(UIDialog,{...$3ef42575df84b30b$export$9d1611c77c2fe928({open:kt,onClose:Tt,className:"max-w-[400px]",onExitComplete:()=>{vt()}},dt),children:ut?jsxRuntimeExports.jsx(CloseableChildren,{onClose:()=>{St(!1)},resolve:xt,children:ut}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Qe&&jsxRuntimeExports.jsx(UIDialogHeader,{heading:Qe}),jsxRuntimeExports.jsx(UIDialogContent,{children:it}),lt&&jsxRuntimeExports.jsx(UIDialogFooter,{children:lt})]})})}}))})};function CloseableChildren(He){const{children:Qe,onClose:it,resolve:lt}=He;if(!Qe||!it)return null;const ut=()=>{lt(void 0),it()};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:typeof Qe=="function"?Qe({close:ut,closeDialog:it,resolve:He.resolve}):Qe})}UIDialog.alert=async He=>{const{confirmProps:Qe=void 0,...it}=typeof He=="object"&&"content"in He?He:{content:He};return UIDialog.create({...it,footer:({close:lt})=>jsxRuntimeExports.jsx(UIButton$1,{...$3ef42575df84b30b$export$9d1611c77c2fe928({variant:"filled",className:"max-msm:flex-1 min-w-16 capitalize",onPress:lt},Qe),children:Qe?.children??jsxRuntimeExports.jsx(Text,{i18nKey:"action:ok"})})})};UIDialog.confirm=async He=>{const{confirmProps:Qe=void 0,cancelProps:it=void 0,...lt}=typeof He=="object"&&"content"in He?He:{content:He};let ut=!1;return UIDialog.create({...lt,footer:({close:dt})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIButton$1,{...$3ef42575df84b30b$export$9d1611c77c2fe928({className:"max-msm:flex-1 min-w-16 capitalize",onPress:()=>{ut=!1,dt()}},it),children:it?.children??jsxRuntimeExports.jsx(Text,{i18nKey:"action:cancel"})}),jsxRuntimeExports.jsx(UIButton$1,{...$3ef42575df84b30b$export$9d1611c77c2fe928({variant:"filled",className:"max-msm:flex-1 min-w-16 capitalize",onPress:()=>{ut=!0,dt()}},Qe),children:Qe?.children??jsxRuntimeExports.jsx(Text,{i18nKey:"action:confirm"})})]})}).then(()=>ut)};function UIDialogHeader(He){const{setWithHeader:Qe,dragControls:it,styles:lt}=reactExports.useContext(UIDialogContext);reactExports.useEffect(()=>(Qe(!0),()=>Qe(!1)),[Qe]);const ut=jsxRuntimeExports.jsx($5cb03073d3f54797$export$a8a3e93435678ff9,{slot:"title",className:"text-lg -my-1",onPointerDown:dt=>it.start(dt),children:He.heading});return jsxRuntimeExports.jsx("header",{"data-ui":"dialog-header",className:lt.header({className:He.className}),style:He.style,children:He.children?He.children({heading:ut}):ut})}function UIDialogContent(He){const{styles:Qe,onClose:it}=reactExports.useContext(UIDialogContext);return jsxRuntimeExports.jsx("div",{"data-ui":"dialog-content",className:Qe.content({className:He.className}),style:He.style,children:typeof He.children=="function"?He.children({close:()=>it?.()}):He.children})}function UIDialogFooter(He){const{styles:Qe,onClose:it}=reactExports.useContext(UIDialogContext);return jsxRuntimeExports.jsx("footer",{"data-ui":"dialog-footer",className:Qe.footer({className:He.className}),style:He.style,children:typeof He.children=="function"?He.children({close:()=>it?.()}):He.children})}function UIDialogResponsive(He){const{isMobile:Qe,...it}=He,lt=useIsMobile(),ut=isAppWebview()?!0:Qe??lt;return jsxRuntimeExports.jsx(UIDialog,{...it,type:ut?"drawer":"dialog"})}function useHoverMediaQuery(He){return useMediaQuery("(hover: hover) and (pointer: fine)")}const icOutlineHelpOutline=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8s8 3.59 8 8s-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5c0-2.21-1.79-4-4-4z"})}),HelpPopover=({children:He,scene:Qe,className:it,trigger:lt})=>{const[ut,dt]=React.useState(),xt=reactExports.useRef();function ft(St){dt(St)}function vt(){dt(void 0)}const kt=reactExports.useCallback(()=>{xt.current&&clearTimeout(xt.current),xt.current=setTimeout(vt,100)},[]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:cx("flex items-center justify-center",it),onMouseOver:St=>{ft(St.currentTarget),track("help_icon_show",{scene:Qe})},onMouseLeave:kt,children:lt}),jsxRuntimeExports.jsx(Popover,{open:!!ut,anchorEl:ut,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},className:"pointer-events-none",onClose:vt,disableRestoreFocus:!0,disableAutoFocus:!0,slotProps:{paper:{className:"pointer-events-auto",onMouseEnter:()=>clearTimeout(xt.current),onMouseLeave:vt}},children:He})]})},tooltipStyles=ce$1({base:"group bg-modal-background text-sm rounded-lg drop-shadow-lg will-change-transform shadow-[0_0_20px_0_#0000001a]",variants:{isEntering:{true:"animate-in fade-in placement-bottom:slide-in-from-top-0.5 placement-top:slide-in-from-bottom-0.5 placement-left:slide-in-from-right-0.5 placement-right:slide-in-from-left-0.5 ease-out duration-200"},isExiting:{true:"animate-out fade-out placement-bottom:slide-out-to-top-0.5 placement-top:slide-out-to-bottom-0.5 placement-left:slide-out-to-right-0.5 placement-right:slide-out-to-left-0.5 ease-in duration-150"}}});function UITooltip(He){const{children:Qe,TooltipProps:it}=He;return jsxRuntimeExports.jsxs($4e3b923658d69c60$export$28c660c63b792dea,{offset:10,...it,className:$64fa3d84918910a7$export$c245e6201fed2f75(it?.className,(lt,ut)=>tooltipStyles({...ut,className:lt})),children:[jsxRuntimeExports.jsx(UITooltipArrow,{}),Qe]})}function UITooltipArrow(){return jsxRuntimeExports.jsx($44f671af83e7d9e0$export$746d02f47f4d381,{children:jsxRuntimeExports.jsx("svg",{width:12,height:12,viewBox:"0 0 12 12",className:"fill-modal-background group-placement-bottom:rotate-180 group-placement-left:-rotate-90 group-placement-right:rotate-90",children:jsxRuntimeExports.jsx("path",{d:"M0 0 L4 4 L8 0"})})})}function UITooltipTriggerWrapper({trigger:He,delay:Qe,children:it,TooltipProps:lt,...ut}){return jsxRuntimeExports.jsxs($4e3b923658d69c60$export$8c610744efcf8a1d,{delay:Qe,children:[He,jsxRuntimeExports.jsx(UITooltip,{children:it,TooltipProps:{...lt,...ut}})]})}const HelpIcon=({iconClassname:He,iconComp:Qe=icOutlineHelpOutline,...it})=>jsxRuntimeExports.jsx(HelpPopover,{...it,trigger:jsxRuntimeExports.jsx(Qe,{className:He})}),helpTooltipStyles=ce$1({slots:{tooltip:"overflow-auto",modal:"overflow-auto",dialog:"flex-col flex outline-none"},variants:{variant:{normal:""},showClose:{false:""},showConfirm:{false:""}},compoundVariants:[{variant:"normal",class:{tooltip:"p-4",dialog:"",modal:"p-4"}},{variant:"normal",showClose:!0,class:{modal:"pt-0"}},{variant:"normal",showConfirm:!0,class:{modal:"pb-0"}}]});function UITooltipResponsive(He){const Qe=useHoverMediaQuery(),{variant:it,wrapperClassName:lt,TooltipProps:ut,trigger:dt}=He;return Qe?jsxRuntimeExports.jsx(UITooltipTriggerWrapper,{delay:ut?.delay??250,TooltipProps:ut,trigger:dt(),className:"flex",children:jsxRuntimeExports.jsx("div",{className:helpTooltipStyles().tooltip({variant:it,className:lt}),children:He.children})}):dt(()=>UIDialog.alert(jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:He.children})))}function UITooltipHelpIcon(He){const{iconComp:Qe=icOutlineHelpOutline,iconClassName:it,...lt}=He,ut=dt=>jsxRuntimeExports.jsx($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{onPress:dt,children:jsxRuntimeExports.jsx(Qe,{className:cx("size-4",it)})});return jsxRuntimeExports.jsx(UITooltipResponsive,{...lt,trigger:ut})}const m$1=(He,Qe,it)=>{const lt=document.createElement(He),[ut,dt]=Array.isArray(Qe)?[void 0,Qe]:[Qe,it];return ut&&Object.assign(lt,ut),dt?.forEach(xt=>lt.appendChild(xt)),lt},F$1=(He,Qe)=>{var it;return Qe==="left"?He.offsetLeft:(((it=He.offsetParent instanceof HTMLElement?He.offsetParent:null)==null?void 0:it.offsetWidth)??0)-He.offsetWidth-He.offsetLeft},H$2=He=>He.offsetWidth>0&&He.offsetHeight>0,st$1=(He,Qe)=>{customElements.get(He)!==Qe&&customElements.define(He,Qe)};function X$1(He,Qe,{reverse:it=!1}={}){const lt=He.length;for(let ut=it?lt-1:0;it?ut>=0:ut<lt;it?ut--:ut++)Qe(He[ut],ut)}function nt(He,Qe,it,lt){const ut=Qe.formatToParts(He);it&&ut.unshift({type:"prefix",value:it}),lt&&ut.push({type:"suffix",value:lt});const dt=[],xt=[],ft=[],vt=[],kt={},St=$t=>`${$t}:${kt[$t]=(kt[$t]??-1)+1}`;let Tt="",Mt=!1,Nt=!1;for(const $t of ut){Tt+=$t.value;const Dt=$t.type==="minusSign"||$t.type==="plusSign"?"sign":$t.type;Dt==="integer"?(Mt=!0,xt.push(...$t.value.split("").map(Ft=>({type:Dt,value:parseInt(Ft)})))):Dt==="group"?xt.push({type:Dt,value:$t.value}):Dt==="decimal"?(Nt=!0,ft.push({type:Dt,value:$t.value,key:St(Dt)})):Dt==="fraction"?ft.push(...$t.value.split("").map(Ft=>({type:Dt,value:parseInt(Ft),key:St(Dt),pos:-1-kt[Dt]}))):(Mt||Nt?vt:dt).push({type:Dt,value:$t.value,key:St(Dt)})}const At=[];for(let $t=xt.length-1;$t>=0;$t--){const Dt=xt[$t];At.unshift(Dt.type==="integer"?{...Dt,key:St(Dt.type),pos:kt[Dt.type]}:{...Dt,key:St(Dt.type)})}return{pre:dt,integer:At,fraction:ft,post:vt,valueAsString:Tt,value:typeof He=="string"?parseFloat(He):He}}const V$2=String.raw,O$3=(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0})(),z$1=typeof CSS<"u"&&CSS.supports&&CSS.supports("line-height","mod(1,1)"),A$3=typeof matchMedia<"u"?matchMedia("(prefers-reduced-motion: reduce)"):null,$$2="--_number-flow-d-opacity",U$1="--_number-flow-d-width",S$1="--_number-flow-dx",j$2="--_number-flow-d",Y$2=(()=>{try{return CSS.registerProperty({name:$$2,syntax:"<number>",inherits:!1,initialValue:"0"}),CSS.registerProperty({name:S$1,syntax:"<length>",inherits:!0,initialValue:"0px"}),CSS.registerProperty({name:U$1,syntax:"<number>",inherits:!1,initialValue:"0"}),CSS.registerProperty({name:j$2,syntax:"<number>",inherits:!0,initialValue:"0"}),!0}catch{return!1}})(),P$2="var(--number-flow-char-height, 1em)",f$1="var(--number-flow-mask-height, 0.25em)",k$1=`calc(${f$1} / 2)`,E$2="var(--number-flow-mask-width, 0.5em)",u=`calc(${E$2} / var(--scale-x))`,w$2="#000 0, transparent 71%",M$2=V$2`:host{display:inline-block;direction:ltr;white-space:nowrap;isolation:isolate;line-height:${P$2} !important}.number,.number__inner{display:inline-block;transform-origin:left top}:host([data-will-change]) :is(.number,.number__inner,.section,.digit,.digit__num,.symbol){will-change:transform}.number{--scale-x:calc(1 + var(${U$1}) / var(--width));transform:translateX(var(${S$1})) scaleX(var(--scale-x));margin:0 calc(-1 * ${E$2});position:relative;-webkit-mask-image:linear-gradient(to right,transparent 0,#000 ${u},#000 calc(100% - ${u}),transparent ),linear-gradient(to bottom,transparent 0,#000 ${f$1},#000 calc(100% - ${f$1}),transparent 100% ),radial-gradient(at bottom right,${w$2}),radial-gradient(at bottom left,${w$2}),radial-gradient(at top left,${w$2}),radial-gradient(at top right,${w$2});-webkit-mask-size:100% calc(100% - ${f$1} * 2),calc(100% - ${u} * 2) 100%,${u} ${f$1},${u} ${f$1},${u} ${f$1},${u} ${f$1};-webkit-mask-position:center,center,top left,top right,bottom right,bottom left;-webkit-mask-repeat:no-repeat}.number__inner{padding:${k$1} ${E$2};transform:scaleX(calc(1 / var(--scale-x))) translateX(calc(-1 * var(${S$1})))}:host > :not(.number){z-index:5}.section,.symbol{display:inline-block;position:relative;isolation:isolate}.section::after{content:'\200b';display:inline-block}.section--justify-left{transform-origin:center left}.section--justify-right{transform-origin:center right}.section > [inert],.symbol > [inert]{margin:0 !important;position:absolute !important;z-index:-1}.digit{display:inline-block;position:relative;--c:var(--current) + var(${j$2})}.digit__num,.number .section::after{padding:${k$1} 0}.digit__num{display:inline-block;--offset-raw:mod(var(--length) + var(--n) - mod(var(--c),var(--length)),var(--length));--offset:calc( var(--offset-raw) - var(--length) * round(down,var(--offset-raw) / (var(--length) / 2),1) );--y:clamp(-100%,var(--offset) * 100%,100%);transform:translateY(var(--y))}.digit__num[inert]{position:absolute;top:0;left:50%;transform:translateX(-50%) translateY(var(--y))}.digit:not(.is-spinning) .digit__num[inert]{display:none}.symbol__value{display:inline-block;mix-blend-mode:plus-lighter;white-space:pre}.section--justify-left .symbol > [inert]{left:0}.section--justify-right .symbol > [inert]{right:0}.animate-presence{opacity:calc(1 + var(${$$2}))}`,G$2=HTMLElement,q$2=z$1&&O$3&&Y$2;let b$1,J$2=class extends G$2{constructor(){super(),this.created=!1,this.batched=!1;const{animated:Qe,...it}=this.constructor.defaultProps;this._animated=this.computedAnimated=Qe,Object.assign(this,it)}get animated(){return this._animated}set animated(Qe){var it;this.animated!==Qe&&(this._animated=Qe,(it=this.shadowRoot)==null||it.getAnimations().forEach(lt=>lt.finish()))}set data(Qe){var it;if(Qe==null)return;const{pre:lt,integer:ut,fraction:dt,post:xt,value:ft}=Qe;if(this.created){const vt=this._data;this._data=Qe,this.computedTrend=typeof this.trend=="function"?this.trend(vt.value,ft):this.trend,this.computedAnimated=q$2&&this._animated&&(!this.respectMotionPreference||!(A$3!=null&&A$3.matches))&&H$2(this),(it=this.plugins)==null||it.forEach(kt=>{var St;return(St=kt.onUpdate)==null?void 0:St.call(kt,Qe,vt,this)}),this.batched||this.willUpdate(),this._pre.update(lt),this._num.update({integer:ut,fraction:dt}),this._post.update(xt),this.batched||this.didUpdate()}else{this._data=Qe,this.attachShadow({mode:"open"});try{this._internals??(this._internals=this.attachInternals()),this._internals.role="img"}catch{}if(typeof CSSStyleSheet<"u"&&this.shadowRoot.adoptedStyleSheets)b$1||(b$1=new CSSStyleSheet,b$1.replaceSync(M$2)),this.shadowRoot.adoptedStyleSheets=[b$1];else{const vt=document.createElement("style");vt.textContent=M$2,this.shadowRoot.appendChild(vt)}this._pre=new N$2(this,lt,{justify:"right",part:"left"}),this.shadowRoot.appendChild(this._pre.el),this._num=new Q$1(this,ut,dt),this.shadowRoot.appendChild(this._num.el),this._post=new N$2(this,xt,{justify:"left",part:"right"}),this.shadowRoot.appendChild(this._post.el),this.created=!0}try{this._internals.ariaLabel=Qe.valueAsString}catch{}}willUpdate(){this._pre.willUpdate(),this._num.willUpdate(),this._post.willUpdate()}didUpdate(){if(!this.computedAnimated)return;this._abortAnimationsFinish?this._abortAnimationsFinish.abort():this.dispatchEvent(new Event("animationsstart")),this._pre.didUpdate(),this._num.didUpdate(),this._post.didUpdate();const Qe=new AbortController;Promise.all(this.shadowRoot.getAnimations().map(it=>it.finished)).then(()=>{Qe.signal.aborted||(this.dispatchEvent(new Event("animationsfinish")),this._abortAnimationsFinish=void 0)}),this._abortAnimationsFinish=Qe}};J$2.defaultProps={transformTiming:{duration:900,easing:O$3?"linear(0,.005,.019,.039,.066,.096,.129,.165,.202,.24,.278,.316,.354,.39,.426,.461,.494,.526,.557,.586,.614,.64,.665,.689,.711,.731,.751,.769,.786,.802,.817,.831,.844,.856,.867,.877,.887,.896,.904,.912,.919,.925,.931,.937,.942,.947,.951,.955,.959,.962,.965,.968,.971,.973,.976,.978,.98,.981,.983,.984,.986,.987,.988,.989,.99,.991,.992,.992,.993,.994,.994,.995,.995,.996,.996,.9963,.9967,.9969,.9972,.9975,.9977,.9979,.9981,.9982,.9984,.9985,.9987,.9988,.9989,1)":"cubic-bezier(0.33, 1, 0.68, 1)"},spinTiming:void 0,opacityTiming:{duration:450,easing:"ease-out"},animated:!0,trend:(He,Qe)=>Math.sign(Qe-He),respectMotionPreference:!0,plugins:void 0,digits:void 0};let Q$1=class{constructor(Qe,it,lt,{className:ut,...dt}={}){this.flow=Qe,this._integer=new L$1(Qe,it,{justify:"right",part:"integer"}),this._fraction=new L$1(Qe,lt,{justify:"left",part:"fraction"}),this._inner=m$1("span",{className:"number__inner"},[this._integer.el,this._fraction.el]),this.el=m$1("span",{...dt,part:"number",className:`number ${ut??""}`},[this._inner])}willUpdate(){this._prevWidth=this.el.offsetWidth,this._prevLeft=this.el.getBoundingClientRect().left,this._integer.willUpdate(),this._fraction.willUpdate()}update({integer:Qe,fraction:it}){this._integer.update(Qe),this._fraction.update(it)}didUpdate(){const Qe=this.el.getBoundingClientRect();this._integer.didUpdate(),this._fraction.didUpdate();const it=this._prevLeft-Qe.left,lt=this.el.offsetWidth,ut=this._prevWidth-lt;this.el.style.setProperty("--width",String(lt)),this.el.animate({[S$1]:[`${it}px`,"0px"],[U$1]:[ut,0]},{...this.flow.transformTiming,composite:"accumulate"})}},W$2=class{constructor(Qe,it,{justify:lt,className:ut,...dt},xt){this.flow=Qe,this.children=new Map,this.onCharRemove=vt=>()=>{this.children.delete(vt)},this.justify=lt;const ft=it.map(vt=>this.addChar(vt).el);this.el=m$1("span",{...dt,className:`section section--justify-${lt} ${ut??""}`},xt?xt(ft):ft)}addChar(Qe,{startDigitsAtZero:it=!1,...lt}={}){const ut=Qe.type==="integer"||Qe.type==="fraction"?new D$2(this,Qe.type,it?0:Qe.value,Qe.pos,{...lt,onRemove:this.onCharRemove(Qe.key)}):new tt(this,Qe.type,Qe.value,{...lt,onRemove:this.onCharRemove(Qe.key)});return this.children.set(Qe.key,ut),ut}unpop(Qe){Qe.el.removeAttribute("inert"),Qe.el.style.top="",Qe.el.style[this.justify]=""}pop(Qe){Qe.forEach(it=>{it.el.style.top=`${it.el.offsetTop}px`,it.el.style[this.justify]=`${F$1(it.el,this.justify)}px`}),Qe.forEach(it=>{it.el.setAttribute("inert",""),it.present=!1})}addNewAndUpdateExisting(Qe){const it=new Map,lt=new Map,ut=this.justify==="left",dt=ut?"prepend":"append";if(X$1(Qe,xt=>{let ft;this.children.has(xt.key)?(ft=this.children.get(xt.key),lt.set(xt,ft),this.unpop(ft),ft.present=!0):(ft=this.addChar(xt,{startDigitsAtZero:!0,animateIn:!0}),it.set(xt,ft)),this.el[dt](ft.el)},{reverse:ut}),this.flow.computedAnimated){const xt=this.el.getBoundingClientRect();it.forEach(ft=>{ft.willUpdate(xt)})}it.forEach((xt,ft)=>{xt.update(ft.value)}),lt.forEach((xt,ft)=>{xt.update(ft.value)})}willUpdate(){const Qe=this.el.getBoundingClientRect();this._prevOffset=Qe[this.justify],this.children.forEach(it=>it.willUpdate(Qe))}didUpdate(){const Qe=this.el.getBoundingClientRect();this.children.forEach(ut=>ut.didUpdate(Qe));const it=Qe[this.justify],lt=this._prevOffset-it;lt&&this.children.size&&this.el.animate({transform:[`translateX(${lt}px)`,"none"]},{...this.flow.transformTiming,composite:"accumulate"})}},L$1=class extends W$2{update(Qe){const it=new Map;this.children.forEach((lt,ut)=>{Qe.find(dt=>dt.key===ut)||it.set(ut,lt),this.unpop(lt)}),this.addNewAndUpdateExisting(Qe),it.forEach(lt=>{lt instanceof D$2&&lt.update(0)}),this.pop(it)}},N$2=class extends W$2{update(Qe){const it=new Map;this.children.forEach((lt,ut)=>{Qe.find(dt=>dt.key===ut)||it.set(ut,lt)}),this.pop(it),this.addNewAndUpdateExisting(Qe)}},R$1=class{constructor(Qe,it,{onRemove:lt,animateIn:ut=!1}={}){this.flow=Qe,this.el=it,this._present=!0,this._remove=()=>{var dt;this.el.remove(),(dt=this._onRemove)==null||dt.call(this)},this.el.classList.add("animate-presence"),this.flow.computedAnimated&&ut&&this.el.animate({[$$2]:[-.9999,0]},{...this.flow.opacityTiming,composite:"accumulate"}),this._onRemove=lt}get present(){return this._present}set present(Qe){if(this._present!==Qe){if(this._present=Qe,Qe?this.el.removeAttribute("inert"):this.el.setAttribute("inert",""),!this.flow.computedAnimated){Qe||this._remove();return}this.el.style.setProperty("--_number-flow-d-opacity",Qe?"0":"-.999"),this.el.animate({[$$2]:Qe?[-.9999,0]:[.999,0]},{...this.flow.opacityTiming,composite:"accumulate"}),Qe?this.flow.removeEventListener("animationsfinish",this._remove):this.flow.addEventListener("animationsfinish",this._remove,{once:!0})}}},B$1=class extends R$1{constructor(Qe,it,lt,ut){super(Qe.flow,lt,ut),this.section=Qe,this.value=it,this.el=lt}},D$2=class extends B$1{constructor(Qe,it,lt,ut,dt){var xt,ft;const vt=(((ft=(xt=Qe.flow.digits)==null?void 0:xt[ut])==null?void 0:ft.max)??9)+1,kt=Array.from({length:vt}).map((Tt,Mt)=>{const Nt=m$1("span",{className:"digit__num"},[document.createTextNode(String(Mt))]);return Mt!==lt&&Nt.setAttribute("inert",""),Nt.style.setProperty("--n",String(Mt)),Nt}),St=m$1("span",{part:`digit ${it}-digit`,className:"digit"},kt);St.style.setProperty("--current",String(lt)),St.style.setProperty("--length",String(vt)),super(Qe,lt,St,dt),this.pos=ut,this._onAnimationsFinish=()=>{this.el.classList.remove("is-spinning")},this._numbers=kt,this.length=vt}willUpdate(Qe){const it=this.el.getBoundingClientRect();this._prevValue=this.value;const lt=it[this.section.justify]-Qe[this.section.justify],ut=it.width/2;this._prevCenter=this.section.justify==="left"?lt+ut:lt-ut}update(Qe){this.el.style.setProperty("--current",String(Qe)),this._numbers.forEach((it,lt)=>lt===Qe?it.removeAttribute("inert"):it.setAttribute("inert","")),this.value=Qe}didUpdate(Qe){const it=this.el.getBoundingClientRect(),lt=it[this.section.justify]-Qe[this.section.justify],ut=it.width/2,dt=this.section.justify==="left"?lt+ut:lt-ut,xt=this._prevCenter-dt;xt&&this.el.animate({transform:[`translateX(${xt}px)`,"none"]},{...this.flow.transformTiming,composite:"accumulate"});const ft=this.getDelta();ft&&(this.el.classList.add("is-spinning"),this.el.animate({[j$2]:[-ft,0]},{...this.flow.spinTiming??this.flow.transformTiming,composite:"accumulate"}),this.flow.addEventListener("animationsfinish",this._onAnimationsFinish,{once:!0}))}getDelta(){var Qe;if(this.flow.plugins)for(const ut of this.flow.plugins){const dt=(Qe=ut.getDelta)==null?void 0:Qe.call(ut,this.value,this._prevValue,this);if(dt!=null)return dt}const it=this.value-this._prevValue,lt=this.flow.computedTrend||Math.sign(it);return lt<0&&this.value>this._prevValue?this.value-this.length-this._prevValue:lt>0&&this.value<this._prevValue?this.length-this._prevValue+this.value:it}};class tt extends B$1{constructor(Qe,it,lt,ut){const dt=m$1("span",{className:"symbol__value",textContent:lt});super(Qe,lt,m$1("span",{part:`symbol ${it}`,className:"symbol"},[dt]),ut),this.type=it,this._children=new Map,this._onChildRemove=xt=>()=>{this._children.delete(xt)},this._children.set(lt,new R$1(this.flow,dt,{onRemove:this._onChildRemove(lt)}))}willUpdate(Qe){if(this.type==="decimal")return;const it=this.el.getBoundingClientRect();this._prevOffset=it[this.section.justify]-Qe[this.section.justify]}update(Qe){if(this.value!==Qe){const it=this._children.get(this.value);it&&(it.present=!1);const lt=this._children.get(Qe);if(lt)lt.present=!0;else{const ut=m$1("span",{className:"symbol__value",textContent:Qe});this.el.appendChild(ut),this._children.set(Qe,new R$1(this.flow,ut,{animateIn:!0,onRemove:this._onChildRemove(Qe)}))}}this.value=Qe}didUpdate(Qe){if(this.type==="decimal")return;const it=this.el.getBoundingClientRect()[this.section.justify]-Qe[this.section.justify],lt=this._prevOffset-it;lt&&this.el.animate({transform:[`translateX(${lt}px)`,"none"]},{...this.flow.transformTiming,composite:"accumulate"})}}const REACT_MAJOR=parseInt(reactExports.version.match(/^(\d+)\./)?.[1]),isReact19=REACT_MAJOR>=19,OBSERVED_ATTRIBUTES=["data","digits"];class NumberFlowElement extends J$2{attributeChangedCallback(Qe,it,lt){this[Qe]=JSON.parse(lt)}}NumberFlowElement.observedAttributes=isReact19?[]:OBSERVED_ATTRIBUTES;st$1("number-flow-react",NumberFlowElement);const formatters={},serialize=isReact19?He=>He:JSON.stringify;function splitProps(He){const{transformTiming:Qe,spinTiming:it,opacityTiming:lt,animated:ut,respectMotionPreference:dt,trend:xt,plugins:ft,...vt}=He;return[{transformTiming:Qe,spinTiming:it,opacityTiming:lt,animated:ut,respectMotionPreference:dt,trend:xt,plugins:ft},vt]}class NumberFlowImpl extends reactExports.Component{updateProperties(Qe){if(!this.el)return;this.el.batched=!this.props.isolate;const[it]=splitProps(this.props);Object.entries(it).forEach(([lt,ut])=>{this.el[lt]=ut??NumberFlowElement.defaultProps[lt]}),Qe?.onAnimationsStart&&this.el.removeEventListener("animationsstart",Qe.onAnimationsStart),this.props.onAnimationsStart&&this.el.addEventListener("animationsstart",this.props.onAnimationsStart),Qe?.onAnimationsFinish&&this.el.removeEventListener("animationsfinish",Qe.onAnimationsFinish),this.props.onAnimationsFinish&&this.el.addEventListener("animationsfinish",this.props.onAnimationsFinish)}componentDidMount(){this.updateProperties(),isReact19&&this.el&&(this.el.digits=this.props.digits,this.el.data=this.props.data)}getSnapshotBeforeUpdate(Qe){if(this.updateProperties(Qe),Qe.data!==this.props.data){if(this.props.group)return this.props.group.willUpdate(),()=>this.props.group?.didUpdate();if(!this.props.isolate)return this.el?.willUpdate(),()=>this.el?.didUpdate()}return null}componentDidUpdate(Qe,it,lt){lt?.()}handleRef(Qe){this.props.innerRef&&(this.props.innerRef.current=Qe),this.el=Qe}render(){const[Qe,{innerRef:it,className:lt,data:ut,willChange:dt,isolate:xt,group:ft,digits:vt,onAnimationsStart:kt,onAnimationsFinish:St,...Tt}]=splitProps(this.props);return reactExports.createElement("number-flow-react",{ref:this.handleRef,"data-will-change":dt?"":void 0,class:lt,...Tt,dangerouslySetInnerHTML:{__html:""},suppressHydrationWarning:!0,digits:serialize(vt),data:serialize(ut)})}constructor(Qe){super(Qe),this.handleRef=this.handleRef.bind(this)}}const NumberFlow=reactExports.forwardRef(function({value:Qe,locales:it,format:lt,prefix:ut,suffix:dt,...xt},ft){reactExports.useImperativeHandle(ft,()=>vt.current,[]);const vt=reactExports.useRef(),kt=reactExports.useContext(NumberFlowGroupContext);kt?.useRegister(vt);const St=reactExports.useMemo(()=>it?JSON.stringify(it):"",[it]),Tt=reactExports.useMemo(()=>lt?JSON.stringify(lt):"",[lt]),Mt=reactExports.useMemo(()=>{const Nt=formatters[`${St}:${Tt}`]??=new Intl.NumberFormat(it,lt);return nt(Qe,Nt,ut,dt)},[Qe,St,Tt,ut,dt]);return reactExports.createElement(NumberFlowImpl,{...xt,group:kt,data:Mt,innerRef:vt})}),NumberFlowGroupContext=reactExports.createContext(void 0);function NumberFlowGroup({children:He}){const Qe=reactExports.useRef(new Set),it=reactExports.useRef(!1),lt=reactExports.useRef(new WeakMap),ut=reactExports.useMemo(()=>({useRegister(dt){reactExports.useEffect(()=>(Qe.current.add(dt),()=>{Qe.current.delete(dt)}),[])},willUpdate(){it.current||(it.current=!0,Qe.current.forEach(dt=>{const xt=dt.current;!xt||!xt.created||(xt.willUpdate(),lt.current.set(xt,!0))}))},didUpdate(){Qe.current.forEach(dt=>{const xt=dt.current;!xt||!lt.current.get(xt)||(xt.didUpdate(),lt.current.delete(xt))}),it.current=!1}}),[]);return reactExports.createElement(NumberFlowGroupContext.Provider,{value:ut},He)}function CreditMeter({as:He="span",value:Qe,originalValue:it,updating:lt=!1,children:ut,iconClassName:dt,valueClassName:xt,...ft}){const vt=He;return jsxRuntimeExports.jsx(vt,{...ft,children:jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-[0.25em]",children:[jsxRuntimeExports.jsx(gameIconsCrystalBars,{className:twMerge("size-4",dt)}),ut??jsxRuntimeExports.jsxs("span",{className:twJoin("transition",lt&&"opacity-50",xt),children:[Qe!=null?jsxRuntimeExports.jsx(NumberFlow,{value:Qe}):"—",it&&jsxRuntimeExports.jsx("span",{className:"ml-[0.25em] line-through opacity-80",children:it.toLocaleString()})]})]})})}const linkStyles=ce$1({extend:buttonStyles$3,slots:{root:"rounded-none",label:"",startIcon:"",endIcon:""},variants:{variant:{outlined:{},filled:{},ghost:{}}},compoundVariants:[{variant:["outlined","filled"],className:{root:"no-underline"}},{variant:["ghost"],className:{root:"inline underline-offset-4"}}],compoundSlots:[{slots:["startIcon","endIcon"],variant:["outlined","filled"],className:"h-full aspect-square"}],defaultVariants:{variant:"ghost"}}),transformLinkProps=produce(He=>{He.isDisabled=He.disabled,delete He.disabled}),RE_LOCAL_HREF=/^[/.]/;function UILink(He){const Qe=reactExports.useRef(null),it=transformLinkProps(He),{linkProps:lt}=$298d61e98472621b$export$dcf14c9974fe2767(it,Qe),ut=useNavigate(),dt=RE_LOCAL_HREF.test(He.href??"")&&(!He.target||He.target==="_self"),xt=linkStyles({variant:He.variant,color:He.color,size:He.size,hasLabel:!!He.children,hasStartIcon:!!He.icon,hasEndIcon:!!He.endIcon});return jsxRuntimeExports.jsxs("a",{...lt,ref:Qe,href:He.href,target:He.target,className:xt.root({className:He.className}),style:He.style,onClick:ft=>{He.onClick?.(),dt&&(ft.preventDefault(),ut(He.href,{relative:He.relative,replace:He.replace}))},children:[jsxRuntimeExports.jsx("span",{className:xt.startIcon({className:He.startIconClassName}),children:He.icon}),jsxRuntimeExports.jsx("span",{className:xt.label({className:He.labelClassName}),children:He.children}),jsxRuntimeExports.jsx("span",{className:xt.endIcon({className:He.endIconClassName}),children:He.endIcon})]})}const usePaymentMethodAutoRenewable=()=>{const{data:He}=useDynamicConstants(),Qe=He?.payment?.autoRenewableProviders||[];return it=>Qe.includes(it.toString())},getMembershipExpireTime=He=>{if(He!=null)return defaultDayjs(He).utc().add(1,"day").startOf("day")},shouldShowMembershipCountdown=(He,Qe)=>{const it=defaultDayjs();return He.isValid()&&He.isAfter(it)&&He.diff(it,"day")<Qe};var PaymentProvider$1=(He=>(He.Google="google",He.Apple="apple",He.Onerway="onerway",He.Paypay="paypay",He.Other="other",He))(PaymentProvider$1||{});const PaymentProviders=Object.values(PaymentProvider$1),useMembershipExpireDialogState=(He,Qe)=>{switch(Qe?.state){case"active":{const it=He.nearExpire.filter(vt=>vt>=0),lt=getMembershipExpireTime(Qe?.current.endAt);if(!lt)return{type:"none"};const ut=defaultDayjs().utc(),dt=lt.diff(ut,"day"),xt=it.find(vt=>vt===dt);return Qe.current.autoRenewable!=="enabled"&&xt!==void 0&&lt.isValid()&&lt.isAfter(ut)?{type:"near-expire",paymentProvider:Qe.current.paymentProvider,days:xt}:{type:"none"}}case"expired":{const it=He.expired.filter(vt=>vt>=0).map(vt=>-vt),lt=getMembershipExpireTime(Qe?.previous.endAt);if(!lt)return{type:"none"};const ut=defaultDayjs().utc(),dt=lt.diff(ut,"day"),xt=it.find(vt=>vt===dt);return xt!==void 0&&lt.isValid()&&lt.isBefore(ut)?{type:"expired",days:-xt}:{type:"none"}}default:return{type:"none"}}};function getMembershipTierConfig(He){return $$3(He).returnType().with(1,()=>({label:"membership:membership.tier.1.label",color:"#0000",darkColor:"#0000"})).with(2,()=>({label:"membership:membership.tier.2.label",color:"#e9d5ff",darkColor:"#581c87a0"})).with(3,()=>({label:"membership:membership.tier.3.label",color:"#e2e8f0",darkColor:"#374151"})).otherwise(()=>({label:"Unknown",color:"#FFF",darkColor:"#000"}))}const getSubscriptionAutoRenewState=He=>{const Qe=He.cancelAtPeriodEnd,it=He.provider;return it?.startsWith("apple")||it?.startsWith("google")?"mobile-app-store":Qe===!1?"enabled":"unspecified"},getSubscriptionPaymentProvider=He=>{const Qe=He.provider;if(!Qe)return PaymentProvider$1.Other;const it=PaymentProviders.find(lt=>Qe.startsWith(lt.toString()));return it||PaymentProvider$1.Other};function getSubscriptionState(He){if(He.status==="inactive")return{state:"expired",previous:{tier:He.tier??0,endAt:defaultDayjs(He.endAt)}};if(!He.tier||He.status!=="active")return{state:"none"};const Qe=He.tier,it=He.futureSubscription?.[0];if(!it)return{state:"active",current:{tier:Qe,endAt:defaultDayjs(He.endAt),paymentProvider:He.provider,autoRenewable:getSubscriptionAutoRenewState(He)},next:void 0};const lt=it.tier;return Qe===lt?{state:"active",current:{tier:Qe,endAt:defaultDayjs(He.endAt).add(1,it.interval===Interval.Year?"year":"month"),paymentProvider:getSubscriptionPaymentProvider(He),autoRenewable:getSubscriptionAutoRenewState(He)},next:void 0}:lt!==void 0?{state:"active",current:{tier:Qe,endAt:defaultDayjs(He.endAt),paymentProvider:getSubscriptionPaymentProvider(He),autoRenewable:getSubscriptionAutoRenewState(He)},next:{tier:lt,period:it.interval??Interval.Month}}:{state:"none"}}const mergeContext=(He,Qe)=>({...He,...Qe,fetchOptions:{...He?.fetchOptions,...Qe?.fetchOptions},headers:{...He?.headers,...Qe?.headers}}),createQueryHook=(He,Qe)=>(lt,ut)=>useQuery(He,lt===skipToken?{skip:!0,pollInterval:0}:{...Qe,...ut,context:mergeContext(Qe?.context,ut?.context),variables:lt}),modifyQueryHook=(He,{transform:Qe,reduce:it})=>(lt,ut)=>{const{data:dt,previousData:xt,...ft}=He(lt===skipToken?skipToken:Qe!==void 0?Qe(lt):lt,ut);return{data:dt===void 0?dt:it!==void 0?it(dt):dt,previousData:xt===void 0?xt:it!==void 0?it(xt):xt,...ft}},extractPagedData=(He,Qe,it)=>{if(Qe===skipToken||He==null)return;const{edges:lt,pageInfo:ut,...dt}=He,{before:xt,after:ft,first:vt,last:kt}=Qe;let St=0,Tt=lt.length;if(ft){const At=lt.findIndex($t=>$t?.cursor===ft);if(At>0)St=Math.max(St,At+1);else if(it)return}if(xt){const At=lt.findLastIndex($t=>$t?.cursor===xt);if(At>0)Tt=Math.min(Tt,At);else if(it)return}vt&&vt>=0&&(Tt=Math.min(Tt,St+vt)),kt&&kt>=0&&(St=Math.max(St,Tt-kt));const Mt=lt.slice(St,Tt),Nt={hasNextPage:Tt<lt.length||ut.hasNextPage,hasPreviousPage:St>0||ut.hasPreviousPage,startCursor:Mt.at(0)?.cursor,endCursor:Mt.at(-1)?.cursor};return{...dt,edges:Mt,pageInfo:Nt}},pagedQueryHook=He=>(Qe,it)=>{const{data:lt,previousData:ut,...dt}=He(Qe,it),xt=reactExports.useMemo(()=>extractPagedData(lt,Qe,dt.loading),[lt,Qe,dt.loading]),ft=reactExports.useMemo(()=>extractPagedData(ut,Qe,dt.loading),[ut,Qe,dt.loading]);return{data:xt,previousData:ft,...dt}},infiniteQueryHook=He=>(Qe,it)=>{const lt=He(Qe,{...it,context:mergeContext({refetchOnFocus:!1,refetchOnReconnect:!1},it?.context)}),ut=lt.networkStatus===NetworkStatus.fetchMore;return{...lt,loadingMore:ut}},createFetchQueryHelper=(He,Qe)=>(it,lt)=>baseApolloClient.query({...Qe,...lt,context:mergeContext(Qe?.context,lt?.context),query:He,variables:it}),createRefetchQueryHelper=He=>()=>{baseApolloClient.refetchQueries({include:[He]})},createMutationHelper=(He,Qe)=>[ut=>useMutation(He,{...Qe,...ut,context:mergeContext(Qe?.context,ut?.context)}),(ut,dt)=>baseApolloClient.mutate({...Qe,...dt,variables:ut,mutation:He})],createLocalCursor=()=>uniqueId("!local-cursor"),useGetMyMembership=modifyQueryHook(createQueryHook(GetMyMembershipDocument),{reduce:He=>He?.me}),useMyMembership=He=>{const Qe=useCheckTokenForArgs({});return useGetMyMembership(Qe??skipToken,He)},fetchGetMyMembership=createFetchQueryHelper(GetMyMembershipDocument),refetchGetMyMembership=createRefetchQueryHelper(GetMyMembershipDocument),updateGetMyMembership=He=>{baseApolloClient.refetchQueries({updateCache:Qe=>{Qe.updateQuery({query:GetMyMembershipDocument},()=>He)}})},useGetUserMembership=modifyQueryHook(createQueryHook(GetUserMembershipDocument),{transform:He=>({userId:He}),reduce:He=>He?.user}),[useCancelSubscription,executeCancelSubscription]=createMutationHelper(CancelSubscriptionDocument),[useResumeSubscription,executeResumeSubscription]=createMutationHelper(ResumeSubscriptionDocument),useGetMyQuota=modifyQueryHook(createQueryHook(GetMyQuotaDocument),{reduce:He=>He?.me?.quotaAmount??0}),useMyQuota=He=>{const Qe=useCheckTokenForArgs({});return useGetMyQuota(Qe??skipToken,He)},refetchGetMyQuota=createRefetchQueryHelper(GetMyQuotaDocument),useGetMeWithQuotaForCurrency=modifyQueryHook(createQueryHook(GetMeWithQuotaForCurrencyDocument),{reduce:He=>He?.me}),[useClaimShareCredit,executeClaimShareCredit]=createMutationHelper(ClaimShareCreditDocument),[useVerifyCreditCoupon,executeVerifyCreditCoupon]=createMutationHelper(VerifyCreditCouponDocument),useListUserQuotaLogs=modifyQueryHook(createQueryHook(ListUserQuotaLogsDocument),{reduce:He=>He?.user?.quotaLogs}),useListMyQuotaLogs=modifyQueryHook(createQueryHook(ListMyQuotaLogsDocument),{reduce:He=>He?.me?.quotaLogs}),useListQuests=modifyQueryHook(createQueryHook(ListQuestsDocument),{reduce:He=>He==null?He:{nodes:getNodesFromConnection(He.quests).filter(Qe=>!(Qe.startAt&&defaultDayjs(Qe.startAt).isAfter(defaultDayjs())||Qe.endAt&&defaultDayjs(Qe.endAt).isBefore(defaultDayjs()))),pageInfo:He.quests?.pageInfo}}),[useClaimQuestReward,executeClaimQuestReward]=createMutationHelper(ClaimQuestRewardDocument),useQuests=(He,Qe)=>{const it=useCheckTokenForArgs(He);return useListQuests(it??skipToken,Qe)},useGetDailyClaimAvailable=modifyQueryHook(createQueryHook(GetDailyClaimAvailableDocument),{reduce:He=>He?.me}),useDailyClaimAvailable=He=>{const{data:Qe}=useUserInfo();return useGetDailyClaimAvailable(Qe?{}:skipToken,He)},[useDailyClaimQuota,executeDailyClaimQuota]=createMutationHelper(DailyClaimQuotaDocument);function useDailyClaim(){const{data:He,refetch:Qe}=useDailyClaimAvailable(),it=!!He?.dailyClaimAvailable,lt=He?.dailyClaimAmount??0,ut=defaultDayjs.utc().add(1,"day").startOf("day").valueOf(),{refetch:dt}=useMyQuota(),{t:xt}=useTranslation(["user"]),ft=reactExports.useMemo(()=>debounce(async()=>{track("claim_credit_click",{quest:"daily"});try{return await executeDailyClaimQuota({}),await Promise.allSettled([Qe(),dt()]),toast.success(xt("user:claim-credit-tasks.successfully-claimed")),!0}catch(vt){return toast.error(vt?.message),!1}},100,{leading:!0,trailing:!1}),[Qe,xt]);return{available:it,amount:lt,claim:ft,refreshAt:ut}}const log$4=getAppEnv().isProd?browserExports.debug("pixai:jsBridge"):console.log,INVOKE_CALLBACK_METHOD="__bridge__callback",ANDROID_BRIDGE_NAME="pixaiAppBridge",defaultStore$2=getDefaultStore(),jsBridgeCallbackStoreAtom=atomWithImmer({});function createJsBridgeCallback(He){const Qe=genId();return defaultStore$2.set(jsBridgeCallbackStoreAtom,it=>{it[Qe]=async lt=>{await He(lt),defaultStore$2.set(jsBridgeCallbackStoreAtom,ut=>{delete ut[Qe]})}}),Qe}function callJsBridgeNativeHandler(He,Qe,it){log$4({method:He,args:Qe,callbackId:it});const lt=JSON.stringify(Qe);isAndroidWebview()?window[ANDROID_BRIDGE_NAME]?.postMessage?.(He,lt,it):isIOSWebview()&&window.webkit?.messageHandlers?.nativeBridge?.postMessage?.({method:He,data:lt,callbackId:it})}function callFromJsBridgeHandler(He,Qe,it){if(log$4({method:He,args:Qe,callbackId:it}),He===INVOKE_CALLBACK_METHOD&&it){const lt=defaultStore$2.get(jsBridgeCallbackStoreAtom)[it];return log$4({callback:lt}),lt?.(Qe)}}function copyToJsBridge(He){return callJsBridgeNativeHandler("copyToClipboard",{content:He})}async function getAppVersionFromBridge(){return await Promise.race([new Promise(He=>{const Qe=createJsBridgeCallback(it=>{He(it.version)});callJsBridgeNativeHandler("getAppVersion",void 0,Qe)}),sleep(1e3)])}async function getAppMetadata(){let He=!1;return await Promise.race([new Promise(Qe=>{const it=createJsBridgeCallback(lt=>{He=!0,Qe(lt)});callJsBridgeNativeHandler("getAppMetadata",void 0,it)}),sleep(1e3).then(()=>{if(!He)return getAppVersionFromBridge()}).then(Qe=>Qe?{version:Qe}:void 0)])}async function isAppVersionGreaterThanOrEqualTo(He){if(!He)return!1;const{version:Qe}=await getAppMetadata()??{};if(!Qe)return!1;const it=xt=>{const ft=xt.split(/[.-]/),vt=[];for(const kt of ft)/^\d+$/.test(kt)&&vt.push(Number(kt));return vt},lt=it(Qe),ut=it(He),dt=Math.max(lt.length,ut.length);for(let xt=0;xt<dt;xt++){const ft=lt[xt]||0,vt=ut[xt]||0;if(ft<vt)return!1;if(ft>vt)return!0}return!0}function navigateToNativePage(He){callJsBridgeNativeHandler("navigate",He)}function popBack(){callJsBridgeNativeHandler("popBack")}const IOS_MOBILE_PRODUCT_IDS={"extra-package":"consumable.extra.package","extra-package-2":"consumable.extra.package.2","extra-package-3":"consumable.extra.package.3"},ANDROID_MOBILE_PRODUCT_IDS={"extra-package":"iap_credits_pack","extra-package-2":"iap_credits_pack_2","extra-package-3":"iap_credits_pack_3"},MOBILE_PRODUCT_IDS=isIOSWebview()?IOS_MOBILE_PRODUCT_IDS:ANDROID_MOBILE_PRODUCT_IDS;async function getProductListFromBridge(){return await Promise.race([new Promise(He=>{const Qe=createJsBridgeCallback(it=>{for(const lt of it.products){const ut=Object.entries(MOBILE_PRODUCT_IDS).find(dt=>dt[1]===lt.id)?.[0];ut&&(lt.webId=ut)}He(it.products)});callJsBridgeNativeHandler("getProducts",void 0,Qe)}),sleep(1e3)])}function invokeProductPurchase(He){const Qe=MOBILE_PRODUCT_IDS[He]||He;return new Promise(it=>{const lt=createJsBridgeCallback(ut=>{it(ut.success)});callJsBridgeNativeHandler("purchase",{productId:Qe},lt)})}function downloadMediaToBridge(He){callJsBridgeNativeHandler("downloadMedia",He)}async function takePhoto(){return new Promise(He=>{const Qe=createJsBridgeCallback(it=>{He(it)});callJsBridgeNativeHandler("takePhoto",void 0,Qe)})}async function pickMedia(He){return new Promise(Qe=>{const it=createJsBridgeCallback(lt=>{Qe(lt)});callJsBridgeNativeHandler("mediaPicker",He,it)})}const useJSBridgeFn=(He,Qe)=>isAppWebview()?Qe:He,NativeNavigation={main:He=>`pixai://main?tab=${He}`,generator:He=>{const Qe=`pixai://generator/image/${He.type}`;return"args"in He&&Object.keys(He.args).length>0?`${Qe}?${new URLSearchParams(He.args).toString()}`:Qe},membership:He=>`pixai://membership?target=${He}`,settings:()=>"pixai://settings",profile:(He,Qe)=>He?`pixai://user/${He}`:Qe?`pixai://user/@${Qe}`:"pixai://user",contest:He=>`pixai://contest/${He}`,taskDetail:He=>`pixai://task/${He}`,artworkDetail:He=>`pixai://artwork/${He}`,modelLoraDetail:He=>`pixai://model/${He}`,trainLora:()=>"pixai://train-lora"},icBaselineClose=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z"})}),apkDownloadQRUrl="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/apk-download-C5OB1iI3.jpg",iosDownloadQRUrl="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/ios-download-BUfyH48b.jpg",playStoreDownloadQRUrl="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/playstore-download-Bnt4R1mQ.jpg",apkBadgeDarkUrl="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/apk-badge-dark-C1T39N8Z.svg",appStoreBadgeDarkUrl="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/app-store-badge-dark-CVyK0T4N.svg",playStoreBadgeDarkUrl="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/google-play-badge-dark-DMlHQDm5.svg",[useArtworkWithWorldCharacter,mutateArtworkWithWorldCharacter]=createSWRForGQL("getArtworkWithWorldCharacter",{transform:He=>He?{id:He}:void 0,reduce:He=>He.artwork}),[useUserArtworkLikedCount]=createSWRForGQL("getUserArtworkLikedCount",{transform:He=>He?{userId:He}:void 0,reduce:He=>He.user?.artworkLikedCount}),[useReviewSummary]=createSWRForGQL("getReviewSummary",{transform:He=>He?{itemId:He}:void 0,reduce:He=>He.reviewSummary}),[useMyRoles]=createSWRForGQL("getMyRoles",{reduce:He=>getNodesFromConnection(He?.me?.roles)}),[useMyFreeGenerationEvents]=createSWRForGQL("getMyFreeGenerationEvents",{transform:()=>checkTokenForArgs({}),reduce:He=>He.freeGenerationEvents??[]}),[useMySessions]=createSWRForGQL("listMySessions",{reduce:He=>He.me?.sessions}),[useMyAccessTokens,mutateMyAccessTokens]=createSWRForGQL("listMyAccessTokens",{reduce:He=>He.me?.accessTokens}),[useMyWebhooks,mutateMyWebhooks]=createSWRForGQL("listMyWebhooks",{reduce:He=>He.me?.webhooks}),[useGenerationModel,mutateGenerationModel]=createSWRForGQL("getGenerationModel",{transform:He=>He?{id:He}:void 0,reduce:He=>He.generationModel}),[useGenerationModelByVersionId]=createSWRForGQL("getGenerationModelByVersionId",{transform:He=>He?{id:He}:void 0,reduce:He=>He.generationModelVersion||void 0}),[useGenerationModelByVersionIdForArtwork]=createSWRForGQL("getGenerationModelByVersionIdForArtwork",{transform:He=>He?{id:He}:void 0,reduce:He=>He.generationModelVersion||void 0}),[useGenerationModelDetailByVersionId]=createSWRForGQL("getGenerationModelDetailByVersionId",{transform:He=>He?{id:He}:void 0,reduce:He=>He.generationModelVersion||void 0}),[useGenerationModels]=createSWRForGQL("listGenerationModels",{reduce:He=>He.generationModels}),[useGenerationModelsWithTrainingTask]=createSWRForGQL("listGenerationModelsWithTrainingTask",{reduce:He=>He.generationModels}),[useGenerationModelVersions]=createSWRForGQL("listGenerationModelVersions",{reduce:He=>He.generationModelVersions}),[useUserLikedGenerationModels]=createSWRForGQL("listUserLikedGenerationModel",{reduce:He=>He.user?.likedGenerationModelList}),[useMyBookmarkItems]=createSWRForGQL("listMyBookmarkItems",{reduce:He=>He.me?.defaultBookmark?.items}),[useBookmarks]=createSWRForGQL("listMyBookmarks",{reduce:He=>He.user?.bookmarks}),[useBookmarkItems]=createSWRForGQL("listBookmarkItems",{reduce:He=>He.bookmark?.items}),[useBookmark]=createSWRForGQL("getBookmark",{transform:He=>He?{id:He}:void 0,reduce:He=>He.bookmark}),[useBookmarkCharacterItems]=createSWRForGQL("listBookmarkCharacterItems",{reduce:He=>He.bookmark?.items}),[_useMyBookmarkedGenerationModels]=createSWRForGQL("listMyBookmarkedGenerationModels",{reduce:He=>He.me?.bookmarkedGenerationModels}),useMyBookmarkedGenerationModels=(He,...Qe)=>_useMyBookmarkedGenerationModels(useCheckTokenForArgs(He),...Qe),[useGenerationModelTotalCount]=createSWRForGQL("getPrivateGenerationModelTotalCount",{reduce:He=>He.generationModels.totalCount}),[useMyShareCreditInfo]=createSWRForGQL("getMyShareCreditInfo",{transform:He=>He?void 0:{},reduce:He=>He.me?.shareCreditInfo}),[useWorld]=createSWRForGQL("getWorld",{transform:He=>He?{id:He}:void 0,reduce:He=>He.world}),[useCharacter]=createSWRForGQL("getCharacter",{transform:He=>He?{id:He}:void 0,reduce:He=>He.character}),[useUsers]=createSWRForGQL("listUsers",{reduce:He=>He.users}),[useChatWorkspace]=createSWRForGQL("getChatWorkspace",{reduce:He=>He.chatWorkspace}),[useChatWorkspaces]=createSWRForGQL("listChatWorkspaces",{reduce:He=>He.chatWorkspaces}),[useChatTaskReactionByWorkspace]=createSWRForGQL("getChatTaskReactionByWorkspace",{reduce:He=>He.chatTaskReactionByWorkspace}),logosApple=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 256 315",width:"0.99em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{d:"M213.803 167.03c.442 47.58 41.74 63.413 42.197 63.615c-.35 1.116-6.599 22.563-21.757 44.716c-13.104 19.153-26.705 38.235-48.13 38.63c-21.05.388-27.82-12.483-51.888-12.483c-24.061 0-31.582 12.088-51.51 12.871c-20.68.783-36.428-20.71-49.64-39.793c-27-39.033-47.633-110.3-19.928-158.406c13.763-23.89 38.36-39.017 65.056-39.405c20.307-.387 39.475 13.662 51.889 13.662c12.406 0 35.699-16.895 60.186-14.414c10.25.427 39.026 4.14 57.503 31.186c-1.49.923-34.335 20.044-33.978 59.822M174.24 50.199c10.98-13.29 18.369-31.79 16.353-50.199c-15.826.636-34.962 10.546-46.314 23.828c-10.173 11.763-19.082 30.589-16.678 48.633c17.64 1.365 35.66-8.964 46.64-22.262"})}),logosGooglePlayIcon=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 256 283",width:"1.1em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"#EA4335",d:"M119.553 134.916L1.06 259.061a32.14 32.14 0 0 0 47.062 19.071l133.327-75.934z"}),jsxRuntimeExports.jsx("path",{fill:"#FBBC04",d:"M239.37 113.814L181.715 80.79l-64.898 56.95l65.162 64.28l57.216-32.67a31.345 31.345 0 0 0 0-55.537z"}),jsxRuntimeExports.jsx("path",{fill:"#4285F4",d:"M1.06 23.487A30.565 30.565 0 0 0 0 31.61v219.327a32.333 32.333 0 0 0 1.06 8.124l122.555-120.966z"}),jsxRuntimeExports.jsx("path",{fill:"#34A853",d:"m120.436 141.274l61.278-60.483L48.564 4.503A32.847 32.847 0 0 0 32.051 0C17.644-.028 4.978 9.534 1.06 23.399z"})]}),materialSymbolsApkDocumentRounded=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7 19h10q-.1-1.225-.75-2.25t-1.7-1.625l.95-1.7q.05-.1.025-.225t-.15-.175q-.1-.05-.213-.025t-.162.125l-.975 1.75q-.5-.2-1-.313T12 14.45q-.525 0-1.025.113t-1 .312L9 13.125Q8.95 13 8.838 13t-.238.05l-.1.375l.95 1.7q-1.05.6-1.7 1.625T7 19Zm2.75-1.5q-.2 0-.35-.15T9.25 17q0-.2.15-.35t.35-.15q.2 0 .35.15t.15.35q0 .2-.15.35t-.35.15Zm4.5 0q-.2 0-.35-.15t-.15-.35q0-.2.15-.35t.35-.15q.2 0 .35.15t.15.35q0 .2-.15.35t-.35.15ZM6 22q-.825 0-1.413-.588T4 20V4q0-.825.588-1.413T6 2h7.175q.4 0 .763.15t.637.425l4.85 4.85q.275.275.425.638t.15.762V20q0 .825-.588 1.413T18 22H6Zm7-14q0 .425.288.713T14 9h4l-5-5v4Z"})}),AutoOpenModal=reactExports.forwardRef(function({children:Qe,responsive:it=!1,onClose:lt=()=>{},afterClose:ut=()=>{},disableBackdropClick:dt=!1,...xt},ft){const[vt,kt]=reactExports.useState(!0),St=reactExports.useCallback(async()=>{kt(!1),await sleep(225),await ut()},[ut]);reactExports.useImperativeHandle(ft,()=>({close:St}),[St]);const Tt=it?ResponsiveDialog:Dialog;return jsxRuntimeExports.jsx(Tt,{open:vt,onClose:(Mt,Nt)=>{dt&&Nt==="backdropClick"||(lt(),St())},...xt,children:Qe})}),dialog=({children:He,afterClose:Qe,...it})=>{const lt=reactExports.createRef(),ut=dynamicCreateElement(jsxRuntimeExports.jsx(AutoOpenModal,{afterClose:async()=>{await Qe?.(),ut()},...it,ref:lt,children:He}));return lt};function openAppDownloadDialog(He){return track("app_download_modal_view",{...He?.trackingArgs}),new Promise((Qe,it)=>{const lt=dialog({children:jsxRuntimeExports.jsx(AppDownloadEntriesContent,{onClose:()=>lt.current?.close(),...He}),onClose:()=>Qe,fullWidth:!1,responsive:!1,maxWidth:"lg",dialogProps:{maxWidth:"md"}})})}function AppDownloadEntriesContent(He){const{onClose:Qe,hideIos:it,hideAndroid:lt,hideAndroidFilterFree:ut=!0}=He,{t:dt}=useTranslation(["common","growth"]),xt=useIsMobile(),ft=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"w-full flex flex-col items-start gap-2 pb-2",children:[jsxRuntimeExports.jsx(IconButton,{className:"absolute top-4 right-4 text-gray-500",onClick:Qe,sx:{position:"absolute",right:8,top:8},children:jsxRuntimeExports.jsx(icBaselineClose,{})}),jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold mb-4 pr-12",children:dt("common:app-download-dialog.title")})]})});return xt?jsxRuntimeExports.jsxs("div",{className:"w-full p-6 fixed bottom-0 left-0 right-0 rounded-t-3xl bg-background",children:[ft,jsxRuntimeExports.jsx(AppDownloadButtons,{...He,isMobile:!0})]}):jsxRuntimeExports.jsxs("div",{className:"w-full h-full p-6 flex flex-col gap-2",children:[ft,jsxRuntimeExports.jsx(AppDownloadButtons,{...He})]})}function AppDownloadButtons(He){const{hideAndroid:Qe,hideAndroidFilterFree:it=!0,hideIos:lt,isMobile:ut,trackingProps:dt}=He;return ut?jsxRuntimeExports.jsxs("div",{className:cx("flex flex-col",He.className),children:[!Qe&&jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"font-bold text-base mt-4 text-primary mb-[2px]",children:"Android"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row flex-wrap items-center gap-4 w-full",children:[jsxRuntimeExports.jsx("a",{className:"translate-y-px  h-[60px] w-[180px] flex flex-col items-center justify-center hover:no-underline relative",href:config$1.playStoreLink,download:!0,rel:"noopener noreferrer",target:"_blank",onClick:()=>{track("app_download_click",{value:"android",...dt})},children:jsxRuntimeExports.jsx("img",{src:playStoreBadgeDarkUrl,className:"h-full w-full",alt:"google-play-badge"})}),!it&&jsxRuntimeExports.jsxs("a",{className:"translate-y-px h-[60px] w-[180px] flex flex-col items-center justify-center hover:no-underline relative",href:config$1.apkReleaseLink,download:!0,rel:"noopener noreferrer",target:"_blank",onClick:()=>{track("app_download_click",{value:"android-filter-free",...dt})},children:[jsxRuntimeExports.jsx(materialSymbolsApkDocumentRounded,{className:"self-center ml-1 size-[78px]"}),jsxRuntimeExports.jsx("img",{src:apkBadgeDarkUrl,className:"h-full w-full"})]})]})]}),!lt&&!Qe&&jsxRuntimeExports.jsx("div",{className:"h-px mr-4 mb-2"}),!lt&&jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"font-bold text-base mt-4 text-primary mb-[2px]",children:"iOS"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap items-center gap-4",children:jsxRuntimeExports.jsx("a",{className:"translate-y-px h-[60px] w-[180px] rounded-[7px] flex flex-col items-center justify-center hover:no-underline relative",href:config$1.iosAppStoreLink,rel:"noopener noreferrer",target:"_blank",onClick:()=>{track("app_download_click",{value:"ios",...dt})},children:jsxRuntimeExports.jsx("img",{src:appStoreBadgeDarkUrl,className:"h-full w-full"})})})]})]}):jsxRuntimeExports.jsxs("div",{className:cx("flex flex-row",He.className),children:[!Qe&&jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"font-bold text-lg text-primary mb-[2px]",children:"Android"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row flex-wrap items-center gap-4",children:[jsxRuntimeExports.jsxs("a",{className:"translate-y-px size-[194px] border border-gray-200 dark:border-gray-300 bg-white dark:bg-black rounded-[7px] flex flex-col items-center justify-center hover:no-underline relative",href:config$1.playStoreLink,download:!0,rel:"noopener noreferrer",target:"_blank",onClick:()=>{track("app_download_click",{value:"android",...dt})},children:[jsxRuntimeExports.jsx(logosGooglePlayIcon,{className:"w-12 h-[78px]"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center self-center ml-1",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-sm leading-5 -translate-y-px",children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:mobile-app.download-badges.android.wordmark"})}),jsxRuntimeExports.jsx("p",{className:"font-semibold text-lg leading-8 -translate-x-px",children:"Google Play"})]}),jsxRuntimeExports.jsx("img",{src:playStoreDownloadQRUrl,className:"h-full w-full absolute top-0 left-0 opacity-0 hover:opacity-100 transition-opacity	duration-300 rounded-[7px]"})]}),!it&&jsxRuntimeExports.jsxs("a",{className:"translate-y-px size-[194px] border border-gray-200 dark:border-gray-300 bg-white dark:bg-black rounded-[7px] flex flex-col items-center justify-center hover:no-underline relative",href:config$1.apkReleaseLink,download:!0,rel:"noopener noreferrer",target:"_blank",onClick:()=>{track("app_download_click",{value:"android-filter-free",...dt})},children:[jsxRuntimeExports.jsx(materialSymbolsApkDocumentRounded,{className:"self-center ml-1 size-[78px]"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center self-center ml-1",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-sm leading-5 -translate-y-px",children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:download"})}),jsxRuntimeExports.jsx("p",{className:"font-semibold text-lg leading-8 -translate-x-px",children:"APK File"})]}),jsxRuntimeExports.jsx("img",{src:apkDownloadQRUrl,className:"h-full w-full absolute top-0 left-0 opacity-0 hover:opacity-100 transition-opacity	duration-300 rounded-[7px]"})]})]})]}),!lt&&!Qe&&jsxRuntimeExports.jsx("div",{className:"h-px mr-4 mb-2"}),!lt&&jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"font-bold text-lg text-primary mb-[2px]",children:"iOS"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap items-center gap-4",children:jsxRuntimeExports.jsxs("a",{className:"translate-y-px size-[194px] border border-gray-200 dark:border-gray-300 bg-white dark:bg-black rounded-[7px] flex flex-col items-center justify-center hover:no-underline relative",href:config$1.iosAppStoreLink,rel:"noopener noreferrer",target:"_blank",onClick:()=>{track("app_download_click",{value:"ios",...dt})},children:[jsxRuntimeExports.jsx(logosApple,{className:"w-12 h-[78px] dark:[&>path]:fill-white"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center self-center ml-1",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-sm leading-5 -translate-y-px",children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:mobile-app.download-badges.ios.wordmark"})}),jsxRuntimeExports.jsx("p",{className:"font-semibold text-lg leading-8 -translate-x-px",children:"App Store"})]}),jsxRuntimeExports.jsx("img",{src:iosDownloadQRUrl,className:"h-full w-full absolute top-0 left-0 opacity-0 hover:opacity-100 transition-opacity	duration-300 rounded-[7px]"})]})})]})]})}const UserCancelled=new Error("user cancelled"),dialogConfirm=async({title:He="Confirm?",description:Qe,cancelLabel:it=jsxRuntimeExports.jsx(Text,{i18nKey:"action:cancel"}),confirmLabel:lt=jsxRuntimeExports.jsx(Text,{i18nKey:"action:confirm"}),noCancel:ut,ConfirmButtonProps:dt,CancelButtonProps:xt}={})=>new Promise(async(ft,vt)=>{const kt=await dialog({fullWidth:!0,maxWidth:"xs",onClose:()=>{vt(UserCancelled)},children:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:He}),jsxRuntimeExports.jsx(DialogContent,{children:Qe&&jsxRuntimeExports.jsx(DialogContentText,{children:Qe})}),jsxRuntimeExports.jsxs(DialogActions,{children:[ut||jsxRuntimeExports.jsx(Button,{onClick:async()=>{await kt.current?.close(),vt(UserCancelled)},...xt,children:it}),jsxRuntimeExports.jsx(Button,{onClick:async()=>{await kt.current?.close(),ft()},autoFocus:!0,...dt,children:lt})]})]})})}),mdiClose=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"})}),cancelSubReasons=["too-expensive","poor-generation-quality","found-a-better-service-elsewhere","no-longer-in-need","technical-issues","dissatisfied-with-customer-support","dissatisfied-with-membership-features","makes-no-difference","pausing-the-subscription"],cancelPaymentReasons=["confused-about-actual-payment-amount","accidentally-clicked","encountered-payment-issues","concerned-about-security"];function MembershipSubscriptionCancelSurveyForm(He){const Qe=He.type==="cancel-subs"?cancelSubReasons:cancelPaymentReasons,{t:it}=useTranslation(["membership","action"]),[lt,ut]=reactExports.useState(""),[dt,xt]=reactExports.useState(()=>Object.fromEntries(Qe.map(St=>[St,!1]))),ft=St=>{xt(Tt=>({...Tt,[St.target.name]:St.target.checked}))},vt=()=>{track(`${He.type}-submit`,{content:lt,...dt}),He.onConfirm?.()},kt=`${He.type}-survey`;return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(DialogTitle,{className:"font-bold pr-16",children:it(`membership:${kt}.title`)}),jsxRuntimeExports.jsx(IconButton,{onClick:He.onClose,sx:{position:"absolute",right:8,top:8,color:St=>St.palette.grey[500]},children:jsxRuntimeExports.jsx(mdiClose,{})}),jsxRuntimeExports.jsxs(DialogContent,{children:[jsxRuntimeExports.jsx(FormGroup,{children:Qe.map(St=>jsxRuntimeExports.jsx(FormControlLabel,{control:jsxRuntimeExports.jsx(Checkbox,{name:St,onChange:ft}),checked:dt[St],label:it(`membership:${kt}.reasons.${St}`)},St))}),jsxRuntimeExports.jsx(OutlinedInput,{className:"mt-4",fullWidth:!0,value:lt,onChange:St=>{ut(St.target.value)},inputProps:{maxLength:500},multiline:!0,placeholder:it(`membership:${kt}.reasons.other`)})]}),jsxRuntimeExports.jsx("div",{className:"py-2 pb-6 w-full flex items-center justify-center",children:jsxRuntimeExports.jsx(UIButton$1,{onPress:vt,variant:"filled",children:it("action:submit")})})]})}const openMembershipSubscriptionSurveyDialog=async He=>new Promise(async(Qe,it)=>{const lt=await dialog({onClose:()=>{Qe()},children:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(MembershipSubscriptionCancelSurveyForm,{type:He.type,onConfirm:()=>{lt.current?.close(),Qe()},onClose:()=>{lt.current?.close(),Qe()}})})})});function PaymentFailedDialogContent(He){const{close:Qe,children:it}=He,{t:lt}=useTranslation(["membership","action"]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("section",{className:"flex justify-between items-center pt-4 px-6",children:[jsxRuntimeExports.jsx("h1",{className:"font-semibold text-2xl",children:lt("membership:payment.sth-went-wrong")}),jsxRuntimeExports.jsx(IconButton,{edge:"end",onClick:Qe,children:jsxRuntimeExports.jsx(icBaselineClose,{className:"size-6"})})]}),jsxRuntimeExports.jsxs(DialogContent,{children:[it,jsxRuntimeExports.jsx("div",{className:"my-4 w-full h-px bg-zinc-300 dark:bg-zinc-500"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"font-semibold text-lg",children:lt("membership:payment.failed.dialog.try-our-app-title")}),jsxRuntimeExports.jsx(AppDownloadButtons,{className:"mt-3 [&_h2]:text-base",hideAndroidFilterFree:!0,trackingProps:{location:"payment-failed"}})]})]}),jsxRuntimeExports.jsx(DialogActions,{children:jsxRuntimeExports.jsx(Button,{onClick:Qe,children:lt("action:cancel")})})]})}const openPaymentFailedDialog=He=>{const Qe=dialog({children:jsxRuntimeExports.jsx(PaymentFailedDialogContent,{close:()=>{Qe.current?.close()},children:He}),fullWidth:!0,maxWidth:"xs"})};function CancelSubscriptionContent(He){const{t:Qe}=useTranslation(["membership","action"]),{close:it,onSuccess:lt,onError:ut,subscription:dt,tier:xt}=He;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DialogTitle,{className:"font-bold",children:Qe("membership:plan.action.cancel.confirm-dialog.title")}),jsxRuntimeExports.jsxs(DialogContent,{children:[jsxRuntimeExports.jsx("p",{children:Qe("membership:plan.action.cancel.confirm-dialog.content")}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-theme-primary",children:[Qe("membership:plan.action.cancel.confirm-dialog.expires-at"),":"," ",defaultDayjs(dt?.endAt).format("l")]})]}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{variant:"text",onClick:()=>{it(),ut()},children:Qe("action:cancel")}),jsxRuntimeExports.jsx(Button,{variant:"contained",onClick:async()=>{track("plan_cancel_confirm",{type:dt?.interval,tier:xt}),it(),lt(),await openMembershipSubscriptionSurveyDialog({type:"cancel-subs"})},children:Qe("membership:plan.action.cancel.confirm-dialog.confirm-label")})]})]})}function openCancelSubscriptionDialog(He,Qe){return new Promise((it,lt)=>{const ut=dialog({children:jsxRuntimeExports.jsx(CancelSubscriptionContent,{subscription:He,close:()=>{ut.current?.close()},onSuccess:()=>{it(!0)},onError:()=>{lt(UserCancelled)},tier:Qe}),onClose:()=>{lt(UserCancelled)},fullWidth:!0,maxWidth:"sm"})})}function MembershipRequiredDialogContent(He){const Qe=useNavigate(),it=useJSBridgeFn(()=>{Qe("/membership/plans")},()=>{navigateToNativePage({route:NativeNavigation.membership("subscription")})}),lt=isAppWebview(),ut=reactExports.useCallback(()=>{it(),!lt&&He.close?.()},[lt,it,He]),{ongoing:dt}=useGrowthEvent(GrowthEventName.AugustEvent2025);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DialogTitle,{className:"font-bold",children:jsxRuntimeExports.jsxs("span",{className:"flex flex-row items-center gap-2",children:[jsxRuntimeExports.jsx(MembershipIconCircled,{}),jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership-requirement.title"})]})}),jsxRuntimeExports.jsxs(DialogContent,{children:[jsxRuntimeExports.jsx(Text,{i18nKey:`membership:membership-requirement.content.${He.feature}`}),dt&&jsxRuntimeExports.jsx(Link,{className:"text-amber-600 font-bold",to:"/membership/plans",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership-requirement.content.august-event"})})]}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(UIButton$1,{onPress:He.close,children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:cancel"})}),jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",onPress:ut,children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership-requirement.action.become-member"})})]})]})}function openMembershipRequiredDialog(He,Qe){return new Promise(()=>{const it=dialog({children:jsxRuntimeExports.jsx(MembershipRequiredDialogContent,{feature:He,close:()=>{it.current?.close(),Qe?.()}}),fullWidth:!0,maxWidth:"sm"})})}const PayPayLogo=He=>jsxRuntimeExports.jsxs("svg",{width:"865",height:"866",viewBox:"0 0 865 866",fill:"none",xmlns:"http://www.w3.org/2000/svg",...He,children:[jsxRuntimeExports.jsx("path",{d:"M737.075 0.681641C807.427 0.681641 864.962 58.2143 864.962 128.566V737.476C864.962 807.828 807.427 865.36 737.075 865.36H128.168C57.8139 865.36 0.28125 807.828 0.28125 737.476V271.255L0.587264 121.7C4.24963 54.5519 60.1031 0.681641 128.168 0.681641H737.075Z",fill:"white"}),jsxRuntimeExports.jsx("path",{d:"M168.609 865.36H128.168C57.8139 865.36 0.28125 807.828 0.28125 737.476V271.255C115.042 259.658 222.022 259.964 315.876 268.968L168.609 865.36ZM688.698 462.322C708.995 379.761 575.769 303.304 362.575 274.46L285.202 596.464C463.907 605.011 666.875 551.14 688.698 462.322ZM737.075 0.681641H128.168C60.1031 0.681641 4.24963 54.5519 0.587264 121.7C510.452 107.355 758.439 284.686 719.525 461.559C684.425 620.729 522.659 681.773 259.868 701.917L220.496 865.513H737.075C807.427 865.513 864.962 807.981 864.962 737.629V128.566C864.962 58.2143 807.427 0.681641 737.075 0.681641Z",fill:"#FF0033"})]});function createMarkdownRenderer(He){return new MarkdownIt({html:!0}).enable(He?.enable??[],!0).disable(He?.disable??[],!0).use(collapsiblePlugin).use(OpenLinkInNewWindow).use(Underline).use(LimitHtmlTags)}const mdFull=createMarkdownRenderer(),mdUser=createMarkdownRenderer({disable:["image","link"]});function OpenLinkInNewWindow(He){He.renderer.rules.link_open=function(Qe,it,lt,ut,dt){return Qe[it].attrSet("target","_blank"),dt.renderToken(Qe,it,lt)}}function LimitHtmlTags(He){He.renderer.rules.html_block=He.renderer.rules.html_inline=function(Qe,it){const lt=Qe[it].content;return/^<br\s*\/?>$/.test(lt)?lt:He.utils.escapeHtml(lt)}}function Underline(He){He.renderer.rules.em_open=He.renderer.rules.em_close=function(it,lt,ut,dt,xt){const ft=it[lt];return ft.markup==="_"&&(ft.tag="u"),xt.renderToken(it,lt,ut)}}function MarkdownRenderer(He){const{as:Qe="div",renderer:it=mdFull,inline:lt,children:ut,...dt}=He,xt=reactExports.useMemo(()=>lt?it.renderInline(ut):it.render(ut),[lt,it,ut]);return jsxRuntimeExports.jsx(Qe,{...dt,dangerouslySetInnerHTML:{__html:xt}})}const useGetAllPaymentItems=modifyQueryHook(createQueryHook(GetAllPaymentItemsDocument),{reduce:He=>He?.paymentItems}),fetchGetAllPaymentItems=createFetchQueryHelper(GetAllPaymentItemsDocument),refetchGetAllPaymentItems=createRefetchQueryHelper(GetAllPaymentItemsDocument),updateGetAllPaymentItems=(He,Qe)=>{baseApolloClient.refetchQueries({updateCache:it=>{it.updateQuery({query:GetAllPaymentItemsDocument,variables:He},()=>Qe)}})},useGetOrderById=modifyQueryHook(createQueryHook(GetOrderByIdDocument,{pollInterval:5e3}),{transform:He=>({orderId:He}),reduce:He=>He?.order}),[useIntentToPay,executeIntentToPay]=createMutationHelper(IntentToPayDocument),fetchGetCoupon=createFetchQueryHelper(GetCouponDocument);function openVerifyEmailModal(He){dynamicCreateElement(jsxRuntimeExports.jsx(VerifyEmailModal,{open:!0,...He}))}const VerifyEmailModal=reactExports.forwardRef((He,Qe)=>{const it=useNavigate(),{t:lt}=useTranslation(["action","user"]),{open:ut=!1,onCancel:dt=()=>{track("email_verify_cancel_click")},onConfirm:xt=()=>{track("email_verify_yes_click"),it("/profile/edit")},onClose:ft,title:vt=lt("user:profile.email.verification-required-dialog.title"),content:kt=lt("user:profile.email.verification-required-dialog.content"),confirmLabel:St,cancelLabel:Tt}=He,[Mt,Nt]=reactExports.useState(ut);return reactExports.useImperativeHandle(Qe,()=>({open:()=>{Nt(!0)}}),[]),jsxRuntimeExports.jsxs(ResponsiveDialog,{open:Mt,dialogProps:{maxWidth:!1,fullWidth:!1},onClose:()=>{Nt(!1),ft?.()},children:[jsxRuntimeExports.jsx(DialogTitle,{children:vt}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsx(DialogContentText,{children:kt})}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:()=>{dt?.(),Nt(!1)},children:Tt??lt("action:cancel")}),jsxRuntimeExports.jsx(Button,{variant:"contained",onClick:()=>{xt?.(),Nt(!1)},children:St??lt("action:yes")})]})]})});VerifyEmailModal.displayName="VerifyEmailModal";var PaymentProvider=(He=>(He.stripe="stripe",He.paddle="paddle",He.braintree="braintree",He.onerway="onerway",He.paypay="paypay",He))(PaymentProvider||{});const handleChangePlanSuccess=async()=>{refetchGetMyMembership()},getPaymentErrorMessage=He=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Text,{i18nKey:"membership:payment.if-this-error-persists-pls-contact-us"})," (",jsxRuntimeExports.jsx(Text,{i18nKey:"membership:payment.unexpected-error",values:{error:He?.message}}),")"]}),handlePaymentError=He=>{if(console.error(He),He===UserCancelled)return;const Qe=extractActionableErrorCode(He);$$3(Qe).with("EMAIL_IS_REQUIRED",()=>{openVerifyEmailModal()}).otherwise(()=>{const it=getPaymentErrorMessage(He);track("payment_failed",{errorMessage:typeof He.message=="string"?He.message:"Unknown Error Message"}),openPaymentFailedDialog(it)})};function extractActionableErrorCode(He){if(He.errors?.length>0)return He.errors[0].extensions?.exception?.name}const mdiLoading=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 4V2A10 10 0 0 0 2 12h2a8 8 0 0 1 8-8Z"})});/*! For license information please see pacypay.js.LICENSE.txt */const Pacypay=function(){var He={61:function(ut,dt,xt){var ft=xt(698).default;function vt(){ut.exports=vt=function(){return kt},ut.exports.__esModule=!0,ut.exports.default=ut.exports;var kt={},St=Object.prototype,Tt=St.hasOwnProperty,Mt=Object.defineProperty||function(Sr,Dr,wr){Sr[Dr]=wr.value},Nt=typeof Symbol=="function"?Symbol:{},At=Nt.iterator||"@@iterator",$t=Nt.asyncIterator||"@@asyncIterator",Dt=Nt.toStringTag||"@@toStringTag";function Ft(Sr,Dr,wr){return Object.defineProperty(Sr,Dr,{value:wr,enumerable:!0,configurable:!0,writable:!0}),Sr[Dr]}try{Ft({},"")}catch{Ft=function(Dr,wr,qr){return Dr[wr]=qr}}function Bt(Sr,Dr,wr,qr){var Nr=Dr&&Dr.prototype instanceof Wt?Dr:Wt,Jr=Object.create(Nr.prototype),Qr=new Tr(qr||[]);return Mt(Jr,"_invoke",{value:yr(Sr,wr,Qr)}),Jr}function Ot(Sr,Dr,wr){try{return{type:"normal",arg:Sr.call(Dr,wr)}}catch(qr){return{type:"throw",arg:qr}}}kt.wrap=Bt;var Qt={};function Wt(){}function Xt(){}function Kt(){}var Jt={};Ft(Jt,At,function(){return this});var hr=Object.getPrototypeOf,xr=hr&&hr(hr($r([])));xr&&xr!==St&&Tt.call(xr,At)&&(Jt=xr);var gr=Kt.prototype=Wt.prototype=Object.create(Jt);function br(Sr){["next","throw","return"].forEach(function(Dr){Ft(Sr,Dr,function(wr){return this._invoke(Dr,wr)})})}function vr(Sr,Dr){function wr(Nr,Jr,Qr,Ur){var nn=Ot(Sr[Nr],Sr,Jr);if(nn.type!=="throw"){var Cn=nn.arg,es=Cn.value;return es&&ft(es)=="object"&&Tt.call(es,"__await")?Dr.resolve(es.__await).then(function(Xr){wr("next",Xr,Qr,Ur)},function(Xr){wr("throw",Xr,Qr,Ur)}):Dr.resolve(es).then(function(Xr){Cn.value=Xr,Qr(Cn)},function(Xr){return wr("throw",Xr,Qr,Ur)})}Ur(nn.arg)}var qr;Mt(this,"_invoke",{value:function(Nr,Jr){function Qr(){return new Dr(function(Ur,nn){wr(Nr,Jr,Ur,nn)})}return qr=qr?qr.then(Qr,Qr):Qr()}})}function yr(Sr,Dr,wr){var qr="suspendedStart";return function(Nr,Jr){if(qr==="executing")throw new Error("Generator is already running");if(qr==="completed"){if(Nr==="throw")throw Jr;return Zr()}for(wr.method=Nr,wr.arg=Jr;;){var Qr=wr.delegate;if(Qr){var Ur=Cr(Qr,wr);if(Ur){if(Ur===Qt)continue;return Ur}}if(wr.method==="next")wr.sent=wr._sent=wr.arg;else if(wr.method==="throw"){if(qr==="suspendedStart")throw qr="completed",wr.arg;wr.dispatchException(wr.arg)}else wr.method==="return"&&wr.abrupt("return",wr.arg);qr="executing";var nn=Ot(Sr,Dr,wr);if(nn.type==="normal"){if(qr=wr.done?"completed":"suspendedYield",nn.arg===Qt)continue;return{value:nn.arg,done:wr.done}}nn.type==="throw"&&(qr="completed",wr.method="throw",wr.arg=nn.arg)}}}function Cr(Sr,Dr){var wr=Dr.method,qr=Sr.iterator[wr];if(qr===void 0)return Dr.delegate=null,wr==="throw"&&Sr.iterator.return&&(Dr.method="return",Dr.arg=void 0,Cr(Sr,Dr),Dr.method==="throw")||wr!=="return"&&(Dr.method="throw",Dr.arg=new TypeError("The iterator does not provide a '"+wr+"' method")),Qt;var Nr=Ot(qr,Sr.iterator,Dr.arg);if(Nr.type==="throw")return Dr.method="throw",Dr.arg=Nr.arg,Dr.delegate=null,Qt;var Jr=Nr.arg;return Jr?Jr.done?(Dr[Sr.resultName]=Jr.value,Dr.next=Sr.nextLoc,Dr.method!=="return"&&(Dr.method="next",Dr.arg=void 0),Dr.delegate=null,Qt):Jr:(Dr.method="throw",Dr.arg=new TypeError("iterator result is not an object"),Dr.delegate=null,Qt)}function Rr(Sr){var Dr={tryLoc:Sr[0]};1 in Sr&&(Dr.catchLoc=Sr[1]),2 in Sr&&(Dr.finallyLoc=Sr[2],Dr.afterLoc=Sr[3]),this.tryEntries.push(Dr)}function Ir(Sr){var Dr=Sr.completion||{};Dr.type="normal",delete Dr.arg,Sr.completion=Dr}function Tr(Sr){this.tryEntries=[{tryLoc:"root"}],Sr.forEach(Rr,this),this.reset(!0)}function $r(Sr){if(Sr){var Dr=Sr[At];if(Dr)return Dr.call(Sr);if(typeof Sr.next=="function")return Sr;if(!isNaN(Sr.length)){var wr=-1,qr=function Nr(){for(;++wr<Sr.length;)if(Tt.call(Sr,wr))return Nr.value=Sr[wr],Nr.done=!1,Nr;return Nr.value=void 0,Nr.done=!0,Nr};return qr.next=qr}}return{next:Zr}}function Zr(){return{value:void 0,done:!0}}return Xt.prototype=Kt,Mt(gr,"constructor",{value:Kt,configurable:!0}),Mt(Kt,"constructor",{value:Xt,configurable:!0}),Xt.displayName=Ft(Kt,Dt,"GeneratorFunction"),kt.isGeneratorFunction=function(Sr){var Dr=typeof Sr=="function"&&Sr.constructor;return!!Dr&&(Dr===Xt||(Dr.displayName||Dr.name)==="GeneratorFunction")},kt.mark=function(Sr){return Object.setPrototypeOf?Object.setPrototypeOf(Sr,Kt):(Sr.__proto__=Kt,Ft(Sr,Dt,"GeneratorFunction")),Sr.prototype=Object.create(gr),Sr},kt.awrap=function(Sr){return{__await:Sr}},br(vr.prototype),Ft(vr.prototype,$t,function(){return this}),kt.AsyncIterator=vr,kt.async=function(Sr,Dr,wr,qr,Nr){Nr===void 0&&(Nr=Promise);var Jr=new vr(Bt(Sr,Dr,wr,qr),Nr);return kt.isGeneratorFunction(Dr)?Jr:Jr.next().then(function(Qr){return Qr.done?Qr.value:Jr.next()})},br(gr),Ft(gr,Dt,"Generator"),Ft(gr,At,function(){return this}),Ft(gr,"toString",function(){return"[object Generator]"}),kt.keys=function(Sr){var Dr=Object(Sr),wr=[];for(var qr in Dr)wr.push(qr);return wr.reverse(),function Nr(){for(;wr.length;){var Jr=wr.pop();if(Jr in Dr)return Nr.value=Jr,Nr.done=!1,Nr}return Nr.done=!0,Nr}},kt.values=$r,Tr.prototype={constructor:Tr,reset:function(Sr){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Ir),!Sr)for(var Dr in this)Dr.charAt(0)==="t"&&Tt.call(this,Dr)&&!isNaN(+Dr.slice(1))&&(this[Dr]=void 0)},stop:function(){this.done=!0;var Sr=this.tryEntries[0].completion;if(Sr.type==="throw")throw Sr.arg;return this.rval},dispatchException:function(Sr){if(this.done)throw Sr;var Dr=this;function wr(nn,Cn){return Jr.type="throw",Jr.arg=Sr,Dr.next=nn,Cn&&(Dr.method="next",Dr.arg=void 0),!!Cn}for(var qr=this.tryEntries.length-1;qr>=0;--qr){var Nr=this.tryEntries[qr],Jr=Nr.completion;if(Nr.tryLoc==="root")return wr("end");if(Nr.tryLoc<=this.prev){var Qr=Tt.call(Nr,"catchLoc"),Ur=Tt.call(Nr,"finallyLoc");if(Qr&&Ur){if(this.prev<Nr.catchLoc)return wr(Nr.catchLoc,!0);if(this.prev<Nr.finallyLoc)return wr(Nr.finallyLoc)}else if(Qr){if(this.prev<Nr.catchLoc)return wr(Nr.catchLoc,!0)}else{if(!Ur)throw new Error("try statement without catch or finally");if(this.prev<Nr.finallyLoc)return wr(Nr.finallyLoc)}}}},abrupt:function(Sr,Dr){for(var wr=this.tryEntries.length-1;wr>=0;--wr){var qr=this.tryEntries[wr];if(qr.tryLoc<=this.prev&&Tt.call(qr,"finallyLoc")&&this.prev<qr.finallyLoc){var Nr=qr;break}}Nr&&(Sr==="break"||Sr==="continue")&&Nr.tryLoc<=Dr&&Dr<=Nr.finallyLoc&&(Nr=null);var Jr=Nr?Nr.completion:{};return Jr.type=Sr,Jr.arg=Dr,Nr?(this.method="next",this.next=Nr.finallyLoc,Qt):this.complete(Jr)},complete:function(Sr,Dr){if(Sr.type==="throw")throw Sr.arg;return Sr.type==="break"||Sr.type==="continue"?this.next=Sr.arg:Sr.type==="return"?(this.rval=this.arg=Sr.arg,this.method="return",this.next="end"):Sr.type==="normal"&&Dr&&(this.next=Dr),Qt},finish:function(Sr){for(var Dr=this.tryEntries.length-1;Dr>=0;--Dr){var wr=this.tryEntries[Dr];if(wr.finallyLoc===Sr)return this.complete(wr.completion,wr.afterLoc),Ir(wr),Qt}},catch:function(Sr){for(var Dr=this.tryEntries.length-1;Dr>=0;--Dr){var wr=this.tryEntries[Dr];if(wr.tryLoc===Sr){var qr=wr.completion;if(qr.type==="throw"){var Nr=qr.arg;Ir(wr)}return Nr}}throw new Error("illegal catch attempt")},delegateYield:function(Sr,Dr,wr){return this.delegate={iterator:$r(Sr),resultName:Dr,nextLoc:wr},this.method==="next"&&(this.arg=void 0),Qt}},kt}ut.exports=vt,ut.exports.__esModule=!0,ut.exports.default=ut.exports},698:function(ut){function dt(xt){return ut.exports=dt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ft){return typeof ft}:function(ft){return ft&&typeof Symbol=="function"&&ft.constructor===Symbol&&ft!==Symbol.prototype?"symbol":typeof ft},ut.exports.__esModule=!0,ut.exports.default=ut.exports,dt(xt)}ut.exports=dt,ut.exports.__esModule=!0,ut.exports.default=ut.exports},687:function(ut,dt,xt){var ft=xt(61)();ut.exports=ft;try{regeneratorRuntime=ft}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=ft:Function("r","regeneratorRuntime = r")(ft)}}},Qe={};function it(ut){var dt=Qe[ut];if(dt!==void 0)return dt.exports;var xt=Qe[ut]={exports:{}};return He[ut](xt,xt.exports,it),xt.exports}it.n=function(ut){var dt=ut&&ut.__esModule?function(){return ut.default}:function(){return ut};return it.d(dt,{a:dt}),dt},it.d=function(ut,dt){for(var xt in dt)it.o(dt,xt)&&!it.o(ut,xt)&&Object.defineProperty(ut,xt,{enumerable:!0,get:dt[xt]})},it.o=function(ut,dt){return Object.prototype.hasOwnProperty.call(ut,dt)};var lt={};return function(){function ut(Xt){return ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Kt){return typeof Kt}:function(Kt){return Kt&&typeof Symbol=="function"&&Kt.constructor===Symbol&&Kt!==Symbol.prototype?"symbol":typeof Kt},ut(Xt)}function dt(Xt){var Kt=function(Jt,hr){if(ut(Jt)!=="object"||Jt===null)return Jt;var xr=Jt[Symbol.toPrimitive];if(xr!==void 0){var gr=xr.call(Jt,hr||"default");if(ut(gr)!=="object")return gr;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hr==="string"?String:Number)(Jt)}(Xt,"string");return ut(Kt)==="symbol"?Kt:String(Kt)}function xt(Xt,Kt){for(var Jt=0;Jt<Kt.length;Jt++){var hr=Kt[Jt];hr.enumerable=hr.enumerable||!1,hr.configurable=!0,"value"in hr&&(hr.writable=!0),Object.defineProperty(Xt,dt(hr.key),hr)}}function ft(Xt,Kt,Jt){return(Kt=dt(Kt))in Xt?Object.defineProperty(Xt,Kt,{value:Jt,enumerable:!0,configurable:!0,writable:!0}):Xt[Kt]=Jt,Xt}function vt(Xt,Kt,Jt,hr,xr,gr,br){try{var vr=Xt[gr](br),yr=vr.value}catch(Cr){return void Jt(Cr)}vr.done?Kt(yr):Promise.resolve(yr).then(hr,xr)}function kt(Xt){return function(){var Kt=this,Jt=arguments;return new Promise(function(hr,xr){var gr=Xt.apply(Kt,Jt);function br(yr){vt(gr,hr,xr,br,vr,"next",yr)}function vr(yr){vt(gr,hr,xr,br,vr,"throw",yr)}br(void 0)})}}it.d(lt,{default:function(){return Wt}});var St=it(687),Tt=it.n(St),Mt=function(Xt,Kt){var Jt=JSON.parse(Kt).iframeId,hr=document.getElementById(Jt);hr&&hr.contentWindow.postMessage({action:Xt,data:Kt},"*")},Nt=function(){var Xt=kt(Tt().mark(function Kt(Jt){return Tt().wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:if(!window.ApplePaySession){hr.next=12;break}return hr.prev=1,hr.next=4,window.ApplePaySession.canMakePayments();case 4:if(!hr.sent){hr.next=7;break}return hr.abrupt("return",!0);case 7:hr.next=12;break;case 9:hr.prev=9,hr.t0=hr.catch(1),console.error("ApplePay canMakePaymentsWithActiveCard error",hr.t0);case 12:return hr.abrupt("return",!1);case 13:case"end":return hr.stop()}},Kt,null,[[1,9]])}));return function(Kt){return Xt.apply(this,arguments)}}(),At=function(){var Xt=kt(Tt().mark(function Kt(Jt,hr){var xr,gr,br;return Tt().wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return xr=JSON.parse(Jt),gr=xr.iframeId,vr.prev=2,vr.next=5,Nt();case 5:if(!vr.sent){vr.next=12;break}return(br=new window.ApplePaySession(1,xr.request)).onvalidatemerchant=function(yr){Mt("check_apple_pay_session",JSON.stringify({website:window.location.hostname,verifyUrl:yr.validationURL,iframeId:gr}))},br.onpaymentauthorized=function(yr){var Cr=yr.payment.token;Mt("apple_pay_submit",JSON.stringify({applePaymentToken:Cr,iframeId:gr}))},br.oncancel=function(yr){hr[gr]&&hr[gr].onSubmitting&&hr[gr].onSubmitting(!1)},br.begin(),vr.abrupt("return",br);case 12:vr.next=16;break;case 14:vr.prev=14,vr.t0=vr.catch(2);case 16:case"end":return vr.stop()}},Kt,null,[[2,14]])}));return function(Kt,Jt){return Xt.apply(this,arguments)}}(),$t=function(){return{sandbox:"https://sandbox-checkout-sdk.onerway.com",production:"https://checkout-sdk.onerway.com"}[(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"production").toLowerCase()]||"https://checkout-sdk.onerway.com"},Dt={},Ft=null;function Bt(Xt){return Ot.apply(this,arguments)}function Ot(){return(Ot=kt(Tt().mark(function Xt(Kt){var Jt,hr,xr,gr,br,vr,yr,Cr;return Tt().wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:Jt=Kt.data||{},hr=Jt.action,xr=Jt.data,gr={},Rr.t0=hr,Rr.next=Rr.t0==="pacypay_onsubmit"?5:Rr.t0==="pacypay_checkout_success"?8:Rr.t0==="pacypay_checkout_error"?23:Rr.t0==="pacypay_checkout_wh"?26:Rr.t0==="apple_pay_check_availability"?28:Rr.t0==="apple_pay_start"?34:Rr.t0==="apple_pay_session_validation"?38:Rr.t0==="apple_pay_completed"?40:43;break;case 5:return(gr=JSON.parse(xr)).iframeId?(br=gr.iframeId,Dt[br]&&Dt[br].onSubmitting&&Dt[br].onSubmitting(gr.loading)):Dt.original&&Dt.original.onSubmitting&&Dt.original.onSubmitting(gr.loading),Rr.abrupt("break",43);case 8:if(!(gr=JSON.parse(xr)).iframeId){Rr.next=18;break}if(vr=gr.iframeId,delete gr.iframeId,!Dt[vr]||!Dt[vr].onSubmitting){Rr.next=15;break}return Rr.next=15,Dt[vr].onSubmitting(!1);case 15:gr.respCode?Dt[vr]&&Dt[vr].onPaymentCompleted&&Dt[vr].onPaymentCompleted(gr):Dt[vr]&&Dt[vr].onPaymentCompleted&&Dt[vr].onPaymentCompleted({respCode:"20000",respMsg:"Success",data:gr}),Rr.next=22;break;case 18:if(!Dt.original||!Dt.original.onSubmitting){Rr.next=21;break}return Rr.next=21,Dt.original.onSubmitting(!1);case 21:Dt.original&&Dt.original.onPaymentCompleted&&Dt.original.onPaymentCompleted(gr);case 22:return Rr.abrupt("break",43);case 23:return(gr=JSON.parse(xr)).iframeId?(yr=gr.iframeId,delete gr.iframeId,Dt[yr]&&Dt[yr].onSubmitting&&Dt[yr].onSubmitting(!1),Dt[yr]&&Dt[yr].onError&&Dt[yr].onError(gr)):Dt.original?(Dt.original.onSubmitting&&Dt.original.onSubmitting(!1),Dt.original.onError&&Dt.original.onError(gr)):Object.keys(Dt).forEach(function(Ir){Dt[Ir].onSubmitting&&Dt[Ir].onSubmitting(!1),Dt[Ir].onError&&Dt[Ir].onError(gr)}),Rr.abrupt("break",43);case 26:return Object.keys(Dt).forEach(function(Ir){(Ir==="original"||Dt[Ir].props&&(!Dt[Ir].props.mode||Dt[Ir].props.mode.length===0||Dt[Ir].props.mode==="CARD"||Dt[Ir].props.mode.includes("CARD")))&&Dt[Ir].onChangeWH&&Dt[Ir].onChangeWH(xr)}),Rr.abrupt("break",43);case 28:return gr=JSON.parse(xr),Rr.next=31,Nt(gr.merchantIdentifier);case 31:return Cr=Rr.sent,Mt("apple_pay_init",JSON.stringify({iframeId:gr.iframeId,availability:Cr})),Rr.abrupt("break",43);case 34:return Rr.next=36,At(xr,Dt);case 36:return Ft=Rr.sent,Rr.abrupt("break",43);case 38:try{gr=JSON.parse(xr),Ft.completeMerchantValidation(gr.mSession)}catch{}return Rr.abrupt("break",43);case 40:return(gr=JSON.parse(xr)).status==="F"?Ft.completePayment(Ft.STATUS_FAILURE):Ft.completePayment(Ft.STATUS_SUCCESS),Rr.abrupt("break",43);case 43:case"end":return Rr.stop()}},Xt)}))).apply(this,arguments)}var Qt=function(){function Xt(gr){var br=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(function(yr,Cr){if(!(yr instanceof Cr))throw new TypeError("Cannot call a class as a function")}(this,Xt),ft(this,"props",void 0),ft(this,"container",void 0),ft(this,"onPaymentCompleted",void 0),ft(this,"onError",void 0),ft(this,"_initContainerHeight",void 0),ft(this,"_isSubmitting",!1),!gr)throw"Pacypay -> transactionId is null!";this.props=br;var vr="iframe_".concat(new Date().getTime(),"_").concat(Math.floor(1e3*Math.random()));br.mode?Dt[vr]=this:Dt.original=this,this.container=br.container||"pacypay_checkout",this.onPaymentCompleted=br.onPaymentCompleted,this.onError=br.onError,this.onSubmit=br.onSubmit,this.onChangeWH=br.onChangeWH,this.iframeId=vr,this.createCheckout(br,gr)}var Kt,Jt,hr,xr;return Kt=Xt,Jt=[{key:"createCheckout",value:function(gr,br){var vr=this,yr={};try{yr=this.checkMerchant(gr.environment);var Cr=document.getElementById(this.container);this._initContainerHeight=Cr.scrollHeight;var Rr=function(Ir){var Tr=Ir.src,$r=Ir.title,Zr=$r===void 0?"pacypay iframe":$r,Sr=Ir.policy,Dr=Sr===void 0?"origin":Sr,wr=Ir.styleStr,qr=wr===void 0?"border: none; height:100%; width:100%; overflow:hidden;":wr,Nr=document.createElement("iframe");Nr.setAttribute("src",Tr),Nr.setAttribute("class","pacypay-iframe"),Nr.setAttribute("allowpaymentrequest",!0),Zr===""||Zr.trim().length===0||Zr==="none"?Nr.setAttribute("role","presentation"):Nr.setAttribute("title",Zr),Nr.setAttribute("allowtransparency","true"),Nr.setAttribute("style",qr),Nr.setAttribute("referrerpolicy",Dr),Nr.setAttribute("scrolling","no"),Nr.setAttribute("allow","payment *");var Jr=document.createTextNode("<p>Your browser does not support iframes.</p>");return Nr.appendChild(Jr),Nr}({src:yr.iframeUrl});Rr.setAttribute("id",this.iframeId),Cr.innerHTML="",Cr.appendChild(Rr),window.removeEventListener("message",Bt,!0),window.addEventListener("message",Bt,!0),Rr.onload=function(){var Ir=gr.mode,Tr=ut(Ir);if(Ir&&Tr==="string"&&(Ir==="ApplePay"||Ir==="GooglePay")||Tr==="object"&&(Ir.includes("ApplePay")||Ir.includes("GooglePay"))){var $r=document.createElement("meta");$r.setAttribute("http-equiv","Feature-Policy"),$r.setAttribute("content","payment 'self'"),document.head.appendChild($r),gr.config&&(gr.config.locale=gr.locale,gr.config.googlePayButtonType=gr.config.googlePayButtonType||"plain",gr.config.googlePayButtonColor=gr.config.googlePayButtonColor||"black",gr.config.buttonRadius=gr.config.buttonRadius||"4px",gr.config.applePayButtonType=gr.config.applePayButtonType||"plain",gr.config.applePayButtonColor=gr.config.applePayButtonColor||"black",(Ir==="GooglePay"||Ir.includes("GooglePay"))&&(gr.config.paymentMethod="GooglePay"),(Ir==="ApplePay"||Ir.includes("ApplePay"))&&(gr.config.paymentMethod="ApplePay")),gr.config.transactionId=br,gr.config.originUrl=window.location.origin,gr.config.iframeId=vr.iframeId,Mt("pacypay_theme",JSON.stringify({config:gr.config,iframeId:vr.iframeId}))}else gr.config?(gr.config.subProductType?gr.config.paymentMethod=gr.config.subProductType:gr.config.paymentMethod="card",gr.config.checkoutTheme||(gr.config.checkoutTheme="light"),gr.config.showPayButton=typeof gr.config.showPayButton!="boolean"||!!gr.config.showPayButton,gr.config.buttonSeparation=typeof gr.config.buttonSeparation!="boolean"||!!gr.config.buttonSeparation,gr.config.displayBillingInformation=typeof gr.config.displayBillingInformation!="boolean"||!!gr.config.displayBillingInformation,gr.config.locale=gr.locale,gr.config.displayCardholdername=typeof gr.config.displayCardholdername!="boolean"||!!gr.config.displayCardholdername):gr.config={paymentMethod:"card",checkoutTheme:"light",showPayButton:!0,buttonSeparation:!0,displayBillingInformation:!0,locale:gr.locale},gr.config.transactionId=br,gr.config.originUrl=window.location.origin,gr.config.iframeId=vr.iframeId,Mt("pacypay_theme",JSON.stringify({config:gr.config,iframeId:vr.iframeId}))}}catch(Ir){this.onError&&this.onError(Ir)}}},{key:"checkMerchant",value:function(gr){return{iframeUrl:$t(gr)}}},{key:"submit",value:function(){var gr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};gr.iframeId=this.iframeId,Mt("pacypay_checkout_submit",JSON.stringify(gr))}},{key:"onSubmitting",value:(xr=kt(Tt().mark(function gr(){var br,vr=arguments;return Tt().wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:if(br=vr.length>0&&vr[0]!==void 0&&vr[0],this.onSubmit){yr.next=3;break}return yr.abrupt("return");case 3:if(!br||this._isSubmitting){yr.next=9;break}return this._isSubmitting=!0,yr.next=7,this.onSubmit(!0);case 7:yr.next=13;break;case 9:if(br||!this._isSubmitting){yr.next=13;break}return this._isSubmitting=!1,yr.next=13,this.onSubmit(!1);case 13:case"end":return yr.stop()}},gr,this)})),function(){return xr.apply(this,arguments)})},{key:"onChangeWH",value:function(gr){var br=JSON.parse(gr).height,vr=this._initContainerHeight;this._initContainerHeight<br&&(vr=br),document.getElementById(this.container).style.height="".concat(vr,"px")}}],hr=[{key:"version",get:function(){return"1.1.2"}}],Jt&&xt(Kt.prototype,Jt),hr&&xt(Kt,hr),Object.defineProperty(Kt,"prototype",{writable:!1}),Xt}(),Wt=Qt}(),lt=lt.default}(),log$3=debug("pixai:payment:onerway");function ensureOnerwayLocale(He){const Qe=["en","zh-cn","ar","de","es","fi","fr","it","ja","ko","nl","no","pl","pt","ru","sv","th","zh-tw"];if(Qe.includes(He))return He;const it=He.split("-")[0];if(Qe.includes(it))return it}const PaymentDialogContentOnerway=({onSucceeded:He,onFailed:Qe,...it})=>{const[lt,ut]=reactExports.useState(null),{t:dt,i18n:xt}=useTranslation(["membership"]),ft=reactExports.useRef("onerway_"+genRandomString(16)).current,[vt,kt]=reactExports.useState(null),{error:St}=useAsync(async()=>{const Tt=typeof it.redirect=="string"?it.redirect:it.redirect?.(lt?.revenueInfo),Mt=await executeIntentToPay({itemId:it.itemId,interval:it.interval,opt:{provider:PaymentProvider.onerway,currency:it.currency,couponCode:it.couponCode,shouldDiscount:it.shouldDiscount,redirect:Tt}}),Nt=Mt.data?.intentToPay?.onerwayTransactionId;if(!Nt)throw new Error("Transaction ID not found");const At=Mt.data?.intentToPay?.orderId;if(!At)throw new Error("Order ID not found");ut({revenueInfo:Mt.data?.intentToPay?.revenueInfo,transactionId:Nt,orderId:At,subProductType:Mt.data?.intentToPay?.onerwaySubProductType}),it.trackingFnAfterFetch?.()});return reactExports.useEffect(()=>{St&&(log$3("[Payment:Onerway] Failed to fetch transaction ID",St),Qe?.(St))},[St]),reactExports.useLayoutEffect(()=>{if(!lt)return;const Tt=new Pacypay(lt.transactionId,{container:ft,locale:ensureOnerwayLocale(xt.language)??"en",environment:getApiEnv().isProd||getApiEnv().isStaging?"production":"sandbox",mode:"CARD",config:{subProductType:lt.subProductType,checkoutTheme:"light",buttonSeparation:!1,displayBillingInformation:!1,variables:{colorBackground:"#ffffff",colorPrimary:"#999999",colorText:"#000000",colorDanger:"#dc2626",borderRadius:"4px",fontSizeBase:"15px",fontFamily:"Inter, system-ui, -apple-system, sans-serif"},styles:{body:{"margin-top":"10px"},".pacypay-checkout__payment-method__image":{"object-fit":"contain",filter:"grayscale(1)","-webkit-user-drag":"none","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"},".pacypay-checkout__payment-method__header":{padding:"10px 14px 10px 3px"},".pacypay-checkout__payment-method":{"border-color":"transparent","border-radius":"0"},".pacypay-checkout__btn-wrap":{margin:"0 10px 10px 10px !important",transition:"all 0.2s ease-out"},".pacypay-checkout__btn-wrap:hover":{filter:"brightness(1.15)"},".pacypay-checkout__btn-wrap:active":{filter:"brightness(0.8)",transform:"scale(0.975)"},".pacypay-checkout__error-text":{"font-family":"var(--fontFamily)",padding:"2px"},".pacypay-checkout__payment-method__details":{margin:"10px 0 0 0"},".pacypay-checkout__payment-method__name":{"font-variant-numeric":"tabular-nums"},".pacypay-checkout__modal-wrap":{"flex-direction":"row","font-family":"var(--fontFamily)"},".pacypay-checkout__modal":{overflow:"hidden","border-radius":"8px","min-height":"auto"},".pacypay-checkout__modal__close":{display:"none"},".pacypay-checkout__modal__title":{padding:"10px 15px"},".pacypay-checkout__modal__buttons":{"background-color":"transparent","margin-top":"0px","margin-bottom":"0px","padding-left":"15px",display:"flex"},".pacypay-checkout__modal__content":{padding:"10px 15px"}}},onPaymentCompleted:Nt=>{log$3("[Payment:Onerway] Payment completed with response",Nt);const At=Nt.data;if(Nt.respCode==="20000")switch(At.status){case"S":He?.({revenueInfo:lt.revenueInfo,finalizedPaymentProvider:PaymentProvider.onerway,orderId:lt.orderId});break;case"R":if(At.redirectUrl){window.location.href=At.redirectUrl,kt(At.redirectUrl);const Dt=document.getElementById(ft);if(Dt){for(;Dt?.firstChild;)Dt.removeChild(Dt.firstChild);Dt.style.setProperty("height","auto"),Dt.style.setProperty("width","auto")}}else alert("Redirect URL not found");break}else console.error("[Payment:Onerway] Payment error",Nt),toast.error("That didn't work out. Please check your payment details and try again."),Qe?.(new Error(Nt.respMsg))},onError:Nt=>{console.error("[Payment:Onerway] Payment error",Nt),toast.error("That didn't work out. Please check your payment details and try again."),Qe?.(new Error(Nt.message))},onChangeWH:Nt=>{const{width:At,height:$t}=JSON.parse(Nt);document.getElementById(ft)?.style.setProperty("height",`${$t+20}px`),document.getElementById(ft)?.style.setProperty("width",`${At}px`)}}),Mt=setInterval(()=>{const Nt=document.getElementById(ft)?.querySelector("iframe");Nt&&(Nt.title="",clearInterval(Mt))},1e3);return log$3("[Payment:Onerway] Initialized Onerway instance",Tt),()=>{clearInterval(Mt)}},[lt]),vt?jsxRuntimeExports.jsxs("div",{className:"w-full rounded-lg flex flex-col items-center duration-300 justify-center text-black/75 text-center bg-white select-none px-4 py-8 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"w-full flex flex-col items-center justify-center gap-2 py-2",children:[jsxRuntimeExports.jsx(mdiLoading,{className:"size-6 animate-spin"}),jsxRuntimeExports.jsx("div",{className:"opacity-70 text-sm mt-2",children:jsxRuntimeExports.jsx(Trans,{i18nKey:"membership:payment.threedsecure.title",components:[jsxRuntimeExports.jsx("a",{href:vt,rel:"noreferrer noopener",className:"text-blue-500 hover:underline"})]})})]}),jsxRuntimeExports.jsx("div",{className:"h-px w-full bg-black/10"}),jsxRuntimeExports.jsx("div",{className:"opacity-70 text-left w-full [&>p:not(:last-child)]:mb-2 text-xs",children:jsxRuntimeExports.jsx(MarkdownRenderer,{children:dt("membership:payment.threedsecure.faq")})})]}):lt?jsxRuntimeExports.jsx("div",{className:"h-[100px] w-full bg-white rounded-lg overflow-y-auto flex items-center duration-300",id:ft}):jsxRuntimeExports.jsx("div",{className:"h-[100px] w-full rounded-lg flex items-center duration-300 justify-center text-black/75 text-center text-sm bg-white select-none",children:jsxRuntimeExports.jsx(mdiLoading,{className:"size-6 animate-spin"})})};var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(He,Qe,it)=>Qe in He?__defProp(He,Qe,{enumerable:!0,configurable:!0,writable:!0,value:it}):He[Qe]=it,__spreadValues=(He,Qe)=>{for(var it in Qe||(Qe={}))__hasOwnProp.call(Qe,it)&&__defNormalProp(He,it,Qe[it]);if(__getOwnPropSymbols)for(var it of __getOwnPropSymbols(Qe))__propIsEnum.call(Qe,it)&&__defNormalProp(He,it,Qe[it]);return He},__objRest=(He,Qe)=>{var it={};for(var lt in He)__hasOwnProp.call(He,lt)&&Qe.indexOf(lt)<0&&(it[lt]=He[lt]);if(He!=null&&__getOwnPropSymbols)for(var lt of __getOwnPropSymbols(He))Qe.indexOf(lt)<0&&__propIsEnum.call(He,lt)&&(it[lt]=He[lt]);return it};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var qrcodegen;(He=>{const Qe=class{constructor(vt,kt,St,Tt){if(this.version=vt,this.errorCorrectionLevel=kt,this.modules=[],this.isFunction=[],vt<Qe.MIN_VERSION||vt>Qe.MAX_VERSION)throw new RangeError("Version value out of range");if(Tt<-1||Tt>7)throw new RangeError("Mask value out of range");this.size=vt*4+17;let Mt=[];for(let At=0;At<this.size;At++)Mt.push(!1);for(let At=0;At<this.size;At++)this.modules.push(Mt.slice()),this.isFunction.push(Mt.slice());this.drawFunctionPatterns();const Nt=this.addEccAndInterleave(St);if(this.drawCodewords(Nt),Tt==-1){let At=1e9;for(let $t=0;$t<8;$t++){this.applyMask($t),this.drawFormatBits($t);const Dt=this.getPenaltyScore();Dt<At&&(Tt=$t,At=Dt),this.applyMask($t)}}dt(0<=Tt&&Tt<=7),this.mask=Tt,this.applyMask(Tt),this.drawFormatBits(Tt),this.isFunction=[]}static encodeText(vt,kt){const St=He.QrSegment.makeSegments(vt);return Qe.encodeSegments(St,kt)}static encodeBinary(vt,kt){const St=He.QrSegment.makeBytes(vt);return Qe.encodeSegments([St],kt)}static encodeSegments(vt,kt,St=1,Tt=40,Mt=-1,Nt=!0){if(!(Qe.MIN_VERSION<=St&&St<=Tt&&Tt<=Qe.MAX_VERSION)||Mt<-1||Mt>7)throw new RangeError("Invalid value");let At,$t;for(At=St;;At++){const Ot=Qe.getNumDataCodewords(At,kt)*8,Qt=ft.getTotalBits(vt,At);if(Qt<=Ot){$t=Qt;break}if(At>=Tt)throw new RangeError("Data too long")}for(const Ot of[Qe.Ecc.MEDIUM,Qe.Ecc.QUARTILE,Qe.Ecc.HIGH])Nt&&$t<=Qe.getNumDataCodewords(At,Ot)*8&&(kt=Ot);let Dt=[];for(const Ot of vt){lt(Ot.mode.modeBits,4,Dt),lt(Ot.numChars,Ot.mode.numCharCountBits(At),Dt);for(const Qt of Ot.getData())Dt.push(Qt)}dt(Dt.length==$t);const Ft=Qe.getNumDataCodewords(At,kt)*8;dt(Dt.length<=Ft),lt(0,Math.min(4,Ft-Dt.length),Dt),lt(0,(8-Dt.length%8)%8,Dt),dt(Dt.length%8==0);for(let Ot=236;Dt.length<Ft;Ot^=253)lt(Ot,8,Dt);let Bt=[];for(;Bt.length*8<Dt.length;)Bt.push(0);return Dt.forEach((Ot,Qt)=>Bt[Qt>>>3]|=Ot<<7-(Qt&7)),new Qe(At,kt,Bt,Mt)}getModule(vt,kt){return 0<=vt&&vt<this.size&&0<=kt&&kt<this.size&&this.modules[kt][vt]}getModules(){return this.modules}drawFunctionPatterns(){for(let St=0;St<this.size;St++)this.setFunctionModule(6,St,St%2==0),this.setFunctionModule(St,6,St%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const vt=this.getAlignmentPatternPositions(),kt=vt.length;for(let St=0;St<kt;St++)for(let Tt=0;Tt<kt;Tt++)St==0&&Tt==0||St==0&&Tt==kt-1||St==kt-1&&Tt==0||this.drawAlignmentPattern(vt[St],vt[Tt]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(vt){const kt=this.errorCorrectionLevel.formatBits<<3|vt;let St=kt;for(let Mt=0;Mt<10;Mt++)St=St<<1^(St>>>9)*1335;const Tt=(kt<<10|St)^21522;dt(Tt>>>15==0);for(let Mt=0;Mt<=5;Mt++)this.setFunctionModule(8,Mt,ut(Tt,Mt));this.setFunctionModule(8,7,ut(Tt,6)),this.setFunctionModule(8,8,ut(Tt,7)),this.setFunctionModule(7,8,ut(Tt,8));for(let Mt=9;Mt<15;Mt++)this.setFunctionModule(14-Mt,8,ut(Tt,Mt));for(let Mt=0;Mt<8;Mt++)this.setFunctionModule(this.size-1-Mt,8,ut(Tt,Mt));for(let Mt=8;Mt<15;Mt++)this.setFunctionModule(8,this.size-15+Mt,ut(Tt,Mt));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let vt=this.version;for(let St=0;St<12;St++)vt=vt<<1^(vt>>>11)*7973;const kt=this.version<<12|vt;dt(kt>>>18==0);for(let St=0;St<18;St++){const Tt=ut(kt,St),Mt=this.size-11+St%3,Nt=Math.floor(St/3);this.setFunctionModule(Mt,Nt,Tt),this.setFunctionModule(Nt,Mt,Tt)}}drawFinderPattern(vt,kt){for(let St=-4;St<=4;St++)for(let Tt=-4;Tt<=4;Tt++){const Mt=Math.max(Math.abs(Tt),Math.abs(St)),Nt=vt+Tt,At=kt+St;0<=Nt&&Nt<this.size&&0<=At&&At<this.size&&this.setFunctionModule(Nt,At,Mt!=2&&Mt!=4)}}drawAlignmentPattern(vt,kt){for(let St=-2;St<=2;St++)for(let Tt=-2;Tt<=2;Tt++)this.setFunctionModule(vt+Tt,kt+St,Math.max(Math.abs(Tt),Math.abs(St))!=1)}setFunctionModule(vt,kt,St){this.modules[kt][vt]=St,this.isFunction[kt][vt]=!0}addEccAndInterleave(vt){const kt=this.version,St=this.errorCorrectionLevel;if(vt.length!=Qe.getNumDataCodewords(kt,St))throw new RangeError("Invalid argument");const Tt=Qe.NUM_ERROR_CORRECTION_BLOCKS[St.ordinal][kt],Mt=Qe.ECC_CODEWORDS_PER_BLOCK[St.ordinal][kt],Nt=Math.floor(Qe.getNumRawDataModules(kt)/8),At=Tt-Nt%Tt,$t=Math.floor(Nt/Tt);let Dt=[];const Ft=Qe.reedSolomonComputeDivisor(Mt);for(let Ot=0,Qt=0;Ot<Tt;Ot++){let Wt=vt.slice(Qt,Qt+$t-Mt+(Ot<At?0:1));Qt+=Wt.length;const Xt=Qe.reedSolomonComputeRemainder(Wt,Ft);Ot<At&&Wt.push(0),Dt.push(Wt.concat(Xt))}let Bt=[];for(let Ot=0;Ot<Dt[0].length;Ot++)Dt.forEach((Qt,Wt)=>{(Ot!=$t-Mt||Wt>=At)&&Bt.push(Qt[Ot])});return dt(Bt.length==Nt),Bt}drawCodewords(vt){if(vt.length!=Math.floor(Qe.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let kt=0;for(let St=this.size-1;St>=1;St-=2){St==6&&(St=5);for(let Tt=0;Tt<this.size;Tt++)for(let Mt=0;Mt<2;Mt++){const Nt=St-Mt,$t=(St+1&2)==0?this.size-1-Tt:Tt;!this.isFunction[$t][Nt]&&kt<vt.length*8&&(this.modules[$t][Nt]=ut(vt[kt>>>3],7-(kt&7)),kt++)}}dt(kt==vt.length*8)}applyMask(vt){if(vt<0||vt>7)throw new RangeError("Mask value out of range");for(let kt=0;kt<this.size;kt++)for(let St=0;St<this.size;St++){let Tt;switch(vt){case 0:Tt=(St+kt)%2==0;break;case 1:Tt=kt%2==0;break;case 2:Tt=St%3==0;break;case 3:Tt=(St+kt)%3==0;break;case 4:Tt=(Math.floor(St/3)+Math.floor(kt/2))%2==0;break;case 5:Tt=St*kt%2+St*kt%3==0;break;case 6:Tt=(St*kt%2+St*kt%3)%2==0;break;case 7:Tt=((St+kt)%2+St*kt%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[kt][St]&&Tt&&(this.modules[kt][St]=!this.modules[kt][St])}}getPenaltyScore(){let vt=0;for(let Mt=0;Mt<this.size;Mt++){let Nt=!1,At=0,$t=[0,0,0,0,0,0,0];for(let Dt=0;Dt<this.size;Dt++)this.modules[Mt][Dt]==Nt?(At++,At==5?vt+=Qe.PENALTY_N1:At>5&&vt++):(this.finderPenaltyAddHistory(At,$t),Nt||(vt+=this.finderPenaltyCountPatterns($t)*Qe.PENALTY_N3),Nt=this.modules[Mt][Dt],At=1);vt+=this.finderPenaltyTerminateAndCount(Nt,At,$t)*Qe.PENALTY_N3}for(let Mt=0;Mt<this.size;Mt++){let Nt=!1,At=0,$t=[0,0,0,0,0,0,0];for(let Dt=0;Dt<this.size;Dt++)this.modules[Dt][Mt]==Nt?(At++,At==5?vt+=Qe.PENALTY_N1:At>5&&vt++):(this.finderPenaltyAddHistory(At,$t),Nt||(vt+=this.finderPenaltyCountPatterns($t)*Qe.PENALTY_N3),Nt=this.modules[Dt][Mt],At=1);vt+=this.finderPenaltyTerminateAndCount(Nt,At,$t)*Qe.PENALTY_N3}for(let Mt=0;Mt<this.size-1;Mt++)for(let Nt=0;Nt<this.size-1;Nt++){const At=this.modules[Mt][Nt];At==this.modules[Mt][Nt+1]&&At==this.modules[Mt+1][Nt]&&At==this.modules[Mt+1][Nt+1]&&(vt+=Qe.PENALTY_N2)}let kt=0;for(const Mt of this.modules)kt=Mt.reduce((Nt,At)=>Nt+(At?1:0),kt);const St=this.size*this.size,Tt=Math.ceil(Math.abs(kt*20-St*10)/St)-1;return dt(0<=Tt&&Tt<=9),vt+=Tt*Qe.PENALTY_N4,dt(0<=vt&&vt<=2568888),vt}getAlignmentPatternPositions(){if(this.version==1)return[];{const vt=Math.floor(this.version/7)+2,kt=this.version==32?26:Math.ceil((this.version*4+4)/(vt*2-2))*2;let St=[6];for(let Tt=this.size-7;St.length<vt;Tt-=kt)St.splice(1,0,Tt);return St}}static getNumRawDataModules(vt){if(vt<Qe.MIN_VERSION||vt>Qe.MAX_VERSION)throw new RangeError("Version number out of range");let kt=(16*vt+128)*vt+64;if(vt>=2){const St=Math.floor(vt/7)+2;kt-=(25*St-10)*St-55,vt>=7&&(kt-=36)}return dt(208<=kt&&kt<=29648),kt}static getNumDataCodewords(vt,kt){return Math.floor(Qe.getNumRawDataModules(vt)/8)-Qe.ECC_CODEWORDS_PER_BLOCK[kt.ordinal][vt]*Qe.NUM_ERROR_CORRECTION_BLOCKS[kt.ordinal][vt]}static reedSolomonComputeDivisor(vt){if(vt<1||vt>255)throw new RangeError("Degree out of range");let kt=[];for(let Tt=0;Tt<vt-1;Tt++)kt.push(0);kt.push(1);let St=1;for(let Tt=0;Tt<vt;Tt++){for(let Mt=0;Mt<kt.length;Mt++)kt[Mt]=Qe.reedSolomonMultiply(kt[Mt],St),Mt+1<kt.length&&(kt[Mt]^=kt[Mt+1]);St=Qe.reedSolomonMultiply(St,2)}return kt}static reedSolomonComputeRemainder(vt,kt){let St=kt.map(Tt=>0);for(const Tt of vt){const Mt=Tt^St.shift();St.push(0),kt.forEach((Nt,At)=>St[At]^=Qe.reedSolomonMultiply(Nt,Mt))}return St}static reedSolomonMultiply(vt,kt){if(vt>>>8||kt>>>8)throw new RangeError("Byte out of range");let St=0;for(let Tt=7;Tt>=0;Tt--)St=St<<1^(St>>>7)*285,St^=(kt>>>Tt&1)*vt;return dt(St>>>8==0),St}finderPenaltyCountPatterns(vt){const kt=vt[1];dt(kt<=this.size*3);const St=kt>0&&vt[2]==kt&&vt[3]==kt*3&&vt[4]==kt&&vt[5]==kt;return(St&&vt[0]>=kt*4&&vt[6]>=kt?1:0)+(St&&vt[6]>=kt*4&&vt[0]>=kt?1:0)}finderPenaltyTerminateAndCount(vt,kt,St){return vt&&(this.finderPenaltyAddHistory(kt,St),kt=0),kt+=this.size,this.finderPenaltyAddHistory(kt,St),this.finderPenaltyCountPatterns(St)}finderPenaltyAddHistory(vt,kt){kt[0]==0&&(vt+=this.size),kt.pop(),kt.unshift(vt)}};let it=Qe;it.MIN_VERSION=1,it.MAX_VERSION=40,it.PENALTY_N1=3,it.PENALTY_N2=3,it.PENALTY_N3=40,it.PENALTY_N4=10,it.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],it.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],He.QrCode=it;function lt(vt,kt,St){if(kt<0||kt>31||vt>>>kt)throw new RangeError("Value out of range");for(let Tt=kt-1;Tt>=0;Tt--)St.push(vt>>>Tt&1)}function ut(vt,kt){return(vt>>>kt&1)!=0}function dt(vt){if(!vt)throw new Error("Assertion error")}const xt=class{constructor(vt,kt,St){if(this.mode=vt,this.numChars=kt,this.bitData=St,kt<0)throw new RangeError("Invalid argument");this.bitData=St.slice()}static makeBytes(vt){let kt=[];for(const St of vt)lt(St,8,kt);return new xt(xt.Mode.BYTE,vt.length,kt)}static makeNumeric(vt){if(!xt.isNumeric(vt))throw new RangeError("String contains non-numeric characters");let kt=[];for(let St=0;St<vt.length;){const Tt=Math.min(vt.length-St,3);lt(parseInt(vt.substr(St,Tt),10),Tt*3+1,kt),St+=Tt}return new xt(xt.Mode.NUMERIC,vt.length,kt)}static makeAlphanumeric(vt){if(!xt.isAlphanumeric(vt))throw new RangeError("String contains unencodable characters in alphanumeric mode");let kt=[],St;for(St=0;St+2<=vt.length;St+=2){let Tt=xt.ALPHANUMERIC_CHARSET.indexOf(vt.charAt(St))*45;Tt+=xt.ALPHANUMERIC_CHARSET.indexOf(vt.charAt(St+1)),lt(Tt,11,kt)}return St<vt.length&&lt(xt.ALPHANUMERIC_CHARSET.indexOf(vt.charAt(St)),6,kt),new xt(xt.Mode.ALPHANUMERIC,vt.length,kt)}static makeSegments(vt){return vt==""?[]:xt.isNumeric(vt)?[xt.makeNumeric(vt)]:xt.isAlphanumeric(vt)?[xt.makeAlphanumeric(vt)]:[xt.makeBytes(xt.toUtf8ByteArray(vt))]}static makeEci(vt){let kt=[];if(vt<0)throw new RangeError("ECI assignment value out of range");if(vt<128)lt(vt,8,kt);else if(vt<16384)lt(2,2,kt),lt(vt,14,kt);else if(vt<1e6)lt(6,3,kt),lt(vt,21,kt);else throw new RangeError("ECI assignment value out of range");return new xt(xt.Mode.ECI,0,kt)}static isNumeric(vt){return xt.NUMERIC_REGEX.test(vt)}static isAlphanumeric(vt){return xt.ALPHANUMERIC_REGEX.test(vt)}getData(){return this.bitData.slice()}static getTotalBits(vt,kt){let St=0;for(const Tt of vt){const Mt=Tt.mode.numCharCountBits(kt);if(Tt.numChars>=1<<Mt)return 1/0;St+=4+Mt+Tt.bitData.length}return St}static toUtf8ByteArray(vt){vt=encodeURI(vt);let kt=[];for(let St=0;St<vt.length;St++)vt.charAt(St)!="%"?kt.push(vt.charCodeAt(St)):(kt.push(parseInt(vt.substr(St+1,2),16)),St+=2);return kt}};let ft=xt;ft.NUMERIC_REGEX=/^[0-9]*$/,ft.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,ft.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",He.QrSegment=ft})(qrcodegen||(qrcodegen={}));(He=>{(Qe=>{const it=class{constructor(ut,dt){this.ordinal=ut,this.formatBits=dt}};let lt=it;lt.LOW=new it(0,1),lt.MEDIUM=new it(1,0),lt.QUARTILE=new it(2,3),lt.HIGH=new it(3,2),Qe.Ecc=lt})(He.QrCode||(He.QrCode={}))})(qrcodegen||(qrcodegen={}));(He=>{(Qe=>{const it=class{constructor(ut,dt){this.modeBits=ut,this.numBitsCharCount=dt}numCharCountBits(ut){return this.numBitsCharCount[Math.floor((ut+7)/17)]}};let lt=it;lt.NUMERIC=new it(1,[10,12,14]),lt.ALPHANUMERIC=new it(2,[9,11,13]),lt.BYTE=new it(4,[8,16,16]),lt.KANJI=new it(8,[8,10,12]),lt.ECI=new it(7,[0,0,0]),Qe.Mode=lt})(He.QrSegment||(He.QrSegment={}))})(qrcodegen||(qrcodegen={}));var qrcodegen_default=qrcodegen;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var ERROR_LEVEL_MAP={L:qrcodegen_default.QrCode.Ecc.LOW,M:qrcodegen_default.QrCode.Ecc.MEDIUM,Q:qrcodegen_default.QrCode.Ecc.QUARTILE,H:qrcodegen_default.QrCode.Ecc.HIGH},DEFAULT_SIZE$1=128,DEFAULT_LEVEL="L",DEFAULT_BGCOLOR="#FFFFFF",DEFAULT_FGCOLOR="#000000",DEFAULT_INCLUDEMARGIN=!1,MARGIN_SIZE=4,DEFAULT_IMG_SCALE=.1;function generatePath(He,Qe=0){const it=[];return He.forEach(function(lt,ut){let dt=null;lt.forEach(function(xt,ft){if(!xt&&dt!==null){it.push(`M${dt+Qe} ${ut+Qe}h${ft-dt}v1H${dt+Qe}z`),dt=null;return}if(ft===lt.length-1){if(!xt)return;dt===null?it.push(`M${ft+Qe},${ut+Qe} h1v1H${ft+Qe}z`):it.push(`M${dt+Qe},${ut+Qe} h${ft+1-dt}v1H${dt+Qe}z`);return}xt&&dt===null&&(dt=ft)})}),it.join("")}function excavateModules(He,Qe){return He.slice().map((it,lt)=>lt<Qe.y||lt>=Qe.y+Qe.h?it:it.map((ut,dt)=>dt<Qe.x||dt>=Qe.x+Qe.w?ut:!1))}function getImageSettings(He,Qe,it,lt){if(lt==null)return null;const ut=it?MARGIN_SIZE:0,dt=He.length+ut*2,xt=Math.floor(Qe*DEFAULT_IMG_SCALE),ft=dt/Qe,vt=(lt.width||xt)*ft,kt=(lt.height||xt)*ft,St=lt.x==null?He.length/2-vt/2:lt.x*ft,Tt=lt.y==null?He.length/2-kt/2:lt.y*ft;let Mt=null;if(lt.excavate){let Nt=Math.floor(St),At=Math.floor(Tt),$t=Math.ceil(vt+St-Nt),Dt=Math.ceil(kt+Tt-At);Mt={x:Nt,y:At,w:$t,h:Dt}}return{x:St,y:Tt,h:kt,w:vt,excavation:Mt}}var SUPPORTS_PATH2D=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}();function QRCodeCanvas(He){const Qe=He,{value:it,size:lt=DEFAULT_SIZE$1,level:ut=DEFAULT_LEVEL,bgColor:dt=DEFAULT_BGCOLOR,fgColor:xt=DEFAULT_FGCOLOR,includeMargin:ft=DEFAULT_INCLUDEMARGIN,style:vt,imageSettings:kt}=Qe,St=__objRest(Qe,["value","size","level","bgColor","fgColor","includeMargin","style","imageSettings"]),Tt=kt?.src,Mt=reactExports.useRef(null),Nt=reactExports.useRef(null),[At,$t]=reactExports.useState(!1);reactExports.useEffect(()=>{if(Mt.current!=null){const Bt=Mt.current,Ot=Bt.getContext("2d");if(!Ot)return;let Qt=qrcodegen_default.QrCode.encodeText(it,ERROR_LEVEL_MAP[ut]).getModules();const Wt=ft?MARGIN_SIZE:0,Xt=Qt.length+Wt*2,Kt=getImageSettings(Qt,lt,ft,kt),Jt=Nt.current,hr=Kt!=null&&Jt!==null&&Jt.complete&&Jt.naturalHeight!==0&&Jt.naturalWidth!==0;hr&&Kt.excavation!=null&&(Qt=excavateModules(Qt,Kt.excavation));const xr=window.devicePixelRatio||1;Bt.height=Bt.width=lt*xr;const gr=lt/Xt*xr;Ot.scale(gr,gr),Ot.fillStyle=dt,Ot.fillRect(0,0,Xt,Xt),Ot.fillStyle=xt,SUPPORTS_PATH2D?Ot.fill(new Path2D(generatePath(Qt,Wt))):Qt.forEach(function(br,vr){br.forEach(function(yr,Cr){yr&&Ot.fillRect(Cr+Wt,vr+Wt,1,1)})}),hr&&Ot.drawImage(Jt,Kt.x+Wt,Kt.y+Wt,Kt.w,Kt.h)}}),reactExports.useEffect(()=>{$t(!1)},[Tt]);const Dt=__spreadValues({height:lt,width:lt},vt);let Ft=null;return Tt!=null&&(Ft=React.createElement("img",{src:Tt,key:Tt,style:{display:"none"},onLoad:()=>{$t(!0)},ref:Nt})),React.createElement(React.Fragment,null,React.createElement("canvas",__spreadValues({style:Dt,height:lt,width:lt,ref:Mt},St)),Ft)}function QRCodeSVG(He){const Qe=He,{value:it,size:lt=DEFAULT_SIZE$1,level:ut=DEFAULT_LEVEL,bgColor:dt=DEFAULT_BGCOLOR,fgColor:xt=DEFAULT_FGCOLOR,includeMargin:ft=DEFAULT_INCLUDEMARGIN,imageSettings:vt}=Qe,kt=__objRest(Qe,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]);let St=qrcodegen_default.QrCode.encodeText(it,ERROR_LEVEL_MAP[ut]).getModules();const Tt=ft?MARGIN_SIZE:0,Mt=St.length+Tt*2,Nt=getImageSettings(St,lt,ft,vt);let At=null;vt!=null&&Nt!=null&&(Nt.excavation!=null&&(St=excavateModules(St,Nt.excavation)),At=React.createElement("image",{xlinkHref:vt.src,height:Nt.h,width:Nt.w,x:Nt.x+Tt,y:Nt.y+Tt,preserveAspectRatio:"none"}));const $t=generatePath(St,Tt);return React.createElement("svg",__spreadValues({height:lt,width:lt,viewBox:`0 0 ${Mt} ${Mt}`},kt),React.createElement("path",{fill:dt,d:`M0,0 h${Mt}v${Mt}H0z`,shapeRendering:"crispEdges"}),React.createElement("path",{fill:xt,d:$t,shapeRendering:"crispEdges"}),At)}var QRCode=He=>{const Qe=He,{renderAs:it}=Qe,lt=__objRest(Qe,["renderAs"]);return it==="svg"?React.createElement(QRCodeSVG,__spreadValues({},lt)):React.createElement(QRCodeCanvas,__spreadValues({},lt))};const icBaselineOpenInNew=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 19H5V5h7V3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83l1.41 1.41L19 6.41V10h2V3h-7z"})}),log$2=debug("pixai:payment:paypay"),PaymentDialogContentPayPay=({onSucceeded:He,onFailed:Qe,...it})=>{const[lt,ut]=reactExports.useState(null),{error:dt}=useAsync(async()=>{const xt=await executeIntentToPay({itemId:it.oneTimeMembership?.id??it.itemId,interval:it.interval,opt:{provider:PaymentProvider.paypay,currency:Currency.Jpy,redirect:typeof it.redirect=="string"?it.redirect:it.redirect?.(),couponCode:it.couponCode,shouldDiscount:it.shouldDiscount}}),ft=xt.data?.intentToPay?.url;if(!ft)throw new Error("URL not found");const vt=xt.data?.intentToPay?.orderId;if(!vt)throw new Error("Order ID not found");const kt=new URL(ft);ut({orderId:vt,revenueInfo:xt.data?.intentToPay?.revenueInfo,...xt.data?.intentToPay?.codeId?{mode:"inline-qrcode",content:ft}:kt.searchParams.has("code")?{mode:"inline-qrcode",content:kt.searchParams.get("code")}:{mode:"redirect",url:ft}}),it.trackingFnAfterFetch?.()});return reactExports.useEffect(()=>{dt&&(log$2("Failed to fetch payment configuration",dt),Qe?.(dt))},[dt]),jsxRuntimeExports.jsx("div",{className:"rounded-lg flex items-center justify-center size-full bg-white",children:$$3(lt).with(null,()=>jsxRuntimeExports.jsx("div",{className:"py-8 size-full text-black/75 flex justify-center text-sm select-none",children:jsxRuntimeExports.jsx(mdiLoading,{className:"size-6 animate-spin"})})).with({mode:"inline-qrcode"},xt=>jsxRuntimeExports.jsx(PaymentDialogContentPayPayQRCode,{config:xt,onSucceeded:()=>He?.({revenueInfo:xt.revenueInfo,orderId:xt.orderId,finalizedPaymentProvider:PaymentProvider.paypay}),onFailed:Qe})).with({mode:"redirect"},xt=>jsxRuntimeExports.jsx(PaymentDialogContentPayPayRedirect,{config:xt,onSucceeded:()=>He?.({revenueInfo:xt.revenueInfo,orderId:xt.orderId,finalizedPaymentProvider:PaymentProvider.paypay}),onFailed:Qe})).exhaustive()})},PaymentDialogContentPayPayQRCode=({config:He,onSucceeded:Qe,onFailed:it})=>{const{t:lt}=useTranslation(["membership"]),{data:ut}=useGetOrderById(He.orderId);reactExports.useEffect(()=>{ut?.status==="completed"?(log$2("Payment completed",ut),Qe?.()):ut?.status==="cancelled"?(log$2("Payment cancelled",ut),it?.(new Error(lt("membership:payment.cancelled-due-to-timeout")))):ut?.status==="failed"&&(log$2("Payment failed",ut),it?.(new Error(lt("membership:payment.failed-generic"))))},[ut?.status]);const dt=reactExports.useMemo(()=>{const xt=new URL(He.content);if(xt.hostname==="www.paypay.ne.jp"&&xt.pathname==="/app/cashier"){const ft=xt.searchParams.get("code");if(ft)return ft}return xt.toString()},[He.content]);return jsxRuntimeExports.jsxs("div",{className:"p-8 flex flex-col items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"size-32 bg-gray-100 relative",children:[jsxRuntimeExports.jsx(QRCodeSVG,{value:dt}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:jsxRuntimeExports.jsx(PayPayLogo,{className:"w-6 h-6"})})]}),jsxRuntimeExports.jsx("div",{className:"h-px w-full bg-gray-200"}),jsxRuntimeExports.jsxs("button",{className:"text-sm text-black border-2 border-[#FF0033] rounded px-3 py-2 flex items-center gap-2 font-bold bg-white hover:brightness-95 active:brightness-90 select-none",onClick:()=>window.open(He.content),children:[jsxRuntimeExports.jsx(PayPayLogo,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{className:"leading-none",children:lt("membership:payment.paypay.launch")}),jsxRuntimeExports.jsx(icBaselineOpenInNew,{className:"w-5 h-5 ml-1 text-[#FF0033]"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start text-xs gap-2 opacity-80 mt-4",children:[jsxRuntimeExports.jsx(mdiLoading,{className:"size-4 animate-spin-slow shrink-0"}),jsxRuntimeExports.jsx("span",{children:lt("membership:payment.paypay.pending-payment-completion")})]})]})},PaymentDialogContentPayPayRedirect=({config:He,onSucceeded:Qe,onFailed:it})=>{const{t:lt}=useTranslation(["membership"]),{data:ut}=useGetOrderById(He.orderId);return reactExports.useEffect(()=>{ut?.status==="completed"?(log$2("Payment completed",ut),Qe?.()):ut?.status==="cancelled"?(log$2("Payment cancelled",ut),it?.(new Error(lt("membership:payment.cancelled-due-to-timeout")))):ut?.status==="failed"&&(log$2("Payment failed",ut),it?.(new Error(lt("membership:payment.failed-generic"))))},[ut?.status]),jsxRuntimeExports.jsxs("div",{className:"p-8 flex flex-col items-center gap-4",children:[jsxRuntimeExports.jsxs("button",{className:"text-sm text-black border-2 border-[#FF0033] rounded px-3 py-2 flex items-center gap-2 font-bold bg-white hover:brightness-95 active:brightness-90 select-none",onClick:()=>window.open(He.url),children:[jsxRuntimeExports.jsx(PayPayLogo,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{className:"leading-none",children:lt("membership:payment.paypay.launch")}),jsxRuntimeExports.jsx(icBaselineOpenInNew,{className:"w-5 h-5 ml-1 text-[#FF0033]"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start text-xs gap-2 opacity-80 mt-4",children:[jsxRuntimeExports.jsx(mdiLoading,{className:"size-4 animate-spin-slow shrink-0"}),jsxRuntimeExports.jsx("span",{children:lt("membership:payment.paypay.pending-payment-completion")})]})]})},SUPPORTED_LOCALES={ja:{code:"ja",label:"日本語",currency:Currency.Jpy},en:{code:"en",label:"English",currency:Currency.Usd},kr:{code:"kr",label:"한국어",currency:Currency.Usd},zh:{code:"zh",label:"繁体中文",currency:Currency.Usd},id:{code:"id",label:"Bahasa Indonesia",currency:Currency.Usd},de:{code:"de",label:"Deutsch",currency:Currency.Usd},fr:{code:"fr",label:"Français",currency:Currency.Usd},th:{code:"th",label:"ภาษาไทย",currency:Currency.Usd},vi:{code:"vi",label:"Tiếng Việt",currency:Currency.Usd},it:{code:"it",label:"Italiano",currency:Currency.Usd},uk:{code:"uk",label:"українська мова",currency:Currency.Usd},pl:{code:"pl",label:"Polski",currency:Currency.Usd},es:{code:"es",label:"Español",currency:Currency.Usd},ms:{code:"ms",label:"Bahasa Melayu",currency:Currency.Usd},tr:{code:"tr",label:"Türkçe",currency:Currency.Usd},pt:{code:"pt",label:"Português",currency:Currency.Usd}},resources={en:{auth:enAuth,common:enCommon,action:enAction,error:enError,manga:enManga,artwork:enArtwork,user:enUser,comment:enComment,market:enMarket,growth:enGrowth,generation:enGeneration,membership:enMembership,workflow:enWorkflow,platform:enPlatform,worlds:enWorlds},ja:{auth:jaAuth,common:jaCommon,action:jaAction,error:jaError,artwork:jaArtwork,user:jaUser,comment:jaComment,market:jaMarket,growth:jaGrowth,generation:jaGeneration,membership:jaMembership,worlds:jaWorlds}},simpleLocalizeLoadPathPrefix="https://cdn.simplelocalize.io/f3353c72ee48433ba07d0cc8b0973612/_latest",loadPath=([He],[Qe])=>`${simpleLocalizeLoadPathPrefix}/${He==="zh"?"zh_tw":He}/${Qe}`,i18n=createInstance();i18n.use(Backend).use(Browser).use(initReactI18next).init({load:"languageOnly",backend:{backends:[Backend$1],backendOptions:[{loadPath}]},detection:{order:["querystring","localStorage","path","navigator"],caches:["localStorage"],lookupQuerystring:"lang",lookupFromPathIndex:0},ns:["action","artwork","auth","comment","common","generation","growth","manga","market","membership","user","workflow","agent"],defaultNS:"common",supportedLngs:Object.keys(SUPPORTED_LOCALES),fallbackLng:{default:["en"]},returnEmptyString:!1,nonExplicitSupportedLngs:!0,debug:!1,interpolation:{escapeValue:!1},react:{bindI18n:"languageChanged"}});i18n.on("initialized",()=>{i18n.resolvedLanguage&&setLocale(i18n.resolvedLanguage)});i18n.on("loaded",He=>{for(const[Qe,it]of Object.entries(He))for(const lt in it){const ut=resources?.[Qe]?.[lt];ut&&i18n.addResourceBundle(Qe,lt,flattenObject(ut),!0,!1)}});document.documentElement.setAttribute("lang",i18n.resolvedLanguage);i18n.on("languageChanged",He=>{document.documentElement.setAttribute("lang",i18n.resolvedLanguage)});const useGetMyPreferences=modifyQueryHook(createQueryHook(GetMyPreferencesDocument),{reduce:He=>He?.me?.preferences}),useMyPreferences=He=>{const Qe=useCheckTokenForArgs({});return useGetMyPreferences(Qe??skipToken,He)},updateGetMyPreferences=He=>{cache$1.updateQuery({query:GetMyPreferencesDocument},produce(Qe=>{const it=Qe?.me;it!=null&&(it.preferences={...it.preferences,...He})}))},[useSetPreferences,executeSetPreferences]=createMutationHelper(SetPreferencesDocument),DEFAULT_LOCALE="en",store$4=getDefaultStore(),localeAtom=atom(DEFAULT_LOCALE),setLocale=He=>store$4.set(localeAtom,He);store$4.sub(localeAtom,async()=>{const He=store$4.get(localeAtom);i18n.changeLanguage(He),setLocaleToUrl(He)});async function updateLangPreference(He){getToken()&&await executeSetPreferences({value:{lang:He}})}function resolveLocaleFromUrl(){const He=new URL(window.location.href),Qe=He.searchParams.get("lang"),it=Qe?.toLowerCase(),lt=He.pathname.split("/")[1],ut=lt.toLowerCase();return{query:isSupportedLocale(it)?Qe:void 0,path:isSupportedLocale(ut)?lt:void 0,resolved:isSupportedLocale(it)?it:isSupportedLocale(ut)?ut:void 0}}function setLocaleToUrl(He){if(true){return}const{query:Qe,path:it,resolved:lt}=resolveLocaleFromUrl(),ut=new URL(window.location.href);lt!==He&&(ut.pathname=withBase(withoutBase(ut.pathname,`/${it}`),He===DEFAULT_LOCALE?"":`/${He}`)),window.location.href!==ut.href?window.location.href=ut.href:Qe&&(ut.searchParams.delete("lang"),window.history.replaceState({},"",ut.href))}function isSupportedLocale(He){return typeof He=="string"&&He in SUPPORTED_LOCALES}const currencies=[{code:Currency.Usd,symbol:"$",valueMultiplier:100},{code:Currency.Jpy,symbol:"¥",valueMultiplier:1,preferNarrowRepresentation:!0}],currencyData=Object.fromEntries(currencies.map(He=>[He.code,He]));function formatPrice(He,Qe){if(He&&Qe!=null)return currencyData[He].symbol+Qe.toLocaleString()}const JPY_CURRENCY_EXPERIMENT_NAME="2507-enable-jpy-currency",useCurrency=()=>{const{data:He}=useIPCountry();return useExperimentParam(JPY_CURRENCY_EXPERIMENT_NAME)&&He==="JP"?[Currency.Jpy,noop$6]:[Currency.Usd,noop$6]},useCurrencyDetails=He=>reactExports.useMemo(()=>currencies.find(Qe=>Qe.code===He),[He]),icBaselineChevronLeft=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M15.41 7.41L14 6l-6 6l6 6l1.41-1.41L10.83 12z"})}),icBaselineChevronRight=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10 6L8.59 7.41L13.17 12l-4.58 4.59L10 18l6-6z"})}),icBaselineShoppingCartCheckout=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2s-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2s2-.9 2-2s-.9-2-2-2zm-8.9-5h7.45c.75 0 1.41-.41 1.75-1.03L21 4.96L19.25 4l-3.7 7H8.53L4.27 2H1v2h2l3.6 7.59l-1.35 2.44C4.52 15.37 5.48 17 7 17h12v-2H7l1.1-2zM12 2l4 4l-4 4l-1.41-1.41L12.17 7H8V5h4.17l-1.59-1.59L12 2z"})}),icRoundLock=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2s2 .9 2 2s-.9 2-2 2zM9 8V6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9z"})}),icTwotoneError=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 4c-4.42 0-8 3.58-8 8s3.58 8 8 8s8-3.58 8-8s-3.58-8-8-8zm1 13h-2v-2h2v2zm0-4h-2V7h2v6z",opacity:.3}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8s8 3.58 8 8s-3.58 8-8 8zm-1-5h2v2h-2zm0-8h2v6h-2z"})]}),icTwotonePayment=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M4 6h16v2H4zm0 6h16v6H4z",opacity:.3}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"})]}),PAYMENT_PROVIDERS=[{id:PaymentProvider.onerway,name:"Credit/Debit Card",supportedCurrencies:[Currency.Usd],icon:jsxRuntimeExports.jsx(icTwotonePayment,{className:"w-5 h-5"}),available:!0},{id:PaymentProvider.paypay,name:"PayPay",supportedCurrencies:[Currency.Jpy],icon:jsxRuntimeExports.jsx(PayPayLogo,{className:"w-5 h-5"}),available:({country:He})=>He==="JP",preferred:!0}],PaymentMethodSelectItem=({id:He,header:Qe,badge:it,onClick:lt})=>{const ut=PAYMENT_PROVIDERS.find(xt=>xt.id===He);if(!ut)return null;const dt=Qe?"h2":"button";return jsxRuntimeExports.jsxs(dt,{className:clsx$1("flex items-center gap-1 text-white text-left select-none",!Qe&&"p-3 bg-neutral-800 tracking-tight hover:brightness-110 active:brightness-95 transition duration-100 border-neutral-700 [&:not(:last-child)]:border-b"),onClick:lt,children:[jsxRuntimeExports.jsx("div",{className:clsx$1("flex items-center justify-center",Qe?"size-5":"size-8"),children:ut.icon}),jsxRuntimeExports.jsxs("div",{className:clsx$1("flex-1 flex items-center gap-1",Qe&&"text-sm font-bold"),children:[jsxRuntimeExports.jsx("span",{children:ut.name}),!Qe&&it&&jsxRuntimeExports.jsx("div",{className:"bg-purple-500 rounded-sm leading-none px-1 py-0.5 text-[10px] shadow-sm",children:it})]}),!Qe&&jsxRuntimeExports.jsx("div",{className:"h-8 w-8 flex items-center justify-center",children:jsxRuntimeExports.jsx(icBaselineChevronRight,{className:"w-6 h-6 opacity-80"})})]})},PaymentDialog=({onSucceeded:He,onFailed:Qe,...it})=>{const[lt,ut]=reactExports.useState(!0),[dt,xt]=reactExports.useState(null),{data:ft,isLoading:vt}=useIPCountry(),{t:kt}=useTranslation(["membership"]),St=reactExports.useMemo(()=>{if(vt||!ft)return[];const $t=PAYMENT_PROVIDERS.filter(Wt=>typeof Wt.available=="function"?Wt.available({country:ft}):Wt.available),Dt=it.paymentProvider?.preferred?.provider??$t.find(Wt=>Wt.preferred)?.id,Ft=it.paymentProvider.allowed,Bt=$t.map(Wt=>Wt.id),Qt=(Ft==="any"?Bt:Ft).filter(Wt=>Bt.includes(Wt)).map(Wt=>({provider:Wt,preferred:Wt===Dt}));return Qt.sort((Wt,Xt)=>Wt.preferred&&!Xt.preferred?-1:!Wt.preferred&&Xt.preferred?1:Bt.indexOf(Wt.provider)-Bt.indexOf(Xt.provider)),Qt},[it.paymentProvider.allowed,it.paymentProvider.preferred?.provider,ft,vt]),Tt=(()=>{if(!dt)return null;if(dt===PaymentProvider.paypay)return{currency:Currency.Jpy,amount:it.prices?.[Currency.Jpy]};const $t=it.currency??Currency.Usd,Dt=it.prices?.[$t];return Dt===void 0?null:{currency:it.currency,amount:Dt}})(),Mt=St.length===1;reactExports.useEffect(()=>{Mt&&xt(St[0].provider)},[Mt]);const Nt=()=>{ut(!1),setTimeout(()=>{Qe?.(UserCancelled)},150)},At=vt?jsxRuntimeExports.jsx(mdiLoading,{className:"w-8 h-8 animate-spin my-16 mx-auto text-white"}):St.length===0?jsxRuntimeExports.jsxs("div",{className:"px-4 py-8 flex flex-col items-start gap-1 border border-white text-white rounded-lg",children:[jsxRuntimeExports.jsx(icTwotoneError,{className:"w-12 h-12 mb-2 opacity-70"}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold",children:kt("membership:payment.no-available-providers.title")}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:kt("membership:payment.no-available-providers.description")})]}):dt===null?jsxRuntimeExports.jsx("div",{className:"grid overflow-hidden rounded-lg shadow-lg",children:St.map(({provider:$t,preferred:Dt})=>jsxRuntimeExports.jsx(PaymentMethodSelectItem,{id:$t,badge:Dt?kt("membership:payment.recommended"):void 0,onClick:()=>xt($t)},$t))}):jsxRuntimeExports.jsxs("div",{className:"grid gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-white h-6",children:[jsxRuntimeExports.jsxs("button",{disabled:Mt,className:clsx$1("inline-flex items-center gap-1 text-lg opacity-80 transition duration-100 group",!Mt&&"-ml-5 hover:opacity-100 active:opacity-70"),onClick:()=>xt(null),children:[jsxRuntimeExports.jsx(icBaselineChevronLeft,{className:clsx$1("h-4 w-4",Mt?"hidden":"opacity-50 group-focus:opacity-100 group-hover:opacity-100")}),jsxRuntimeExports.jsx(PaymentMethodSelectItem,{id:dt,header:!0})]}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),Tt&&jsxRuntimeExports.jsx("div",{className:"font-bold tabular-nums text-sm opacity-80 tracking-wide px-2 leading-6 rounded-lg bg-zinc-800 select-none",children:formatPrice(Tt.currency,Tt.amount)})]}),dt===PaymentProvider.onerway&&jsxRuntimeExports.jsx(PaymentDialogContentOnerway,{...it,onSucceeded:He,onFailed:Qe}),dt===PaymentProvider.paypay&&jsxRuntimeExports.jsx(PaymentDialogContentPayPay,{...it,onSucceeded:He,onFailed:Qe})]});return jsxRuntimeExports.jsx($f3f84453ead64de5$export$8948f78d83984c69,{isOpen:lt,onOpenChange:$t=>{$t||Nt()},isKeyboardDismissDisabled:!0,className:cx("fixed inset-0 z-[1400] bg-black/90 backdrop-blur-md select-none","!duration-150","entering:animate-in","entering:fade-in","exiting:animate-out","exiting:fade-out"),children:jsxRuntimeExports.jsx($f3f84453ead64de5$export$2b77a92f1a5ad772,{className:cx("fixed inset-0 z-[1400] grid gap-3 place-content-center w-[300px] sm:w-[420px] md:w-[500px] mx-auto","entering:animate-in","entering:slide-in-from-bottom-4","entering:fade-in","entering:duration-300","exiting:animate-out","exiting:slide-out-to-bottom-4","exiting:fade-out","exiting:duration-150"),children:jsxRuntimeExports.jsxs($de32f1b87079253c$export$3ddf2d174ce01153,{className:"outline-none",children:[jsxRuntimeExports.jsxs("div",{className:"flex text-white items-center text-sm select-none",children:[jsxRuntimeExports.jsx("span",{className:"opacity-80",children:jsxRuntimeExports.jsx(icBaselineShoppingCartCheckout,{className:"w-5 h-5"})}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx("button",{onClick:()=>{Nt()},className:"text-white bg-zinc-600 disabled:bg-black/50 ring-1 ring-black/20 p-1 hover:brightness-90 active:brightness-75 rounded-full",children:jsxRuntimeExports.jsx(icBaselineClose,{className:"w-4 h-4"})})]}),At,jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-center gap-2 mt-4 opacity-60 text-white text-sm select-none",children:[jsxRuntimeExports.jsx(icRoundLock,{className:"size-4 shrink-0"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2 items-start",children:[jsxRuntimeExports.jsx("h2",{className:"font-bold leading-4",children:kt("membership:plans-page.promotion.secure-payments.title")}),jsxRuntimeExports.jsx("p",{className:"text-neutral-200",children:kt("membership:plans-page.promotion.secure-payments.description")})]})]})]})})})};async function openPaymentDialog(He){return new Promise((Qe,it)=>{const lt=dynamicCreateElement(jsxRuntimeExports.jsx(PaymentDialog,{...He,onSucceeded:ut=>{Qe(ut),lt()},onFailed:ut=>{it(ut),lt()}}),"payment-dialog")})}function mergeCurrencies(He,Qe){return Qe?He.map(it=>({...it,...Qe.find(lt=>lt.currency===it.currency)})):He}function mapPlanPrices(He,Qe){return Object.fromEntries(He.map(({interval:it,currencies:lt})=>[it,Object.fromEntries((it==="MONTH"?mergeCurrencies(lt,Qe):lt).map(ut=>priceMapFnForMembershipPlans(ut,it)))]))}function useMembershipPlans(He){const{data:Qe}=useGetAllPaymentItems({couponCode:He?.discountedMonthlyPrices?void 0:He?.couponCode});return reactExports.useMemo(()=>compact(Qe?.map(it=>a$3({type:PaymentItemType.Plan,tier:N$4.number},it)?{id:it.id,planId:it.planId,tier:it.tier,privileges:it.privilege,prices:mapPlanPrices(it.prices,He?.discountedMonthlyPrices?.[it.id]?.currencies),oneTimeMembership:(()=>{const lt=Qe.find(ut=>ut.planId===it.id&&ut.tier===it.tier);if(!(!lt||!lt.tier))return{id:lt.id,tier:lt.tier,privileges:lt.privilege,prices:mapPlanPrices(lt.prices,He?.discountedMonthlyPrices?.[it.id]?.currencies)}})()}:null)),[He?.discountedMonthlyPrices,Qe])}function priceMapFnForMembershipPlans(He,Qe){const it=normalizePrice(He),lt=normalizePrice({amount:He.originalAmount||He.amount,by:He.by}),ut=Qe===Interval.Month?{perMonth:it,perYear:it,perMonthOriginal:lt,perYearOriginal:lt*12,perWeek:it/4,perDay:it/30}:{perMonth:normalizePriceForYearPlan({amount:it,by:He.by,per:"month"}),perWeek:normalizePriceForYearPlan({amount:it,by:He.by,per:"week"}),perDay:normalizePriceForYearPlan({amount:it,by:He.by,per:"day"}),perYear:it,perMonthOriginal:normalizePriceForYearPlan({amount:lt,by:He.by,per:"month"}),perYearOriginal:lt};return[He.currency,ut]}function useMembershipPlan(He){const Qe=useMembershipPlans();if(He)return Qe.find(it=>typeof He=="number"?it.tier===He:it.id===He||it.planId===He)}function useMembershipExtraPackages(He){const{data:Qe,previousData:it}=useGetAllPaymentItems({}),lt=Qe??it,ut=useMembershipPlan(He);return reactExports.useMemo(()=>{const dt=lt?.filter(xt=>xt.type===PaymentItemType.ExtraPackage)??[];if(dt.length>0)return dt.map(xt=>({id:xt.id,values:xt.values?.map(ft=>({tier:ft.tier,value:ft.value,creditsAfterBoosts:ft.creditsAfterBoosts,boosts:ft.extraPackageBoosts}))??[],prices:Object.fromEntries(xt.prices[0].currencies.map(ft=>[ft.currency,normalizePrice(ft)])),oneTimePurchase:xt.oneTimePurchase,monthlyPurchase:xt.monthlyPurchase,extraPackageBoosts:xt.values?.find(ft=>ft.tier===ut?.tier)?.extraPackageBoosts??xt.values?.find(ft=>ft.tier===0)?.extraPackageBoosts}))},[lt,ut])}function normalizePrice({amount:He,by:Qe}){return He/Qe}function normalizePriceForYearPlan({amount:He,by:Qe,per:it}){const lt=$$3(it).with("day",()=>365).with("month",()=>12).otherwise(()=>52);return round(He/lt,Math.log10(Qe))}function useMembershipActions(){const He=useMembershipExtraPackages(),{data:{membership:Qe,subscription:it}={}}=useMyMembership(),{isUnknownProvider:lt}=useSubscriptionInfo(),{data:ut}=useUserInfo(),[dt]=useCurrency(),xt=useMatches(),ft=useNavigate(),{t:vt}=useTranslation(["membership","user","action"]);return reactExports.useMemo(()=>({async subscribe(kt){if(lt)return;const{planId:St=missingArgumentError("planId"),interval:Tt=missingArgumentError("interval"),oneTimeMembership:Mt}=kt,Nt=$$3({wasActive:kt.isActive,tierDiff:kt.tier-(Qe?.tier??Number.NaN),subscription:it}).with({tierDiff:Number.NaN},()=>"subscribe").with({tierDiff:0,wasActive:!1},()=>"resubscribe").with({tierDiff:0,wasActive:!0},()=>"extend").with({tierDiff:N$4.number.positive()},()=>"upgrade").with({tierDiff:N$4.number.negative()},()=>"downgrade").otherwise(()=>null);if(Nt)try{track("begin_checkout",void 0);const{revenueInfo:At,finalizedPaymentProvider:$t}=await openPaymentDialog({itemId:St,oneTimeMembership:Mt,interval:Tt,currency:dt,prices:kt.prices,couponCode:kt.couponCode,paymentProvider:{allowed:"any"},redirect:Bt=>new URL(withQuery("/payment/subscription/landing",{itemId:St,interval:Tt,currency:dt,discountType:kt.trackingOpts?.discountType,price:Bt?.revenue,...kt.extraParamsForSubscribeRedirection}),window.location.origin).toString(),dialogTrackingOpts:{scene:xt.at(-1)?.handle?.name},shouldDiscount:kt.shouldDiscount,afterCancelSurvey:kt.afterCancelSurvey});if(($t===PaymentProvider.braintree||$t===PaymentProvider.onerway||$t===PaymentProvider.paypay)&&kt.isNewSubscribe)return ft(withQuery("/payment/subscription/landing",{itemId:St,interval:Tt,currency:dt}));const Dt=await fetchGetMyMembership({}),Ft=Dt.data.me?.subscription?.status===UserSubscriptionStatus.active;!kt.isNewSubscribe&&Ft&&track("order_payment_success",{type:Tt,cate:Nt,number:kt.tier,price:At?.revenue,currency:dt,preplan:kt.trackingOpts?.upgradeFromTier,provider:$t}),Nt==="resubscribe"?endEventGroup("member_source"):Ft&&ft(withQuery("/payment/subscription/result",{type:Nt,...kt.extraParamsForSubscribeRedirection})),updateGetMyMembership(Dt.data)}catch(At){handlePaymentError(At)}},async unsubscribe(){try{await openCancelSubscriptionDialog(it,Qe?.tier),await executeCancelSubscription({}),await handleChangePlanSuccess(),ft("/payment/subscription/result?type=cancel")}catch(kt){if(kt===UserCancelled)return;handlePaymentError(kt)}},async purchaseExtraPackage(kt,St,Tt){if(!He)return!1;try{const{orderId:Mt,finalizedPaymentProvider:Nt}=await openPaymentDialog({itemId:kt,currency:dt,prices:St,paymentProvider:{allowed:"any"},dialogTrackingOpts:{scene:xt.at(-1)?.handle?.name},trackingFnAfterFetch:()=>{track("refuel_purchase_submitted")},redirect:Tt??joinURL(window.location.origin,"payment/landing")});return track("order_payment_success",{type:"purchase",cate:"refuel",currency:dt,extraPackageId:kt,provider:Nt,price:St[dt]}),{orderId:Mt}}catch(Mt){return Mt!==UserCancelled&&handlePaymentError(Mt),!1}},async resume(){try{await executeResumeSubscription({}),refetchGetMyMembership(),ft("/payment/subscription/result?type=resume")}catch(kt){if(kt===UserCancelled)return;handlePaymentError(kt)}}}),[He,Qe,it,lt,ut,dt,ft,vt,xt])}function useSubscriptionInfo(){const{data:He}=useMyMembership(),Qe=He?.subscription?.status===UserSubscriptionStatus.inactive?void 0:He?.subscription;return reactExports.useMemo(()=>({isActive:Qe?.status===UserSubscriptionStatus.active,isStripe:Qe?.provider===PaymentProvider.stripe,isPaddle:Qe?.provider===PaymentProvider.paddle,isBraintree:Qe?.provider===PaymentProvider.braintree,isOnerway:Qe?.provider===PaymentProvider.onerway,isUnknownProvider:!a$3(N$4.union(PaymentProvider.stripe,PaymentProvider.paddle,PaymentProvider.braintree,PaymentProvider.onerway,PaymentProvider.paypay,N$4.nullish),Qe?.provider),isManageableProvider:!1,isUpgradeDowngradeSupportedProvider:a$3(N$4.union(PaymentProvider.stripe,PaymentProvider.paddle,PaymentProvider.braintree,PaymentProvider.onerway,PaymentProvider.paypay),Qe?.provider),isProviderOnlySupportsOneTimePurchase:a$3(N$4.union(PaymentProvider.onerway,PaymentProvider.paypay),Qe?.provider),isDeprecatedProvider:a$3(N$4.union(PaymentProvider.stripe,PaymentProvider.paddle,PaymentProvider.braintree),Qe?.provider),hasFuturePlan:!!Qe?.futureSubscription?.length}),[Qe])}function useHasOpenedMembershipForExcessiveLoras(){const[He,Qe]=useLocalStorage({key:"growth:last-opened-membership-for-excessive-loras",defaultValue:0}),it=reactExports.useCallback(()=>{Qe(Date.now())},[]);return[reactExports.useMemo(()=>!defaultDayjs(He).isAfter(defaultDayjs().startOf("day")),[He]),it]}const nowAtom=atom(Date.now());let timer,subscribers=0;function subscribe(He){subscribers++,timer==null&&(timer=window.setInterval(()=>{He.set(nowAtom,Date.now())},500))}function unsubscribe(){subscribers--,subscribers===0&&timer!=null&&(window.clearInterval(timer),timer=void 0)}function useNow(He){const Qe=useStore();reactExports.useEffect(()=>(subscribe(Qe),unsubscribe),[Qe]);const it=reactExports.useRef(),lt=reactExports.useMemo(()=>He?atom(ut=>{const dt=He(ut(nowAtom));return isEqual$1(it.current,dt)||(it.current=dt),it.current}):nowAtom,[He]);return useAtomValue(lt)}function useCountdownTimer(He){const Qe=reactExports.useMemo(()=>Date.now()+He,[He]),it=useNow();return reactExports.useMemo(()=>{const lt=Qe-it;return lt<1e3?0:lt},[it,Qe])}const useCampaignAds=modifyQueryHook(createQueryHook(ListCampaignAdsDocument),{reduce:He=>He?.campaignAds});var sdkScriptLocation="https://embed.cloudflarestream.com/embed/sdk.latest.js",safelyAccessStreamSDK=function(){if(!(typeof window>"u"))return window.Stream};function useStreamSDK(){var He=reactExports.useState(safelyAccessStreamSDK),Qe=He[0],it=He[1];return reactExports.useEffect(function(){if(!Qe){var lt=document.querySelector("script[src='"+sdkScriptLocation+"']"),ut=lt??document.createElement("script");ut.addEventListener("load",function(){it(safelyAccessStreamSDK)}),lt||(ut.src=sdkScriptLocation,document.head.appendChild(ut))}},[Qe]),Qe}function useIframeSrc(He,Qe){var it=Qe.muted,lt=Qe.preload,ut=Qe.loop,dt=Qe.autoplay,xt=Qe.controls,ft=Qe.poster,vt=Qe.primaryColor,kt=Qe.letterboxColor,St=Qe.adUrl,Tt=Qe.startTime,Mt=Qe.defaultTextTrack,Nt=Qe.customerCode,At=[ft&&"poster="+encodeURIComponent(ft),St&&"ad-url="+encodeURIComponent(St),Mt&&"defaultTextTrack="+encodeURIComponent(Mt),vt&&"primaryColor="+encodeURIComponent(vt),kt&&"letterboxColor="+encodeURIComponent(kt),Tt&&"startTime="+Tt,it&&"muted=true",lt&&"preload="+lt,ut&&"loop=true",dt&&"autoplay=true",!xt&&"controls=false"].filter(Boolean).join("&"),$t=reactExports.useMemo(function(){return Nt?"https://customer-"+Nt+".cloudflarestream.com/"+He+"?"+At:"https://iframe.cloudflarestream.com/"+He+"?"+At},[]);return $t}function validSrcUrl(He){try{var Qe=new URL(He);return Qe.hostname.endsWith("videodelivery.net")||Qe.hostname.endsWith("cloudflarestream.com")}catch{return!1}}function useProperty(He,Qe,it){reactExports.useEffect(function(){if(Qe.current){var lt=Qe.current;lt[He]=it}},[He,it,Qe])}function useEvent(He,Qe,it){it===void 0&&(it=noop$2),reactExports.useEffect(function(){if(Qe.current){var lt=Qe.current;return lt.addEventListener(He,it),function(){return lt.removeEventListener(He,it)}}},[it,He,Qe])}var noop$2=function(){},Stream=function(Qe){var it=useStreamSDK();return it?React.createElement(StreamEmbed,Object.assign({},Qe)):null},responsiveIframeStyles={position:"absolute",top:0,left:0,right:0,bottom:0,height:"100%",width:"100%"},Container=function(Qe){var it=Qe.children,lt=Qe.responsive,ut=Qe.className,dt=Qe.videoDimensions,xt=dt.videoHeight,ft=dt.videoWidth,vt=reactExports.useMemo(function(){return{position:"relative",paddingTop:ft>0?xt/ft*100+"%":void 0}},[ft,xt]);return React.createElement("div",{className:ut,style:lt?vt:void 0},it)},StreamEmbed=function(Qe){var it=Qe.src,lt=Qe.customerCode,ut=Qe.adUrl,dt=Qe.controls,xt=dt===void 0?!1:dt,ft=Qe.muted,vt=ft===void 0?!1:ft,kt=Qe.autoplay,St=kt===void 0?!1:kt,Tt=Qe.loop,Mt=Tt===void 0?!1:Tt,Nt=Qe.preload,At=Nt===void 0?"metadata":Nt,$t=Qe.primaryColor,Dt=Qe.letterboxColor,Ft=Qe.defaultTextTrack,Bt=Qe.height,Ot=Qe.width,Qt=Qe.poster,Wt=Qe.currentTime,Xt=Wt===void 0?0:Wt,Kt=Qe.volume,Jt=Kt===void 0?1:Kt,hr=Qe.playbackRate,xr=hr===void 0?1:hr,gr=Qe.startTime,br=Qe.streamRef,vr=Qe.responsive,yr=vr===void 0?!0:vr,Cr=Qe.className,Rr=Qe.title,Ir=Qe.onAbort,Tr=Qe.onCanPlay,$r=Qe.onCanPlayThrough,Zr=Qe.onDurationChange,Sr=Qe.onEnded,Dr=Qe.onError,wr=Qe.onLoadedData,qr=Qe.onLoadedMetaData,Nr=Qe.onLoadStart,Jr=Qe.onPause,Qr=Qe.onPlay,Ur=Qe.onPlaying,nn=Qe.onProgress,Cn=Qe.onRateChange,es=Qe.onResize,Xr=Qe.onSeeked,en=Qe.onSeeking,rn=Qe.onStalled,sn=Qe.onSuspend,os=Qe.onTimeUpdate,ls=Qe.onVolumeChange,rs=Qe.onWaiting,ss=Qe.onStreamAdStart,cs=Qe.onStreamAdEnd,ps=Qe.onStreamAdTimeout,hs=reactExports.useRef(),ns=br??hs,tn=reactExports.useState({videoHeight:0,videoWidth:0}),ts=tn[0],as=tn[1],us=reactExports.useRef(null),ds=useIframeSrc(it,{customerCode:lt,muted:vt,preload:At,loop:Mt,autoplay:St,controls:xt,poster:Qt,primaryColor:$t,letterboxColor:Dt,adUrl:ut,defaultTextTrack:Ft,startTime:gr}),gs=validSrcUrl(it)?it:ds;return useProperty("muted",ns,vt),useProperty("controls",ns,xt),useProperty("src",ns,it),useProperty("autoplay",ns,St),useProperty("currentTime",ns,Xt),useProperty("loop",ns,Mt),useProperty("preload",ns,At),useProperty("primaryColor",ns,$t),useProperty("letterboxColor",ns,Dt),useProperty("volume",ns,Jt),useProperty("playbackRate",ns,xr),reactExports.useEffect(function(){var xs=safelyAccessStreamSDK();if(us.current&&xs){var fs=xs(us.current);ns.current=fs;var bs=fs.videoHeight,js=fs.videoWidth;bs&&js&&as({videoHeight:bs,videoWidth:js})}},[]),useEvent("abort",ns,Ir),useEvent("canplay",ns,Tr),useEvent("canplaythrough",ns,$r),useEvent("durationchange",ns,Zr),useEvent("ended",ns,Sr),useEvent("error",ns,Dr),useEvent("loadeddata",ns,wr),useEvent("loadedmetadata",ns,qr),useEvent("loadstart",ns,Nr),useEvent("pause",ns,Jr),useEvent("play",ns,Qr),useEvent("playing",ns,Ur),useEvent("progress",ns,nn),useEvent("ratechange",ns,Cn),useEvent("seeked",ns,Xr),useEvent("seeking",ns,en),useEvent("stalled",ns,rn),useEvent("suspend",ns,sn),useEvent("timeupdate",ns,os),useEvent("volumechange",ns,ls),useEvent("waiting",ns,rs),useEvent("stream-adstart",ns,ss),useEvent("stream-adend",ns,cs),useEvent("stream-adtimeout",ns,ps),useEvent("resize",ns,function(xs){if(ns.current){var fs=ns.current,bs=fs.videoHeight,js=fs.videoWidth;as({videoHeight:bs,videoWidth:js}),es&&es(xs)}}),React.createElement(Container,{className:Cr,responsive:yr,videoDimensions:ts},React.createElement("iframe",{ref:us,src:gs,title:Rr,style:yr?responsiveIframeStyles:void 0,frameBorder:0,height:Bt,width:Ot,allow:"accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;",allowFullScreen:!0}))};const MioImage=He=>{const{expression:Qe,alt:it,...lt}=He,{t:ut}=useTranslation(["common"]),dt=ut("common:resources.miochan",{context:Qe});return jsxRuntimeExports.jsx("img",{src:dt,alt:it??`Mio-chan with expression ${Qe}`,...lt})},Empty=({mioExpression:He,image:Qe,imageClassName:it,description:lt,action:ut,className:dt,...xt})=>jsxRuntimeExports.jsxs("div",{className:cx("w-full p-8 flex flex-col text-[24px] items-center",dt),...xt,children:[Qe===void 0?jsxRuntimeExports.jsx(MioImage,{expression:He??"sad",className:cx(it??"h-72")}):jsxRuntimeExports.jsx("img",{src:Qe,alt:"",className:cx(it??"h-72")}),jsxRuntimeExports.jsx("div",{className:"text-primary-light",children:lt}),ut]}),HlsStream=reactExports.forwardRef(({src:He,...Qe},it)=>{const lt=reactExports.useRef(null),ut=useMergedRef(lt,it),dt=reactExports.useRef(null),xt=reactExports.useRef(null);return reactExports.useEffect(()=>{const ft=lt.current;if(!ft)return;if(ft.canPlayType("application/vnd.apple.mpegurl")){ft.src=He;return}function vt(){Qe.onLoaded?.()}return Hls.isSupported()?(ft.addEventListener("loadeddata",vt),dt.current=new Hls({enableWorker:!0,lowLatencyMode:!0,backBufferLength:0}),dt.current.loadSource(He),dt.current.attachMedia(ft),dt.current.on(Hls.Events.MANIFEST_PARSED,()=>{Qe.autoPlay&&ft.play()}),dt.current.on(Hls.Events.ERROR,(kt,St)=>{if(St.fatal)switch(St.type){case Hls.ErrorTypes.NETWORK_ERROR:dt.current?.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:dt.current?.recoverMediaError();break;default:dt.current?.destroy();break}})):(xt.current="common:error.hls-not-supported",Qe.onLoaded?.()),()=>{ft.removeEventListener("loadeddata",vt),dt.current&&(dt.current.destroy(),dt.current=null)}},[He,Qe.autoPlay,Qe.onLoaded]),xt.current?jsxRuntimeExports.jsx(Empty,{className:"size-full justify-center text-sm",imageClassName:"h-auto",description:jsxRuntimeExports.jsx(Text,{i18nKey:xt.current})}):jsxRuntimeExports.jsx("video",{ref:ut,className:"size-full",style:{maxWidth:"100%",...Qe.style},...Qe})});var TaskStatus=(He=>(He.waiting="waiting",He.running="running",He.completed="completed",He.cancelled="cancelled",He.failed="failed",He))(TaskStatus||{});function isAnimateDiffTask(He){return!!He?.parameters?.animateDiff?.enabled}function isVideoTask(He){return isAnimateDiffTask(He)||isI2vProTask(He)||isT2I2VTask(He)}function isVideoTaskSummary(He){return He?.characteristics?.includes(TaskCharacteristics.AnimatedDiff)||He?.characteristics?.includes(TaskCharacteristics.I2VPro)||He?.characteristics?.includes(TaskCharacteristics.T2I2V)}const isWorkflowTask=a$3({parameters:{workflowId:N$4.string}}),isI2vProTask=a$3({parameters:{i2vPro:N$4.nonNullable}}),isT2I2VTask=a$3({parameters:{t2i2v:N$4.nonNullable}}),isChatTask=a$3({parameters:{chat:N$4.nonNullable}});function getTaskPublishedCount(He){return He?.artworkIds?.length??0}const IPADAPATER_COMPAT_CONTROLNET_METHODS=["dwpose","openpose","openpose_full"],SDXL_COMPAT_CONTROLNET_METHODS=["canny","depth","openpose","openpose_full"],SD3_COMPAT_CONTROLNET_METHODS=[],SD3_COMPAT_SAMPLING_METHODS=["Euler","DDIM"];function isCnetsCompatWithModelType(He,Qe){if(!Qe||isDitV1Model(Qe))return!1;if(isSDV1Model(Qe))return!0;const it=isSD3Model(Qe)?SD3_COMPAT_CONTROLNET_METHODS:isXLModel(Qe)?SDXL_COMPAT_CONTROLNET_METHODS:void 0;return it?He.every(lt=>it.includes(lt.type)):!1}function isCnetsCompatWithIPAdapter(He){return He.every(Qe=>IPADAPATER_COMPAT_CONTROLNET_METHODS.includes(Qe.type))}function getMediaIdsFromTask(He,Qe){return He.status!=="completed"?[]:He.outputs.batch?He.outputs.batch.map(it=>it.mediaId):He.mediaId?[He.mediaId]:[]}function getMediaIdsFromTaskSummary(He,Qe){return He.status!=="completed"?[]:Array.isArray(He.batchMediaIds)&&He.batchMediaIds.length>0?He.batchMediaIds.filter(it=>it!==void 0):He.mediaId?[He.mediaId]:[]}function getMediaIdsFromTaskSummaries(He,Qe){return He.flatMap(it=>getMediaIdsFromTaskSummary(it))}function taskHasFavImages(He){return He?!!(He.favoritedAt||(He.outputs.batch??[]).some(Qe=>!!Qe.favoritedAt)):!1}const emptyHiResParams={upscale:void 0,upscaleDenoisingSteps:void 0,upscaleDenoisingStrength:void 0,upscaleSampler:void 0};function isHiResEnabled(He){return He!=null&&He>1}function getBaseMediaIdFromTask(He){return He?.parameters.mediaId??He?.outputs?.detailParameters?.baseMediaId}function getI18nKeyForI2vModelName(He){return He.replaceAll(".","-")}function isTaskAllowedToPublishAsArtwork(He){return He?!He.parameters?.isPrivate:!1}function isTaskWithPromptHelper(He){return!!(He?.parameters?.promptHelper?.enable||He?.parameters?.promptHelper?.withStage)}const rapiBaseUrl=config$1.rapiUrl,mediaEndpoint=joinURL(rapiBaseUrl,"img","media");function getMediaUrl(He,Qe){if(!He)return;const{isTest:it,isLocal:lt}=getApiEnv();return it||lt?joinURL(getApiUrl(),"v1","media",He,"image"):joinURL(mediaEndpoint,He,Qe)}const getImagePublicUrl=He=>getMediaUrl(He,"orig"),getImageThumbnailUrl=He=>getMediaUrl(He,"thumbnail"),getImageStillThumbnailUrl=He=>getMediaUrl(He,"still_thumbnail"),getPublicUrl=He=>He?.urls?.find(Qe=>Qe.variant==="PUBLIC")?.url,getThumbnailUrl=He=>He?.urls?.find(Qe=>Qe.variant==="THUMBNAIL")?.url,getStillThumbnailUrl=He=>He?.urls?.find(Qe=>Qe.variant==="STILL_THUMBNAIL")?.url,getVideoMediaIdFromTask=He=>isVideoTask(He)?He?.outputs?.videos?.[0]?.mediaId:void 0,getSmartThumbnailUrl=(He,Qe)=>{if(!He)return;const it=getPublicUrl(He),lt=getThumbnailUrl(He);if(it?.includes("public")){const{width:ut}=He,dt=!ut||ut>1e3?"thumbnail":`w=${ut-1}`;return it.replace("public",dt)}return lt},getAspectRatio=He=>He?.width&&He?.height?He.width/He.height:1,downloadMedia=async He=>{if(!He)return;const Qe=getPublicUrl(He);if(!Qe)return;const lt=await(await fetch(Qe)).blob();return new File([lt],He.id,{type:He.imageType})};function shouldMediaBeBlurred(He){return He?.flag?.shouldBlur??!1}const _VideoMedia=reactExports.forwardRef(function(Qe,it){const lt=(({mediaId:vt,src:kt,...St})=>St)(Qe),ut=Qe.src||getMediaUrl(Qe.mediaId,"orig"),dt=reactExports.useRef(null);reactExports.useImperativeHandle(it,()=>dt.current);const xt=reactExports.useCallback(vt=>{const kt=dt.current;Qe.autoPlay==="hover"&&kt?.buffered.length&&kt.play(),Qe.onMouseEnter?.(vt)},[Qe.autoPlay,Qe.onMouseEnter]),ft=reactExports.useCallback(vt=>{const kt=dt.current;Qe.autoPlay==="hover"&&kt?.buffered.length&&(kt.pause(),kt.currentTime=0),Qe.onMouseLeave?.(vt)},[Qe.autoPlay,Qe.onMouseLeave]);return jsxRuntimeExports.jsx("video",{ref:dt,...lt,src:ut,autoPlay:Qe.autoPlay===!0,playsInline:Qe.autoPlay===!0,muted:Qe.autoPlay===!0,loop:!0,disablePictureInPicture:!0,onMouseEnter:xt,onMouseLeave:ft})}),VideoMedia=reactExports.memo(_VideoMedia);function MediaStreamPlayer(He){return $$3(He.mediaType).with(CampaignMediaType.Video,()=>{const{className:Qe,...it}=He.videoMediaProps??{};return jsxRuntimeExports.jsx(VideoMedia,{className:twMerge(He.className,Qe),autoPlay:!0,src:He.mediaSpec,...He.commonProps,...it})}).with(CampaignMediaType.VideoHls,()=>{const{className:Qe,...it}=He.hlsStreamProps??{};return jsxRuntimeExports.jsx(HlsStream,{className:twMerge(He.className,Qe),src:He.mediaSpec,controls:!1,autoPlay:!0,playsInline:!0,muted:!0,loop:!0,...He.commonProps,...it})}).with(CampaignMediaType.VideoStream,()=>{const{className:Qe,...it}=He.streamProps??{};return jsxRuntimeExports.jsx(Stream,{className:twMerge(He.className,Qe),src:He.mediaSpec,controls:!1,autoplay:!0,muted:!0,loop:!0,...He.commonProps,...it})}).otherwise(()=>null)}function AdLabel(He){const{t:Qe}=useTranslation(["growth"]);return jsxRuntimeExports.jsx("div",{className:cx(He.className,"bg-[#F2F2F2]/70 text-[#8F8E90] text-xs rounded-md px-1"),children:Qe("growth:ad-unit.ad-label")})}function AdMedia(He){const[Qe,it]=reactExports.useState(!0),lt=reactExports.useCallback(()=>{it(!1)},[]),ut=He.mediaType!==CampaignMediaType$1.Image&&Qe,dt=He.mediaSpec?He.mediaType===CampaignMediaType$1.Image?jsxRuntimeExports.jsx("img",{className:cx(He.className,"object-contain"),src:He.mediaSpec}):jsxRuntimeExports.jsx(MediaStreamPlayer,{mediaType:He.mediaType,mediaSpec:He.mediaSpec,commonProps:{onCanPlay:lt},className:He.className,videoMediaProps:{className:"object-contain"},hlsStreamProps:{className:"pointer-events-none"},streamProps:{className:"pointer-events-none"}}):null;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[dt,jsxRuntimeExports.jsx(AnimatePresence,{children:ut?jsxRuntimeExports.jsx(motion.div,{className:"absolute inset-0 bg-white/40 flex justify-center items-center",initial:{opacity:0},animate:{opacity:1,transition:{delay:.3,duration:.2,ease:"easeOut"}},exit:{opacity:0,transition:{duration:.125,ease:"easeIn"}},children:jsxRuntimeExports.jsx(Preloader,{})}):null})]})}const trackCampaignClick=He=>track("campaign_click",He);function checkAdUnitConditionWithMembership(He,Qe){if(!He)return!1;if(!Qe?.interval||Qe.status!==UserSubscriptionStatus.active)return!0;const{isShownForMonthlyMember:it,isShownForYearlyMember:lt}=He;return!(Qe.interval===Interval.Month&&!it||Qe.interval===Interval.Year&&!lt)}const useCampaignViewTracker=He=>{const Qe=reactExports.useRef(!1),{ref:it,entry:lt}=useIntersection({rootMargin:"0px",threshold:1});return reactExports.useEffect(()=>{lt?.isIntersecting&&!Qe.current&&(track("campaign_view",He),Qe.current=!0)},[lt?.isIntersecting,He]),it};function DailyQuestAdUnit(He){const{i18n:Qe}=useTranslation(),{data:{subscription:it}={},loading:lt}=useMyMembership(),{data:ut,loading:dt}=useCampaignAds({lang:Qe.language,category:"dailyClaim"}),xt=ut?.find(kt=>checkAdUnitConditionWithMembership(kt,it)),ft={category:"daily_claim",scene:"home",tracking_id:xt?.trackingId},vt=useCampaignViewTracker(ft);return dt||lt?jsxRuntimeExports.jsx("div",{className:"flex size-full aspect-square",children:jsxRuntimeExports.jsx(Preloader,{className:"!my-auto"})}):xt?jsxRuntimeExports.jsxs(Link,{ref:vt,className:"block size-full aspect-square rounded-lg overflow-hidden hover:no-underline",to:xt.targetUrl??"#",target:"_blank",onClick:()=>{trackCampaignClick(ft)},children:[jsxRuntimeExports.jsx(AdMedia,{className:"w-full aspect-square rounded-lg overflow-hidden",mediaType:xt.type,mediaSpec:xt.media}),xt.isAd?jsxRuntimeExports.jsx(AdLabel,{className:"absolute bottom-2 right-2"}):null]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:He.fallback?.()})}let opened=!1,openedInSession=!1;function openQuestDialog(He){opened||(opened=!0,openedInSession=!0,UIDialog.create({dismissable:!0,content:({close:Qe})=>jsxRuntimeExports.jsx(DailyQuestsDialogContent,{trackingProps:He?.trackingProps,onClose:Qe,onClaimed:()=>{He?.afterClaim?.(),He?.closeAfterClaim&&Qe()}}),onClose:()=>{opened=!1,He?.onClose?.()}}))}const useDailyQuestsDialog=He=>{const{data:Qe}=useUserInfo(),it=Qe&&!Qe.deleteAfter,{available:lt}=useDailyClaim(),ut=reactExports.useMemo(()=>debounce(()=>{track("daily_claim_dialog_show"),openQuestDialog({...He,onClose:()=>{He?.onClose?.()}})},200),[He]);reactExports.useEffect(()=>{!it||!lt||document.getElementById("onboarding-dialog-form")||openedInSession||ut()},[lt,ut,it])};function DailyQuestsDialogContent(He){const{t:Qe}=useTranslation(["user","membership"]),it=()=>He.onClose?.(),{data:lt}=useMyMembership(),ut=reactExports.useMemo(()=>lt?.subscription?getSubscriptionState(lt?.subscription):void 0,[lt]),dt=useMembershipExpireDialogState({nearExpire:[0,1,3,7],expired:[0,1,3,7]},ut),xt=jsxRuntimeExports.jsx("span",{className:"font-bold"}),ft=usePaymentMethodAutoRenewable(),{beingMember:vt}=useMe(),{data:kt,previousData:St}=useMyQuota(),Tt=kt??St,{amount:Mt}=useDailyClaim(),Nt=useBreakpoint("msm","up"),At=352;return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("header",{className:"flex justify-between items-start gap-6",children:[jsxRuntimeExports.jsx($5cb03073d3f54797$export$a8a3e93435678ff9,{className:"text-3xl -my-1 font-black",children:jsxRuntimeExports.jsx(Text,{i18nKey:"user:claim-credit-tasks.daily-desc"})}),jsxRuntimeExports.jsxs("div",{className:"-my-1 flex flex-col items-end",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-neutral-500",children:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:generation.credits-balance"})}),jsxRuntimeExports.jsx("span",{className:"text-purple-600",children:jsxRuntimeExports.jsx(CreditMeter,{value:Tt})})]})]}),jsxRuntimeExports.jsx("div",{className:"relative self-center",style:{minWidth:252,width:Nt?"calc(100vw - 96px)":"calc(100vw - 64px)",maxWidth:At},children:$$3(dt).with({type:"none"},()=>jsxRuntimeExports.jsx(DailyQuestAdUnit,{fallback:()=>jsxRuntimeExports.jsx("img",{src:Qe("user:quest.claim-dialog.figure.src"),alt:"",className:"flex-none mx-auto object-scale-down object-center w-full",style:{width:At,maxHeight:At}})})).with({type:"near-expire"},()=>jsxRuntimeExports.jsx("img",{src:Qe("membership:membership.expire-notice.near-expire.image"),alt:"",className:"flex-none mx-auto object-scale-down object-center w-full",style:{width:At,maxHeight:At}})).with({type:"expired"},()=>jsxRuntimeExports.jsx("img",{src:Qe("membership:membership.expire-notice.expired.image"),alt:"",className:"flex-none mx-auto object-scale-down object-center w-full",style:{width:At,maxHeight:At}})).exhaustive()}),jsxRuntimeExports.jsx("p",{className:"self-center text-base text-center text-balance text-neutral-500",style:{maxWidth:At},children:$$3(dt).with({type:"none"},()=>jsxRuntimeExports.jsx(Text,{i18nKey:"user:quest.types.daily_reward.description",context:vt?"member":void 0,values:{amount:Mt?Mt.toLocaleString():"..."}})).with({type:"near-expire"},Dt=>jsxRuntimeExports.jsx(Text,{i18nKey:`membership:membership.expire-notice.near-expire.${Dt.paymentProvider}.content`,context:Dt.days===0?"today":void 0,values:{count:Dt.days},components:{DayEmphasize:xt}})).with({type:"expired"},Dt=>jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership.expire-notice.expired.content",context:Dt.days===0?"today":void 0,values:{count:Dt.days},components:{DayEmphasize:xt}})).exhaustive()}),ut?.state==="active"&&ut.current.autoRenewable==="unspecified"&&ft(ut.current.paymentProvider)&&jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",color:"theme",size:"large",className:"w-full",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership.auto-renewal.manage.menu-item"})}),!vt&&jsxRuntimeExports.jsx(MembershipButton,{close:it}),jsxRuntimeExports.jsx(ClaimButton,{close:it,trackingProps:He.trackingProps,onClaimed:He.onClaimed,disabled:!1})]})}function ClaimButton(He){const{amount:Qe,available:it,claim:lt,refreshAt:ut}=useDailyClaim(),dt=reactExports.useRef(Date.now()).current,xt=useCountdownTimer(ut-dt);return jsxRuntimeExports.jsx(UIButton$1,{size:"large",busy:"auto",className:cx("h-12",He.className),style:He.style,disabled:He.disabled,onPress:async()=>{it?(track("claim_credit_click",{quest:"daily_reward",...He.trackingProps}),await lt(),He.onClaimed?.()):He.close()},children:it?jsxRuntimeExports.jsx(Text,{i18nKey:"common:app-notification-permission-dialog.benefit1",values:{amount:Qe?Qe.toLocaleString():"..."}}):jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-sm",children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:close"})}),jsxRuntimeExports.jsx("span",{className:"text-xs tabular-nums text-neutral-500",children:jsxRuntimeExports.jsx(Text,{i18nKey:"user:quest.types.daily_reward.next-reward-countdown",values:{time:defaultDayjs.duration(xt).format("HH:mm:ss")}})})]})})}function MembershipButton(He){const Qe=useMembershipPlans(),it=reactExports.useMemo(()=>Qe.length?Math.max(...Qe.map(lt=>lt.privileges.paidCredit)):void 0,[Qe]);return jsxRuntimeExports.jsx(UILink,{href:"/membership/plans",variant:"filled",color:"theme",size:"large",className:cx("h-12 text-sm text-center rounded-md",He.className),style:He.style,onPress:()=>{startEventGroup("member_source","daily-claim-dialog-title",{persistent:!0}),He.close()},children:jsxRuntimeExports.jsx(Text,{i18nKey:"user:quest.claim-dialog.join-membership-hint",context:it?"with-amount":void 0,values:{amount:it?.toLocaleString()},components:{strong:jsxRuntimeExports.jsx("strong",{className:"text-yellow-300 [text-shadow:0_0_8px_theme(colors.yellow.300/0.5)]"})}})})}const REFERRAL_CODE_FOR_REG_KEY="user::referral-code-for-registration";function getReferralCodeFromLocalStorage(){return localStorage.getItem(REFERRAL_CODE_FOR_REG_KEY)}function setReferralCodeToLocalStorage(He){return localStorage.setItem(REFERRAL_CODE_FOR_REG_KEY,He)}function deleteReferralCodeFromLocalStorage(){return localStorage.removeItem(REFERRAL_CODE_FOR_REG_KEY)}const buttonStyles$2=ce$1({base:"relative whitespace-nowrap",variants:{variant:{normal:cx("h-8 grid grid-flow-col place-items-center ring-1 rounded-md transition duration-75 ease-out","bg-white dark:bg-zinc-800 dark:hover:bg-zinc-700 dark:active:bg-zinc-800 dark:disabled:bg-zinc-800","dark:text-neutral-300 disabled:text-black/50 dark:disabled:text-white/40","ring-black/10 dark:ring-black/20 active:ring-black/20 dark:active:ring-black/40","shadow hover:shadow-md active:shadow-md dark:active:shadow disabled:shadow-none","dark:shadow-black/30 hover:shadow-black/20 dark:hover:shadow-black/60 active:shadow-black/10 dark:active:shadow-black"),"grayish-sidebar":cx("flex items-center justify-center rounded-md transition duration-75 ease-out","bg-background-light px-2 py-1.5 font-medium leading-6 drop-shadow-sm","dark:text-white disabled:text-black/50 dark:disabled:text-white/40","ring-black/10 dark:ring-black/20 active:ring-black/20 dark:active:ring-black/40","shadow hover:shadow-md active:shadow-md dark:active:shadow disabled:shadow-none","dark:shadow-black/30 hover:shadow-black/20 dark:hover:shadow-black/60 active:shadow-black/10 dark:active:shadow-black")},hasChildren:{true:"min-w-[5rem] px-3"},hasStartIcon:{true:"grid place-items-center pl-0"},hasEndIcon:{true:"grid place-items-center pr-0"}}}),UIButton=reactExports.forwardRef((He,Qe)=>{const{variant:it,icon:lt,busy:ut,onClick:dt,...xt}=He,[ft,vt]=Array.isArray(lt)?lt:[lt],kt=reactExports.useCallback(()=>ut===!0,[ut]),[St,Tt]=reactExports.useState(kt);reactExports.useEffect(()=>Tt(kt()),[ut,kt]);const Mt=reactExports.useCallback(async Nt=>{ut==="auto"?(Tt(!0),await dt?.(Nt),Tt(!1)):dt?.(Nt)},[ut,dt]);return jsxRuntimeExports.jsxs("button",{ref:Qe,...xt,disabled:He.disabled||St,className:buttonStyles$2({class:He.className,variant:it,hasStartIcon:!!ft,hasEndIcon:!!vt,hasChildren:!!He.children}),style:{gridTemplateColumns:[ft!=null?"32px":"","1fr",vt!=null?"32px":""].join(" "),...He.style},onClick:Mt,children:[jsxRuntimeExports.jsxs("span",{className:cx("contents",{"text-transparent *:invisible":St}),children:[ft||ft===""&&jsxRuntimeExports.jsx("i",{}),He.children,vt]}),St&&jsxRuntimeExports.jsx("span",{className:"flex justify-center items-center absolute inset-0",children:jsxRuntimeExports.jsx(mdiLoading,{className:"w-6 h-6 animate-spin"})})]})});UIButton.displayName="UIButton";const switchRootStyles=ce$1({base:"rounded-full transition flex gap-2",variants:{labelPlacement:{start:"flex-row-reverse",end:""},isDisabled:{true:"opacity-50"}}}),switchTrackStyles=ce$1({base:"bg-neutral-200 dark:bg-neutral-600 flex shrink-0 items-center rounded-full",variants:{size:{normal:"w-10 h-6 p-[3px]",small:"w-6 h-4 p-[2px]",xsmall:"w-[22px] h-3 p-px"},isSelected:{true:"dark:bg-neutral-50 bg-black"}}}),switchHandleStyles=ce$1({base:"block bg-neutral-50 dark:bg-neutral-800 rounded-full shadow transition",variants:{size:{normal:"size-[18px]",small:"size-3",xsmall:"size-[10px]"}},compoundVariants:[{size:"normal",isSelected:!0,class:"translate-x-[15px]"},{size:"small",isSelected:!0,class:"translate-x-2"},{size:"xsmall",isSelected:!0,class:"translate-x-[10px]"}]}),UISwitch=reactExports.forwardRef(function({className:He,style:Qe,size:it="normal",children:lt,labelPlacement:ut,checked:dt,onCheckedChange:xt,SwitchProps:ft,onChange:vt,isSelected:kt,disabled:St},Tt){return jsxRuntimeExports.jsx($8e59e948500a8fe1$export$b5d5cf8927ab7262,{ref:Tt,className:$64fa3d84918910a7$export$c245e6201fed2f75(He,(Mt,Nt)=>switchRootStyles({...Nt,className:Mt,labelPlacement:ut})),style:Qe,isSelected:kt??dt,isDisabled:St,onChange:vt??xt,...ft,children:$64fa3d84918910a7$export$c245e6201fed2f75(lt,(Mt,Nt)=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:switchTrackStyles({...Nt,size:it}),children:jsxRuntimeExports.jsx("span",{className:switchHandleStyles({...Nt,size:it})})}),Mt]}))})});UISwitch.displayName="UISwitch";const classes$1={},UITextFieldWithIcon=reactExports.forwardRef((He,Qe)=>{const{variant:it,icon:lt,wrapperProps:ut,...dt}=He,[xt,ft]=Array.isArray(lt)?lt:[lt];return jsxRuntimeExports.jsxs("div",{...ut,className:cx("grid",ut?.className),style:{gridTemplateColumns:[xt!=null?"32px":"","1fr",ft!=null?"32px":""].join(" "),...ut?.style},children:[xt&&jsxRuntimeExports.jsx("span",{children:xt}),jsxRuntimeExports.jsx("input",{ref:Qe,...dt,disabled:He.disabled,className:cx("relative h-full outline-none",...it?[classes$1[it],He.children&&"min-w-[5rem] px-3"]:[],dt?.className)}),ft&&jsxRuntimeExports.jsx("span",{children:ft})]})});UITextFieldWithIcon.displayName="UITextFieldWithIcon";const inputStyles=ce$1({base:"border",variants:{variant:{"rounded-normal":"bg-white dark:bg-zinc-900 text-gray-800 dark:text-zinc-200 border-gray-200 dark:border-zinc-700 outline-none ring-0 focus:ring-1 focus:ring-zinc-700 focus:dark:ring-zinc-400 rounded-lg py-2 px-4 placeholder:text-neutral-400 placeholder:dark:text-neutral-500"},isError:{true:"border-red-500 dark:border-red-400 focus:ring-red-500 focus:dark:ring-red-400"}},compoundVariants:[{variant:"rounded-normal",isDisabled:!0,className:"cursor-not-allowed text-neutral-400"},{variant:"rounded-normal",isError:!0,className:"bg-red-50 dark:bg-red-900/20 text-red-900 dark:text-red-100 animate-shake"}]});function UIInput(He){const{variant:Qe,className:it,isError:lt,...ut}=He;return jsxRuntimeExports.jsx($3985021b0ad6602f$export$f5b8910cec6cf069,{...ut,className:$64fa3d84918910a7$export$c245e6201fed2f75(it,(dt,xt)=>inputStyles({...xt,variant:Qe,isError:lt,className:dt}))})}const textAreaStyles=ce$1({variants:{variant:{"rounded-normal":"border bg-white dark:bg-zinc-900 text-gray-800 dark:text-zinc-200 border-gray-200 dark:border-zinc-700 outline-none ring-0 focus:ring-1 focus:ring-zinc-700 focus:dark:ring-zinc-400 rounded-lg py-2 px-4 placeholder:text-neutral-400 placeholder:dark:text-neutral-500"}}});function UITextArea(He){const{variant:Qe,className:it,...lt}=He;return jsxRuntimeExports.jsx($216918bed6669f72$export$f5c9f3c2c4054eec,{...lt,className:$64fa3d84918910a7$export$c245e6201fed2f75(it,(ut,dt)=>textAreaStyles({...dt,variant:Qe,className:ut}))})}const[useGenerateReferralCode,executeGenerateReferralCode]=createMutationHelper(GenerateReferralCodeDocument),useGetMyReferralCode=modifyQueryHook(createQueryHook(GetMyReferralCodeDocument),{reduce:He=>He?.me?.referralCode}),updateGetMyReferralCode=He=>{cache$1.updateQuery({query:GetMyReferralCodeDocument},produce(Qe=>{const it=Qe?.me;it!=null&&(it.referralCode=He)}))},useGetUserReferralLogs=modifyQueryHook(createQueryHook(GetUserReferralLogsDocument),{reduce:He=>He?.referralLogs}),[useSetReferrer,executeSetReferrer]=createMutationHelper(SetReferrerDocument),useGetMyReferrerId=modifyQueryHook(createQueryHook(GetMyReferrerIdDocument),{reduce:He=>He?.me?.referrerId}),useGetReferralCodeInfo=modifyQueryHook(createQueryHook(GetReferralCodeInfoDocument),{reduce:He=>He?.referralCode}),fetchListUsers=createFetchQueryHelper(ListUsersDocument),useListUsers=modifyQueryHook(createQueryHook(ListUsersDocument),{reduce:He=>He?.users}),useGetUserInfoById=modifyQueryHook(createQueryHook(GetUserInfoByIdDocument),{transform:He=>({userId:He}),reduce:He=>He?.user}),useGetUserInfoByUsername=modifyQueryHook(createQueryHook(GetUserInfoByUsernameDocument),{transform:He=>({username:He}),reduce:He=>He?.user}),fetchGetUserInfoByUsername=createFetchQueryHelper(GetUserInfoByUsernameDocument),useListUserDecorations=modifyQueryHook(createQueryHook(ListUserDecorationsDocument),{reduce:He=>He?.user?.decorations});modifyQueryHook(createQueryHook(ListUserActiveDecorationsDocument),{reduce:He=>He?.user?.activeDecorations});modifyQueryHook(createQueryHook(ListUserCollectionCardsDocument),{reduce:He=>He?.user?.collectionCards});modifyQueryHook(createQueryHook(ListActiveCollectionCardSetsDocument),{reduce:He=>He?.activeCollectionCardSets});modifyQueryHook(createQueryHook(GetUserCardSetProgressDocument),{reduce:He=>He?.user?.collectionCardSetProgress});const useListUserCollectionCardSetProgress=modifyQueryHook(createQueryHook(ListUserCardSetProgressDocument),{reduce:He=>He?.user?.collectionCardSetProgresses}),fluentSpinnerIos16Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M2.501 8a5.5 5.5 0 1 1 5.5 5.5A.75.75 0 0 0 8 15a7 7 0 1 0-7-7a.75.75 0 0 0 1.501 0"})}),icBaselineAlternateEmail=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10h5v-2h-5c-4.34 0-8-3.66-8-8s3.66-8 8-8s8 3.66 8 8v1.43c0 .79-.71 1.57-1.5 1.57s-1.5-.78-1.5-1.57V12c0-2.76-2.24-5-5-5s-5 2.24-5 5s2.24 5 5 5c1.38 0 2.64-.56 3.54-1.47c.65.89 1.77 1.47 2.96 1.47c1.97 0 3.5-1.6 3.5-3.57V12c0-5.52-4.48-10-10-10zm0 13c-1.66 0-3-1.34-3-3s1.34-3 3-3s3 1.34 3 3s-1.34 3-3 3z"})}),icRoundCheckCircleOutline=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8s8 3.59 8 8s-3.59 8-8 8zm3.88-11.71L10 14.17l-1.88-1.88a.996.996 0 1 0-1.41 1.41l2.59 2.59c.39.39 1.02.39 1.41 0L17.3 9.7a.996.996 0 0 0 0-1.41c-.39-.39-1.03-.39-1.42 0z"})}),icRoundClose=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"})}),majesticonsExclamationCircleLine=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("g",{fill:"currentColor",children:jsxRuntimeExports.jsx("path",{d:"M12 4a8 8 0 1 0 0 16a8 8 0 0 0 0-16zM2 12C2 6.477 6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12zm10-5a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V8a1 1 0 0 1 1-1zm0 8a1 1 0 1 0 0 2h.01a1 1 0 1 0 0-2H12z"})})});function getExperienceLevelWithIcons(He){return[{name:"beginner",label:He("user:onboarding.experience.beginner.label"),help:He("user:onboarding.experience.beginner.help"),icon:BeginnerLevelIcon},{name:"intermediate",label:He("user:onboarding.experience.intermediate.label"),help:He("user:onboarding.experience.intermediate.help"),icon:IntermediateLevelIcon},{name:"advanced",label:He("user:onboarding.experience.advanced.label"),help:He("user:onboarding.experience.advanced.help"),icon:AdvancedLevelIcon}]}function BeginnerLevelIcon(He){return jsxRuntimeExports.jsx("svg",{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",...He,children:jsxRuntimeExports.jsx("path",{d:"M25.8751 4.12524C24.9932 3.24818 23.8 2.75586 22.5563 2.75586C21.3126 2.75586 20.1194 3.24818 19.2376 4.12524L6.30005 17.0815L3.00005 23.869C2.83044 24.2265 2.75333 24.6208 2.77578 25.0158C2.79824 25.4109 2.91955 25.7939 3.12858 26.1299C3.33761 26.4658 3.62766 26.7439 3.97213 26.9385C4.31659 27.1332 4.70443 27.2382 5.10005 27.244C5.45806 27.2439 5.81113 27.1604 6.1313 27.0002L12.9188 23.7002L24.1688 12.4502L25.7251 10.9127L25.8376 10.8002C26.7265 9.9194 27.2297 8.7219 27.2367 7.4705C27.2437 6.2191 26.754 5.01601 25.8751 4.12524ZM24.2063 5.79399C24.4246 6.01171 24.5977 6.27034 24.7159 6.55508C24.8341 6.83983 24.8949 7.14508 24.8949 7.45337C24.8949 7.76165 24.8341 8.06691 24.7159 8.35165C24.5977 8.63639 24.4246 8.89503 24.2063 9.11274L20.8876 5.79399C21.3138 5.36092 21.8926 5.1119 22.5001 5.10024C22.817 5.09131 23.1324 5.14837 23.4261 5.2678C23.7198 5.38722 23.9855 5.56641 24.2063 5.79399ZM5.1188 24.8815L8.0438 18.7502L11.2501 21.9565L5.1188 24.8815ZM12.9188 20.3815L9.6188 17.0815L19.2376 7.50024L22.5001 10.7627L12.9188 20.3815Z",fill:"currentColor"})})}function IntermediateLevelIcon(He){return jsxRuntimeExports.jsxs("svg",{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",...He,children:[jsxRuntimeExports.jsx("path",{d:"M14.0917 23.2555C11.9773 23.2555 10.0643 22.6776 8.6049 21.6681C7.14176 20.6511 6.12121 19.2283 5.72609 17.4504C5.61269 16.9385 5.55781 16.4187 5.55781 15.8958C5.55781 14.1583 6.16868 12.3661 7.28427 10.76C6.80147 10.4125 6.348 9.98101 5.94919 9.47266C4.55193 11.4002 3.73251 13.6278 3.72888 15.8958C3.72888 16.547 3.79838 17.1982 3.94106 17.8419C4.43117 20.0877 5.75894 21.9277 7.56232 23.1712C9.36933 24.415 11.6446 25.0845 14.0917 25.0845C15.4231 25.0845 16.8094 24.8869 18.2031 24.47L16.9961 22.9043C16.0048 23.1422 15.0282 23.2555 14.0917 23.2555Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M26.6055 7.53738C25.7092 6.19851 24.4362 5.16686 22.9438 4.47567C21.4478 3.78409 19.7359 3.42935 17.9362 3.42578C16.5463 3.42578 15.1014 3.63796 13.6566 4.08055C13.0455 4.26701 12.4567 4.48666 11.8898 4.74245C11.8971 4.75355 11.9044 4.76103 11.9117 4.77173C12.2702 5.27651 12.5592 5.81052 12.7641 6.34849C13.2213 6.15093 13.6968 5.97874 14.1869 5.8291C15.4636 5.44117 16.7292 5.25465 17.9362 5.25465C19.4981 5.25465 20.9504 5.56544 22.1721 6.13626C23.4011 6.70318 24.3961 7.5226 25.0838 8.55391C25.3434 8.94184 25.4422 9.27834 25.4422 9.53447C25.4387 9.7027 25.4056 9.84169 25.318 9.9953C25.252 10.1086 25.1533 10.2332 24.9996 10.3575C24.7728 10.5476 24.4217 10.7487 23.9206 10.9134C23.423 11.0781 22.7793 11.2098 21.9856 11.2792C21.0345 11.3599 20.2408 11.7071 19.6884 12.2558C19.1361 12.7973 18.8545 13.5253 18.8545 14.2347C18.8545 15.0138 19.1837 15.7858 19.7909 16.3491C20.3944 16.916 21.2687 17.2561 22.2782 17.2525C22.3404 17.2525 22.4025 17.2525 22.4684 17.249H22.4757C22.5343 17.2454 22.5965 17.2454 22.6549 17.2454C23.028 17.2454 23.3023 17.2929 23.4963 17.3586C23.7853 17.4576 23.8987 17.5708 23.9755 17.6805C24.0485 17.7901 24.0925 17.9366 24.0925 18.1123C24.0925 18.2473 24.0669 18.3902 24.023 18.507C23.9828 18.6278 23.9242 18.7192 23.9022 18.7449C23.3061 19.4362 22.6147 20.0802 21.8391 20.6507L22.8524 22.1724C23.7633 21.5141 24.579 20.7568 25.2886 19.9373C25.4971 19.6923 25.6435 19.4144 25.7532 19.1107C25.8555 18.8035 25.9214 18.4705 25.9214 18.1123C25.9214 17.8012 25.8701 17.4682 25.7458 17.1428C25.5594 16.6528 25.1825 16.1809 24.6448 15.8773C24.107 15.5665 23.445 15.4164 22.6548 15.4164C22.5707 15.4164 22.483 15.42 22.3878 15.4236H22.2782C21.6601 15.4201 21.2796 15.2335 21.0381 15.0103C20.7968 14.7834 20.687 14.502 20.6834 14.2348C20.687 13.9898 20.7711 13.7594 20.9759 13.5547C21.1808 13.3532 21.532 13.1556 22.1465 13.101C23.7522 12.9581 24.9668 12.5998 25.8555 12.0036C26.2983 11.7036 26.6568 11.3377 26.9018 10.9098C27.1505 10.4855 27.2712 10.0064 27.2712 9.53453C27.2711 8.8212 27.0114 8.14462 26.6055 7.53738Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M23.2872 10.0094C23.5869 9.70933 23.7588 9.29534 23.7588 8.87133C23.7588 8.44732 23.5869 8.03294 23.2872 7.73286C22.9872 7.43351 22.5731 7.26172 22.1492 7.26172C21.7252 7.26172 21.3108 7.43351 21.011 7.73286C20.7113 8.03294 20.5396 8.44726 20.5396 8.87133C20.5396 9.29534 20.7113 9.70933 21.011 10.0094C21.3108 10.3091 21.7252 10.4809 22.1492 10.4809C22.5731 10.4809 22.9872 10.3092 23.2872 10.0094Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M10.0506 13.8918C10.2924 13.1635 9.89769 12.3769 9.16895 12.1347C8.44061 11.8928 7.65398 12.2871 7.41184 13.0159C7.16999 13.7442 7.56472 14.5308 8.29345 14.7734C9.0214 15.0149 9.80836 14.6206 10.0506 13.8918Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M10.0703 19.4069C10.57 18.8786 10.5468 18.0452 10.0188 17.5455C9.49048 17.0454 8.65713 17.0686 8.15739 17.597C7.65725 18.1249 7.68013 18.9583 8.20848 19.4584C8.73637 19.9581 9.57012 19.9349 10.0703 19.4069Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M16.9688 9.22767C17.8115 9.1298 18.4156 8.36713 18.3173 7.52443C18.2195 6.68173 17.4568 6.07806 16.6141 6.17593C15.7711 6.27381 15.1674 7.03613 15.2656 7.87917C15.3635 8.72187 16.1258 9.32589 16.9688 9.22767Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M6.63205 8.55715C7.48919 9.75204 8.71195 10.5493 9.82364 10.6394L9.87025 10.6436L11.9575 9.14616L11.9685 9.10079C12.2389 8.01878 11.8753 6.60458 11.0185 5.41037C10.2053 4.27733 9.25836 3.49999 8.34209 2.74769C7.71694 2.23476 7.06999 1.70358 6.46632 1.06094C5.96652 0.528684 5.7983 0.265758 5.79773 0.265078L5.63574 0L5.4998 0.160066C4.86883 0.905231 4.61661 2.24835 4.80664 3.84443C5.00578 5.52042 5.65466 7.19472 6.63205 8.55715ZM7.0973 6.57348C7.778 7.34368 8.09593 6.83924 7.68636 6.05409C7.17212 5.06922 7.69185 5.03388 8.00819 5.34036C8.32345 5.64577 8.71852 6.33021 9.05876 6.13412C9.26323 6.01625 9.04358 5.59219 8.75403 4.9496C8.58791 4.58166 8.73138 4.02975 9.58671 4.76631C9.89908 5.08032 10.1954 5.41898 10.4714 5.80334C11.0697 6.63636 11.3529 7.64008 11.2146 8.42745L9.42755 9.7099C8.63667 9.58914 7.77812 8.99901 7.17908 8.16452C6.94975 7.84444 6.7395 7.49797 6.55162 7.1336C6.53146 7.08144 6.5084 7.02576 6.48161 6.96674C6.18317 6.30988 6.41665 5.80408 7.0973 6.57348Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M13.2022 10.4137C12.7656 10.2355 12.3504 10.2555 12.0543 10.4676L11.0918 11.1585C10.7953 11.3707 10.6438 11.7583 10.6722 12.2283C10.7011 12.6988 10.9076 13.2118 11.243 13.6472L12.7639 15.619L15.744 13.481L14.3634 11.4092C14.0586 10.9513 13.6386 10.592 13.2022 10.4137Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M16.2346 14.2183L13.3051 16.3198L22.3805 28.0858C23.0097 28.902 23.9387 29.2289 24.4945 28.8309L24.5011 28.8252C25.0566 28.4269 25.044 27.442 24.4727 26.5844L16.2346 14.2183Z",fill:"currentColor"})]})}function AdvancedLevelIcon(He){return jsxRuntimeExports.jsxs("svg",{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",...He,children:[jsxRuntimeExports.jsx("path",{d:"M4.18995 18.0045H15.376L14.4593 17.1553C14.1686 16.8836 13.9964 16.5002 13.9886 16.0985C13.9886 16.0819 13.9925 16.0662 13.9925 16.0501H5.16851V3.6718H24.061V16.0501H21.9356L23.7477 18.0046H25.0384C25.5775 18.0046 26.0161 17.5672 26.0161 17.0271V2.69429C26.0161 2.1546 25.5775 1.71729 25.0384 1.71729H4.18995C3.65088 1.71729 3.21344 2.15467 3.21344 2.69429V17.0271C3.21344 17.5672 3.65088 18.0045 4.18995 18.0045Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M27.6715 22.2397H27.7637C28.5728 22.2397 29.2293 21.5836 29.2293 20.7738C29.2293 19.9642 28.5728 19.3081 27.7637 19.3081H24.9555L27.6715 22.2397Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M1.46591 19.3081C0.655731 19.3081 0 19.9642 0 20.7739C0 21.5836 0.655731 22.2397 1.46591 22.2397H19.9474L16.7831 19.3081H1.46591Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M11.962 8.20654C11.9394 8.20654 11.9054 8.22906 11.8545 8.28046C10.9159 9.2198 10.2232 12.3289 12.5364 14.2468C13.0607 14.6817 13.6949 14.9176 14.3153 14.9176C14.9033 14.9176 15.4796 14.7048 15.9377 14.2468C17.244 12.9405 17.0598 11.5554 15.9377 10.8451C15.5982 10.6298 15.2566 10.5711 14.924 10.5711C14.5218 10.5711 14.1293 10.6568 13.7594 10.6568C13.5363 10.6568 13.3231 10.6259 13.1197 10.5286C11.5509 9.78244 12.1469 8.20654 11.962 8.20654Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M29.5982 25.7569L18.5612 13.878C18.361 13.6626 18.0819 13.5379 17.7879 13.5324C17.4939 13.5269 17.2099 13.6409 17.002 13.8488C16.5297 14.3211 16.0573 14.7932 15.5849 15.2654C15.377 15.4731 15.2625 15.7565 15.2677 16.0504C15.2729 16.3442 15.3975 16.6232 15.6124 16.8237L27.4739 27.8812C27.7528 28.1396 28.1148 28.2824 28.4954 28.2824C28.8968 28.2824 29.2743 28.1259 29.5584 27.8411C30.1314 27.2677 30.1491 26.3519 29.5982 25.7569ZM28.6573 27.0609C28.4868 27.2237 28.2191 27.2255 28.0463 27.0651L17.4971 17.2681L18.1881 16.5768L18.2929 16.4721L18.9846 15.7804L28.7781 26.3384C28.9437 26.517 28.9353 26.7955 28.7591 26.9638L28.6573 27.0609Z",fill:"currentColor"})]})}function RegisterOnboardingDialogContent(He){const{data:Qe,loading:it}=useUserInfo({context:{refetchOnFocus:!1}}),[lt,ut]=reactExports.useState(),{t:dt}=useTranslation(["common","user"]),[xt,ft]=reactExports.useState(!1),{data:vt,loading:kt,refetch:St}=useGetMyReferrerId({}),[Tt,Mt]=reactExports.useState(""),[Nt,At]=useLocalStorage({key:REFERRAL_CODE_FOR_REG_KEY,serialize:xr=>xr,deserialize:xr=>xr??""}),[$t,Dt]=reactExports.useState(""),Ft=Tt===Qe?.username,Bt=Tt==="",Ot=useAsync(async()=>{if(Ft)return{valid:!0};if(!$t)return;if(!/^[a-z0-9-]+$/.test($t))return{valid:!1,errorType:"invalid"};const xr=await fetchGetUserInfoByUsername({username:$t});return xr.data&&!xr.data.user?{valid:!0}:xr.data.user?.id===Qe?.id?{valid:!0}:{valid:!1,errorType:"taken"}},[$t,Qe?.id,Ft]);useDebounce(()=>{Dt(Tt)},500,[Tt]);const Qt=Tt!==$t,Wt=Ot.loading||Qt,[Xt,Kt]=useAsyncFn(async()=>{try{track("started_choice",{chosenLevel:lt,isOver18:xt?"1":"0",referrerCode:Nt});const xr={experienceLevel:lt,ageVerificationStatus:xt?AgeVerificationStatus.Over18:AgeVerificationStatus.Minor},[gr,br]=await Promise.all([executeUpdateUserInfo({input:{username:$t}}),executeSetPreferences({value:xr}),Nt&&!vt?executeSetReferrer({code:Nt}).then(()=>{St()}):Promise.resolve()]);updateGetMyPreferences(xr),trackerSetUserProperties({experienceLevel:lt}),deleteReferralCodeFromLocalStorage()}catch(xr){xr instanceof Error?toast.error(xr.message):toast.error(String(xr));return}He.onSuccess?.()},[$t,xt,lt,Nt,vt]),Jt=!Ot.value||Ot.loading||Qt||kt,hr=Bt?null:!Ft&&Wt?jsxRuntimeExports.jsx(fluentSpinnerIos16Filled,{className:"animate-spin"}):Ot?.value?.valid===!0?jsxRuntimeExports.jsx(icRoundCheckCircleOutline,{className:"text-green-500 size-6"}):jsxRuntimeExports.jsx(majesticonsExclamationCircleLine,{className:"text-red-500 size-6"},"end");return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:He.onAbort,className:"absolute right-4 top-4 cursor-pointer",children:jsxRuntimeExports.jsx(icRoundClose,{className:"opacity-80 size-6"})}),jsxRuntimeExports.jsxs("form",{className:"px-7 pt-7 pb-6 flex flex-col gap-6",onSubmit:xr=>{xr.preventDefault(),Kt()},id:"onboarding-dialog-form",children:[jsxRuntimeExports.jsx("h1",{className:"font-semibold text-3xl self-center leading-none",children:dt("user:onboarding.getting-started.title")}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"font-semibold text-lg",children:dt("user:onboarding.getting-started.username.title")}),jsxRuntimeExports.jsx("h3",{className:"text-sm mt-1",children:dt("user:onboarding.getting-started.username.subtitle")}),jsxRuntimeExports.jsx(UITextFieldWithIcon,{disabled:!Tt&&it,className:"bg-transparent min-w-[12rem] py-[10px]",wrapperProps:{className:cx("mt-2 w-fit items-center gap-1 bg-neutral-100 dark:bg-neutral-700 focus-within:!bg-background px-[10px] rounded-xl ring-1",{"ring-violet-600":Ot.value?.valid==null,"ring-green-500":Ot.value?.valid===!0,"ring-red-500":Ot.value?.valid===!1})},value:Tt,onChange:xr=>Mt(xr.target.value),icon:[jsxRuntimeExports.jsx(icBaselineAlternateEmail,{className:"text-neutral-400"},"start"),hr],minLength:1,maxLength:50,required:!0,placeholder:dt("user:onboarding.getting-started.username.placeholder")}),jsxRuntimeExports.jsx("p",{className:cx("text-xs mt-[2px] h-[1lh]",{"text-red-500":Ot.value?.valid===!1,"text-green-500":Ot.value?.valid===!0}),children:$$3([Ot,Wt,Ft]).with([{value:{valid:!0}},!1,N$4._],()=>dt("user:onboarding.getting-started.username.valid")).with([N$4._,N$4._,!0],()=>dt("user:onboarding.getting-started.username.valid")).with([N$4._,!0,N$4._],()=>null).with([{value:{valid:!1,errorType:"taken"}},N$4._,N$4._],()=>dt("user:onboarding.getting-started.username.invalid.taken")).otherwise(()=>null)})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"font-semibold text-lg",children:dt("user:onboarding.getting-started.experience.title")}),jsxRuntimeExports.jsx("h3",{className:"text-sm",children:dt("user:onboarding.getting-started.experience.subtitle")}),jsxRuntimeExports.jsx(OnboardingExperienceLevels,{level:lt,setLevel:ut})]}),jsxRuntimeExports.jsx("section",{children:jsxRuntimeExports.jsx(FormControlLabel,{slotProps:{typography:{className:"text-lg font-semibold ml-2 shrink-1"}},className:"ml-1",label:dt("user:onboarding.getting-started.consent.age.label"),control:jsxRuntimeExports.jsx(UISwitch,{className:"shrink-0",isSelected:xt,onChange:xr=>{ft(xr)}})})}),jsxRuntimeExports.jsx(UserReferralSection,{referrerId:vt,loadingReferrerId:kt,referrerCode:Nt,setReferrerCode:At}),jsxRuntimeExports.jsx("section",{children:jsxRuntimeExports.jsx(UIButton,{className:cx("w-full rounded-2xl bg-violet-600 text-white py-4 text-xl font-medium cursor-pointer","disabled:cursor-not-allowed disabled:bg-opacity-40","shadow hover:shadow-md active:shadow-md disabled:shadow-none"),disabled:Jt,busy:Xt.loading,type:"submit",children:dt("common:done")})})]})]})}function UserReferralSection(He){const{t:Qe}=useTranslation(["user"]),{referrerId:it,loadingReferrerId:lt,referrerCode:ut,setReferrerCode:dt}=He;return jsxRuntimeExports.jsxs("section",{children:[lt&&jsxRuntimeExports.jsx(fluentSpinnerIos16Filled,{className:"animate-spin"}),!lt&&it===null&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h2",{className:"font-semibold text-lg",children:Qe("user:referral.referral-page.submit-referral-code.label")}),jsxRuntimeExports.jsx(UITextFieldWithIcon,{className:"bg-transparent min-w-[228px] py-[10px]",wrapperProps:{className:cx("mt-2 w-fit items-center gap-1 bg-neutral-100 dark:bg-neutral-700 focus-within:!bg-background px-[10px] rounded-xl ring-1","ring-violet-600")},minLength:1,placeholder:Qe("user:referral.referral-page.submit-referral-code.placeholder"),value:ut,onChange:xt=>dt(xt.target.value),autoCapitalize:"none",autoCorrect:"off",spellCheck:"false",autoComplete:"off",inputMode:"text",type:"text"})]}),it&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h2",{className:"font-semibold text-lg",children:Qe("user:referral.referred-by.label")}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:ut?jsxRuntimeExports.jsx("span",{className:"font-mono tracking-wide",children:ut}):Qe("common:unknown")})]})]})}function openRegisterOnboardingDialog(He){track("getting_started_show");const Qe=()=>{deleteReferralCodeFromLocalStorage()};return UIDialog.create({className:"max-w-screen-msm",children:({close:it})=>jsxRuntimeExports.jsx("div",{className:"relative",children:jsxRuntimeExports.jsx(RegisterOnboardingDialogContent,{onSuccess:()=>{openQuestDialog(),it()},onAbort:()=>{Qe(),openQuestDialog(),it()}})}),onClose:()=>{Qe(),openQuestDialog()}})}function OnboardingExperienceLevels(He){const{t:Qe}=useTranslation(["user"]),it=getExperienceLevelWithIcons(Qe);return jsxRuntimeExports.jsx("fieldset",{className:"w-full grid grid-rows-3 md:grid-rows-1 md:grid-cols-3 gap-2 md:gap-6 mt-2",children:it.map(lt=>{const ut=lt.name===He.level;return jsxRuntimeExports.jsxs("div",{className:"content",children:[jsxRuntimeExports.jsx("input",{className:"hidden",type:"radio",id:lt.name,name:lt.name,value:lt.name,onChange:dt=>He.setLevel(dt.target.value),checked:ut}),jsxRuntimeExports.jsxs("label",{htmlFor:lt.name,className:cx("rounded-xl flex items-center cursor-pointer grow gap-6","px-4 md:flex-col md:gap-2","bg-neutral-100 dark:bg-neutral-600 pb-4 pt-6 transition",ut&&"ring-1 ring-violet-600"),children:[jsxRuntimeExports.jsx(lt.icon,{className:cx(!ut&&"opacity-50","transition")}),jsxRuntimeExports.jsxs("div",{className:cx(!ut&&"opacity-50","font-semibold text-sm transition"),children:[lt.label,jsxRuntimeExports.jsx(HelpIcon,{className:"!hidden md:!inline-flex [&>svg]:size-[14px] ml-1 translate-y-[2px]",children:jsxRuntimeExports.jsx("p",{className:"p-3",children:lt.help})}),jsxRuntimeExports.jsx("p",{className:"md:hidden text-xs font-normal",children:lt.help})]})]})]},lt.name)})})}const useLoadingCallback=(He,Qe=[],it)=>{const[lt,ut]=reactExports.useState(!1),dt=reactExports.useRef(!1),xt=reactExports.useRef();let ft=[];const vt=reactExports.useCallback(async(...kt)=>{if(dt.current)return xt.current={fn:vt,args:kt,thisArg:void 0},new Promise((St,Tt)=>{ft.push([St,Tt])});dt.current=!0,ut(!0);try{return await He(...kt)}finally{if(dt.current=!1,xt.current){const St=xt.current,Tt=ft;xt.current=void 0,ft=[],Promise.resolve().then(()=>{St.fn.apply(St.thisArg,St.args).then(Mt=>{Tt.forEach(([Nt])=>Promise.resolve(Mt).then(Nt))}).catch(Mt=>{Tt.forEach(([,Nt])=>Promise.resolve(Mt).then(Nt))})})}else ut(!1)}},Qe);return[lt,vt]},PREFERENCE_STORAGE_KEY_PREFIX="preferences::",PREFERENCES=["showNsfw","blurNsfw","promoEmail","ageVerificationStatus","experienceLevel","disableAutoPromptHelper","allowPromptHelperSwitchForTsubaki","tsubakiPromptHelper"];function getPreferenceFromLocalStorage(He){const Qe=`${PREFERENCE_STORAGE_KEY_PREFIX}${He}`,it=window.localStorage.getItem(Qe);if(it)return attemptParseJSON(it)}function syncPreferenceValueToLocalStorage(He,Qe){const it=`${PREFERENCE_STORAGE_KEY_PREFIX}${He}`;window.localStorage.setItem(it,JSON.stringify(Qe))}function resetLocalPreferences(){for(const He of PREFERENCES)window.localStorage.removeItem(`${PREFERENCE_STORAGE_KEY_PREFIX}${He}`)}const PreferenceContext=reactExports.createContext({updateValue:async()=>{}});function UserPreferenceProvider(He){const{data:Qe,refetch:it}=useMyPreferences(),lt=reactExports.useCallback(async(dt,xt,ft)=>{const vt=ft?.localStorageGetter?.();try{updateGetMyPreferences({[dt]:xt??void 0}),await executeSetPreferences({value:{[dt]:xt}}),ft?.localStorageSetter?.(xt??void 0)}catch(kt){toast.error(`fail to set preference ${kt?.message}`),ft?.localStorageSetter?.(vt)}finally{it()}},[it]),ut=reactExports.useMemo(()=>({preference:Qe,updateValue:lt}),[Qe,lt]);return jsxRuntimeExports.jsx(PreferenceContext.Provider,{value:ut,children:He.children})}const createUsePreferenceHook=(He,Qe,it)=>()=>{const{preference:lt,updateValue:ut}=reactExports.useContext(PreferenceContext),dt=lt?.[He]??it?.localStorageGetter?.()??Qe;reactExports.useEffect(()=>{lt?.[He]&&it?.localStorageSetter?.(lt?.[He])},[lt,He]);const[xt,ft]=useLoadingCallback(async vt=>{await ut(He,vt,it)},[He,it]);return[dt,ft,xt]},useShowNsfw=createUsePreferenceHook("showNsfw",!1),useBlurNsfw=createUsePreferenceHook("blurNsfw",!0),usePromoEmailPref=createUsePreferenceHook("promoEmail",!1),useDisableAutoPromptHelperPref=createUsePreferenceHook("disableAutoPromptHelper",!1),TSUBAKI_PROMPT_HELPER="tsubakiPromptHelper";var TSUBAKI_PROMPT_HELPER_VALUE=(He=>(He.autoEnable="autoEnable",He.followUser="followUser",He))(TSUBAKI_PROMPT_HELPER_VALUE||{});const useTsubakiPromptHelperPref=createUsePreferenceHook(TSUBAKI_PROMPT_HELPER,"autoEnable",{localStorageGetter:()=>getPreferenceFromLocalStorage(TSUBAKI_PROMPT_HELPER),localStorageSetter:He=>syncPreferenceValueToLocalStorage(TSUBAKI_PROMPT_HELPER,He)}),usePushPrefs=()=>["FOLLOW","LIKE","COMMENT","TASK","NEWS"].map(He=>[`push-${He}`,createUsePreferenceHook(`push-${He}`,!0)()]),useAgeVerificationStatus=createUsePreferenceHook("ageVerificationStatus",void 0),icBaselineLock=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2s2 .9 2 2s-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1c1.71 0 3.1 1.39 3.1 3.1v2z"})}),icBaselineNotifications=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 22c1.1 0 2-.9 2-2h-4a2 2 0 0 0 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"})}),icBaselineSettings=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19.14 12.94c.04-.3.06-.61.06-.94c0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6s3.6 1.62 3.6 3.6s-1.62 3.6-3.6 3.6z"})});function promisifyRequest(He){return new Promise((Qe,it)=>{He.oncomplete=He.onsuccess=()=>Qe(He.result),He.onabort=He.onerror=()=>it(He.error)})}function createStore(He,Qe){const it=indexedDB.open(He);it.onupgradeneeded=()=>it.result.createObjectStore(Qe);const lt=promisifyRequest(it);return(ut,dt)=>lt.then(xt=>dt(xt.transaction(Qe,ut).objectStore(Qe)))}let defaultGetStoreFunc;function defaultGetStore(){return defaultGetStoreFunc||(defaultGetStoreFunc=createStore("keyval-store","keyval")),defaultGetStoreFunc}function get$2(He,Qe=defaultGetStore()){return Qe("readonly",it=>promisifyRequest(it.get(He)))}function set$3(He,Qe,it=defaultGetStore()){return it("readwrite",lt=>(lt.put(Qe,He),promisifyRequest(lt.transaction)))}function del(He,Qe=defaultGetStore()){return Qe("readwrite",it=>(it.delete(He),promisifyRequest(it.transaction)))}function createKv(He){return[()=>{try{return get$2(He)}catch{}},ut=>{try{set$3(He,ut)}catch{}},()=>{try{del(He)}catch{}}]}const[getDisablePush,setDisablePush,delDisablePush]=createKv("disablePush"),log$1=debug("pixai:swClient");isServiceWorkerAvailable&&navigator.serviceWorker.register("/sw.js").then(He=>{He.active?.postMessage({type:"client-sync",debug:localStorage.getItem("debug")})});async function refreshPushToken(He=!1,Qe){if(!isNotificationAvailable)return!1;if(He){const ut=await Notification.requestPermission().catch(()=>"default");if(ut==="granted")track("notification_granted",{scene:Qe}),localStorage.removeItem("notification::dismissed-inbox-permission-prompt"),localStorage.removeItem("notification::dismissed-generation-submit-permission-prompt"),await setDisablePush(!1);else{ut==="denied"&&track("notification_denied",{scene:Qe}),track("notification_unblock_open",{scene:Qe});const dt=dialog({children:jsxRuntimeExports.jsx(EnableNotificationContent,{dialogRef:()=>dt.current}),onClose:()=>{track("notification_unblock_close",{scene:Qe})}})}}if(!isNotificationAvailable||Notification.permission!=="granted"||await getDisablePush())return!1;let it;try{it=await getFirebaseToken()}catch{return track("push_token_sync",{scene:Qe,success:!1}),!1}return track("push_token_sync",{scene:Qe,success:!0}),log$1("FCM registration token",it),it&&(await executeSetPushToken({token:it})).data?.setPushToken?.acknowledged||!1}function EnableNotificationContent({dialogRef:He}){const{t:Qe}=useTranslation(["common"]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:Qe("common:notification.unblock-tutorial.title")}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsxs(List,{children:[jsxRuntimeExports.jsxs(ListItem$3,{children:[jsxRuntimeExports.jsx(ListItemAvatar,{children:jsxRuntimeExports.jsx(Avatar,{children:"1"})}),jsxRuntimeExports.jsx(ListItemText,{children:jsxRuntimeExports.jsx(Trans,{t:Qe,i18nKey:"common:notification.unblock-tutorial.step-1",components:{PadlockIcon:jsxRuntimeExports.jsx(icBaselineLock,{className:"inline-block"})}})})]}),jsxRuntimeExports.jsxs(ListItem$3,{children:[jsxRuntimeExports.jsx(ListItemAvatar,{children:jsxRuntimeExports.jsx(Avatar,{children:"2"})}),jsxRuntimeExports.jsx(ListItemText,{children:jsxRuntimeExports.jsx(Trans,{t:Qe,i18nKey:"common:notification.unblock-tutorial.step-2",components:{SettingsIcon:jsxRuntimeExports.jsx(icBaselineSettings,{className:"inline-block"}),Reference:jsxRuntimeExports.jsx("span",{className:"font-semibold"})}})})]}),jsxRuntimeExports.jsxs(ListItem$3,{children:[jsxRuntimeExports.jsx(ListItemAvatar,{children:jsxRuntimeExports.jsx(Avatar,{children:"3"})}),jsxRuntimeExports.jsx(ListItemText,{children:jsxRuntimeExports.jsx(Trans,{t:Qe,i18nKey:"common:notification.unblock-tutorial.step-3",components:{NotificationsIcon:jsxRuntimeExports.jsx(icBaselineNotifications,{className:"inline-block"}),Reference:jsxRuntimeExports.jsx("span",{className:"font-semibold"})}})})]})]})}),jsxRuntimeExports.jsx(DialogActions,{children:jsxRuntimeExports.jsx(Button,{onClick:()=>He()?.close(),autoFocus:!0,children:Qe("common:notification.unblock-tutorial.confirm")})})]})}let lastUserId;function refreshPushTokenEffect(He){He!==lastUserId&&(lastUserId=He,refreshPushToken())}async function withdrawPushToken(He){if(!isNotificationAvailable||Notification.permission!=="granted")return;let Qe;try{Qe=await getFirebaseToken()}catch{track("withdraw_push_token",{scene:He,success:!1});return}track("withdraw_push_token",{scene:He,success:!0}),Qe&&await executeSetPushToken({token:Qe,withdraw:!0}),lastUserId=void 0}async function isPushEnabled(){if(!isNotificationAvailable||Notification.permission!=="granted"||!getToken()||await getDisablePush())return!1;let He;try{He=await getFirebaseToken()}catch{return!1}return!!He}getFirebaseMessaging().then(He=>{He&&onMessage(He,async Qe=>{log$1("Received push message",Qe);const{data:it}=Qe;if(!it)return;switch(it.type||"notification"){case"notification":{if(!it.title)return;const ut=attemptParseJSON(it.webpush),dt=attemptParseJSON(it.payload),xt={...it,...ut},ft=await getDisablePush();ft||(toast.info(jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[(xt.icon||xt.image)&&jsxRuntimeExports.jsx("img",{className:"w-12 h-12 rounded object-cover object-center",src:xt.icon||xt.image,alt:""}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{children:xt.title}),jsxRuntimeExports.jsx("p",{className:"text-sm line-clamp-2",children:xt.body})]})]}),{icon:!1,onClick:()=>{const vt="type"in dt?dt.type:void 0;track("notification_click",{inApp:!0,type:vt});const kt=new URL(xt.link,location.href),St=new URL(location.origin);kt.host!==St.host&&(kt.protocol=St.protocol,kt.host=St.host,log$1(`The link is not from the same origin, opening anyway.
`,it.link,"=>",kt.href)),window.open(kt.href,"_blank")},autoClose:15*1e3,pauseOnFocusLoss:!1}),track("notification_impression",{inApp:!0,type:"type"in dt?dt.type:void 0})),track("notification_received",{inApp:!0,type:"type"in dt?dt.type:void 0,disablePush:ft});break}default:{log$1("Received unknown push message",Qe);break}}})});const addRedirectState=(He,Qe)=>{const it=encodeURIComponent(`redirect=${encodeURIComponent(Qe)}`),lt=new URL(He),ut=getReferralCodeFromLocalStorage();return lt.searchParams.append("state",it),lt.searchParams.append("token",getToken()),ut&&lt.searchParams.append("referralCode",ut),lt.toString()},redirectToOAuth=(He,Qe=window.location.href)=>{const it=addRedirectState(`${getApiUrl()}/auth/${He}`,Qe);window.location.href=it},useInitialQueryStringHandler=()=>{const[{token:He,isNew:Qe,submitTask:it,refCode:lt},ut]=useQs(),dt=reactExports.useRef(!1);reactExports.useEffect(()=>{if(He){setToken(He),track(Qe==="true"?"register_success":"login_success",{type:"token"});const xt=["refCode"];xt.push("token"),baseApolloClient.resetStore(),Qe==="true"&&(Number(it)||(dt.current||openRegisterOnboardingDialog().catch(()=>{}),dt.current=!0)),Number(it)||xt.push("isNew"),ut(ft=>({...ft,...Object.fromEntries(xt.map(vt=>[vt,null]))}))}},[He]),reactExports.useEffect(()=>{!He&&lt&&(setReferralCodeToLocalStorage(lt),ut(xt=>({...xt,refCode:null})))},[lt,He]),reactExports.useEffect(()=>{getToken()&&executeRefreshToken({})},[])};function logoutUser(){withdrawPushToken("logout"),setToken(""),baseApolloClient.resetStore(),refetchGetAllPaymentItems(),trackerLogout(),experimentLogout(),unsetIntercomUserJwt(),resetLocalPreferences()}function getPostRegistrationRequests(He){const it=getReferralCodeFromLocalStorage();return[He.promoEmailPref&&executeSetPreferences({value:{promoEmail:!0}}),it&&void executeSetReferrer({code:it}).catch(()=>{deleteReferralCodeFromLocalStorage()})].filter(Boolean)}function UserInfoChangeHandler(){const{data:He}=useUserInfo();return reactExports.useEffect(()=>{He?.id&&refreshPushTokenEffect(He.id),resubscribe(He?.id)},[He?.id]),null}const icBaselineMailOutline=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5l8-5v10zm-8-7L4 6h16l-8 5z"})}),icOutlineInstallMobile=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17 18H7V6h7V4H7V3h7V1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2v-5h-2v2zm0 3H7v-1h10v1z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m18 14l5-5l-1.41-1.41L19 10.17V3h-2v7.17l-2.59-2.58L13 9z"})]}),getErrorCode=He=>getErrorData(He)?.name,getErrorData=He=>He instanceof ApolloError?He.graphQLErrors?.[0]?.extensions?.exception:He?.res?.data?.errors?.[0]?.extensions?.exception;function extractPromptsModerationActionFromNsfwError(He){if(getErrorCode(He)!=="NSFW_PROMPTS_DETECTED")return;const{promptsModerationAction:it}=He?.res?.data?.errors?.[0]?.extensions?.exception??{};return it}const getValue=He=>He?.target?.value??He,createHandleChange=(He=[],Qe=()=>{})=>(it,lt)=>it==null?ut=>Qe(dt=>set$5(clonePlainObjectDeep(dt),He,getValue(ut))):lt?createHandleChange([...He,it],Qe):ut=>Qe(dt=>set$5(clonePlainObjectDeep(dt),[...He,it].join("."),getValue(ut))),useForm$1=(He={})=>{const[Qe,it]=reactExports.useState(He),lt=reactExports.useMemo(()=>createHandleChange([],it),[]),ut=reactExports.useMemo(()=>()=>new Promise(dt=>{it(xt=>(dt(xt),xt))}),[]);return reactExports.useMemo(()=>({values:Qe,setValues:it,handleChange:lt,getValues:ut}),[Qe])},NormalInput$1=styled(InputBase)(({theme:He})=>({"label + &":{marginTop:He.spacing(3)},"& .MuiInputBase-input":{borderRadius:He.shape.borderRadius,position:"relative",backgroundColor:He.palette.mode==="light"?"#fcfcfb":"#2b2b2b",border:"1px solid #ced4da",width:"100%",padding:"8px",transition:He.transitions.create(["border-color","background-color","box-shadow"]),fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"','"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:focus":{borderColor:He.palette.primary.main}}}));/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var s=function(){return(s=Object.assign||function(He){for(var Qe,it=1,lt=arguments.length;it<lt;it++)for(var ut in Qe=arguments[it])Object.prototype.hasOwnProperty.call(Qe,ut)&&(He[ut]=Qe[ut]);return He}).apply(this,arguments)},f,p=function(He){var Qe;He?function(it){if(it)for(;it.lastChild;)it.lastChild.remove()}(typeof He=="string"?document.getElementById(He):He):(Qe=document.querySelector(".grecaptcha-badge"))&&Qe.parentNode&&document.body.removeChild(Qe.parentNode)},d=function(He,Qe){p(Qe),window.___grecaptcha_cfg=void 0;var it=document.querySelector("#"+He);it&&it.remove(),function(){var lt=document.querySelector('script[src^="https://www.gstatic.com/recaptcha/releases"]');lt&&lt.remove()}()},y=function(He){var Qe=He.render,it=He.onLoadCallbackName,lt=He.language,ut=He.onLoad,dt=He.useRecaptchaNet,xt=He.useEnterprise,ft=He.scriptProps,vt=ft===void 0?{}:ft,kt=vt.nonce,St=kt===void 0?"":kt,Tt=vt.defer,Mt=Tt!==void 0&&Tt,Nt=vt.async,At=Nt!==void 0&&Nt,$t=vt.id,Dt=$t===void 0?"":$t,Ft=vt.appendTo,Bt=Dt||"google-recaptcha-v3";if(function(Wt){return!!document.querySelector("#"+Wt)}(Bt))ut();else{var Ot=function(Wt){return"https://www."+(Wt.useRecaptchaNet?"recaptcha.net":"google.com")+"/recaptcha/"+(Wt.useEnterprise?"enterprise.js":"api.js")}({useEnterprise:xt,useRecaptchaNet:dt}),Qt=document.createElement("script");Qt.id=Bt,Qt.src=Ot+"?render="+Qe+(Qe==="explicit"?"&onload="+it:"")+(lt?"&hl="+lt:""),St&&(Qt.nonce=St),Qt.defer=!!Mt,Qt.async=!!At,Qt.onload=ut,(Ft==="body"?document.body:document.getElementsByTagName("head")[0]).appendChild(Qt)}},m=function(He){console.warn(He)};(function(He){He.SCRIPT_NOT_AVAILABLE="Recaptcha script is not available"})(f||(f={}));var v$1=reactExports.createContext({executeRecaptcha:function(){throw Error("GoogleReCaptcha Context has not yet been implemented, if you are using useGoogleReCaptcha hook, make sure the hook is called inside component wrapped by GoogleRecaptchaProvider")}});v$1.Consumer;function h(He){var Qe=He.reCaptchaKey,it=He.useEnterprise,lt=it!==void 0&&it,ut=He.useRecaptchaNet,dt=ut!==void 0&&ut,xt=He.scriptProps,ft=He.language,vt=He.container,kt=He.children,St=reactExports.useState(null),Tt=St[0],Mt=St[1],Nt=reactExports.useRef(Qe),At=JSON.stringify(xt),$t=JSON.stringify(vt?.parameters);reactExports.useEffect(function(){if(Qe){var Bt=xt?.id||"google-recaptcha-v3",Ot=xt?.onLoadCallbackName||"onRecaptchaLoadCallback";return window[Ot]=function(){var Qt=lt?window.grecaptcha.enterprise:window.grecaptcha,Wt=s({badge:"inline",size:"invisible",sitekey:Qe},vt?.parameters||{});Nt.current=Qt.render(vt?.element,Wt)},y({render:vt?.element?"explicit":Qe,onLoadCallbackName:Ot,useEnterprise:lt,useRecaptchaNet:dt,scriptProps:xt,language:ft,onLoad:function(){if(window&&window.grecaptcha){var Qt=lt?window.grecaptcha.enterprise:window.grecaptcha;Qt.ready(function(){Mt(Qt)})}else m("<GoogleRecaptchaProvider /> "+f.SCRIPT_NOT_AVAILABLE)},onError:function(){m("Error loading google recaptcha script")}}),function(){d(Bt,vt?.element)}}m("<GoogleReCaptchaProvider /> recaptcha key not provided")},[lt,dt,At,$t,ft,Qe,vt?.element]);var Dt=reactExports.useCallback(function(Bt){if(!Tt||!Tt.execute)throw new Error("<GoogleReCaptchaProvider /> Google Recaptcha has not been loaded");return Tt.execute(Nt.current,{action:Bt})},[Tt,Nt]),Ft=reactExports.useMemo(function(){return{executeRecaptcha:Tt?Dt:void 0,container:vt?.element}},[Dt,Tt,vt?.element]);return React.createElement(v$1.Provider,{value:Ft},kt)}var g=function(){return reactExports.useContext(v$1)};function w$1(He,Qe){return He(Qe={exports:{}},Qe.exports),Qe.exports;/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */}var $$1=typeof Symbol=="function"&&Symbol.for,C=$$1?Symbol.for("react.element"):60103,P$1=$$1?Symbol.for("react.portal"):60106,x$1=$$1?Symbol.for("react.fragment"):60107,E$1=$$1?Symbol.for("react.strict_mode"):60108,R=$$1?Symbol.for("react.profiler"):60114,M$1=$$1?Symbol.for("react.provider"):60109,N$1=$$1?Symbol.for("react.context"):60110,O$2=$$1?Symbol.for("react.async_mode"):60111,_$1=$$1?Symbol.for("react.concurrent_mode"):60111,T=$$1?Symbol.for("react.forward_ref"):60112,j$1=$$1?Symbol.for("react.suspense"):60113,L=$$1?Symbol.for("react.suspense_list"):60120,k=$$1?Symbol.for("react.memo"):60115,F=$$1?Symbol.for("react.lazy"):60116,A$2=$$1?Symbol.for("react.block"):60121,V$1=$$1?Symbol.for("react.fundamental"):60117,z=$$1?Symbol.for("react.responder"):60118,G$1=$$1?Symbol.for("react.scope"):60119;function I(He){if(typeof He=="object"&&He!==null){var Qe=He.$$typeof;switch(Qe){case C:switch(He=He.type){case O$2:case _$1:case x$1:case R:case E$1:case j$1:return He;default:switch(He=He&&He.$$typeof){case N$1:case T:case F:case k:case M$1:return He;default:return Qe}}case P$1:return Qe}}}function D$1(He){return I(He)===_$1}var q$1={AsyncMode:O$2,ConcurrentMode:_$1,ContextConsumer:N$1,ContextProvider:M$1,Element:C,ForwardRef:T,Fragment:x$1,Lazy:F,Memo:k,Portal:P$1,Profiler:R,StrictMode:E$1,Suspense:j$1,isAsyncMode:function(He){return D$1(He)||I(He)===O$2},isConcurrentMode:D$1,isContextConsumer:function(He){return I(He)===N$1},isContextProvider:function(He){return I(He)===M$1},isElement:function(He){return typeof He=="object"&&He!==null&&He.$$typeof===C},isForwardRef:function(He){return I(He)===T},isFragment:function(He){return I(He)===x$1},isLazy:function(He){return I(He)===F},isMemo:function(He){return I(He)===k},isPortal:function(He){return I(He)===P$1},isProfiler:function(He){return I(He)===R},isStrictMode:function(He){return I(He)===E$1},isSuspense:function(He){return I(He)===j$1},isValidElementType:function(He){return typeof He=="string"||typeof He=="function"||He===x$1||He===_$1||He===R||He===E$1||He===j$1||He===L||typeof He=="object"&&He!==null&&(He.$$typeof===F||He.$$typeof===k||He.$$typeof===M$1||He.$$typeof===N$1||He.$$typeof===T||He.$$typeof===V$1||He.$$typeof===z||He.$$typeof===G$1||He.$$typeof===A$2)},typeOf:I},B=w$1(function(He,Qe){}),J$1=(B.AsyncMode,B.ConcurrentMode,B.ContextConsumer,B.ContextProvider,B.Element,B.ForwardRef,B.Fragment,B.Lazy,B.Memo,B.Portal,B.Profiler,B.StrictMode,B.Suspense,B.isAsyncMode,B.isConcurrentMode,B.isContextConsumer,B.isContextProvider,B.isElement,B.isForwardRef,B.isFragment,B.isLazy,B.isMemo,B.isPortal,B.isProfiler,B.isStrictMode,B.isSuspense,B.isValidElementType,B.typeOf,w$1(function(He){He.exports=q$1})),H$1={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Q={};Q[J$1.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Q[J$1.Memo]=H$1;const InvisibleReCaptchaImplementation=reactExports.forwardRef(({setCaptchaReady:He},Qe)=>{const{executeRecaptcha:it}=g();return reactExports.useEffect(()=>{He?.(it!=null)}),reactExports.useImperativeHandle(Qe,()=>({getToken:async()=>{if(!it)throw new CaptchaError("recaptcha not prepared");return{token:await it(),provider:"recaptcha"}}}),[it]),null}),InvisibleReCaptchaWrapper=reactExports.forwardRef(({...He},Qe)=>jsxRuntimeExports.jsx(h,{reCaptchaKey:config$1.recaptchaSiteKey,children:jsxRuntimeExports.jsx(InvisibleReCaptchaImplementation,{ref:Qe,...He})}));var se$1=({as:He="div",...Qe},it)=>jsxRuntimeExports.jsx(He,{...Qe,ref:it}),V=reactExports.forwardRef(se$1),Y$1="https://challenges.cloudflare.com/turnstile/v0/api.js",w="cf-turnstile-script",A$1="cf-turnstile",S="onloadTurnstileCallback",D=He=>!!document.getElementById(He),q=({render:He="explicit",onLoadCallbackName:Qe=S,scriptOptions:{nonce:it="",defer:lt=!0,async:ut=!0,id:dt="",appendTo:xt,onError:ft,crossOrigin:vt=""}={}})=>{let kt=dt||w;if(D(kt))return;let St=document.createElement("script");St.id=kt,St.src=`${Y$1}?onload=${Qe}&render=${He}`,!document.querySelector(`script[src="${St.src}"]`)&&(St.defer=!!lt,St.async=!!ut,it&&(St.nonce=it),vt&&(St.crossOrigin=vt),ft&&(St.onerror=ft,delete window[Qe]),(xt==="body"?document.body:document.getElementsByTagName("head")[0]).appendChild(St))},l={normal:{width:300,height:65},compact:{width:150,height:140},invisible:{width:0,height:0,overflow:"hidden"},flexible:{minWidth:300,width:"100%",height:65},interactionOnly:{width:"fit-content",height:"auto",display:"flex"}};function J(He){if(He!=="invisible"&&He!=="interactionOnly")return He}function O$1(He=w){let[Qe,it]=reactExports.useState(!1);return reactExports.useEffect(()=>{let lt=()=>{D(He)&&it(!0)},ut=new MutationObserver(lt);return ut.observe(document,{childList:!0,subtree:!0}),lt(),()=>{ut.disconnect()}},[He]),Qe}var b="unloaded",G,fe=new Promise((He,Qe)=>{G={resolve:He,reject:Qe},b==="ready"&&He(void 0)}),me=(He=S)=>(b==="unloaded"&&(b="loading",window[He]=()=>{G.resolve(),b="ready",delete window[He]}),fe),Te$1=reactExports.forwardRef((He,Qe)=>{let{scriptOptions:it,options:lt={},siteKey:ut,onWidgetLoad:dt,onSuccess:xt,onExpire:ft,onError:vt,onBeforeInteractive:kt,onAfterInteractive:St,onUnsupported:Tt,onTimeout:Mt,onLoadScript:Nt,id:At,style:$t,as:Dt="div",injectScript:Ft=!0,...Bt}=He,Ot=lt.size,Qt=reactExports.useCallback(()=>typeof Ot>"u"?{}:lt.execution==="execute"?l.invisible:lt.appearance==="interaction-only"?l.interactionOnly:l[Ot],[lt.execution,Ot,lt.appearance]),[Wt,Xt]=reactExports.useState(Qt()),Kt=reactExports.useRef(null),[Jt,hr]=reactExports.useState(!1),xr=reactExports.useRef(),gr=reactExports.useRef(!1),br=At||A$1,vr=it?.id||w,yr=O$1(vr),Cr=it?.onLoadCallbackName||S,Rr=lt.appearance||"always",Ir=reactExports.useMemo(()=>({sitekey:ut,action:lt.action,cData:lt.cData,callback:$r=>{gr.current=!0,xt?.($r)},"error-callback":vt,"expired-callback":ft,"before-interactive-callback":kt,"after-interactive-callback":St,"unsupported-callback":Tt,theme:lt.theme||"auto",language:lt.language||"auto",tabindex:lt.tabIndex,"response-field":lt.responseField,"response-field-name":lt.responseFieldName,size:J(Ot),retry:lt.retry||"auto","retry-interval":lt.retryInterval||8e3,"refresh-expired":lt.refreshExpired||"auto","refresh-timeout":lt.refreshTimeout||"auto",execution:lt.execution||"render",appearance:lt.appearance||"always","feedback-enabled":lt.feedbackEnabled||!0,"timeout-callback":Mt}),[lt.action,lt.appearance,lt.cData,lt.execution,lt.language,lt.refreshExpired,lt.responseField,lt.responseFieldName,lt.retry,lt.retryInterval,lt.tabIndex,lt.theme,lt.feedbackEnabled,lt.refreshTimeout,ut,Ot]),Tr=reactExports.useCallback(()=>typeof window<"u"&&!!window.turnstile,[]);return reactExports.useEffect(function(){Ft&&!Jt&&q({onLoadCallbackName:Cr,scriptOptions:{...it,id:vr}})},[Ft,Jt,it,vr]),reactExports.useEffect(function(){b!=="ready"&&me(Cr).then(()=>hr(!0)).catch(console.error)},[]),reactExports.useEffect(function(){if(!Kt.current||!Jt)return;let $r=!1;return(async()=>{if($r||!Kt.current)return;let Zr=window.turnstile.render(Kt.current,Ir);xr.current=Zr,xr.current&&dt?.(xr.current)})(),()=>{$r=!0,xr.current&&(window.turnstile.remove(xr.current),gr.current=!1)}},[br,Jt,Ir]),reactExports.useImperativeHandle(Qe,()=>{let{turnstile:$r}=window;return{getResponse(){if(!$r?.getResponse||!xr.current||!Tr()){console.warn("Turnstile has not been loaded");return}return $r.getResponse(xr.current)},async getResponsePromise(Zr=3e4,Sr=100){return new Promise((Dr,wr)=>{let qr,Nr=async()=>{if(gr.current&&window.turnstile&&xr.current)try{let Jr=window.turnstile.getResponse(xr.current);return qr&&clearTimeout(qr),Jr?Dr(Jr):wr(new Error("No response received"))}catch(Jr){return qr&&clearTimeout(qr),console.warn("Failed to get response",Jr),wr(new Error("Failed to get response"))}qr||(qr=setTimeout(()=>{qr&&clearTimeout(qr),wr(new Error("Timeout"))},Zr)),await new Promise(Jr=>setTimeout(Jr,Sr)),await Nr()};Nr()})},reset(){if(!$r?.reset||!xr.current||!Tr()){console.warn("Turnstile has not been loaded");return}lt.execution==="execute"&&Xt(l.invisible);try{gr.current=!1,$r.reset(xr.current)}catch(Zr){console.warn(`Failed to reset Turnstile widget ${xr}`,Zr)}},remove(){if(!$r?.remove||!xr.current||!Tr()){console.warn("Turnstile has not been loaded");return}Xt(l.invisible),gr.current=!1,$r.remove(xr.current),xr.current=null},render(){if(!$r?.render||!Kt.current||!Tr()||xr.current){console.warn("Turnstile has not been loaded or container not found");return}let Zr=$r.render(Kt.current,Ir);return xr.current=Zr,xr.current&&dt?.(xr.current),lt.execution!=="execute"&&Xt(Ot?l[Ot]:{}),Zr},execute(){if(lt.execution!=="execute"){console.warn('Execution mode is not set to "execute"');return}if(!$r?.execute||!Kt.current||!xr.current||!Tr()){console.warn("Turnstile has not been loaded or container not found");return}$r.execute(Kt.current,Ir),Xt(Ot?l[Ot]:{})},isExpired(){return!$r?.isExpired||!xr.current||!Tr()?(console.warn("Turnstile has not been loaded"),!1):$r.isExpired(xr.current)}}},[xr,lt.execution,Ot,Ir,Kt,Tr,Jt,dt]),reactExports.useEffect(()=>{yr&&!Jt&&window.turnstile&&hr(!0)},[Jt,yr]),reactExports.useEffect(()=>{Xt(Qt())},[lt.execution,Ot,Rr]),reactExports.useEffect(()=>{!yr||typeof Nt!="function"||Nt()},[yr]),jsxRuntimeExports.jsx(V,{ref:Kt,as:Dt,id:br,style:{...Wt,...$t},...Bt})});Te$1.displayName="Turnstile";const common={palette:{},components:{MuiButton:{styleOverrides:{root:{textTransform:"none"}}}},typography:{fontFamily:"Inter, system-ui, -apple-system, sans-serif"},shape:{borderRadius:8}},lightTheme=createMuiStrictModeTheme({...common,palette:{...common.palette,mode:"light",primary:{main:"#000000"},secondary:{main:"#efefef",contrastText:"#000"}}}),darkTheme=createMuiStrictModeTheme({...common,palette:{...common.palette,mode:"dark",primary:{main:"#fff"}}});let colorModeValue;const getColorModeValue=()=>colorModeValue,ColorModeContext=reactExports.createContext({mode:"light",themeType:"light",changeColorMode:()=>{}}),useColorModeContext=()=>reactExports.useContext(ColorModeContext),ColorModeProvider=({children:He})=>{const Qe=useExperimentParam("exp2511-default-color-mode-ab"),[it,lt]=useLocalStorage({key:"app-color-theme",defaultValue:Qe==="treatment"?"auto":"light"});it||shouldNotHappen();const ut=useMediaQuery("(prefers-color-scheme: dark)"),dt=useMediaQuery("(prefers-color-scheme: light)"),xt=colorModeValue=reactExports.useMemo(()=>it==="auto"?ut?"dark":"light":it,[it,ut]),ft=reactExports.useMemo(()=>xt==="dark"?darkTheme:lightTheme,[xt]);reactExports.useEffect(()=>{xt==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[xt]),reactExports.useEffect(()=>{let kt="no-preference";ut?kt="dark":dt&&(kt="light"),trackerSetUserProperties({systemColorPreference:kt})},[ut,dt]);const vt=reactExports.useMemo(()=>({mode:it,themeType:xt,changeColorMode:lt}),[it,lt,xt]);return jsxRuntimeExports.jsx(ColorModeContext.Provider,{value:vt,children:jsxRuntimeExports.jsx(ThemeProvider,{theme:ft,children:He})})},InvisibleTurnstileWrapper=reactExports.forwardRef(({setCaptchaReady:He,action:Qe},it)=>{const lt=reactExports.useRef(null),ut=reactExports.useRef("");return reactExports.useImperativeHandle(it,()=>({getToken:async()=>{const dt=lt.current;if(!dt)throw new CaptchaError("turnstile not prepared");const ft=await(async()=>{try{return await dt.getResponsePromise(5e3,250)}catch{throw new CaptchaError(`trunstile error: ${ut.current}`)}})();if(ft==null)throw new CaptchaError("turnstile token acquisition failed");return{token:ft,provider:"turnstile",turnstileWidgetMode:TurnstileWidgetMode.Invisible}},reset:()=>{lt.current?.reset()}}),[]),jsxRuntimeExports.jsx(Te$1,{siteKey:getTurnstileSiteKey(TurnstileWidgetMode.Invisible),options:{size:"invisible",action:Qe},onWidgetLoad:()=>{He?.(!0)},onError:dt=>{console.warn("turnstile error:",dt),ut.current=dt},ref:lt})}),VisibleTurnstileWrapper=reactExports.forwardRef(({setToken:He,action:Qe,turnstileWidgetMode:it=TurnstileWidgetMode.Managed},lt)=>{const ut=reactExports.useRef(null);reactExports.useImperativeHandle(lt,()=>({reset:()=>{ut.current?.reset()}}));const[dt,xt]=reactExports.useState();reactExports.useEffect(()=>{He?.(dt)},[dt,He]);const{themeType:ft}=useColorModeContext(),{i18n:vt}=useTranslation(),kt=vt.language,St=kt==="zh"?"zh-tw":kt;return jsxRuntimeExports.jsx(Te$1,{siteKey:getTurnstileSiteKey(it),options:{size:"flexible",action:Qe,theme:ft,language:St},onError:Tt=>{console.warn("turnstile error:",Tt),xt(void 0)},onExpire:()=>{xt(void 0)},onSuccess:Tt=>{xt({token:Tt,provider:"turnstile",turnstileWidgetMode:it})},ref:ut})}),InvisibleCaptcha=reactExports.forwardRef(({provider:He,...Qe},it)=>$$3(He).with("recaptcha",()=>jsxRuntimeExports.jsx(InvisibleReCaptchaWrapper,{ref:it,...Qe})).with("turnstile",()=>jsxRuntimeExports.jsx(InvisibleTurnstileWrapper,{ref:it,...Qe})).otherwise(()=>null)),VisibleCaptcha=reactExports.forwardRef(({provider:He,...Qe},it)=>$$3(He).with("turnstile",()=>jsxRuntimeExports.jsx(VisibleTurnstileWrapper,{ref:it,...Qe})).otherwise(()=>null)),LOGIN_CAPTCHA_EXPERIMENT_NAME="2507-login-register-recaptcha-turnstile",captchaVariants={recaptcha:"recaptcha",turnstileInvisible:"turnstile-invisible",turnstileNonInteractive:"turnstile-non-interactive",turnstileManaged:"turnstile-managed"},useLoginCaptchaExperiment=()=>{const{value:He,loading:Qe}=useExperimentParamValue(LOGIN_CAPTCHA_EXPERIMENT_NAME);return{provider:$$3(He).returnType().with(captchaVariants.recaptcha,()=>"recaptcha").with(captchaVariants.turnstileInvisible,()=>"turnstile").with(captchaVariants.turnstileNonInteractive,()=>"turnstile").with(captchaVariants.turnstileManaged,()=>"turnstile").otherwise(()=>"recaptcha"),visible:He===captchaVariants.turnstileNonInteractive||He===captchaVariants.turnstileManaged,turnstileWidgetMode:$$3(He).returnType().with(captchaVariants.recaptcha,()=>{}).with(captchaVariants.turnstileInvisible,()=>TurnstileWidgetMode.Invisible).with(captchaVariants.turnstileNonInteractive,()=>TurnstileWidgetMode.NonInteractive).with(captchaVariants.turnstileManaged,()=>TurnstileWidgetMode.Managed).otherwise(()=>{}),loading:Qe}},NormalInput=styled(InputBase)(({theme:He})=>({"label + &":{marginTop:He.spacing(3)},"& .MuiInputBase-input":{borderRadius:He.shape.borderRadius,position:"relative",backgroundColor:He.palette.mode==="light"?"#fcfcfb":"#2b2b2b",border:"1px solid #ced4da",fontSize:16,width:"100%",padding:"10px 12px",transition:He.transitions.create(["border-color","background-color","box-shadow"]),fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"','"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:focus":{borderColor:He.palette.primary.main}}})),OTPForm=({onSubmit:He})=>{const{t:Qe}=useTranslation(["auth"]),[it,lt]=reactExports.useState("");return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-8",children:[jsxRuntimeExports.jsxs(FormControl,{variant:"standard",children:[jsxRuntimeExports.jsx(InputLabel,{shrink:!0,children:Qe("auth:mfa.otp.code.label")}),jsxRuntimeExports.jsx(NormalInput,{value:it,onChange:ut=>lt(ut.target.value)})]}),jsxRuntimeExports.jsx("div",{className:"w-full flex justify-end",children:jsxRuntimeExports.jsx(Button,{variant:"contained",color:"primary",onClick:()=>{He(it)},children:Qe("auth:mfa.otp.code.submit")})})]})},MFAForm=({type:He,key:Qe,onSubmit:it})=>{const{t:lt}=useTranslation(["auth"]),ut=He==="otp"?jsxRuntimeExports.jsx(OTPForm,{onSubmit:dt=>{it({type:"otp",code:dt})}}):jsxRuntimeExports.jsxs("div",{children:[lt("auth:mfa.not-supported"),": ",He]});return jsxRuntimeExports.jsx("div",{className:"p-8",children:ut})},dialogMFA=He=>new Promise(async(Qe,it)=>{const lt=dialog({children:jsxRuntimeExports.jsx(MFAForm,{type:He.type,onSubmit:ut=>{lt.current?.close(),Qe(ut)},onCancel:()=>{lt.current?.close(),it(UserCancelled)}},He.key),onClose:()=>{it(UserCancelled)}})}),biTwitterX=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07l-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865z"})}),icBaselineApple=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17.05 20.28c-.98.95-2.05.8-3.08.35c-1.09-.46-2.09-.48-3.24 0c-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8c1.18-.24 2.31-.93 3.57-.84c1.51.12 2.65.72 3.4 1.8c-3.12 1.87-2.38 5.98.48 7.13c-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25c.29 2.58-2.34 4.5-3.74 4.25z"})}),logosDiscordIcon=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 256 199",width:"1.55em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"#5865F2",d:"M216.856 16.597A208.502 208.502 0 0 0 164.042 0c-2.275 4.113-4.933 9.645-6.766 14.046c-19.692-2.961-39.203-2.961-58.533 0c-1.832-4.4-4.55-9.933-6.846-14.046a207.809 207.809 0 0 0-52.855 16.638C5.618 67.147-3.443 116.4 1.087 164.956c22.169 16.555 43.653 26.612 64.775 33.193A161.094 161.094 0 0 0 79.735 175.3a136.413 136.413 0 0 1-21.846-10.632a108.636 108.636 0 0 0 5.356-4.237c42.122 19.702 87.89 19.702 129.51 0a131.66 131.66 0 0 0 5.355 4.237a136.07 136.07 0 0 1-21.886 10.653c4.006 8.02 8.638 15.67 13.873 22.848c21.142-6.58 42.646-16.637 64.815-33.213c5.316-56.288-9.08-105.09-38.056-148.36M85.474 135.095c-12.645 0-23.015-11.805-23.015-26.18s10.149-26.2 23.015-26.2c12.867 0 23.236 11.804 23.015 26.2c.02 14.375-10.148 26.18-23.015 26.18m85.051 0c-12.645 0-23.014-11.805-23.014-26.18s10.148-26.2 23.014-26.2c12.867 0 23.236 11.804 23.015 26.2c0 14.375-10.148 26.18-23.015 26.18"})}),logosGoogleIcon=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 256 262",width:"1.18em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"#4285F4",d:"M255.878 133.451c0-10.734-.871-18.567-2.756-26.69H130.55v48.448h71.947c-1.45 12.04-9.283 30.172-26.69 42.356l-.244 1.622l38.755 30.023l2.685.268c24.659-22.774 38.875-56.282 38.875-96.027"}),jsxRuntimeExports.jsx("path",{fill:"#34A853",d:"M130.55 261.1c35.248 0 64.839-11.605 86.453-31.622l-41.196-31.913c-11.024 7.688-25.82 13.055-45.257 13.055c-34.523 0-63.824-22.773-74.269-54.25l-1.531.13l-40.298 31.187l-.527 1.465C35.393 231.798 79.49 261.1 130.55 261.1"}),jsxRuntimeExports.jsx("path",{fill:"#FBBC05",d:"M56.281 156.37c-2.756-8.123-4.351-16.827-4.351-25.82c0-8.994 1.595-17.697 4.206-25.82l-.073-1.73L15.26 71.312l-1.335.635C5.077 89.644 0 109.517 0 130.55s5.077 40.905 13.925 58.602z"}),jsxRuntimeExports.jsx("path",{fill:"#EB4335",d:"M130.55 50.479c24.514 0 41.05 10.589 50.479 19.438l36.844-35.974C195.245 12.91 165.798 0 130.55 0C79.49 0 35.393 29.301 13.925 71.947l42.211 32.783c10.59-31.477 39.891-54.251 74.414-54.251"})]}),OAuthProviders={google:{name:"Google",icon:jsxRuntimeExports.jsx(logosGoogleIcon,{className:"size-6"}),style:{color:"#000"},recommended:!0},twitter:{name:"Twitter",icon:jsxRuntimeExports.jsx(biTwitterX,{className:"size-5 ml-[2px] text-black dark:text-white"})},discord:{name:"Discord",icon:jsxRuntimeExports.jsx(logosDiscordIcon,{className:"size-6"}),style:{color:"#000"}},apple:{name:"Apple",icon:jsxRuntimeExports.jsx(icBaselineApple,{className:"size-6"}),style:{background:"#000",color:"#fff"}}},OAuthButton=({provider:He,children:Qe,scene:it,redirectUrl:lt,...ut})=>{const{t:dt}=useTranslation(["auth","action"]),xt=reactExports.useCallback(Tt=>async()=>{track("oauth_btn_clicked",{provider:Tt,scene:it}),Tt!=="email"&&(Tt==="apple"&&!await dialogConfirm({title:null,description:jsxRuntimeExports.jsx(MarkdownRenderer,{className:"prose prose-sm prose-neutral dark:prose-invert",children:dt("auth:oauth.apple.login-alert.content")}),confirmLabel:dt("action:continue")}).then(()=>!0,()=>!1)||redirectToOAuth(Tt,lt))},[He,lt]),{icon:ft,iconUrl:vt,style:kt,recommended:St}=OAuthProviders[He];return jsxRuntimeExports.jsxs(Button,{onClick:xt(He),variant:"outlined",size:"large",className:"py-3 px-4 rounded-full border-card-border flex justify-between",style:ut.disabled?void 0:kt,startIcon:ft||jsxRuntimeExports.jsx("img",{src:vt,alt:`${He} icon`,className:"w-6 h-6 my-0"}),endIcon:jsxRuntimeExports.jsx("div",{className:"w-6"}),...ut,children:[jsxRuntimeExports.jsx("span",{className:"normal-case w-80 font-medium text-primary",children:Qe}),St&&jsxRuntimeExports.jsx("div",{className:"h-6 leading-6 absolute -top-3 right-4 px-2 text-white bg-recommended-badge rounded-full text-xs",children:dt("auth:recommended")})]})},OAuthButtons=He=>{const{t:Qe}=useTranslation(["auth"]),it=He.scene==="login"?"auth:continue-with":"auth:sign-up-with";return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(OAuthButton,{provider:"google",...He,children:Qe(it,{provider:Qe("auth:provider.google")})}),jsxRuntimeExports.jsx(OAuthButton,{provider:"discord",...He,children:Qe(it,{provider:Qe("auth:provider.discord")})}),jsxRuntimeExports.jsx(OAuthButton,{provider:"twitter",...He,children:Qe(it,{provider:Qe("auth:provider.twitter")})})]})},AuthForm=({isEmailSign:He,setIsEmailSign:Qe,isLogin:it,setIsLogin:lt,onSuccess:ut,onClose:dt,initialErrorMessage:xt,oauthRedirectUrl:ft})=>{const{t:vt}=useTranslation(["auth","user"]),{provider:kt,visible:St,turnstileWidgetMode:Tt,loading:Mt}=useLoginCaptchaExperiment(),[Nt,At]=reactExports.useState(!1),$t=reactExports.useRef(null),[Dt,Ft]=reactExports.useState(void 0),Bt=reactExports.useRef(null),{values:{email:Ot,password:Qt},getValues:Wt,handleChange:Xt}=useForm$1(),[Kt,Jt]=reactExports.useState(!0),[hr,xr]=reactExports.useState(),[gr,br]=reactExports.useState(xt),[vr,yr]=useLoadingCallback(async(Zr,Sr={})=>{Zr?.preventDefault();const Dr=await Wt();if(!Dr)return;const{email:wr,password:qr}=Dr;if(!(!wr||!qr))try{let Nr;if(St){if(!Dt)throw new CaptchaError("Captcha is not passed");Nr=Dt}else{const es=$t.current?.getToken;if(!es)throw new CaptchaError("Captcha is not loaded");Nr=await es()}const{token:Jr,provider:Qr,turnstileWidgetMode:Ur}=Nr;br("");const nn={...Dr,mfaRequest:Sr.mfaRequest};Qr==="recaptcha"?nn.recaptchaToken=Jr:(nn.turnstileToken=Jr,nn.turnstileWidgetMode=Ur);let Cn;if(it)Cn=(await executeLogin({input:nn})).data?.login,updateGetUserInfo(Cn);else{Cn=(await executeRegister({input:nn})).data?.register,trackerSetUserProperties({createdAt:Cn?.createdAt}),updateGetUserInfo(Cn);const Xr=getPostRegistrationRequests({promoEmailPref:Kt});await Promise.all(Xr)}Cn&&(trackerSetUserId(Cn.id),track(it?"login_success":"register_success",{type:"email"})),br(""),ut?.()}catch(Nr){if(getErrorCode(Nr)==="MFA_REQUIRED"){dialogMFA(getErrorData(Nr)).then(Jr=>{br("Please pass the captcha and login again"),xr(Jr)}).catch(Jr=>{Jr!==UserCancelled&&br(Jr.message)});return}br(Nr.message),track(it?"login_failed":"register_failed",{error:Nr.message}),errorIsUnknownError(Nr)&&captureException(Nr)}finally{$t.current?.reset?.(),Bt.current?.reset?.()}},[it,Kt,Dt]),Cr=St||Nt,Rr=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col justify-center gap-4",children:[jsxRuntimeExports.jsxs(FormControl,{variant:"standard",children:[jsxRuntimeExports.jsx(InputLabel,{className:"font-bold text-primary text-base w-full ",shrink:!0,htmlFor:"email-input",children:vt("auth:email")}),jsxRuntimeExports.jsx(NormalInput$1,{value:Ot,onChange:Xt("email"),type:"email",id:"email-input",onBlur:()=>{track("email_input_blur",{length:Ot?.length})},autoComplete:"email",placeholder:"Enter your email address"})]}),jsxRuntimeExports.jsxs(FormControl,{variant:"standard",children:[jsxRuntimeExports.jsx(InputLabel,{className:"font-bold text-primary text-base",shrink:!0,htmlFor:"password-input",children:vt("auth:password")}),jsxRuntimeExports.jsx(NormalInput$1,{value:Qt,onChange:Xt("password"),type:"password",id:"password-input",onBlur:()=>{track("password_input_blur",{length:Qt?.length})},autoComplete:it?"current-password":"new-password",placeholder:"Enter your password"})]}),!Mt&&St?jsxRuntimeExports.jsx("div",{className:"min-w-full self-center bg-zinc-200 dark:bg-zinc-800",children:jsxRuntimeExports.jsx(VisibleCaptcha,{provider:kt,setToken:Ft,turnstileWidgetMode:Tt,ref:Bt,action:"registerOrLogin"})}):null,!it&&jsxRuntimeExports.jsx(FormControlLabel,{control:jsxRuntimeExports.jsx(Checkbox,{checked:Kt,size:"small",onChange:Zr=>Jt(Zr.target.checked)}),label:jsxRuntimeExports.jsx("span",{className:"block text-wrap text-sm",children:vt("user:profile.receive-promo-emails")})}),it&&jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-4 justify-between",children:jsxRuntimeExports.jsx(Link,{className:"flex text-sm text-secondary-light font-normal cursor-pointer hover:underline justify-end",onClick:()=>{dt?.(),track("forget_password_link_click")},to:"/forget-password",children:vt("auth:forget-password")})}),jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",color:"theme",busy:!Cr||vr,type:"submit",className:"py-3 mt-2 mb-10 text-sm h-12 rounded-full",children:vt(it?"auth:login.label":"auth:signup.label")})]})}),Ir=()=>{dt?.(),openAppDownloadDialog({trackingArgs:{source:"user"}}),track("login_modal_app_download_click",{type:"standard"})},Tr=async()=>{await dialogConfirm({title:null,description:jsxRuntimeExports.jsx(MarkdownRenderer,{className:"prose prose-sm prose-neutral dark:prose-invert",children:vt("auth:oauth.apple.login-alert.content")}),confirmLabel:vt("action:continue")}).then(()=>!0,()=>!1)&&redirectToOAuth("apple")},$r=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4 max-w-full",children:[jsxRuntimeExports.jsx(OAuthButtons,{redirectUrl:ft,scene:it?"login":"register"}),jsxRuntimeExports.jsx(Button,{onClick:()=>{track(He?"third_party_platform_login_click":"continue_with_email_click"),Qe?.(!He)},variant:"outlined",size:"large",className:" py-3 px-4 rounded-full border-card-border flex flex-row justify-between",startIcon:jsxRuntimeExports.jsx(icBaselineMailOutline,{className:"size-6 my-0"}),endIcon:jsxRuntimeExports.jsx("div",{className:"w-6"}),children:jsxRuntimeExports.jsx("span",{className:"normal-case w-80 font-medium text-primary",children:vt(it?"auth:continue-with":"auth:sign-up-with",{provider:vt("auth:provider.email")})})})]}),jsxRuntimeExports.jsx("div",{className:"w-full flex flex-col text-nowrap",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-200 text-center whitespace-pre-line",children:jsxRuntimeExports.jsx(Trans,{t:vt,i18nKey:vt("auth:tos.label",{context:"long"}),components:{privacy:jsxRuntimeExports.jsx(Link,{to:"/privacy",target:"_blank",className:"font-medium text-primary"}),tos:jsxRuntimeExports.jsx(Link,{to:"/terms",target:"_blank",className:"font-medium text-primary"})}})})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-row items-center	",children:[jsxRuntimeExports.jsxs("div",{className:"text-sm flex items-center cursor-pointer hover:underline text-nowrap",onClick:Ir,children:[jsxRuntimeExports.jsx(icOutlineInstallMobile,{className:"inline size-5 my-0 pr-1"}),vt("auth:mobile-app")]}),jsxRuntimeExports.jsx("div",{className:"mx-2 border-l items-center w-px h-4"}),jsxRuntimeExports.jsx("div",{onClick:Tr,className:"text-sm cursor-pointer hover:underline text-nowrap",children:vt("auth:find-my-apple-account")})]})})]})});return jsxRuntimeExports.jsxs("div",{className:"w-full",children:[jsxRuntimeExports.jsxs("form",{className:"flex flex-col gap-4",noValidate:!0,onSubmit:Zr=>yr(Zr,{mfaRequest:hr}),children:[gr?jsxRuntimeExports.jsx(Alert,{severity:"warning",children:gr}):null,He?Rr:$r]}),!Mt&&!St?jsxRuntimeExports.jsx(InvisibleCaptcha,{provider:kt,setCaptchaReady:At,ref:$t,action:"registerOrLogin"}):null]})},Sign=({isLogin:He,setIsLogin:Qe,onSuccess:it,onClose:lt,isSignPage:ut,oauthRedirectUrl:dt})=>{const{t:xt}=useTranslation(["auth","common","growth"]),{data:ft}=useUserInfo(),[{error:vt,debug:kt,to:St}]=useQs(),Tt=useLocation(),Mt=useNavigate();reactExports.useEffect(()=>{kt||ft&&(St?Mt(St):ut&&Mt("/"))},[ft,kt,St,Tt.pathname,ut]);const[Nt,At]=reactExports.useState(!1),$t=jsxRuntimeExports.jsx("p",{className:"pb-4 w-full flex flex-col items-center justify-center text-3xl font-bold",children:xt(He?"auth:sign-in":"auth:register")}),Dt=jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{className:"pt-4 pb-4 w-full flex flex-col items-center justify-center text-4xl font-bold",children:xt(He?"auth:sign-in":"auth:register")})});return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:max-w-[924px] md:h-[700px]",children:[jsxRuntimeExports.jsxs("div",{children:[Nt&&jsxRuntimeExports.jsx("button",{onClick:()=>{At(!1)},className:"float-left cursor-pointer",children:jsxRuntimeExports.jsx(icBaselineChevronLeft,{className:"mt-4 ml-4 size-6"})}),lt&&jsxRuntimeExports.jsx("button",{onClick:lt,className:"float-right cursor-pointer",children:jsxRuntimeExports.jsx(icBaselineClose,{className:"mt-4 mr-4 size-6 opacity-80"})})]}),jsxRuntimeExports.jsx("div",{className:"flex flex-col md:flex-row gap-6 px-8 pb-8 justify-center h-full",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-1 md:min-w-[460px] w-full",children:[jsxRuntimeExports.jsxs("div",{className:"px-8 pt-0 pb-4 md:pt-8 md:pb-8 flex flex-col gap-10 w-full ",children:[Nt?$t:Dt,jsxRuntimeExports.jsx(AuthForm,{isEmailSign:Nt,setIsEmailSign:At,isLogin:He,setIsLogin:Qe,onSuccess:it,onClose:lt,initialErrorMessage:vt,oauthRedirectUrl:dt})]}),jsxRuntimeExports.jsx(Divider,{className:"w-full"}),jsxRuntimeExports.jsxs("div",{className:"py-4 md:py-8 w-full text-md flex flex-row justify-center items-center",children:[xt(He?"auth:login.hint.no-account":"auth:already-have-an-account-2")," ",jsxRuntimeExports.jsx("span",{onClick:()=>{Qe?.(!He)},className:"text-blue-600 cursor-pointer hover:underline",children:xt(He?"auth:register":"auth:sign-in")})]})]})})]})})},SignModal=reactExports.forwardRef(({open:He=!1,onSuccess:Qe,onClose:it,disableClose:lt,oauthRedirectUrl:ut,skipAfterAuthDialogs:dt,isLoginInit:xt=!0},ft)=>{const[vt,kt]=reactExports.useState(He),[St,Tt]=reactExports.useState(xt);return reactExports.useEffect(()=>{vt||endEventGroup("login_source")},[vt]),reactExports.useImperativeHandle(ft,()=>({open:(Mt=!1)=>{Tt(!Mt),kt(!0)},close:()=>{kt(!1)}}),[]),jsxRuntimeExports.jsx(ResponsiveDialog,{open:vt,dialogProps:{maxWidth:!1,fullWidth:!1},onClose:lt?void 0:()=>{kt(!1),it?.()},className:"rounded-2xl",children:jsxRuntimeExports.jsx(Sign,{isLogin:St,setIsLogin:Tt,onSuccess:()=>{Qe?.(St),dt||St||openRegisterOnboardingDialog(),kt(!1),it?.()},onClose:lt?void 0:()=>{kt(!1),it?.()},oauthRedirectUrl:ut})})});SignModal.displayName="SignModal";let signModalOpened=!1;function openSignModal(He,Qe){if(!signModalOpened){startEventGroup("login_source"),track("signup_login_show",Qe);try{dynamicCreateElement(jsxRuntimeExports.jsx(SignModal,{open:!0,...He,onClose:()=>{signModalOpened=!1,He?.onClose?.()}})),signModalOpened=!0}catch{}}}function isUserVerified(He){return He?.verificationStatus!=null}function userHasMembership(He){return He?.membership?.tier!=null}const UserSubscriptionStatus={active:"active",canceled:"canceled",pending:"pending",inactive:"inactive"};function userHasNotVerifiedEmail(He){return He&&He.email&&!He.emailVerified||!1}const SHOW_USER_EMAIL_VERIFICATION_DOT_KEY="growth:show-user-email-verification-dot";function useShowEmailVerificationDot(He,Qe){const[it,lt]=useLocalStorage({key:SHOW_USER_EMAIL_VERIFICATION_DOT_KEY,defaultValue:["account-btn","account-menu","user-profile-btn"]}),ut=reactExports.useCallback(()=>{lt(ft=>{const vt=new Set(ft);return vt.delete(He),[...vt]})},[lt,He]),dt=userHasNotVerifiedEmail(Qe);return[reactExports.useMemo(()=>dt?it?it?.includes(He):!0:!1,[dt,it,He]),ut]}async function ensureLogIn(He){getToken()||await new Promise((Qe,it)=>{openSignModal({onSuccess:Qe,onClose:()=>{getToken()||it()}},He)})}function createProfileUrl(He,Qe){return`/@${He.username}`}function useUserIsRevivable(){const{data:He}=useUserInfo();return He?.deleteAfter&&new Date(He.deleteAfter).getTime()>new Date().getTime()}function useCanUsePrivateChannel(){const{me:He}=useMe();return(He?.membership?.tier??0)>=2}function useMe(){const{data:He,...Qe}=useUserInfo();return{me:He,beingAdmin:!!He?.isAdmin,beingMember:userHasMembership(He),membershipTier:He?.membership?.tier,...Qe}}function useIsModelAlphaTester(){const{me:He,loading:Qe}=useMe(),{data:it,isValidating:lt}=useMyRoles({last:1,names:[MODEL_ALPHA_TESTER_USER_ROLE]}),ut=(it?.length??0)>0;return{value:He?.id&&ut,loading:Qe||lt}}getDefaultStore();const GrowthEventName={SpringEvent2025:"springEvent2025",AprilFoolsDay2025:"aprilFoolsDay2025",ditModelReleaseEvent:DIT_MODEL_RELEASE_EVENT_NAME,SummerEvent2025:"summerEvent2025",AugustEvent2025:"augustEvent2025"},eventsAtom=atom({[GrowthEventName.ditModelReleaseEvent]:{configKey:DIT_MODEL_RELEASE_EVENT_NAME},[GrowthEventName.SummerEvent2025]:{configKey:"summerEvent2025"},[GrowthEventName.AugustEvent2025]:{configKey:"augustEvent2025"}});function useGrowthEvent(He){const[Qe,it]=useImmerAtom(eventsAtom),{configKey:lt,enabled:ut,enabledForAdmin:dt,startDate:xt,endDate:ft,countdown:vt}=Qe[He]??{endDate:"2000-01-01T00:00:00Z"},{beingAdmin:kt}=useMe(),St=ut||kt&&dt,{data:Tt}=useDynamicConstants(),Mt=get$3(Tt,lt);reactExports.useEffect(()=>{Mt&&it($t=>{Object.assign($t[He],pick$1(Mt,["enabled","enabledForAdmin","startDate","endDate","countdown"]))})},[He,Mt,it]);const{started:Nt,ended:At}=useNow(reactExports.useCallback($t=>({started:!!xt&&new Date(xt).getTime()<=$t,ended:!!ft&&new Date(ft).getTime()<$t}),[xt,ft]));return reactExports.useMemo(()=>({enabled:St,startDate:xt,endDate:ft,started:Nt,ended:At,ongoing:St&&Nt&&!At,countdown:vt}),[St,xt,ft,Nt,At,vt])}const UserAvatarFrameName={IceCream2025:"iceCream2025",SodaFloat2025:"sodaFloat2025"},USER_AVATAR_FRAME_DICT={[UserAvatarFrameName.IceCream2025]:{name:UserAvatarFrameName.IceCream2025,group:GrowthEventName.SummerEvent2025,src:IMG_ICE_CREAM_2025,style:{width:"113.3787%",height:"105.6689%",left:"-9.9773%",top:"-2.9478%"}},[UserAvatarFrameName.SodaFloat2025]:{name:UserAvatarFrameName.SodaFloat2025,group:GrowthEventName.SummerEvent2025,src:IMG_SODA_FLOAT_2025,style:{width:"113.3787%",height:"106.576%",left:"-10.2041%",top:"-3.1746%"}}};function getUserAvatarFrameDataByName(He){return USER_AVATAR_FRAME_DICT[He]}function getUserActiveAvatarFrameDecoration(He){return He?.activeDecorations?.find(it=>it.decoration.type===DecorationType.AvatarFrame)}const BadgeGroupName={SpringEvent2025:"springEvent2025",AprilFoolsDay2025:"aprilFoolsDay2025"},BadgeName={Clown:"clownDecoration",Chip:"specialMemberDecoration100",Jackpot:"specialMemberDecoration300",Primrose:"primroseDecoration",Tulip:"tulipDecoration",CherryBlossom:"cherryBlossomDecoration"},BadgeData={[BadgeName.Clown]:{Icon:reactExports.lazy(()=>__vitePreload(()=>import("./clown-wlHXvNZI.js"),__vite__mapDeps([21,3,4,1]),import.meta.url)),irregular:!0,color:"#c084fc"},[BadgeName.Chip]:{Icon:reactExports.lazy(()=>__vitePreload(()=>import("./chip-B6bSLI_A.js"),__vite__mapDeps([22,3,4,1]),import.meta.url))},[BadgeName.Jackpot]:{Icon:reactExports.lazy(()=>__vitePreload(()=>import("./jackpot-CLMivLm8.js"),__vite__mapDeps([23,3,4,1]),import.meta.url)),irregular:!0,color:"#fbbf24"},[BadgeName.Primrose]:{Icon:reactExports.lazy(()=>__vitePreload(()=>import("./primrose-b67mAatV.js"),__vite__mapDeps([24,3,4,1]),import.meta.url)),rareness:"r"},[BadgeName.Tulip]:{Icon:reactExports.lazy(()=>__vitePreload(()=>import("./tulip-BVg-nxiH.js"),__vite__mapDeps([25,3,4,1]),import.meta.url)),rareness:"sr"},[BadgeName.CherryBlossom]:{Icon:reactExports.lazy(()=>__vitePreload(()=>import("./cherry_blossom-DlsSou9N.js"),__vite__mapDeps([26,3,4,1]),import.meta.url)),rareness:"ssr"}},BadgeGroups={[BadgeGroupName.AprilFoolsDay2025]:[BadgeName.Clown,BadgeName.Chip,BadgeName.Jackpot],[BadgeGroupName.SpringEvent2025]:[BadgeName.Primrose,BadgeName.Tulip,BadgeName.CherryBlossom]},BadgeIconStyles={[BadgeName.Clown]:{style:{width:"calc(var(--base-avatar-width) * 0.4)",height:"auto"}},[BadgeName.Chip]:{style:{width:"calc(var(--base-avatar-width) * 0.4)",height:"auto"}},[BadgeName.Jackpot]:{style:{width:"calc(var(--base-avatar-width) * 0.5)",height:"auto"}},[BadgeName.Primrose]:{style:{width:"calc(var(--base-avatar-width) * 0.4)",height:"auto"}},[BadgeName.Tulip]:{style:{width:"calc(var(--base-avatar-width) * 0.4)",height:"auto"}},[BadgeName.CherryBlossom]:{style:{width:"calc(var(--base-avatar-width) * 0.4)",height:"auto"}}};function AvatarBadge({user:He,className:Qe,style:it}){const lt=reactExports.useMemo(()=>resolveDecoration(He,He.activeDecorations?.find(xt=>xt.decoration.type===DecorationType.Badge)?.decoration),[He]);if(!lt)return null;if(lt==="membership")return jsxRuntimeExports.jsx(MembershipIconCircled,{className:twMerge(Qe,"outline outline-1 outline-black"),style:{width:"calc(var(--base-avatar-width) * 0.3)",height:"auto",...it}});const{Icon:ut}=BadgeData[lt],dt=BadgeIconStyles[lt];return jsxRuntimeExports.jsx(reactExports.Suspense,{children:jsxRuntimeExports.jsx(ut,{className:twMerge(dt.className,Qe),style:{...dt.style,...it}})})}function resolveDecoration(He,Qe){if(Qe)return Qe.code;if(userHasMembership(He))return"membership"}function AvatarFrame({className:He,style:Qe,frameName:it}){const lt=it&&getUserAvatarFrameDataByName(it);return lt?jsxRuntimeExports.jsx("img",{src:lt.src,alt:"",className:twMerge("absolute object-fill pointer-events-none",He),style:{maxWidth:"unset",...lt.style,...Qe}}):null}const styles$d={"profile-image-member-border":"_profile-image-member-border_jzjqh_1","profile-placeholder-member-border":"_profile-placeholder-member-border_jzjqh_9"};function UserAvatarImage({user:He,className:Qe,style:it,onLoadImageFailed:lt,...ut}){const dt=He?.avatarMediaId,[xt,ft]=reactExports.useState(!1),vt=getUserDisplayName(He);return jsxRuntimeExports.jsx("div",{className:twMerge("aspect-square overflow-hidden rounded-full",Qe),style:it,...ut,children:He&&(!dt||xt?jsxRuntimeExports.jsx(ImagePlaceholder,{user:He}):jsxRuntimeExports.jsx("img",{src:getImageThumbnailUrl(dt),alt:`Avatar image of ${vt}`,crossOrigin:"anonymous",onError:()=>{ft(!0),lt?.()},className:"size-full object-cover object-center"}))})}const INITIALS_FONT_SIZE_FACTOR=2.5,PLACEHOLDER_COLORS=["from-red-200 to-red-400 text-white","from-green-400 to-blue-400 text-white","from-yellow-500 to-red-800 text-white","from-yellow-200 to-amber-400 text-amber-900","from-pink-100 to-violet-300 text-violet-900","from-red-400 to-amber-500 text-white","from-yellow-300 to-green-300 text-green-900","from-pink-300 to-red-500 text-white","from-sky-300 to-yellow-300 text-sky-900","from-indigo-100 to-blue-300 text-indigo-900"];function ImagePlaceholder({user:He}){const Qe=reactExports.useMemo(()=>PLACEHOLDER_COLORS[hash(He.id)%PLACEHOLDER_COLORS.length],[He]),it=reactExports.useMemo(()=>{const dt=getUserDisplayName(He);if(!(!dt||dt===`user-${He.id}`))return dt.length<=2?dt:snakeCase(dt).split("_").slice(0,2).map(xt=>xt[0]).join("")},[He]),[lt,ut]=useResizeObserver();return jsxRuntimeExports.jsx("div",{ref:lt,className:twMerge("size-full grid place-content-center cursor-default select-none bg-gradient-to-br",Qe),children:jsxRuntimeExports.jsx("span",{className:"font-inter font-semibold uppercase",style:{fontSize:ut.width/INITIALS_FONT_SIZE_FACTOR},children:it})})}const UserAvatar=({user:He,style:Qe,className:it,displayRedDot:lt,decorations:ut,...dt})=>{const[xt,ft]=reactExports.useState(!1),vt=getUserActiveAvatarFrameDecoration(He)?.decoration.code,kt=$$3(ut).returnType().with({frame:N$4.select(N$4.string)},$t=>$t).with(N$4.union(N$4.optional(void 0),{frame:!0}),()=>vt).otherwise(()=>{});if(!He)return jsxRuntimeExports.jsx("div",{className:it,style:{borderRadius:"100%",margin:0,...Qe}});const St=userHasMembership(He)&&!kt,Tt=Qe?.width?isNaN(Number(Qe.width))?Qe.width:`${Qe.width} * 1px`:"40px",Mt=He.avatarMediaId&&!xt,Nt=jsxRuntimeExports.jsx(UserAvatarImage,{user:He,className:cx(St&&(Mt?styles$d["profile-image-member-border"]:styles$d["profile-placeholder-member-border"]),it),style:{...Mt&&St?{borderStyle:"solid",borderColor:"transparent",borderWidth:`calc(${Tt} * 0.05)`}:{},...Qe},onLoadImageFailed:()=>ft(!0)}),At=jsxRuntimeExports.jsx(Badge,{variant:"dot",color:"error",invisible:!lt,className:"size-full",classes:{badge:"top-0.5"},children:Nt});return jsxRuntimeExports.jsxs("div",{className:cx("relative",it),style:{"--base-avatar-width":Tt},...dt,children:[At,jsxRuntimeExports.jsx(AvatarFrame,{frameName:kt}),(ut?.badge??!0)&&jsxRuntimeExports.jsx(AvatarBadge,{user:He,className:"absolute bottom-0 right-0"})]})},getUserDisplayName=He=>He?.displayName||He?.username,UserLink=({user:He,name:Qe,size:it=28,showName:lt=!0,showUserName:ut=!1,leftAnchor:dt,loading:xt,enableLink:ft=!0,showFollow:vt=!1,target:kt,className:St,linkClassName:Tt,scene:Mt})=>{const Nt=Qe||getUserDisplayName(He),{t:At}=useTranslation(["common"]),$t=jsxRuntimeExports.jsxs("div",{className:"flex gap-1 items-center",children:[dt,jsxRuntimeExports.jsx("div",{className:"no-underline shrink-0",children:xt?jsxRuntimeExports.jsx("div",{className:"rounded-full bg-active animate-pulse",style:{width:it,height:it}}):He?jsxRuntimeExports.jsx(UserAvatar,{user:He,style:{width:it,height:it}}):jsxRuntimeExports.jsx(icBaselineAccountCircle,{className:"size-6"})}),lt?xt?jsxRuntimeExports.jsx("div",{className:"min-w-[100px] h-4 bg-active animate-pulse"}):jsxRuntimeExports.jsxs("div",{className:cx("flex flex-col min-w-0",vt?"ml-3 gap-2":"ml-1"),children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-0",children:[jsxRuntimeExports.jsx("p",{className:cx("truncate text-base font-semibold group-hover:underline decoration-current",St),children:Nt}),He?.username&&ut&&jsxRuntimeExports.jsxs("div",{className:cx("truncate text-sm group-hover:underline decoration-current text-gray-500"),children:["@",He?.username]})]}),vt&&jsxRuntimeExports.jsx("div",{className:"",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-1 items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-bold",children:(He?.followingCount||0).toLocaleString()}),jsxRuntimeExports.jsx("span",{className:"text-sm text-primary-light",children:At("user:following-count-label")})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1 items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-bold",children:(He?.followerCount||0).toLocaleString()}),jsxRuntimeExports.jsx("span",{className:"text-sm text-primary-light",children:At("user:follower-count-label")})]})]})})]}):null]});return He&&He.username&&ft?jsxRuntimeExports.jsx(Link,{to:`/@${He.username}`,target:kt,className:cx("group no-underline",Tt),onClick:()=>{track("user_avatar_click",{scene:Mt})},children:$t}):$t},INTERCOM_USER_JWT_KEY=`${getApiUrl()}:intercom-user-jwt`,setIntercomUserJwt=He=>{localStorage.setItem(INTERCOM_USER_JWT_KEY,He)},unsetIntercomUserJwt=()=>{localStorage.removeItem(INTERCOM_USER_JWT_KEY)},IntercomContext=reactExports.createContext({showing:!1,unreadCount:0});function IntercomController(){const He=we$1(),Qe=useLocation(),{showing:it,unreadCount:lt}=reactExports.useContext(IntercomContext);reactExports.useEffect(()=>{He.update({hideDefaultLauncher:!(Qe.pathname.endsWith("/feedback")||it||lt>0)})},[He,Qe,it,lt]);const{i18n:ut}=useTranslation();reactExports.useEffect(()=>{const ft=ut.language,vt=ft==="zh"?"zh-tw":ft;He.update({languageOverride:vt})},[ut.language,He]);const[dt]=useLocalStorage({key:INTERCOM_USER_JWT_KEY}),{data:xt}=useUserInfo();return reactExports.useEffect(()=>{dt&&xt&&He.update({email:xt?.email,userId:xt?.id,createdAt:xt?.createdAt,name:getUserDisplayName(xt),intercomUserJwt:dt})},[He,dt,xt]),null}function IntercomMessengerProvider({children:He}){const[Qe,it]=reactExports.useState(!1),[lt,ut]=reactExports.useState(0),dt={showing:Qe,unreadCount:lt};return jsxRuntimeExports.jsx(pe$1,{appId:config$1.intercomAppId,initializeDelay:1e3,autoBoot:!0,onShow:()=>{it(!0)},onHide:()=>{it(!1)},onUnreadCountChange:ut,children:jsxRuntimeExports.jsx(IntercomContext.Provider,{value:dt,children:He})})}const baseURL=getApiUrl(),httpLink=createHttpLink({uri:baseURL,credentials:"include"}),persistedQueryLink=createPersistedQueryLink({sha256:sha256$1}),retryLink=new RetryLink({delay:{initial:5e3,max:5e3},attempts:{max:10,retryIf(He,Qe){const it=getMainDefinition(Qe.query);return!(it.kind===Kind.OPERATION_DEFINITION&&it.operation===OperationTypeNode.QUERY)||"parseError"in He&&He.parseError||"statusCode"in He&&He.statusCode>=400&&He.statusCode<500?!1:!!He}}}),setContextLink=setContext((He,Qe)=>{const it=getToken(),lt={...Qe.headers};it&&(lt.Authorization=`Bearer ${it}`),bypassAdmin()&&(lt["X-Bypass-Admin"]="1");const ut=getFingerprint();return ut&&(lt["X-Browser-ID"]=ut),Qe.headers=lt,Qe.uri=withQuery(withBase("/graphql",baseURL),{operation:He.operationName}),Qe}),logoutLink=onError(({networkError:He})=>{He&&"statusCode"in He&&He.statusCode===401&&(setToken(""),unsetIntercomUserJwt())}),handleHeaderLink=new ApolloLink((He,Qe)=>new Observable$1(it=>{Qe(He).subscribe({next(lt){it.next(lt)},error(lt){it.error(lt)},complete(){const lt=He.getContext().response,ut=lt?.headers.get("token");ut&&setToken(ut);const dt=lt?.headers.get("x-intercom-user-jwt");dt&&setIntercomUserJwt(dt);const xt=lt?.headers.get("x-country-code");xt&&setIPCountry(xt),it.complete()}})})),dropIntrospectionLink=new ApolloLink((He,Qe)=>He.operationName==="IntrospectionQuery"?(console.debug("Dropped IntrospectionQuery from Apollo Client Devtools"),null):Qe(He)),reportErrorsToSentryLink=onError(({graphQLErrors:He,operation:Qe})=>{He&&He.filter(lt=>lt.extensions?.code==="BAD_USER_INPUT").forEach(lt=>{const ut=new Error(lt.message);ut.name="GRAPHQL_BAD_USER_INPUT",captureException(ut)})}),relayStylePaginationKeyArgsFunction=He=>{if(He!=null)return Object.keys(He).filter(Qe=>Qe!=="before"&&Qe!=="after"&&Qe!=="first"&&Qe!=="last")},typePolicies={Query:{fields:{messages:relayStylePagination(relayStylePaginationKeyArgsFunction),artworks:relayStylePagination(relayStylePaginationKeyArgsFunction),tasks:relayStylePagination(relayStylePaginationKeyArgsFunction),workflows:relayStylePagination(relayStylePaginationKeyArgsFunction)}},Workflow:{fields:{versions:relayStylePagination(relayStylePaginationKeyArgsFunction)}},User:{fields:{tasks:relayStylePagination(relayStylePaginationKeyArgsFunction)}}},cache$1=new InMemoryCache({typePolicies}),defaultContext={refetchOnFocus:!0,refetchOnReconnect:!0,fetchOptions:{},headers:{}},baseApolloClient=new ApolloClient({link:from([dropIntrospectionLink,reportErrorsToSentryLink,handleHeaderLink,logoutLink,setContextLink,retryLink,persistedQueryLink,httpLink]),cache:cache$1,defaultContext,defaultOptions:{query:{fetchPolicy:"network-only"},watchQuery:{fetchPolicy:"cache-and-network"}}}),[useRegister,executeRegister]=createMutationHelper(RegisterDocument),[useLogin,executeLogin]=createMutationHelper(LoginDocument),[useRefreshToken,executeRefreshToken]=createMutationHelper(RefreshTokenDocument),[useForgetPassword,executeForgetPassword]=createMutationHelper(ForgetPasswordDocument),[useGenCode,executeGenCode]=createMutationHelper(GenCodeDocument),[useVerifyEmail,executeVerifyEmail]=createMutationHelper(VerifyEmailDocument),useGetUserInfo=modifyQueryHook(createQueryHook(GetUserInfoDocument),{reduce:He=>He?.me&&bypassAdmin()?{...He?.me,isAdmin:!1}:He?.me}),useUserInfo=He=>{const Qe=useCheckTokenForArgs({});return useGetUserInfo(Qe??skipToken,He)},refetchGetUserInfo=createRefetchQueryHelper(GetUserInfoDocument),updateGetUserInfo=He=>{He&&bypassAdmin()&&(He={...He,isAdmin:!1}),He&&cache$1.updateQuery({query:GetUserInfoDocument},Qe=>({...Qe,me:{...Qe?.me,...He}})),refetchGetUserInfo()},[useUpdateUserInfo,executeUpdateUserInfo]=createMutationHelper(UpdateUserInfoDocument,{update:(He,Qe)=>{updateGetUserInfo(Qe.data?.updateUserInfo)}}),[useUpdateUserSensitiveInfos,executeUpdateUserSensitiveInfos]=createMutationHelper(UpdateUserSensitiveInfosDocument),[useSetPushToken,executeSetPushToken]=createMutationHelper(SetPushTokenDocument),useListMyMFAList=modifyQueryHook(createQueryHook(ListMyMfaListDocument),{reduce:He=>He?.me?.mfaList}),[useSetupMFA,executeSetupMFA]=createMutationHelper(SetupMfaDocument),[useWithdrawAccount,executeWithdrawAccount]=createMutationHelper(WithdrawAccountDocument),useGetMyExternalProfiles=modifyQueryHook(createQueryHook(GetMyExternalProfilesDocument),{reduce:He=>He?.me?.externalProfiles}),[useUnlinkExternal,executeUnlinkExternal]=createMutationHelper(UnlinkExternalDocument),useGetUserWithExternalProfiles=modifyQueryHook(createQueryHook(GetUserWithExternalProfilesDocument),{transform:He=>({userId:He}),reduce:He=>He?.user}),useMapSubjectValue=(He,Qe,it)=>{const lt=useObservable(He.pipe(map$2(dt=>dt[Qe]??it)),it),ut=reactExports.useCallback(dt=>{He.next({...He.value,[Qe]:isFunction$3(dt)?dt(He.value[Qe]??it):dt})},[]);return[lt,ut]},createMapSubjectValueHook=(He,Qe)=>(it,lt=Qe)=>useMapSubjectValue(He,it,lt),$userFollowed=new BehaviorSubject({}),useUserFollowed=createMapSubjectValueHook($userFollowed,!1),$userFollowerCount=new BehaviorSubject({}),useUserFollowerCount=createMapSubjectValueHook($userFollowerCount,0),icBaselineAdd=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),icBaselineCheck=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M9 16.17L4.83 12l-1.42 1.41L9 19L21 7l-1.41-1.41z"})}),UserFollowButton=({user:He,userId:Qe,initialValue:it=He?.followedByMe==null?!1:He?.followedByMe,initialCount:lt=He?.followerCount||0,className:ut,followProps:dt={className:"bg-theme-primary text-white dark:text-white ring-1 ring-inset ring-black/20 dark:ring-white/30",variant:"contained",startIcon:jsxRuntimeExports.jsx(icBaselineAdd,{className:"size-5"})},followingProps:xt={className:"bg-black text-white",variant:"outlined",startIcon:jsxRuntimeExports.jsx(icBaselineCheck,{className:"size-5"})},disableUnfollow:ft,scene:vt,...kt})=>{const{t:St}=useTranslation(["user"]),[Tt,Mt]=useUserFollowed(Qe,it),[Nt,At]=useUserFollowerCount(Qe,lt),{data:$t}=useUserInfo(),Dt=reactExports.useCallback(async Ft=>{if(Ft.preventDefault(),!Qe)return;if(!$t){track("follow_btn_click",{notLogin:!0,scene:vt}),openSignModal(void 0,{fromPath:"follow"});return}const Bt=!Tt;Mt(Bt),At(Nt+(Bt?1:-1));try{track("follow_btn_click",{userId:Qe,target:Bt,scene:vt}),await client.setFollowState({userId:Qe,target:Bt})}catch(Ot){toast.error(Ot?.message),Mt(Tt),At(Nt)}},[$t,Qe,Tt,Nt]);return Qe===$t?.id?null:jsxRuntimeExports.jsx(Button,{onClick:Dt,variant:Tt?xt.variant:dt.variant,className:cx("rounded-md font-bold shadow-none",ut,Tt?xt.className:dt.className),startIcon:Tt?xt.startIcon:dt.startIcon,disabled:Tt?ft:!1,...kt,children:jsxRuntimeExports.jsx("span",{className:"capitalize",children:Tt?xt?.label??St("user:following"):dt?.label??St("user:follow")})})};function UserCard(He){const{user:Qe,scene:it}=He,lt=useBreakpoint("lg","up");return jsxRuntimeExports.jsxs(Link,{to:`/@${Qe.username}`,className:cx("rounded-xl flex flex-col items-center p-3 bg-background-secondary transition ease-out duration-300 hover:shadow-lg border hover:border-neutral-400 dark:border-none",He.className),children:[jsxRuntimeExports.jsx(UserAvatar,{style:{width:lt?96:40,height:lt?96:40},user:Qe}),jsxRuntimeExports.jsx("p",{className:"mt-4 mb-2 font-medium truncate hover:underline max-w-full",children:getUserDisplayName(Qe)}),jsxRuntimeExports.jsx(UserFollowButton,{user:Qe,userId:Qe.id,followProps:{startIcon:null,variant:"outlined",className:"!rounded-full font-medium"},followingProps:{startIcon:null,className:"!rounded-full font-base",variant:"contained"},scene:it})]})}function ArtworkRecommendedUsers(){const{data:He}=useUsers({last:4,feed:"recommend"},{revalidateOnFocus:!1}),Qe=useBreakpoint("lg","up"),lt=getNodesFromConnection(He).slice(0,Qe?4:2);return jsxRuntimeExports.jsx("div",{className:"w-full",children:jsxRuntimeExports.jsx("div",{className:"grid grid-flow-col grid-cols-2 gap-2 pt-2 pb-8 lg:grid-cols-4 lg:gap-3",children:lt.map(ut=>jsxRuntimeExports.jsx(UserCard,{user:ut,scene:"artwork-recommended"},ut.id))})})}const useGetArtwork=modifyQueryHook(createQueryHook(GetArtworkDocument),{transform:He=>({id:He}),reduce:He=>He?.artwork}),updateGetArtwork=(He,Qe)=>{cache$1.updateQuery({query:GetArtworkDocument,variables:{id:He}},()=>({artwork:{__typename:"Artwork",...Qe}}))},refetchGetArtwork=He=>{baseApolloClient.refetchQueries({updateCache(Qe){Qe.evict({id:Qe.identify({__typename:"Artwork",id:He})})}})},fetchGetArtwork=createFetchQueryHelper(GetArtworkDocument),useGetArtworkWithTaskDetail=modifyQueryHook(createQueryHook(GetArtworkWithTaskDetailDocument),{transform:He=>({id:He}),reduce:He=>He?.artwork}),fetchGetArtworkWithTaskDetail=createFetchQueryHelper(GetArtworkWithTaskDetailDocument),useListArtworks=modifyQueryHook(createQueryHook(ListArtworksDocument),{reduce:He=>He?.artworks}),useInfiniteListArtworks=infiniteQueryHook(useListArtworks),usePagedListArtworks=pagedQueryHook(useListArtworks),useListUserLikedArtworks=modifyQueryHook(createQueryHook(ListUserLikedArtworksDocument),{reduce:He=>He?.user?.likedArtworks}),fetchListArtworks=createFetchQueryHelper(ListArtworksDocument),[useUpsertArtwork,executeUpsertArtwork]=createMutationHelper(UpsertArtworkDocument),[useDeleteArtwork,executeDeleteArtwork]=createMutationHelper(DeleteArtworkDocument),[useMarkArtwork,executeMarkArtwork]=createMutationHelper(MarkArtworkDocument);function isAnimatedArtwork(He){return He?.type===ArtworkType.AnimatedArtwork}function isAnimatedComic(He){return He?.type===ArtworkType.AnimatedComic}const isGeneratedByWorkflow=a$3({extra:N$4.optional({workflowId:N$4.string})});a$3({extra:N$4.optional({animatedMediaId:N$4.string})});function getArtworkLink(He){if(He)switch(!0){case isAnimatedArtwork(He):return`/video/${He.id}`;case isAnimatedComic(He):return`/animated-comic/${He.id}`;case He.manga!=null:return`/manga/${He.manga.id}`;default:{const Qe=getArtworkTitle(He);return`/artwork/${He.id}-${slugify(Qe)}`.replace(/-+$/,"")}}}function getArtworkTitle(He){return He.title?He.title:(He.prompts??"").slice(0,33)}function isArtworkAppealable(He){return He?.flag?.isAppealable??!1}function shouldArtworkBeBlurred(He){return He?.flag?.shouldBlur??!1}var ArtworkTypeFilterValue=(He=>(He.All="all",He.Image="image",He.Animated="animated",He.Album="album",He.Comic="comic",He))(ArtworkTypeFilterValue||{});function getArtworkQueryArgsByTypeFilter(He){return $$3(He).with("image",()=>({type:ArtworkType.Default})).with("animated",()=>({type:ArtworkType.AnimatedArtwork,i2vPro:!0})).with("album",()=>({type:ArtworkType.Album})).with("comic",()=>({type:ArtworkType.Comic})).otherwise(()=>({}))}const PromptsModerationActions={PASS:"PASS",PASS_FEEDBACK:"PASS_FEEDBACK",WARN_FEEDBACK:"WARN_FEEDBACK",MEMBER_WARN_FEEDBACK:"MEMBER_WARN_FEEDBACK",REJECT_SET_NSFW_GUIDANCE:"REJECT_SET_NSFW_GUIDANCE",REJECT_FEEDBACK:"REJECT_FEEDBACK"};function isUserContentSensitive(He){return He?(He?.flag?.isSensitive||He?.flag?.isMinors)??!1:!1}function getContentSafetyLabelForUserContent(He){if(isUserContentSensitive(He))return"sensitive"}function getContentSafetyScores(He){const Qe=He?.textSafetyScore?.toString()??"?",it=He?.mediaSafetyScore?.toString()??"?";return{textSafetyScore:Qe,mediaSafetyScore:it}}function getGenerationModelArtworkSafetyScore(He){const{safetyScoreCount:Qe,safetyScoreSum:it}=He??{};return!Qe||!it||Qe<3?"?":(it/Qe).toFixed(1)}const fluentOpen20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M6.25 4.5A1.75 1.75 0 0 0 4.5 6.25v7.5c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 0 0 1.75-1.75v-2a.75.75 0 0 1 1.5 0v2A3.25 3.25 0 0 1 13.75 17h-7.5A3.25 3.25 0 0 1 3 13.75v-7.5A3.25 3.25 0 0 1 6.25 3h2a.75.75 0 0 1 0 1.5zm4.25-.75a.75.75 0 0 1 .75-.75h5a.75.75 0 0 1 .75.75v5a.75.75 0 0 1-1.5 0V5.56l-3.72 3.72a.75.75 0 1 1-1.06-1.06l3.72-3.72h-3.19a.75.75 0 0 1-.75-.75"})}),mingcuteHeartFill=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsxs("g",{fill:"none",children:[jsxRuntimeExports.jsx("path",{d:"M24 0v24H0V0h24ZM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018Zm.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01l-.184-.092Z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M18.494 3.801c2.095 1.221 3.569 3.7 3.504 6.592C21.86 16.5 13.5 21 12 21s-9.861-4.5-9.998-10.607c-.065-2.892 1.409-5.37 3.504-6.592C7.466 2.66 9.928 2.653 12 4.338c2.072-1.685 4.534-1.679 6.494-.537Z"})]})}),styles$c={"animate-like":"_animate-like_1yr6u_1","animation-like":"_animation-like_1yr6u_1","animate-unlike":"_animate-unlike_1yr6u_10","animation-unlike":"_animation-unlike_1yr6u_1"};function LikeHeart(He){const{liked:Qe,className:it,...lt}=He;return jsxRuntimeExports.jsx(mingcuteHeartFill,{...lt,"data-liked":Qe?"":null,className:cx("text-zinc-400 data-[liked]:text-red-500 [--duration:100ms]",Qe?styles$c["animate-like"]:styles$c["animate-unlike"],it)})}const formatNum=(He,Qe)=>{const it=Qe?.fixedDigits??2;if(He!=null)return He<1e3?He:He<1e6?(He/1e3).toFixed(it)+(Qe?.uppercase?"K":"k"):(He/1e6).toFixed(it)+(Qe?.uppercase?"M":"m")},formatBytes=(He,Qe=2)=>{if(!+He)return"0 Bytes";const it=1024,lt=Qe<0?0:Qe,ut=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],dt=Math.floor(Math.log(He)/Math.log(it));return`${parseFloat((He/Math.pow(it,dt)).toFixed(lt))} ${ut[dt]}`};function _mergeNamespaces(He,Qe){return Qe.forEach(function(it){Object.keys(it).forEach(function(lt){if(lt!=="default"&&!(lt in He)){var ut=Object.getOwnPropertyDescriptor(it,lt);Object.defineProperty(He,lt,ut.get?ut:{enumerable:!0,get:function(){return it[lt]}})}})}),Object.freeze(He)}function ownKeys$2(He,Qe){var it=Object.keys(He);if(Object.getOwnPropertySymbols){var lt=Object.getOwnPropertySymbols(He);Qe&&(lt=lt.filter(function(ut){return Object.getOwnPropertyDescriptor(He,ut).enumerable})),it.push.apply(it,lt)}return it}function _objectSpread2(He){for(var Qe=1;Qe<arguments.length;Qe++){var it=arguments[Qe]!=null?arguments[Qe]:{};Qe%2?ownKeys$2(Object(it),!0).forEach(function(lt){_defineProperty$2(He,lt,it[lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(He,Object.getOwnPropertyDescriptors(it)):ownKeys$2(Object(it)).forEach(function(lt){Object.defineProperty(He,lt,Object.getOwnPropertyDescriptor(it,lt))})}return He}function _defineProperty$2(He,Qe,it){return Qe in He?Object.defineProperty(He,Qe,{value:it,enumerable:!0,configurable:!0,writable:!0}):He[Qe]=it,He}function _slicedToArray$2(He,Qe){return _arrayWithHoles$2(He)||_iterableToArrayLimit$2(He,Qe)||_unsupportedIterableToArray$2(He,Qe)||_nonIterableRest$2()}function _arrayWithHoles$2(He){if(Array.isArray(He))return He}function _iterableToArrayLimit$2(He,Qe){var it=He==null?null:typeof Symbol<"u"&&He[Symbol.iterator]||He["@@iterator"];if(it!=null){var lt,ut,dt=[],xt=!0,ft=!1;try{for(it=it.call(He);!(xt=(lt=it.next()).done)&&(dt.push(lt.value),!Qe||dt.length!==Qe);xt=!0);}catch(vt){ft=!0,ut=vt}finally{try{xt||it.return==null||it.return()}finally{if(ft)throw ut}}return dt}}function _unsupportedIterableToArray$2(He,Qe){if(He){if(typeof He=="string")return _arrayLikeToArray$2(He,Qe);var it=Object.prototype.toString.call(He).slice(8,-1);return it==="Object"&&He.constructor&&(it=He.constructor.name),it==="Map"||it==="Set"?Array.from(He):it==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(it)?_arrayLikeToArray$2(He,Qe):void 0}}function _arrayLikeToArray$2(He,Qe){(Qe==null||Qe>He.length)&&(Qe=He.length);for(var it=0,lt=new Array(Qe);it<Qe;it++)lt[it]=He[it];return lt}function _nonIterableRest$2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function createCommonjsModule(He){var Qe={exports:{}};return He(Qe,Qe.exports),Qe.exports}var UZIP_1=createCommonjsModule(function(He){var Qe,it,lt={};He.exports=lt,lt.parse=function(ut,dt){for(var xt=lt.bin.readUshort,ft=lt.bin.readUint,vt=0,kt={},St=new Uint8Array(ut),Tt=St.length-4;ft(St,Tt)!=101010256;)Tt--;vt=Tt,vt+=4;var Mt=xt(St,vt+=4);xt(St,vt+=2);var Nt=ft(St,vt+=2),At=ft(St,vt+=4);vt+=4,vt=At;for(var $t=0;$t<Mt;$t++){ft(St,vt),vt+=4,vt+=4,vt+=4,ft(St,vt+=4),Nt=ft(St,vt+=4);var Dt=ft(St,vt+=4),Ft=xt(St,vt+=4),Bt=xt(St,vt+2),Ot=xt(St,vt+4);vt+=6;var Qt=ft(St,vt+=8);vt+=4,vt+=Ft+Bt+Ot,lt._readLocal(St,Qt,kt,Nt,Dt,dt)}return kt},lt._readLocal=function(ut,dt,xt,ft,vt,kt){var St=lt.bin.readUshort,Tt=lt.bin.readUint;Tt(ut,dt),St(ut,dt+=4),St(ut,dt+=2);var Mt=St(ut,dt+=2);Tt(ut,dt+=2),Tt(ut,dt+=4),dt+=4;var Nt=St(ut,dt+=8),At=St(ut,dt+=2);dt+=2;var $t=lt.bin.readUTF8(ut,dt,Nt);if(dt+=Nt,dt+=At,kt)xt[$t]={size:vt,csize:ft};else{var Dt=new Uint8Array(ut.buffer,dt);if(Mt==0)xt[$t]=new Uint8Array(Dt.buffer.slice(dt,dt+ft));else{if(Mt!=8)throw"unknown compression method: "+Mt;var Ft=new Uint8Array(vt);lt.inflateRaw(Dt,Ft),xt[$t]=Ft}}},lt.inflateRaw=function(ut,dt){return lt.F.inflate(ut,dt)},lt.inflate=function(ut,dt){return ut[0],ut[1],lt.inflateRaw(new Uint8Array(ut.buffer,ut.byteOffset+2,ut.length-6),dt)},lt.deflate=function(ut,dt){dt==null&&(dt={level:6});var xt=0,ft=new Uint8Array(50+Math.floor(1.1*ut.length));ft[xt]=120,ft[xt+1]=156,xt+=2,xt=lt.F.deflateRaw(ut,ft,xt,dt.level);var vt=lt.adler(ut,0,ut.length);return ft[xt+0]=vt>>>24&255,ft[xt+1]=vt>>>16&255,ft[xt+2]=vt>>>8&255,ft[xt+3]=vt>>>0&255,new Uint8Array(ft.buffer,0,xt+4)},lt.deflateRaw=function(ut,dt){dt==null&&(dt={level:6});var xt=new Uint8Array(50+Math.floor(1.1*ut.length)),ft=lt.F.deflateRaw(ut,xt,ft,dt.level);return new Uint8Array(xt.buffer,0,ft)},lt.encode=function(ut,dt){dt==null&&(dt=!1);var xt=0,ft=lt.bin.writeUint,vt=lt.bin.writeUshort,kt={};for(var St in ut){var Tt=!lt._noNeed(St)&&!dt,Mt=ut[St],Nt=lt.crc.crc(Mt,0,Mt.length);kt[St]={cpr:Tt,usize:Mt.length,crc:Nt,file:Tt?lt.deflateRaw(Mt):Mt}}for(var St in kt)xt+=kt[St].file.length+30+46+2*lt.bin.sizeUTF8(St);xt+=22;var At=new Uint8Array(xt),$t=0,Dt=[];for(var St in kt){var Ft=kt[St];Dt.push($t),$t=lt._writeHeader(At,$t,St,Ft,0)}var Bt=0,Ot=$t;for(var St in kt)Ft=kt[St],Dt.push($t),$t=lt._writeHeader(At,$t,St,Ft,1,Dt[Bt++]);var Qt=$t-Ot;return ft(At,$t,101010256),$t+=4,vt(At,$t+=4,Bt),vt(At,$t+=2,Bt),ft(At,$t+=2,Qt),ft(At,$t+=4,Ot),$t+=4,$t+=2,At.buffer},lt._noNeed=function(ut){var dt=ut.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(dt)!=-1},lt._writeHeader=function(ut,dt,xt,ft,vt,kt){var St=lt.bin.writeUint,Tt=lt.bin.writeUshort,Mt=ft.file;return St(ut,dt,vt==0?67324752:33639248),dt+=4,vt==1&&(dt+=2),Tt(ut,dt,20),Tt(ut,dt+=2,0),Tt(ut,dt+=2,ft.cpr?8:0),St(ut,dt+=2,0),St(ut,dt+=4,ft.crc),St(ut,dt+=4,Mt.length),St(ut,dt+=4,ft.usize),Tt(ut,dt+=4,lt.bin.sizeUTF8(xt)),Tt(ut,dt+=2,0),dt+=2,vt==1&&(dt+=2,dt+=2,St(ut,dt+=6,kt),dt+=4),dt+=lt.bin.writeUTF8(ut,dt,xt),vt==0&&(ut.set(Mt,dt),dt+=Mt.length),dt},lt.crc={table:function(){for(var ut=new Uint32Array(256),dt=0;dt<256;dt++){for(var xt=dt,ft=0;ft<8;ft++)1&xt?xt=3988292384^xt>>>1:xt>>>=1;ut[dt]=xt}return ut}(),update:function(ut,dt,xt,ft){for(var vt=0;vt<ft;vt++)ut=lt.crc.table[255&(ut^dt[xt+vt])]^ut>>>8;return ut},crc:function(ut,dt,xt){return 4294967295^lt.crc.update(4294967295,ut,dt,xt)}},lt.adler=function(ut,dt,xt){for(var ft=1,vt=0,kt=dt,St=dt+xt;kt<St;){for(var Tt=Math.min(kt+5552,St);kt<Tt;)vt+=ft+=ut[kt++];ft%=65521,vt%=65521}return vt<<16|ft},lt.bin={readUshort:function(ut,dt){return ut[dt]|ut[dt+1]<<8},writeUshort:function(ut,dt,xt){ut[dt]=255&xt,ut[dt+1]=xt>>8&255},readUint:function(ut,dt){return 16777216*ut[dt+3]+(ut[dt+2]<<16|ut[dt+1]<<8|ut[dt])},writeUint:function(ut,dt,xt){ut[dt]=255&xt,ut[dt+1]=xt>>8&255,ut[dt+2]=xt>>16&255,ut[dt+3]=xt>>24&255},readASCII:function(ut,dt,xt){for(var ft="",vt=0;vt<xt;vt++)ft+=String.fromCharCode(ut[dt+vt]);return ft},writeASCII:function(ut,dt,xt){for(var ft=0;ft<xt.length;ft++)ut[dt+ft]=xt.charCodeAt(ft)},pad:function(ut){return ut.length<2?"0"+ut:ut},readUTF8:function(ut,dt,xt){for(var ft,vt="",kt=0;kt<xt;kt++)vt+="%"+lt.bin.pad(ut[dt+kt].toString(16));try{ft=decodeURIComponent(vt)}catch{return lt.bin.readASCII(ut,dt,xt)}return ft},writeUTF8:function(ut,dt,xt){for(var ft=xt.length,vt=0,kt=0;kt<ft;kt++){var St=xt.charCodeAt(kt);if(!(4294967168&St))ut[dt+vt]=St,vt++;else if(!(4294965248&St))ut[dt+vt]=192|St>>6,ut[dt+vt+1]=128|St>>0&63,vt+=2;else if(!(4294901760&St))ut[dt+vt]=224|St>>12,ut[dt+vt+1]=128|St>>6&63,ut[dt+vt+2]=128|St>>0&63,vt+=3;else{if(4292870144&St)throw"e";ut[dt+vt]=240|St>>18,ut[dt+vt+1]=128|St>>12&63,ut[dt+vt+2]=128|St>>6&63,ut[dt+vt+3]=128|St>>0&63,vt+=4}}return vt},sizeUTF8:function(ut){for(var dt=ut.length,xt=0,ft=0;ft<dt;ft++){var vt=ut.charCodeAt(ft);if(!(4294967168&vt))xt++;else if(!(4294965248&vt))xt+=2;else if(!(4294901760&vt))xt+=3;else{if(4292870144&vt)throw"e";xt+=4}}return xt}},lt.F={},lt.F.deflateRaw=function(ut,dt,xt,ft){var vt=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][ft],kt=lt.F.U,St=lt.F._goodIndex;lt.F._hash;var Tt=lt.F._putsE,Mt=0,Nt=xt<<3,At=0,$t=ut.length;if(ft==0){for(;Mt<$t;)Tt(dt,Nt,Mt+(gr=Math.min(65535,$t-Mt))==$t?1:0),Nt=lt.F._copyExact(ut,Mt,gr,dt,Nt+8),Mt+=gr;return Nt>>>3}var Dt=kt.lits,Ft=kt.strt,Bt=kt.prev,Ot=0,Qt=0,Wt=0,Xt=0,Kt=0,Jt=0;for($t>2&&(Ft[Jt=lt.F._hash(ut,0)]=0),Mt=0;Mt<$t;Mt++){if(Kt=Jt,Mt+1<$t-2){Jt=lt.F._hash(ut,Mt+1);var hr=Mt+1&32767;Bt[hr]=Ft[Jt],Ft[Jt]=hr}if(At<=Mt){(Ot>14e3||Qt>26697)&&$t-Mt>100&&(At<Mt&&(Dt[Ot]=Mt-At,Ot+=2,At=Mt),Nt=lt.F._writeBlock(Mt==$t-1||At==$t?1:0,Dt,Ot,Xt,ut,Wt,Mt-Wt,dt,Nt),Ot=Qt=Xt=0,Wt=Mt);var xr=0;Mt<$t-2&&(xr=lt.F._bestMatch(ut,Mt,Bt,Kt,Math.min(vt[2],$t-Mt),vt[3]));var gr=xr>>>16,br=65535&xr;if(xr!=0){br=65535&xr;var vr=St(gr=xr>>>16,kt.of0);kt.lhst[257+vr]++;var yr=St(br,kt.df0);kt.dhst[yr]++,Xt+=kt.exb[vr]+kt.dxb[yr],Dt[Ot]=gr<<23|Mt-At,Dt[Ot+1]=br<<16|vr<<8|yr,Ot+=2,At=Mt+gr}else kt.lhst[ut[Mt]]++;Qt++}}for(Wt==Mt&&ut.length!=0||(At<Mt&&(Dt[Ot]=Mt-At,Ot+=2,At=Mt),Nt=lt.F._writeBlock(1,Dt,Ot,Xt,ut,Wt,Mt-Wt,dt,Nt),Ot=0,Qt=0,Ot=Qt=Xt=0,Wt=Mt);7&Nt;)Nt++;return Nt>>>3},lt.F._bestMatch=function(ut,dt,xt,ft,vt,kt){var St=32767&dt,Tt=xt[St],Mt=St-Tt+32768&32767;if(Tt==St||ft!=lt.F._hash(ut,dt-Mt))return 0;for(var Nt=0,At=0,$t=Math.min(32767,dt);Mt<=$t&&--kt!=0&&Tt!=St;){if(Nt==0||ut[dt+Nt]==ut[dt+Nt-Mt]){var Dt=lt.F._howLong(ut,dt,Mt);if(Dt>Nt){if(At=Mt,(Nt=Dt)>=vt)break;Mt+2<Dt&&(Dt=Mt+2);for(var Ft=0,Bt=0;Bt<Dt-2;Bt++){var Ot=dt-Mt+Bt+32768&32767,Qt=Ot-xt[Ot]+32768&32767;Qt>Ft&&(Ft=Qt,Tt=Ot)}}}Mt+=(St=Tt)-(Tt=xt[St])+32768&32767}return Nt<<16|At},lt.F._howLong=function(ut,dt,xt){if(ut[dt]!=ut[dt-xt]||ut[dt+1]!=ut[dt+1-xt]||ut[dt+2]!=ut[dt+2-xt])return 0;var ft=dt,vt=Math.min(ut.length,dt+258);for(dt+=3;dt<vt&&ut[dt]==ut[dt-xt];)dt++;return dt-ft},lt.F._hash=function(ut,dt){return(ut[dt]<<8|ut[dt+1])+(ut[dt+2]<<4)&65535},lt.saved=0,lt.F._writeBlock=function(ut,dt,xt,ft,vt,kt,St,Tt,Mt){var Nt,At,$t,Dt,Ft,Bt,Ot,Qt,Wt,Xt=lt.F.U,Kt=lt.F._putsF,Jt=lt.F._putsE;Xt.lhst[256]++,At=(Nt=lt.F.getTrees())[0],$t=Nt[1],Dt=Nt[2],Ft=Nt[3],Bt=Nt[4],Ot=Nt[5],Qt=Nt[6],Wt=Nt[7];var hr=32+(Mt+3&7?8-(Mt+3&7):0)+(St<<3),xr=ft+lt.F.contSize(Xt.fltree,Xt.lhst)+lt.F.contSize(Xt.fdtree,Xt.dhst),gr=ft+lt.F.contSize(Xt.ltree,Xt.lhst)+lt.F.contSize(Xt.dtree,Xt.dhst);gr+=14+3*Ot+lt.F.contSize(Xt.itree,Xt.ihst)+(2*Xt.ihst[16]+3*Xt.ihst[17]+7*Xt.ihst[18]);for(var br=0;br<286;br++)Xt.lhst[br]=0;for(br=0;br<30;br++)Xt.dhst[br]=0;for(br=0;br<19;br++)Xt.ihst[br]=0;var vr=hr<xr&&hr<gr?0:xr<gr?1:2;if(Kt(Tt,Mt,ut),Kt(Tt,Mt+1,vr),Mt+=3,vr==0){for(;7&Mt;)Mt++;Mt=lt.F._copyExact(vt,kt,St,Tt,Mt)}else{var yr,Cr;if(vr==1&&(yr=Xt.fltree,Cr=Xt.fdtree),vr==2){lt.F.makeCodes(Xt.ltree,At),lt.F.revCodes(Xt.ltree,At),lt.F.makeCodes(Xt.dtree,$t),lt.F.revCodes(Xt.dtree,$t),lt.F.makeCodes(Xt.itree,Dt),lt.F.revCodes(Xt.itree,Dt),yr=Xt.ltree,Cr=Xt.dtree,Jt(Tt,Mt,Ft-257),Jt(Tt,Mt+=5,Bt-1),Jt(Tt,Mt+=5,Ot-4),Mt+=4;for(var Rr=0;Rr<Ot;Rr++)Jt(Tt,Mt+3*Rr,Xt.itree[1+(Xt.ordr[Rr]<<1)]);Mt+=3*Ot,Mt=lt.F._codeTiny(Qt,Xt.itree,Tt,Mt),Mt=lt.F._codeTiny(Wt,Xt.itree,Tt,Mt)}for(var Ir=kt,Tr=0;Tr<xt;Tr+=2){for(var $r=dt[Tr],Zr=$r>>>23,Sr=Ir+(8388607&$r);Ir<Sr;)Mt=lt.F._writeLit(vt[Ir++],yr,Tt,Mt);if(Zr!=0){var Dr=dt[Tr+1],wr=Dr>>16,qr=Dr>>8&255,Nr=255&Dr;Jt(Tt,Mt=lt.F._writeLit(257+qr,yr,Tt,Mt),Zr-Xt.of0[qr]),Mt+=Xt.exb[qr],Kt(Tt,Mt=lt.F._writeLit(Nr,Cr,Tt,Mt),wr-Xt.df0[Nr]),Mt+=Xt.dxb[Nr],Ir+=Zr}}Mt=lt.F._writeLit(256,yr,Tt,Mt)}return Mt},lt.F._copyExact=function(ut,dt,xt,ft,vt){var kt=vt>>>3;return ft[kt]=xt,ft[kt+1]=xt>>>8,ft[kt+2]=255-ft[kt],ft[kt+3]=255-ft[kt+1],kt+=4,ft.set(new Uint8Array(ut.buffer,dt,xt),kt),vt+(xt+4<<3)},lt.F.getTrees=function(){for(var ut=lt.F.U,dt=lt.F._hufTree(ut.lhst,ut.ltree,15),xt=lt.F._hufTree(ut.dhst,ut.dtree,15),ft=[],vt=lt.F._lenCodes(ut.ltree,ft),kt=[],St=lt.F._lenCodes(ut.dtree,kt),Tt=0;Tt<ft.length;Tt+=2)ut.ihst[ft[Tt]]++;for(Tt=0;Tt<kt.length;Tt+=2)ut.ihst[kt[Tt]]++;for(var Mt=lt.F._hufTree(ut.ihst,ut.itree,7),Nt=19;Nt>4&&ut.itree[1+(ut.ordr[Nt-1]<<1)]==0;)Nt--;return[dt,xt,Mt,vt,St,Nt,ft,kt]},lt.F.getSecond=function(ut){for(var dt=[],xt=0;xt<ut.length;xt+=2)dt.push(ut[xt+1]);return dt},lt.F.nonZero=function(ut){for(var dt="",xt=0;xt<ut.length;xt+=2)ut[xt+1]!=0&&(dt+=(xt>>1)+",");return dt},lt.F.contSize=function(ut,dt){for(var xt=0,ft=0;ft<dt.length;ft++)xt+=dt[ft]*ut[1+(ft<<1)];return xt},lt.F._codeTiny=function(ut,dt,xt,ft){for(var vt=0;vt<ut.length;vt+=2){var kt=ut[vt],St=ut[vt+1];ft=lt.F._writeLit(kt,dt,xt,ft);var Tt=kt==16?2:kt==17?3:7;kt>15&&(lt.F._putsE(xt,ft,St,Tt),ft+=Tt)}return ft},lt.F._lenCodes=function(ut,dt){for(var xt=ut.length;xt!=2&&ut[xt-1]==0;)xt-=2;for(var ft=0;ft<xt;ft+=2){var vt=ut[ft+1],kt=ft+3<xt?ut[ft+3]:-1,St=ft+5<xt?ut[ft+5]:-1,Tt=ft==0?-1:ut[ft-1];if(vt==0&&kt==vt&&St==vt){for(var Mt=ft+5;Mt+2<xt&&ut[Mt+2]==vt;)Mt+=2;(Nt=Math.min(Mt+1-ft>>>1,138))<11?dt.push(17,Nt-3):dt.push(18,Nt-11),ft+=2*Nt-2}else if(vt==Tt&&kt==vt&&St==vt){for(Mt=ft+5;Mt+2<xt&&ut[Mt+2]==vt;)Mt+=2;var Nt=Math.min(Mt+1-ft>>>1,6);dt.push(16,Nt-3),ft+=2*Nt-2}else dt.push(vt,0)}return xt>>>1},lt.F._hufTree=function(ut,dt,xt){var ft=[],vt=ut.length,kt=dt.length,St=0;for(St=0;St<kt;St+=2)dt[St]=0,dt[St+1]=0;for(St=0;St<vt;St++)ut[St]!=0&&ft.push({lit:St,f:ut[St]});var Tt=ft.length,Mt=ft.slice(0);if(Tt==0)return 0;if(Tt==1){var Nt=ft[0].lit;return Mt=Nt==0?1:0,dt[1+(Nt<<1)]=1,dt[1+(Mt<<1)]=1,1}ft.sort(function(Qt,Wt){return Qt.f-Wt.f});var At=ft[0],$t=ft[1],Dt=0,Ft=1,Bt=2;for(ft[0]={lit:-1,f:At.f+$t.f,l:At,r:$t,d:0};Ft!=Tt-1;)At=Dt!=Ft&&(Bt==Tt||ft[Dt].f<ft[Bt].f)?ft[Dt++]:ft[Bt++],$t=Dt!=Ft&&(Bt==Tt||ft[Dt].f<ft[Bt].f)?ft[Dt++]:ft[Bt++],ft[Ft++]={lit:-1,f:At.f+$t.f,l:At,r:$t};var Ot=lt.F.setDepth(ft[Ft-1],0);for(Ot>xt&&(lt.F.restrictDepth(Mt,xt,Ot),Ot=xt),St=0;St<Tt;St++)dt[1+(Mt[St].lit<<1)]=Mt[St].d;return Ot},lt.F.setDepth=function(ut,dt){return ut.lit!=-1?(ut.d=dt,dt):Math.max(lt.F.setDepth(ut.l,dt+1),lt.F.setDepth(ut.r,dt+1))},lt.F.restrictDepth=function(ut,dt,xt){var ft=0,vt=1<<xt-dt,kt=0;for(ut.sort(function(Tt,Mt){return Mt.d==Tt.d?Tt.f-Mt.f:Mt.d-Tt.d}),ft=0;ft<ut.length&&ut[ft].d>dt;ft++){var St=ut[ft].d;ut[ft].d=dt,kt+=vt-(1<<xt-St)}for(kt>>>=xt-dt;kt>0;)(St=ut[ft].d)<dt?(ut[ft].d++,kt-=1<<dt-St-1):ft++;for(;ft>=0;ft--)ut[ft].d==dt&&kt<0&&(ut[ft].d--,kt++);kt!=0&&console.log("debt left")},lt.F._goodIndex=function(ut,dt){var xt=0;return dt[16|xt]<=ut&&(xt|=16),dt[8|xt]<=ut&&(xt|=8),dt[4|xt]<=ut&&(xt|=4),dt[2|xt]<=ut&&(xt|=2),dt[1|xt]<=ut&&(xt|=1),xt},lt.F._writeLit=function(ut,dt,xt,ft){return lt.F._putsF(xt,ft,dt[ut<<1]),ft+dt[1+(ut<<1)]},lt.F.inflate=function(ut,dt){var xt=Uint8Array;if(ut[0]==3&&ut[1]==0)return dt||new xt(0);var ft=lt.F,vt=ft._bitsF,kt=ft._bitsE,St=ft._decodeTiny,Tt=ft.makeCodes,Mt=ft.codes2map,Nt=ft._get17,At=ft.U,$t=dt==null;$t&&(dt=new xt(ut.length>>>2<<3));for(var Dt,Ft,Bt=0,Ot=0,Qt=0,Wt=0,Xt=0,Kt=0,Jt=0,hr=0,xr=0;Bt==0;)if(Bt=vt(ut,xr,1),Ot=vt(ut,xr+1,2),xr+=3,Ot!=0){if($t&&(dt=lt.F._check(dt,hr+(1<<17))),Ot==1&&(Dt=At.flmap,Ft=At.fdmap,Kt=511,Jt=31),Ot==2){Qt=kt(ut,xr,5)+257,Wt=kt(ut,xr+5,5)+1,Xt=kt(ut,xr+10,4)+4,xr+=14;for(var gr=0;gr<38;gr+=2)At.itree[gr]=0,At.itree[gr+1]=0;var br=1;for(gr=0;gr<Xt;gr++){var vr=kt(ut,xr+3*gr,3);At.itree[1+(At.ordr[gr]<<1)]=vr,vr>br&&(br=vr)}xr+=3*Xt,Tt(At.itree,br),Mt(At.itree,br,At.imap),Dt=At.lmap,Ft=At.dmap,xr=St(At.imap,(1<<br)-1,Qt+Wt,ut,xr,At.ttree);var yr=ft._copyOut(At.ttree,0,Qt,At.ltree);Kt=(1<<yr)-1;var Cr=ft._copyOut(At.ttree,Qt,Wt,At.dtree);Jt=(1<<Cr)-1,Tt(At.ltree,yr),Mt(At.ltree,yr,Dt),Tt(At.dtree,Cr),Mt(At.dtree,Cr,Ft)}for(;;){var Rr=Dt[Nt(ut,xr)&Kt];xr+=15&Rr;var Ir=Rr>>>4;if(!(Ir>>>8))dt[hr++]=Ir;else{if(Ir==256)break;var Tr=hr+Ir-254;if(Ir>264){var $r=At.ldef[Ir-257];Tr=hr+($r>>>3)+kt(ut,xr,7&$r),xr+=7&$r}var Zr=Ft[Nt(ut,xr)&Jt];xr+=15&Zr;var Sr=Zr>>>4,Dr=At.ddef[Sr],wr=(Dr>>>4)+vt(ut,xr,15&Dr);for(xr+=15&Dr,$t&&(dt=lt.F._check(dt,hr+(1<<17)));hr<Tr;)dt[hr]=dt[hr++-wr],dt[hr]=dt[hr++-wr],dt[hr]=dt[hr++-wr],dt[hr]=dt[hr++-wr];hr=Tr}}}else{7&xr&&(xr+=8-(7&xr));var qr=4+(xr>>>3),Nr=ut[qr-4]|ut[qr-3]<<8;$t&&(dt=lt.F._check(dt,hr+Nr)),dt.set(new xt(ut.buffer,ut.byteOffset+qr,Nr),hr),xr=qr+Nr<<3,hr+=Nr}return dt.length==hr?dt:dt.slice(0,hr)},lt.F._check=function(ut,dt){var xt=ut.length;if(dt<=xt)return ut;var ft=new Uint8Array(Math.max(xt<<1,dt));return ft.set(ut,0),ft},lt.F._decodeTiny=function(ut,dt,xt,ft,vt,kt){for(var St=lt.F._bitsE,Tt=lt.F._get17,Mt=0;Mt<xt;){var Nt=ut[Tt(ft,vt)&dt];vt+=15&Nt;var At=Nt>>>4;if(At<=15)kt[Mt]=At,Mt++;else{var $t=0,Dt=0;At==16?(Dt=3+St(ft,vt,2),vt+=2,$t=kt[Mt-1]):At==17?(Dt=3+St(ft,vt,3),vt+=3):At==18&&(Dt=11+St(ft,vt,7),vt+=7);for(var Ft=Mt+Dt;Mt<Ft;)kt[Mt]=$t,Mt++}}return vt},lt.F._copyOut=function(ut,dt,xt,ft){for(var vt=0,kt=0,St=ft.length>>>1;kt<xt;){var Tt=ut[kt+dt];ft[kt<<1]=0,ft[1+(kt<<1)]=Tt,Tt>vt&&(vt=Tt),kt++}for(;kt<St;)ft[kt<<1]=0,ft[1+(kt<<1)]=0,kt++;return vt},lt.F.makeCodes=function(ut,dt){for(var xt,ft,vt,kt,St=lt.F.U,Tt=ut.length,Mt=St.bl_count,Nt=0;Nt<=dt;Nt++)Mt[Nt]=0;for(Nt=1;Nt<Tt;Nt+=2)Mt[ut[Nt]]++;var At=St.next_code;for(xt=0,Mt[0]=0,ft=1;ft<=dt;ft++)xt=xt+Mt[ft-1]<<1,At[ft]=xt;for(vt=0;vt<Tt;vt+=2)(kt=ut[vt+1])!=0&&(ut[vt]=At[kt],At[kt]++)},lt.F.codes2map=function(ut,dt,xt){for(var ft=ut.length,vt=lt.F.U.rev15,kt=0;kt<ft;kt+=2)if(ut[kt+1]!=0)for(var St=kt>>1,Tt=ut[kt+1],Mt=St<<4|Tt,Nt=dt-Tt,At=ut[kt]<<Nt,$t=At+(1<<Nt);At!=$t;)xt[vt[At]>>>15-dt]=Mt,At++},lt.F.revCodes=function(ut,dt){for(var xt=lt.F.U.rev15,ft=15-dt,vt=0;vt<ut.length;vt+=2){var kt=ut[vt]<<dt-ut[vt+1];ut[vt]=xt[kt]>>>ft}},lt.F._putsE=function(ut,dt,xt){xt<<=7&dt;var ft=dt>>>3;ut[ft]|=xt,ut[ft+1]|=xt>>>8},lt.F._putsF=function(ut,dt,xt){xt<<=7&dt;var ft=dt>>>3;ut[ft]|=xt,ut[ft+1]|=xt>>>8,ut[ft+2]|=xt>>>16},lt.F._bitsE=function(ut,dt,xt){return(ut[dt>>>3]|ut[1+(dt>>>3)]<<8)>>>(7&dt)&(1<<xt)-1},lt.F._bitsF=function(ut,dt,xt){return(ut[dt>>>3]|ut[1+(dt>>>3)]<<8|ut[2+(dt>>>3)]<<16)>>>(7&dt)&(1<<xt)-1},lt.F._get17=function(ut,dt){return(ut[dt>>>3]|ut[1+(dt>>>3)]<<8|ut[2+(dt>>>3)]<<16)>>>(7&dt)},lt.F._get25=function(ut,dt){return(ut[dt>>>3]|ut[1+(dt>>>3)]<<8|ut[2+(dt>>>3)]<<16|ut[3+(dt>>>3)]<<24)>>>(7&dt)},lt.F.U=(Qe=Uint16Array,it=Uint32Array,{next_code:new Qe(16),bl_count:new Qe(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new Qe(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new it(32),flmap:new Qe(512),fltree:[],fdmap:new Qe(32),fdtree:[],lmap:new Qe(32768),ltree:[],ttree:[],dmap:new Qe(32768),dtree:[],imap:new Qe(512),itree:[],rev15:new Qe(32768),lhst:new it(286),dhst:new it(30),ihst:new it(19),lits:new it(15e3),strt:new Qe(65536),prev:new Qe(32768)}),function(){for(var ut=lt.F.U,dt=0;dt<32768;dt++){var xt=dt;xt=(4278255360&(xt=(4042322160&(xt=(3435973836&(xt=(2863311530&xt)>>>1|(1431655765&xt)<<1))>>>2|(858993459&xt)<<2))>>>4|(252645135&xt)<<4))>>>8|(16711935&xt)<<8,ut.rev15[dt]=(xt>>>16|xt<<16)>>>17}function ft(vt,kt,St){for(;kt--!=0;)vt.push(0,St)}for(dt=0;dt<32;dt++)ut.ldef[dt]=ut.of0[dt]<<3|ut.exb[dt],ut.ddef[dt]=ut.df0[dt]<<4|ut.dxb[dt];ft(ut.fltree,144,8),ft(ut.fltree,112,9),ft(ut.fltree,24,7),ft(ut.fltree,8,8),lt.F.makeCodes(ut.fltree,9),lt.F.codes2map(ut.fltree,9,ut.flmap),lt.F.revCodes(ut.fltree,9),ft(ut.fdtree,32,5),lt.F.makeCodes(ut.fdtree,5),lt.F.codes2map(ut.fdtree,5,ut.fdmap),lt.F.revCodes(ut.fdtree,5),ft(ut.itree,19,0),ft(ut.ltree,286,0),ft(ut.dtree,30,0),ft(ut.ttree,320,0)}()}),UZIP=Object.freeze(_mergeNamespaces({__proto__:null,default:UZIP_1},[UZIP_1])),UPNG={},N,W$1,H;UPNG.toRGBA8=function(He){var Qe=He.width,it=He.height;if(He.tabs.acTL==null)return[UPNG.toRGBA8.decodeImage(He.data,Qe,it,He).buffer];var lt=[];He.frames[0].data==null&&(He.frames[0].data=He.data);for(var ut=Qe*it*4,dt=new Uint8Array(ut),xt=new Uint8Array(ut),ft=new Uint8Array(ut),vt=0;vt<He.frames.length;vt++){var kt=He.frames[vt],St=kt.rect.x,Tt=kt.rect.y,Mt=kt.rect.width,Nt=kt.rect.height,At=UPNG.toRGBA8.decodeImage(kt.data,Mt,Nt,He);if(vt!=0)for(var $t=0;$t<ut;$t++)ft[$t]=dt[$t];if(kt.blend==0?UPNG._copyTile(At,Mt,Nt,dt,Qe,it,St,Tt,0):kt.blend==1&&UPNG._copyTile(At,Mt,Nt,dt,Qe,it,St,Tt,1),lt.push(dt.buffer.slice(0)),kt.dispose!=0){if(kt.dispose==1)UPNG._copyTile(xt,Mt,Nt,dt,Qe,it,St,Tt,0);else if(kt.dispose==2)for($t=0;$t<ut;$t++)dt[$t]=ft[$t]}}return lt},UPNG.toRGBA8.decodeImage=function(He,Qe,it,lt){var ut=Qe*it,dt=UPNG.decode._getBPP(lt),xt=Math.ceil(Qe*dt/8),ft=new Uint8Array(4*ut),vt=new Uint32Array(ft.buffer),kt=lt.ctype,St=lt.depth,Tt=UPNG._bin.readUshort;if(kt==6){var Mt=ut<<2;if(St==8)for(var Nt=0;Nt<Mt;Nt+=4)ft[Nt]=He[Nt],ft[Nt+1]=He[Nt+1],ft[Nt+2]=He[Nt+2],ft[Nt+3]=He[Nt+3];if(St==16)for(Nt=0;Nt<Mt;Nt++)ft[Nt]=He[Nt<<1]}else if(kt==2){var At=lt.tabs.tRNS;if(At==null){if(St==8)for(Nt=0;Nt<ut;Nt++){var $t=3*Nt;vt[Nt]=255<<24|He[$t+2]<<16|He[$t+1]<<8|He[$t]}if(St==16)for(Nt=0;Nt<ut;Nt++)$t=6*Nt,vt[Nt]=255<<24|He[$t+4]<<16|He[$t+2]<<8|He[$t]}else{var Dt=At[0],Ft=At[1],Bt=At[2];if(St==8)for(Nt=0;Nt<ut;Nt++){var Ot=Nt<<2;$t=3*Nt,vt[Nt]=255<<24|He[$t+2]<<16|He[$t+1]<<8|He[$t],He[$t]==Dt&&He[$t+1]==Ft&&He[$t+2]==Bt&&(ft[Ot+3]=0)}if(St==16)for(Nt=0;Nt<ut;Nt++)Ot=Nt<<2,$t=6*Nt,vt[Nt]=255<<24|He[$t+4]<<16|He[$t+2]<<8|He[$t],Tt(He,$t)==Dt&&Tt(He,$t+2)==Ft&&Tt(He,$t+4)==Bt&&(ft[Ot+3]=0)}}else if(kt==3){var Qt=lt.tabs.PLTE,Wt=lt.tabs.tRNS,Xt=Wt?Wt.length:0;if(St==1)for(var Kt=0;Kt<it;Kt++){var Jt=Kt*xt,hr=Kt*Qe;for(Nt=0;Nt<Qe;Nt++){Ot=hr+Nt<<2;var xr=3*(gr=He[Jt+(Nt>>3)]>>7-((7&Nt)<<0)&1);ft[Ot]=Qt[xr],ft[Ot+1]=Qt[xr+1],ft[Ot+2]=Qt[xr+2],ft[Ot+3]=gr<Xt?Wt[gr]:255}}if(St==2)for(Kt=0;Kt<it;Kt++)for(Jt=Kt*xt,hr=Kt*Qe,Nt=0;Nt<Qe;Nt++)Ot=hr+Nt<<2,xr=3*(gr=He[Jt+(Nt>>2)]>>6-((3&Nt)<<1)&3),ft[Ot]=Qt[xr],ft[Ot+1]=Qt[xr+1],ft[Ot+2]=Qt[xr+2],ft[Ot+3]=gr<Xt?Wt[gr]:255;if(St==4)for(Kt=0;Kt<it;Kt++)for(Jt=Kt*xt,hr=Kt*Qe,Nt=0;Nt<Qe;Nt++)Ot=hr+Nt<<2,xr=3*(gr=He[Jt+(Nt>>1)]>>4-((1&Nt)<<2)&15),ft[Ot]=Qt[xr],ft[Ot+1]=Qt[xr+1],ft[Ot+2]=Qt[xr+2],ft[Ot+3]=gr<Xt?Wt[gr]:255;if(St==8)for(Nt=0;Nt<ut;Nt++){var gr;Ot=Nt<<2,xr=3*(gr=He[Nt]),ft[Ot]=Qt[xr],ft[Ot+1]=Qt[xr+1],ft[Ot+2]=Qt[xr+2],ft[Ot+3]=gr<Xt?Wt[gr]:255}}else if(kt==4){if(St==8)for(Nt=0;Nt<ut;Nt++){Ot=Nt<<2;var br=He[vr=Nt<<1];ft[Ot]=br,ft[Ot+1]=br,ft[Ot+2]=br,ft[Ot+3]=He[vr+1]}if(St==16)for(Nt=0;Nt<ut;Nt++){var vr;Ot=Nt<<2,br=He[vr=Nt<<2],ft[Ot]=br,ft[Ot+1]=br,ft[Ot+2]=br,ft[Ot+3]=He[vr+2]}}else if(kt==0)for(Dt=lt.tabs.tRNS?lt.tabs.tRNS:-1,Kt=0;Kt<it;Kt++){var yr=Kt*xt,Cr=Kt*Qe;if(St==1)for(var Rr=0;Rr<Qe;Rr++){var Ir=(br=255*(He[yr+(Rr>>>3)]>>>7-(7&Rr)&1))==255*Dt?0:255;vt[Cr+Rr]=Ir<<24|br<<16|br<<8|br}else if(St==2)for(Rr=0;Rr<Qe;Rr++)Ir=(br=85*(He[yr+(Rr>>>2)]>>>6-((3&Rr)<<1)&3))==85*Dt?0:255,vt[Cr+Rr]=Ir<<24|br<<16|br<<8|br;else if(St==4)for(Rr=0;Rr<Qe;Rr++)Ir=(br=17*(He[yr+(Rr>>>1)]>>>4-((1&Rr)<<2)&15))==17*Dt?0:255,vt[Cr+Rr]=Ir<<24|br<<16|br<<8|br;else if(St==8)for(Rr=0;Rr<Qe;Rr++)Ir=(br=He[yr+Rr])==Dt?0:255,vt[Cr+Rr]=Ir<<24|br<<16|br<<8|br;else if(St==16)for(Rr=0;Rr<Qe;Rr++)br=He[yr+(Rr<<1)],Ir=Tt(He,yr+(Rr<<Nt))==Dt?0:255,vt[Cr+Rr]=Ir<<24|br<<16|br<<8|br}return ft},UPNG.decode=function(He){for(var Qe,it=new Uint8Array(He),lt=8,ut=UPNG._bin,dt=ut.readUshort,xt=ut.readUint,ft={tabs:{},frames:[]},vt=new Uint8Array(it.length),kt=0,St=0,Tt=[137,80,78,71,13,10,26,10],Mt=0;Mt<8;Mt++)if(it[Mt]!=Tt[Mt])throw"The input is not a PNG file!";for(;lt<it.length;){var Nt=ut.readUint(it,lt);lt+=4;var At=ut.readASCII(it,lt,4);if(lt+=4,At=="IHDR")UPNG.decode._IHDR(it,lt,ft);else if(At=="CgBI")ft.tabs[At]=it.slice(lt,lt+4);else if(At=="IDAT"){for(Mt=0;Mt<Nt;Mt++)vt[kt+Mt]=it[lt+Mt];kt+=Nt}else if(At=="acTL")ft.tabs[At]={num_frames:xt(it,lt),num_plays:xt(it,lt+4)},Qe=new Uint8Array(it.length);else if(At=="fcTL"){var $t;St!=0&&(($t=ft.frames[ft.frames.length-1]).data=UPNG.decode._decompress(ft,Qe.slice(0,St),$t.rect.width,$t.rect.height),St=0);var Dt={x:xt(it,lt+12),y:xt(it,lt+16),width:xt(it,lt+4),height:xt(it,lt+8)},Ft=dt(it,lt+22);Ft=dt(it,lt+20)/(Ft==0?100:Ft);var Bt={rect:Dt,delay:Math.round(1e3*Ft),dispose:it[lt+24],blend:it[lt+25]};ft.frames.push(Bt)}else if(At=="fdAT"){for(Mt=0;Mt<Nt-4;Mt++)Qe[St+Mt]=it[lt+Mt+4];St+=Nt-4}else if(At=="pHYs")ft.tabs[At]=[ut.readUint(it,lt),ut.readUint(it,lt+4),it[lt+8]];else if(At=="cHRM")for(ft.tabs[At]=[],Mt=0;Mt<8;Mt++)ft.tabs[At].push(ut.readUint(it,lt+4*Mt));else if(At=="tEXt"||At=="zTXt"){ft.tabs[At]==null&&(ft.tabs[At]={});var Ot=ut.nextZero(it,lt),Qt=ut.readASCII(it,lt,Ot-lt),Wt=lt+Nt-Ot-1;if(At=="tEXt")Jt=ut.readASCII(it,Ot+1,Wt);else{var Xt=UPNG.decode._inflate(it.slice(Ot+2,Ot+2+Wt));Jt=ut.readUTF8(Xt,0,Xt.length)}ft.tabs[At][Qt]=Jt}else if(At=="iTXt"){ft.tabs[At]==null&&(ft.tabs[At]={}),Ot=0;var Kt=lt;Ot=ut.nextZero(it,Kt),Qt=ut.readASCII(it,Kt,Ot-Kt);var Jt,hr=it[Kt=Ot+1];it[Kt+1],Kt+=2,Ot=ut.nextZero(it,Kt),ut.readASCII(it,Kt,Ot-Kt),Kt=Ot+1,Ot=ut.nextZero(it,Kt),ut.readUTF8(it,Kt,Ot-Kt),Wt=Nt-((Kt=Ot+1)-lt),hr==0?Jt=ut.readUTF8(it,Kt,Wt):(Xt=UPNG.decode._inflate(it.slice(Kt,Kt+Wt)),Jt=ut.readUTF8(Xt,0,Xt.length)),ft.tabs[At][Qt]=Jt}else if(At=="PLTE")ft.tabs[At]=ut.readBytes(it,lt,Nt);else if(At=="hIST"){var xr=ft.tabs.PLTE.length/3;for(ft.tabs[At]=[],Mt=0;Mt<xr;Mt++)ft.tabs[At].push(dt(it,lt+2*Mt))}else if(At=="tRNS")ft.ctype==3?ft.tabs[At]=ut.readBytes(it,lt,Nt):ft.ctype==0?ft.tabs[At]=dt(it,lt):ft.ctype==2&&(ft.tabs[At]=[dt(it,lt),dt(it,lt+2),dt(it,lt+4)]);else if(At=="gAMA")ft.tabs[At]=ut.readUint(it,lt)/1e5;else if(At=="sRGB")ft.tabs[At]=it[lt];else if(At=="bKGD")ft.ctype==0||ft.ctype==4?ft.tabs[At]=[dt(it,lt)]:ft.ctype==2||ft.ctype==6?ft.tabs[At]=[dt(it,lt),dt(it,lt+2),dt(it,lt+4)]:ft.ctype==3&&(ft.tabs[At]=it[lt]);else if(At=="IEND")break;lt+=Nt,ut.readUint(it,lt),lt+=4}return St!=0&&(($t=ft.frames[ft.frames.length-1]).data=UPNG.decode._decompress(ft,Qe.slice(0,St),$t.rect.width,$t.rect.height),St=0),ft.data=UPNG.decode._decompress(ft,vt,ft.width,ft.height),delete ft.compress,delete ft.interlace,delete ft.filter,ft},UPNG.decode._decompress=function(He,Qe,it,lt){var ut=UPNG.decode._getBPP(He),dt=Math.ceil(it*ut/8),xt=new Uint8Array((dt+1+He.interlace)*lt);return Qe=He.tabs.CgBI?UPNG.inflateRaw(Qe,xt):UPNG.decode._inflate(Qe,xt),He.interlace==0?Qe=UPNG.decode._filterZero(Qe,He,0,it,lt):He.interlace==1&&(Qe=UPNG.decode._readInterlace(Qe,He)),Qe},UPNG.decode._inflate=function(He,Qe){return UPNG.inflateRaw(new Uint8Array(He.buffer,2,He.length-6),Qe)},UPNG.inflateRaw=(H={},H.H={},H.H.N=function(He,Qe){var it,lt,ut=Uint8Array,dt=0,xt=0,ft=0,vt=0,kt=0,St=0,Tt=0,Mt=0,Nt=0;if(He[0]==3&&He[1]==0)return Qe||new ut(0);var At=H.H,$t=At.b,Dt=At.e,Ft=At.R,Bt=At.n,Ot=At.A,Qt=At.Z,Wt=At.m,Xt=Qe==null;for(Xt&&(Qe=new ut(He.length>>>2<<5));dt==0;)if(dt=$t(He,Nt,1),xt=$t(He,Nt+1,2),Nt+=3,xt!=0){if(Xt&&(Qe=H.H.W(Qe,Mt+(1<<17))),xt==1&&(it=Wt.J,lt=Wt.h,St=511,Tt=31),xt==2){ft=Dt(He,Nt,5)+257,vt=Dt(He,Nt+5,5)+1,kt=Dt(He,Nt+10,4)+4,Nt+=14;for(var Kt=1,Jt=0;Jt<38;Jt+=2)Wt.Q[Jt]=0,Wt.Q[Jt+1]=0;for(Jt=0;Jt<kt;Jt++){var hr=Dt(He,Nt+3*Jt,3);Wt.Q[1+(Wt.X[Jt]<<1)]=hr,hr>Kt&&(Kt=hr)}Nt+=3*kt,Bt(Wt.Q,Kt),Ot(Wt.Q,Kt,Wt.u),it=Wt.w,lt=Wt.d,Nt=Ft(Wt.u,(1<<Kt)-1,ft+vt,He,Nt,Wt.v);var xr=At.V(Wt.v,0,ft,Wt.C);St=(1<<xr)-1;var gr=At.V(Wt.v,ft,vt,Wt.D);Tt=(1<<gr)-1,Bt(Wt.C,xr),Ot(Wt.C,xr,it),Bt(Wt.D,gr),Ot(Wt.D,gr,lt)}for(;;){var br=it[Qt(He,Nt)&St];Nt+=15&br;var vr=br>>>4;if(!(vr>>>8))Qe[Mt++]=vr;else{if(vr==256)break;var yr=Mt+vr-254;if(vr>264){var Cr=Wt.q[vr-257];yr=Mt+(Cr>>>3)+Dt(He,Nt,7&Cr),Nt+=7&Cr}var Rr=lt[Qt(He,Nt)&Tt];Nt+=15&Rr;var Ir=Rr>>>4,Tr=Wt.c[Ir],$r=(Tr>>>4)+$t(He,Nt,15&Tr);for(Nt+=15&Tr;Mt<yr;)Qe[Mt]=Qe[Mt++-$r],Qe[Mt]=Qe[Mt++-$r],Qe[Mt]=Qe[Mt++-$r],Qe[Mt]=Qe[Mt++-$r];Mt=yr}}}else{7&Nt&&(Nt+=8-(7&Nt));var Zr=4+(Nt>>>3),Sr=He[Zr-4]|He[Zr-3]<<8;Xt&&(Qe=H.H.W(Qe,Mt+Sr)),Qe.set(new ut(He.buffer,He.byteOffset+Zr,Sr),Mt),Nt=Zr+Sr<<3,Mt+=Sr}return Qe.length==Mt?Qe:Qe.slice(0,Mt)},H.H.W=function(He,Qe){var it=He.length;if(Qe<=it)return He;var lt=new Uint8Array(it<<1);return lt.set(He,0),lt},H.H.R=function(He,Qe,it,lt,ut,dt){for(var xt=H.H.e,ft=H.H.Z,vt=0;vt<it;){var kt=He[ft(lt,ut)&Qe];ut+=15&kt;var St=kt>>>4;if(St<=15)dt[vt]=St,vt++;else{var Tt=0,Mt=0;St==16?(Mt=3+xt(lt,ut,2),ut+=2,Tt=dt[vt-1]):St==17?(Mt=3+xt(lt,ut,3),ut+=3):St==18&&(Mt=11+xt(lt,ut,7),ut+=7);for(var Nt=vt+Mt;vt<Nt;)dt[vt]=Tt,vt++}}return ut},H.H.V=function(He,Qe,it,lt){for(var ut=0,dt=0,xt=lt.length>>>1;dt<it;){var ft=He[dt+Qe];lt[dt<<1]=0,lt[1+(dt<<1)]=ft,ft>ut&&(ut=ft),dt++}for(;dt<xt;)lt[dt<<1]=0,lt[1+(dt<<1)]=0,dt++;return ut},H.H.n=function(He,Qe){for(var it,lt,ut,dt,xt=H.H.m,ft=He.length,vt=xt.j,kt=0;kt<=Qe;kt++)vt[kt]=0;for(kt=1;kt<ft;kt+=2)vt[He[kt]]++;var St=xt.K;for(it=0,vt[0]=0,lt=1;lt<=Qe;lt++)it=it+vt[lt-1]<<1,St[lt]=it;for(ut=0;ut<ft;ut+=2)(dt=He[ut+1])!=0&&(He[ut]=St[dt],St[dt]++)},H.H.A=function(He,Qe,it){for(var lt=He.length,ut=H.H.m.r,dt=0;dt<lt;dt+=2)if(He[dt+1]!=0)for(var xt=dt>>1,ft=He[dt+1],vt=xt<<4|ft,kt=Qe-ft,St=He[dt]<<kt,Tt=St+(1<<kt);St!=Tt;)it[ut[St]>>>15-Qe]=vt,St++},H.H.l=function(He,Qe){for(var it=H.H.m.r,lt=15-Qe,ut=0;ut<He.length;ut+=2){var dt=He[ut]<<Qe-He[ut+1];He[ut]=it[dt]>>>lt}},H.H.M=function(He,Qe,it){it<<=7&Qe;var lt=Qe>>>3;He[lt]|=it,He[lt+1]|=it>>>8},H.H.I=function(He,Qe,it){it<<=7&Qe;var lt=Qe>>>3;He[lt]|=it,He[lt+1]|=it>>>8,He[lt+2]|=it>>>16},H.H.e=function(He,Qe,it){return(He[Qe>>>3]|He[1+(Qe>>>3)]<<8)>>>(7&Qe)&(1<<it)-1},H.H.b=function(He,Qe,it){return(He[Qe>>>3]|He[1+(Qe>>>3)]<<8|He[2+(Qe>>>3)]<<16)>>>(7&Qe)&(1<<it)-1},H.H.Z=function(He,Qe){return(He[Qe>>>3]|He[1+(Qe>>>3)]<<8|He[2+(Qe>>>3)]<<16)>>>(7&Qe)},H.H.i=function(He,Qe){return(He[Qe>>>3]|He[1+(Qe>>>3)]<<8|He[2+(Qe>>>3)]<<16|He[3+(Qe>>>3)]<<24)>>>(7&Qe)},H.H.m=(N=Uint16Array,W$1=Uint32Array,{K:new N(16),j:new N(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new N(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new W$1(32),J:new N(512),_:[],h:new N(32),$:[],w:new N(32768),C:[],v:[],d:new N(32768),D:[],u:new N(512),Q:[],r:new N(32768),s:new W$1(286),Y:new W$1(30),a:new W$1(19),t:new W$1(15e3),k:new N(65536),g:new N(32768)}),function(){for(var He=H.H.m,Qe=0;Qe<32768;Qe++){var it=Qe;it=(4278255360&(it=(4042322160&(it=(3435973836&(it=(2863311530&it)>>>1|(1431655765&it)<<1))>>>2|(858993459&it)<<2))>>>4|(252645135&it)<<4))>>>8|(16711935&it)<<8,He.r[Qe]=(it>>>16|it<<16)>>>17}function lt(ut,dt,xt){for(;dt--!=0;)ut.push(0,xt)}for(Qe=0;Qe<32;Qe++)He.q[Qe]=He.S[Qe]<<3|He.T[Qe],He.c[Qe]=He.p[Qe]<<4|He.z[Qe];lt(He._,144,8),lt(He._,112,9),lt(He._,24,7),lt(He._,8,8),H.H.n(He._,9),H.H.A(He._,9,He.J),H.H.l(He._,9),lt(He.$,32,5),H.H.n(He.$,5),H.H.A(He.$,5,He.h),H.H.l(He.$,5),lt(He.Q,19,0),lt(He.C,286,0),lt(He.D,30,0),lt(He.v,320,0)}(),H.H.N),UPNG.decode._readInterlace=function(He,Qe){for(var it=Qe.width,lt=Qe.height,ut=UPNG.decode._getBPP(Qe),dt=ut>>3,xt=Math.ceil(it*ut/8),ft=new Uint8Array(lt*xt),vt=0,kt=[0,0,4,0,2,0,1],St=[0,4,0,2,0,1,0],Tt=[8,8,8,4,4,2,2],Mt=[8,8,4,4,2,2,1],Nt=0;Nt<7;){for(var At=Tt[Nt],$t=Mt[Nt],Dt=0,Ft=0,Bt=kt[Nt];Bt<lt;)Bt+=At,Ft++;for(var Ot=St[Nt];Ot<it;)Ot+=$t,Dt++;var Qt=Math.ceil(Dt*ut/8);UPNG.decode._filterZero(He,Qe,vt,Dt,Ft);for(var Wt=0,Xt=kt[Nt];Xt<lt;){for(var Kt=St[Nt],Jt=vt+Wt*Qt<<3;Kt<it;){var hr;if(ut==1&&(hr=(hr=He[Jt>>3])>>7-(7&Jt)&1,ft[Xt*xt+(Kt>>3)]|=hr<<7-((7&Kt)<<0)),ut==2&&(hr=(hr=He[Jt>>3])>>6-(7&Jt)&3,ft[Xt*xt+(Kt>>2)]|=hr<<6-((3&Kt)<<1)),ut==4&&(hr=(hr=He[Jt>>3])>>4-(7&Jt)&15,ft[Xt*xt+(Kt>>1)]|=hr<<4-((1&Kt)<<2)),ut>=8)for(var xr=Xt*xt+Kt*dt,gr=0;gr<dt;gr++)ft[xr+gr]=He[(Jt>>3)+gr];Jt+=ut,Kt+=$t}Wt++,Xt+=At}Dt*Ft!=0&&(vt+=Ft*(1+Qt)),Nt+=1}return ft},UPNG.decode._getBPP=function(He){return[1,null,3,1,2,null,4][He.ctype]*He.depth},UPNG.decode._filterZero=function(He,Qe,it,lt,ut){var dt=UPNG.decode._getBPP(Qe),xt=Math.ceil(lt*dt/8),ft=UPNG.decode._paeth;dt=Math.ceil(dt/8);var vt=0,kt=1,St=He[it],Tt=0;if(St>1&&(He[it]=[0,0,1][St-2]),St==3)for(Tt=dt;Tt<xt;Tt++)He[Tt+1]=He[Tt+1]+(He[Tt+1-dt]>>>1)&255;for(var Mt=0;Mt<ut;Mt++)if(Tt=0,(St=He[(kt=(vt=it+Mt*xt)+Mt+1)-1])==0)for(;Tt<xt;Tt++)He[vt+Tt]=He[kt+Tt];else if(St==1){for(;Tt<dt;Tt++)He[vt+Tt]=He[kt+Tt];for(;Tt<xt;Tt++)He[vt+Tt]=He[kt+Tt]+He[vt+Tt-dt]}else if(St==2)for(;Tt<xt;Tt++)He[vt+Tt]=He[kt+Tt]+He[vt+Tt-xt];else if(St==3){for(;Tt<dt;Tt++)He[vt+Tt]=He[kt+Tt]+(He[vt+Tt-xt]>>>1);for(;Tt<xt;Tt++)He[vt+Tt]=He[kt+Tt]+(He[vt+Tt-xt]+He[vt+Tt-dt]>>>1)}else{for(;Tt<dt;Tt++)He[vt+Tt]=He[kt+Tt]+ft(0,He[vt+Tt-xt],0);for(;Tt<xt;Tt++)He[vt+Tt]=He[kt+Tt]+ft(He[vt+Tt-dt],He[vt+Tt-xt],He[vt+Tt-dt-xt])}return He},UPNG.decode._paeth=function(He,Qe,it){var lt=He+Qe-it,ut=lt-He,dt=lt-Qe,xt=lt-it;return ut*ut<=dt*dt&&ut*ut<=xt*xt?He:dt*dt<=xt*xt?Qe:it},UPNG.decode._IHDR=function(He,Qe,it){var lt=UPNG._bin;it.width=lt.readUint(He,Qe),Qe+=4,it.height=lt.readUint(He,Qe),Qe+=4,it.depth=He[Qe],Qe++,it.ctype=He[Qe],Qe++,it.compress=He[Qe],Qe++,it.filter=He[Qe],Qe++,it.interlace=He[Qe],Qe++},UPNG._bin={nextZero:function(Qe,it){for(;Qe[it]!=0;)it++;return it},readUshort:function(Qe,it){return Qe[it]<<8|Qe[it+1]},writeUshort:function(Qe,it,lt){Qe[it]=lt>>8&255,Qe[it+1]=255&lt},readUint:function(Qe,it){return 16777216*Qe[it]+(Qe[it+1]<<16|Qe[it+2]<<8|Qe[it+3])},writeUint:function(Qe,it,lt){Qe[it]=lt>>24&255,Qe[it+1]=lt>>16&255,Qe[it+2]=lt>>8&255,Qe[it+3]=255&lt},readASCII:function(Qe,it,lt){for(var ut="",dt=0;dt<lt;dt++)ut+=String.fromCharCode(Qe[it+dt]);return ut},writeASCII:function(Qe,it,lt){for(var ut=0;ut<lt.length;ut++)Qe[it+ut]=lt.charCodeAt(ut)},readBytes:function(Qe,it,lt){for(var ut=[],dt=0;dt<lt;dt++)ut.push(Qe[it+dt]);return ut},pad:function(Qe){return Qe.length<2?"0".concat(Qe):Qe},readUTF8:function(Qe,it,lt){for(var ut,dt="",xt=0;xt<lt;xt++)dt+="%".concat(UPNG._bin.pad(Qe[it+xt].toString(16)));try{ut=decodeURIComponent(dt)}catch{return UPNG._bin.readASCII(Qe,it,lt)}return ut}},UPNG._copyTile=function(He,Qe,it,lt,ut,dt,xt,ft,vt){for(var kt=Math.min(Qe,ut),St=Math.min(it,dt),Tt=0,Mt=0,Nt=0;Nt<St;Nt++)for(var At=0;At<kt;At++)if(xt>=0&&ft>=0?(Tt=Nt*Qe+At<<2,Mt=(ft+Nt)*ut+xt+At<<2):(Tt=(-ft+Nt)*Qe-xt+At<<2,Mt=Nt*ut+At<<2),vt==0)lt[Mt]=He[Tt],lt[Mt+1]=He[Tt+1],lt[Mt+2]=He[Tt+2],lt[Mt+3]=He[Tt+3];else if(vt==1){var $t=He[Tt+3]*.00392156862745098,Dt=He[Tt]*$t,Ft=He[Tt+1]*$t,Bt=He[Tt+2]*$t,Ot=lt[Mt+3]*(1/255),Qt=lt[Mt]*Ot,Wt=lt[Mt+1]*Ot,Xt=lt[Mt+2]*Ot,Kt=1-$t,Jt=$t+Ot*Kt,hr=Jt==0?0:1/Jt;lt[Mt+3]=255*Jt,lt[Mt+0]=(Dt+Qt*Kt)*hr,lt[Mt+1]=(Ft+Wt*Kt)*hr,lt[Mt+2]=(Bt+Xt*Kt)*hr}else if(vt==2)$t=He[Tt+3],Dt=He[Tt],Ft=He[Tt+1],Bt=He[Tt+2],Ot=lt[Mt+3],Qt=lt[Mt],Wt=lt[Mt+1],Xt=lt[Mt+2],$t==Ot&&Dt==Qt&&Ft==Wt&&Bt==Xt?(lt[Mt]=0,lt[Mt+1]=0,lt[Mt+2]=0,lt[Mt+3]=0):(lt[Mt]=Dt,lt[Mt+1]=Ft,lt[Mt+2]=Bt,lt[Mt+3]=$t);else if(vt==3){if($t=He[Tt+3],Dt=He[Tt],Ft=He[Tt+1],Bt=He[Tt+2],Ot=lt[Mt+3],Qt=lt[Mt],Wt=lt[Mt+1],Xt=lt[Mt+2],$t==Ot&&Dt==Qt&&Ft==Wt&&Bt==Xt)continue;if($t<220&&Ot>20)return!1}return!0},UPNG.encode=function(He,Qe,it,lt,ut,dt,xt){lt==null&&(lt=0),xt==null&&(xt=!1);var ft=UPNG.encode.compress(He,Qe,it,lt,[!1,!1,!1,0,xt]);return UPNG.encode.compressPNG(ft,-1),UPNG.encode._main(ft,Qe,it,ut,dt)},UPNG.encodeLL=function(He,Qe,it,lt,ut,dt,xt,ft){for(var vt={ctype:0+(lt==1?0:2)+(ut==0?0:4),depth:dt,frames:[]},kt=(lt+ut)*dt,St=kt*Qe,Tt=0;Tt<He.length;Tt++)vt.frames.push({rect:{x:0,y:0,width:Qe,height:it},img:new Uint8Array(He[Tt]),blend:0,dispose:1,bpp:Math.ceil(kt/8),bpl:Math.ceil(St/8)});return UPNG.encode.compressPNG(vt,0,!0),UPNG.encode._main(vt,Qe,it,xt,ft)},UPNG.encode._main=function(He,Qe,it,lt,ut){ut==null&&(ut={});var dt=UPNG.crc.crc,xt=UPNG._bin.writeUint,ft=UPNG._bin.writeUshort,vt=UPNG._bin.writeASCII,kt=8,St=He.frames.length>1,Tt=!1,Mt=33+(St?20:0);if(ut.sRGB!=null&&(Mt+=13),ut.pHYs!=null&&(Mt+=21),He.ctype==3){for(var Nt=He.plte.length,At=0;At<Nt;At++)He.plte[At]>>>24!=255&&(Tt=!0);Mt+=8+3*Nt+4+(Tt?8+1*Nt+4:0)}for(var $t=0;$t<He.frames.length;$t++)St&&(Mt+=38),Mt+=(Jt=He.frames[$t]).cimg.length+12,$t!=0&&(Mt+=4);Mt+=12;var Dt=new Uint8Array(Mt),Ft=[137,80,78,71,13,10,26,10];for(At=0;At<8;At++)Dt[At]=Ft[At];if(xt(Dt,kt,13),vt(Dt,kt+=4,"IHDR"),xt(Dt,kt+=4,Qe),xt(Dt,kt+=4,it),Dt[kt+=4]=He.depth,Dt[++kt]=He.ctype,Dt[++kt]=0,Dt[++kt]=0,Dt[++kt]=0,xt(Dt,++kt,dt(Dt,kt-17,17)),kt+=4,ut.sRGB!=null&&(xt(Dt,kt,1),vt(Dt,kt+=4,"sRGB"),Dt[kt+=4]=ut.sRGB,xt(Dt,++kt,dt(Dt,kt-5,5)),kt+=4),ut.pHYs!=null&&(xt(Dt,kt,9),vt(Dt,kt+=4,"pHYs"),xt(Dt,kt+=4,ut.pHYs[0]),xt(Dt,kt+=4,ut.pHYs[1]),Dt[kt+=4]=ut.pHYs[2],xt(Dt,++kt,dt(Dt,kt-13,13)),kt+=4),St&&(xt(Dt,kt,8),vt(Dt,kt+=4,"acTL"),xt(Dt,kt+=4,He.frames.length),xt(Dt,kt+=4,ut.loop!=null?ut.loop:0),xt(Dt,kt+=4,dt(Dt,kt-12,12)),kt+=4),He.ctype==3){for(xt(Dt,kt,3*(Nt=He.plte.length)),vt(Dt,kt+=4,"PLTE"),kt+=4,At=0;At<Nt;At++){var Bt=3*At,Ot=He.plte[At],Qt=255&Ot,Wt=Ot>>>8&255,Xt=Ot>>>16&255;Dt[kt+Bt+0]=Qt,Dt[kt+Bt+1]=Wt,Dt[kt+Bt+2]=Xt}if(xt(Dt,kt+=3*Nt,dt(Dt,kt-3*Nt-4,3*Nt+4)),kt+=4,Tt){for(xt(Dt,kt,Nt),vt(Dt,kt+=4,"tRNS"),kt+=4,At=0;At<Nt;At++)Dt[kt+At]=He.plte[At]>>>24&255;xt(Dt,kt+=Nt,dt(Dt,kt-Nt-4,Nt+4)),kt+=4}}var Kt=0;for($t=0;$t<He.frames.length;$t++){var Jt=He.frames[$t];St&&(xt(Dt,kt,26),vt(Dt,kt+=4,"fcTL"),xt(Dt,kt+=4,Kt++),xt(Dt,kt+=4,Jt.rect.width),xt(Dt,kt+=4,Jt.rect.height),xt(Dt,kt+=4,Jt.rect.x),xt(Dt,kt+=4,Jt.rect.y),ft(Dt,kt+=4,lt[$t]),ft(Dt,kt+=2,1e3),Dt[kt+=2]=Jt.dispose,Dt[++kt]=Jt.blend,xt(Dt,++kt,dt(Dt,kt-30,30)),kt+=4);var hr=Jt.cimg;xt(Dt,kt,(Nt=hr.length)+($t==0?0:4));var xr=kt+=4;vt(Dt,kt,$t==0?"IDAT":"fdAT"),kt+=4,$t!=0&&(xt(Dt,kt,Kt++),kt+=4),Dt.set(hr,kt),xt(Dt,kt+=Nt,dt(Dt,xr,kt-xr)),kt+=4}return xt(Dt,kt,0),vt(Dt,kt+=4,"IEND"),xt(Dt,kt+=4,dt(Dt,kt-4,4)),kt+=4,Dt.buffer},UPNG.encode.compressPNG=function(He,Qe,it){for(var lt=0;lt<He.frames.length;lt++){var ut=He.frames[lt];ut.rect.width;var dt=ut.rect.height,xt=new Uint8Array(dt*ut.bpl+dt);ut.cimg=UPNG.encode._filterZero(ut.img,dt,ut.bpp,ut.bpl,xt,Qe,it)}},UPNG.encode.compress=function(He,Qe,it,lt,ut){for(var dt=ut[0],xt=ut[1],ft=ut[2],vt=ut[3],kt=ut[4],St=6,Tt=8,Mt=255,Nt=0;Nt<He.length;Nt++)for(var At=new Uint8Array(He[Nt]),$t=At.length,Dt=0;Dt<$t;Dt+=4)Mt&=At[Dt+3];var Ft=Mt!=255,Bt=UPNG.encode.framize(He,Qe,it,dt,xt,ft),Ot={},Qt=[],Wt=[];if(lt!=0){var Xt=[];for(Dt=0;Dt<Bt.length;Dt++)Xt.push(Bt[Dt].img.buffer);var Kt=UPNG.encode.concatRGBA(Xt),Jt=UPNG.quantize(Kt,lt),hr=0,xr=new Uint8Array(Jt.abuf);for(Dt=0;Dt<Bt.length;Dt++){var gr=(nn=Bt[Dt].img).length;for(Wt.push(new Uint8Array(Jt.inds.buffer,hr>>2,gr>>2)),Nt=0;Nt<gr;Nt+=4)nn[Nt]=xr[hr+Nt],nn[Nt+1]=xr[hr+Nt+1],nn[Nt+2]=xr[hr+Nt+2],nn[Nt+3]=xr[hr+Nt+3];hr+=gr}for(Dt=0;Dt<Jt.plte.length;Dt++)Qt.push(Jt.plte[Dt].est.rgba)}else for(Nt=0;Nt<Bt.length;Nt++){var br=Bt[Nt],vr=new Uint32Array(br.img.buffer),yr=br.rect.width,Cr=($t=vr.length,new Uint8Array($t));for(Wt.push(Cr),Dt=0;Dt<$t;Dt++){var Rr=vr[Dt];if(Dt!=0&&Rr==vr[Dt-1])Cr[Dt]=Cr[Dt-1];else if(Dt>yr&&Rr==vr[Dt-yr])Cr[Dt]=Cr[Dt-yr];else{var Ir=Ot[Rr];if(Ir==null&&(Ot[Rr]=Ir=Qt.length,Qt.push(Rr),Qt.length>=300))break;Cr[Dt]=Ir}}}var Tr=Qt.length;for(Tr<=256&&kt==0&&(Tt=Tr<=2?1:Tr<=4?2:Tr<=16?4:8,Tt=Math.max(Tt,vt)),Nt=0;Nt<Bt.length;Nt++){(br=Bt[Nt]).rect.x,br.rect.y,yr=br.rect.width;var $r=br.rect.height,Zr=br.img;new Uint32Array(Zr.buffer);var Sr=4*yr,Dr=4;if(Tr<=256&&kt==0){Sr=Math.ceil(Tt*yr/8);for(var wr=new Uint8Array(Sr*$r),qr=Wt[Nt],Nr=0;Nr<$r;Nr++){Dt=Nr*Sr;var Jr=Nr*yr;if(Tt==8)for(var Qr=0;Qr<yr;Qr++)wr[Dt+Qr]=qr[Jr+Qr];else if(Tt==4)for(Qr=0;Qr<yr;Qr++)wr[Dt+(Qr>>1)]|=qr[Jr+Qr]<<4-4*(1&Qr);else if(Tt==2)for(Qr=0;Qr<yr;Qr++)wr[Dt+(Qr>>2)]|=qr[Jr+Qr]<<6-2*(3&Qr);else if(Tt==1)for(Qr=0;Qr<yr;Qr++)wr[Dt+(Qr>>3)]|=qr[Jr+Qr]<<7-1*(7&Qr)}Zr=wr,St=3,Dr=1}else if(Ft==0&&Bt.length==1){wr=new Uint8Array(yr*$r*3);var Ur=yr*$r;for(Dt=0;Dt<Ur;Dt++){var nn,Cn=4*Dt;wr[nn=3*Dt]=Zr[Cn],wr[nn+1]=Zr[Cn+1],wr[nn+2]=Zr[Cn+2]}Zr=wr,St=2,Dr=3,Sr=3*yr}br.img=Zr,br.bpl=Sr,br.bpp=Dr}return{ctype:St,depth:Tt,plte:Qt,frames:Bt}},UPNG.encode.framize=function(He,Qe,it,lt,ut,dt){for(var xt=[],ft=0;ft<He.length;ft++){var vt,kt=new Uint8Array(He[ft]),St=new Uint32Array(kt.buffer),Tt=0,Mt=0,Nt=Qe,At=it,$t=lt?1:0;if(ft!=0){for(var Dt=dt||lt||ft==1||xt[ft-2].dispose!=0?1:2,Ft=0,Bt=1e9,Ot=0;Ot<Dt;Ot++){for(var Qt=new Uint8Array(He[ft-1-Ot]),Wt=new Uint32Array(He[ft-1-Ot]),Xt=Qe,Kt=it,Jt=-1,hr=-1,xr=0;xr<it;xr++)for(var gr=0;gr<Qe;gr++)St[Tr=xr*Qe+gr]!=Wt[Tr]&&(gr<Xt&&(Xt=gr),gr>Jt&&(Jt=gr),xr<Kt&&(Kt=xr),xr>hr&&(hr=xr));Jt==-1&&(Xt=Kt=Jt=hr=0),ut&&((1&Xt)==1&&Xt--,(1&Kt)==1&&Kt--);var br=(Jt-Xt+1)*(hr-Kt+1);br<Bt&&(Bt=br,Ft=Ot,Tt=Xt,Mt=Kt,Nt=Jt-Xt+1,At=hr-Kt+1)}Qt=new Uint8Array(He[ft-1-Ft]),Ft==1&&(xt[ft-1].dispose=2),vt=new Uint8Array(Nt*At*4),UPNG._copyTile(Qt,Qe,it,vt,Nt,At,-Tt,-Mt,0),($t=UPNG._copyTile(kt,Qe,it,vt,Nt,At,-Tt,-Mt,3)?1:0)==1?UPNG.encode._prepareDiff(kt,Qe,it,vt,{x:Tt,y:Mt,width:Nt,height:At}):UPNG._copyTile(kt,Qe,it,vt,Nt,At,-Tt,-Mt,0)}else vt=kt.slice(0);xt.push({rect:{x:Tt,y:Mt,width:Nt,height:At},img:vt,blend:$t,dispose:0})}if(lt){for(ft=0;ft<xt.length;ft++)if(($r=xt[ft]).blend!=1){var vr=$r.rect,yr=xt[ft-1].rect,Cr=Math.min(vr.x,yr.x),Rr=Math.min(vr.y,yr.y),Ir={x:Cr,y:Rr,width:Math.max(vr.x+vr.width,yr.x+yr.width)-Cr,height:Math.max(vr.y+vr.height,yr.y+yr.height)-Rr};xt[ft-1].dispose=1,ft-1!=0&&UPNG.encode._updateFrame(He,Qe,it,xt,ft-1,Ir,ut),UPNG.encode._updateFrame(He,Qe,it,xt,ft,Ir,ut)}}if(He.length!=1)for(var Tr=0;Tr<xt.length;Tr++){var $r;($r=xt[Tr]).rect.width*$r.rect.height}return xt},UPNG.encode._updateFrame=function(He,Qe,it,lt,ut,dt,xt){for(var ft=Uint8Array,vt=Uint32Array,kt=new ft(He[ut-1]),St=new vt(He[ut-1]),Tt=ut+1<He.length?new ft(He[ut+1]):null,Mt=new ft(He[ut]),Nt=new vt(Mt.buffer),At=Qe,$t=it,Dt=-1,Ft=-1,Bt=0;Bt<dt.height;Bt++)for(var Ot=0;Ot<dt.width;Ot++){var Qt=dt.x+Ot,Wt=dt.y+Bt,Xt=Wt*Qe+Qt,Kt=Nt[Xt];Kt==0||lt[ut-1].dispose==0&&St[Xt]==Kt&&(Tt==null||Tt[4*Xt+3]!=0)||(Qt<At&&(At=Qt),Qt>Dt&&(Dt=Qt),Wt<$t&&($t=Wt),Wt>Ft&&(Ft=Wt))}Dt==-1&&(At=$t=Dt=Ft=0),xt&&((1&At)==1&&At--,(1&$t)==1&&$t--),dt={x:At,y:$t,width:Dt-At+1,height:Ft-$t+1};var Jt=lt[ut];Jt.rect=dt,Jt.blend=1,Jt.img=new Uint8Array(dt.width*dt.height*4),lt[ut-1].dispose==0?(UPNG._copyTile(kt,Qe,it,Jt.img,dt.width,dt.height,-dt.x,-dt.y,0),UPNG.encode._prepareDiff(Mt,Qe,it,Jt.img,dt)):UPNG._copyTile(Mt,Qe,it,Jt.img,dt.width,dt.height,-dt.x,-dt.y,0)},UPNG.encode._prepareDiff=function(He,Qe,it,lt,ut){UPNG._copyTile(He,Qe,it,lt,ut.width,ut.height,-ut.x,-ut.y,2)},UPNG.encode._filterZero=function(He,Qe,it,lt,ut,dt,xt){var ft,vt=[],kt=[0,1,2,3,4];dt!=-1?kt=[dt]:(Qe*lt>5e5||it==1)&&(kt=[0]),xt&&(ft={level:0});for(var St,Tt=UZIP,Mt=0;Mt<kt.length;Mt++){for(var Nt=0;Nt<Qe;Nt++)UPNG.encode._filterLine(ut,He,Nt,lt,it,kt[Mt]);vt.push(Tt.deflate(ut,ft))}var At=1e9;for(Mt=0;Mt<vt.length;Mt++)vt[Mt].length<At&&(St=Mt,At=vt[Mt].length);return vt[St]},UPNG.encode._filterLine=function(He,Qe,it,lt,ut,dt){var xt=it*lt,ft=xt+it,vt=UPNG.decode._paeth;if(He[ft]=dt,ft++,dt==0)if(lt<500)for(var kt=0;kt<lt;kt++)He[ft+kt]=Qe[xt+kt];else He.set(new Uint8Array(Qe.buffer,xt,lt),ft);else if(dt==1){for(kt=0;kt<ut;kt++)He[ft+kt]=Qe[xt+kt];for(kt=ut;kt<lt;kt++)He[ft+kt]=Qe[xt+kt]-Qe[xt+kt-ut]+256&255}else if(it==0){for(kt=0;kt<ut;kt++)He[ft+kt]=Qe[xt+kt];if(dt==2)for(kt=ut;kt<lt;kt++)He[ft+kt]=Qe[xt+kt];if(dt==3)for(kt=ut;kt<lt;kt++)He[ft+kt]=Qe[xt+kt]-(Qe[xt+kt-ut]>>1)+256&255;if(dt==4)for(kt=ut;kt<lt;kt++)He[ft+kt]=Qe[xt+kt]-vt(Qe[xt+kt-ut],0,0)+256&255}else{if(dt==2)for(kt=0;kt<lt;kt++)He[ft+kt]=Qe[xt+kt]+256-Qe[xt+kt-lt]&255;if(dt==3){for(kt=0;kt<ut;kt++)He[ft+kt]=Qe[xt+kt]+256-(Qe[xt+kt-lt]>>1)&255;for(kt=ut;kt<lt;kt++)He[ft+kt]=Qe[xt+kt]+256-(Qe[xt+kt-lt]+Qe[xt+kt-ut]>>1)&255}if(dt==4){for(kt=0;kt<ut;kt++)He[ft+kt]=Qe[xt+kt]+256-vt(0,Qe[xt+kt-lt],0)&255;for(kt=ut;kt<lt;kt++)He[ft+kt]=Qe[xt+kt]+256-vt(Qe[xt+kt-ut],Qe[xt+kt-lt],Qe[xt+kt-ut-lt])&255}}},UPNG.crc={table:function(){for(var He=new Uint32Array(256),Qe=0;Qe<256;Qe++){for(var it=Qe,lt=0;lt<8;lt++)1&it?it=3988292384^it>>>1:it>>>=1;He[Qe]=it}return He}(),update:function(Qe,it,lt,ut){for(var dt=0;dt<ut;dt++)Qe=UPNG.crc.table[255&(Qe^it[lt+dt])]^Qe>>>8;return Qe},crc:function(Qe,it,lt){return 4294967295^UPNG.crc.update(4294967295,Qe,it,lt)}},UPNG.quantize=function(He,Qe){var it,lt=new Uint8Array(He),ut=lt.slice(0),dt=new Uint32Array(ut.buffer),xt=UPNG.quantize.getKDtree(ut,Qe),ft=xt[0],vt=xt[1],kt=UPNG.quantize.planeDst,St=lt,Tt=dt,Mt=St.length,Nt=new Uint8Array(lt.length>>2);if(lt.length<2e7)for(var At=0;At<Mt;At+=4){var $t=St[At]*.00392156862745098,Dt=St[At+1]*(1/255),Ft=St[At+2]*(1/255),Bt=St[At+3]*(1/255);it=UPNG.quantize.getNearest(ft,$t,Dt,Ft,Bt),Nt[At>>2]=it.ind,Tt[At>>2]=it.est.rgba}else for(At=0;At<Mt;At+=4){for($t=St[At]*(1/255),Dt=St[At+1]*(1/255),Ft=St[At+2]*(1/255),Bt=St[At+3]*(1/255),it=ft;it.left;)it=kt(it.est,$t,Dt,Ft,Bt)<=0?it.left:it.right;Nt[At>>2]=it.ind,Tt[At>>2]=it.est.rgba}return{abuf:ut.buffer,inds:Nt,plte:vt}},UPNG.quantize.getKDtree=function(He,Qe,it){it==null&&(it=1e-4);var lt=new Uint32Array(He.buffer),ut={i0:0,i1:He.length,bst:null,est:null,tdst:0,left:null,right:null};ut.bst=UPNG.quantize.stats(He,ut.i0,ut.i1),ut.est=UPNG.quantize.estats(ut.bst);for(var dt=[ut];dt.length<Qe;){for(var xt=0,ft=0,vt=0;vt<dt.length;vt++)dt[vt].est.L>xt&&(xt=dt[vt].est.L,ft=vt);if(xt<it)break;var kt=dt[ft],St=UPNG.quantize.splitPixels(He,lt,kt.i0,kt.i1,kt.est.e,kt.est.eMq255);if(kt.i0>=St||kt.i1<=St)kt.est.L=0;else{var Tt={i0:kt.i0,i1:St,bst:null,est:null,tdst:0,left:null,right:null};Tt.bst=UPNG.quantize.stats(He,Tt.i0,Tt.i1),Tt.est=UPNG.quantize.estats(Tt.bst);var Mt={i0:St,i1:kt.i1,bst:null,est:null,tdst:0,left:null,right:null};for(Mt.bst={R:[],m:[],N:kt.bst.N-Tt.bst.N},vt=0;vt<16;vt++)Mt.bst.R[vt]=kt.bst.R[vt]-Tt.bst.R[vt];for(vt=0;vt<4;vt++)Mt.bst.m[vt]=kt.bst.m[vt]-Tt.bst.m[vt];Mt.est=UPNG.quantize.estats(Mt.bst),kt.left=Tt,kt.right=Mt,dt[ft]=Tt,dt.push(Mt)}}for(dt.sort(function(Nt,At){return At.bst.N-Nt.bst.N}),vt=0;vt<dt.length;vt++)dt[vt].ind=vt;return[ut,dt]},UPNG.quantize.getNearest=function(He,Qe,it,lt,ut){if(He.left==null)return He.tdst=UPNG.quantize.dist(He.est.q,Qe,it,lt,ut),He;var dt=UPNG.quantize.planeDst(He.est,Qe,it,lt,ut),xt=He.left,ft=He.right;dt>0&&(xt=He.right,ft=He.left);var vt=UPNG.quantize.getNearest(xt,Qe,it,lt,ut);if(vt.tdst<=dt*dt)return vt;var kt=UPNG.quantize.getNearest(ft,Qe,it,lt,ut);return kt.tdst<vt.tdst?kt:vt},UPNG.quantize.planeDst=function(He,Qe,it,lt,ut){var dt=He.e;return dt[0]*Qe+dt[1]*it+dt[2]*lt+dt[3]*ut-He.eMq},UPNG.quantize.dist=function(He,Qe,it,lt,ut){var dt=Qe-He[0],xt=it-He[1],ft=lt-He[2],vt=ut-He[3];return dt*dt+xt*xt+ft*ft+vt*vt},UPNG.quantize.splitPixels=function(He,Qe,it,lt,ut,dt){var xt=UPNG.quantize.vecDot;for(lt-=4;it<lt;){for(;xt(He,it,ut)<=dt;)it+=4;for(;xt(He,lt,ut)>dt;)lt-=4;if(it>=lt)break;var ft=Qe[it>>2];Qe[it>>2]=Qe[lt>>2],Qe[lt>>2]=ft,it+=4,lt-=4}for(;xt(He,it,ut)>dt;)it-=4;return it+4},UPNG.quantize.vecDot=function(He,Qe,it){return He[Qe]*it[0]+He[Qe+1]*it[1]+He[Qe+2]*it[2]+He[Qe+3]*it[3]},UPNG.quantize.stats=function(He,Qe,it){for(var lt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ut=[0,0,0,0],dt=it-Qe>>2,xt=Qe;xt<it;xt+=4){var ft=He[xt]*.00392156862745098,vt=He[xt+1]*(1/255),kt=He[xt+2]*(1/255),St=He[xt+3]*(1/255);ut[0]+=ft,ut[1]+=vt,ut[2]+=kt,ut[3]+=St,lt[0]+=ft*ft,lt[1]+=ft*vt,lt[2]+=ft*kt,lt[3]+=ft*St,lt[5]+=vt*vt,lt[6]+=vt*kt,lt[7]+=vt*St,lt[10]+=kt*kt,lt[11]+=kt*St,lt[15]+=St*St}return lt[4]=lt[1],lt[8]=lt[2],lt[9]=lt[6],lt[12]=lt[3],lt[13]=lt[7],lt[14]=lt[11],{R:lt,m:ut,N:dt}},UPNG.quantize.estats=function(He){var Qe=He.R,it=He.m,lt=He.N,ut=it[0],dt=it[1],xt=it[2],ft=it[3],vt=lt==0?0:1/lt,kt=[Qe[0]-ut*ut*vt,Qe[1]-ut*dt*vt,Qe[2]-ut*xt*vt,Qe[3]-ut*ft*vt,Qe[4]-dt*ut*vt,Qe[5]-dt*dt*vt,Qe[6]-dt*xt*vt,Qe[7]-dt*ft*vt,Qe[8]-xt*ut*vt,Qe[9]-xt*dt*vt,Qe[10]-xt*xt*vt,Qe[11]-xt*ft*vt,Qe[12]-ft*ut*vt,Qe[13]-ft*dt*vt,Qe[14]-ft*xt*vt,Qe[15]-ft*ft*vt],St=kt,Tt=UPNG.M4,Mt=[Math.random(),Math.random(),Math.random(),Math.random()],Nt=0,At=0;if(lt!=0)for(var $t=0;$t<16&&(Mt=Tt.multVec(St,Mt),At=Math.sqrt(Tt.dot(Mt,Mt)),Mt=Tt.sml(1/At,Mt),!($t!=0&&Math.abs(At-Nt)<1e-9));$t++)Nt=At;var Dt=[ut*vt,dt*vt,xt*vt,ft*vt];return{Cov:kt,q:Dt,e:Mt,L:Nt,eMq255:Tt.dot(Tt.sml(255,Dt),Mt),eMq:Tt.dot(Mt,Dt),rgba:(Math.round(255*Dt[3])<<24|Math.round(255*Dt[2])<<16|Math.round(255*Dt[1])<<8|Math.round(255*Dt[0])<<0)>>>0}},UPNG.M4={multVec:function(Qe,it){return[Qe[0]*it[0]+Qe[1]*it[1]+Qe[2]*it[2]+Qe[3]*it[3],Qe[4]*it[0]+Qe[5]*it[1]+Qe[6]*it[2]+Qe[7]*it[3],Qe[8]*it[0]+Qe[9]*it[1]+Qe[10]*it[2]+Qe[11]*it[3],Qe[12]*it[0]+Qe[13]*it[1]+Qe[14]*it[2]+Qe[15]*it[3]]},dot:function(Qe,it){return Qe[0]*it[0]+Qe[1]*it[1]+Qe[2]*it[2]+Qe[3]*it[3]},sml:function(Qe,it){return[Qe*it[0],Qe*it[1],Qe*it[2],Qe*it[3]]}},UPNG.encode.concatRGBA=function(He){for(var Qe=0,it=0;it<He.length;it++)Qe+=He[it].byteLength;var lt=new Uint8Array(Qe),ut=0;for(it=0;it<He.length;it++){for(var dt=new Uint8Array(He[it]),xt=dt.length,ft=0;ft<xt;ft+=4){var vt=dt[ft],kt=dt[ft+1],St=dt[ft+2],Tt=dt[ft+3];Tt==0&&(vt=kt=St=0),lt[ut+ft]=vt,lt[ut+ft+1]=kt,lt[ut+ft+2]=St,lt[ut+ft+3]=Tt}ut+=xt}return lt.buffer};var BROWSER_NAME={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",MOBILE_SAFARI:"MOBILE_SAFARI",ETC:"ETC"},_BROWSER_NAME$CHROME$,MAX_CANVAS_SIZE=(_BROWSER_NAME$CHROME$={},_defineProperty$2(_BROWSER_NAME$CHROME$,BROWSER_NAME.CHROME,16384),_defineProperty$2(_BROWSER_NAME$CHROME$,BROWSER_NAME.FIREFOX,11180),_defineProperty$2(_BROWSER_NAME$CHROME$,BROWSER_NAME.DESKTOP_SAFARI,16384),_defineProperty$2(_BROWSER_NAME$CHROME$,BROWSER_NAME.IE,8192),_defineProperty$2(_BROWSER_NAME$CHROME$,BROWSER_NAME.MOBILE_SAFARI,4096),_defineProperty$2(_BROWSER_NAME$CHROME$,BROWSER_NAME.ETC,8192),_BROWSER_NAME$CHROME$),isBrowser=typeof window<"u",moduleMapper=isBrowser&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),CustomFile=isBrowser&&(moduleMapper&&moduleMapper.getOriginalSymbol(window,"File")||window.File!==void 0&&File),CustomFileReader=isBrowser&&(moduleMapper&&moduleMapper.getOriginalSymbol(window,"FileReader")||window.FileReader!==void 0&&FileReader);function getFilefromDataUrl(He,Qe){var it=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Date.now();return new Promise(function(lt){for(var ut=He.split(","),dt=ut[0].match(/:(.*?);/)[1],xt=globalThis.atob(ut[1]),ft=xt.length,vt=new Uint8Array(ft);ft--;)vt[ft]=xt.charCodeAt(ft);var kt=new Blob([vt],{type:dt});kt.name=Qe,kt.lastModified=it,lt(kt)})}function getDataUrlFromFile(He){return new Promise(function(Qe,it){var lt=new CustomFileReader;lt.onload=function(){return Qe(lt.result)},lt.onerror=function(ut){return it(ut)},lt.readAsDataURL(He)})}function loadImage$1(He){return new Promise(function(Qe,it){var lt=new Image;lt.onload=function(){return Qe(lt)},lt.onerror=function(ut){return it(ut)},lt.src=He})}function getBrowserName(){if(getBrowserName.cachedResult!==void 0)return getBrowserName.cachedResult;var He=BROWSER_NAME.ETC,Qe=navigator.userAgent;return/Chrom(e|ium)/i.test(Qe)?He=BROWSER_NAME.CHROME:/iP(ad|od|hone)/i.test(Qe)&&/WebKit/i.test(Qe)&&!/(CriOS|FxiOS|OPiOS|mercury)/i.test(Qe)?He=BROWSER_NAME.MOBILE_SAFARI:/Safari/i.test(Qe)?He=BROWSER_NAME.DESKTOP_SAFARI:/Firefox/i.test(Qe)?He=BROWSER_NAME.FIREFOX:(/MSIE/i.test(Qe)||document.documentMode)&&(He=BROWSER_NAME.IE),getBrowserName.cachedResult=He,getBrowserName.cachedResult}function approximateBelowMaximumCanvasSizeOfBrowser(He,Qe){for(var it=getBrowserName(),lt=MAX_CANVAS_SIZE[it],ut=He,dt=Qe,xt=ut*dt,ft=ut>dt?dt/ut:ut/dt;xt>lt*lt;){var vt=(lt+ut)/2,kt=(lt+dt)/2;vt<kt?(dt=kt,ut=kt*ft):(dt=vt*ft,ut=vt),xt=ut*dt}return{width:ut,height:dt}}function getNewCanvasAndCtx(He,Qe){var it,lt;try{if((lt=(it=new OffscreenCanvas(He,Qe)).getContext("2d"))===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{lt=(it=document.createElement("canvas")).getContext("2d")}return it.width=He,it.height=Qe,[it,lt]}function drawImageInCanvas(He){var Qe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,it=approximateBelowMaximumCanvasSizeOfBrowser(He.width,He.height),lt=it.width,ut=it.height,dt=getNewCanvasAndCtx(lt,ut),xt=_slicedToArray$2(dt,2),ft=xt[0],vt=xt[1];return Qe&&/jpe?g/.test(Qe)&&(vt.fillStyle="white",vt.fillRect(0,0,ft.width,ft.height)),vt.drawImage(He,0,0,ft.width,ft.height),ft}function isIOS(){return isIOS.cachedResult!==void 0||(isIOS.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),isIOS.cachedResult}function drawFileInCanvas(He){var Qe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(it,lt){var ut,dt,xt=function(){try{return dt=drawImageInCanvas(ut,Qe.fileType||He.type),it([ut,dt])}catch(kt){return lt(kt)}},ft=function(kt){try{var St=function(Mt){try{throw Mt}catch(Nt){return lt(Nt)}};try{return getDataUrlFromFile(He).then(function(Tt){try{return loadImage$1(Tt).then(function(Mt){try{return ut=Mt,function(){try{return xt()}catch(At){return lt(At)}}()}catch(Nt){return St(Nt)}},St)}catch(Mt){return St(Mt)}},St)}catch(Tt){St(Tt)}}catch(Tt){return lt(Tt)}};try{if(isIOS()||[BROWSER_NAME.DESKTOP_SAFARI,BROWSER_NAME.MOBILE_SAFARI].includes(getBrowserName()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(He).then(function(vt){try{return ut=vt,xt()}catch{return ft()}},ft)}catch{ft()}})}function canvasToFile$1(He,Qe,it,lt){var ut=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1;return new Promise(function(dt,xt){var ft,vt,kt;if(Qe==="image/png")return vt=He.getContext("2d").getImageData(0,0,He.width,He.height).data,kt=UPNG.encode([vt],He.width,He.height,256*ut),(ft=new Blob([kt],{type:Qe})).name=it,ft.lastModified=lt,St.call(this);{let Tt=function(){return St.call(this)};return typeof OffscreenCanvas=="function"&&He instanceof OffscreenCanvas?He.convertToBlob({type:Qe,quality:ut}).then((function(Mt){try{return(ft=Mt).name=it,ft.lastModified=lt,Tt.call(this)}catch(Nt){return xt(Nt)}}).bind(this),xt):getFilefromDataUrl(He.toDataURL(Qe,ut),it,lt).then((function(Mt){try{return ft=Mt,Tt.call(this)}catch(Nt){return xt(Nt)}}).bind(this),xt)}function St(){return dt(ft)}})}function cleanupCanvasMemory(He){He.width=0,He.height=0}function isAutoOrientationInBrowser(){return new Promise(function(He,Qe){var it,lt,ut,dt;return isAutoOrientationInBrowser.cachedResult!==void 0?He(isAutoOrientationInBrowser.cachedResult):getFilefromDataUrl("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(xt){try{return drawFileInCanvas(it=xt).then(function(ft){try{return canvasToFile$1(lt=ft[1],it.type,it.name,it.lastModified).then(function(vt){try{return ut=vt,cleanupCanvasMemory(lt),drawFileInCanvas(ut).then(function(kt){try{return dt=kt[0],isAutoOrientationInBrowser.cachedResult=dt.width===1&&dt.height===2,He(isAutoOrientationInBrowser.cachedResult)}catch(St){return Qe(St)}},Qe)}catch(kt){return Qe(kt)}},Qe)}catch(vt){return Qe(vt)}},Qe)}catch(ft){return Qe(ft)}},Qe)})}function getExifOrientation(He){return new Promise(function(Qe,it){var lt=new CustomFileReader;lt.onload=function(ut){var dt=new DataView(ut.target.result);if(dt.getUint16(0,!1)!=65496)return Qe(-2);for(var xt=dt.byteLength,ft=2;ft<xt;){if(dt.getUint16(ft+2,!1)<=8)return Qe(-1);var vt=dt.getUint16(ft,!1);if(ft+=2,vt==65505){if(dt.getUint32(ft+=2,!1)!=1165519206)return Qe(-1);var kt=dt.getUint16(ft+=6,!1)==18761;ft+=dt.getUint32(ft+4,kt);var St=dt.getUint16(ft,kt);ft+=2;for(var Tt=0;Tt<St;Tt++)if(dt.getUint16(ft+12*Tt,kt)==274)return Qe(dt.getUint16(ft+12*Tt+8,kt))}else{if((65280&vt)!=65280)break;ft+=dt.getUint16(ft,!1)}}return Qe(-1)},lt.onerror=function(ut){return it(ut)},lt.readAsArrayBuffer(He)})}function handleMaxWidthOrHeight(He,Qe){var it,lt=He.width,ut=He.height,dt=Qe.maxWidthOrHeight,xt=He;if(isFinite(dt)&&(lt>dt||ut>dt)){var ft=_slicedToArray$2(getNewCanvasAndCtx(lt,ut),2);xt=ft[0],it=ft[1],lt>ut?(xt.width=dt,xt.height=ut/lt*dt):(xt.width=lt/ut*dt,xt.height=dt),it.drawImage(He,0,0,xt.width,xt.height),cleanupCanvasMemory(He)}return xt}function followExifOrientation(He,Qe){var it=He.width,lt=He.height,ut=_slicedToArray$2(getNewCanvasAndCtx(it,lt),2),dt=ut[0],xt=ut[1];switch(Qe>4&&Qe<9?(dt.width=lt,dt.height=it):(dt.width=it,dt.height=lt),Qe){case 2:xt.transform(-1,0,0,1,it,0);break;case 3:xt.transform(-1,0,0,-1,it,lt);break;case 4:xt.transform(1,0,0,-1,0,lt);break;case 5:xt.transform(0,1,1,0,0,0);break;case 6:xt.transform(0,1,-1,0,lt,0);break;case 7:xt.transform(0,-1,-1,0,lt,it);break;case 8:xt.transform(0,-1,1,0,0,it)}return xt.drawImage(He,0,0,it,lt),cleanupCanvasMemory(He),dt}function compress(He,Qe){var it=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return new Promise(function(lt,ut){var dt,xt,ft,vt,kt,St,Tt,Mt,Nt,At,$t,Dt,Ft,Bt,Ot,Qt,Wt,Xt,Kt;function Jt(){var xr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:5;if(Qe.signal&&Qe.signal.aborted)throw Qe.signal.reason;dt+=xr,Qe.onProgress(Math.min(dt,100))}function hr(xr){if(Qe.signal&&Qe.signal.aborted)throw Qe.signal.reason;dt=Math.min(Math.max(xr,dt),100),Qe.onProgress(dt)}return dt=it,xt=Qe.maxIteration||10,ft=1024*Qe.maxSizeMB*1024,Jt(),drawFileInCanvas(He,Qe).then((function(xr){try{var gr=_slicedToArray$2(xr,2);return vt=gr[1],Jt(),kt=handleMaxWidthOrHeight(vt,Qe),Jt(),new Promise(function(br,vr){var yr;if(!(yr=Qe.exifOrientation))return getExifOrientation(He).then((function(Rr){try{return yr=Rr,Cr.call(this)}catch(Ir){return vr(Ir)}}).bind(this),vr);function Cr(){return br(yr)}return Cr.call(this)}).then((function(br){try{return St=br,Jt(),isAutoOrientationInBrowser().then((function(vr){try{return Tt=vr?kt:followExifOrientation(kt,St),Jt(),Mt=Qe.initialQuality||1,Nt=Qe.fileType||He.type,canvasToFile$1(Tt,Nt,He.name,He.lastModified,Mt).then((function(yr){try{{let Rr=function(){if(xt--&&(Ot>ft||Ot>Ft)){var Tr,$r,Zr=_slicedToArray$2(getNewCanvasAndCtx(Tr=Kt?.95*Xt.width:Xt.width,$r=Kt?.95*Xt.height:Xt.height),2);return Wt=Zr[0],Zr[1].drawImage(Xt,0,0,Tr,$r),Mt*=.95,canvasToFile$1(Wt,Nt,He.name,He.lastModified,Mt).then(function(Sr){try{return Qt=Sr,cleanupCanvasMemory(Xt),Xt=Wt,Ot=Qt.size,hr(Math.min(99,Math.floor((Bt-Ot)/(Bt-ft)*100))),Rr}catch(Dr){return ut(Dr)}},ut)}return[1]},Ir=function(){return cleanupCanvasMemory(Xt),cleanupCanvasMemory(Wt),cleanupCanvasMemory(kt),cleanupCanvasMemory(Tt),cleanupCanvasMemory(vt),hr(100),lt(Qt)};if(At=yr,Jt(),$t=At.size>ft,Dt=At.size>He.size,!$t&&!Dt)return hr(100),lt(At);var Cr;return Ft=He.size,Bt=At.size,Ot=Bt,Xt=Tt,Kt=!Qe.alwaysKeepResolution&&$t,(Cr=(function(Tr){for(;Tr;){if(Tr.then)return void Tr.then(Cr,ut);try{if(Tr.pop){if(Tr.length)return Tr.pop()?Ir.call(this):Tr;Tr=Rr}else Tr=Tr.call(this)}catch($r){return ut($r)}}}).bind(this))(Rr)}}catch(Rr){return ut(Rr)}}).bind(this),ut)}catch(yr){return ut(yr)}}).bind(this),ut)}catch(vr){return ut(vr)}}).bind(this),ut)}catch(br){return ut(br)}}).bind(this),ut)})}var cnt=0,imageCompressionLibUrl,worker$1;function createWorker(He){var Qe=[];return Qe.push(He),new Worker(URL.createObjectURL(new Blob(Qe)))}function createSourceObject(He){return URL.createObjectURL(new Blob([He],{type:"application/javascript"}))}function stringify(He){return JSON.stringify(He,function(Qe,it){return typeof it=="function"?"BIC_FN:::(function () { return ".concat(it.toString()," })()"):it})}function parse$1(o){if(typeof o=="string")return o;var result={};return Object.entries(o).forEach(function(_ref){var _ref2=_slicedToArray$2(_ref,2),key=_ref2[0],value=_ref2[1];if(typeof value=="string"&&value.startsWith("BIC_FN:::"))try{result[key]=eval(value.replace(/^BIC_FN:::/,""))}catch(He){throw He}else result[key]=parse$1(value)}),result}function generateLib(){return createSourceObject(`
    // reconstruct library
    function imageCompression (){return (`.concat(imageCompression,`).apply(null, arguments)}

    imageCompression.getDataUrlFromFile = `).concat(imageCompression.getDataUrlFromFile,`
    imageCompression.getFilefromDataUrl = `).concat(imageCompression.getFilefromDataUrl,`
    imageCompression.loadImage = `).concat(imageCompression.loadImage,`
    imageCompression.drawImageInCanvas = `).concat(imageCompression.drawImageInCanvas,`
    imageCompression.drawFileInCanvas = `).concat(imageCompression.drawFileInCanvas,`
    imageCompression.canvasToFile = `).concat(imageCompression.canvasToFile,`
    imageCompression.getExifOrientation = `).concat(imageCompression.getExifOrientation,`
    imageCompression.handleMaxWidthOrHeight = `).concat(imageCompression.handleMaxWidthOrHeight,`
    imageCompression.followExifOrientation = `).concat(imageCompression.followExifOrientation,`
    imageCompression.cleanupCanvasMemory = `).concat(imageCompression.cleanupCanvasMemory,`
    imageCompression.isAutoOrientationInBrowser = `).concat(imageCompression.isAutoOrientationInBrowser,`
    imageCompression.approximateBelowMaximumCanvasSizeOfBrowser = `).concat(imageCompression.approximateBelowMaximumCanvasSizeOfBrowser,`
    imageCompression.getBrowserName = `).concat(imageCompression.getBrowserName,`

    // functions / objects
    getDataUrlFromFile = imageCompression.getDataUrlFromFile
    getFilefromDataUrl = imageCompression.getFilefromDataUrl
    loadImage = imageCompression.loadImage
    drawImageInCanvas = imageCompression.drawImageInCanvas
    drawFileInCanvas = imageCompression.drawFileInCanvas
    canvasToFile = imageCompression.canvasToFile
    getExifOrientation = imageCompression.getExifOrientation
    handleMaxWidthOrHeight = imageCompression.handleMaxWidthOrHeight
    followExifOrientation = imageCompression.followExifOrientation
    cleanupCanvasMemory = imageCompression.cleanupCanvasMemory
    isAutoOrientationInBrowser = imageCompression.isAutoOrientationInBrowser
    approximateBelowMaximumCanvasSizeOfBrowser = imageCompression.approximateBelowMaximumCanvasSizeOfBrowser
    getBrowserName = imageCompression.getBrowserName
    isIOS = `).concat(isIOS,`
    
    getNewCanvasAndCtx = `).concat(getNewCanvasAndCtx,`
    CustomFileReader = FileReader
    CustomFile = File
    MAX_CANVAS_SIZE = `).concat(JSON.stringify(MAX_CANVAS_SIZE),`
    BROWSER_NAME = `).concat(JSON.stringify(BROWSER_NAME),`
    function compress (){return (`).concat(compress,`).apply(null, arguments)}

    // core-js
    function _slicedToArray(arr, n) { return arr }
    function _typeof(a) { return typeof a }
    function _objectSpread2(target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i] != null ? arguments[i] : {};
  
        Object.assign(target, source)
      }
  
      return target;
    }

    // Libraries
    const parse = `).concat(parse$1,`
    const UPNG = {}
    UPNG.toRGBA8 = `).concat(UPNG.toRGBA8,`
    UPNG.toRGBA8.decodeImage = `).concat(UPNG.toRGBA8.decodeImage,`
    UPNG.decode = `).concat(UPNG.decode,`
    UPNG.decode._decompress = `).concat(UPNG.decode._decompress,`
    UPNG.decode._inflate = `).concat(UPNG.decode._inflate,`
    UPNG.decode._readInterlace = `).concat(UPNG.decode._readInterlace,`
    UPNG.decode._getBPP = `).concat(UPNG.decode._getBPP,` 
    UPNG.decode._filterZero = `).concat(UPNG.decode._filterZero,`
    UPNG.decode._paeth = `).concat(UPNG.decode._paeth,`
    UPNG.decode._IHDR = `).concat(UPNG.decode._IHDR,`
    UPNG._bin = parse(`).concat(stringify(UPNG._bin),`)
    UPNG._copyTile = `).concat(UPNG._copyTile,`
    UPNG.encode = `).concat(UPNG.encode,`
    UPNG.encodeLL = `).concat(UPNG.encodeLL,` 
    UPNG.encode._main = `).concat(UPNG.encode._main,`
    UPNG.encode.compressPNG = `).concat(UPNG.encode.compressPNG,` 
    UPNG.encode.compress = `).concat(UPNG.encode.compress,`
    UPNG.encode.framize = `).concat(UPNG.encode.framize,` 
    UPNG.encode._updateFrame = `).concat(UPNG.encode._updateFrame,` 
    UPNG.encode._prepareDiff = `).concat(UPNG.encode._prepareDiff,` 
    UPNG.encode._filterZero = `).concat(UPNG.encode._filterZero,` 
    UPNG.encode._filterLine = `).concat(UPNG.encode._filterLine,`
    UPNG.encode.concatRGBA = `).concat(UPNG.encode.concatRGBA,`
    UPNG.crc = parse(`).concat(stringify(UPNG.crc),`)
    UPNG.crc.table = ( function() {
    var tab = new Uint32Array(256);
    for (var n=0; n<256; n++) {
      var c = n;
      for (var k=0; k<8; k++) {
        if (c & 1)  c = 0xedb88320 ^ (c >>> 1);
        else        c = c >>> 1;
      }
      tab[n] = c;  }
    return tab;  })()
    UPNG.quantize = `).concat(UPNG.quantize,` 
    UPNG.quantize.getKDtree = `).concat(UPNG.quantize.getKDtree,` 
    UPNG.quantize.getNearest = `).concat(UPNG.quantize.getNearest,` 
    UPNG.quantize.planeDst = `).concat(UPNG.quantize.planeDst,` 
    UPNG.quantize.dist = `).concat(UPNG.quantize.dist,`     
    UPNG.quantize.splitPixels = `).concat(UPNG.quantize.splitPixels,` 
    UPNG.quantize.vecDot = `).concat(UPNG.quantize.vecDot,` 
    UPNG.quantize.stats = `).concat(UPNG.quantize.stats,` 
    UPNG.quantize.estats = `).concat(UPNG.quantize.estats,`
    UPNG.M4 = parse(`).concat(stringify(UPNG.M4),`)
    UPNG.encode.concatRGBA = `).concat(UPNG.encode.concatRGBA,`
    UPNG.inflateRaw=function(){
    var H={};H.H={};H.H.N=function(N,W){var R=Uint8Array,i=0,m=0,J=0,h=0,Q=0,X=0,u=0,w=0,d=0,v,C;
      if(N[0]==3&&N[1]==0)return W?W:new R(0);var V=H.H,n=V.b,A=V.e,l=V.R,M=V.n,I=V.A,e=V.Z,b=V.m,Z=W==null;
      if(Z)W=new R(N.length>>>2<<5);while(i==0){i=n(N,d,1);m=n(N,d+1,2);d+=3;if(m==0){if((d&7)!=0)d+=8-(d&7);
        var D=(d>>>3)+4,q=N[D-4]|N[D-3]<<8;if(Z)W=H.H.W(W,w+q);W.set(new R(N.buffer,N.byteOffset+D,q),w);d=D+q<<3;
        w+=q;continue}if(Z)W=H.H.W(W,w+(1<<17));if(m==1){v=b.J;C=b.h;X=(1<<9)-1;u=(1<<5)-1}if(m==2){J=A(N,d,5)+257;
        h=A(N,d+5,5)+1;Q=A(N,d+10,4)+4;d+=14;var E=d,j=1;for(var c=0;c<38;c+=2){b.Q[c]=0;b.Q[c+1]=0}for(var c=0;
                                                                                                        c<Q;c++){var K=A(N,d+c*3,3);b.Q[(b.X[c]<<1)+1]=K;if(K>j)j=K}d+=3*Q;M(b.Q,j);I(b.Q,j,b.u);v=b.w;C=b.d;
        d=l(b.u,(1<<j)-1,J+h,N,d,b.v);var r=V.V(b.v,0,J,b.C);X=(1<<r)-1;var S=V.V(b.v,J,h,b.D);u=(1<<S)-1;M(b.C,r);
        I(b.C,r,v);M(b.D,S);I(b.D,S,C)}while(!0){var T=v[e(N,d)&X];d+=T&15;var p=T>>>4;if(p>>>8==0){W[w++]=p}else if(p==256){break}else{var z=w+p-254;
        if(p>264){var _=b.q[p-257];z=w+(_>>>3)+A(N,d,_&7);d+=_&7}var $=C[e(N,d)&u];d+=$&15;var s=$>>>4,Y=b.c[s],a=(Y>>>4)+n(N,d,Y&15);
        d+=Y&15;while(w<z){W[w]=W[w++-a];W[w]=W[w++-a];W[w]=W[w++-a];W[w]=W[w++-a]}w=z}}}return W.length==w?W:W.slice(0,w)};
      H.H.W=function(N,W){var R=N.length;if(W<=R)return N;var V=new Uint8Array(R<<1);V.set(N,0);return V};
      H.H.R=function(N,W,R,V,n,A){var l=H.H.e,M=H.H.Z,I=0;while(I<R){var e=N[M(V,n)&W];n+=e&15;var b=e>>>4;
        if(b<=15){A[I]=b;I++}else{var Z=0,m=0;if(b==16){m=3+l(V,n,2);n+=2;Z=A[I-1]}else if(b==17){m=3+l(V,n,3);
          n+=3}else if(b==18){m=11+l(V,n,7);n+=7}var J=I+m;while(I<J){A[I]=Z;I++}}}return n};H.H.V=function(N,W,R,V){var n=0,A=0,l=V.length>>>1;
        while(A<R){var M=N[A+W];V[A<<1]=0;V[(A<<1)+1]=M;if(M>n)n=M;A++}while(A<l){V[A<<1]=0;V[(A<<1)+1]=0;A++}return n};
      H.H.n=function(N,W){var R=H.H.m,V=N.length,n,A,l,M,I,e=R.j;for(var M=0;M<=W;M++)e[M]=0;for(M=1;M<V;M+=2)e[N[M]]++;
        var b=R.K;n=0;e[0]=0;for(A=1;A<=W;A++){n=n+e[A-1]<<1;b[A]=n}for(l=0;l<V;l+=2){I=N[l+1];if(I!=0){N[l]=b[I];
          b[I]++}}};H.H.A=function(N,W,R){var V=N.length,n=H.H.m,A=n.r;for(var l=0;l<V;l+=2)if(N[l+1]!=0){var M=l>>1,I=N[l+1],e=M<<4|I,b=W-I,Z=N[l]<<b,m=Z+(1<<b);
        while(Z!=m){var J=A[Z]>>>15-W;R[J]=e;Z++}}};H.H.l=function(N,W){var R=H.H.m.r,V=15-W;for(var n=0;n<N.length;
                                                                                                 n+=2){var A=N[n]<<W-N[n+1];N[n]=R[A]>>>V}};H.H.M=function(N,W,R){R=R<<(W&7);var V=W>>>3;N[V]|=R;N[V+1]|=R>>>8};
      H.H.I=function(N,W,R){R=R<<(W&7);var V=W>>>3;N[V]|=R;N[V+1]|=R>>>8;N[V+2]|=R>>>16};H.H.e=function(N,W,R){return(N[W>>>3]|N[(W>>>3)+1]<<8)>>>(W&7)&(1<<R)-1};
      H.H.b=function(N,W,R){return(N[W>>>3]|N[(W>>>3)+1]<<8|N[(W>>>3)+2]<<16)>>>(W&7)&(1<<R)-1};H.H.Z=function(N,W){return(N[W>>>3]|N[(W>>>3)+1]<<8|N[(W>>>3)+2]<<16)>>>(W&7)};
      H.H.i=function(N,W){return(N[W>>>3]|N[(W>>>3)+1]<<8|N[(W>>>3)+2]<<16|N[(W>>>3)+3]<<24)>>>(W&7)};H.H.m=function(){var N=Uint16Array,W=Uint32Array;
        return{K:new N(16),j:new N(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new N(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new W(32),J:new N(512),_:[],h:new N(32),$:[],w:new N(32768),C:[],v:[],d:new N(32768),D:[],u:new N(512),Q:[],r:new N(1<<15),s:new W(286),Y:new W(30),a:new W(19),t:new W(15e3),k:new N(1<<16),g:new N(1<<15)}}();
      (function(){var N=H.H.m,W=1<<15;for(var R=0;R<W;R++){var V=R;V=(V&2863311530)>>>1|(V&1431655765)<<1;
        V=(V&3435973836)>>>2|(V&858993459)<<2;V=(V&4042322160)>>>4|(V&252645135)<<4;V=(V&4278255360)>>>8|(V&16711935)<<8;
        N.r[R]=(V>>>16|V<<16)>>>17}function n(A,l,M){while(l--!=0)A.push(0,M)}for(var R=0;R<32;R++){N.q[R]=N.S[R]<<3|N.T[R];
        N.c[R]=N.p[R]<<4|N.z[R]}n(N._,144,8);n(N._,255-143,9);n(N._,279-255,7);n(N._,287-279,8);H.H.n(N._,9);
        H.H.A(N._,9,N.J);H.H.l(N._,9);n(N.$,32,5);H.H.n(N.$,5);H.H.A(N.$,5,N.h);H.H.l(N.$,5);n(N.Q,19,0);n(N.C,286,0);
        n(N.D,30,0);n(N.v,320,0)}());return H.H.N}()
    
    const UZIP = {}
    UZIP["parse"] = `).concat(UZIP_1.parse,`
    UZIP._readLocal = `).concat(UZIP_1._readLocal,`
    UZIP.inflateRaw = `).concat(UZIP_1.inflateRaw,`
    UZIP.inflate = `).concat(UZIP_1.inflate,`
    UZIP.deflate = `).concat(UZIP_1.deflate,`
    UZIP.deflateRaw = `).concat(UZIP_1.deflateRaw,`
    UZIP.encode = `).concat(UZIP_1.encode,`
    UZIP._noNeed = `).concat(UZIP_1._noNeed,`
    UZIP._writeHeader = `).concat(UZIP_1._writeHeader,`
    UZIP.crc = parse(`).concat(stringify(UZIP_1.crc),`)
    UZIP.crc.table = ( function() {
      var tab = new Uint32Array(256);
      for (var n=0; n<256; n++) {
        var c = n;
        for (var k=0; k<8; k++) {
          if (c & 1)  c = 0xedb88320 ^ (c >>> 1);
          else        c = c >>> 1;
        }
        tab[n] = c;  }
      return tab;  })()
    
    UZIP.adler = `).concat(UZIP_1.adler,`
    UZIP.bin = parse(`).concat(stringify(UZIP_1.bin),`)
    UZIP.F = {}
    UZIP.F.deflateRaw = `).concat(UZIP_1.F.deflateRaw,`
    UZIP.F._bestMatch = `).concat(UZIP_1.F._bestMatch,`
    UZIP.F._howLong = `).concat(UZIP_1.F._howLong,`
    UZIP.F._hash = `).concat(UZIP_1.F._hash,`
    UZIP.saved = `).concat(UZIP_1.saved,`
    UZIP.F._writeBlock = `).concat(UZIP_1.F._writeBlock,`
    UZIP.F._copyExact = `).concat(UZIP_1.F._copyExact,`
    UZIP.F.getTrees = `).concat(UZIP_1.F.getTrees,`
    UZIP.F.getSecond = `).concat(UZIP_1.F.getSecond,`
    UZIP.F.nonZero = `).concat(UZIP_1.F.nonZero,`
    UZIP.F.contSize = `).concat(UZIP_1.F.contSize,`
    UZIP.F._codeTiny = `).concat(UZIP_1.F._codeTiny,` 
    UZIP.F._lenCodes = `).concat(UZIP_1.F._lenCodes,` 
    UZIP.F._hufTree = `).concat(UZIP_1.F._hufTree,` 
    UZIP.F.setDepth = `).concat(UZIP_1.F.setDepth,` 
    UZIP.F.restrictDepth = `).concat(UZIP_1.F.restrictDepth,`
    UZIP.F._goodIndex = `).concat(UZIP_1.F._goodIndex,` 
    UZIP.F._writeLit = `).concat(UZIP_1.F._writeLit,` 
    UZIP.F.inflate = `).concat(UZIP_1.F.inflate,` 
    UZIP.F._check = `).concat(UZIP_1.F._check,` 
    UZIP.F._decodeTiny = `).concat(UZIP_1.F._decodeTiny,` 
    UZIP.F._copyOut = `).concat(UZIP_1.F._copyOut,` 
    UZIP.F.makeCodes = `).concat(UZIP_1.F.makeCodes,` 
    UZIP.F.codes2map = `).concat(UZIP_1.F.codes2map,` 
    UZIP.F.revCodes = `).concat(UZIP_1.F.revCodes,` 

    // used only in deflate
    UZIP.F._putsE = `).concat(UZIP_1.F._putsE,`
    UZIP.F._putsF = `).concat(UZIP_1.F._putsF,`
  
    UZIP.F._bitsE = `).concat(UZIP_1.F._bitsE,`
    UZIP.F._bitsF = `).concat(UZIP_1.F._bitsF,`

    UZIP.F._get17 = `).concat(UZIP_1.F._get17,`
    UZIP.F._get25 = `).concat(UZIP_1.F._get25,`
    UZIP.F.U = function(){
      var u16=Uint16Array, u32=Uint32Array;
      return {
        next_code : new u16(16),
        bl_count  : new u16(16),
        ordr : [ 16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15 ],
        of0  : [3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],
        exb  : [0,0,0,0,0,0,0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4,  4,  5,  5,  5,  5,  0,  0,  0,  0],
        ldef : new u16(32),
        df0  : [1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577, 65535, 65535],
        dxb  : [0,0,0,0,1,1,2, 2, 3, 3, 4, 4, 5, 5,  6,  6,  7,  7,  8,  8,   9,   9,  10,  10,  11,  11,  12,   12,   13,   13,     0,     0],
        ddef : new u32(32),
        flmap: new u16(  512),  fltree: [],
        fdmap: new u16(   32),  fdtree: [],
        lmap : new u16(32768),  ltree : [],  ttree:[],
        dmap : new u16(32768),  dtree : [],
        imap : new u16(  512),  itree : [],
        //rev9 : new u16(  512)
        rev15: new u16(1<<15),
        lhst : new u32(286), dhst : new u32( 30), ihst : new u32(19),
        lits : new u32(15000),
        strt : new u16(1<<16),
        prev : new u16(1<<15)
      };
    } ();

    (function(){
      var U = UZIP.F.U;
      var len = 1<<15;
      for(var i=0; i<len; i++) {
        var x = i;
        x = (((x & 0xaaaaaaaa) >>> 1) | ((x & 0x55555555) << 1));
        x = (((x & 0xcccccccc) >>> 2) | ((x & 0x33333333) << 2));
        x = (((x & 0xf0f0f0f0) >>> 4) | ((x & 0x0f0f0f0f) << 4));
        x = (((x & 0xff00ff00) >>> 8) | ((x & 0x00ff00ff) << 8));
        U.rev15[i] = (((x >>> 16) | (x << 16)))>>>17;
      }
  
      function pushV(tgt, n, sv) {  while(n--!=0) tgt.push(0,sv);  }
  
      for(var i=0; i<32; i++) {  U.ldef[i]=(U.of0[i]<<3)|U.exb[i];  U.ddef[i]=(U.df0[i]<<4)|U.dxb[i];  }
  
      pushV(U.fltree, 144, 8);  pushV(U.fltree, 255-143, 9);  pushV(U.fltree, 279-255, 7);  pushV(U.fltree,287-279,8);
      /*
        var i = 0;
        for(; i<=143; i++) U.fltree.push(0,8);
        for(; i<=255; i++) U.fltree.push(0,9);
        for(; i<=279; i++) U.fltree.push(0,7);
        for(; i<=287; i++) U.fltree.push(0,8);
        */
      UZIP.F.makeCodes(U.fltree, 9);
      UZIP.F.codes2map(U.fltree, 9, U.flmap);
      UZIP.F.revCodes (U.fltree, 9)
  
      pushV(U.fdtree,32,5);
      //for(i=0;i<32; i++) U.fdtree.push(0,5);
      UZIP.F.makeCodes(U.fdtree, 5);
      UZIP.F.codes2map(U.fdtree, 5, U.fdmap);
      UZIP.F.revCodes (U.fdtree, 5)
  
      pushV(U.itree,19,0);  pushV(U.ltree,286,0);  pushV(U.dtree,30,0);  pushV(U.ttree,320,0);
      /*
        for(var i=0; i< 19; i++) U.itree.push(0,0);
        for(var i=0; i<286; i++) U.ltree.push(0,0);
        for(var i=0; i< 30; i++) U.dtree.push(0,0);
        for(var i=0; i<320; i++) U.ttree.push(0,0);
        */
    })()
    `))}function generateWorkerScript(){return createWorker(`
    let scriptImported = false
    self.addEventListener('message', async (e) => {
      const { file, id, imageCompressionLibUrl, options } = e.data
      options.onProgress = (progress) => self.postMessage({ progress, id })
      try {
        if (!scriptImported) {
          // console.log('[worker] importScripts', imageCompressionLibUrl)
          self.importScripts(imageCompressionLibUrl)
          scriptImported = true
        }
        // console.log('[worker] self', self)
        const compressedFile = await imageCompression(file, options)
        self.postMessage({ file: compressedFile, id })
      } catch (e) {
        // console.error('[worker] error', e)
        self.postMessage({ error: e.message + '\\n' + e.stack, id })
      }
    })
  `)}function compressOnWebWorker(He,Qe){return new Promise(function(it,lt){var ut=cnt+=1;imageCompressionLibUrl||(imageCompressionLibUrl=generateLib()),worker$1||(worker$1=generateWorkerScript()),worker$1.addEventListener("message",function dt(xt){if(xt.data.id===ut){if(Qe.signal&&Qe.signal.aborted)return;if(xt.data.progress!==void 0)return void Qe.onProgress(xt.data.progress);worker$1.removeEventListener("message",dt),xt.data.error&&lt(new Error(xt.data.error)),it(xt.data.file)}}),worker$1.addEventListener("error",lt),Qe.signal&&Qe.signal.addEventListener("abort",function(){worker$1.terminate(),lt(Qe.signal.reason)}),worker$1.postMessage({file:He,id:ut,imageCompressionLibUrl,options:_objectSpread2(_objectSpread2({},Qe),{},{onProgress:void 0,signal:void 0})})})}function imageCompression(He,Qe){return new Promise(function(it,lt){var ut,dt,xt,ft,vt,kt;if(ut=_objectSpread2({},Qe),xt=0,ft=ut.onProgress,ut.maxSizeMB=ut.maxSizeMB||Number.POSITIVE_INFINITY,vt=typeof ut.useWebWorker!="boolean"||ut.useWebWorker,delete ut.useWebWorker,ut.onProgress=function(Nt){xt=Nt,typeof ft=="function"&&ft(xt)},!(He instanceof Blob||He instanceof CustomFile))return lt(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(He.type))return lt(new Error("The file given is not an image"));if(kt=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!vt||typeof Worker!="function"||kt)return compress(He,ut).then((function(Nt){try{return dt=Nt,Mt.call(this)}catch(At){return lt(At)}}).bind(this),lt);var St=(function(){try{return Mt.call(this)}catch(Nt){return lt(Nt)}}).bind(this),Tt=function(At){try{return compress(He,ut).then(function($t){try{return dt=$t,St()}catch(Dt){return lt(Dt)}},lt)}catch($t){return lt($t)}};try{return compressOnWebWorker(He,ut).then(function(Nt){try{return dt=Nt,St()}catch{return Tt()}},Tt)}catch{Tt()}function Mt(){try{dt.name=He.name,dt.lastModified=He.lastModified}catch{}return it(dt)}})}imageCompression.getDataUrlFromFile=getDataUrlFromFile,imageCompression.getFilefromDataUrl=getFilefromDataUrl,imageCompression.loadImage=loadImage$1,imageCompression.drawImageInCanvas=drawImageInCanvas,imageCompression.drawFileInCanvas=drawFileInCanvas,imageCompression.canvasToFile=canvasToFile$1,imageCompression.getExifOrientation=getExifOrientation,imageCompression.handleMaxWidthOrHeight=handleMaxWidthOrHeight,imageCompression.followExifOrientation=followExifOrientation,imageCompression.cleanupCanvasMemory=cleanupCanvasMemory,imageCompression.isAutoOrientationInBrowser=isAutoOrientationInBrowser,imageCompression.approximateBelowMaximumCanvasSizeOfBrowser=approximateBelowMaximumCanvasSizeOfBrowser,imageCompression.getBrowserName=getBrowserName,imageCompression.version="2.0.0";function getImageUrlDimensionOrThrow(He){return new Promise((Qe,it)=>{const lt=new Image;lt.onload=()=>Qe({height:lt.height,width:lt.width}),lt.onerror=it,lt.src=He})}const getCompressedDimensions=He=>{if(!He)return{height:void 0,width:void 0};const{height:Qe,width:it}=He;if(it==null||Qe==null||isNaN(it)||isNaN(Qe))return{height:void 0,width:void 0};const lt=He.divisibleBy??1,ut=He.maxEdge??1024,dt=Math.max(Qe,it),xt=Math.min(Qe,it),ft=dt>ut?ut/dt:1,vt=Math.floor(dt*ft/lt)*lt,kt=Math.floor(xt*ft/lt)*lt;return Qe>it?{height:vt,width:kt}:{width:vt,height:kt}},compressImage=async(He,Qe)=>await imageCompression.drawFileInCanvas(await imageCompression(He,{maxWidthOrHeight:1024,maxSizeMB:1,useWebWorker:!0,fileType:"image/png",...Qe})),resizeImage=async(He,Qe,it)=>{const[lt]=await compressImage(He),ut=document.createElement("canvas");ut.width=Qe,ut.height=it,ut.hidden=!0;const dt=ut.getContext("2d",{alpha:!1});if(!dt)throw new Error("Failed to get context of canvas");dt.drawImage(lt,0,0,Qe,it);const xt=await new Promise(ft=>ut.toBlob(ft));if(!xt)throw new Error("Failed to convert canvas to blob");return new File([xt],He.name,{type:"image/png"})},isOffscreenCanvas=He=>typeof window.OffscreenCanvas=="function"&&He instanceof window.OffscreenCanvas,canvasToFile=async(He,Qe)=>{const it=isOffscreenCanvas(He)?await He.convertToBlob():await new Promise(ut=>{He.toBlob(ut)});return it?new File([it],Qe,{type:"image/png"}):void 0},canvasToBlob=He=>isOffscreenCanvas(He)?He.convertToBlob():new Promise(Qe=>{He.toBlob(Qe)});async function loadImage(He,Qe=new Image){return new Promise((it,lt)=>{Qe.onload=()=>it(Qe),Qe.onerror=lt,Qe.src=He})}async function fetchToBlob(He){return(await fetch(He,{method:"GET"})).blob()}async function fetchToBlobUrl(He){const Qe=await fetchToBlob(He);return URL.createObjectURL(Qe)}async function fetchToBase64(He){const it=await(await fetch(He)).blob();return new Promise((lt,ut)=>{try{const dt=new FileReader;dt.onload=function(){lt(this.result)},dt.readAsDataURL(it)}catch(dt){ut(dt)}})}async function downloadFile(He,Qe,it){const ut=await(await fetch(He,{method:"GET"})).blob();let dt=Qe,xt="";if(!it?.skipConversion&&Qe.endsWith(".webp")){dt=Qe.replace(".webp",".png");const vt=await convertBlobToPng(ut,dt);if(!vt)throw new Error("conversion error: file is invalid");xt=URL.createObjectURL(vt)}else xt=URL.createObjectURL(new Blob([ut]));const ft=document.createElement("a");ft.href=xt,ft.setAttribute("download",`${dt}`),document.body.appendChild(ft),ft.click(),ft.parentNode?.removeChild(ft)}async function convertBlobToPng(He,Qe){const it=new Image,lt=()=>new Promise((ut,dt)=>{it.onload=()=>ut(it),it.onerror=dt,it.src=URL.createObjectURL(He)});try{const ut=await lt();let dt;if(typeof window.OffscreenCanvas=="function"){dt=new OffscreenCanvas(ut.width,ut.height);const xt=dt.getContext("2d");if(!xt)throw new Error("ctx not initialized");xt.drawImage(ut,0,0,ut.width,ut.height)}else{dt=document.createElement("canvas");const xt=dt.getContext("2d");if(dt.width=ut.width,dt.height=ut.height,!xt)throw new Error("ctx not initialized");xt.drawImage(ut,0,0,ut.width,ut.height)}return canvasToFile(dt,Qe)}catch(ut){console.log("cannot download image: ",ut)}}function getArtworkAlt(He,Qe){if(!He)return;const it=`AI art "${He.title}"`,lt=(He.tags?.length??0)>0?`featuring ${naturalJoin(He.tags?.map(xt=>`#${xt.name}`)??[])}`:"",ut=Qe?`generated with ${Qe}`:"",dt=He.prompts?`for keywords ${He.prompts}`:"";return[it,lt,ut,dt].filter(Boolean).join(" ")}function naturalJoin(He){const Qe=He.pop();return He.length===0?Qe:`${He.join(", ")} and ${Qe}`}function getImageDownloadFilename({artwork:He,task:Qe,mediaIdx:it}){return He?`pixai-${He.id}${He.title?"-"+He.title:""}`:Qe?it!=null?`pixai-${Qe.id}-${it}`:`pixai-${Qe.id}`:"pixai-image"}function getImageDownloadFileExt({task:He,artwork:Qe,media:it}){if(getVideoMediaIdFromTask(He)||Qe?.videoMediaId)return"mp4";if(isAnimateDiffTask(He)||isAnimatedArtwork(Qe))return"webp";const lt=(it?.imageType||He?.media?.imageType)??"png";if(lt.startsWith("image/")){const ut=lt.split("/");if(ut.length>1)return ut[1].toLowerCase()}return lt}function getOpenArtworkDetailQuery(He){return withQuery(location.href,{artworkId:He,openDetail:"true"})}const $itemLiked=new BehaviorSubject({}),useItemLiked=createMapSubjectValueHook($itemLiked,!1),$itemLikedCount=new BehaviorSubject({}),useItemLikedCount=createMapSubjectValueHook($itemLikedCount,0),once$1=He=>{let Qe=null;return(...it)=>Qe||(Qe=He(...it).finally(()=>{Qe=null}),Qe)},BaseLikeButton=({id:He,initialCount:Qe,initialValue:it,onSuccess:lt=()=>{},onBtnClick:ut=()=>{},handler:dt,render:xt,signModalProps:ft})=>{const[vt,kt]=useItemLiked(He,it),[St,Tt]=useItemLikedCount(He,Qe),{data:Mt}=useUserInfo(),Nt=reactExports.useCallback(once$1(async At=>{At.preventDefault(),At.stopPropagation();const $t=!vt;if(ut($t),!!He){if(!Mt){openSignModal(ft,{fromPath:"like"});return}kt($t),Tt(St+($t?1:-1));try{await dt(He,$t),lt($t)}catch(Dt){kt(vt),Tt(St),toast.error(Dt.message),console.error(Dt)}}}),[Mt,vt,St,ft]);return xt({value:vt,count:St,onClick:Nt})},ArtworkLikeButton=({artworkId:He,artwork:Qe,initialValue:it=Qe?.liked??!1,initialCount:lt=Qe?.likedCount??0,countStyle:ut,numOnTop:dt,hideValueOnZero:xt,trackingArgs:ft,afterClick:vt,oauthReturnOpensDetail:kt})=>jsxRuntimeExports.jsx(BaseLikeButton,{id:He,initialCount:lt,initialValue:it,onBtnClick:St=>{St&&(track("like_click",{id:He,tags:Qe?.tags?.map(({name:Tt})=>Tt),authorId:Qe?.authorId,type:RefType.Artwork,...ft},{destinations:["amplitude"]}),vt?.())},handler:(St,Tt)=>executeMarkArtwork({artworkId:St,type:MarkType.Like,target:Tt}),render:({value:St,count:Tt,onClick:Mt})=>jsxRuntimeExports.jsx(ButtonBase,{component:"div",role:"button",className:"cursor-pointer outline transition -m-2 p-2 rounded-md focus-within:outline-1",onClick:Mt,children:jsxRuntimeExports.jsxs("div",{className:cx("flex gap-1 items-center",{"flex-col-reverse":dt}),children:[jsxRuntimeExports.jsx(LikeHeart,{liked:St,className:"size-5"}),xt&&!Tt?null:jsxRuntimeExports.jsx("span",{className:"text-sm tabular-nums",style:{color:"inherit",...ut},children:formatNum(Tt||0)})]})}),signModalProps:kt?{oauthRedirectUrl:getOpenArtworkDetailQuery(He)}:void 0}),fluentChevronRight16Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M5.74 3.2a.75.75 0 0 0-.04 1.06L9.227 8L5.7 11.74a.75.75 0 1 0 1.1 1.02l4-4.25a.75.75 0 0 0 0-1.02l-4-4.25a.75.75 0 0 0-1.06-.04"})}),mingcuteCheckFill=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsxs("g",{fill:"none",fillRule:"evenodd",children:[jsxRuntimeExports.jsx("path",{d:"M24 0v24H0V0h24ZM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018Zm.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01l-.184-.092Z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M21.546 5.111a1.5 1.5 0 0 1 0 2.121L10.303 18.475a1.6 1.6 0 0 1-2.263 0L2.454 12.89a1.5 1.5 0 1 1 2.121-2.121l4.596 4.596L19.424 5.111a1.5 1.5 0 0 1 2.122 0Z"})]})});function UIMenuTrigger(He){const Qe=reactExports.useContext($3674c52c6b3c5bce$export$c7e742effb1c51e2);return $$3(He).with({children:N$4.array(N$4.when(reactExports.isValidElement))},it=>!!Qe,it=>jsxRuntimeExports.jsx($3674c52c6b3c5bce$export$ecabc99eeffab7ca,{children:it.children})).with({onOpenChange:N$4.optional(N$4.any)},it=>jsxRuntimeExports.jsx($3674c52c6b3c5bce$export$27d2ad3c5815583e,{onOpenChange:it.onOpenChange,children:it.children})).otherwise(()=>null)}function UIMenuSeparator(He){return jsxRuntimeExports.jsx($431f98aba6844401$export$1ff3c3f08ae963c0,{id:He.id,className:"col-span-full -mx-1 my-1 border-t border-black/10 dark:border-white/10"})}function UIMenuLabel(He){return jsxRuntimeExports.jsx($72a5793c14baf454$export$8b251419efc915eb,{...He,className:cx("col-span-full flex items-center h-7 px-2 text-xs",He.className),children:He.children})}const UIMenuContext=reactExports.createContext({isRoot:!0});function UIMenuProvider(He){const Qe=reactExports.useContext(UIMenuContext);return jsxRuntimeExports.jsx(UIMenuContext.Provider,{value:{isRoot:!Qe},children:He.children})}const menuStyles=ce$1({slots:{popover:["entering:animate-in","entering:fade-in","entering:data-[placement=top]:slide-in-from-bottom-1","entering:data-[placement=bottom]:slide-in-from-top-1","entering:data-[placement=left]:slide-in-from-right-1","entering:data-[placement=right]:slide-in-from-left-1","exiting:animate-out","exiting:fade-out","exiting:data-[placement=top]:slide-out-to-bottom-1","exiting:data-[placement=bottom]:slide-out-to-top-1","exiting:data-[placement=left]:slide-out-to-right-1","exiting:data-[placement=right]:slide-out-to-left-1"],menu:["grid grid-cols-[auto_1fr_auto] min-w-[100px] max-h-[inherit] p-1 overflow-auto text-sm rounded-lg ring-1 shadow-lg outline-none","bg-white ring-black/20","dark:bg-zinc-700 dark:ring-white/20 dark:shadow-black/20"]}}),UIMenuSeparatorSymbol=Symbol("menu separator");function UIMenu(He){const Qe=reactExports.useContext(UIMenuContext),it=reactExports.useContext($07b14b47974efb58$export$9b9a0cd73afb7ca4),lt=reactExports.useRef(null);lt.current=resolveTrigger(it);const ut=reactExports.useMemo(()=>He.items&&Array.from(He.items)?.map((ft,vt)=>ft===UIMenuSeparatorSymbol?{id:`sep-${vt}`,type:"separator"}:ft),[He.items]),dt=reactExports.useCallback(ft=>typeof He.children=="function"?a$3({id:N$4.string,type:"separator"},ft)?jsxRuntimeExports.jsx(UIMenuSeparator,{id:ft.id}):He.children(ft):He.children,[He]),xt=menuStyles();return jsxRuntimeExports.jsx(UIMenuProvider,{children:jsxRuntimeExports.jsx($07b14b47974efb58$export$5b6b19405a83ff9d,{triggerRef:lt,placement:He.placement,offset:Qe.isRoot?4:0,crossOffset:Qe.isRoot?0:-4,className:xt.popover(),children:jsxRuntimeExports.jsx($3674c52c6b3c5bce$export$d9b273488cd8ce6f,{items:ut,onAction:He.onAction,selectionMode:He.selectionMode,selectedKeys:He.selectedKeys,onSelectionChange:He.onSelectionChange,className:xt.menu({className:He.className}),style:He.style,children:typeof He.children=="function"?dt:He.children})})})}UIMenu.compact=He=>{const Qe=compact(He);return Qe.slice(Qe.findIndex(it=>it!==UIMenuSeparatorSymbol),Qe.findLastIndex(it=>it!==UIMenuSeparatorSymbol)+1)};function resolveTrigger(He){const Qe=He&&"triggerRef"in He?He.triggerRef?.current:void 0;return Qe?.querySelector("[data-ref-caret]")??Qe}const menuItemStyles$1=ce$1({slots:{root:"col-span-full grid grid-cols-subgrid items-center min-h-8 rounded outline-none cursor-default",icon:"col-start-1 inline-grid place-content-center min-w-2.5",label:"col-start-2 py-1",caret:"col-start-3 self-stretch inline-grid justify-end items-center min-w-2.5 text-neutral-600 dark:text-neutral-400",description:"col-start-2 mb-1 text-xs text-neutral-500"},variants:{color:{normal:{root:["hover:bg-black/5 focus-visible:bg-black/5 open:bg-black/5","dark:hover:bg-white/5 dark:focus-visible:bg-white/5 dark:open:bg-white/5"]},danger:{root:["text-red-600 dark:text-red-500 hover:!text-white focus-visible:!text-white open:!text-white","hover:bg-red-600 focus-visible:bg-red-600 open:bg-red-600","dark:hover:bg-red-500 dark:focus-visible:bg-red-500 dark:open:bg-red-500"]},warning:{root:["text-orange-600 dark:text-orange-500 hover:!text-white focus-visible:!text-white open:!text-white","hover:bg-orange-600 focus-visible:bg-orange-600 open:bg-orange-600","dark:hover:bg-orange-500 dark:focus-visible:bg-orange-500 dark:open:bg-orange-500"]},admin:{root:["text-amber-600 hover:bg-amber-100 focus-visible:bg-amber-100 open:bg-amber-100","dark:text-amber-500 dark:hover:bg-amber-500/10 dark:focus-visible:bg-amber-500/10 dark:open:bg-amber-500/10"]}},disabled:{true:{root:"opacity-50"}}},defaultVariants:{color:"normal",disabled:!1}});function UIMenuItem(He){const Qe=menuItemStyles$1({color:He.color,disabled:He.disabled});return jsxRuntimeExports.jsx($3674c52c6b3c5bce$export$2ce376c2cc3355c8,{id:He.id,textValue:He.textValue,isDisabled:He.disabled,className:Qe.root({className:He.className}),style:He.style,onAction:He.onAction,children:({selectionMode:it,isSelected:lt,hasSubmenu:ut})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:Qe.icon({className:(He.icon||it!=="none")&&"size-8"}),children:lt?it==="multiple"?jsxRuntimeExports.jsx(mingcuteCheckFill,{className:"size-3"}):jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 10 10",className:"size-1.5",children:jsxRuntimeExports.jsx("circle",{cx:"5",cy:"5",r:"5",fill:"currentColor"})}):He.icon}),jsxRuntimeExports.jsx("div",{className:Qe.label(),children:He.children}),jsxRuntimeExports.jsx("span",{"data-ref-caret":"",className:Qe.caret({className:ut&&"w-4 ml-4"}),children:ut&&jsxRuntimeExports.jsx(fluentChevronRight16Filled,{className:"size-4"})}),He.description&&jsxRuntimeExports.jsx("p",{className:Qe.description(),children:jsxRuntimeExports.jsx($514c0188e459b4c0$export$5f1af8db9871e1d6,{slot:"description",children:He.description})})]})})}function useArtworkGridCols(){const He=useBreakpoint("xl","up"),Qe=useBreakpoint("mmd","up");return reactExports.useMemo(()=>He?4:Qe?3:2,[He,Qe])}const fluentThumbDislike20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10.052 17.706c.34.977 1.632 1.427 2.43.59c.164-.17.326-.355.436-.519c.32-.48.455-1.113.504-1.73c.05-.628.016-1.302-.048-1.912a18 18 0 0 0-.241-1.583l-.01-.052h.883a3 3 0 0 0 2.952-3.537l-.684-3.762a4.5 4.5 0 0 0-5.612-3.536l-5.6 1.527A2.5 2.5 0 0 0 3.27 5.114l-.353 1.765c-.278 1.389.784 2.558 1.913 3.005c.323.127.614.289.84.49c1.707 1.513 2.325 2.723 3.385 4.849c.354.71.718 1.676.998 2.483m1.965-5.585v.002l.002.007l.007.031a14 14 0 0 1 .126.583c.076.39.167.92.227 1.496c.061.577.09 1.184.046 1.728c-.044.555-.16.985-.34 1.254c-.059.09-.171.222-.326.383c-.199.209-.628.16-.762-.227c-.283-.814-.664-1.83-1.048-2.601c-1.067-2.14-1.756-3.501-3.616-5.151a3.8 3.8 0 0 0-1.136-.672c-.88-.348-1.447-1.149-1.3-1.879L4.25 5.31a1.5 1.5 0 0 1 1.077-1.153l5.6-1.527a3.5 3.5 0 0 1 4.364 2.75l.684 3.762a2 2 0 0 1-1.968 2.358h-1.505a.5.5 0 0 0-.484.621"})}),icOutlineSms=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12zM7 9h2v2H7zm8 0h2v2h-2zm-4 0h2v2h-2z"})});function CardCornerDebugInfo(He){const{t:Qe}=useTranslation(["generation"]),[it]=useLocalStorage({key:"debug::show-generated-content-debug-info",defaultValue:!1}),lt=He.extra?.mediaSafetyScore!=null||He.extra?.textSafetyScore!=null,ut=He.artworkSafetyScore?.safetyScoreCount!=null&&He.artworkSafetyScore?.safetyScoreSum!=null,dt=[];if(lt){const{textSafetyScore:Tt,mediaSafetyScore:Mt}=getContentSafetyScores(He.extra);dt.push({label:"T",value:Tt,title:"Text Safety Score",color:"text-blue-400"}),dt.push({label:"M",value:Mt,title:"Media Safety Score",color:"text-green-400"})}ut&&dt.push({label:"AM",value:getGenerationModelArtworkSafetyScore(He.artworkSafetyScore),title:"Artwork Media Safety Score",color:"text-purple-400"}),He.aesScore!=null&&dt.push({label:"A",value:He.aesScore.toFixed(1),title:"Aesthetic Score",color:"text-yellow-400"});const xt=[];He.paidCredit!=null&&xt.push({label:"C",value:He.paidCredit.toString(),title:"cost",color:"text-blue-400"});const ft=He.extra?.i2vProParameters?.model;ft!=null&&xt.push({label:"",value:ft,title:Qe([`generation:image-to-video.parameters.model.${getI18nKeyForI2vModelName(ft)}.label`,"common:unknown"]),color:"text-green-400"});const vt=[];if(He.feedMetadata?.retrieverId!=null&&vt.push({label:"",value:He.feedMetadata.retrieverId,title:"retriever id",color:"text-white/70"}),!it)return null;const kt=[dt,xt,vt];if(kt.every(Tt=>Tt.length===0))return null;const St=jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:kt.map(Tt=>Tt.length>0&&jsxRuntimeExports.jsx("p",{className:"flex items-center justify-end gap-1",children:Tt.map(({label:Mt,value:Nt,title:At,color:$t},Dt)=>jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsxs("span",{className:`${$t} text-sm`,title:At,children:[Mt,jsxRuntimeExports.jsx("span",{className:"font-semibold",children:Nt})]}),Dt<Tt.length-1&&jsxRuntimeExports.jsx("span",{className:"text-white/70",children:"/"})]},`${Mt}-${Nt}-${Dt}`))}))});return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:He.children(St)})}function CardCornerOverlay({children:He,corner:Qe="bottom-left",className:it}){return jsxRuntimeExports.jsx("div",{className:cx("absolute py-2 px-3 md:px-4 text-sm md:text-base z-10 bg-gray-900/60 shadow-lg",{"rounded-tr-lg bottom-0 left-0":Qe==="bottom-left","rounded-tl-lg bottom-0 right-0":Qe==="bottom-right","rounded-br-lg top-0 left-0":Qe==="top-left","rounded-bl-lg top-0 right-0":Qe==="top-right"},it),children:He})}const mingcuteLockFill=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsxs("g",{fill:"none",fillRule:"evenodd",children:[jsxRuntimeExports.jsx("path",{d:"M24 0v24H0V0h24ZM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018Zm.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01l-.184-.092Z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M6 8a6 6 0 1 1 12 0h1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V10a2 2 0 0 1 2-2h1Zm6-4a4 4 0 0 1 4 4H8a4 4 0 0 1 4-4Zm2 10a2 2 0 0 1-1 1.732V17a1 1 0 1 1-2 0v-1.268A2 2 0 0 1 12 12a2 2 0 0 1 2 2Z"})]})});function ArtworkPrivateLabel(){const{t:He}=useTranslation(["artwork"]);return jsxRuntimeExports.jsxs("span",{className:"absolute bottom-2 left-2 whitespace-nowrap inline-flex items-center gap-0.5 h-5 px-1.5 text-black bg-white ring-1 ring-black/20 rounded-full",children:[jsxRuntimeExports.jsx(mingcuteLockFill,{className:"flex-none size-4"}),jsxRuntimeExports.jsx("span",{className:"text-xs font-medium uppercase text-shadow-none",children:He("artwork:generation.is-private")})]})}const fluentSparkle20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7.398 12.809a1.04 1.04 0 0 0 1.204-.003c.178-.13.313-.31.387-.518l.447-1.373a2.34 2.34 0 0 1 1.477-1.479l1.391-.45a1.045 1.045 0 0 0-.044-1.98l-1.375-.448a2.34 2.34 0 0 1-1.48-1.477l-.452-1.388a1.044 1.044 0 0 0-1.973.017l-.457 1.4a2.34 2.34 0 0 1-1.44 1.45l-1.39.447a1.045 1.045 0 0 0 .016 1.974l1.374.445a2.33 2.33 0 0 1 1.481 1.488l.452 1.391c.072.204.206.38.382.504m6.137 4.042a.806.806 0 0 0 1.226-.398l.248-.762a1.1 1.1 0 0 1 .26-.42c.118-.12.262-.208.42-.26l.772-.252a.8.8 0 0 0-.023-1.52l-.764-.25a1.08 1.08 0 0 1-.68-.678l-.252-.773a.8.8 0 0 0-1.518.01l-.247.762a1.07 1.07 0 0 1-.665.679l-.773.252a.8.8 0 0 0 .008 1.518l.763.247c.16.054.304.143.422.261c.119.119.207.263.258.422l.253.774a.8.8 0 0 0 .292.388"})}),icOutlineCollections=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M20 4v12H8V4h12m0-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 9.67l1.69 2.26l2.48-3.1L19 15H9zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6H2z"})}),icOutlineMenuBook=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M21 5c-1.11-.35-2.33-.5-3.5-.5c-1.95 0-4.05.4-5.5 1.5c-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5c.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5c1.35-.85 3.8-1.5 5.5-1.5c1.65 0 3.35.3 4.75 1.05c.1.05.15.05.25.05c.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1zm0 13.5c-1.1-.35-2.3-.5-3.5-.5c-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5c1.2 0 2.4.15 3.5.5v11.5z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17.5 10.5c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99zM13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99c.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24c-1.7 0-3.24.3-4.5.83zm4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99c.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24z"})]});function ArtworkTypeLabel(He){const{t:Qe}=useTranslation(["artwork","manga"]),it=$$3(He).returnType().with({type:ArtworkType.Comic},{artwork:{type:ArtworkType.Comic}},{manga:{type:MangaType.Comic}},()=>({icon:jsxRuntimeExports.jsx(icOutlineMenuBook,{className:"w-5 h-5 -translate-y-px"}),label:Qe("manga:manga-type.comic"),className:"bg-indigo-700"})).with({manga:{type:MangaType.Album}},lt=>({icon:jsxRuntimeExports.jsx(icOutlineCollections,{className:"w-5 h-5",style:{marginLeft:-1}}),label:lt?.manga?.chapter?.content?.mediaIds?.length??Qe("manga:manga-type.album"),className:"bg-indigo-700"})).with({type:"ANIMATED_COMIC"},{artwork:{type:ArtworkType.AnimatedComic}},{manga:{type:MangaType.AnimatedComic}},()=>({icon:jsxRuntimeExports.jsx(fluentSparkle20Filled,{className:"w-5 h-5",style:{marginLeft:-3}}),label:Qe("manga:manga-type.animated-comic"),className:"bg-indigo-700"})).with({type:"ANIMATED"},{artwork:{type:ArtworkType.AnimatedArtwork}},()=>({icon:jsxRuntimeExports.jsx(fluentSparkle20Filled,{className:"w-5 h-5",style:{marginLeft:-3}}),label:Qe("artwork:type.animated",{context:"short"}),className:"bg-purple-700"})).otherwise(()=>null);return it&&jsxRuntimeExports.jsxs("div",{className:cx("px-2 leading-6 text-sm whitespace-nowrap flex items-center gap-1 text-white font-medium rounded",it.className,He.className),style:He.style,children:[it.icon,it.label]})}const fluentMoreVertical20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10 6.5A1.75 1.75 0 1 1 10 3a1.75 1.75 0 0 1 0 3.5M10 17a1.75 1.75 0 1 1 0-3.5a1.75 1.75 0 0 1 0 3.5m-1.75-7a1.75 1.75 0 1 0 3.5 0a1.75 1.75 0 0 0-3.5 0"})}),fluentShare20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m13.33 12.838l4.497-4.423l.057-.065a.59.59 0 0 0-.057-.767L13.33 3.162l-.062-.053c-.36-.27-.89-.01-.89.469v2.13l-.225.015c-3.563.282-5.65 2.537-6.148 6.627c-.064.525.538.854.928.506c1.431-1.278 2.91-2.072 4.445-2.39q.369-.077.742-.117l.258-.023v2.096l.005.082c.06.453.609.666.947.334M12.226 6.72l1.152-.077V4.61l3.446 3.388l-3.446 3.39V9.231l-1.356.122h-.008c-1.703.183-3.31.865-4.827 2.002c.298-1.339.807-2.346 1.476-3.067c.83-.895 1.99-1.443 3.563-1.569M5.5 4A2.5 2.5 0 0 0 3 6.5v8A2.5 2.5 0 0 0 5.5 17h8a2.5 2.5 0 0 0 2.5-2.5v-1a.5.5 0 0 0-1 0v1a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 4 14.5v-8A1.5 1.5 0 0 1 5.5 5h3a.5.5 0 0 0 0-1z"})}),icBaselineDone=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M9 16.2L4.8 12l-1.4 1.4L9 19L21 7l-1.4-1.4L9 16.2z"})}),icRoundExplicit=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 6h-3v2h3c.55 0 1 .45 1 1s-.45 1-1 1h-3v2h3c.55 0 1 .45 1 1s-.45 1-1 1h-4c-.55 0-1-.45-1-1V8c0-.55.45-1 1-1h4c.55 0 1 .45 1 1s-.45 1-1 1z"})}),encodedJs="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO3ZhciB6PVsiMCIsIjEiLCIyIiwiMyIsIjQiLCI1IiwiNiIsIjciLCI4IiwiOSIsIkEiLCJCIiwiQyIsIkQiLCJFIiwiRiIsIkciLCJIIiwiSSIsIkoiLCJLIiwiTCIsIk0iLCJOIiwiTyIsIlAiLCJRIiwiUiIsIlMiLCJUIiwiVSIsIlYiLCJXIiwiWCIsIlkiLCJaIiwiYSIsImIiLCJjIiwiZCIsImUiLCJmIiwiZyIsImgiLCJpIiwiaiIsImsiLCJsIiwibSIsIm4iLCJvIiwicCIsInEiLCJyIiwicyIsInQiLCJ1IiwidiIsInciLCJ4IiwieSIsInoiLCIjIiwiJCIsIiUiLCIqIiwiKyIsIiwiLCItIiwiLiIsIjoiLCI7IiwiPSIsIj8iLCJAIiwiWyIsIl0iLCJeIiwiXyIsInsiLCJ8IiwifSIsIn4iXSxvPWU9PntsZXQgdD0wO2ZvcihsZXQgbD0wO2w8ZS5sZW5ndGg7bCsrKXtsZXQgYT1lW2xdLHM9ei5pbmRleE9mKGEpO3Q9dCo4MytzfXJldHVybiB0fSxNPWU9PntsZXQgdD1lLzI1NTtyZXR1cm4gdDw9LjA0MDQ1P3QvMTIuOTI6TWF0aC5wb3coKHQrLjA1NSkvMS4wNTUsMi40KX0sZz1lPT57bGV0IHQ9TWF0aC5tYXgoMCxNYXRoLm1pbigxLGUpKTtyZXR1cm4gdDw9LjAwMzEzMDg/TWF0aC50cnVuYyh0KjEyLjkyKjI1NSsuNSk6TWF0aC50cnVuYygoMS4wNTUqTWF0aC5wb3codCwuNDE2NjY2NjY2NjY2NjY2NyktLjA1NSkqMjU1Ky41KX0sQT1lPT5lPDA/LTE6MSxkPShlLHQpPT5BKGUpKk1hdGgucG93KE1hdGguYWJzKGUpLHQpLHA9Y2xhc3MgZXh0ZW5kcyBFcnJvcntjb25zdHJ1Y3RvcihlKXtzdXBlcihlKSx0aGlzLm5hbWU9IlZhbGlkYXRpb25FcnJvciIsdGhpcy5tZXNzYWdlPWV9fSxDPWU9PntpZighZXx8ZS5sZW5ndGg8Nil0aHJvdyBuZXcgcCgiVGhlIGJsdXJoYXNoIHN0cmluZyBtdXN0IGJlIGF0IGxlYXN0IDYgY2hhcmFjdGVycyIpO2xldCB0PW8oZVswXSksbD1NYXRoLmZsb29yKHQvOSkrMSxhPXQlOSsxO2lmKGUubGVuZ3RoIT09NCsyKmEqbCl0aHJvdyBuZXcgcChgYmx1cmhhc2ggbGVuZ3RoIG1pc21hdGNoOiBsZW5ndGggaXMgJHtlLmxlbmd0aH0gYnV0IGl0IHNob3VsZCBiZSAkezQrMiphKmx9YCl9LEw9ZT0+e2xldCB0PWU+PjE2LGw9ZT4+OCYyNTUsYT1lJjI1NTtyZXR1cm5bTSh0KSxNKGwpLE0oYSldfSxUPShlLHQpPT57bGV0IGw9TWF0aC5mbG9vcihlLzM2MSksYT1NYXRoLmZsb29yKGUvMTkpJTE5LHM9ZSUxOTtyZXR1cm5bZCgobC05KS85LDIpKnQsZCgoYS05KS85LDIpKnQsZCgocy05KS85LDIpKnRdfSxVPShlLHQsbCxhKT0+e0MoZSksYT1hfDE7bGV0IHM9byhlWzBdKSxFPU1hdGguZmxvb3Iocy85KSsxLG09cyU5KzEsaj0obyhlWzFdKSsxKS8xNjYsdT1uZXcgQXJyYXkobSpFKTtmb3IobGV0IHI9MDtyPHUubGVuZ3RoO3IrKylpZihyPT09MCl7bGV0IG49byhlLnN1YnN0cmluZygyLDYpKTt1W3JdPUwobil9ZWxzZXtsZXQgbj1vKGUuc3Vic3RyaW5nKDQrcioyLDYrcioyKSk7dVtyXT1UKG4saiphKX1sZXQgaD10KjQsaT1uZXcgVWludDhDbGFtcGVkQXJyYXkoaCpsKTtmb3IobGV0IHI9MDtyPGw7cisrKWZvcihsZXQgbj0wO248dDtuKyspe2xldCB5PTAsST0wLFA9MDtmb3IobGV0IGM9MDtjPEU7YysrKWZvcihsZXQgZj0wO2Y8bTtmKyspe2xldCB3PU1hdGguY29zKE1hdGguUEkqbipmL3QpKk1hdGguY29zKE1hdGguUEkqcipjL2wpLGI9dVtmK2MqbV07eSs9YlswXSp3LEkrPWJbMV0qdyxQKz1iWzJdKnd9bGV0IHE9Zyh5KSxCPWcoSSksRD1nKFApO2lbNCpuKzArcipoXT1xLGlbNCpuKzErcipoXT1CLGlbNCpuKzIrcipoXT1ELGlbNCpuKzMrcipoXT0yNTV9cmV0dXJuIGl9LFY9VTtjb25zdCB4PXNlbGYsdj0zMjtmdW5jdGlvbiAkKHtoYXNoOmV9KXtjb25zdCB0PVYoZSx2LHYpO3JldHVybiB4LnBvc3RNZXNzYWdlKHtoYXNoOmUscGl4ZWxzOnR9KX14LmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCh7ZGF0YTplfSk9PiQoZSkpfSkoKTsK",decodeBase64=He=>Uint8Array.from(atob(He),Qe=>Qe.charCodeAt(0)),blob=typeof self<"u"&&self.Blob&&new Blob([decodeBase64(encodedJs)],{type:"text/javascript;charset=utf-8"});function WorkerWrapper(He){let Qe;try{if(Qe=blob&&(self.URL||self.webkitURL).createObjectURL(blob),!Qe)throw"";const it=new Worker(Qe,{name:He?.name});return it.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(Qe)}),it}catch{return new Worker("data:text/javascript;base64,"+encodedJs,{name:He?.name})}finally{Qe&&(self.URL||self.webkitURL).revokeObjectURL(Qe)}}const decodeSize=32,worker=new WorkerWrapper,BlurHash=({hash:He,...Qe})=>{const it=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{const lt=async({data:ut})=>{if(ut.hash!==He)return;const dt=it.current?.getContext("2d");if(!dt)return;const xt=new ImageData(ut.pixels,decodeSize,decodeSize);dt.putImageData(xt,0,0)};return worker.addEventListener("message",lt),worker.postMessage({hash:He}),()=>{worker.removeEventListener("message",lt)}},[He]),jsxRuntimeExports.jsx("canvas",{ref:it,width:decodeSize,height:decodeSize,...Qe})},mediaStyle=ce$1({base:"w-full h-full",variants:{fit:{contain:"object-contain",cover:"object-cover object-top"},fadeIn:{true:""},loading:{true:"opacity-0"},blurred:{true:"blur-xl"}},compoundVariants:[{fadeIn:!0,loading:!1,className:"transition-opacity duration-200 ease-out"}],defaultVariants:{fit:"cover"}}),MediaPreviewContent=({mediaId:He,videoMediaId:Qe,blurHash:it,thumbnail:lt,preferStill:ut=!1,fit:dt="cover",alt:xt,className:ft,experiments:vt,...kt})=>{const St=getMediaUrl(Qe,"orig"),Tt=!!St,Mt=getImagePublicUrl(He),Nt=getImageThumbnailUrl(He),At=getImageStillThumbnailUrl(He),$t=lt?Tt&&ut?At:Nt:Mt,[Dt,Ft]=reactExports.useState(!0),[Bt,Ot]=reactExports.useState(!0),Qt=!ut&&Tt&&Bt,[Wt]=useBlurNsfw(),Xt=a$3({experiments:{safetyBlur:!0},blurNsfw:!0},{experiments:vt,blurNsfw:Wt,mediaId:He});return jsxRuntimeExports.jsxs("div",{...kt,className:cx("group relative isolate bg-skeleton overflow-hidden",ft||"w-full h-full"),children:[it&&jsxRuntimeExports.jsx(BlurHash,{className:"z-[-1] absolute inset-0 w-full h-full",hash:it}),$t&&jsxRuntimeExports.jsx("img",{alt:xt,loading:"lazy",decoding:"async",src:$t,className:mediaStyle({fit:dt,fadeIn:!!it,loading:Dt,blurred:Xt}),onLoadStart:()=>Ft(!0),onLoad:()=>Ft(!1)}),Tt&&!ut&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[St&&jsxRuntimeExports.jsx(VideoMedia,{autoPlay:!0,src:St,className:mediaStyle({fit:dt,fadeIn:!!it&&Dt,loading:Bt,blurred:Xt,className:"absolute inset-0"}),onLoadStart:()=>Ot(!0),onLoadedData:()=>Ot(!1)}),jsxRuntimeExports.jsx(AnimatePresence,{children:Qt&&jsxRuntimeExports.jsx(motion.div,{className:"absolute inset-0 bg-white/40 flex justify-center items-center",initial:{opacity:0},animate:{opacity:1,transition:{delay:.3,duration:.2,ease:"easeOut"}},exit:{opacity:0,transition:{duration:.125,ease:"easeIn"}},children:jsxRuntimeExports.jsx(Preloader,{})})})]}),Xt&&jsxRuntimeExports.jsx(icRoundExplicit,{className:"absolute inset-0 m-auto text-3xl text-white opacity-50 group-hover:opacity-80 transition-opacity"})]})};function MediaPreview$1(He){return jsxRuntimeExports.jsx(reactExports.Suspense,{children:jsxRuntimeExports.jsx(MediaPreviewContent,{...He})})}const materialSymbolsDownload=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m12 16l-5-5l1.4-1.45l2.6 2.6V4h2v8.15l2.6-2.6L17 11l-5 5Zm-6 4q-.825 0-1.413-.588T4 18v-3h2v3h12v-3h2v3q0 .825-.588 1.413T18 20H6Z"})}),OutboundLink=({target:He="_blank",children:Qe,...it})=>jsxRuntimeExports.jsx("a",{target:He,rel:"noopener nofollow",className:cx("break-all",it.className),...it,children:Qe}),biFacebook=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131c.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951"})}),biLine=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M8 0c4.411 0 8 2.912 8 6.492c0 1.433-.555 2.723-1.715 3.994c-1.678 1.932-5.431 4.285-6.285 4.645c-.83.35-.734-.197-.696-.413l.003-.018l.114-.685c.027-.204.055-.521-.026-.723c-.09-.223-.444-.339-.704-.395C2.846 12.39 0 9.701 0 6.492C0 2.912 3.59 0 8 0M5.022 7.686H3.497V4.918a.156.156 0 0 0-.155-.156H2.78a.156.156 0 0 0-.156.156v3.486c0 .041.017.08.044.107v.001l.002.002l.002.002a.15.15 0 0 0 .108.043h2.242c.086 0 .155-.07.155-.156v-.56a.156.156 0 0 0-.155-.157m.791-2.924a.156.156 0 0 0-.156.156v3.486c0 .086.07.155.156.155h.562c.086 0 .155-.07.155-.155V4.918a.156.156 0 0 0-.155-.156zm3.863 0a.156.156 0 0 0-.156.156v2.07L7.923 4.832l-.013-.015v-.001l-.01-.01l-.003-.003l-.011-.009h-.001L7.88 4.79l-.003-.002l-.005-.003l-.008-.005h-.002l-.003-.002l-.01-.004l-.004-.002l-.01-.003h-.002l-.003-.001l-.009-.002h-.006l-.003-.001h-.004l-.002-.001h-.574a.156.156 0 0 0-.156.155v3.486c0 .086.07.155.156.155h.56c.087 0 .157-.07.157-.155v-2.07l1.6 2.16a.2.2 0 0 0 .039.038l.001.001l.01.006l.004.002l.008.004l.007.003l.005.002l.01.003h.003a.2.2 0 0 0 .04.006h.56c.087 0 .157-.07.157-.155V4.918a.156.156 0 0 0-.156-.156zm3.815.717v-.56a.156.156 0 0 0-.155-.157h-2.242a.16.16 0 0 0-.108.044h-.001l-.001.002l-.002.003a.16.16 0 0 0-.044.107v3.486c0 .041.017.08.044.107l.002.003l.002.002a.16.16 0 0 0 .108.043h2.242c.086 0 .155-.07.155-.156v-.56a.156.156 0 0 0-.155-.157H11.81v-.589h1.525c.086 0 .155-.07.155-.156v-.56a.156.156 0 0 0-.155-.157H11.81v-.589h1.525c.086 0 .155-.07.155-.156Z"})}),biPinterest=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M8 0a8 8 0 0 0-2.915 15.452c-.07-.633-.134-1.606.027-2.297c.146-.625.938-3.977.938-3.977s-.239-.479-.239-1.187c0-1.113.645-1.943 1.448-1.943c.682 0 1.012.512 1.012 1.127c0 .686-.437 1.712-.663 2.663c-.188.796.4 1.446 1.185 1.446c1.422 0 2.515-1.5 2.515-3.664c0-1.915-1.377-3.254-3.342-3.254c-2.276 0-3.612 1.707-3.612 3.471c0 .688.265 1.425.595 1.826a.24.24 0 0 1 .056.23c-.061.252-.196.796-.222.907c-.035.146-.116.177-.268.107c-1-.465-1.624-1.926-1.624-3.1c0-2.523 1.834-4.84 5.286-4.84c2.775 0 4.932 1.977 4.932 4.62c0 2.757-1.739 4.976-4.151 4.976c-.811 0-1.573-.421-1.834-.919l-.498 1.902c-.181.695-.669 1.566-.995 2.097A8 8 0 1 0 8 0"})}),biWhatsapp=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M13.601 2.326A7.85 7.85 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.9 7.9 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.9 7.9 0 0 0 13.6 2.326zM7.994 14.521a6.6 6.6 0 0 1-3.356-.92l-.24-.144l-2.494.654l.666-2.433l-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931a6.56 6.56 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592m3.615-4.934c-.197-.099-1.17-.578-1.353-.646c-.182-.065-.315-.099-.445.099c-.133.197-.513.646-.627.775c-.114.133-.232.148-.43.05c-.197-.1-.836-.308-1.592-.985c-.59-.525-.985-1.175-1.103-1.372c-.114-.198-.011-.304.088-.403c.087-.088.197-.232.296-.346c.1-.114.133-.198.198-.33c.065-.134.034-.248-.015-.347c-.05-.099-.445-1.076-.612-1.47c-.16-.389-.323-.335-.445-.34c-.114-.007-.247-.007-.38-.007a.73.73 0 0 0-.529.247c-.182.198-.691.677-.691 1.654s.71 1.916.81 2.049c.098.133 1.394 2.132 3.383 2.992c.47.205.84.326 1.129.418c.475.152.904.129 1.246.08c.38-.058 1.171-.48 1.338-.943c.164-.464.164-.86.114-.943c-.049-.084-.182-.133-.38-.232"})}),icBaselineContentCopy=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})}),icBaselineIosShare=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m16 5l-1.42 1.42l-1.59-1.59V16h-1.98V4.83L9.42 6.42L8 5l4-4l4 4zm4 5v11c0 1.1-.9 2-2 2H6a2 2 0 0 1-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3a2 2 0 0 1 2 2z"})}),sharePlatformMap={twitter:{color:"#000",label:"X (Formerly Twitter)",icon:jsxRuntimeExports.jsx(biTwitterX,{}),shareUrl:({link:He,text:Qe,tags:it})=>formatParamURL("https://twitter.com/intent/tweet",{url:He,text:Qe,hashtags:it?.join(",")})},pinterest:{color:"#fff",label:"Pinterest",icon:jsxRuntimeExports.jsx(biPinterest,{style:{width:"100%",height:"100%",color:"#e70024"}}),shareUrl:({link:He,image:Qe})=>formatParamURL("https://www.pinterest.com/pin/create/button/",{url:He,media:Qe,method:"button"})},whatsapp:{color:"#25D366",label:"WhatsApp",icon:jsxRuntimeExports.jsx(biWhatsapp,{}),shareUrl:({link:He,text:Qe})=>formatParamURL("https://wa.me/",{text:`${Qe} ${He}`})},line:{color:"#06c755",label:"LINE",icon:jsxRuntimeExports.jsx(biLine,{}),shareUrl:({link:He,text:Qe})=>formatParamURL("https://social-plugins.line.me/lineit/share",{url:He,text:Qe})},facebook:{color:"#fff",label:"Facebook",icon:jsxRuntimeExports.jsx(biFacebook,{style:{width:"100%",height:"100%",color:"#0865fe"}}),shareUrl:({link:He})=>formatParamURL("https://www.facebook.com/sharer/sharer.php",{u:He})}},sharePlatforms=Object.keys(sharePlatformMap),ShareButton$1=({type:He,link:Qe,image:it,text:lt,tags:ut,buttonProps:dt,render:xt,afterAction:ft})=>{const{color:vt,label:kt,icon:St,shareUrl:Tt}=sharePlatformMap[He],Mt=Tt({link:formatParamURL(Qe,{utm_medium:"referral",utm_source:He,utm_content:"share"}),image:it,text:lt,tags:ut}),Nt=useMatches().at(-1),At=()=>{track("share_social_btn_click",{type:He,scene:Nt.handle.name})},$t=reactExports.cloneElement(St,{className:"size-8"}),Dt=xt?xt({onClick:At,icon:$t,label:kt,color:vt}):jsxRuntimeExports.jsx(Button,{className:"w-full py-2",onClick:At,...dt,children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-1 items-center normal-case",children:[jsxRuntimeExports.jsx("div",{className:"size-12 inline-grid place-items-center text-white rounded-full",style:{backgroundColor:vt},children:$t}),jsxRuntimeExports.jsx("div",{children:kt})]})});return jsxRuntimeExports.jsx(OutboundLink,{href:Mt,className:"no-underline",onClick:ft,children:Dt})},copy=async(He,{enableTrackValue:Qe,scene:it}={})=>{try{isAppWebview()?copyToJsBridge(He):await window.navigator.clipboard.writeText(He),toast.success("Copied to clipboard"),it!=null&&track("copy_success",{scene:it,...Qe?{value:He}:{}})}catch(lt){toast.warn(`Failed to copy to clipboard: ${lt?.message}`),console.error(lt),it!==null&&track("copy_failed",{scene:it})}},getArtworkShareLink=He=>`${location.origin}/artwork/${He}`,getModelShareLink=He=>`${location.origin}/model/${He}`,SocialShare=({image:He,text:Qe,tags:it,afterAction:lt,link:ut})=>ut?jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 flex-wrap",children:sharePlatforms.map(dt=>reactExports.createElement(ShareButton$1,{key:dt,type:dt,link:ut,image:He,text:Qe,tags:it,afterAction:lt}))}),jsxRuntimeExports.jsx(ItemShareLink,{link:ut,afterAction:lt})]}):null,SystemShareButton=({link:He,text:Qe,image:it,afterAction:lt})=>{const ut=useMatches().at(-1),dt=async xt=>{xt.preventDefault(),xt.stopPropagation();const ft=async()=>await fetch(it).then(kt=>kt.blob());navigator.share?navigator.share({title:"PixAI Art",text:Qe,url:He,...it?{files:[new File([await ft()],"image.png")]}:{}}).then(()=>{track("share_system_btn_click",{type:"system",scene:ut.handle.name})}).catch(vt=>{console.error(vt)}):toast.warn("System share is not supported"),lt?.()};return jsxRuntimeExports.jsx(IconButton,{className:"border border-gray-300 border-solid",onClick:dt,children:jsxRuntimeExports.jsx(icBaselineIosShare,{className:"size-6"})})},ItemShareLink=({className:He,link:Qe,afterAction:it})=>{const lt=useMatches().at(-1),ut=reactExports.useRef(null);return jsxRuntimeExports.jsx(OutlinedInput,{className:He,value:Qe,readOnly:!0,size:"small",inputProps:{style:{userSelect:"all"}},style:{padding:0},inputRef:ut,endAdornment:jsxRuntimeExports.jsx(InputAdornment,{position:"end",children:jsxRuntimeExports.jsx(IconButton,{onClick:()=>{track("share_copy_click",{scene:lt.handle.name}),copy(formatParamURL(Qe,{utm_source:"copy_web"})),it?.()},children:jsxRuntimeExports.jsx(icBaselineContentCopy,{className:"size-6"})})}),onMouseEnter:()=>{ut.current?.select()},onMouseLeave:()=>{window.getSelection()?.removeAllRanges(),ut.current?.blur()}})},fluentLinkMultiple16Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M1 6.5A3.5 3.5 0 0 1 4.5 3h4a3.5 3.5 0 0 1 3.469 3.031a3.5 3.5 0 0 1-.122 1.499A3.5 3.5 0 0 1 8.5 10h-.75a.75.75 0 0 1 0-1.5h.75a2 2 0 1 0 0-4h-4a2 2 0 0 0-1.262 3.552a4.5 4.5 0 0 0-.235 1.613A3.5 3.5 0 0 1 1 6.5m8 .25a.75.75 0 0 1-.75.75H7.5a2 2 0 1 0 0 4h4a2 2 0 0 0 1.263-3.551a4.5 4.5 0 0 0 .235-1.613A3.5 3.5 0 0 1 11.5 13h-4a3.5 3.5 0 1 1 0-7h.75a.75.75 0 0 1 .75.75"})}),dark="_dark_15lth_6",white="_white_15lth_18",black="_black_15lth_21",selected="_selected_15lth_26",styles$b={"rounded-btn":"_rounded-btn_15lth_1",dark,white,black,selected,"social-btn":"_social-btn_15lth_39"},fixedShareTags$1=["pixai"];function ArtworkSocialShareButtons(He){const{t:Qe}=useTranslation(["artwork"]),{artwork:it,scene:lt}=He,ut=getPublicUrl(it.media),{data:dt}=useUserInfo(),{data:{countRemains:xt}={}}=useMyShareCreditInfo(!dt?.id),[ft,vt]=useLoadingCallback(async Tt=>{if(dt?.id&&!((xt??0)<1))try{const Mt=await executeClaimShareCredit({});track("share_credits_dialog_show",{fromPath:Tt,scene:lt}),await openClaimCreditDialog(Mt.data?.getShareCredit)}catch(Mt){toast.error(Mt.message)}},[dt?.id,xt]),kt=reactExports.useCallback(Tt=>{if(!ft)return track("share_platform_btn_click",{value:Tt,scene:lt}),vt(Tt)},[ft,vt,lt]),St=reactExports.useCallback(Tt=>{const Mt=it.tags?.map(({name:At})=>At).slice(0,5)??[],Nt=sharePlatformMap[Tt].shareUrl;return{href:Nt({link:formatParamURL(getArtworkShareLink(it.id),{utm_medium:"referral",utm_source:Tt,utm_content:"share"}),image:ut,text:Qe("artwork:social-share-text",{authorName:`${getUserDisplayName(it.author)||"anonymous"}`}),tags:[...fixedShareTags$1,...Mt]}),target:"_blank",rel:"noopener noreferrer",onClick:()=>kt(Tt)}},[it,ut,kt]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Object.entries(sharePlatformMap).map(([Tt,Mt])=>jsxRuntimeExports.jsx("a",{className:cx("inline-grid place-items-center size-12 text-white rounded-full"),style:{backgroundColor:Mt.color},...St(Tt),children:reactExports.cloneElement(Mt.icon,{className:"size-8"})},Tt)),jsxRuntimeExports.jsx("button",{className:styles$b["rounded-btn"],onClick:Tt=>{track("copy_link_click",{scene:lt,location:"share"}),copy(formatParamURL(getArtworkShareLink(it.id),{utm_source:"copy_web"}))},disabled:ft,children:jsxRuntimeExports.jsx(fluentLinkMultiple16Filled,{className:"text-2xl"})})]})}function openClaimCreditDialog(He){return new Promise(async(Qe,it)=>{const lt=await dialog({children:jsxRuntimeExports.jsx(ClaimCreditDialogContent,{onClose:()=>{lt.current?.close(),Qe()},result:He}),onClose:()=>{Qe()},maxWidth:"xs"})})}function ClaimCreditDialogContent(He){const{t:Qe}=useTranslation(["growth","action"]);return jsxRuntimeExports.jsxs("div",{className:"p-8 flex flex-col justify-center items-center",children:[jsxRuntimeExports.jsx("p",{className:"text-xl text-center mb-6",children:Qe("growth:watermark-share.claim-credit-dialog.title")}),jsxRuntimeExports.jsxs("p",{className:"text-xl text-center mb-6",children:[jsxRuntimeExports.jsxs("span",{className:"font-bold text-theme-primary inline-flex items-center leading-none mr-2 translate-y-1",children:[jsxRuntimeExports.jsx(gameIconsCrystalBars,{width:28}),Qe("growth:watermark-share.claim-credit-dialog.claim-amount",{amount:He.result?.amountEach})]}),Qe("growth:watermark-share.claim-credit-dialog.claim-description")]}),jsxRuntimeExports.jsx("p",{className:"text-center text-theme-primary font-medium mb-5",children:Qe("growth:watermark-share.claim-credit-dialog.remain-description",{count:He.result?.countRemains??0})}),jsxRuntimeExports.jsx(Button,{variant:"contained",className:"text-white bg-theme-primary px-12 py-2 !font-bold rounded-full text-sm",onClick:()=>{He.onClose()},children:Qe("action:ok")})]})}function ArtworkShareActions(He){const{artwork:Qe}=He;return Qe.media?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ArtworkSocialShareButtons,{artwork:Qe,scene:He.opts?.trackingArgs?.scene}),jsxRuntimeExports.jsx(DownloadButton,{artwork:Qe,trackingArgs:He.opts?.trackingArgs})]}):null}function DownloadButton(He){const{t:Qe}=useTranslation(["artwork","action"]),{artwork:it,trackingArgs:lt}=He,ut=isAnimatedArtwork(it),[dt,xt]=useLoadingCallback(async()=>{track("share_image_dl_click",lt);const ft=getImageDownloadFileExt({artwork:it,media:it.media}),vt=`${getImageDownloadFilename({artwork:it})}.${ft}`,kt=getMediaUrl(it.videoMediaId,"orig")||getPublicUrl(it.media);if(kt)try{await downloadFile(kt,vt,{skipConversion:ut}),track("share_image_dl_dialog_show",lt),openArtworkShareActionSuccessDialog(Qe,{type:"download"})}catch(St){toast.error(Qe("artwork:share.watermark-dialog.notice.failed-to-download")+": ",St.message)}},[it]);return jsxRuntimeExports.jsx("button",{disabled:dt,className:styles$b["rounded-btn"],onClick:xt,children:dt?jsxRuntimeExports.jsx(CircularProgress,{className:"text-primary",size:20}):jsxRuntimeExports.jsx(materialSymbolsDownload,{fontSize:20})})}const openShareArtworkDialog=(He,Qe)=>new Promise((it,lt)=>{const ut=dialog({children:jsxRuntimeExports.jsx(ArtworkShareDialogContent,{onClose:()=>{ut.current?.close(),it(null)},artwork:He,opts:Qe}),onClose:()=>{it(null)},fullWidth:!1,responsive:!0,dialogProps:{maxWidth:"sm"}})});function ArtworkSharePopover(He){return jsxRuntimeExports.jsxs($07b14b47974efb58$export$5b6b19405a83ff9d,{isOpen:He.open,onOpenChange:He.onOpenChange,triggerRef:He.triggerRef,placement:"top",containerPadding:16,className:cx("text-sm bg-white dark:bg-zinc-700 border border-black/20 dark:border-white/20 rounded-[10px]",He.className),style:He.style,children:[jsxRuntimeExports.jsx($44f671af83e7d9e0$export$746d02f47f4d381,{className:"group",children:jsxRuntimeExports.jsx("svg",{width:12,height:6,viewBox:"0 0 12 6",className:"stroke-black/20 dark:stroke-white/20 fill-white dark:fill-zinc-700 group-data-[placement=bottom]:rotate-180",children:jsxRuntimeExports.jsx("path",{d:"M0 0 L6 6 L12 0"})})}),jsxRuntimeExports.jsx($de32f1b87079253c$export$3ddf2d174ce01153,{children:jsxRuntimeExports.jsx(ArtworkShareDialogContent,{artwork:He.artwork,opts:{trackingArgs:He.trackingArgs}})})]})}function ArtworkShareDialogContent(He){const{t:Qe}=useTranslation(["artwork"]),{data:it}=useUserInfo(),lt=He.artwork.media,ut=it&&it?.id===He.artwork.author?.id;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DialogTitle,{className:"mx-auto text-center font-bold text-xl sm:text-2xl pt-7 pb-1 truncate",children:Qe(ut?"artwork:share.watermark-dialog.title-for-self":"artwork:share.watermark-dialog.title-for-others")}),jsxRuntimeExports.jsx("div",{className:"w-full flex justify-center items-center",children:jsxRuntimeExports.jsxs("div",{className:"py-4 px-3 max-w-[520px] bg-[#7f3fd9]/10 text-theme-primary flex items-center rounded-xl gap-4 sm:mx-4",children:[jsxRuntimeExports.jsx(gameIconsCrystalBars,{className:"text-xl sm:text-3xl shrink-0"}),jsxRuntimeExports.jsx(RemaningCreditCount,{})]})}),jsxRuntimeExports.jsx("div",{className:"mt-1 mb-3 flex justify-center items-center gap-2 overflow-x-auto py-4 *:flex-none shrink-0",children:jsxRuntimeExports.jsx(ArtworkShareActions,{...He,isSelfArtwork:!!ut})}),He.opts?.displayMedia&&lt&&jsxRuntimeExports.jsx("div",{className:"pb-4 px-4 w-full flex shrink",children:jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:He.artwork.mediaId,className:"mx-auto max-mmd:max-w-full max-w-[480px]"})})]})}function RemaningCreditCount(){const{t:He}=useTranslation(["growth"]),{data:Qe}=useUserInfo(),{data:{amountEach:it=100,countRemains:lt=3}={}}=useMyShareCreditInfo(!Qe?.id);return jsxRuntimeExports.jsxs("p",{className:"shrink min-w-0 text-xs sm:text-sm",children:[He("growth:watermark-share.share-to-credit.amount-description",{amountEach:it})," ",Qe?.id?He("growth:watermark-share.share-to-credit.remain-description",{count:lt}):He("growth:watermark-share.share-to-credit.login-to-claim-description")]})}function openArtworkShareActionSuccessDialog(He,Qe){return new Promise(async(it,lt)=>{const ut=await dialog({children:jsxRuntimeExports.jsxs("div",{className:"py-4 px-8 flex flex-col justify-center items-center",children:[jsxRuntimeExports.jsx("p",{className:"text-xl text-center",children:Qe.type==="download"?He("artwork:share.watermark-dialog.download-modal.title"):He("artwork:share.watermark-dialog.copy-modal.title")}),jsxRuntimeExports.jsx(Button,{variant:"contained",className:"text-white bg-theme-primary mt-8 px-12 !font-bold",onClick:()=>{ut.current?.close(),it()},children:He("action:ok")})]}),maxWidth:"xs"})})}const majesticonsBan=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("g",{fill:"none",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 12a8 8 0 1 1 16 0a8 8 0 0 1-16 0zm8-10C6.477 2 2 6.477 2 12s4.477 10 10 10s10-4.477 10-10S17.523 2 12 2zm6 10c0 1.296-.41 2.496-1.11 3.476L8.524 7.11A6 6 0 0 1 18 12zM6 12c0-1.296.41-2.496 1.11-3.477l8.366 8.368A6 6 0 0 1 6 12z",fill:"currentColor"})})}),majesticonsExclamation=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("g",{fill:"none",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.378 4.661c1.143-2.057 4.101-2.057 5.245 0l6.6 11.882c1.111 2-.335 4.457-2.622 4.457H5.399c-2.287 0-3.733-2.457-2.622-4.457l6.6-11.882zM12 8a1 1 0 0 1 1 1v4a1 1 0 1 1-2 0V9a1 1 0 0 1 1-1zm1 9a1 1 0 1 1-2 0a1 1 0 0 1 2 0z",fill:"currentColor"})})}),majesticonsQuestionMarkCircle=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("g",{fill:"none",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12zm10-5a2 2 0 0 0-2 2a1 1 0 0 1-2 0a4 4 0 1 1 5.31 3.78a.674.674 0 0 0-.273.169a.177.177 0 0 0-.037.054v.497a1 1 0 1 1-2 0V13c0-1.152.924-1.856 1.655-2.11A2.001 2.001 0 0 0 12 7zm1 6.007v-.004v.004zM13 17a1 1 0 1 1-2 0a1 1 0 0 1 2 0z",fill:"currentColor"})})});function getIcon(He){return $$3(He).returnType().with("model-cover-under-review",()=>majesticonsExclamation).with("model-cover-warned",()=>majesticonsBan).otherwise(()=>majesticonsQuestionMarkCircle)}function MediaContentRemoved(He){const{type:Qe,overlayType:it}=He,{t:lt}=useTranslation(["common"]),ut=getIcon(it);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[ut({className:cx("text-neutral-300 dark:text-neutral-100/20",Qe==="standalone"&&"text-3xl sm:text-8xl",Qe==="in-grid"&&"text-6xl")}),jsxRuntimeExports.jsx("p",{className:cx("text-center font-light text-neutral-400 dark:text-neutral-100/20 mt-1 whitespace-pre",Qe==="standalone"&&"text-xl sm:text-3xl",Qe==="in-grid"&&"text-lg"),children:lt(`common:content-removed.${it}.title`)}),jsxRuntimeExports.jsx(MarkdownRenderer,{className:"prose text-xs font-normal text-neutral-400 dark:text-neutral-100/20 px-2",children:lt(`common:content-removed.${it}.content`)})]})}function MediaContentRemovedIcon(He){const{className:Qe,...it}=He;return jsxRuntimeExports.jsx(majesticonsBan,{className:cx("text-neutral-700 dark:text-neutral-300",Qe),...it})}function ArtworkWarnedOverlay(He){const{t:Qe}=useTranslation(["common"]);return He.placement==="in-grid"?jsxRuntimeExports.jsx(MarkdownRenderer,{className:cx("prose text-xs *:text-white",He.className),children:Qe("common:content-removed.artwork-warned.preview-content")}):jsxRuntimeExports.jsx(MarkdownRenderer,{className:cx("prose text-xs sm:text-base *:text-white",He.className),children:Qe("common:content-removed.artwork-warned.detail-content")})}const BaseArtworkItemPreviewCardContext=reactExports.createContext(null),BaseArtworkItemPreviewCard=He=>{const{mediaId:Qe,mediaFallback:it,mediaExtra:lt,label:ut,secondLabel:dt,time:xt,showInfo:ft=!0,artwork:vt,animated:kt,overrideAuthor:St,className:Tt,contentClassName:Mt,borderClassName:Nt,showLikeBtn:At,showAuthorAvatar:$t,loading:Dt,to:Ft,lastElementRef:Bt,wrapperRef:Ot,selected:Qt=!1,isEdit:Wt=!1,likeBtn:Xt,trackingArgs:Kt,border:Jt,contentExtra:hr,fit:xr="cover",mediaContentRemovedOverlayType:gr,nsfwBlur:br,showExplicitIcon:vr,menu:yr,hideShare:Cr,modelTitle:Rr,...Ir}=He,Tr=kt||isAnimatedArtwork(vt),[$r,Zr]=reactExports.useState(!0),Sr=qr=>{Tr&&Zr(qr)},Dr=At&&(Xt??(vt&&jsxRuntimeExports.jsx(ArtworkLikeButton,{trackingArgs:Kt,artworkId:vt.id,initialCount:vt.likedCount,initialValue:vt.liked,numOnTop:!0,hideValueOnZero:!0}))),wr=gr!=null?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex flex-col items-center justify-center p-2",children:jsxRuntimeExports.jsx(MediaContentRemoved,{type:"in-grid",overlayType:gr})}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Qe?jsxRuntimeExports.jsx(MediaPreview$1,{className:cx("w-full h-full",br&&"blur-xl"),blurHash:vt?.extra?.imageBlurHash,mediaId:Qe??vt?.mediaId,videoMediaId:vt?.videoMediaId,thumbnail:!0,fit:xr,preferStill:$r,alt:getArtworkAlt(vt,Rr)}):it,jsxRuntimeExports.jsx(PreviewMask,{nsfwBlur:br,showExplicitIcon:vr})]});return jsxRuntimeExports.jsx(BaseArtworkItemPreviewCardContext.Provider,{value:He,children:jsxRuntimeExports.jsxs("div",{className:cx("group group/card","relative isolate",Jt&&"p-0.5"),children:[Jt==="member"?jsxRuntimeExports.jsx("div",{className:cx("z-[-1] absolute inset-0 rounded-lg bg-gradient-member","mmd:-inset-0.5 mmd:rounded-[0.625rem]","transition ease-out duration-300 group-hover:shadow-xl",Nt)}):Jt==="plain"?jsxRuntimeExports.jsx("div",{className:cx("z-[-1] absolute inset-px rounded-lg","bg-black/10 group-hover:bg-black/30","transition ease-out duration-300 group-hover:shadow-xl",Nt)}):jsxRuntimeExports.jsx("div",{className:cx("z-[-1] absolute inset-0 rounded-lg","transition ease-out duration-300 group-hover:shadow-2xl",Nt)}),jsxRuntimeExports.jsxs(ButtonBase,{ref:Ot,component:Ft!=null?Link:"div",className:cx("group block bg-background-secondary transition cursor-pointer",Jt==="member"?"rounded-md":"rounded-lg",Mt),to:Ft,...Ir,onMouseEnter:()=>Sr(!1),onMouseLeave:()=>Sr(!0),children:[jsxRuntimeExports.jsxs("div",{ref:Bt,className:cx("relative w-full aspect-square bg-active overflow-hidden transition duration-300 group-focus-within:outline",Wt&&Qt&&"border-black border-[5px] rounded-[16px]",ft?Jt==="member"?"rounded-t-md":"rounded-t-lg":Jt==="member"?"rounded-md":"rounded-lg",Tt),children:[jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[wr,lt]}),Wt&&jsxRuntimeExports.jsx("div",{className:"w-full absolute top-0 p-3",children:jsxRuntimeExports.jsx(icBaselineDone,{className:cx(Qt?"text-opacity-100":"text-opacity-0","w-7 h-7 border-2 border-black bg-white rounded-xl float-right text-black")})}),Dr?jsxRuntimeExports.jsxs("div",{className:cx("w-full absolute bottom-0 flex p-3 items-end text-white drop-shadow",ft&&"md:hidden"),style:{background:"linear-gradient(to top, #0003, #0000)"},children:[jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx("div",{className:"block translate-y-1",children:Dr})]}):null,!Wt&&jsxRuntimeExports.jsx(MenuButton$1,{})]}),ft&&jsxRuntimeExports.jsxs("div",{className:"relative flex items-center gap-1.5 w-full h-14 pl-2 pb-0.5",children:[$t&&jsxRuntimeExports.jsx(UserAvatar,{className:"flex-none",user:vt?.author??St,style:{width:"2rem",height:"2rem",flexShrink:0}}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-stretch gap-0.5 min-w-0 px-1 py-1.5",children:[jsxRuntimeExports.jsx("div",{className:cx("text-left min-h-[1rem] text-sm font-semibold truncate",Dt&&"bg-active animate-pulse"),children:ut}),jsxRuntimeExports.jsx("div",{className:cx("text-left w-auto min-h-[1rem] text-xs text-primary-light truncate",Dt&&"bg-active animate-pulse"),children:dt||(xt?defaultDayjs(xt).format("lll"):"")})]}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx("div",{className:"flex-shrink-0 mr-4 hidden md:block",children:Dr})]}),hr]})]})})};function MenuButton$1(){const{artwork:He,trackingArgs:Qe,menu:it,hideShare:lt}=reactExports.useContext(BaseArtworkItemPreviewCardContext),ut=UIMenu.compact([He&&!He.isPrivate&&!lt&&{id:"share",icon:jsxRuntimeExports.jsx(fluentShare20Regular,{className:"size-5"}),children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:share.label"}),onAction:()=>{track("share_my_work_click",Qe),openShareArtworkDialog(He,Qe)}},it&&UIMenuSeparatorSymbol,...it??[]]);return ut.length===0?null:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs(UIMenuTrigger,{children:[jsxRuntimeExports.jsx($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{className:cx("absolute top-1 right-1 inline-grid place-items-center size-7 rounded-md ring-1 ring-white/20 transition duration-100","text-white/50 bg-black/50 [@media(hover:hover)]:opacity-0","group-hover/card:opacity-100","hover:text-white data-[pressed]:text-white hover:bg-black/80 data-[pressed]:bg-black/80 data-[pressed]:opacity-100"),children:jsxRuntimeExports.jsx(fluentMoreVertical20Filled,{className:"size-5"})}),jsxRuntimeExports.jsx(UIMenu,{items:ut,placement:"bottom right",children:dt=>jsxRuntimeExports.jsx(UIMenuItem,{...dt})})]})})}function PreviewMask(He){return He.nsfwBlur?jsxRuntimeExports.jsx(NsfwMask,{showExplicitIcon:He.showExplicitIcon}):null}function NsfwMask(He){return jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black text-white bg-opacity-40 group-hover:bg-opacity-20 transition",children:He.showExplicitIcon&&jsxRuntimeExports.jsx(icRoundExplicit,{className:"opacity-50 group-hover:opacity-80 transition-opacity text-3xl"})})}function useArtworkLinkExperiment(){return useExperimentParam("exp2508-artwork-use-link")==="treatment"}const ArtworkPreviewCardSimple=reactExports.memo(({artwork:He,showAuthor:Qe,loading:it,showLikeBtn:lt=!0,trackingArgs:ut,showIndex:dt,index:xt,onArtworkClick:ft,onLikeClickForRec:vt,showDislike:kt,contentSafetyLabelType:St,oauthReturnOpensDetail:Tt,...Mt})=>{const[{sort:Nt="trending"}]=useQs(),At=useArtworkGridCols(),{me:$t}=useMe(),{title:Dt,prompts:Ft,createdAt:Bt}=He||{},Ot=Dt||Ft,[Qt]=useBlurNsfw(),Wt=getUserDisplayName(He?.author),Xt=userHasMembership(He?.author),Kt=useArtworkLinkExperiment(),Jt=shouldArtworkBeBlurred(He)&&Qt;return jsxRuntimeExports.jsx(BaseArtworkItemPreviewCard,{mediaId:He?.mediaId||He?.manga?.coverMediaId||He?.manga?.chapter?.coverMediaId,nsfwBlur:Jt,showExplicitIcon:Jt,label:jsxRuntimeExports.jsx("span",{title:Ot,children:Ot}),secondLabel:Qe&&Wt,time:Bt,artwork:He,showLikeBtn:lt,loading:it,trackingArgs:ut,mediaExtra:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[He&&jsxRuntimeExports.jsx(CardCornerOverlay,{corner:"top-left",className:"bg-transparent shadow-none backdrop-filter-none",children:jsxRuntimeExports.jsx(ArtworkTypeLabel,{artwork:He,className:"absolute top-1 left-1 ring-1 ring-black/20"})}),$$3(He).with({isPrivate:!0},()=>jsxRuntimeExports.jsx(CardCornerOverlay,{corner:"bottom-left",className:"bg-transparent shadow-none backdrop-filter-none",children:jsxRuntimeExports.jsx(ArtworkPrivateLabel,{})})).with({commentCount:N$4.number.gt(0)},({commentCount:hr})=>jsxRuntimeExports.jsx(CardCornerOverlay,{corner:"bottom-left",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(icOutlineSms,{className:"text-white/70 text-xl"}),jsxRuntimeExports.jsx("span",{className:"text-white/90",children:hr})]})})).otherwise(()=>null),St&&jsxRuntimeExports.jsx(ContentSafetyLabel,{type:St}),jsxRuntimeExports.jsx(CardCornerDebugInfo,{extra:He?.extra,feedMetadata:He?.feedMetadata,paidCredit:He?.paidCredit,aesScore:He?.aesScore,children:hr=>jsxRuntimeExports.jsx(CardCornerOverlay,{corner:"top-right",children:hr})})]}),likeBtn:He&&jsxRuntimeExports.jsx(ArtworkLikeButton,{artwork:He,artworkId:He.id,initialCount:He.likedCount,initialValue:He.liked,afterClick:vt,oauthReturnOpensDetail:Tt,hideValueOnZero:!0,trackingArgs:ut}),showAuthorAvatar:!0,contentClassName:"group",border:Xt?"member":"plain",contentExtra:dt&&xt!=null?jsxRuntimeExports.jsx("p",{className:"absolute top-2 right-2 flex items-center justify-center text-white font-black font-quicksand text-xl rounded py-1 bg-opacity-80 shadow-sm bg-purple-700 tabular-nums w-10 pointer-events-none",children:xt+1}):void 0,...Mt,menu:[kt&&{id:"dislike",icon:jsxRuntimeExports.jsx(fluentThumbDislike20Regular,{className:"size-5"}),children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:dislike.label"}),onAction:()=>{trackImageForRec("dislike_click",{feed:Nt,totalCols:At,scene:"artwork_feed",likeFrom:"grid",artworkId:He?.id??"",index:xt??0,currentLikeCount:He?.likedCount??0,type:RefType.Artwork,retrieverId:He?.feedMetadata?.retrieverId}),toast.success(jsxRuntimeExports.jsx(Text,{i18nKey:"action:dislike.success"}))}},UIMenuSeparatorSymbol,...Mt.menu??[]],onClick:(...hr)=>{if(He?.type===ArtworkType.AnimatedComic&&(track("animated_comic_click"),hr[0].preventDefault(),He.manga))return window.open(getArtworkLink(He),"_blank");Kt&&!$t||(Mt.onClick?.(...hr),ft?.(He))}})});ArtworkPreviewCardSimple.displayName="ArtworkPreviewCardSimple";function ContentSafetyLabel(He){const{t:Qe}=useTranslation(["artwork"]),{type:it}=He;return jsxRuntimeExports.jsx("div",{className:"absolute py-1 px-2 text-xs z-10 backdrop-blur backdrop-brightness-50 shadow-lg bottom-9 left-0 rounded-r-md md:rounded-tl-lg md:rounded-r-none md:py-2 md:right-0 md:left-[unset] md:bottom-0 md:text-base",children:jsxRuntimeExports.jsx("p",{className:cx(it==="sensitive"?"text-rose-400 font-bold":"text-orange-200 font-medium"),children:Qe(it==="sensitive"?"artwork:content-safety.sensitive.label":"artwork:content-safety.flagged.label")})})}function ArtworkTrackedPreviewCard(He){const Qe=useArtworkGridCols(),[{sort:it="trending"}]=useQs(),{index:lt,id:ut,artwork:dt,onArtworkClick:xt,...ft}=He,{ref:vt,entry:kt}=useIntersection({rootMargin:"0px",threshold:1});reactExports.useEffect(()=>{kt?.isIntersecting&&trackImageForRec("reco_artwork_view",{artworkId:ut,index:lt,currentLikeCount:dt?.likedCount??0,scene:"artwork_feed",feed:it,totalCols:Qe,hidePrompts:dt?.hidePrompts??!1,retrieverId:dt?.feedMetadata?.retrieverId},{amplitudeSampleRate:RECO_EVENTS_AMPLITUDE_SAMPLE_RATE})},[ut,lt,dt?.likedCount,dt?.feedMetadata?.retrieverId,kt?.isIntersecting,Qe,it]);const St=reactExports.useCallback(Mt=>{trackImageForRec("reco_artwork_click",{artworkId:ut,index:lt,currentLikeCount:Mt?.likedCount??0,scene:"artwork_feed",feed:it,totalCols:Qe,hidePrompts:Mt?.hidePrompts??!1,retrieverId:Mt?.feedMetadata?.retrieverId},{amplitudeSampleRate:RECO_EVENTS_AMPLITUDE_SAMPLE_RATE}),xt?.(Mt,lt)},[ut,lt,it,Qe,xt]),Tt=reactExports.useCallback(()=>{trackImageForRec("like_click",{artworkId:ut,index:lt,currentLikeCount:dt?.likedCount??0,scene:"artwork_feed",feed:it,totalCols:Qe,type:RefType.Artwork,likeFrom:"grid",hidePrompts:dt?.hidePrompts??!1,retrieverId:dt?.feedMetadata?.retrieverId})},[ut,lt,dt?.likedCount,dt?.feedMetadata?.retrieverId,it,Qe]);return jsxRuntimeExports.jsx(ArtworkPreviewCardSimple,{...ft,artwork:dt,onArtworkClick:St,onLikeClickForRec:Tt,wrapperRef:vt})}modifyQueryHook(createQueryHook(GetMangaDocument),{transform:He=>({id:He}),reduce:He=>He?.manga});const useGetMangaChapter=modifyQueryHook(createQueryHook(GetMangaChapterDocument),{transform:({mangaId:He,chapterId:Qe,index:it}={})=>He&&(Qe||it!=null)?{mangaId:He,chapterId:Qe,index:it}:skipToken,reduce:He=>He?.manga?.chapter});modifyQueryHook(createQueryHook(ListUserLikedMangaListDocument),{reduce:He=>He?.user?.likedMangaList});const[useDeleteManga,executeDeleteManga]=createMutationHelper(DeleteMangaDocument),[useMarkManga,executeMarkManga]=createMutationHelper(MarkMangaDocument),icBaselineFlag=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"})}),icBaselineSend=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M2.01 21L23 12L2.01 3L2 10l15 2l-15 2z"})}),AppealDialog=({refId:He,refType:Qe,description:it,onComplete:lt})=>{const{t:ut}=useTranslation(["common","action"]),[dt,xt]=reactExports.useState(!1),ft=async()=>{xt(!0);try{if(Qe!==RefType.Artwork&&Qe!==RefType.Model){toast.error("Wrong appeal type");return}await client.report({refType:Qe,refId:He,reason:Qe===RefType.Artwork?ReportReason.MislabeledArchivedArtwork:ReportReason.MislabeledNsfw}),toast.success(ut(`common:appeal.${Qe.toLowerCase()}.success`)),lt?.()}catch(vt){const kt=vt;toast.error(kt.message)}finally{xt(!1)}};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-2",children:[jsxRuntimeExports.jsx(icBaselineFlag,{className:"size-5",color:"inherit"}),jsxRuntimeExports.jsx("span",{children:ut(`common:appeal.${Qe.toLowerCase()}.title`)})]})}),jsxRuntimeExports.jsx(UIDialogContent,{children:jsxRuntimeExports.jsx("p",{className:"whitespace-pre-line",children:it||ut(`common:appeal.${Qe.toLowerCase()}.description`)})}),jsxRuntimeExports.jsx(UIDialogFooter,{children:jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",color:"admin",onPress:ft,busy:dt,icon:jsxRuntimeExports.jsx(icBaselineSend,{className:"mx-2 size-5"}),children:jsxRuntimeExports.jsx("span",{children:ut("action:submit")})})})]})},dialogAppeal=async(He,Qe,it)=>(track("appeal_click",{refType:He,refId:Qe}),UIDialog.create({dismissable:!0,children:({close:lt})=>jsxRuntimeExports.jsx(AppealDialog,{refType:He,refId:Qe,description:it?.description,onComplete:()=>{lt()}})}));function AppealButtonInDetail(He){const{t:Qe}=useTranslation(["common"]);return jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",className:He.className,color:"danger",onPress:()=>dialogAppeal(He.refType,He.refId,{description:He.description}),children:Qe("common:appeal.action-label")})}const useGetMedia=modifyQueryHook(createQueryHook(GetMediaDocument,{fetchPolicy:"cache-first",context:{refetchOnFocus:!1,refetchOnReconnect:!1}}),{transform:He=>({id:He}),reduce:He=>He?.media}),fetchGetMedia=createFetchQueryHelper(GetMediaDocument),updateGetMedia=(He,Qe)=>{baseApolloClient.refetchQueries({updateCache(it){it.updateQuery({query:GetMediaDocument,variables:{id:He}},()=>({media:Qe}))}})},[useUploadMedia,executeUploadMedia]=createMutationHelper(UploadMediaDocument),MangaLikeButton=({manga:He,id:Qe=He?.id,initialCount:it=He?.likedCount,initialValue:lt=He?.liked,className:ut,style:dt,afterClick:xt})=>Qe?jsxRuntimeExports.jsx(BaseLikeButton,{id:Qe,initialCount:it,initialValue:lt,onSuccess:ft=>{ft&&(track("like_click",{id:He?.artworkId,type:isAnimatedComic(He)?MangaType.AnimatedComic:RefType.Manga},{destinations:["amplitude"]}),xt?.())},handler:async(ft,vt)=>{await executeMarkManga({mangaId:ft,type:MarkType.Like,target:vt})},render:({value:ft,count:vt,onClick:kt})=>jsxRuntimeExports.jsx(ButtonBase,{component:"div",role:"button",className:cx("cursor-pointer outline transition -m-2 p-2 rounded-md focus-within:outline-1",ut),style:dt,onClick:kt,children:jsxRuntimeExports.jsxs("div",{className:"flex gap-1 items-center",children:[jsxRuntimeExports.jsx(LikeHeart,{liked:ft,className:"size-5"}),vt?jsxRuntimeExports.jsx("span",{className:"text-sm tabular-nums",style:{color:"inherit"},children:formatNum(vt||0)}):null]})})}):null,_MangaBlock=({mediaId:He,onLoad:Qe})=>{const{data:it}=useGetMedia(He),lt=getPublicUrl(it);return jsxRuntimeExports.jsx("img",{className:"w-full select-none pointer-events-none bg-black",src:lt,crossOrigin:"anonymous",loading:"lazy",decoding:"async",onLoad:Qe})},MangaBlock=reactExports.memo(_MangaBlock),_MangaViewer=({manga:He,chapter:Qe,artwork:it})=>{const{content:lt}=Qe,[ut,dt]=reactExports.useState(!0),xt=Array.isArray(lt?.mediaIds)?lt.mediaIds:[];return jsxRuntimeExports.jsxs("div",{className:"text-white",children:[jsxRuntimeExports.jsxs("div",{className:"w-full text-primary bg-background min-h-[80px] flex flex-col justify-center items-center text-2xl font-bold p-4",children:[jsxRuntimeExports.jsx("span",{className:"whitespace-normal w-full break-word mb-2 text-center",children:Qe.title}),He&&jsxRuntimeExports.jsx(MangaLikeButton,{manga:He})]}),jsxRuntimeExports.jsx("div",{className:"mb-8 h-[1px] w-full bg-gray-300"}),jsxRuntimeExports.jsxs("div",{className:cx("flex flex-col w-full relative",{"min-h-[--visible-height]":ut}),children:[ut&&jsxRuntimeExports.jsx("div",{className:"absolute w-full",children:jsxRuntimeExports.jsx(LoadingPage,{})}),xt.map(ft=>jsxRuntimeExports.jsx(MangaBlock,{mediaId:ft,onLoad:()=>dt(!1)},ft)),He?.artworkId&&jsxRuntimeExports.jsx(MangaArtworkOverlay,{artworkId:He?.artworkId,artwork:it})]})]})};function MangaArtworkOverlay(He){const Qe=isUserContentSensitive(He.artwork),it=isArtworkAppealable(He.artwork);return Qe?jsxRuntimeExports.jsxs("div",{className:cx("absolute w-full h-full bg-black/30 backdrop-blur-sm flex flex-col justify-center items-center"),children:[jsxRuntimeExports.jsx(ArtworkWarnedOverlay,{className:"px-4",placement:"in-detail"}),it&&jsxRuntimeExports.jsx(AppealButtonInDetail,{className:"mt-4",refType:RefType.Artwork,refId:He.artworkId})]}):null}const MangaViewer=reactExports.memo(_MangaViewer),MangaViewerFooter=({manga:He})=>{const{t:Qe}=useTranslation(["manga"]);return jsxRuntimeExports.jsxs("div",{className:"bg-background w-full min-h-[300px] flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx(MangaLikeButton,{manga:He}),jsxRuntimeExports.jsx("div",{className:"opacity-40 text-lg pt-4",children:Qe("manga:interesting")})]})},icBaselineHome=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10 20v-6h4v6h5v-8h3L12 3L2 12h3v8z"})}),CircularSpinner=()=>jsxRuntimeExports.jsx("div",{className:"w-full flex justify-center items-center h-20",children:jsxRuntimeExports.jsx(CircularProgress,{})}),icRoundCheck=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41L9 16.17z"})}),getClassNameForSafetyScore=He=>$$3(He).with(N$4.nullish,()=>"").when(Qe=>Qe<2,()=>"text-red-600 dark:text-red-500").when(Qe=>Qe<4,()=>"text-orange-600 dark:text-orange-500").when(Qe=>Qe<6,()=>"text-amber-600 dark:text-amber-500").when(Qe=>Qe<8,()=>"text-yellow-600 dark:text-yellow-500").otherwise(()=>"text-lime-600 dark:text-lime-500");function SafetyScoreDisplay(He){return jsxRuntimeExports.jsx("div",{className:getClassNameForSafetyScore(He.score),children:He.score===void 0?"?":He.score})}const safetyScoreOptions=[{score:1,label:"1(cp)",className:"bg-red-500 hover:bg-red-400"},{score:3,label:"3(nsfw)",className:"bg-orange-500 hover:bg-orange-400"},{score:6,label:"6(sexy)",className:"bg-yellow-500 hover:bg-yellow-400"},{score:8,label:"8(safe)",className:"bg-lime-500 hover:bg-lime-400"}];function SafetyScoreEditor(He){return jsxRuntimeExports.jsx("div",{className:"flex gap-1",children:safetyScoreOptions.map(({score:Qe,label:it,className:lt})=>jsxRuntimeExports.jsx(UIButton$1,{size:"small",variant:"filled",className:lt,onPress:()=>{He.setScore?.(Qe)},children:it}))})}const ModerationEditDialog=({refIds:He,refType:Qe,onComplete:it,onRefresh:lt,values:ut,textSafetyScore:dt,mediaSafetyScore:xt})=>{const[ft,vt]=reactExports.useState({...defaultFlags$1,...ut}),[kt,St]=reactExports.useState({textSafetyScore:dt,mediaSafetyScore:xt}),[Tt,Mt]=useAsyncFn(async()=>{if(Qe!==RefType.Artwork&&Qe!==RefType.Model)return toast.error(`Unexpected moderation type ${Qe}`);const Ot=Qt=>client.opRefreshTextSafetyScore({input:Qe===RefType.Artwork?{artworkId:Qt}:{modelId:Qt}});try{for(const Qt of He){const Xt=(await Ot(Qt)).opRefreshTextSafetyScore?.textSafetyScore;Xt?(St(Kt=>({...Kt,textSafetyScore:Xt})),toast.success(`Text safety score refreshed for: [${Qt}], now is ${Xt}`),lt?.()):toast.error(`Failed to refresh text safety score for: [${Qt}]`)}}catch(Qt){const Wt=Qt;toast.error(Wt.message)}},[He,Qe]),[Nt,At]=useAsyncFn(async()=>{if(Qe!==RefType.Artwork)return toast.error("Media safety score refresh is only available for artworks");const Ot=Qt=>client.opRefreshMediaSafetyScore({input:{artworkId:Qt}});try{for(const Qt of He){const Xt=(await Ot(Qt)).opRefreshMediaSafetyScore?.mediaSafetyScore;Xt?(St(Kt=>({...Kt,mediaSafetyScore:Xt})),toast.success(`Media safety score refreshed for: [${Qt}], now is ${Xt}`),lt?.()):toast.error(`Failed to refresh media safety score for: [${Qt}]`)}}catch(Qt){const Wt=Qt;toast.error(Wt.message)}},[He,Qe]),[$t,Dt]=reactExports.useState(!1),Ft=async()=>{if(Dt(!0),Qe!==RefType.Artwork&&Qe!==RefType.Model)return toast.error(`Unexpected moderation type ${Qe}`);const Ot=Qt=>client.opModerationNSFW({input:{...Qe===RefType.Artwork?{artworkId:Qt}:{modelId:Qt},...pick$1(ft,["isMinors","isRealistic","isSensitive","isSexyPic","isSexyText"]),...kt,resolveReport:!0}});try{for(const Qt of He)if(ft.isMinors)try{await dialogConfirm({title:"You've marked this entity as MINORS",description:"Proceeding this action will DELETE this entity. Confirm?"}),await Ot(Qt),toast.success(`Moderation successfully updated: [${Qt}]`),Qe===RefType.Artwork?await executeDeleteArtwork({id:Qt}):await client.deleteGenerationModel({id:Qt}),toast.success("Entity successfully deleted: [${refId}]")}catch(Wt){if(Wt===UserCancelled)return;toast.error(Wt?.message)}else await Ot(Qt),toast.success(`Moderation successfully updated: [${Qt}]`);it?.()}catch(Qt){const Wt=Qt;toast.error(Wt.message)}finally{Dt(!1)}},Bt=reactExports.useCallback((Ot,Qt)=>vt(produce(Wt=>{Wt[Ot]=Qt})),[]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-2",children:[jsxRuntimeExports.jsx(icBaselineFlag,{className:"w-6",color:"inherit"}),jsxRuntimeExports.jsx("span",{children:Qe===RefType.Artwork?"Adjust Artwork Moderation":"Adjust Model Moderation"})]})}),jsxRuntimeExports.jsx(UIDialogContent,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsx("h2",{className:"text-md",children:"Current Safety Score"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-[60px_36px_80px] grid-rows-2 gap-1 items-center my-2",children:[jsxRuntimeExports.jsx("div",{children:"Media:"}),jsxRuntimeExports.jsx(SafetyScoreDisplay,{score:kt.mediaSafetyScore}),Qe===RefType.Artwork&&jsxRuntimeExports.jsx(UIButton$1,{size:"small",variant:"filled",color:"normal",onPress:()=>{At()},busy:Nt.loading,children:"Refresh"}),jsxRuntimeExports.jsx("div",{children:"Text:"}),jsxRuntimeExports.jsx(SafetyScoreDisplay,{score:kt.textSafetyScore}),jsxRuntimeExports.jsx(UIButton$1,{size:"small",variant:"filled",color:"normal",onPress:()=>{Mt()},busy:Tt.loading,children:"Refresh"})]}),jsxRuntimeExports.jsx("h2",{className:"text-md",children:"Adjust Safety Score"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-[60px_auto] grid-rows-2 gap-1 items-center my-2",children:[jsxRuntimeExports.jsx("div",{children:"Media:"}),jsxRuntimeExports.jsx(SafetyScoreEditor,{setScore:Ot=>St(Qt=>({...Qt,mediaSafetyScore:Ot}))}),jsxRuntimeExports.jsx("div",{children:"Text:"}),jsxRuntimeExports.jsx(SafetyScoreEditor,{setScore:Ot=>St(Qt=>({...Qt,textSafetyScore:Ot}))})]}),jsxRuntimeExports.jsx(Divider,{className:"py-1"}),jsxRuntimeExports.jsx(FormControlLabel,{checked:ft.isSensitive,control:jsxRuntimeExports.jsx(Checkbox,{color:"error",onChange:Ot=>Bt("isSensitive",Ot.target.checked)}),label:jsxRuntimeExports.jsx("div",{className:"rounded-md bg-red-700 text-white px-2",children:"Sensitive"})}),jsxRuntimeExports.jsx(FormControlLabel,{checked:ft.isMinors,control:jsxRuntimeExports.jsx(Checkbox,{color:"error",onChange:Ot=>Bt("isMinors",Ot.target.checked)}),label:jsxRuntimeExports.jsx("div",{className:"rounded-md bg-red-700 text-white px-2",children:"Minors"})}),jsxRuntimeExports.jsx(FormControlLabel,{checked:ft.isRealistic,control:jsxRuntimeExports.jsx(Checkbox,{color:"warning",onChange:Ot=>Bt("isRealistic",Ot.target.checked)}),label:jsxRuntimeExports.jsx("div",{className:"rounded-md bg-yellow-700 text-white px-2",children:"Realistic"})}),jsxRuntimeExports.jsx(FormControlLabel,{checked:ft.isSexyPic,control:jsxRuntimeExports.jsx(Checkbox,{color:"warning",onChange:Ot=>Bt("isSexyPic",Ot.target.checked)}),disabled:!0,label:jsxRuntimeExports.jsx("div",{className:"rounded-md bg-pink-600 text-white px-2",children:"isSexyPic"})}),jsxRuntimeExports.jsx(FormControlLabel,{checked:ft.isSexyText,control:jsxRuntimeExports.jsx(Checkbox,{color:"warning",onChange:Ot=>Bt("isSexyText",Ot.target.checked)}),disabled:!0,label:jsxRuntimeExports.jsx("div",{className:"rounded-md bg-pink-600 text-white px-2",children:"isSexyText"})})]})}),jsxRuntimeExports.jsx(UIDialogFooter,{children:jsxRuntimeExports.jsx(UIButton$1,{size:"large",variant:"filled",color:"normal",onPress:()=>{Ft()},busy:$t,icon:jsxRuntimeExports.jsx(icRoundCheck,{}),children:jsxRuntimeExports.jsx("span",{children:"Submit"})})})]})},defaultFlags$1={isMinors:!1,isRealistic:!1,isSensitive:!1,isSexyPic:!1,isSexyText:!1};function ModerationEditDialogFetchWrapper(He){const{refType:Qe,refIds:it}=He,{data:lt,isLoading:ut}=useGenerationModel(Qe===RefType.Model?it[0]:void 0),{data:dt,loading:xt}=useGetArtwork(Qe===RefType.Artwork?it[0]:skipToken);if(ut||xt)return jsxRuntimeExports.jsx(CircularSpinner,{});const ft=Qe===RefType.Artwork?dt:lt,vt=He.values??ft?.flag??defaultFlags$1,{textSafetyScore:kt,mediaSafetyScore:St}=ft?.extra??{};return jsxRuntimeExports.jsx(ModerationEditDialog,{...He,values:vt,textSafetyScore:kt,mediaSafetyScore:St})}const dialogModerationEdit=async({refType:He,refIds:Qe,values:it,shouldFetch:lt,mutate:ut})=>UIDialog.create({dismissable:!0,className:"max-w-screen-md",children:({close:dt})=>Qe.length>1?jsxRuntimeExports.jsx(ModerationEditDialog,{refIds:Qe,refType:He,values:it??defaultFlags$1,onRefresh:()=>{ut?.()},onComplete:()=>{ut?.(),dt()}}):jsxRuntimeExports.jsx(ModerationEditDialogFetchWrapper,{values:it,shouldFetch:lt,refType:He,refIds:Qe,onComplete:()=>{ut?.(),dt()}})}),dialogModerationArchiveEdit=async({refType:He,refId:Qe,values:it,shouldFetch:lt,mutate:ut})=>{const dt=await dialog({children:jsxRuntimeExports.jsx(ModerationArchiveDialogFetchWrapper,{values:it,shouldFetch:lt,refType:He,refId:Qe,onComplete:()=>{ut?.(),dt.current?.close()}}),fullWidth:!0,maxWidth:"sm",classes:{paper:"rounded-xl"},TransitionComponent:Grow})};function ModerationArchiveDialogFetchWrapper(He){const{refType:Qe,refId:it}=He,{data:lt,loading:ut}=useGetArtwork(Qe===RefType.Artwork?it:skipToken);if(ut)return jsxRuntimeExports.jsx(CircularSpinner,{});const dt=He.values??lt?.extra.archived??!1;return jsxRuntimeExports.jsx(ModerationArchiveDialog,{...He,values:dt})}const ModerationArchiveDialog=({refId:He,refType:Qe,onComplete:it,values:lt})=>{const[ut,dt]=reactExports.useState(lt),[xt,ft]=reactExports.useState(!1),vt=async()=>{ft(!0);try{if(Qe!==RefType.Artwork)return toast.error("Wrong moderation type");await executeUpsertArtwork({id:He,input:{extra:{archived:ut}}}),toast.success("Archive status successfully updated"),it?.()}catch(kt){const St=kt;toast.error(St.message)}finally{ft(!1)}};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-2",children:[jsxRuntimeExports.jsx(icBaselineFlag,{className:"w-6",color:"inherit"}),jsxRuntimeExports.jsx("span",{children:Qe===RefType.Artwork?"Adjust Artwork Moderations":"Adjust Model Moderations"})]})}),jsxRuntimeExports.jsx(UIDialogContent,{children:jsxRuntimeExports.jsx("div",{className:"flex flex-col mt-8",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx(UISwitch,{checked:ut,onCheckedChange:kt=>{dt(kt)}}),"Archive"]})})}),jsxRuntimeExports.jsx(UIDialogFooter,{children:jsxRuntimeExports.jsx(UIButton$1,{size:"large",variant:"filled",color:"normal",onPress:()=>{vt()},busy:xt,icon:jsxRuntimeExports.jsx(icRoundCheck,{}),children:jsxRuntimeExports.jsx("span",{children:"Submit"})})})]})},DropdownMenu=({anchor:He,children:Qe,...it})=>{const[lt,ut]=reactExports.useState(),dt=reactExports.useMemo(()=>{const xt=ft=>{ut(ft.currentTarget)};return reactExports.isValidElement(He)?reactExports.cloneElement(He,{...He.props,onClick:xt},He.props.children):jsxRuntimeExports.jsx("div",{onClick:xt,children:He})},[He]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[dt,jsxRuntimeExports.jsx(Menu,{anchorEl:lt,open:!!lt,onClose:()=>ut(void 0),...it,children:Qe})]})},JSONView=reactExports.lazy(()=>__vitePreload(()=>import("./index-_8yKFzX7.js"),__vite__mapDeps([27,2,3,4,1,5,6,28]),import.meta.url)),InspectDialog=({data:He})=>{const{themeType:Qe}=useColorModeContext();return jsxRuntimeExports.jsx("div",{className:"p-8 min-h-[calc(100dvh-64px)]",children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(LoadingPage,{}),children:jsxRuntimeExports.jsx(JSONView,{value:He,style:Qe==="dark"?{"--w-rjv-font-family":"monospace","--w-rjv-color":"#79c0ff","--w-rjv-key-string":"#79c0ff","--w-rjv-background-color":"#0d111700","--w-rjv-line-color":"#94949480","--w-rjv-arrow-color":"#ccc","--w-rjv-edit-color":"var(--w-rjv-color)","--w-rjv-info-color":"#7b7b7b","--w-rjv-update-color":"#ebcb8b","--w-rjv-copied-color":"#79c0ff","--w-rjv-copied-success-color":"#28a745","--w-rjv-curlybraces-color":"#8b949e","--w-rjv-colon-color":"#c9d1d9","--w-rjv-brackets-color":"#8b949e","--w-rjv-quotes-color":"var(--w-rjv-key-string)","--w-rjv-quotes-string-color":"var(--w-rjv-type-string-color)","--w-rjv-type-string-color":"#a5d6ff","--w-rjv-type-int-color":"#79c0ff","--w-rjv-type-float-color":"#79c0ff","--w-rjv-type-bigint-color":"#79c0ff","--w-rjv-type-boolean-color":"#ffab70","--w-rjv-type-date-color":"#79c0ff","--w-rjv-type-url-color":"#4facff","--w-rjv-type-null-color":"#ff7b72","--w-rjv-type-nan-color":"#859900","--w-rjv-type-undefined-color":"#79c0ff"}:void 0,displayDataTypes:!1,enableClipboard:!1,collapsed:2,shortenTextAfterLength:40,highlightUpdates:!1})})})},dialogInspection=He=>{dialog({children:jsxRuntimeExports.jsx(InspectDialog,{data:He}),fullWidth:!0,maxWidth:"md",scroll:"body"})},dialogInspectionForRAC=He=>UIDialog.create({dismissable:!0,children:jsxRuntimeExports.jsx(InspectDialog,{data:He}),className:"w-[calc(100vw-64px)] max-w-screen-mlg"}),ReportDialog=({refId:He,refType:Qe,onComplete:it})=>{const{t:lt}=useTranslation(),[ut,dt]=reactExports.useState(ReportReason.InappropriateContent),[xt,ft]=reactExports.useState(!1),vt=St=>{dt(St.target.value)},kt=async()=>{ft(!0);try{await client.report({refType:Qe,refId:He,reason:ut}),toast.success(lt("artwork:report.success")),it?.()}catch(St){const Tt=St;toast.error(Tt.message)}finally{ft(!1)}};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-2",children:[jsxRuntimeExports.jsx(icBaselineFlag,{className:"size-5"}),jsxRuntimeExports.jsx("span",{children:lt(`common:report.${Qe.toLowerCase()}.title`)})]})}),jsxRuntimeExports.jsxs(UIDialogContent,{children:[jsxRuntimeExports.jsx("p",{children:lt("artwork:report.description")}),jsxRuntimeExports.jsx(FormControl,{fullWidth:!0,className:"mt-4",children:jsxRuntimeExports.jsxs(RadioGroup,{value:ut,onChange:vt,children:[jsxRuntimeExports.jsx(FormControlLabel,{value:ReportReason.MistakenInfo,control:jsxRuntimeExports.jsx(Radio,{}),label:lt("artwork:report.reasons.mistaken_info")},"mistaken_info"),jsxRuntimeExports.jsx(FormControlLabel,{value:ReportReason.InappropriateContent,control:jsxRuntimeExports.jsx(Radio,{}),label:lt("artwork:report.reasons.inappropriate_content")}),jsxRuntimeExports.jsx(FormControlLabel,{value:ReportReason.IrrelevantTag,control:jsxRuntimeExports.jsx(Radio,{}),label:lt("artwork:report.reasons.irrelevant_tag")}),jsxRuntimeExports.jsx(FormControlLabel,{value:ReportReason.IrrelevantTitle,control:jsxRuntimeExports.jsx(Radio,{}),label:lt("artwork:report.reasons.irrelevant_title")}),jsxRuntimeExports.jsx(FormControlLabel,{value:ReportReason.Spam,control:jsxRuntimeExports.jsx(Radio,{}),label:lt("artwork:report.reasons.spam")}),jsxRuntimeExports.jsx(FormControlLabel,{value:ReportReason.NotAiArtwork,control:jsxRuntimeExports.jsx(Radio,{}),label:lt("artwork:report.reasons.not_ai_artwork")}),jsxRuntimeExports.jsx(FormControlLabel,{value:ReportReason.Offensive,control:jsxRuntimeExports.jsx(Radio,{}),label:lt("artwork:report.reasons.offensive")})]})})]}),jsxRuntimeExports.jsx(UIDialogFooter,{children:jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",color:"admin",onPress:kt,busy:xt,icon:jsxRuntimeExports.jsx(icBaselineSend,{className:"mx-2 size-5"}),children:jsxRuntimeExports.jsx("span",{children:lt("artwork:action.report")})})})]})},dialogReport=async(He,Qe)=>(track("report_click",{refType:He,refId:Qe}),UIDialog.create({dismissable:!0,children:({close:it})=>jsxRuntimeExports.jsx(ReportDialog,{refType:He,refId:Qe,onComplete:()=>{it()}})})),icBaselineMoreVert=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2s-2 .9-2 2s.9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2z"})}),confirmDeleteManga=async()=>{await dialogConfirm({title:"Delete manga?",description:"Are you sure you want to delete this manga?",confirmLabel:"Delete",ConfirmButtonProps:{color:"error",className:"font-bold"}})},MangaExtraActions=({manga:He})=>{const{t:Qe}=useTranslation(["manga","artwork"]),{data:it}=useUserInfo();if(!He||!it)return null;const lt=He.authorId===it.id,ut=it.isAdmin,dt=async()=>{if(!He.artworkId)return toast.error("This manga cannot be reported");dialogReport(RefType.Artwork,He.artworkId)},xt=async()=>{try{track("delete_manga_click"),await confirmDeleteManga(),await executeDeleteManga({id:He.id}),toast.success("Delete successfully.")}catch(Tt){if(Tt===UserCancelled)return;toast.error(`Failed to delete. ${Tt?.message}`)}},ft=async()=>{if(!He.artworkId)return toast.error("This manga cannot be moderated");dialogModerationEdit({refIds:[He.artworkId],refType:RefType.Artwork,shouldFetch:!0})},vt=async()=>{if(!He.artworkId)return toast.error("This manga cannot be adjusted archive status");dialogModerationArchiveEdit({refId:He.artworkId,refType:RefType.Artwork,shouldFetch:!0})},kt=()=>{dialogInspection({manga:He})},St=compact([it&&!lt&&jsxRuntimeExports.jsxs(MenuItem$1,{onClick:dt,children:[jsxRuntimeExports.jsx(icBaselineFlag,{className:"size-6 mr-2 opacity-80"}),Qe("artwork:action.report")]},"report"),!lt&&ut&&jsxRuntimeExports.jsxs(ListSubheader,{className:"flex items-center gap-4 font-bold",children:[jsxRuntimeExports.jsx("span",{children:"Admin (override) Actions"}),jsxRuntimeExports.jsx(HelpIcon,{children:jsxRuntimeExports.jsx("div",{className:"p-4 text-sm w-80",children:"This artwork is not yours, but you are admin so you can access these actions."})})]},"subheader-admin"),...lt||ut?[jsxRuntimeExports.jsx(MenuItem$1,{onClick:xt,children:jsxRuntimeExports.jsx("span",{className:"text-red-600",children:Qe("manga:delete")})},"delete")]:[],ut&&jsxRuntimeExports.jsxs(ListSubheader,{className:"flex items-center gap-4 font-bold bg-orange-50 hover:bg-orange-100 dark:bg-orange-700 dark:text-orange-50",children:[jsxRuntimeExports.jsx("span",{children:"Admin Actions"}),jsxRuntimeExports.jsx(HelpIcon,{children:jsxRuntimeExports.jsx("div",{className:"p-4 text-sm w-80",children:"You are admin so you can access these actions."})})]},"subheader-admin-moderation"),...ut?[jsxRuntimeExports.jsx(MenuItem$1,{onClick:()=>ft(),className:"",children:jsxRuntimeExports.jsx("span",{className:"text-orange-600",children:"Adjust Manga Moderation"})},"mark-moderation-sfw"),jsxRuntimeExports.jsx(MenuItem$1,{onClick:()=>{vt()},className:"text-orange-600",children:"Adjust Manga Archive status"},"archive"),jsxRuntimeExports.jsx(MenuItem$1,{onClick:kt,className:"dark:text-orange-50",children:"Inspect"},"inspect")]:[]]);return St.length===0?null:jsxRuntimeExports.jsx(DropdownMenu,{anchor:jsxRuntimeExports.jsx(ButtonBase,{children:jsxRuntimeExports.jsx(icBaselineMoreVert,{className:"size-6"})}),children:St})};function useDialogMangaShare(){const{t:He}=useTranslation();return reactExports.useCallback(debounce(Qe=>{const it=Qe.type===MangaType.AnimatedComic,lt={link:`${window.location.origin}/${it?"animated-comic":"manga"}/${Qe.id}`,image:getPublicUrl(Qe.coverMedia),text:He("manga:social-share-text",{authorName:getUserDisplayName(Qe.author)})};dialog({children:jsxRuntimeExports.jsxs("div",{className:"p-5 pb-6 flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xl leading-none pb-1 font-sans",children:"Share"}),Qe.author?.username&&jsxRuntimeExports.jsxs("div",{className:"text-xs",children:[it?"Animated comic":"Manga"," by @",Qe.author?.username]})]}),!!navigator.share&&jsxRuntimeExports.jsx(SystemShareButton,{...lt})]}),jsxRuntimeExports.jsx(SocialShare,{...lt})]}),fullWidth:!0,maxWidth:"xs",classes:{paper:"rounded-xl"},TransitionComponent:Grow})},100),[He])}const MangaViewerNavbar=({manga:He,showHomeButton:Qe=!0,onLikeClick:it})=>{const lt=useDialogMangaShare();return jsxRuntimeExports.jsxs("div",{className:"h-[48px] flex items-center gap-4 px-4",children:[Qe&&jsxRuntimeExports.jsx(ButtonBase,{component:Link,to:"/",children:jsxRuntimeExports.jsx(icBaselineHome,{className:"size-6"})}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx(UserLink,{user:He.author??He.artwork?.author,showName:!1,target:"_blank",scene:"mange"}),jsxRuntimeExports.jsx(MangaExtraActions,{manga:He}),He.type===MangaType.Comic&&jsxRuntimeExports.jsx(MangaLikeButton,{manga:He,afterClick:it}),jsxRuntimeExports.jsx(ButtonBase,{onClick:()=>{lt(He)},children:jsxRuntimeExports.jsx(icBaselineIosShare,{className:"size-6"})})]})},MangaDetail=({manga:He,onLikeClick:Qe})=>{const{t:it}=useTranslation(["manga"]),{data:lt,loading:ut}=useGetMangaChapter({mangaId:He.id,index:0});return lt?jsxRuntimeExports.jsxs("main",{children:[jsxRuntimeExports.jsx("div",{className:"w-full text-white bg-black",children:jsxRuntimeExports.jsx(MangaViewerNavbar,{showHomeButton:!1,manga:He,onLikeClick:Qe})}),jsxRuntimeExports.jsx(MangaViewer,{manga:He,artwork:He.artwork,chapter:lt}),jsxRuntimeExports.jsx(MangaViewerFooter,{manga:He})]}):ut?jsxRuntimeExports.jsx(LoadingPage,{}):jsxRuntimeExports.jsx(Empty,{description:it("manga:manga-not-found")})},ArtworkDetailDialog=({artwork:He,manga:Qe,open:it,onClose:lt,extraLikeTrackingArgsForRec:ut,trackingArgs:dt})=>{const[{sort:xt="trending"}]=useQs(),ft=useArtworkGridCols(),vt=reactExports.useCallback(()=>{ut&&trackImageForRec("like_click",{feed:xt,totalCols:ft,scene:"artwork_feed",likeFrom:"detail",retrieverId:He?.feedMetadata?.retrieverId,...ut})},[ut,He?.feedMetadata?.retrieverId,xt,ft]),kt=useTrackPageView(),St=reactExports.useRef(kt);return St.current=kt,reactExports.useEffect(()=>{it&&St.current({scene:"artwork-detail",modal:!0})},[it]),jsxRuntimeExports.jsx(UIDialogResponsive,{open:it,onClose:lt,className:cx(Qe?"max-w-[600px]":"max-w-[1200px]","mmd:w-[calc(100vw-64px)] [&>main]:max-mmd:overflow-y-auto"),dismissable:!0,children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(LoadingPage,{}),children:$$3({artwork:He,manga:Qe}).with({manga:N$4.nonNullable},({manga:Tt})=>jsxRuntimeExports.jsx(MangaDetail,{manga:Tt,onLikeClick:vt})).with({artwork:N$4.nonNullable},({artwork:Tt})=>jsxRuntimeExports.jsx(ArtworkDetailExperiment,{artwork:Tt,onClose:lt,onLikeClickForRec:vt,trackingArgs:dt})).otherwise(()=>null)})})},ArtworkDetailDialog$1=reactExports.memo(ArtworkDetailDialog),MangaPreviewCardContent=({manga:He,to:Qe,showAuthor:it,onClick:lt,onMangaClick:ut,onLikeClick:dt,lastElementRef:xt,wrapperRef:ft,shouldBlur:vt,showIndex:kt,index:St,artworkModFlags:Tt,artwork:Mt})=>{const[Nt]=useBlurNsfw(),At=He.author||Mt?.author,$t=getUserDisplayName(At),Dt=userHasMembership(At),Ft=getPublicUrl(He.coverMedia),Bt=vt&&Nt,Ot=Bt||Tt?.isSensitive;return useTranslation(["action"]),jsxRuntimeExports.jsx(BaseArtworkItemPreviewCard,{lastElementRef:xt,wrapperRef:ft,mediaId:Mt?.mediaId||He.coverMediaId||He.chapter?.coverMediaId,to:Qe,nsfwBlur:Ot,showExplicitIcon:Bt,mediaExtra:jsxRuntimeExports.jsxs("div",{className:cx("absolute inset-0",{"bg-white bg-opacity-70":He.type===MangaType.Comic}),children:[He.type===MangaType.Comic&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:cx("absolute inset-0 flex items-center justify-center opacity-30 pointer-events-none"),children:jsxRuntimeExports.jsx("img",{src:Ft,className:cx("max-w-[90%] max-h-[90%] border-4 border-black scale-95 translate-x-4 shadow-2xl overflow-hidden",{"blur-xl":Ot})})}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:jsxRuntimeExports.jsx("img",{src:Ft,className:cx("max-w-[90%] max-h-[90%] border-4 border-black shadow-2xl overflow-hidden",{"blur-xl":Ot})})}),jsxRuntimeExports.jsx(PreviewMask,{nsfwBlur:Ot,showExplicitIcon:Bt})]}),jsxRuntimeExports.jsx(CardCornerOverlay,{corner:"top-left",className:"bg-transparent shadow-none backdrop-filter-none",children:jsxRuntimeExports.jsx(ArtworkTypeLabel,{artwork:Mt,manga:He,className:"absolute top-1 left-1 ring-1 ring-black/20"})}),Tt?.isSensitive&&jsxRuntimeExports.jsx(ArtworkWarnedOverlay,{className:"absolute left-0 bottom-0 p-4",placement:"in-grid"})]}),likeBtn:jsxRuntimeExports.jsx(MangaLikeButton,{afterClick:dt,manga:He}),showLikeBtn:!0,label:Mt?.title||He.title,time:He.createdAt,secondLabel:it&&$t,showAuthorAvatar:!0,overrideAuthor:At,border:Dt?"member":"plain",contentExtra:kt&&St!=null?jsxRuntimeExports.jsx("p",{className:"absolute top-2 right-2 flex items-center justify-center text-white font-black font-quicksand text-xl rounded py-1 bg-opacity-80 shadow-sm bg-purple-700 tabular-nums w-10 pointer-events-none",children:St+1}):void 0,onClick:Qt=>{if(track(isAnimatedComic(He)?"animated_comic_click":"manga_click",{id:He.id}),isAnimatedComic(He)&&Mt)return Qt.preventDefault(),window.open(getArtworkLink(Mt),"_blank");lt?.(Qt),ut?.(He)}})},MangaPreviewCard=reactExports.memo(function He(Qe){return jsxRuntimeExports.jsx(reactExports.Suspense,{children:jsxRuntimeExports.jsx(MangaPreviewCardContent,{...Qe})})});function MangaTrackedPreviewCard(He){const Qe=useArtworkGridCols(),[{sort:it="trending"}]=useQs(),{index:lt,manga:ut,onMangaClick:dt,artworkId:xt,...ft}=He,{ref:vt,entry:kt}=useIntersection({root:null,rootMargin:"0px",threshold:1});reactExports.useEffect(()=>{kt?.isIntersecting&&trackImageForRec("reco_artwork_view",{artworkId:xt,index:lt,currentLikeCount:ut?.likedCount??0,scene:"artwork_feed",feed:it,totalCols:Qe,retrieverId:ut?.artwork?.feedMetadata?.retrieverId},{amplitudeSampleRate:RECO_EVENTS_AMPLITUDE_SAMPLE_RATE})},[xt,lt,ut?.likedCount,ut?.artwork?.feedMetadata?.retrieverId,kt?.isIntersecting,Qe,it]);const St=reactExports.useCallback(Mt=>{trackImageForRec("reco_artwork_click",{artworkId:xt,index:lt,currentLikeCount:Mt?.likedCount??0,scene:"artwork_feed",feed:it,totalCols:Qe,retrieverId:Mt?.artwork?.feedMetadata?.retrieverId},{amplitudeSampleRate:RECO_EVENTS_AMPLITUDE_SAMPLE_RATE}),dt?.(Mt,lt)},[xt,lt,it,Qe,dt]),Tt=reactExports.useCallback(()=>{trackImageForRec("like_click",{artworkId:xt,index:lt,currentLikeCount:ut?.likedCount??0,scene:"artwork_feed",feed:it,totalCols:Qe,type:isAnimatedComic(ut)?MangaType.AnimatedComic:RefType.Manga,likeFrom:"grid",retrieverId:ut?.artwork?.feedMetadata?.retrieverId})},[xt,lt,ut?.likedCount,ut?.artwork?.feedMetadata?.retrieverId,it,Qe]);return jsxRuntimeExports.jsx(MangaPreviewCard,{...ft,manga:ut,onLikeClick:Tt,onMangaClick:St,wrapperRef:vt})}function ArtworkGrid(He){const{trackingArgs:Qe,artworks:it,onArtworkClick:lt,loading:ut,lastElementRef:dt,queryParams:{order:xt,q:ft}={},className:vt,showIndex:kt,enableTracking:St,showDislike:Tt,containerProps:Mt,modifyArtworkElements:Nt=br=>br,artworkCardProps:At}=He,{t:$t}=useTranslation(["artwork"]),Dt=useIsMobile(),[Ft,Bt]=reactExports.useState(!1),[Ot,Qt]=reactExports.useState(),[Wt,Xt]=reactExports.useState(),Kt=reactExports.useCallback(br=>br.preventDefault(),[]),Jt=reactExports.useCallback((br,vr)=>{vr?window.open(getArtworkLink(br),"_blank"):(Qt(br),Bt(!0))},[]),hr=reactExports.useCallback((br,vr)=>{if(!br)return;const yr=br.manga;Xt({type:yr?isAnimatedComic(yr)?MangaType.AnimatedComic:RefType.Manga:RefType.Artwork,artworkId:br.id,currentLikeCount:br.likedCount??0,index:vr??0}),Jt(br),lt?.(br)},[lt,Jt]),xr=reactExports.useCallback(()=>{Xt(void 0),Bt(!1)},[]);useArtworkIdFromQueryParams({onArtworkOpen:Jt});const gr=reactExports.useMemo(()=>{if(!it)return null;const br=it.map((vr,yr)=>{const Cr=yr===it.length-1;if(vr){const Rr=isUserContentSensitive(vr),Ir=vr.manga;if(Ir){const $r={manga:Ir,shouldBlur:shouldArtworkBeBlurred(vr),showAuthor:!0,onMangaClick:()=>Jt(vr),lastElementRef:Cr?dt:null,index:yr,showIndex:kt,artworkModFlags:{isSensitive:Rr},showDislike:Tt,artwork:vr};return St?jsxRuntimeExports.jsx(MangaTrackedPreviewCard,{artworkId:vr.id,...$r},Ir.id):jsxRuntimeExports.jsx(MangaPreviewCard,{...$r},Ir.id)}const Tr={trackingArgs:Qe,artwork:vr,onClick:Kt,onArtworkClick:hr,showAuthor:!0,lastElementRef:Cr?dt:null,to:getArtworkLink(vr),index:yr,showIndex:kt,showDislike:Tt,menu:[{id:"open-in-new-window",icon:jsxRuntimeExports.jsx(fluentOpen20Filled,{className:"size-5"}),children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:open-in-new-window"}),onAction:()=>Jt(vr,!0)}],oauthReturnOpensDetail:!0,...At};return St?jsxRuntimeExports.jsx(ArtworkTrackedPreviewCard,{id:vr.id,...Tr},vr.id):jsxRuntimeExports.jsx(ArtworkPreviewCardSimple,{...Tr},vr.id)}return null});return Nt(br,{gridItemType:"artwork"})},[it,Dt,$t,xt,ft,St,Tt,Nt,At]);return jsxRuntimeExports.jsxs("div",{className:cx("w-full grid content-start","grid-cols-2 gap-2","lg:grid-cols-4 lg:gap-3",vt),...Mt,children:[gr,ut&&Array.from({length:20}).map((br,vr)=>jsxRuntimeExports.jsx(ArtworkPreviewCardSimple,{loading:!0},vr)),jsxRuntimeExports.jsx(ArtworkDetailDialog$1,{open:Ft,onClose:xr,artwork:Ot,manga:Ot?.manga,trackingArgs:Qe,extraLikeTrackingArgsForRec:St?Wt:void 0})]})}function useArtworkIdFromQueryParams(He){const{data:Qe}=useUserInfo(),[{artworkId:it,openDetail:lt},ut]=useQs(),dt=reactExports.useRef(!1),xt=reactExports.useRef(!1),[ft,vt]=reactExports.useState();reactExports.useEffect(()=>{Qe&&(!it||!lt||dt.current||(typeof it=="string"&&lt==="true"&&vt(it),dt.current=!0,ut(St=>({...St,artworkId:null,openDetail:null}))))},[Qe?.id,it,lt]);const{data:kt}=useGetArtwork(ft??skipToken);return reactExports.useEffect(()=>{xt.current||kt?.id&&(xt.current=!0,He.onArtworkOpen(kt))},[kt?.id]),ft}const $refreshContent=new Subject,$refreshCount=$refreshContent.pipe(scan((He,Qe)=>He+Qe,0)),useRefreshCount=()=>useObservable($refreshCount,0),$globalSearching=new BehaviorSubject(!1),inView=(He,{offset:Qe=0,threshold:it=0}={})=>{const{top:lt,right:ut,bottom:dt,left:xt,width:ft,height:vt}=He.getBoundingClientRect(),kt={t:dt,r:window.innerWidth-xt,b:window.innerHeight-lt,l:ut},St={x:it*ft,y:it*vt};return kt.t>=(Qe.top||Qe+St.y)&&kt.r>=(Qe.right||Qe+St.x)&&kt.b>=(Qe.bottom||Qe+St.y)&&kt.l>=(Qe.left||Qe+St.x)};Intl.Segmenter||__vitePreload(()=>import("./intl_segmenter_polyfill_rs-CyBj4KCD.js"),__vite__mapDeps([29,1]),import.meta.url).then(He=>{Intl.Segmenter=He.Segmenter});const normalizeString=He=>He.replace(/\xa0/g," "),toHalfWidth=He=>He.replace(/[\uff01-\uff5e]/g,function(Qe){return String.fromCharCode(Qe.charCodeAt(0)-65248)}),normalizeSearch=He=>toHalfWidth(He).split(/[{}[\]()/\\,.?!]/).map(Qe=>Qe.trim()).filter(Qe=>Qe).join(" "),toTitleCase=He=>He.split(/[\s_]+/).map(Qe=>Qe[0].toUpperCase()+Qe.slice(1)).join(" "),RE_ASCII_CHAR_WITH_PUNCTUATIONS=new RegExp("^[\\x00-\\x7F]|\\p{P}$","u");function getNonAsciiStats(He){const it=[...new Intl.Segmenter("en",{granularity:"grapheme"}).segment(He)],lt=it.length,ut=it.filter(dt=>!RE_ASCII_CHAR_WITH_PUNCTUATIONS.test(dt.segment)).length;return{totalCount:lt,nonAsciiCount:ut,nonAsciiRatio:ut/lt}}const ArtworkDetailContext=reactExports.createContext({}),useArtworkDetailContext=()=>reactExports.useContext(ArtworkDetailContext),trackArtwork=(He,Qe,it,lt)=>{track(He,{artworkId:Qe?.id,tags:Qe?.tags?.map(({name:ut})=>ut),authorId:Qe?.authorId,...it},lt)},CURSOR_PARAM="_cursor",getNextPageUrl=(He,Qe,it,lt)=>withFragment(withQuery(He,{...parseQuery(Qe),[CURSOR_PARAM]:lt}),it),useInitialPageCursor=()=>{const[He]=useQs();return He[CURSOR_PARAM]};function InvisibleNextPage(He){const Qe=useLocation();return He.cursor?jsxRuntimeExports.jsx(Link,{className:"opacity-0",target:"_blank",to:getNextPageUrl(Qe.pathname,Qe.search,Qe.hash,He.cursor),children:"Next Page"}):null}const icBaselineKeyboardArrowUp=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"})}),ScrollTop=He=>jsxRuntimeExports.jsx("div",{className:cx("fixed bottom-24 right-6 gap-8",He.className),style:He.style,children:jsxRuntimeExports.jsx(Fab,{color:"secondary",size:"small",className:cx("shadow-md"),onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},children:jsxRuntimeExports.jsx(icBaselineKeyboardArrowUp,{})})}),BaseArtworkInfiniteScroll=({tag:He,q:Qe,relevantArtworkId:it,order:lt,type:ut,i2vPro:dt,challenge:xt,authorId:ft,worldId:vt,characterId:kt,pageSize:St=24,renderEmpty:Tt,renderLoading:Mt=()=>jsxRuntimeExports.jsx(LoadingPage,{}),renderContent:Nt,containerProps:At,extraArgs:$t,showSpeedDial:Dt=!0,trackingArgs:Ft,scrollContainer:Bt=window})=>{const{t:Ot}=useTranslation(["artwork"]),Qt=useInitialPageCursor(),{data:Wt,loading:Xt}=useUserInfo(),Kt=isOrderOptionPosSeq(lt),Jt=reactExports.useMemo(()=>{if(Xt)return skipToken;const Nr={...$t,isSafeSearch:!0,tag:He,q:typeof Qe=="string"?normalizeSearch(Qe):void 0,relevantArtworkId:it,authorId:ft,worldId:vt,characterId:kt,type:ut,i2vPro:dt};if(Kt?(Nr.first=St,Qt&&(Nr.after=Qt)):(Nr.last=St,Qt&&(Nr.before=Qt)),Nr.feed=getListArtworkFeedFromArgs({order:lt,type:ut,relevantArtworkId:it,q:Qe,tag:He}),lt===OrderOption.dailyRanking)if(!dt&&(Qe==null||Qe===""))Nr.feed="daily_ranking_dedup";else{const Jr=defaultDayjs().subtract(1,"week").startOf("day").toISOString(),Qr=defaultDayjs().subtract(30,"minute").startOf("minute").toISOString();Nr.orderBy="-markInfo.likedCount",Nr.time={gt:Jr,lt:Qr}}return lt===OrderOption.mostLiked&&(Nr.orderBy="-markInfo.likedCount"),He==="challenge"&&(Nr.challenge=xt,Nr.tag=void 0),(He==="all"||!He)&&(Nr.tag=void 0),Nr},[ft,xt,kt,$t,dt,Qt,lt,Qe,it,He,ut,vt,Xt]),{data:hr,loading:xr,fetchMore:gr,loadingMore:br}=useInfiniteListArtworks(Jt),vr=reactExports.useMemo(()=>Kt?hr?.pageInfo?.hasNextPage:hr?.pageInfo?.hasPreviousPage,[hr?.pageInfo,Kt]),yr=reactExports.useMemo(()=>{if(Kt&&hr?.pageInfo?.hasNextPage)return hr?.pageInfo.endCursor;if(hr?.pageInfo?.hasPreviousPage)return hr?.pageInfo.startCursor},[hr?.pageInfo,Kt]),Cr=br||xr,Rr=reactExports.useCallback(()=>{!Cr&&vr&&gr({variables:Kt?{after:hr?.pageInfo.endCursor,first:St}:{before:hr?.pageInfo.startCursor,last:St}})},[Cr,vr,gr,hr]),Ir=reactExports.useMemo(()=>{if(!hr)return[];const Nr=uniqBy(getNodesFromConnection(hr),"id");return Kt?Nr:Nr.reverse()},[hr,Kt]),Tr=hr?.edges?.length,$r=Tr==null?void 0:Math.ceil(Tr/St),Zr=reactExports.useCallback(async Nr=>{trackArtwork("image_click",Nr,{...Ft,curPage:$r},{destinations:["getway"]})},[$r,Ft]),Sr=reactExports.useMemo(()=>({...Ft,type:ut}),[ut,Ft]);reactExports.useEffect(()=>{$globalSearching.next(Cr)},[Cr]);const Dr=reactExports.useRef(null),wr=reactExports.useRef(null);useEvent$1("scroll",reactExports.useCallback(()=>{Dr.current&&inView(Dr.current,{offset:-500})&&Rr()},[Rr]),Bt,{passive:!0});const qr=Xt||xr?Mt():Ir.length===0?Tt?Tt():jsxRuntimeExports.jsx(DefaultEmptyComponent,{userInfo:Wt,order:lt,q:Qe,trackingArgs:Sr}):Nt({artworks:Ir,loadMore:Rr,onArtworkClick:Zr,loading:xr,lastElementRef:Dr,queryParams:{order:lt,q:Qe},trackingArgs:Sr});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{...At,className:cx("w-full flex flex-wrap justify-center mb-8 min-h-screen",At?.className),children:[qr,!vr&&Ir.length>0&&!Cr&&jsxRuntimeExports.jsx("div",{className:"text-active font-bold text-3xl w-full text-center",children:Ot("common:list-reached-the-end")}),jsxRuntimeExports.jsx(InvisibleNextPage,{cursor:yr})]}),jsxRuntimeExports.jsx("div",{ref:wr,className:"w-full flex justify-center mb-8",children:vr?jsxRuntimeExports.jsx(LoadingPage,{fullHeight:!0}):null}),Dt&&jsxRuntimeExports.jsx(SpeedDialBtns,{})]})},DefaultEmptyComponent=He=>{const{userInfo:Qe,order:it,q:lt,trackingArgs:ut}=He,{t:dt}=useTranslation(["artwork"]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Empty,{description:it===OrderOption.followingNews?dt(Qe?"artwork:search-results.empty-no-following":"artwork:search-results.empty-no-login"):lt?dt("artwork:search-results.empty-with-keyword",{keyword:lt}):dt("artwork:search-results.empty-without-keyword")}),jsxRuntimeExports.jsxs("section",{className:"w-full",children:[jsxRuntimeExports.jsx("h3",{className:"mb-4 text-xl font-bold",children:dt("artwork:search-results.recommendation-section.heading")}),jsxRuntimeExports.jsx(StatefulArtworkGrid,{order:OrderOption.recommended,showDislike:!0,enableTracking:!0,trackingArgs:ut,renderEmpty:()=>null})]})]})},SpeedDialBtns=()=>{const He=useIsMobile();return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(ScrollTop,{style:{bottom:He?76:void 0}})})},StatefulArtworkGrid=({enableTracking:He,showDislike:Qe,modifyArtworkElements:it,artworkCardProps:lt,...ut})=>jsxRuntimeExports.jsxs(reactExports.Suspense,{children:[jsxRuntimeExports.jsx(ScrollRestoration,{}),jsxRuntimeExports.jsx(BaseArtworkInfiniteScroll,{...ut,renderContent:dt=>jsxRuntimeExports.jsx(ArtworkGrid,{enableTracking:He,showDislike:Qe,modifyArtworkElements:it,artworkCardProps:lt,...dt}),renderLoading:()=>jsxRuntimeExports.jsx(ArtworkGrid,{loading:!0})})]});function ArtworkRelevantArtworks(He){const Qe=OrderOption.mostLiked;return jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(StatefulArtworkGrid,{order:OrderOption.mostLiked,relevantArtworkId:He.artworkId,trackingArgs:{feed:Qe,scene:"artwork-relevant"},pageSize:24,renderEmpty:()=>jsxRuntimeExports.jsx(EmptyForRelevantArtworks,{})},He.artworkId)})}function ArtworkRelevantArtworksInline(He){const{t:Qe}=useTranslation(["artwork"]),{data:it,loading:lt}=usePagedListArtworks({first:4,relevantArtworkId:He.artworkId,orderBy:"-markInfo.likedCount",feed:"relevant-v2"},{context:{refetchOnFocus:!1}}),ut=useBreakpoint("lg","up"),dt=getNodesFromConnection(it),xt=dt.slice(0,ut?4:2);return!lt&&dt.length<1?null:jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"font-medium text-xl",children:Qe("artwork:similar-images.title")}),jsxRuntimeExports.jsx(Link,{to:`/artwork/${He.artworkId}/relevant`,className:"text-theme-primary ml-auto",onClick:()=>{track("show_similar_image_click")},children:Qe("artwork:show.more")})]}),jsxRuntimeExports.jsxs("div",{className:"w-full",children:[lt&&xt.length===0&&jsxRuntimeExports.jsx(CircularSpinner,{}),!lt&&xt.length>0?jsxRuntimeExports.jsx(ArtworkGrid,{artworks:xt,loading:lt,containerProps:{className:"grid grid-flow-col grid-cols-2 gap-2 pt-2 pb-8 lg:grid-cols-4 lg:gap-3"},trackingArgs:{scene:"artwork-relevant"}}):null]})]})}function EmptyForRelevantArtworks(){const{t:He}=useTranslation(["artwork"]);return jsxRuntimeExports.jsx(Empty,{description:He("artwork:relevant-page.empty-placeholder")})}function ArtworkRecommendedArtworks(He){const Qe=OrderOption.recommended;return jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(StatefulArtworkGrid,{order:Qe,showDislike:!0,enableTracking:!0,renderEmpty:()=>null,trackingArgs:{...He.trackingArgs,feed:Qe}})})}const we=0,zt=1,qt=2,En=4;function ln(He){return()=>He}function lo(He){He()}function ne(He,Qe){return it=>He(Qe(it))}function cn(He,Qe){return()=>He(Qe)}function co(He,Qe){return it=>He(Qe,it)}function Me(He){return He!==void 0}function uo(...He){return()=>{He.map(lo)}}function Yt(){}function ve(He,Qe){return Qe(He),He}function ao(He,Qe){return Qe(He)}function X(...He){return He}function K(He,Qe){return He(zt,Qe)}function W(He,Qe){He(we,Qe)}function We(He){He(qt)}function st(He){return He(En)}function O(He,Qe){return K(He,co(Qe,we))}function bt(He,Qe){const it=He(zt,lt=>{it(),Qe(lt)});return it}function un(He){let Qe,it;return lt=>ut=>{Qe=ut,it&&clearTimeout(it),it=setTimeout(()=>{lt(Qe)},He)}}function Bn(He,Qe){return He===Qe}function Y(He=Bn){let Qe;return it=>lt=>{He(Qe,lt)||(Qe=lt,it(lt))}}function P(He){return Qe=>it=>{He(it)&&Qe(it)}}function E(He){return Qe=>ne(Qe,He)}function yt(He){return Qe=>()=>{Qe(He)}}function x(He,...Qe){const it=fo(...Qe);return(lt,ut)=>{switch(lt){case qt:We(He);return;case zt:return K(He,it(ut))}}}function Rt(He,Qe){return it=>lt=>{it(Qe=He(Qe,lt))}}function jt(He){return Qe=>it=>{He>0?He--:Qe(it)}}function Lt(He){let Qe=null,it;return lt=>ut=>{Qe=ut,!it&&(it=setTimeout(()=>{it=void 0,lt(Qe)},He))}}function _(...He){const Qe=new Array(He.length);let it=0,lt=null;const ut=Math.pow(2,He.length)-1;return He.forEach((dt,xt)=>{const ft=Math.pow(2,xt);K(dt,vt=>{const kt=it;it=it|ft,Qe[xt]=vt,kt!==ut&&it===ut&&lt&&(lt(),lt=null)})}),dt=>xt=>{const ft=()=>{dt([xt].concat(Qe))};it===ut?ft():lt=ft}}function fo(...He){return Qe=>He.reduceRight(ao,Qe)}function mo(He){let Qe,it;const lt=()=>Qe?.();return function(ut,dt){switch(ut){case zt:return dt?it===dt?void 0:(lt(),it=dt,Qe=K(He,dt),Qe):(lt(),Yt);case qt:lt(),it=null;return}}}function v(He){let Qe=He;const it=$();return(lt,ut)=>{switch(lt){case we:Qe=ut;break;case zt:{ut(Qe);break}case En:return Qe}return it(lt,ut)}}function ct(He,Qe){return ve(v(Qe),it=>O(He,it))}function $(){const He=[];return(Qe,it)=>{switch(Qe){case we:He.slice().forEach(lt=>{lt(it)});return;case qt:He.splice(0,He.length);return;case zt:return He.push(it),()=>{const lt=He.indexOf(it);lt>-1&&He.splice(lt,1)}}}}function ht(He){return ve($(),Qe=>O(He,Qe))}function U(He,Qe=[],{singleton:it}={singleton:!0}){return{constructor:He,dependencies:Qe,id:po(),singleton:it}}const po=()=>Symbol();function ho(He){const Qe=new Map,it=({constructor:lt,dependencies:ut,id:dt,singleton:xt})=>{if(xt&&Qe.has(dt))return Qe.get(dt);const ft=lt(ut.map(vt=>it(vt)));return xt&&Qe.set(dt,ft),ft};return it(He)}function rt(...He){const Qe=$(),it=new Array(He.length);let lt=0;const ut=Math.pow(2,He.length)-1;return He.forEach((dt,xt)=>{const ft=Math.pow(2,xt);K(dt,vt=>{it[xt]=vt,lt=lt|ft,lt===ut&&W(Qe,it)})}),function(dt,xt){switch(dt){case qt:{We(Qe);return}case zt:return lt===ut&&xt(it),K(Qe,xt)}}}function A(He,Qe=Bn){return x(He,Y(Qe))}function an(...He){return function(Qe,it){switch(Qe){case qt:return;case zt:return uo(...He.map(lt=>K(lt,it)))}}}var mt=(He=>(He[He.DEBUG=0]="DEBUG",He[He.INFO=1]="INFO",He[He.WARN=2]="WARN",He[He.ERROR=3]="ERROR",He))(mt||{});const go={0:"debug",3:"error",1:"log",2:"warn"},Io=()=>typeof globalThis>"u"?window:globalThis,Vt=U(()=>{const He=v(3);return{log:v((Qe,it,lt=1)=>{var ut;const dt=(ut=Io().VIRTUOSO_LOG_LEVEL)!=null?ut:st(He);lt>=dt&&console[go[lt]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",Qe,it)}),logLevel:He}},[],{singleton:!0});function Ht(He,Qe,it){return Ge(He,Qe,it).callbackRef}function Ge(He,Qe,it){const lt=React.useRef(null);let ut=xt=>{};const dt=React.useMemo(()=>typeof ResizeObserver<"u"?new ResizeObserver(xt=>{const ft=()=>{const vt=xt[0].target;vt.offsetParent!==null&&He(vt)};it?ft():requestAnimationFrame(ft)}):null,[He,it]);return ut=xt=>{xt&&Qe?(dt?.observe(xt),lt.current=xt):(lt.current&&dt?.unobserve(lt.current),lt.current=null)},{callbackRef:ut,ref:lt}}function kn(He,Qe,it,lt,ut,dt,xt,ft,vt){const kt=React.useCallback(St=>{const Tt=So(St.children,Qe,ft?"offsetWidth":"offsetHeight",ut);let Mt=St.parentElement;for(;!Mt.dataset.virtuosoScroller;)Mt=Mt.parentElement;const Nt=Mt.lastElementChild.dataset.viewportType==="window";let At;Nt&&(At=Mt.ownerDocument.defaultView);const $t=xt?ft?xt.scrollLeft:xt.scrollTop:Nt?ft?At.scrollX||At.document.documentElement.scrollLeft:At.scrollY||At.document.documentElement.scrollTop:ft?Mt.scrollLeft:Mt.scrollTop,Dt=xt?ft?xt.scrollWidth:xt.scrollHeight:Nt?ft?At.document.documentElement.scrollWidth:At.document.documentElement.scrollHeight:ft?Mt.scrollWidth:Mt.scrollHeight,Ft=xt?ft?xt.offsetWidth:xt.offsetHeight:Nt?ft?At.innerWidth:At.innerHeight:ft?Mt.offsetWidth:Mt.offsetHeight;lt({scrollHeight:Dt,scrollTop:Math.max($t,0),viewportHeight:Ft}),dt?.(ft?dn("column-gap",getComputedStyle(St).columnGap,ut):dn("row-gap",getComputedStyle(St).rowGap,ut)),Tt!==null&&He(Tt)},[He,Qe,ut,dt,xt,lt,ft]);return Ge(kt,it,vt)}function So(He,Qe,it,lt){const ut=He.length;if(ut===0)return null;const dt=[];for(let xt=0;xt<ut;xt++){const ft=He.item(xt);if(ft.dataset.index===void 0)continue;const vt=parseInt(ft.dataset.index),kt=parseFloat(ft.dataset.knownSize),St=Qe(ft,it);if(St===0&&lt("Zero-sized element, this should not happen",{child:ft},mt.ERROR),St===kt)continue;const Tt=dt[dt.length-1];dt.length===0||Tt.size!==St||Tt.endIndex!==vt-1?dt.push({endIndex:vt,size:St,startIndex:vt}):dt[dt.length-1].endIndex++}return dt}function dn(He,Qe,it){return Qe!=="normal"&&!(Qe!=null&&Qe.endsWith("px"))&&it(`${He} was not resolved to pixel value correctly`,Qe,mt.WARN),Qe==="normal"?0:parseInt(Qe??"0",10)}function _e(He,Qe,it){const lt=React.useRef(null),ut=React.useCallback(vt=>{if(!(vt!=null&&vt.offsetParent))return;const kt=vt.getBoundingClientRect(),St=kt.width;let Tt,Mt;if(Qe){const Nt=Qe.getBoundingClientRect(),At=kt.top-Nt.top;Mt=Nt.height-Math.max(0,At),Tt=At+Qe.scrollTop}else{const Nt=xt.current.ownerDocument.defaultView;Mt=Nt.innerHeight-Math.max(0,kt.top),Tt=kt.top+Nt.scrollY}lt.current={offsetTop:Tt,visibleHeight:Mt,visibleWidth:St},He(lt.current)},[He,Qe]),{callbackRef:dt,ref:xt}=Ge(ut,!0,it),ft=React.useCallback(()=>{ut(xt.current)},[ut,xt]);return React.useEffect(()=>{var vt;if(Qe){Qe.addEventListener("scroll",ft);const kt=new ResizeObserver(()=>{requestAnimationFrame(ft)});return kt.observe(Qe),()=>{Qe.removeEventListener("scroll",ft),kt.unobserve(Qe)}}else{const kt=(vt=xt.current)==null?void 0:vt.ownerDocument.defaultView;return kt?.addEventListener("scroll",ft),kt?.addEventListener("resize",ft),()=>{kt?.removeEventListener("scroll",ft),kt?.removeEventListener("resize",ft)}}},[ft,Qe,xt]),dt}const at$1=U(()=>{const He=$(),Qe=$(),it=v(0),lt=$(),ut=v(0),dt=$(),xt=$(),ft=v(0),vt=v(0),kt=v(0),St=v(0),Tt=$(),Mt=$(),Nt=v(!1),At=v(!1),$t=v(!1);return O(x(He,E(({scrollTop:Dt})=>Dt)),Qe),O(x(He,E(({scrollHeight:Dt})=>Dt)),xt),O(Qe,ut),{deviation:it,fixedFooterHeight:kt,fixedHeaderHeight:vt,footerHeight:St,headerHeight:ft,horizontalDirection:At,scrollBy:Mt,scrollContainerState:He,scrollHeight:xt,scrollingInProgress:Nt,scrollTo:Tt,scrollTop:Qe,skipAnimationFrameInResizeObserver:$t,smoothScrollTargetReached:lt,statefulScrollTop:ut,viewportHeight:dt}},[],{singleton:!0}),oe={lvl:0};function Fn(He,Qe){const it=He.length;if(it===0)return[];let{index:lt,value:ut}=Qe(He[0]);const dt=[];for(let xt=1;xt<it;xt++){const{index:ft,value:vt}=Qe(He[xt]);dt.push({end:ft-1,start:lt,value:ut}),lt=ft,ut=vt}return dt.push({end:1/0,start:lt,value:ut}),dt}function j(He){return He===oe}function re(He,Qe){if(!j(He))return Qe===He.k?He.v:Qe<He.k?re(He.l,Qe):re(He.r,Qe)}function Ct(He,Qe,it="k"){if(j(He))return[-1/0,void 0];if(Number(He[it])===Qe)return[He.k,He.v];if(Number(He[it])<Qe){const lt=Ct(He.r,Qe,it);return lt[0]===-1/0?[He.k,He.v]:lt}return Ct(He.l,Qe,it)}function pt(He,Qe,it){return j(He)?zn(Qe,it,1):Qe===He.k?ot(He,{k:Qe,v:it}):Qe<He.k?fn(ot(He,{l:pt(He.l,Qe,it)})):fn(ot(He,{r:pt(He.r,Qe,it)}))}function Ut(){return oe}function ye(He,Qe,it){if(j(He))return[];const lt=Ct(He,Qe)[0];return xo(ze(He,lt,it))}function Le(He,Qe){if(j(He))return oe;const{k:it,l:lt,r:ut}=He;if(Qe===it){if(j(lt))return ut;if(j(ut))return lt;{const[dt,xt]=Ln(lt);return ge(ot(He,{k:dt,l:On(lt),v:xt}))}}else return Qe<it?ge(ot(He,{l:Le(lt,Qe)})):ge(ot(He,{r:Le(ut,Qe)}))}function Gt(He){return j(He)?[]:[...Gt(He.l),{k:He.k,v:He.v},...Gt(He.r)]}function ze(He,Qe,it){if(j(He))return[];const{k:lt,l:ut,r:dt,v:xt}=He;let ft=[];return lt>Qe&&(ft=ft.concat(ze(ut,Qe,it))),lt>=Qe&&lt<=it&&ft.push({k:lt,v:xt}),lt<=it&&(ft=ft.concat(ze(dt,Qe,it))),ft}function ge(He){const{l:Qe,lvl:it,r:lt}=He;if(lt.lvl>=it-1&&Qe.lvl>=it-1)return He;if(it>lt.lvl+1){if(Ee(Qe))return Vn(ot(He,{lvl:it-1}));if(!j(Qe)&&!j(Qe.r))return ot(Qe.r,{l:ot(Qe,{r:Qe.r.l}),lvl:it,r:ot(He,{l:Qe.r.r,lvl:it-1})});throw new Error("Unexpected empty nodes")}else{if(Ee(He))return Ve(ot(He,{lvl:it-1}));if(!j(lt)&&!j(lt.l)){const ut=lt.l,dt=Ee(ut)?lt.lvl-1:lt.lvl;return ot(ut,{l:ot(He,{lvl:it-1,r:ut.l}),lvl:ut.lvl+1,r:Ve(ot(lt,{l:ut.r,lvl:dt}))})}else throw new Error("Unexpected empty nodes")}}function ot(He,Qe){return zn(Qe.k!==void 0?Qe.k:He.k,Qe.v!==void 0?Qe.v:He.v,Qe.lvl!==void 0?Qe.lvl:He.lvl,Qe.l!==void 0?Qe.l:He.l,Qe.r!==void 0?Qe.r:He.r)}function On(He){return j(He.r)?He.l:ge(ot(He,{r:On(He.r)}))}function Ee(He){return j(He)||He.lvl>He.r.lvl}function Ln(He){return j(He.r)?[He.k,He.v]:Ln(He.r)}function zn(He,Qe,it,lt=oe,ut=oe){return{k:He,l:lt,lvl:it,r:ut,v:Qe}}function fn(He){return Ve(Vn(He))}function Vn(He){const{l:Qe}=He;return!j(Qe)&&Qe.lvl===He.lvl?ot(Qe,{r:ot(He,{l:Qe.r})}):He}function Ve(He){const{lvl:Qe,r:it}=He;return!j(it)&&!j(it.r)&&it.lvl===Qe&&it.r.lvl===Qe?ot(it,{l:ot(He,{r:it.l}),lvl:Qe+1}):He}function xo(He){return Fn(He,({k:Qe,v:it})=>({index:Qe,value:it}))}function Pn(He,Qe){return!!(He&&He.startIndex===Qe.startIndex&&He.endIndex===Qe.endIndex)}function se(He,Qe){return!!(He&&He[0]===Qe[0]&&He[1]===Qe[1])}const Ne=U(()=>({recalcInProgress:v(!1)}),[],{singleton:!0});function An(He,Qe,it){return He[Se(He,Qe,it)]}function Se(He,Qe,it,lt=0){let ut=He.length-1;for(;lt<=ut;){const dt=Math.floor((lt+ut)/2),xt=He[dt],ft=it(xt,Qe);if(ft===0)return dt;if(ft===-1){if(ut-lt<2)return dt-1;ut=dt-1}else{if(ut===lt)return dt;lt=dt+1}}throw new Error(`Failed binary finding record in array - ${He.join(",")}, searched for ${Qe}`)}function To(He,Qe,it,lt){const ut=Se(He,Qe,lt),dt=Se(He,it,lt,ut);return He.slice(ut,dt+1)}function wt(He,Qe){return Math.round(He.getBoundingClientRect()[Qe])}function Re(He){return!j(He.groupOffsetTree)}function De({index:He},Qe){return Qe===He?0:Qe<He?-1:1}function Co(){return{groupIndices:[],groupOffsetTree:Ut(),lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:Ut()}}function wo(He,Qe){let it=j(He)?0:1/0;for(const lt of Qe){const{endIndex:ut,size:dt,startIndex:xt}=lt;if(it=Math.min(it,xt),j(He)){He=pt(He,0,dt);continue}const ft=ye(He,xt-1,ut+1);if(ft.some(Bo(lt)))continue;let vt=!1,kt=!1;for(const{end:St,start:Tt,value:Mt}of ft)vt?(ut>=Tt||dt===Mt)&&(He=Le(He,Tt)):(kt=Mt!==dt,vt=!0),St>ut&&ut>=Tt&&Mt!==dt&&(He=pt(He,ut+1,Mt));kt&&(He=pt(He,xt,dt))}return[He,it]}function vo(He){return typeof He.groupIndex<"u"}function yo({offset:He},Qe){return Qe===He?0:Qe<He?-1:1}function ie(He,Qe,it){if(Qe.length===0)return 0;const{index:lt,offset:ut,size:dt}=An(Qe,He,De),xt=He-lt,ft=dt*xt+(xt-1)*it+ut;return ft>0?ft+it:ft}function Mn(He,Qe){if(!Re(Qe))return He;let it=0;for(;Qe.groupIndices[it]<=He+it;)it++;return He+it}function Wn(He,Qe,it){if(vo(He))return Qe.groupIndices[He.groupIndex]+1;{const lt=He.index==="LAST"?it:He.index;let ut=Mn(lt,Qe);return ut=Math.max(0,ut,Math.min(it,ut)),ut}}function Ro(He,Qe,it,lt=0){return lt>0&&(Qe=Math.max(Qe,An(He,lt,De).offset)),Fn(To(He,Qe,it,yo),Eo)}function bo(He,[Qe,it,lt,ut]){Qe.length>0&&lt("received item sizes",Qe,mt.DEBUG);const dt=He.sizeTree;let xt=dt,ft=0;if(it.length>0&&j(dt)&&Qe.length===2){const Mt=Qe[0].size,Nt=Qe[1].size;xt=it.reduce((At,$t)=>pt(pt(At,$t,Mt),$t+1,Nt),xt)}else[xt,ft]=wo(xt,Qe);if(xt===dt)return He;const{lastIndex:vt,lastOffset:kt,lastSize:St,offsetTree:Tt}=Pe(He.offsetTree,ft,xt,ut);return{groupIndices:it,groupOffsetTree:it.reduce((Mt,Nt)=>pt(Mt,Nt,ie(Nt,Tt,ut)),Ut()),lastIndex:vt,lastOffset:kt,lastSize:St,offsetTree:Tt,sizeTree:xt}}function Ho(He){return Gt(He).map(({k:Qe,v:it},lt,ut)=>{const dt=ut[lt+1];return{endIndex:dt?dt.k-1:1/0,size:it,startIndex:Qe}})}function mn(He,Qe){let it=0,lt=0;for(;it<He;)it+=Qe[lt+1]-Qe[lt]-1,lt++;return lt-(it===He?0:1)}function Pe(He,Qe,it,lt){let ut=He,dt=0,xt=0,ft=0,vt=0;if(Qe!==0){vt=Se(ut,Qe-1,De),ft=ut[vt].offset;const kt=Ct(it,Qe-1);dt=kt[0],xt=kt[1],ut.length&&ut[vt].size===Ct(it,Qe)[1]&&(vt-=1),ut=ut.slice(0,vt+1)}else ut=[];for(const{start:kt,value:St}of ye(it,Qe,1/0)){const Tt=kt-dt,Mt=Tt*xt+ft+Tt*lt;ut.push({index:kt,offset:Mt,size:St}),dt=kt,ft=Mt,xt=St}return{lastIndex:dt,lastOffset:ft,lastSize:xt,offsetTree:ut}}function Eo(He){return{index:He.index,value:He}}function Bo(He){const{endIndex:Qe,size:it,startIndex:lt}=He;return ut=>ut.start===lt&&(ut.end===Qe||ut.end===1/0)&&ut.value===it}const ko={offsetHeight:"height",offsetWidth:"width"},Et=U(([{log:He},{recalcInProgress:Qe}])=>{const it=$(),lt=$(),ut=ct(lt,0),dt=$(),xt=$(),ft=v(0),vt=v([]),kt=v(void 0),St=v(void 0),Tt=v((Wt,Xt)=>wt(Wt,ko[Xt])),Mt=v(void 0),Nt=v(0),At=Co(),$t=ct(x(it,_(vt,He,Nt),Rt(bo,At),Y()),At),Dt=ct(x(vt,Y(),Rt((Wt,Xt)=>({current:Xt,prev:Wt.current}),{current:[],prev:[]}),E(({prev:Wt})=>Wt)),[]);O(x(vt,P(Wt=>Wt.length>0),_($t,Nt),E(([Wt,Xt,Kt])=>{const Jt=Wt.reduce((hr,xr,gr)=>pt(hr,xr,ie(xr,Xt.offsetTree,Kt)||gr),Ut());return{...Xt,groupIndices:Wt,groupOffsetTree:Jt}})),$t),O(x(lt,_($t),P(([Wt,{lastIndex:Xt}])=>Wt<Xt),E(([Wt,{lastIndex:Xt,lastSize:Kt}])=>[{endIndex:Xt,size:Kt,startIndex:Wt}])),it),O(kt,St);const Ft=ct(x(kt,E(Wt=>Wt===void 0)),!0);O(x(St,P(Wt=>Wt!==void 0&&j(st($t).sizeTree)),E(Wt=>[{endIndex:0,size:Wt,startIndex:0}])),it);const Bt=ht(x(it,_($t),Rt(({sizes:Wt},[Xt,Kt])=>({changed:Kt!==Wt,sizes:Kt}),{changed:!1,sizes:At}),E(Wt=>Wt.changed)));K(x(ft,Rt((Wt,Xt)=>({diff:Wt.prev-Xt,prev:Xt}),{diff:0,prev:0}),E(Wt=>Wt.diff)),Wt=>{const{groupIndices:Xt}=st($t);if(Wt>0)W(Qe,!0),W(dt,Wt+mn(Wt,Xt));else if(Wt<0){const Kt=st(Dt);Kt.length>0&&(Wt-=mn(-Wt,Kt)),W(xt,Wt)}}),K(x(ft,_(He)),([Wt,Xt])=>{Wt<0&&Xt("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:ft},mt.ERROR)});const Ot=ht(dt);O(x(dt,_($t),E(([Wt,Xt])=>{const Kt=Xt.groupIndices.length>0,Jt=[],hr=Xt.lastSize;if(Kt){const xr=re(Xt.sizeTree,0);let gr=0,br=0;for(;gr<Wt;){const yr=Xt.groupIndices[br],Cr=Xt.groupIndices.length===br+1?1/0:Xt.groupIndices[br+1]-yr-1;Jt.push({endIndex:yr,size:xr,startIndex:yr}),Jt.push({endIndex:yr+1+Cr-1,size:hr,startIndex:yr+1}),br++,gr+=Cr+1}const vr=Gt(Xt.sizeTree);return gr!==Wt&&vr.shift(),vr.reduce((yr,{k:Cr,v:Rr})=>{let Ir=yr.ranges;return yr.prevSize!==0&&(Ir=[...yr.ranges,{endIndex:Cr+Wt-1,size:yr.prevSize,startIndex:yr.prevIndex}]),{prevIndex:Cr+Wt,prevSize:Rr,ranges:Ir}},{prevIndex:Wt,prevSize:0,ranges:Jt}).ranges}return Gt(Xt.sizeTree).reduce((xr,{k:gr,v:br})=>({prevIndex:gr+Wt,prevSize:br,ranges:[...xr.ranges,{endIndex:gr+Wt-1,size:xr.prevSize,startIndex:xr.prevIndex}]}),{prevIndex:0,prevSize:hr,ranges:[]}).ranges})),it);const Qt=ht(x(xt,_($t,Nt),E(([Wt,{offsetTree:Xt},Kt])=>{const Jt=-Wt;return ie(Jt,Xt,Kt)})));return O(x(xt,_($t,Nt),E(([Wt,Xt,Kt])=>{if(Xt.groupIndices.length>0){if(j(Xt.sizeTree))return Xt;let Jt=Ut();const hr=st(Dt);let xr=0,gr=0,br=0;for(;xr<-Wt;){br=hr[gr];const vr=hr[gr+1]-br-1;gr++,xr+=vr+1}if(Jt=Gt(Xt.sizeTree).reduce((vr,{k:yr,v:Cr})=>pt(vr,Math.max(0,yr+Wt),Cr),Jt),xr!==-Wt){const vr=re(Xt.sizeTree,br);Jt=pt(Jt,0,vr);const yr=Ct(Xt.sizeTree,-Wt+1)[1];Jt=pt(Jt,1,yr)}return{...Xt,sizeTree:Jt,...Pe(Xt.offsetTree,0,Jt,Kt)}}else{const Jt=Gt(Xt.sizeTree).reduce((hr,{k:xr,v:gr})=>pt(hr,Math.max(0,xr+Wt),gr),Ut());return{...Xt,sizeTree:Jt,...Pe(Xt.offsetTree,0,Jt,Kt)}}})),$t),{beforeUnshiftWith:Ot,data:Mt,defaultItemSize:St,firstItemIndex:ft,fixedItemSize:kt,gap:Nt,groupIndices:vt,itemSize:Tt,listRefresh:Bt,shiftWith:xt,shiftWithOffset:Qt,sizeRanges:it,sizes:$t,statefulTotalCount:ut,totalCount:lt,trackItemSizes:Ft,unshiftWith:dt}},X(Vt,Ne),{singleton:!0});function Fo(He){return He.reduce((Qe,it)=>(Qe.groupIndices.push(Qe.totalCount),Qe.totalCount+=it+1,Qe),{groupIndices:[],totalCount:0})}const Gn=U(([{groupIndices:He,sizes:Qe,totalCount:it},{headerHeight:lt,scrollTop:ut}])=>{const dt=$(),xt=$(),ft=ht(x(dt,E(Fo)));return O(x(ft,E(vt=>vt.totalCount)),it),O(x(ft,E(vt=>vt.groupIndices)),He),O(x(rt(ut,Qe,lt),P(([vt,kt])=>Re(kt)),E(([vt,kt,St])=>Ct(kt.groupOffsetTree,Math.max(vt-St,0),"v")[0]),Y(),E(vt=>[vt])),xt),{groupCounts:dt,topItemsIndexes:xt}},X(Et,at$1)),Pt=U(([{log:He}])=>{const Qe=v(!1),it=ht(x(Qe,P(lt=>lt),Y()));return K(Qe,lt=>{lt&&st(He)("props updated",{},mt.DEBUG)}),{didMount:it,propsReady:Qe}},X(Vt),{singleton:!0}),Oo=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function _n(He){const Qe=typeof He=="number"?{index:He}:He;return Qe.align||(Qe.align="start"),(!Qe.behavior||!Oo)&&(Qe.behavior="auto"),Qe.offset||(Qe.offset=0),Qe}const ce=U(([{gap:He,listRefresh:Qe,sizes:it,totalCount:lt},{fixedFooterHeight:ut,fixedHeaderHeight:dt,footerHeight:xt,headerHeight:ft,scrollingInProgress:vt,scrollTo:kt,smoothScrollTargetReached:St,viewportHeight:Tt},{log:Mt}])=>{const Nt=$(),At=$(),$t=v(0);let Dt=null,Ft=null,Bt=null;function Ot(){Dt&&(Dt(),Dt=null),Bt&&(Bt(),Bt=null),Ft&&(clearTimeout(Ft),Ft=null),W(vt,!1)}return O(x(Nt,_(it,Tt,lt,$t,ft,xt,Mt),_(He,dt,ut),E(([[Qt,Wt,Xt,Kt,Jt,hr,xr,gr],br,vr,yr])=>{const Cr=_n(Qt),{align:Rr,behavior:Ir,offset:Tr}=Cr,$r=Kt-1,Zr=Wn(Cr,Wt,$r);let Sr=ie(Zr,Wt.offsetTree,br)+hr;Rr==="end"?(Sr+=vr+Ct(Wt.sizeTree,Zr)[1]-Xt+yr,Zr===$r&&(Sr+=xr)):Rr==="center"?Sr+=(vr+Ct(Wt.sizeTree,Zr)[1]-Xt+yr)/2:Sr-=Jt,Tr&&(Sr+=Tr);const Dr=wr=>{Ot(),wr?(gr("retrying to scroll to",{location:Qt},mt.DEBUG),W(Nt,Qt)):(W(At,!0),gr("list did not change, scroll successful",{},mt.DEBUG))};if(Ot(),Ir==="smooth"){let wr=!1;Bt=K(Qe,qr=>{wr=wr||qr}),Dt=bt(St,()=>{Dr(wr)})}else Dt=bt(x(Qe,Lo(150)),Dr);return Ft=setTimeout(()=>{Ot()},1200),W(vt,!0),gr("scrolling from index to",{behavior:Ir,index:Zr,top:Sr},mt.DEBUG),{behavior:Ir,top:Sr}})),kt),{scrollTargetReached:At,scrollToIndex:Nt,topListHeight:$t}},X(Et,at$1,Vt),{singleton:!0});function Lo(He){return Qe=>{const it=setTimeout(()=>{Qe(!1)},He);return lt=>{lt&&(Qe(!0),clearTimeout(it))}}}function $e(He,Qe){He==0?Qe():requestAnimationFrame(()=>{$e(He-1,Qe)})}function Ue(He,Qe){const it=Qe-1;return typeof He=="number"?He:He.index==="LAST"?it:He.index}const ue=U(([{defaultItemSize:He,listRefresh:Qe,sizes:it},{scrollTop:lt},{scrollTargetReached:ut,scrollToIndex:dt},{didMount:xt}])=>{const ft=v(!0),vt=v(0),kt=v(!0);return O(x(xt,_(vt),P(([St,Tt])=>!!Tt),yt(!1)),ft),O(x(xt,_(vt),P(([St,Tt])=>!!Tt),yt(!1)),kt),K(x(rt(Qe,xt),_(ft,it,He,kt),P(([[,St],Tt,{sizeTree:Mt},Nt,At])=>St&&(!j(Mt)||Me(Nt))&&!Tt&&!At),_(vt)),([,St])=>{bt(ut,()=>{W(kt,!0)}),$e(4,()=>{bt(lt,()=>{W(ft,!0)}),W(dt,St)})}),{initialItemFinalLocationReached:kt,initialTopMostItemIndex:vt,scrolledToInitialItem:ft}},X(Et,at$1,ce,Pt),{singleton:!0});function Nn(He,Qe){return Math.abs(He-Qe)<1.01}const le="up",te="down",zo="none",Vo={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},Po=0,ae=U(([{footerHeight:He,headerHeight:Qe,scrollBy:it,scrollContainerState:lt,scrollTop:ut,viewportHeight:dt}])=>{const xt=v(!1),ft=v(!0),vt=$(),kt=$(),St=v(4),Tt=v(Po),Mt=ct(x(an(x(A(ut),jt(1),yt(!0)),x(A(ut),jt(1),yt(!1),un(100))),Y()),!1),Nt=ct(x(an(x(it,yt(!0)),x(it,yt(!1),un(200))),Y()),!1);O(x(rt(A(ut),A(Tt)),E(([Bt,Ot])=>Bt<=Ot),Y()),ft),O(x(ft,Lt(50)),kt);const At=ht(x(rt(lt,A(dt),A(Qe),A(He),A(St)),Rt((Bt,[{scrollHeight:Ot,scrollTop:Qt},Wt,Xt,Kt,Jt])=>{const hr=Qt+Wt-Ot>-Jt,xr={scrollHeight:Ot,scrollTop:Qt,viewportHeight:Wt};if(hr){let br,vr;return Qt>Bt.state.scrollTop?(br="SCROLLED_DOWN",vr=Bt.state.scrollTop-Qt):(br="SIZE_DECREASED",vr=Bt.state.scrollTop-Qt||Bt.scrollTopDelta),{atBottom:!0,atBottomBecause:br,scrollTopDelta:vr,state:xr}}let gr;return xr.scrollHeight>Bt.state.scrollHeight?gr="SIZE_INCREASED":Wt<Bt.state.viewportHeight?gr="VIEWPORT_HEIGHT_DECREASING":Qt<Bt.state.scrollTop?gr="SCROLLING_UPWARDS":gr="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:gr,state:xr}},Vo),Y((Bt,Ot)=>Bt&&Bt.atBottom===Ot.atBottom))),$t=ct(x(lt,Rt((Bt,{scrollHeight:Ot,scrollTop:Qt,viewportHeight:Wt})=>{if(Nn(Bt.scrollHeight,Ot))return{changed:!1,jump:0,scrollHeight:Ot,scrollTop:Qt};{const Xt=Ot-(Qt+Wt)<1;return Bt.scrollTop!==Qt&&Xt?{changed:!0,jump:Bt.scrollTop-Qt,scrollHeight:Ot,scrollTop:Qt}:{changed:!0,jump:0,scrollHeight:Ot,scrollTop:Qt}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),P(Bt=>Bt.changed),E(Bt=>Bt.jump)),0);O(x(At,E(Bt=>Bt.atBottom)),xt),O(x(xt,Lt(50)),vt);const Dt=v(te);O(x(lt,E(({scrollTop:Bt})=>Bt),Y(),Rt((Bt,Ot)=>st(Nt)?{direction:Bt.direction,prevScrollTop:Ot}:{direction:Ot<Bt.prevScrollTop?le:te,prevScrollTop:Ot},{direction:te,prevScrollTop:0}),E(Bt=>Bt.direction)),Dt),O(x(lt,Lt(50),yt(zo)),Dt);const Ft=v(0);return O(x(Mt,P(Bt=>!Bt),yt(0)),Ft),O(x(ut,Lt(100),_(Mt),P(([Bt,Ot])=>!!Ot),Rt(([Bt,Ot],[Qt])=>[Ot,Qt],[0,0]),E(([Bt,Ot])=>Ot-Bt)),Ft),{atBottomState:At,atBottomStateChange:vt,atBottomThreshold:St,atTopStateChange:kt,atTopThreshold:Tt,isAtBottom:xt,isAtTop:ft,isScrolling:Mt,lastJumpDueToItemResize:$t,scrollDirection:Dt,scrollVelocity:Ft}},X(at$1)),xe="top",Te="bottom",pn="none";function hn(He,Qe,it){return typeof He=="number"?it===le&&Qe===xe||it===te&&Qe===Te?He:0:it===le?Qe===xe?He.main:He.reverse:Qe===Te?He.main:He.reverse}function gn(He,Qe){var it;return typeof He=="number"?He:(it=He[Qe])!=null?it:0}const Ke=U(([{deviation:He,fixedHeaderHeight:Qe,headerHeight:it,scrollTop:lt,viewportHeight:ut}])=>{const dt=$(),xt=v(0),ft=v(0),vt=v(0),kt=ct(x(rt(A(lt),A(ut),A(it),A(dt,se),A(vt),A(xt),A(Qe),A(He),A(ft)),E(([St,Tt,Mt,[Nt,At],$t,Dt,Ft,Bt,Ot])=>{const Qt=St-Bt,Wt=Dt+Ft,Xt=Math.max(Mt-Qt,0);let Kt=pn;const Jt=gn(Ot,xe),hr=gn(Ot,Te);return Nt-=Bt,Nt+=Mt+Ft,At+=Mt+Ft,At-=Bt,Nt>St+Wt-Jt&&(Kt=le),At<St-Xt+Tt+hr&&(Kt=te),Kt!==pn?[Math.max(Qt-Mt-hn($t,xe,Kt)-Jt,0),Qt-Xt-Ft+Tt+hn($t,Te,Kt)+hr]:null}),P(St=>St!=null),Y(se)),[0,0]);return{increaseViewportBy:ft,listBoundary:dt,overscan:vt,topListHeight:xt,visibleRange:kt}},X(at$1),{singleton:!0});function Ao(He,Qe,it){if(Re(Qe)){const lt=Mn(He,Qe);return[{index:Ct(Qe.groupOffsetTree,lt)[0],offset:0,size:0},{data:it?.[0],index:lt,offset:0,size:0}]}return[{data:it?.[0],index:He,offset:0,size:0}]}const Be={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function Ie(He,Qe,it,lt,ut,dt){const{lastIndex:xt,lastOffset:ft,lastSize:vt}=ut;let kt=0,St=0;if(He.length>0){kt=He[0].offset;const $t=He[He.length-1];St=$t.offset+$t.size}const Tt=it-xt,Mt=ft+Tt*vt+(Tt-1)*lt,Nt=kt,At=Mt-St;return{bottom:St,firstItemIndex:dt,items:In(He,ut,dt),offsetBottom:At,offsetTop:kt,top:Nt,topItems:In(Qe,ut,dt),topListHeight:Qe.reduce(($t,Dt)=>Dt.size+$t,0),totalCount:it}}function Dn(He,Qe,it,lt,ut,dt){let xt=0;if(it.groupIndices.length>0)for(const St of it.groupIndices){if(St-xt>=He)break;xt++}const ft=He+xt,vt=Ue(Qe,ft),kt=Array.from({length:ft}).map((St,Tt)=>({data:dt[Tt+vt],index:Tt+vt,offset:0,size:0}));return Ie(kt,[],ft,ut,it,lt)}function In(He,Qe,it){if(He.length===0)return[];if(!Re(Qe))return He.map(kt=>({...kt,index:kt.index+it,originalIndex:kt.index}));const lt=He[0].index,ut=He[He.length-1].index,dt=[],xt=ye(Qe.groupOffsetTree,lt,ut);let ft,vt=0;for(const kt of He){(!ft||ft.end<kt.index)&&(ft=xt.shift(),vt=Qe.groupIndices.indexOf(ft.start));let St;kt.index===ft.start?St={index:vt,type:"group"}:St={groupIndex:vt,index:kt.index-(vt+1)+it},dt.push({...St,data:kt.data,offset:kt.offset,originalIndex:kt.index,size:kt.size})}return dt}const _t=U(([{data:He,firstItemIndex:Qe,gap:it,sizes:lt,totalCount:ut},dt,{listBoundary:xt,topListHeight:ft,visibleRange:vt},{initialTopMostItemIndex:kt,scrolledToInitialItem:St},{topListHeight:Tt},Mt,{didMount:Nt},{recalcInProgress:At}])=>{const $t=v([]),Dt=v(0),Ft=$();O(dt.topItemsIndexes,$t);const Bt=ct(x(rt(Nt,At,A(vt,se),A(ut),A(lt),A(kt),St,A($t),A(Qe),A(it),He),P(([Xt,Kt,,Jt,,,,,,,hr])=>{const xr=hr&&hr.length!==Jt;return Xt&&!Kt&&!xr}),E(([,,[Xt,Kt],Jt,hr,xr,gr,br,vr,yr,Cr])=>{const Rr=hr,{offsetTree:Ir,sizeTree:Tr}=Rr,$r=st(Dt);if(Jt===0)return{...Be,totalCount:Jt};if(Xt===0&&Kt===0)return $r===0?{...Be,totalCount:Jt}:Dn($r,xr,hr,vr,yr,Cr||[]);if(j(Tr))return $r>0?null:Ie(Ao(Ue(xr,Jt),Rr,Cr),[],Jt,yr,Rr,vr);const Zr=[];if(br.length>0){const Nr=br[0],Jr=br[br.length-1];let Qr=0;for(const Ur of ye(Tr,Nr,Jr)){const nn=Ur.value,Cn=Math.max(Ur.start,Nr),es=Math.min(Ur.end,Jr);for(let Xr=Cn;Xr<=es;Xr++)Zr.push({data:Cr?.[Xr],index:Xr,offset:Qr,size:nn}),Qr+=nn}}if(!gr)return Ie([],Zr,Jt,yr,Rr,vr);const Sr=br.length>0?br[br.length-1]+1:0,Dr=Ro(Ir,Xt,Kt,Sr);if(Dr.length===0)return null;const wr=Jt-1,qr=ve([],Nr=>{for(const Jr of Dr){const Qr=Jr.value;let Ur=Qr.offset,nn=Jr.start;const Cn=Qr.size;if(Qr.offset<Xt){nn+=Math.floor((Xt-Qr.offset+yr)/(Cn+yr));const Xr=nn-Jr.start;Ur+=Xr*Cn+Xr*yr}nn<Sr&&(Ur+=(Sr-nn)*Cn,nn=Sr);const es=Math.min(Jr.end,wr);for(let Xr=nn;Xr<=es&&!(Ur>=Kt);Xr++)Nr.push({data:Cr?.[Xr],index:Xr,offset:Ur,size:Cn}),Ur+=Cn+yr}});return Ie(qr,Zr,Jt,yr,Rr,vr)}),P(Xt=>Xt!==null),Y()),Be);O(x(He,P(Me),E(Xt=>Xt?.length)),ut),O(x(Bt,E(Xt=>Xt.topListHeight)),Tt),O(Tt,ft),O(x(Bt,E(Xt=>[Xt.top,Xt.bottom])),xt),O(x(Bt,E(Xt=>Xt.items)),Ft);const Ot=ht(x(Bt,P(({items:Xt})=>Xt.length>0),_(ut,He),P(([{items:Xt},Kt])=>Xt[Xt.length-1].originalIndex===Kt-1),E(([,Xt,Kt])=>[Xt-1,Kt]),Y(se),E(([Xt])=>Xt))),Qt=ht(x(Bt,Lt(200),P(({items:Xt,topItems:Kt})=>Xt.length>0&&Xt[0].originalIndex===Kt.length),E(({items:Xt})=>Xt[0].index),Y())),Wt=ht(x(Bt,P(({items:Xt})=>Xt.length>0),E(({items:Xt})=>{let Kt=0,Jt=Xt.length-1;for(;Xt[Kt].type==="group"&&Kt<Jt;)Kt++;for(;Xt[Jt].type==="group"&&Jt>Kt;)Jt--;return{endIndex:Xt[Jt].index,startIndex:Xt[Kt].index}}),Y(Pn)));return{endReached:Ot,initialItemCount:Dt,itemsRendered:Ft,listState:Bt,rangeChanged:Wt,startReached:Qt,topItemsIndexes:$t,...Mt}},X(Et,Gn,Ke,ue,ce,ae,Pt,Ne),{singleton:!0}),$n=U(([{fixedFooterHeight:He,fixedHeaderHeight:Qe,footerHeight:it,headerHeight:lt},{listState:ut}])=>{const dt=$(),xt=ct(x(rt(it,He,lt,Qe,ut),E(([ft,vt,kt,St,Tt])=>ft+vt+kt+St+Tt.offsetBottom+Tt.bottom)),0);return O(A(xt),dt),{totalListHeight:xt,totalListHeightChanged:dt}},X(at$1,_t),{singleton:!0}),Mo=U(([{viewportHeight:He},{totalListHeight:Qe}])=>{const it=v(!1),lt=ct(x(rt(it,He,Qe),P(([ut])=>ut),E(([,ut,dt])=>Math.max(0,ut-dt)),Lt(0),Y()),0);return{alignToBottom:it,paddingTopAddition:lt}},X(at$1,$n),{singleton:!0});function Sn(He){return He?He==="smooth"?"smooth":"auto":!1}const Wo=(He,Qe)=>typeof He=="function"?Sn(He(Qe)):Qe&&Sn(He),Go=U(([{listRefresh:He,totalCount:Qe,fixedItemSize:it},{atBottomState:lt,isAtBottom:ut},{scrollToIndex:dt},{scrolledToInitialItem:xt},{didMount:ft,propsReady:vt},{log:kt},{scrollingInProgress:St}])=>{const Tt=v(!1),Mt=$();let Nt=null;function At(Dt){W(dt,{align:"end",behavior:Dt,index:"LAST"})}K(x(rt(x(A(Qe),jt(1)),ft),_(A(Tt),ut,xt,St),E(([[Dt,Ft],Bt,Ot,Qt,Wt])=>{let Xt=Ft&&Qt,Kt="auto";return Xt&&(Kt=Wo(Bt,Ot||Wt),Xt=Xt&&!!Kt),{followOutputBehavior:Kt,shouldFollow:Xt,totalCount:Dt}}),P(({shouldFollow:Dt})=>Dt)),({followOutputBehavior:Dt,totalCount:Ft})=>{Nt&&(Nt(),Nt=null),st(it)?requestAnimationFrame(()=>{st(kt)("following output to ",{totalCount:Ft},mt.DEBUG),At(Dt)}):Nt=bt(He,()=>{st(kt)("following output to ",{totalCount:Ft},mt.DEBUG),At(Dt),Nt=null})});function $t(Dt){const Ft=bt(lt,Bt=>{Dt&&!Bt.atBottom&&Bt.notAtBottomBecause==="SIZE_INCREASED"&&!Nt&&(st(kt)("scrolling to bottom due to increased size",{},mt.DEBUG),At("auto"))});setTimeout(Ft,100)}return K(x(rt(A(Tt),Qe,vt),P(([Dt,,Ft])=>Dt&&Ft),Rt(({value:Dt},[,Ft])=>({refreshed:Dt===Ft,value:Ft}),{refreshed:!1,value:0}),P(({refreshed:Dt})=>Dt),_(Tt,Qe)),([,Dt])=>{st(xt)&&$t(Dt!==!1)}),K(Mt,()=>{$t(st(Tt)!==!1)}),K(rt(A(Tt),lt),([Dt,Ft])=>{Dt&&!Ft.atBottom&&Ft.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&At("auto")}),{autoscrollToBottom:Mt,followOutput:Tt}},X(Et,ae,ce,ue,Pt,Vt,at$1)),_o=U(([{data:He,firstItemIndex:Qe,gap:it,sizes:lt},{initialTopMostItemIndex:ut},{initialItemCount:dt,listState:xt},{didMount:ft}])=>(O(x(ft,_(dt),P(([,vt])=>vt!==0),_(ut,lt,Qe,it,He),E(([[,vt],kt,St,Tt,Mt,Nt=[]])=>Dn(vt,kt,St,Tt,Mt,Nt))),xt),{}),X(Et,ue,_t,Pt),{singleton:!0}),No=U(([{didMount:He},{scrollTo:Qe},{listState:it}])=>{const lt=v(0);return K(x(He,_(lt),P(([,ut])=>ut!==0),E(([,ut])=>({top:ut}))),ut=>{bt(x(it,jt(1),P(dt=>dt.items.length>1)),()=>{requestAnimationFrame(()=>{W(Qe,ut)})})}),{initialScrollTop:lt}},X(Pt,at$1,_t),{singleton:!0}),Do=({itemBottom:He,itemTop:Qe,locationParams:{align:it,behavior:lt,...ut},viewportBottom:dt,viewportTop:xt})=>Qe<xt?{...ut,align:it??"start",behavior:lt}:He>dt?{...ut,align:it??"end",behavior:lt}:null,$o=U(([{gap:He,sizes:Qe,totalCount:it},{fixedFooterHeight:lt,fixedHeaderHeight:ut,headerHeight:dt,scrollingInProgress:xt,scrollTop:ft,viewportHeight:vt},{scrollToIndex:kt}])=>{const St=$();return O(x(St,_(Qe,vt,it,dt,ut,lt,ft),_(He),E(([[Tt,Mt,Nt,At,$t,Dt,Ft,Bt],Ot])=>{const{align:Qt,behavior:Wt,calculateViewLocation:Xt=Do,done:Kt,...Jt}=Tt,hr=Wn(Tt,Mt,At-1),xr=ie(hr,Mt.offsetTree,Ot)+$t+Dt,gr=xr+Ct(Mt.sizeTree,hr)[1],br=Bt+Dt,vr=Bt+Nt-Ft,yr=Xt({itemBottom:gr,itemTop:xr,locationParams:{align:Qt,behavior:Wt,...Jt},viewportBottom:vr,viewportTop:br});return yr?Kt&&bt(x(xt,P(Cr=>!Cr),jt(st(xt)?1:2)),Kt):Kt&&Kt(),yr}),P(Tt=>Tt!==null)),kt),{scrollIntoView:St}},X(Et,at$1,ce,_t,Vt),{singleton:!0}),Un=U(([{scrollVelocity:He}])=>{const Qe=v(!1),it=$(),lt=v(!1);return O(x(He,_(lt,Qe,it),P(([ut,dt])=>!!dt),E(([ut,dt,xt,ft])=>{const{enter:vt,exit:kt}=dt;if(xt){if(kt(ut,ft))return!1}else if(vt(ut,ft))return!0;return xt}),Y()),Qe),K(x(rt(Qe,He,it),_(lt)),([[ut,dt,xt],ft])=>{ut&&ft&&ft.change&&ft.change(dt,xt)}),{isSeeking:Qe,scrollSeekConfiguration:lt,scrollSeekRangeChanged:it,scrollVelocity:He}},X(ae),{singleton:!0}),je=U(([{scrollContainerState:He,scrollTo:Qe}])=>{const it=$(),lt=$(),ut=$(),dt=v(!1),xt=v(void 0);return O(x(rt(it,lt),E(([{scrollHeight:ft,scrollTop:vt,viewportHeight:kt},{offsetTop:St}])=>({scrollHeight:ft,scrollTop:Math.max(0,vt-St),viewportHeight:kt}))),He),O(x(Qe,_(lt),E(([ft,{offsetTop:vt}])=>({...ft,top:ft.top+vt}))),ut),{customScrollParent:xt,useWindowScroll:dt,windowScrollContainerState:it,windowScrollTo:ut,windowViewportRect:lt}},X(at$1)),Uo=U(([{sizeRanges:He,sizes:Qe},{headerHeight:it,scrollTop:lt},{initialTopMostItemIndex:ut},{didMount:dt},{useWindowScroll:xt,windowScrollContainerState:ft,windowViewportRect:vt}])=>{const kt=$(),St=v(void 0),Tt=v(null),Mt=v(null);return O(ft,Tt),O(vt,Mt),K(x(kt,_(Qe,lt,xt,Tt,Mt,it)),([Nt,At,$t,Dt,Ft,Bt,Ot])=>{const Qt=Ho(At.sizeTree);Dt&&Ft!==null&&Bt!==null&&($t=Ft.scrollTop-Bt.offsetTop),$t-=Ot,Nt({ranges:Qt,scrollTop:$t})}),O(x(St,P(Me),E(Ko)),ut),O(x(dt,_(St),P(([,Nt])=>Nt!==void 0),Y(),E(([,Nt])=>Nt.ranges)),He),{getState:kt,restoreStateFrom:St}},X(Et,at$1,ue,Pt,je));function Ko(He){return{align:"start",index:0,offset:He.scrollTop}}const jo=U(([{topItemsIndexes:He}])=>{const Qe=v(0);return O(x(Qe,P(it=>it>=0),E(it=>Array.from({length:it}).map((lt,ut)=>ut))),He),{topItemCount:Qe}},X(_t));function Kn(He){let Qe=!1,it;return()=>(Qe||(Qe=!0,it=He()),it)}const qo=Kn(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),Yo=U(([{deviation:He,scrollBy:Qe,scrollingInProgress:it,scrollTop:lt},{isAtBottom:ut,isScrolling:dt,lastJumpDueToItemResize:xt,scrollDirection:ft},{listState:vt},{beforeUnshiftWith:kt,gap:St,shiftWithOffset:Tt,sizes:Mt},{log:Nt},{recalcInProgress:At}])=>{const $t=ht(x(vt,_(xt),Rt(([,Ft,Bt,Ot],[{bottom:Qt,items:Wt,offsetBottom:Xt,totalCount:Kt},Jt])=>{const hr=Qt+Xt;let xr=0;return Bt===Kt&&Ft.length>0&&Wt.length>0&&(Wt[0].originalIndex===0&&Ft[0].originalIndex===0||(xr=hr-Ot,xr!==0&&(xr+=Jt))),[xr,Wt,Kt,hr]},[0,[],0,0]),P(([Ft])=>Ft!==0),_(lt,ft,it,ut,Nt,At),P(([,Ft,Bt,Ot,,,Qt])=>!Qt&&!Ot&&Ft!==0&&Bt===le),E(([[Ft],,,,,Bt])=>(Bt("Upward scrolling compensation",{amount:Ft},mt.DEBUG),Ft))));function Dt(Ft){Ft>0?(W(Qe,{behavior:"auto",top:-Ft}),W(He,0)):(W(He,0),W(Qe,{behavior:"auto",top:-Ft}))}return K(x($t,_(He,dt)),([Ft,Bt,Ot])=>{Ot&&qo()?W(He,Bt-Ft):Dt(-Ft)}),K(x(rt(ct(dt,!1),He,At),P(([Ft,Bt,Ot])=>!Ft&&!Ot&&Bt!==0),E(([Ft,Bt])=>Bt),Lt(1)),Dt),O(x(Tt,E(Ft=>({top:-Ft}))),Qe),K(x(kt,_(Mt,St),E(([Ft,{groupIndices:Bt,lastSize:Ot,sizeTree:Qt},Wt])=>{function Xt(Kt){return Kt*(Ot+Wt)}if(Bt.length===0)return Xt(Ft);{let Kt=0;const Jt=re(Qt,0);let hr=0,xr=0;for(;hr<Ft;){hr++,Kt+=Jt;let gr=Bt.length===xr+1?1/0:Bt[xr+1]-Bt[xr]-1;hr+gr>Ft&&(Kt-=Jt,gr=Ft-hr+1),hr+=gr,Kt+=Xt(gr),xr++}return Kt}})),Ft=>{W(He,Ft),requestAnimationFrame(()=>{W(Qe,{top:Ft}),requestAnimationFrame(()=>{W(He,0),W(At,!1)})})}),{deviation:He}},X(at$1,ae,_t,Et,Vt,Ne)),Zo=U(([He,Qe,it,lt,ut,dt,xt,ft,vt,kt])=>({...He,...Qe,...it,...lt,...ut,...dt,...xt,...ft,...vt,...kt}),X(Ke,_o,Pt,Un,$n,No,Mo,je,$o,Vt)),jn=U(([{data:He,defaultItemSize:Qe,firstItemIndex:it,fixedItemSize:lt,gap:ut,groupIndices:dt,itemSize:xt,sizeRanges:ft,sizes:vt,statefulTotalCount:kt,totalCount:St,trackItemSizes:Tt},{initialItemFinalLocationReached:Mt,initialTopMostItemIndex:Nt,scrolledToInitialItem:At},$t,Dt,Ft,{listState:Bt,topItemsIndexes:Ot,...Qt},{scrollToIndex:Wt},Xt,{topItemCount:Kt},{groupCounts:Jt},hr])=>(O(Qt.rangeChanged,hr.scrollSeekRangeChanged),O(x(hr.windowViewportRect,E(xr=>xr.visibleHeight)),$t.viewportHeight),{data:He,defaultItemHeight:Qe,firstItemIndex:it,fixedItemHeight:lt,gap:ut,groupCounts:Jt,initialItemFinalLocationReached:Mt,initialTopMostItemIndex:Nt,scrolledToInitialItem:At,sizeRanges:ft,topItemCount:Kt,topItemsIndexes:Ot,totalCount:St,...Ft,groupIndices:dt,itemSize:xt,listState:Bt,scrollToIndex:Wt,statefulTotalCount:kt,trackItemSizes:Tt,...Qt,...hr,...$t,sizes:vt,...Dt}),X(Et,ue,at$1,Uo,Go,_t,ce,Yo,jo,Gn,Zo));function Xo(He,Qe){const it={},lt={};let ut=0;const dt=He.length;for(;ut<dt;)lt[He[ut]]=1,ut+=1;for(const xt in Qe)Object.hasOwn(lt,xt)||(it[xt]=Qe[xt]);return it}const pe=typeof document<"u"?React.useLayoutEffect:React.useEffect;function qe(He,Qe,it){const lt=Object.keys(Qe.required||{}),ut=Object.keys(Qe.optional||{}),dt=Object.keys(Qe.methods||{}),xt=Object.keys(Qe.events||{}),ft=React.createContext({});function vt(Dt,Ft){Dt.propsReady&&W(Dt.propsReady,!1);for(const Bt of lt){const Ot=Dt[Qe.required[Bt]];W(Ot,Ft[Bt])}for(const Bt of ut)if(Bt in Ft){const Ot=Dt[Qe.optional[Bt]];W(Ot,Ft[Bt])}Dt.propsReady&&W(Dt.propsReady,!0)}function kt(Dt){return dt.reduce((Ft,Bt)=>(Ft[Bt]=Ot=>{const Qt=Dt[Qe.methods[Bt]];W(Qt,Ot)},Ft),{})}function St(Dt){return xt.reduce((Ft,Bt)=>(Ft[Bt]=mo(Dt[Qe.events[Bt]]),Ft),{})}const Tt=React.forwardRef((Dt,Ft)=>{const{children:Bt,...Ot}=Dt,[Qt]=React.useState(()=>ve(ho(He),Kt=>{vt(Kt,Ot)})),[Wt]=React.useState(cn(St,Qt));pe(()=>{for(const Kt of xt)Kt in Ot&&K(Wt[Kt],Ot[Kt]);return()=>{Object.values(Wt).map(We)}},[Ot,Wt,Qt]),pe(()=>{vt(Qt,Ot)}),React.useImperativeHandle(Ft,ln(kt(Qt)));const Xt=it;return jsxRuntimeExports.jsx(ft.Provider,{value:Qt,children:it?jsxRuntimeExports.jsx(Xt,{...Xo([...lt,...ut,...xt],Ot),children:Bt}):Bt})}),Mt=Dt=>{const Ft=React.useContext(ft);return React.useCallback(Bt=>{W(Ft[Dt],Bt)},[Ft,Dt])},Nt=Dt=>{const Ft=React.useContext(ft)[Dt],Bt=React.useCallback(Ot=>K(Ft,Ot),[Ft]);return React.useSyncExternalStore(Bt,()=>st(Ft),()=>st(Ft))},At=Dt=>{const Ft=React.useContext(ft)[Dt],[Bt,Ot]=React.useState(cn(st,Ft));return pe(()=>K(Ft,Qt=>{Qt!==Bt&&Ot(ln(Qt))}),[Ft,Bt]),Bt},$t=React.version.startsWith("18")?Nt:At;return{Component:Tt,useEmitter:(Dt,Ft)=>{const Bt=React.useContext(ft)[Dt];pe(()=>K(Bt,Ft),[Ft,Bt])},useEmitterValue:$t,usePublisher:Mt}}const be=React.createContext(void 0),qn=React.createContext(void 0),Yn=typeof document<"u"?React.useLayoutEffect:React.useEffect;function ke(He){return"self"in He}function Jo(He){return"body"in He}function Zn(He,Qe,it,lt=Yt,ut,dt){const xt=React.useRef(null),ft=React.useRef(null),vt=React.useRef(null),kt=React.useCallback(Mt=>{let Nt,At,$t;const Dt=Mt.target;if(Jo(Dt)||ke(Dt)){const Bt=ke(Dt)?Dt:Dt.defaultView;$t=dt?Bt.scrollX:Bt.scrollY,Nt=dt?Bt.document.documentElement.scrollWidth:Bt.document.documentElement.scrollHeight,At=dt?Bt.innerWidth:Bt.innerHeight}else $t=dt?Dt.scrollLeft:Dt.scrollTop,Nt=dt?Dt.scrollWidth:Dt.scrollHeight,At=dt?Dt.offsetWidth:Dt.offsetHeight;const Ft=()=>{He({scrollHeight:Nt,scrollTop:Math.max($t,0),viewportHeight:At})};Mt.suppressFlushSync?Ft():$7SXl2$reactdom.flushSync(Ft),ft.current!==null&&($t===ft.current||$t<=0||$t===Nt-At)&&(ft.current=null,Qe(!0),vt.current&&(clearTimeout(vt.current),vt.current=null))},[He,Qe,dt]);React.useEffect(()=>{const Mt=ut||xt.current;return lt(ut||xt.current),kt({suppressFlushSync:!0,target:Mt}),Mt.addEventListener("scroll",kt,{passive:!0}),()=>{lt(null),Mt.removeEventListener("scroll",kt)}},[xt,kt,it,lt,ut]);function St(Mt){const Nt=xt.current;if(!Nt||(dt?"offsetWidth"in Nt&&Nt.offsetWidth===0:"offsetHeight"in Nt&&Nt.offsetHeight===0))return;const At=Mt.behavior==="smooth";let $t,Dt,Ft;ke(Nt)?(Dt=Math.max(wt(Nt.document.documentElement,dt?"width":"height"),dt?Nt.document.documentElement.scrollWidth:Nt.document.documentElement.scrollHeight),$t=dt?Nt.innerWidth:Nt.innerHeight,Ft=dt?window.scrollX:window.scrollY):(Dt=Nt[dt?"scrollWidth":"scrollHeight"],$t=wt(Nt,dt?"width":"height"),Ft=Nt[dt?"scrollLeft":"scrollTop"]);const Bt=Dt-$t;if(Mt.top=Math.ceil(Math.max(Math.min(Bt,Mt.top),0)),Nn($t,Dt)||Mt.top===Ft){He({scrollHeight:Dt,scrollTop:Ft,viewportHeight:$t}),At&&Qe(!0);return}At?(ft.current=Mt.top,vt.current&&clearTimeout(vt.current),vt.current=setTimeout(()=>{vt.current=null,ft.current=null,Qe(!0)},1e3)):ft.current=null,dt&&(Mt={behavior:Mt.behavior,left:Mt.top}),Nt.scrollTo(Mt)}function Tt(Mt){dt&&(Mt={behavior:Mt.behavior,left:Mt.top}),xt.current.scrollBy(Mt)}return{scrollByCallback:Tt,scrollerRef:xt,scrollToCallback:St}}const Fe="-webkit-sticky",xn="sticky",Xn=Kn(()=>{if(typeof document>"u")return xn;const He=document.createElement("div");return He.style.position=Fe,He.style.position===Fe?Fe:xn});function Ye(He){return He}const Qo=U(()=>{const He=v(vt=>`Item ${vt}`),Qe=v(null),it=v(vt=>`Group ${vt}`),lt=v({}),ut=v(Ye),dt=v("div"),xt=v(Yt),ft=(vt,kt=null)=>ct(x(lt,E(St=>St[vt]),Y()),kt);return{components:lt,computeItemKey:ut,context:Qe,EmptyPlaceholder:ft("EmptyPlaceholder"),FooterComponent:ft("Footer"),GroupComponent:ft("Group","div"),groupContent:it,HeaderComponent:ft("Header"),HeaderFooterTag:dt,ItemComponent:ft("Item","div"),itemContent:He,ListComponent:ft("List","div"),ScrollerComponent:ft("Scroller","div"),scrollerRef:xt,ScrollSeekPlaceholder:ft("ScrollSeekPlaceholder"),TopItemListComponent:ft("TopItemList")}}),tr=U(([He,Qe])=>({...He,...Qe}),X(jn,Qo)),er=({height:He})=>jsxRuntimeExports.jsx("div",{style:{height:He}}),nr={overflowAnchor:"none",position:Xn(),zIndex:1},Jn={overflowAnchor:"none"},or={...Jn,display:"inline-block",height:"100%"},Tn=React.memo(function({showTopList:He=!1}){const Qe=M("listState"),it=gt("sizeRanges"),lt=M("useWindowScroll"),ut=M("customScrollParent"),dt=gt("windowScrollContainerState"),xt=gt("scrollContainerState"),ft=ut||lt?dt:xt,vt=M("itemContent"),kt=M("context"),St=M("groupContent"),Tt=M("trackItemSizes"),Mt=M("itemSize"),Nt=M("log"),At=gt("gap"),$t=M("horizontalDirection"),{callbackRef:Dt}=kn(it,Mt,Tt,He?Yt:ft,Nt,At,ut,$t,M("skipAnimationFrameInResizeObserver")),[Ft,Bt]=React.useState(0);Je("deviation",yr=>{Ft!==yr&&Bt(yr)});const Ot=M("EmptyPlaceholder"),Qt=M("ScrollSeekPlaceholder")||er,Wt=M("ListComponent"),Xt=M("ItemComponent"),Kt=M("GroupComponent"),Jt=M("computeItemKey"),hr=M("isSeeking"),xr=M("groupIndices").length>0,gr=M("alignToBottom"),br=M("initialItemFinalLocationReached"),vr=He?{}:{boxSizing:"border-box",...$t?{display:"inline-block",height:"100%",marginLeft:Ft!==0?Ft:gr?"auto":0,paddingLeft:Qe.offsetTop,paddingRight:Qe.offsetBottom,whiteSpace:"nowrap"}:{marginTop:Ft!==0?Ft:gr?"auto":0,paddingBottom:Qe.offsetBottom,paddingTop:Qe.offsetTop},...br?{}:{visibility:"hidden"}};return!He&&Qe.totalCount===0&&Ot?jsxRuntimeExports.jsx(Ot,{...Z(Ot,kt)}):jsxRuntimeExports.jsx(Wt,{...Z(Wt,kt),"data-testid":He?"virtuoso-top-item-list":"virtuoso-item-list",ref:Dt,style:vr,children:(He?Qe.topItems:Qe.items).map(yr=>{const Cr=yr.originalIndex,Rr=Jt(Cr+Qe.firstItemIndex,yr.data,kt);return hr?reactExports.createElement(Qt,{...Z(Qt,kt),height:yr.size,index:yr.index,key:Rr,type:yr.type||"item",...yr.type==="group"?{}:{groupIndex:yr.groupIndex}}):yr.type==="group"?reactExports.createElement(Kt,{...Z(Kt,kt),"data-index":Cr,"data-item-index":yr.index,"data-known-size":yr.size,key:Rr,style:nr},St(yr.index,kt)):reactExports.createElement(Xt,{...Z(Xt,kt),...Qn(Xt,yr.data),"data-index":Cr,"data-item-group-index":yr.groupIndex,"data-item-index":yr.index,"data-known-size":yr.size,key:Rr,style:$t?or:Jn},xr?vt(yr.index,yr.groupIndex,yr.data,kt):vt(yr.index,yr.data,kt))})})}),rr={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},sr={outline:"none",overflowX:"auto",position:"relative"},Zt=He=>({height:"100%",position:"absolute",top:0,width:"100%",...He?{display:"flex",flexDirection:"column"}:{}}),ir={position:Xn(),top:0,width:"100%",zIndex:1};function Z(He,Qe){if(typeof He!="string")return{context:Qe}}function Qn(He,Qe){return{item:typeof He=="string"?void 0:Qe}}const lr=React.memo(function(){const He=M("HeaderComponent"),Qe=gt("headerHeight"),it=M("HeaderFooterTag"),lt=Ht(React.useMemo(()=>dt=>{Qe(wt(dt,"height"))},[Qe]),!0,M("skipAnimationFrameInResizeObserver")),ut=M("context");return He?jsxRuntimeExports.jsx(it,{ref:lt,children:jsxRuntimeExports.jsx(He,{...Z(He,ut)})}):null}),cr=React.memo(function(){const He=M("FooterComponent"),Qe=gt("footerHeight"),it=M("HeaderFooterTag"),lt=Ht(React.useMemo(()=>dt=>{Qe(wt(dt,"height"))},[Qe]),!0,M("skipAnimationFrameInResizeObserver")),ut=M("context");return He?jsxRuntimeExports.jsx(it,{ref:lt,children:jsxRuntimeExports.jsx(He,{...Z(He,ut)})}):null});function Ze({useEmitter:He,useEmitterValue:Qe,usePublisher:it}){return React.memo(function({children:lt,style:ut,...dt}){const xt=it("scrollContainerState"),ft=Qe("ScrollerComponent"),vt=it("smoothScrollTargetReached"),kt=Qe("scrollerRef"),St=Qe("context"),Tt=Qe("horizontalDirection")||!1,{scrollByCallback:Mt,scrollerRef:Nt,scrollToCallback:At}=Zn(xt,vt,ft,kt,void 0,Tt);return He("scrollTo",At),He("scrollBy",Mt),jsxRuntimeExports.jsx(ft,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:Nt,style:{...Tt?sr:rr,...ut},tabIndex:0,...dt,...Z(ft,St),children:lt})})}function Xe({useEmitter:He,useEmitterValue:Qe,usePublisher:it}){return React.memo(function({children:lt,style:ut,...dt}){const xt=it("windowScrollContainerState"),ft=Qe("ScrollerComponent"),vt=it("smoothScrollTargetReached"),kt=Qe("totalListHeight"),St=Qe("deviation"),Tt=Qe("customScrollParent"),Mt=Qe("context"),Nt=React.useRef(null),At=Qe("scrollerRef"),{scrollByCallback:$t,scrollerRef:Dt,scrollToCallback:Ft}=Zn(xt,vt,ft,At,Tt);return Yn(()=>{var Bt;return Dt.current=Tt||((Bt=Nt.current)==null?void 0:Bt.ownerDocument.defaultView),()=>{Dt.current=null}},[Dt,Tt]),He("windowScrollTo",Ft),He("scrollBy",$t),jsxRuntimeExports.jsx(ft,{ref:Nt,"data-virtuoso-scroller":!0,style:{position:"relative",...ut,...kt!==0?{height:kt+St}:{}},...dt,...Z(ft,Mt),children:lt})})}const ur=({children:He})=>{const Qe=React.useContext(be),it=gt("viewportHeight"),lt=gt("fixedItemHeight"),ut=M("alignToBottom"),dt=M("horizontalDirection"),xt=React.useMemo(()=>ne(it,vt=>wt(vt,dt?"width":"height")),[it,dt]),ft=Ht(xt,!0,M("skipAnimationFrameInResizeObserver"));return React.useEffect(()=>{Qe&&(it(Qe.viewportHeight),lt(Qe.itemHeight))},[Qe,it,lt]),jsxRuntimeExports.jsx("div",{"data-viewport-type":"element",ref:ft,style:Zt(ut),children:He})},ar=({children:He})=>{const Qe=React.useContext(be),it=gt("windowViewportRect"),lt=gt("fixedItemHeight"),ut=M("customScrollParent"),dt=_e(it,ut,M("skipAnimationFrameInResizeObserver")),xt=M("alignToBottom");return React.useEffect(()=>{Qe&&(lt(Qe.itemHeight),it({offsetTop:0,visibleHeight:Qe.viewportHeight,visibleWidth:100}))},[Qe,it,lt]),jsxRuntimeExports.jsx("div",{"data-viewport-type":"window",ref:dt,style:Zt(xt),children:He})},dr=({children:He})=>{const Qe=M("TopItemListComponent")||"div",it=M("headerHeight"),lt={...ir,marginTop:`${it}px`},ut=M("context");return jsxRuntimeExports.jsx(Qe,{style:lt,...Z(Qe,ut),children:He})},fr=React.memo(function(He){const Qe=M("useWindowScroll"),it=M("topItemsIndexes").length>0,lt=M("customScrollParent"),ut=M("context"),dt=lt||Qe?pr:mr,xt=lt||Qe?ar:ur;return jsxRuntimeExports.jsxs(dt,{...He,...Z(dt,ut),children:[it&&jsxRuntimeExports.jsx(dr,{children:jsxRuntimeExports.jsx(Tn,{showTopList:!0})}),jsxRuntimeExports.jsxs(xt,{children:[jsxRuntimeExports.jsx(lr,{}),jsxRuntimeExports.jsx(Tn,{}),jsxRuntimeExports.jsx(cr,{})]})]})}),{Component:to$1,useEmitter:Je,useEmitterValue:M,usePublisher:gt}=qe(tr,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},fr),mr=Ze({useEmitter:Je,useEmitterValue:M,usePublisher:gt}),pr=Xe({useEmitter:Je,useEmitterValue:M,usePublisher:gt}),Kr=to$1,jr=to$1,wn={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},Hr={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:vn,floor:Ce,max:ee,min:Oe,round:yn}=Math;function Rn(He,Qe,it){return Array.from({length:Qe-He+1}).map((lt,ut)=>({data:it===null?null:it[ut+He],index:ut+He}))}function Er(He){return{...Hr,items:He}}function he(He,Qe){return He&&He.width===Qe.width&&He.height===Qe.height}function Br(He,Qe){return He&&He.column===Qe.column&&He.row===Qe.row}const kr=U(([{increaseViewportBy:He,listBoundary:Qe,overscan:it,visibleRange:lt},{footerHeight:ut,headerHeight:dt,scrollBy:xt,scrollContainerState:ft,scrollTo:vt,scrollTop:kt,smoothScrollTargetReached:St,viewportHeight:Tt},Mt,Nt,{didMount:At,propsReady:$t},{customScrollParent:Dt,useWindowScroll:Ft,windowScrollContainerState:Bt,windowScrollTo:Ot,windowViewportRect:Qt},Wt])=>{const Xt=v(0),Kt=v(0),Jt=v(wn),hr=v({height:0,width:0}),xr=v({height:0,width:0}),gr=$(),br=$(),vr=v(0),yr=v(null),Cr=v({column:0,row:0}),Rr=$(),Ir=$(),Tr=v(!1),$r=v(0),Zr=v(!0),Sr=v(!1),Dr=v(!1);K(x(At,_($r),P(([Ur,nn])=>!!nn)),()=>{W(Zr,!1)}),K(x(rt(At,Zr,xr,hr,$r,Sr),P(([Ur,nn,Cn,es,,Xr])=>Ur&&!nn&&Cn.height!==0&&es.height!==0&&!Xr)),([,,,,Ur])=>{W(Sr,!0),$e(1,()=>{W(gr,Ur)}),bt(x(kt),()=>{W(Qe,[0,0]),W(Zr,!0)})}),O(x(Ir,P(Ur=>Ur!=null&&Ur.scrollTop>0),yt(0)),Kt),K(x(At,_(Ir),P(([,Ur])=>Ur!=null)),([,Ur])=>{Ur&&(W(hr,Ur.viewport),W(xr,Ur.item),W(Cr,Ur.gap),Ur.scrollTop>0&&(W(Tr,!0),bt(x(kt,jt(1)),nn=>{W(Tr,!1)}),W(vt,{top:Ur.scrollTop})))}),O(x(hr,E(({height:Ur})=>Ur)),Tt),O(x(rt(A(hr,he),A(xr,he),A(Cr,(Ur,nn)=>Ur&&Ur.column===nn.column&&Ur.row===nn.row),A(kt)),E(([Ur,nn,Cn,es])=>({gap:Cn,item:nn,scrollTop:es,viewport:Ur}))),Rr),O(x(rt(A(Xt),lt,A(Cr,Br),A(xr,he),A(hr,he),A(yr),A(Kt),A(Tr),A(Zr),A($r)),P(([,,,,,,,Ur])=>!Ur),E(([Ur,[nn,Cn],es,Xr,en,rn,sn,,os,ls])=>{const{column:rs,row:ss}=es,{height:cs,width:ps}=Xr,{width:hs}=en;if(sn===0&&(Ur===0||hs===0))return wn;if(ps===0){const fs=Ue(ls,Ur),bs=fs+Math.max(sn-1,0);return Er(Rn(fs,bs,rn))}const ns=eo(hs,ps,rs);let tn,ts;os?nn===0&&Cn===0&&sn>0?(tn=0,ts=sn-1):(tn=ns*Ce((nn+ss)/(cs+ss)),ts=ns*vn((Cn+ss)/(cs+ss))-1,ts=Oe(Ur-1,ee(ts,ns-1)),tn=Oe(ts,ee(0,tn))):(tn=0,ts=-1);const as=Rn(tn,ts,rn),{bottom:us,top:ds}=bn(en,es,Xr,as),gs=vn(Ur/ns),xs=gs*cs+(gs-1)*ss-us;return{bottom:us,itemHeight:cs,items:as,itemWidth:ps,offsetBottom:xs,offsetTop:ds,top:ds}})),Jt),O(x(yr,P(Ur=>Ur!==null),E(Ur=>Ur.length)),Xt),O(x(rt(hr,xr,Jt,Cr),P(([Ur,nn,{items:Cn}])=>Cn.length>0&&nn.height!==0&&Ur.height!==0),E(([Ur,nn,{items:Cn},es])=>{const{bottom:Xr,top:en}=bn(Ur,es,nn,Cn);return[en,Xr]}),Y(se)),Qe);const wr=v(!1);O(x(kt,_(wr),E(([Ur,nn])=>nn||Ur!==0)),wr);const qr=ht(x(rt(Jt,Xt),P(([{items:Ur}])=>Ur.length>0),_(wr),P(([[Ur,nn],Cn])=>{const es=Ur.items[Ur.items.length-1].index===nn-1;return(Cn||Ur.bottom>0&&Ur.itemHeight>0&&Ur.offsetBottom===0&&Ur.items.length===nn)&&es}),E(([[,Ur]])=>Ur-1),Y())),Nr=ht(x(A(Jt),P(({items:Ur})=>Ur.length>0&&Ur[0].index===0),yt(0),Y())),Jr=ht(x(A(Jt),_(Tr),P(([{items:Ur},nn])=>Ur.length>0&&!nn),E(([{items:Ur}])=>({endIndex:Ur[Ur.length-1].index,startIndex:Ur[0].index})),Y(Pn),Lt(0)));O(Jr,Nt.scrollSeekRangeChanged),O(x(gr,_(hr,xr,Xt,Cr),E(([Ur,nn,Cn,es,Xr])=>{const en=_n(Ur),{align:rn,behavior:sn,offset:os}=en;let ls=en.index;ls==="LAST"&&(ls=es-1),ls=ee(0,ls,Oe(es-1,ls));let rs=Ae(nn,Xr,Cn,ls);return rn==="end"?rs=yn(rs-nn.height+Cn.height):rn==="center"&&(rs=yn(rs-nn.height/2+Cn.height/2)),os&&(rs+=os),{behavior:sn,top:rs}})),vt);const Qr=ct(x(Jt,E(Ur=>Ur.offsetBottom+Ur.bottom)),0);return O(x(Qt,E(Ur=>({height:Ur.visibleHeight,width:Ur.visibleWidth}))),hr),{customScrollParent:Dt,data:yr,deviation:vr,footerHeight:ut,gap:Cr,headerHeight:dt,increaseViewportBy:He,initialItemCount:Kt,itemDimensions:xr,overscan:it,restoreStateFrom:Ir,scrollBy:xt,scrollContainerState:ft,scrollHeight:br,scrollTo:vt,scrollToIndex:gr,scrollTop:kt,smoothScrollTargetReached:St,totalCount:Xt,useWindowScroll:Ft,viewportDimensions:hr,windowScrollContainerState:Bt,windowScrollTo:Ot,windowViewportRect:Qt,...Nt,gridState:Jt,horizontalDirection:Dr,initialTopMostItemIndex:$r,totalListHeight:Qr,...Mt,endReached:qr,propsReady:$t,rangeChanged:Jr,startReached:Nr,stateChanged:Rr,stateRestoreInProgress:Tr,...Wt}},X(Ke,at$1,ae,Un,Pt,je,Vt));function eo(He,Qe,it){return ee(1,Ce((He+it)/(Ce(Qe)+it)))}function bn(He,Qe,it,lt){const{height:ut}=it;if(ut===void 0||lt.length===0)return{bottom:0,top:0};const dt=Ae(He,Qe,it,lt[0].index);return{bottom:Ae(He,Qe,it,lt[lt.length-1].index)+ut,top:dt}}function Ae(He,Qe,it,lt){const ut=eo(He.width,it.width,Qe.column),dt=Ce(lt/ut),xt=dt*it.height+ee(0,dt-1)*Qe.row;return xt>0?xt+Qe.row:xt}const Fr=U(()=>{const He=v(Tt=>`Item ${Tt}`),Qe=v({}),it=v(null),lt=v("virtuoso-grid-item"),ut=v("virtuoso-grid-list"),dt=v(Ye),xt=v("div"),ft=v(Yt),vt=(Tt,Mt=null)=>ct(x(Qe,E(Nt=>Nt[Tt]),Y()),Mt),kt=v(!1),St=v(!1);return O(A(St),kt),{components:Qe,computeItemKey:dt,context:it,FooterComponent:vt("Footer"),HeaderComponent:vt("Header"),headerFooterTag:xt,itemClassName:lt,ItemComponent:vt("Item","div"),itemContent:He,listClassName:ut,ListComponent:vt("List","div"),readyStateChanged:kt,reportReadyState:St,ScrollerComponent:vt("Scroller","div"),scrollerRef:ft,ScrollSeekPlaceholder:vt("ScrollSeekPlaceholder","div")}}),Or=U(([He,Qe])=>({...He,...Qe}),X(kr,Fr)),Lr=React.memo(function(){const He=et("gridState"),Qe=et("listClassName"),it=et("itemClassName"),lt=et("itemContent"),ut=et("computeItemKey"),dt=et("isSeeking"),xt=It("scrollHeight"),ft=et("ItemComponent"),vt=et("ListComponent"),kt=et("ScrollSeekPlaceholder"),St=et("context"),Tt=It("itemDimensions"),Mt=It("gap"),Nt=et("log"),At=et("stateRestoreInProgress"),$t=It("reportReadyState"),Dt=Ht(React.useMemo(()=>Ft=>{const Bt=Ft.parentElement.parentElement.scrollHeight;xt(Bt);const Ot=Ft.firstChild;if(Ot){const{height:Qt,width:Wt}=Ot.getBoundingClientRect();Tt({height:Qt,width:Wt})}Mt({column:Hn("column-gap",getComputedStyle(Ft).columnGap,Nt),row:Hn("row-gap",getComputedStyle(Ft).rowGap,Nt)})},[xt,Tt,Mt,Nt]),!0,!1);return Yn(()=>{He.itemHeight>0&&He.itemWidth>0&&$t(!0)},[He]),At?null:jsxRuntimeExports.jsx(vt,{className:Qe,ref:Dt,...Z(vt,St),"data-testid":"virtuoso-item-list",style:{paddingBottom:He.offsetBottom,paddingTop:He.offsetTop},children:He.items.map(Ft=>{const Bt=ut(Ft.index,Ft.data,St);return dt?jsxRuntimeExports.jsx(kt,{...Z(kt,St),height:He.itemHeight,index:Ft.index,width:He.itemWidth},Bt):reactExports.createElement(ft,{...Z(ft,St),className:it,"data-index":Ft.index,key:Bt},lt(Ft.index,Ft.data,St))})})}),zr=React.memo(function(){const He=et("HeaderComponent"),Qe=It("headerHeight"),it=et("headerFooterTag"),lt=Ht(React.useMemo(()=>dt=>{Qe(wt(dt,"height"))},[Qe]),!0,!1),ut=et("context");return He?jsxRuntimeExports.jsx(it,{ref:lt,children:jsxRuntimeExports.jsx(He,{...Z(He,ut)})}):null}),Vr=React.memo(function(){const He=et("FooterComponent"),Qe=It("footerHeight"),it=et("headerFooterTag"),lt=Ht(React.useMemo(()=>dt=>{Qe(wt(dt,"height"))},[Qe]),!0,!1),ut=et("context");return He?jsxRuntimeExports.jsx(it,{ref:lt,children:jsxRuntimeExports.jsx(He,{...Z(He,ut)})}):null}),Pr=({children:He})=>{const Qe=React.useContext(qn),it=It("itemDimensions"),lt=It("viewportDimensions"),ut=Ht(React.useMemo(()=>dt=>{lt(dt.getBoundingClientRect())},[lt]),!0,!1);return React.useEffect(()=>{Qe&&(lt({height:Qe.viewportHeight,width:Qe.viewportWidth}),it({height:Qe.itemHeight,width:Qe.itemWidth}))},[Qe,lt,it]),jsxRuntimeExports.jsx("div",{ref:ut,style:Zt(!1),children:He})},Ar=({children:He})=>{const Qe=React.useContext(qn),it=It("windowViewportRect"),lt=It("itemDimensions"),ut=et("customScrollParent"),dt=_e(it,ut,!1);return React.useEffect(()=>{Qe&&(lt({height:Qe.itemHeight,width:Qe.itemWidth}),it({offsetTop:0,visibleHeight:Qe.viewportHeight,visibleWidth:Qe.viewportWidth}))},[Qe,it,lt]),jsxRuntimeExports.jsx("div",{ref:dt,style:Zt(!1),children:He})},Mr=React.memo(function({...He}){const Qe=et("useWindowScroll"),it=et("customScrollParent"),lt=it||Qe?_r:Gr,ut=it||Qe?Ar:Pr,dt=et("context");return jsxRuntimeExports.jsx(lt,{...He,...Z(lt,dt),children:jsxRuntimeExports.jsxs(ut,{children:[jsxRuntimeExports.jsx(zr,{}),jsxRuntimeExports.jsx(Lr,{}),jsxRuntimeExports.jsx(Vr,{})]})})}),{Component:Wr,useEmitter:no,useEmitterValue:et,usePublisher:It}=qe(Or,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},Mr),Gr=Ze({useEmitter:no,useEmitterValue:et,usePublisher:It}),_r=Xe({useEmitter:no,useEmitterValue:et,usePublisher:It});function Hn(He,Qe,it){return Qe!=="normal"&&!(Qe!=null&&Qe.endsWith("px"))&&it(`${He} was not resolved to pixel value correctly`,Qe,mt.WARN),Qe==="normal"?0:parseInt(Qe??"0",10)}const Yr=Wr,useGetMessage=modifyQueryHook(createQueryHook(GetMessageDocument),{transform:He=>({id:He}),reduce:He=>He?.message}),useInfiniteListMessages=infiniteQueryHook(modifyQueryHook(createQueryHook(ListMessagesDocument),{reduce:He=>He?.messages})),[useSendMessage,executeSendMessage]=createMutationHelper(SendMessageDocument,{update:(He,Qe)=>{const it=Qe.data?.sendMessage;it&&He.updateQuery({query:ListMessagesDocument,variables:{topicId:it.topicId}},produce(lt=>{if(lt==null)return lt;const ut=createLocalCursor();lt.messages.edges?.push({node:it,cursor:ut}),lt.messages.pageInfo.endCursor=ut}))}}),[useDeleteMessage,executeDeleteMessage]=createMutationHelper(DeleteMessageDocument,{update:(He,Qe,{variables:it})=>{const lt=Qe.errors,ut=it?.messageId;if(ut!=null&&(lt?.length??0)<=0){const dt=He.identify({__typename:"Message",id:ut}),xt=He.readFragment({fragment:MessageBaseFragmentDoc,fragmentName:"MessageBase",id:dt});xt&&He.updateQuery({query:ListMessagesDocument,variables:{topicId:xt.topicId}},produce(ft=>{if(ft==null)return ft;for(const[vt,kt]of ft.messages.edges?.entries()??[])if(kt?.node?.id===ut){ft.messages.edges?.splice(vt,1);break}ft.messages.pageInfo.endCursor=ft.messages.edges?.at(-1)?.cursor,ft.messages.pageInfo.startCursor=ft.messages.edges?.at(0)?.cursor})),He.evict({id:dt}),He.gc()}}}),defaultFlags={isMinors:!1,isSensitive:!1};function getCommentTextModerationInfo(He){const Qe={...defaultFlags,...He?.textModerationInfo??{}},it=Qe.isMinors||Qe.isSensitive;return{...Qe,isFlagged:it}}const fluentChevronDown20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M15.794 7.733a.75.75 0 0 1-.026 1.06l-5.25 5.001a.75.75 0 0 1-1.035 0l-5.25-5a.75.75 0 0 1 1.034-1.087l4.734 4.509l4.733-4.51a.75.75 0 0 1 1.06.027"})}),fluentDismiss20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m3.897 4.054l.073-.084a.75.75 0 0 1 .976-.073l.084.073L10 8.939l4.97-4.97a.75.75 0 0 1 .976-.072l.084.073a.75.75 0 0 1 .073.976l-.073.084L11.061 10l4.97 4.97a.75.75 0 0 1 .072.976l-.073.084a.75.75 0 0 1-.976.073l-.084-.073L10 11.061l-4.97 4.97a.75.75 0 0 1-.976.072l-.084-.073a.75.75 0 0 1-.073-.976l.073-.084L8.939 10l-4.97-4.97a.75.75 0 0 1-.072-.976l.073-.084z"})}),fluentPerson24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17.755 14a2.25 2.25 0 0 1 2.248 2.25v.918a2.75 2.75 0 0 1-.512 1.598c-1.546 2.164-4.07 3.235-7.49 3.235c-3.422 0-5.945-1.072-7.487-3.236a2.75 2.75 0 0 1-.51-1.596v-.92A2.25 2.25 0 0 1 6.253 14zM12 2.005a5 5 0 1 1 0 10a5 5 0 0 1 0-10"})}),fluentSend24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m12.815 12.197l-7.532 1.255a.5.5 0 0 0-.386.318L2.3 20.728c-.248.64.421 1.25 1.035.942l18-9a.75.75 0 0 0 0-1.341l-18-9c-.614-.307-1.283.303-1.035.942l2.598 6.958a.5.5 0 0 0 .386.318l7.532 1.255a.2.2 0 0 1 0 .395"})}),CommentContext=reactExports.createContext(void 0);function CommentProvider(He){const{data:Qe,loading:it,fetchMore:lt,loadingMore:ut}=useInfiniteListMessages(He.topicId?{topicId:He.topicId,last:He.initLoadSize??10}:skipToken),dt=Qe?.pageInfo?.hasPreviousPage??!0,xt=reactExports.useMemo(()=>getNodesFromConnection(Qe).filter(Nt=>Nt!=null).reverse()??[],[Qe]),ft=reactExports.useMemo(()=>new Map,[]),vt=useNavigate();reactExports.useEffect(()=>{for(const Nt of xt)Nt&&ft.set(Nt.id,Nt)},[xt,ft]);function kt(Nt){dt&&(lt({variables:{before:Qe?.pageInfo.startCursor,last:Nt}}),He.onLoadMore?.())}const St=async(Nt,At=He.refType)=>{At&&await deleteMessage(Nt,At)},Tt=reactExports.useMemo(createComposerStateAtom,[]),Mt=async(Nt,At)=>{if(He.topicId)try{const $t=await sendMessage(He.topicId,Nt,At);track("send_message",{type:He.scene,isReply:!!At})}catch($t){return getErrorData($t)?.code===40300012?await UIDialog.alert({heading:jsxRuntimeExports.jsx(Text,{i18nKey:"comment:actions.send-comment.verify-email.title"}),content:jsxRuntimeExports.jsx(Text,{i18nKey:"comment:actions.send-comment.verify-email.content"}),confirmProps:{onPress:()=>{vt("/profile/edit/accounts")},children:jsxRuntimeExports.jsx(Text,{i18nKey:"comment:actions.verify-now"})}}):toast.error(jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Text,{i18nKey:"comment:actions.send-comment.messages.failed"}),` (${String($t)})`]})),Promise.reject($t)}};return jsxRuntimeExports.jsx(CommentContext.Provider,{value:{refType:He.refType,messages:xt,messageCache:ft,havingMore:dt,loading:it||ut,loadMore:kt,canDeleteMessage:He.canDeleteMessage,deleteMessage:St,composerStateAtom:Tt,sendMessage:Mt},children:He.children})}function CommentItem(He){const{id:Qe,author:it,createdAt:lt,content:ut,replyToMessageId:dt="",extra:xt}=He.message,{isFlagged:ft}=getCommentTextModerationInfo(xt),vt=it?createProfileUrl(it):void 0,{me:kt,beingAdmin:St}=useMe(),Tt=kt!=null&&kt.id===it?.id,Mt=reactExports.useContext(CommentContext),Nt=He.refType??Mt?.refType,At=He.canDeleteMessage??Mt?.canDeleteMessage,$t=useSetImmerAtom(Mt?.composerStateAtom??createComposerStateAtom()),[{loading:Dt},Ft]=useAsyncFn(async()=>{try{Mt?await Mt.deleteMessage(Qe,Nt):He.refType&&(await deleteMessage(Qe,He.refType),He.onDelete?.())}catch{toast.error(jsxRuntimeExports.jsx(Text,{i18nKey:"comment:notice.delete.failed"}))}},[]);async function Bt(){if(!Nt)return;await dialogConfirm({title:jsxRuntimeExports.jsx(Text,{i18nKey:"comment:delete.confirm-dialog.title"}),description:jsxRuntimeExports.jsx(Text,{i18nKey:"comment:delete.confirm-dialog.description"})}).then(()=>!0,()=>!1)&&await Ft()}return jsxRuntimeExports.jsxs("div",{"data-message-id":Qe,className:cx("grid grid-cols-[auto_1fr] items-start gap-4 text-sm",Dt&&"opacity-50 pointer-events-none",He.className),style:He.style,children:[jsxRuntimeExports.jsx(UILink,{href:vt,onPress:()=>track("user_link_click"),children:jsxRuntimeExports.jsx(UserAvatar,{user:it,className:"!size-10"})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsx(UILink,{href:vt,className:"px-1 -mx-1 font-semibold rounded",onPress:()=>track("user_link_click"),children:getUserDisplayName(it)}),jsxRuntimeExports.jsx("time",{dateTime:defaultDayjs(lt).toISOString(),className:"text-neutral-500",children:defaultDayjs(lt).format("lll")})]}),dt&&jsxRuntimeExports.jsx(RepliedComment,{messageId:dt,className:"mt-2 mb-1"}),ft?jsxRuntimeExports.jsx(NulledComment,{displayText:jsxRuntimeExports.jsx(Text,{i18nKey:"comment:content.flagged-hidden"}),hoverText:kt?ut:void 0}):jsxRuntimeExports.jsx("article",{className:"text-neutral-800 dark:text-neutral-200",children:ut}),jsxRuntimeExports.jsxs("div",{className:"mt-1 flex gap-2",children:[Mt&&!ft&&jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",size:"small",className:"px-2 -ml-2 py-1 -mt-1 text-black dark:text-white",onPress:()=>{$t(Ot=>{Ot.replyTo=Qe})},children:jsxRuntimeExports.jsx(Text,{i18nKey:"comment:reply.label"})}),(Tt||St||At?.(He.message))&&Nt&&jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",size:"small",color:"danger",className:"px-2 -ml-2 py-1 -mt-1 text-black hover:text-red-600 dark:text-white dark:hover:text-red-500",onPress:Bt,children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:delete.label"})})]})]})]})}function NulledComment({displayText:He,hoverText:Qe}){const[it,lt]=reactExports.useState(!1);return jsxRuntimeExports.jsx("span",{className:it?"opacity-50":"uppercase opacity-50",onMouseEnter:()=>lt(!0),onMouseLeave:()=>lt(!1),children:it&&Qe?Qe:He})}function RepliedCommentContainer({className:He,style:Qe,children:it}){return jsxRuntimeExports.jsx("div",{className:cx("pl-2 border-l-2 border-black/50 dark:border-white/50",He),style:Qe,children:it})}function RepliedComment({messageId:He,className:Qe,style:it}){const lt=reactExports.useContext(CommentContext),{me:ut}=useMe(),{data:dt,loading:xt}=useGetMessage(lt?.messageCache.has(He)?skipToken:He),ft=dt??lt?.messageCache.get(He),{isFlagged:vt}=getCommentTextModerationInfo(ft?.extra),kt={className:Qe,style:it};return xt?jsxRuntimeExports.jsx(RepliedCommentContainer,{...kt,children:jsxRuntimeExports.jsx(fluentSpinnerIos20Filled,{className:"size-5 animate-spin"})}):ft?vt?jsxRuntimeExports.jsx(RepliedCommentContainer,{...kt,children:jsxRuntimeExports.jsx(NulledComment,{displayText:jsxRuntimeExports.jsx(Text,{i18nKey:"comment:content.flagged-hidden"}),hoverText:ut?ft.content:void 0})}):jsxRuntimeExports.jsxs(RepliedCommentContainer,{...kt,children:[jsxRuntimeExports.jsxs("p",{className:"text-neutral-500",children:[jsxRuntimeExports.jsx(Text,{i18nKey:"comment:reply.reply-to.label"})," ",jsxRuntimeExports.jsx(UILink,{href:ft.author?createProfileUrl(ft.author):void 0,className:"px-1 -mx-1 font-semibold rounded",onPress:()=>track("user_link_click"),children:getUserDisplayName(ft.author)})]}),jsxRuntimeExports.jsx("article",{className:"line-clamp-3 text-neutral-600 dark:text-neutral-400",children:ft.content})]}):jsxRuntimeExports.jsx(RepliedCommentContainer,{...kt,children:jsxRuntimeExports.jsx(NulledComment,{displayText:jsxRuntimeExports.jsx(Text,{i18nKey:"comment:notice.delete.success"})})})}const DEFAULT_LOAD_SIZE=30;function CommentList(He){const{messages:Qe,loadMore:it}=reactExports.useContext(CommentContext)??ensureContext(),lt={loadMode:He.loadMode??"button"};return He.windowed?jsxRuntimeExports.jsx(Kr,{data:Qe,context:lt,components:virtuosoComponents,itemContent:(ut,dt)=>jsxRuntimeExports.jsx(CommentItem,{message:dt}),className:He.className,style:He.style,endReached:()=>{He.loadMode==="scroll"&&it(DEFAULT_LOAD_SIZE)}}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(virtuosoComponents.List,{context:lt,"data-testid":"",children:Qe.map(ut=>jsxRuntimeExports.jsx(CommentItem,{message:ut},ut.id))}),jsxRuntimeExports.jsx(virtuosoComponents.Footer,{context:lt})]})}const virtuosoComponents={List:reactExports.forwardRef(function He(Qe,it){return jsxRuntimeExports.jsx("div",{ref:it,...Qe,className:"flex flex-col gap-4"})}),Footer:({context:He})=>{const{messages:Qe,havingMore:it,loading:lt,loadMore:ut}=reactExports.useContext(CommentContext)??ensureContext(),{loadMode:dt}=He??shouldNotHappen();return jsxRuntimeExports.jsx("div",{className:cx("pl-14 text-sm",Qe.length>0&&"mt-3"),children:jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",size:"small",busy:lt,disabled:!it,icon:it?jsxRuntimeExports.jsx(fluentChevronDown20Filled,{className:"size-5"}):null,className:cx("pl-1 -ml-2 pr-2 py-1 gap-1",!it&&"text-neutral-500"),onPress:()=>{dt==="button"&&ut(DEFAULT_LOAD_SIZE)},children:lt?jsxRuntimeExports.jsx(Text,{i18nKey:"common:hint.loading"}):it?jsxRuntimeExports.jsx(Text,{i18nKey:"action:load-more"}):Qe.length?jsxRuntimeExports.jsx(Text,{i18nKey:"common:list-reached-the-end"}):jsxRuntimeExports.jsx(Text,{i18nKey:"comment:leave-comments-here"})})})}},createComposerStateAtom=()=>atom({replyTo:void 0}),inputStyle=ce$1({base:"px-2 py-2.5 min-h-10 max-h-20 overflow-auto whitespace-pre-line bg-transparent outline-none"});function CommentComposer(He){const{t:Qe}=useTranslation(["comment"]),{me:it}=useMe(),[lt,ut]=reactExports.useState(""),dt=reactExports.useRef(null),{composerStateAtom:xt,sendMessage:ft}=reactExports.useContext(CommentContext)??ensureContext(),[vt,kt]=useImmerAtom(xt);return reactExports.useEffect(()=>{vt.replyTo&&dt.current?.focus()},[vt.replyTo]),jsxRuntimeExports.jsxs("div",{className:cx("flex items-start gap-4 text-sm",He.className),style:He.style,children:[jsxRuntimeExports.jsx("div",{className:"flex-none",children:it?jsxRuntimeExports.jsx(UserAvatar,{user:it,className:"!size-10"}):jsxRuntimeExports.jsx("div",{className:"grid place-content-center size-10 bg-zinc-200 rounded-full",children:jsxRuntimeExports.jsx(fluentPerson24Filled,{className:"size-6"})})}),jsxRuntimeExports.jsx("div",{className:cx("flex-1 -mx-2 rounded-md ring-1 focus-within:outline outline-2 outline-offset-2","focus-within:bg-white ring-zinc-300 focus-within:ring-zinc-300/50 outline-black","dark:focus-within:bg-black dark:ring-zinc-600 dark:focus-within:ring-zinc-600/50 dark:outline-white"),children:it?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[vt.replyTo&&jsxRuntimeExports.jsxs("div",{className:"flex items-start p-2 bg-black/5 dark:bg-white/5 border-b border-zinc-300 dark:border-zinc-600 rounded-t-md",children:[jsxRuntimeExports.jsx(RepliedComment,{messageId:vt.replyTo,className:"flex-1"}),jsxRuntimeExports.jsx("button",{className:"flex-none p-1 -m-1 ml-0 hover:bg-black/5 dark:hover:bg-white/5 rounded",onClick:()=>{kt(St=>{St.replyTo=void 0})},children:jsxRuntimeExports.jsx(fluentDismiss20Filled,{className:"size-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("div",{className:inputStyle({className:"invisible"}),children:[lt,"‍"]}),jsxRuntimeExports.jsx($216918bed6669f72$export$f5c9f3c2c4054eec,{ref:dt,value:lt,placeholder:Qe("comment:send-message-placeholder"),className:inputStyle({className:"absolute inset-0 h-full resize-none"}),onChange:St=>ut(St.target.value)})]})]}):jsxRuntimeExports.jsx("button",{className:inputStyle({className:"w-full"}),onClick:()=>{track("login_comment_click"),ensureLogIn({fromPath:"comment"}).catch(noop$6)},children:jsxRuntimeExports.jsx(Text,{i18nKey:"comment:login-to-comment"})})}),jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",size:"large",busy:"auto",disabled:!lt.trim(),icon:jsxRuntimeExports.jsx(fluentSend24Filled,{className:"size-6"}),className:"flex-none grid-cols-1 place-items-center size-10",onPress:async()=>{if(lt.trim())try{await ft(lt,vt.replyTo),ut(""),kt(St=>{St.replyTo=void 0})}catch{}}})]})}function ensureContext(){throwError("This component should be within a <CommentProvider>")}async function sendMessage(He,Qe,it){return Qe=Qe.trim(),Qe?(await executeSendMessage({topicId:He,input:{type:"TEXT",content:Qe,replyToMessageId:it}})).data?.sendMessage:void 0}async function deleteMessage(He,Qe){await executeDeleteMessage({messageId:He,topicRefType:Qe})}const mergePromptsWithTriggerWords=(He,Qe,it)=>{if(it)return He;if(Qe instanceof Array){const lt=Qe.map(ut=>ut.triggerWords).filter(ut=>ut).join();return He?`${He},${lt}`:lt}return He},getArtworkParameters=(He,Qe)=>{const it={...He?.extra?.externalParameters,...Qe?.parameters,...isT2I2VTask(Qe)?{}:Qe?.outputs?.detailParameters},lt=getNaturalPrompts(He,Qe),ut=He?.prompts??(He?.hidePrompts?void 0:Qe?.parameters?.prompts);return{...lt&&!He?.hidePrompts?{prompts:mergePromptsWithTriggerWords(lt,it.loraParameters,He?.hidePrompts),enablePromptsRewrite:!0}:{prompts:mergePromptsWithTriggerWords(ut,it.loraParameters,He?.hidePrompts),enablePromptsRewrite:!1},negativePrompts:it.negativePrompts||it.negative_prompt,samplingSteps:it.samplingSteps||it.steps,samplingMethod:it.samplingMethod||it.sample,cfgScale:it.cfgScale||it.cfg_scale,seed:Qe?.parameters?.seed,modelId:Qe?.parameters?.modelId,controlNets:Qe?.parameters?.controlNets??[],lora:it.lora,upscale:it.upscale,upscaleDenoisingSteps:it.upscaleDenoisingSteps,upscaleDenoisingStrength:it.upscaleDenoisingStrength,batchSize:it.batchSize==null?1:it.batchSize===3?4:it.batchSize,enableADetailer:it.enableADetailer,clipSkip:it.clipSkip,vaeModelId:it.vaeModelId,ipAdapter:it.ipAdapter?{...it.ipAdapter,imagesAreValid:!0}:void 0,qualityTag:it.qualityTag?it.qualityTag:void 0,characterId:it.characterId,styleMix:it.styleMix?.enabled?it.styleMix:void 0,lightning:it.lightning,inferenceConfig:it.inferenceConfig}};function getNaturalPrompts(He,Qe){return He?.extra?.naturalPrompts||Qe?.parameters?.extra?.naturalPrompts}async function deleteArtwork(He,Qe){if(await dialogConfirm(defaults$2(Qe?.dialogProps,{title:reactExports.createElement(Text,{i18nKey:"artwork:delete-artwork.confirm.title"}),description:reactExports.createElement(Text,{i18nKey:"artwork:delete-artwork.confirm.content",values:{count:1}}),confirmLabel:reactExports.createElement(Text,{i18nKey:"action:delete.label"}),ConfirmButtonProps:{color:"error",className:"font-bold"}})).then(()=>!0,()=>!1))try{return await executeDeleteArtwork({id:He}),toast.success(reactExports.createElement(Text,{i18nKey:"user:collection.notice.delete.success"})),!0}catch(lt){return toast.error(reactExports.createElement("p",null,reactExports.createElement(Text,{i18nKey:"user:collection.notice.delete.failed"}),` (${String(lt)})`)),!1}}const fluentDatabaseSearch20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M4 5c0-1.007.875-1.755 1.904-2.223C6.978 2.289 8.427 2 10 2s3.022.289 4.096.777C15.125 3.245 16 3.993 16 5v4.758a4.5 4.5 0 0 0-1-.502V6.698a5 5 0 0 1-.904.525C13.022 7.711 11.573 8 10 8s-3.022-.289-4.096-.777A5 5 0 0 1 5 6.698V15c0 .374.356.875 1.318 1.313c.916.416 2.218.687 3.682.687q.33 0 .65-.018c.447.367.966.65 1.534.822c-.68.127-1.417.196-2.184.196c-1.573 0-3.022-.289-4.096-.777C4.875 16.755 4 16.007 4 15zm1 0c0 .374.356.875 1.318 1.313C7.234 6.729 8.536 7 10 7s2.766-.27 3.682-.687C14.644 5.875 15 5.373 15 5c0-.374-.356-.875-1.318-1.313C12.766 3.271 11.464 3 10 3s-2.766.27-3.682.687C5.356 4.125 5 4.627 5 5m8.5 12c.786 0 1.512-.26 2.096-.697l2.55 2.55a.5.5 0 1 0 .708-.707l-2.55-2.55A3.5 3.5 0 1 0 13.5 17m0-1a2.5 2.5 0 1 1 0-5a2.5 2.5 0 0 1 0 5"})}),fluentTextboxSettings20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M6.5 6a.5.5 0 0 0 0 1h7a.5.5 0 0 0 0-1zM6 9.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5m.5 2.5a.5.5 0 0 0 0 1h2.707q.149-.524.393-1zm-1 4h3.707q.149.524.393 1H5.5A2.5 2.5 0 0 1 3 14.5v-9A2.5 2.5 0 0 1 5.5 3h9A2.5 2.5 0 0 1 17 5.5v4.1a5.5 5.5 0 0 0-1-.393V5.5A1.5 1.5 0 0 0 14.5 4h-9A1.5 1.5 0 0 0 4 5.5v9A1.5 1.5 0 0 0 5.5 16m6.565-4.558a2 2 0 0 1-1.43 2.478l-.461.118a4.7 4.7 0 0 0 .01 1.016l.35.083a2 2 0 0 1 1.455 2.519l-.126.423q.387.306.835.517l.325-.344a2 2 0 0 1 2.909.002l.337.358q.44-.203.822-.498l-.156-.556a2 2 0 0 1 1.43-2.478l.461-.118a4.7 4.7 0 0 0-.01-1.017l-.349-.082a2 2 0 0 1-1.456-2.52l.126-.421a4.3 4.3 0 0 0-.835-.519l-.324.344a2 2 0 0 1-2.91-.001l-.337-.358a4.3 4.3 0 0 0-.822.497zM14.5 15.5a1 1 0 1 1 0-2a1 1 0 0 1 0 2"})}),icRoundFlag=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m14.4 6l-.24-1.2c-.09-.46-.5-.8-.98-.8H6c-.55 0-1 .45-1 1v15c0 .55.45 1 1 1s1-.45 1-1v-6h5.6l.24 1.2c.09.47.5.8.98.8H19c.55 0 1-.45 1-1V7c0-.55-.45-1-1-1h-4.6z"})});function validateFormName(He){if(!/^[0-9a-zA-Z-]+$/.test(He))throw new Error(`[@mantine/use-form] Form name "${He}" is invalid, it should contain only letters, numbers and dashes`)}const useIsomorphicEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function useFormEvent(He,Qe){useIsomorphicEffect(()=>{if(He)return window.addEventListener(He,Qe),()=>window.removeEventListener(He,Qe)},[He])}function useFormActions(He,Qe){He&&validateFormName(He),useFormEvent(`mantine-form:${He}:set-field-value`,it=>Qe.setFieldValue(it.detail.path,it.detail.value)),useFormEvent(`mantine-form:${He}:set-values`,it=>Qe.setValues(it.detail)),useFormEvent(`mantine-form:${He}:set-initial-values`,it=>Qe.setInitialValues(it.detail)),useFormEvent(`mantine-form:${He}:set-errors`,it=>Qe.setErrors(it.detail)),useFormEvent(`mantine-form:${He}:set-field-error`,it=>Qe.setFieldError(it.detail.path,it.detail.error)),useFormEvent(`mantine-form:${He}:clear-field-error`,it=>Qe.clearFieldError(it.detail)),useFormEvent(`mantine-form:${He}:clear-errors`,Qe.clearErrors),useFormEvent(`mantine-form:${He}:reset`,Qe.reset),useFormEvent(`mantine-form:${He}:validate`,Qe.validate),useFormEvent(`mantine-form:${He}:validate-field`,it=>Qe.validateField(it.detail)),useFormEvent(`mantine-form:${He}:reorder-list-item`,it=>Qe.reorderListItem(it.detail.path,it.detail.payload)),useFormEvent(`mantine-form:${He}:remove-list-item`,it=>Qe.removeListItem(it.detail.path,it.detail.index)),useFormEvent(`mantine-form:${He}:insert-list-item`,it=>Qe.insertListItem(it.detail.path,it.detail.item,it.detail.index)),useFormEvent(`mantine-form:${He}:set-dirty`,it=>Qe.setDirty(it.detail)),useFormEvent(`mantine-form:${He}:set-touched`,it=>Qe.setTouched(it.detail)),useFormEvent(`mantine-form:${He}:reset-dirty`,it=>Qe.resetDirty(it.detail)),useFormEvent(`mantine-form:${He}:reset-touched`,Qe.resetTouched)}function getInputOnChange(He){return Qe=>{if(!Qe)He(Qe);else if(typeof Qe=="function")He(Qe);else if(typeof Qe=="object"&&"nativeEvent"in Qe){const{currentTarget:it}=Qe;it instanceof HTMLInputElement?it.type==="checkbox"?He(it.checked):He(it.value):(it instanceof HTMLTextAreaElement||it instanceof HTMLSelectElement)&&He(it.value)}else He(Qe)}}function filterErrors(He){return He===null||typeof He!="object"?{}:Object.keys(He).reduce((Qe,it)=>{const lt=He[it];return lt!=null&&lt!==!1&&(Qe[it]=lt),Qe},{})}function useFormErrors(He){const[Qe,it]=reactExports.useState(filterErrors(He)),lt=reactExports.useRef(Qe),ut=reactExports.useCallback(vt=>{it(kt=>{const St=filterErrors(typeof vt=="function"?vt(kt):vt);return lt.current=St,St})},[]),dt=reactExports.useCallback(()=>ut({}),[]),xt=reactExports.useCallback(vt=>{lt.current[vt]!==void 0&&ut(kt=>{const St={...kt};return delete St[vt],St})},[Qe]),ft=reactExports.useCallback((vt,kt)=>{kt==null||kt===!1?xt(vt):lt.current[vt]!==kt&&ut(St=>({...St,[vt]:kt}))},[Qe]);return{errorsState:Qe,setErrors:ut,clearErrors:dt,setFieldError:ft,clearFieldError:xt}}function clearListState(He,Qe){if(Qe===null||typeof Qe!="object")return{};const it={...Qe};return Object.keys(Qe).forEach(lt=>{lt.includes(`${String(He)}.`)&&delete it[lt]}),it}function getIndexFromKeyAfterPath(He,Qe){const it=He.substring(Qe.length+1).split(".")[0];return parseInt(it,10)}function changeErrorIndices(He,Qe,it,lt){if(Qe===void 0)return it;const ut=`${String(He)}`;let dt=it;lt===-1&&(dt=clearListState(`${ut}.${Qe}`,dt));const xt={...dt},ft=new Set;return Object.entries(dt).filter(([vt])=>{if(!vt.startsWith(`${ut}.`))return!1;const kt=getIndexFromKeyAfterPath(vt,ut);return Number.isNaN(kt)?!1:kt>=Qe}).forEach(([vt,kt])=>{const St=getIndexFromKeyAfterPath(vt,ut),Tt=vt.replace(`${ut}.${St}`,`${ut}.${St+lt}`);xt[Tt]=kt,ft.add(Tt),ft.has(vt)||delete xt[vt]}),xt}function reorderErrors(He,{from:Qe,to:it},lt){const ut=`${He}.${Qe}`,dt=`${He}.${it}`,xt={...lt},ft=new Set;return Object.keys(lt).forEach(vt=>{if(ft.has(vt))return;let kt,St;if(vt.startsWith(ut)?(kt=vt,St=vt.replace(ut,dt)):vt.startsWith(dt)&&(kt=vt.replace(dt,ut),St=vt),kt&&St){const Tt=xt[kt],Mt=xt[St];Mt===void 0?delete xt[kt]:xt[kt]=Mt,Tt===void 0?delete xt[St]:xt[St]=Tt,ft.add(kt),ft.add(St)}}),xt}function set$2(He,Qe,it){typeof it.value=="object"&&(it.value=klona(it.value)),!it.enumerable||it.get||it.set||!it.configurable||!it.writable||Qe==="__proto__"?Object.defineProperty(He,Qe,it):He[Qe]=it.value}function klona(He){if(typeof He!="object")return He;var Qe=0,it,lt,ut,dt=Object.prototype.toString.call(He);if(dt==="[object Object]"?ut=Object.create(He.__proto__||null):dt==="[object Array]"?ut=Array(He.length):dt==="[object Set]"?(ut=new Set,He.forEach(function(xt){ut.add(klona(xt))})):dt==="[object Map]"?(ut=new Map,He.forEach(function(xt,ft){ut.set(klona(ft),klona(xt))})):dt==="[object Date]"?ut=new Date(+He):dt==="[object RegExp]"?ut=new RegExp(He.source,He.flags):dt==="[object DataView]"?ut=new He.constructor(klona(He.buffer)):dt==="[object ArrayBuffer]"?ut=He.slice(0):dt.slice(-6)==="Array]"&&(ut=new He.constructor(He)),ut){for(lt=Object.getOwnPropertySymbols(He);Qe<lt.length;Qe++)set$2(ut,lt[Qe],Object.getOwnPropertyDescriptor(He,lt[Qe]));for(Qe=0,lt=Object.getOwnPropertyNames(He);Qe<lt.length;Qe++)Object.hasOwnProperty.call(ut,it=lt[Qe])&&ut[it]===He[it]||set$2(ut,it,Object.getOwnPropertyDescriptor(He,it))}return ut||He}function getSplittedPath(He){return typeof He!="string"?[]:He.split(".")}function getPath(He,Qe){const it=getSplittedPath(He);if(it.length===0||typeof Qe!="object"||Qe===null)return;let lt=Qe[it[0]];for(let ut=1;ut<it.length&&lt!=null;ut+=1)lt=lt[it[ut]];return lt}function setPath(He,Qe,it){const lt=getSplittedPath(He);if(lt.length===0)return it;const ut=klona(it);if(lt.length===1)return ut[lt[0]]=Qe,ut;let dt=ut[lt[0]];for(let xt=1;xt<lt.length-1;xt+=1){if(dt===void 0)return ut;dt=dt[lt[xt]]}return dt[lt[lt.length-1]]=Qe,ut}function reorderPath(He,{from:Qe,to:it},lt){const ut=getPath(He,lt);if(!Array.isArray(ut))return lt;const dt=[...ut],xt=ut[Qe];return dt.splice(Qe,1),dt.splice(it,0,xt),setPath(He,dt,lt)}function insertPath(He,Qe,it,lt){const ut=getPath(He,lt);if(!Array.isArray(ut))return lt;const dt=[...ut];return dt.splice(typeof it=="number"?it:dt.length,0,Qe),setPath(He,dt,lt)}function removePath(He,Qe,it){const lt=getPath(He,it);return Array.isArray(lt)?setPath(He,lt.filter((ut,dt)=>dt!==Qe),it):it}function replacePath(He,Qe,it,lt){const ut=getPath(He,lt);if(!Array.isArray(ut)||ut.length<=it)return lt;const dt=[...ut];return dt[it]=Qe,setPath(He,dt,lt)}function useFormList({$values:He,$errors:Qe,$status:it}){const lt=reactExports.useCallback((ft,vt)=>{it.clearFieldDirty(ft),Qe.setErrors(kt=>reorderErrors(ft,vt,kt)),He.setValues({values:reorderPath(ft,vt,He.refValues.current),updateState:!0})},[]),ut=reactExports.useCallback((ft,vt)=>{it.clearFieldDirty(ft),Qe.setErrors(kt=>changeErrorIndices(ft,vt,kt,-1)),He.setValues({values:removePath(ft,vt,He.refValues.current),updateState:!0})},[]),dt=reactExports.useCallback((ft,vt,kt)=>{it.clearFieldDirty(ft),Qe.setErrors(St=>changeErrorIndices(ft,kt,St,1)),He.setValues({values:insertPath(ft,vt,kt,He.refValues.current),updateState:!0})},[]),xt=reactExports.useCallback((ft,vt,kt)=>{it.clearFieldDirty(ft),He.setValues({values:replacePath(ft,kt,vt,He.refValues.current),updateState:!0})},[]);return{reorderListItem:lt,removeListItem:ut,insertListItem:dt,replaceListItem:xt}}var fastDeepEqual=function He(Qe,it){if(Qe===it)return!0;if(Qe&&it&&typeof Qe=="object"&&typeof it=="object"){if(Qe.constructor!==it.constructor)return!1;var lt,ut,dt;if(Array.isArray(Qe)){if(lt=Qe.length,lt!=it.length)return!1;for(ut=lt;ut--!==0;)if(!He(Qe[ut],it[ut]))return!1;return!0}if(Qe.constructor===RegExp)return Qe.source===it.source&&Qe.flags===it.flags;if(Qe.valueOf!==Object.prototype.valueOf)return Qe.valueOf()===it.valueOf();if(Qe.toString!==Object.prototype.toString)return Qe.toString()===it.toString();if(dt=Object.keys(Qe),lt=dt.length,lt!==Object.keys(it).length)return!1;for(ut=lt;ut--!==0;)if(!Object.prototype.hasOwnProperty.call(it,dt[ut]))return!1;for(ut=lt;ut--!==0;){var xt=dt[ut];if(!He(Qe[xt],it[xt]))return!1}return!0}return Qe!==Qe&&it!==it};const isEqual=getDefaultExportFromCjs(fastDeepEqual);function getStatus(He,Qe){const it=Object.keys(He);if(typeof Qe=="string"){const lt=it.filter(ut=>ut.startsWith(`${Qe}.`));return He[Qe]||lt.some(ut=>He[ut])||!1}return it.some(lt=>He[lt])}function useFormStatus({initialDirty:He,initialTouched:Qe,mode:it,$values:lt}){const[ut,dt]=reactExports.useState(Qe),[xt,ft]=reactExports.useState(He),vt=reactExports.useRef(Qe),kt=reactExports.useRef(He),St=reactExports.useCallback(Xt=>{const Kt=typeof Xt=="function"?Xt(vt.current):Xt;vt.current=Kt,it==="controlled"&&dt(Kt)},[]),Tt=reactExports.useCallback((Xt,Kt=!1)=>{const Jt=typeof Xt=="function"?Xt(kt.current):Xt;kt.current=Jt,(it==="controlled"||Kt)&&ft(Jt)},[]),Mt=reactExports.useCallback(()=>St({}),[]),Nt=reactExports.useCallback(Xt=>{const Kt=Xt?{...lt.refValues.current,...Xt}:lt.refValues.current;lt.setValuesSnapshot(Kt),Tt({})},[]),At=reactExports.useCallback((Xt,Kt)=>{St(Jt=>getStatus(Jt,Xt)===Kt?Jt:{...Jt,[Xt]:Kt})},[]),$t=reactExports.useCallback((Xt,Kt,Jt)=>{Tt(hr=>getStatus(hr,Xt)===Kt?hr:{...hr,[Xt]:Kt},Jt)},[]),Dt=reactExports.useCallback((Xt,Kt)=>{const Jt=getStatus(kt.current,Xt),hr=!isEqual(getPath(Xt,lt.getValuesSnapshot()),Kt),xr=clearListState(Xt,kt.current);xr[Xt]=hr,Tt(xr,Jt!==hr)},[]),Ft=reactExports.useCallback(Xt=>getStatus(vt.current,Xt),[]),Bt=reactExports.useCallback(Xt=>Tt(Kt=>{if(typeof Xt!="string")return Kt;const Jt=clearListState(Xt,Kt);return delete Jt[Xt],isEqual(Jt,Kt)?Kt:Jt}),[]),Ot=reactExports.useCallback(Xt=>{if(Xt){const Jt=getPath(Xt,kt.current);if(typeof Jt=="boolean")return Jt;const hr=getPath(Xt,lt.refValues.current),xr=getPath(Xt,lt.valuesSnapshot.current);return!isEqual(hr,xr)}return Object.keys(kt.current).length>0?getStatus(kt.current):!isEqual(lt.refValues.current,lt.valuesSnapshot.current)},[]),Qt=reactExports.useCallback(()=>kt.current,[]),Wt=reactExports.useCallback(()=>vt.current,[]);return{touchedState:ut,dirtyState:xt,touchedRef:vt,dirtyRef:kt,setTouched:St,setDirty:Tt,resetDirty:Nt,resetTouched:Mt,isTouched:Ft,setFieldTouched:At,setFieldDirty:$t,setTouchedState:dt,setDirtyState:ft,clearFieldDirty:Bt,isDirty:Ot,getDirty:Qt,getTouched:Wt,setCalculatedFieldDirty:Dt}}function useFormValues({initialValues:He,onValuesChange:Qe,mode:it}){const lt=reactExports.useRef(!1),[ut,dt]=reactExports.useState(He||{}),xt=reactExports.useRef(ut),ft=reactExports.useRef(ut),vt=reactExports.useCallback(({values:Dt,subscribers:Ft,updateState:Bt=!0,mergeWithPreviousValues:Ot=!0})=>{const Qt=xt.current,Wt=Dt instanceof Function?Dt(xt.current):Dt,Xt=Ot?{...Qt,...Wt}:Wt;xt.current=Xt,Bt&&(dt(Xt),it==="uncontrolled"&&(xt.current=Xt)),Qe?.(Xt,Qt),Ft?.filter(Boolean).forEach(Kt=>Kt({updatedValues:Xt,previousValues:Qt}))},[Qe]),kt=reactExports.useCallback(Dt=>{const Ft=getPath(Dt.path,xt.current),Bt=Dt.value instanceof Function?Dt.value(Ft):Dt.value;if(Ft!==Bt){const Ot=xt.current,Qt=setPath(Dt.path,Bt,xt.current);vt({values:Qt,updateState:Dt.updateState}),Dt.subscribers?.filter(Boolean).forEach(Wt=>Wt({path:Dt.path,updatedValues:Qt,previousValues:Ot}))}},[vt]),St=reactExports.useCallback(Dt=>{ft.current=Dt},[]),Tt=reactExports.useCallback((Dt,Ft)=>{lt.current||(lt.current=!0,vt({values:Dt,updateState:it==="controlled"}),St(Dt),Ft())},[vt]),Mt=reactExports.useCallback(()=>{vt({values:ft.current,updateState:!0,mergeWithPreviousValues:!1})},[vt]),Nt=reactExports.useCallback(()=>xt.current,[]),At=reactExports.useCallback(()=>ft.current,[]),$t=reactExports.useCallback((Dt,Ft)=>{const Bt=getPath(Dt,ft.current);typeof Bt>"u"||kt({path:Dt,value:Bt,updateState:it==="controlled",subscribers:Ft})},[kt,it]);return{initialized:lt,stateValues:ut,refValues:xt,valuesSnapshot:ft,setValues:vt,setFieldValue:kt,resetValues:Mt,setValuesSnapshot:St,initialize:Tt,getValues:Nt,getValuesSnapshot:At,resetField:$t}}function useFormWatch({$status:He,cascadeUpdates:Qe}){const it=reactExports.useRef({}),lt=reactExports.useCallback((dt,xt)=>{reactExports.useEffect(()=>(it.current[dt]=it.current[dt]||[],it.current[dt].push(xt),()=>{it.current[dt]=it.current[dt].filter(ft=>ft!==xt)}),[xt])},[]),ut=reactExports.useCallback(dt=>{const xt=it.current[dt]?.map(ft=>vt=>ft({previousValue:getPath(dt,vt.previousValues),value:getPath(dt,vt.updatedValues),touched:He.isTouched(dt),dirty:He.isDirty(dt)}))??[];if(Qe)for(const ft in it.current)(ft.startsWith(`${dt}.`)||dt.startsWith(`${ft}.`))&&xt.push(...it.current[ft].map(vt=>kt=>vt({previousValue:getPath(ft,kt.previousValues),value:getPath(ft,kt.updatedValues),touched:He.isTouched(ft),dirty:He.isDirty(ft)})));return xt},[]);return{subscribers:it,watch:lt,getFieldSubscribers:ut}}function getDataPath(He,Qe){return He?`${He}-${Qe.toString()}`:Qe.toString()}const formRootRule=Symbol("root-rule");function getValidationResults(He){const Qe=filterErrors(He);return{hasErrors:Object.keys(Qe).length>0,errors:Qe}}function validateRulesRecord(He,Qe,it="",lt={}){return typeof He!="object"||He===null?lt:Object.keys(He).reduce((ut,dt)=>{const xt=He[dt],ft=`${it===""?"":`${it}.`}${dt}`,vt=getPath(ft,Qe);let kt=!1;return typeof xt=="function"&&(ut[ft]=xt(vt,Qe,ft)),typeof xt=="object"&&Array.isArray(vt)&&(kt=!0,vt.forEach((St,Tt)=>validateRulesRecord(xt,Qe,`${ft}.${Tt}`,ut)),formRootRule in xt&&(ut[ft]=xt[formRootRule](vt,Qe,ft))),typeof xt=="object"&&typeof vt=="object"&&vt!==null&&(kt||validateRulesRecord(xt,Qe,ft,ut),formRootRule in xt&&(ut[ft]=xt[formRootRule](vt,Qe,ft))),ut},lt)}function validateValues(He,Qe){return getValidationResults(typeof He=="function"?He(Qe):validateRulesRecord(He,Qe))}function validateFieldValue(He,Qe,it){if(typeof He!="string")return{hasError:!1,error:null};const lt=validateValues(Qe,it),ut=Object.keys(lt.errors).find(dt=>He.split(".").every((xt,ft)=>xt===dt.split(".")[ft]));return{hasError:!!ut,error:ut?lt.errors[ut]:null}}const FORM_INDEX="__MANTINE_FORM_INDEX__";function shouldValidateOnChange(He,Qe){return Qe?typeof Qe=="boolean"?Qe:Array.isArray(Qe)?Qe.includes(He.replace(/[.][0-9]+/g,`.${FORM_INDEX}`)):!1:!1}function useForm({name:He,mode:Qe="controlled",initialValues:it,initialErrors:lt={},initialDirty:ut={},initialTouched:dt={},clearInputErrorOnChange:xt=!0,validateInputOnChange:ft=!1,validateInputOnBlur:vt=!1,onValuesChange:kt,transformValues:St=Dt=>Dt,enhanceGetInputProps:Tt,validate:Mt,onSubmitPreventDefault:Nt="always",touchTrigger:At="change",cascadeUpdates:$t=!1}={}){const Dt=useFormErrors(lt),Ft=useFormValues({initialValues:it,onValuesChange:kt,mode:Qe}),Bt=useFormStatus({initialDirty:ut,initialTouched:dt,$values:Ft,mode:Qe}),Ot=useFormList({$values:Ft,$errors:Dt,$status:Bt}),Qt=useFormWatch({$status:Bt,cascadeUpdates:$t}),[Wt,Xt]=reactExports.useState(0),[Kt,Jt]=reactExports.useState({}),[hr,xr]=reactExports.useState(!1),gr=reactExports.useCallback(()=>{Ft.resetValues(),Dt.clearErrors(),Bt.resetDirty(),Bt.resetTouched(),Qe==="uncontrolled"&&Xt(Qr=>Qr+1)},[]),br=reactExports.useCallback(Qr=>{xt&&Dt.clearErrors(),Qe==="uncontrolled"&&Xt(Ur=>Ur+1),Object.keys(Qt.subscribers.current).forEach(Ur=>{const nn=getPath(Ur,Ft.refValues.current),Cn=getPath(Ur,Qr);nn!==Cn&&Qt.getFieldSubscribers(Ur).forEach(es=>es({previousValues:Qr,updatedValues:Ft.refValues.current}))})},[xt]),vr=reactExports.useCallback(Qr=>{const Ur=Ft.refValues.current;Ft.initialize(Qr,()=>Qe==="uncontrolled"&&Xt(nn=>nn+1)),br(Ur)},[br]),yr=reactExports.useCallback((Qr,Ur,nn)=>{const Cn=shouldValidateOnChange(Qr,ft),es=Ur instanceof Function?Ur(getPath(Qr,Ft.refValues.current)):Ur;Bt.setCalculatedFieldDirty(Qr,es),At==="change"&&Bt.setFieldTouched(Qr,!0),!Cn&&xt&&Dt.clearFieldError(Qr),Ft.setFieldValue({path:Qr,value:Ur,updateState:Qe==="controlled",subscribers:[...Qt.getFieldSubscribers(Qr),Cn?Xr=>{const en=validateFieldValue(Qr,Mt,Xr.updatedValues);en.hasError?Dt.setFieldError(Qr,en.error):Dt.clearFieldError(Qr)}:null,nn?.forceUpdate!==!1&&Qe!=="controlled"?()=>Jt(Xr=>({...Xr,[Qr]:(Xr[Qr]||0)+1})):null]})},[kt,Mt]),Cr=reactExports.useCallback(Qr=>{const Ur=Ft.refValues.current;Ft.setValues({values:Qr,updateState:Qe==="controlled"}),br(Ur)},[kt,br]),Rr=reactExports.useCallback(()=>{const Qr=validateValues(Mt,Ft.refValues.current);return Dt.setErrors(Qr.errors),Qr},[Mt]),Ir=reactExports.useCallback(Qr=>{const Ur=validateFieldValue(Qr,Mt,Ft.refValues.current);return Ur.hasError?Dt.setFieldError(Qr,Ur.error):Dt.clearFieldError(Qr),Ur},[Mt]),Tr=(Qr,{type:Ur="input",withError:nn=!0,withFocus:Cn=!0,...es}={})=>{const en={onChange:getInputOnChange(rn=>yr(Qr,rn,{forceUpdate:!1})),"data-path":getDataPath(He,Qr)};return nn&&(en.error=Dt.errorsState[Qr]),Ur==="checkbox"?en[Qe==="controlled"?"checked":"defaultChecked"]=getPath(Qr,Ft.refValues.current):en[Qe==="controlled"?"value":"defaultValue"]=getPath(Qr,Ft.refValues.current),Cn&&(en.onFocus=()=>Bt.setFieldTouched(Qr,!0),en.onBlur=()=>{if(shouldValidateOnChange(Qr,vt)){const rn=validateFieldValue(Qr,Mt,Ft.refValues.current);rn.hasError?Dt.setFieldError(Qr,rn.error):Dt.clearFieldError(Qr)}}),Object.assign(en,Tt?.({inputProps:en,field:Qr,options:{type:Ur,withError:nn,withFocus:Cn,...es},form:Jr}))},$r=(Qr,Ur)=>nn=>{Nt==="always"&&nn?.preventDefault();const Cn=Rr();if(Cn.hasErrors)Nt==="validation-failed"&&nn?.preventDefault(),Ur?.(Cn.errors,Ft.refValues.current,nn);else{const es=Qr?.(St(Ft.refValues.current),nn);es instanceof Promise&&(xr(!0),es.finally(()=>xr(!1)))}},Zr=Qr=>St(Qr||Ft.refValues.current),Sr=reactExports.useCallback(Qr=>{Qr.preventDefault(),gr()},[]),Dr=reactExports.useCallback(Qr=>Qr?!validateFieldValue(Qr,Mt,Ft.refValues.current).hasError:!validateValues(Mt,Ft.refValues.current).hasErrors,[Mt]),wr=Qr=>`${Wt}-${String(Qr)}-${Kt[String(Qr)]||0}`,qr=reactExports.useCallback(Qr=>document.querySelector(`[data-path="${getDataPath(He,Qr)}"]`),[]),Nr=reactExports.useCallback(Qr=>{Ft.resetField(Qr,[Qe!=="controlled"?()=>Jt(Ur=>({...Ur,[Qr]:(Ur[Qr]||0)+1})):null])},[Ft.resetField,Qe,Jt]),Jr={watch:Qt.watch,initialized:Ft.initialized.current,values:Qe==="uncontrolled"?Ft.refValues.current:Ft.stateValues,getValues:Ft.getValues,getInitialValues:Ft.getValuesSnapshot,setInitialValues:Ft.setValuesSnapshot,resetField:Nr,initialize:vr,setValues:Cr,setFieldValue:yr,submitting:hr,setSubmitting:xr,errors:Dt.errorsState,setErrors:Dt.setErrors,setFieldError:Dt.setFieldError,clearFieldError:Dt.clearFieldError,clearErrors:Dt.clearErrors,resetDirty:Bt.resetDirty,setTouched:Bt.setTouched,setDirty:Bt.setDirty,isTouched:Bt.isTouched,resetTouched:Bt.resetTouched,isDirty:Bt.isDirty,getTouched:Bt.getTouched,getDirty:Bt.getDirty,reorderListItem:Ot.reorderListItem,insertListItem:Ot.insertListItem,removeListItem:Ot.removeListItem,replaceListItem:Ot.replaceListItem,reset:gr,validate:Rr,validateField:Ir,getInputProps:Tr,onSubmit:$r,onReset:Sr,isValid:Dr,getTransformedValues:Zr,key:wr,getInputNode:qr};return useFormActions(He,Jr),Jr}function isNotEmpty(He){const Qe=He||!0;return it=>typeof it=="string"?it.trim().length>0?null:Qe:Array.isArray(it)?it.length>0?null:Qe:it==null||it===!1?Qe:null}function __awaiter$2(He,Qe,it,lt){function ut(dt){return dt instanceof it?dt:new it(function(xt){xt(dt)})}return new(it||(it=Promise))(function(dt,xt){function ft(St){try{kt(lt.next(St))}catch(Tt){xt(Tt)}}function vt(St){try{kt(lt.throw(St))}catch(Tt){xt(Tt)}}function kt(St){St.done?dt(St.value):ut(St.value).then(ft,vt)}kt((lt=lt.apply(He,Qe||[])).next())})}typeof SuppressedError=="function"&&SuppressedError;const COMMON_MIME_TYPES=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function toFileWithPath(He,Qe,it){const lt=withMimeType(He),{webkitRelativePath:ut}=He,dt=typeof Qe=="string"?Qe:typeof ut=="string"&&ut.length>0?ut:`./${He.name}`;return typeof lt.path!="string"&&setObjProp(lt,"path",dt),setObjProp(lt,"relativePath",dt),lt}function withMimeType(He){const{name:Qe}=He;if(Qe&&Qe.lastIndexOf(".")!==-1&&!He.type){const lt=Qe.split(".").pop().toLowerCase(),ut=COMMON_MIME_TYPES.get(lt);ut&&Object.defineProperty(He,"type",{value:ut,writable:!1,configurable:!1,enumerable:!0})}return He}function setObjProp(He,Qe,it){Object.defineProperty(He,Qe,{value:it,writable:!1,configurable:!1,enumerable:!0})}const FILES_TO_IGNORE=[".DS_Store","Thumbs.db"];function fromEvent(He){return __awaiter$2(this,void 0,void 0,function*(){return isObject$1(He)&&isDataTransfer(He.dataTransfer)?getDataTransferFiles(He.dataTransfer,He.type):isChangeEvt(He)?getInputFiles(He):Array.isArray(He)&&He.every(Qe=>"getFile"in Qe&&typeof Qe.getFile=="function")?getFsHandleFiles(He):[]})}function isDataTransfer(He){return isObject$1(He)}function isChangeEvt(He){return isObject$1(He)&&isObject$1(He.target)}function isObject$1(He){return typeof He=="object"&&He!==null}function getInputFiles(He){return fromList(He.target.files).map(Qe=>toFileWithPath(Qe))}function getFsHandleFiles(He){return __awaiter$2(this,void 0,void 0,function*(){return(yield Promise.all(He.map(it=>it.getFile()))).map(it=>toFileWithPath(it))})}function getDataTransferFiles(He,Qe){return __awaiter$2(this,void 0,void 0,function*(){if(He.items){const it=fromList(He.items).filter(ut=>ut.kind==="file");if(Qe!=="drop")return it;const lt=yield Promise.all(it.map(toFilePromises));return noIgnoredFiles(flatten(lt))}return noIgnoredFiles(fromList(He.files).map(it=>toFileWithPath(it)))})}function noIgnoredFiles(He){return He.filter(Qe=>FILES_TO_IGNORE.indexOf(Qe.name)===-1)}function fromList(He){if(He===null)return[];const Qe=[];for(let it=0;it<He.length;it++){const lt=He[it];Qe.push(lt)}return Qe}function toFilePromises(He){if(typeof He.webkitGetAsEntry!="function")return fromDataTransferItem(He);const Qe=He.webkitGetAsEntry();return Qe&&Qe.isDirectory?fromDirEntry(Qe):fromDataTransferItem(He,Qe)}function flatten(He){return He.reduce((Qe,it)=>[...Qe,...Array.isArray(it)?flatten(it):[it]],[])}function fromDataTransferItem(He,Qe){return __awaiter$2(this,void 0,void 0,function*(){var it;if(globalThis.isSecureContext&&typeof He.getAsFileSystemHandle=="function"){const dt=yield He.getAsFileSystemHandle();if(dt===null)throw new Error(`${He} is not a File`);if(dt!==void 0){const xt=yield dt.getFile();return xt.handle=dt,toFileWithPath(xt)}}const lt=He.getAsFile();if(!lt)throw new Error(`${He} is not a File`);return toFileWithPath(lt,(it=Qe?.fullPath)!==null&&it!==void 0?it:void 0)})}function fromEntry(He){return __awaiter$2(this,void 0,void 0,function*(){return He.isDirectory?fromDirEntry(He):fromFileEntry(He)})}function fromDirEntry(He){const Qe=He.createReader();return new Promise((it,lt)=>{const ut=[];function dt(){Qe.readEntries(xt=>__awaiter$2(this,void 0,void 0,function*(){if(xt.length){const ft=Promise.all(xt.map(fromEntry));ut.push(ft),dt()}else try{const ft=yield Promise.all(ut);it(ft)}catch(ft){lt(ft)}}),xt=>{lt(xt)})}dt()})}function fromFileEntry(He){return __awaiter$2(this,void 0,void 0,function*(){return new Promise((Qe,it)=>{He.file(lt=>{const ut=toFileWithPath(lt,He.fullPath);Qe(ut)},lt=>{it(lt)})})})}var _default=function(He,Qe){if(He&&Qe){var it=Array.isArray(Qe)?Qe:Qe.split(",");if(it.length===0)return!0;var lt=He.name||"",ut=(He.type||"").toLowerCase(),dt=ut.replace(/\/.*$/,"");return it.some(function(xt){var ft=xt.trim().toLowerCase();return ft.charAt(0)==="."?lt.toLowerCase().endsWith(ft):ft.endsWith("/*")?dt===ft.replace(/\/.*$/,""):ut===ft})}return!0};function _toConsumableArray$1(He){return _arrayWithoutHoles$1(He)||_iterableToArray$1(He)||_unsupportedIterableToArray$1(He)||_nonIterableSpread$1()}function _nonIterableSpread$1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$1(He){if(typeof Symbol<"u"&&He[Symbol.iterator]!=null||He["@@iterator"]!=null)return Array.from(He)}function _arrayWithoutHoles$1(He){if(Array.isArray(He))return _arrayLikeToArray$1(He)}function ownKeys$1(He,Qe){var it=Object.keys(He);if(Object.getOwnPropertySymbols){var lt=Object.getOwnPropertySymbols(He);Qe&&(lt=lt.filter(function(ut){return Object.getOwnPropertyDescriptor(He,ut).enumerable})),it.push.apply(it,lt)}return it}function _objectSpread$1(He){for(var Qe=1;Qe<arguments.length;Qe++){var it=arguments[Qe]!=null?arguments[Qe]:{};Qe%2?ownKeys$1(Object(it),!0).forEach(function(lt){_defineProperty$1(He,lt,it[lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(He,Object.getOwnPropertyDescriptors(it)):ownKeys$1(Object(it)).forEach(function(lt){Object.defineProperty(He,lt,Object.getOwnPropertyDescriptor(it,lt))})}return He}function _defineProperty$1(He,Qe,it){return Qe in He?Object.defineProperty(He,Qe,{value:it,enumerable:!0,configurable:!0,writable:!0}):He[Qe]=it,He}function _slicedToArray$1(He,Qe){return _arrayWithHoles$1(He)||_iterableToArrayLimit$1(He,Qe)||_unsupportedIterableToArray$1(He,Qe)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1(He,Qe){if(He){if(typeof He=="string")return _arrayLikeToArray$1(He,Qe);var it=Object.prototype.toString.call(He).slice(8,-1);if(it==="Object"&&He.constructor&&(it=He.constructor.name),it==="Map"||it==="Set")return Array.from(He);if(it==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(it))return _arrayLikeToArray$1(He,Qe)}}function _arrayLikeToArray$1(He,Qe){(Qe==null||Qe>He.length)&&(Qe=He.length);for(var it=0,lt=new Array(Qe);it<Qe;it++)lt[it]=He[it];return lt}function _iterableToArrayLimit$1(He,Qe){var it=He==null?null:typeof Symbol<"u"&&He[Symbol.iterator]||He["@@iterator"];if(it!=null){var lt=[],ut=!0,dt=!1,xt,ft;try{for(it=it.call(He);!(ut=(xt=it.next()).done)&&(lt.push(xt.value),!(Qe&&lt.length===Qe));ut=!0);}catch(vt){dt=!0,ft=vt}finally{try{!ut&&it.return!=null&&it.return()}finally{if(dt)throw ft}}return lt}}function _arrayWithHoles$1(He){if(Array.isArray(He))return He}var accepts=typeof _default=="function"?_default:_default.default,FILE_INVALID_TYPE="file-invalid-type",FILE_TOO_LARGE="file-too-large",FILE_TOO_SMALL="file-too-small",TOO_MANY_FILES="too-many-files",getInvalidTypeRejectionErr=function He(){var Qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",it=Qe.split(","),lt=it.length>1?"one of ".concat(it.join(", ")):it[0];return{code:FILE_INVALID_TYPE,message:"File type must be ".concat(lt)}},getTooLargeRejectionErr=function He(Qe){return{code:FILE_TOO_LARGE,message:"File is larger than ".concat(Qe," ").concat(Qe===1?"byte":"bytes")}},getTooSmallRejectionErr=function He(Qe){return{code:FILE_TOO_SMALL,message:"File is smaller than ".concat(Qe," ").concat(Qe===1?"byte":"bytes")}},TOO_MANY_FILES_REJECTION={code:TOO_MANY_FILES,message:"Too many files"};function fileAccepted(He,Qe){var it=He.type==="application/x-moz-file"||accepts(He,Qe);return[it,it?null:getInvalidTypeRejectionErr(Qe)]}function fileMatchSize(He,Qe,it){if(isDefined(He.size))if(isDefined(Qe)&&isDefined(it)){if(He.size>it)return[!1,getTooLargeRejectionErr(it)];if(He.size<Qe)return[!1,getTooSmallRejectionErr(Qe)]}else{if(isDefined(Qe)&&He.size<Qe)return[!1,getTooSmallRejectionErr(Qe)];if(isDefined(it)&&He.size>it)return[!1,getTooLargeRejectionErr(it)]}return[!0,null]}function isDefined(He){return He!=null}function allFilesAccepted(He){var Qe=He.files,it=He.accept,lt=He.minSize,ut=He.maxSize,dt=He.multiple,xt=He.maxFiles,ft=He.validator;return!dt&&Qe.length>1||dt&&xt>=1&&Qe.length>xt?!1:Qe.every(function(vt){var kt=fileAccepted(vt,it),St=_slicedToArray$1(kt,1),Tt=St[0],Mt=fileMatchSize(vt,lt,ut),Nt=_slicedToArray$1(Mt,1),At=Nt[0],$t=ft?ft(vt):null;return Tt&&At&&!$t})}function isPropagationStopped(He){return typeof He.isPropagationStopped=="function"?He.isPropagationStopped():typeof He.cancelBubble<"u"?He.cancelBubble:!1}function isEvtWithFiles(He){return He.dataTransfer?Array.prototype.some.call(He.dataTransfer.types,function(Qe){return Qe==="Files"||Qe==="application/x-moz-file"}):!!He.target&&!!He.target.files}function onDocumentDragOver(He){He.preventDefault()}function isIe(He){return He.indexOf("MSIE")!==-1||He.indexOf("Trident/")!==-1}function isEdge(He){return He.indexOf("Edge/")!==-1}function isIeOrEdge(){var He=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return isIe(He)||isEdge(He)}function composeEventHandlers(){for(var He=arguments.length,Qe=new Array(He),it=0;it<He;it++)Qe[it]=arguments[it];return function(lt){for(var ut=arguments.length,dt=new Array(ut>1?ut-1:0),xt=1;xt<ut;xt++)dt[xt-1]=arguments[xt];return Qe.some(function(ft){return!isPropagationStopped(lt)&&ft&&ft.apply(void 0,[lt].concat(dt)),isPropagationStopped(lt)})}}function canUseFileSystemAccessAPI(){return"showOpenFilePicker"in window}function pickerOptionsFromAccept(He){if(isDefined(He)){var Qe=Object.entries(He).filter(function(it){var lt=_slicedToArray$1(it,2),ut=lt[0],dt=lt[1],xt=!0;return isMIMEType(ut)||(console.warn('Skipped "'.concat(ut,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),xt=!1),(!Array.isArray(dt)||!dt.every(isExt))&&(console.warn('Skipped "'.concat(ut,'" because an invalid file extension was provided.')),xt=!1),xt}).reduce(function(it,lt){var ut=_slicedToArray$1(lt,2),dt=ut[0],xt=ut[1];return _objectSpread$1(_objectSpread$1({},it),{},_defineProperty$1({},dt,xt))},{});return[{description:"Files",accept:Qe}]}return He}function acceptPropAsAcceptAttr(He){if(isDefined(He))return Object.entries(He).reduce(function(Qe,it){var lt=_slicedToArray$1(it,2),ut=lt[0],dt=lt[1];return[].concat(_toConsumableArray$1(Qe),[ut],_toConsumableArray$1(dt))},[]).filter(function(Qe){return isMIMEType(Qe)||isExt(Qe)}).join(",")}function isAbort(He){return He instanceof DOMException&&(He.name==="AbortError"||He.code===He.ABORT_ERR)}function isSecurityError(He){return He instanceof DOMException&&(He.name==="SecurityError"||He.code===He.SECURITY_ERR)}function isMIMEType(He){return He==="audio/*"||He==="video/*"||He==="image/*"||He==="text/*"||He==="application/*"||/\w+\/[-+.\w]+/g.test(He)}function isExt(He){return/^.*\.[\w]+$/.test(He)}var _excluded=["children"],_excluded2=["open"],_excluded3=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],_excluded4=["refKey","onChange","onClick"];function _toConsumableArray(He){return _arrayWithoutHoles(He)||_iterableToArray(He)||_unsupportedIterableToArray(He)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray(He){if(typeof Symbol<"u"&&He[Symbol.iterator]!=null||He["@@iterator"]!=null)return Array.from(He)}function _arrayWithoutHoles(He){if(Array.isArray(He))return _arrayLikeToArray(He)}function _slicedToArray(He,Qe){return _arrayWithHoles(He)||_iterableToArrayLimit(He,Qe)||_unsupportedIterableToArray(He,Qe)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(He,Qe){if(He){if(typeof He=="string")return _arrayLikeToArray(He,Qe);var it=Object.prototype.toString.call(He).slice(8,-1);if(it==="Object"&&He.constructor&&(it=He.constructor.name),it==="Map"||it==="Set")return Array.from(He);if(it==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(it))return _arrayLikeToArray(He,Qe)}}function _arrayLikeToArray(He,Qe){(Qe==null||Qe>He.length)&&(Qe=He.length);for(var it=0,lt=new Array(Qe);it<Qe;it++)lt[it]=He[it];return lt}function _iterableToArrayLimit(He,Qe){var it=He==null?null:typeof Symbol<"u"&&He[Symbol.iterator]||He["@@iterator"];if(it!=null){var lt=[],ut=!0,dt=!1,xt,ft;try{for(it=it.call(He);!(ut=(xt=it.next()).done)&&(lt.push(xt.value),!(Qe&&lt.length===Qe));ut=!0);}catch(vt){dt=!0,ft=vt}finally{try{!ut&&it.return!=null&&it.return()}finally{if(dt)throw ft}}return lt}}function _arrayWithHoles(He){if(Array.isArray(He))return He}function ownKeys(He,Qe){var it=Object.keys(He);if(Object.getOwnPropertySymbols){var lt=Object.getOwnPropertySymbols(He);Qe&&(lt=lt.filter(function(ut){return Object.getOwnPropertyDescriptor(He,ut).enumerable})),it.push.apply(it,lt)}return it}function _objectSpread(He){for(var Qe=1;Qe<arguments.length;Qe++){var it=arguments[Qe]!=null?arguments[Qe]:{};Qe%2?ownKeys(Object(it),!0).forEach(function(lt){_defineProperty(He,lt,it[lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(He,Object.getOwnPropertyDescriptors(it)):ownKeys(Object(it)).forEach(function(lt){Object.defineProperty(He,lt,Object.getOwnPropertyDescriptor(it,lt))})}return He}function _defineProperty(He,Qe,it){return Qe in He?Object.defineProperty(He,Qe,{value:it,enumerable:!0,configurable:!0,writable:!0}):He[Qe]=it,He}function _objectWithoutProperties(He,Qe){if(He==null)return{};var it=_objectWithoutPropertiesLoose(He,Qe),lt,ut;if(Object.getOwnPropertySymbols){var dt=Object.getOwnPropertySymbols(He);for(ut=0;ut<dt.length;ut++)lt=dt[ut],!(Qe.indexOf(lt)>=0)&&Object.prototype.propertyIsEnumerable.call(He,lt)&&(it[lt]=He[lt])}return it}function _objectWithoutPropertiesLoose(He,Qe){if(He==null)return{};var it={},lt=Object.keys(He),ut,dt;for(dt=0;dt<lt.length;dt++)ut=lt[dt],!(Qe.indexOf(ut)>=0)&&(it[ut]=He[ut]);return it}var Dropzone=reactExports.forwardRef(function(He,Qe){var it=He.children,lt=_objectWithoutProperties(He,_excluded),ut=useDropzone(lt),dt=ut.open,xt=_objectWithoutProperties(ut,_excluded2);return reactExports.useImperativeHandle(Qe,function(){return{open:dt}},[dt]),React.createElement(reactExports.Fragment,null,it(_objectSpread(_objectSpread({},xt),{},{open:dt})))});Dropzone.displayName="Dropzone";var defaultProps={disabled:!1,getFilesFromEvent:fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};Dropzone.defaultProps=defaultProps;Dropzone.propTypes={children:PropTypes.func,accept:PropTypes.objectOf(PropTypes.arrayOf(PropTypes.string)),multiple:PropTypes.bool,preventDropOnDocument:PropTypes.bool,noClick:PropTypes.bool,noKeyboard:PropTypes.bool,noDrag:PropTypes.bool,noDragEventsBubbling:PropTypes.bool,minSize:PropTypes.number,maxSize:PropTypes.number,maxFiles:PropTypes.number,disabled:PropTypes.bool,getFilesFromEvent:PropTypes.func,onFileDialogCancel:PropTypes.func,onFileDialogOpen:PropTypes.func,useFsAccessApi:PropTypes.bool,autoFocus:PropTypes.bool,onDragEnter:PropTypes.func,onDragLeave:PropTypes.func,onDragOver:PropTypes.func,onDrop:PropTypes.func,onDropAccepted:PropTypes.func,onDropRejected:PropTypes.func,onError:PropTypes.func,validator:PropTypes.func};var initialState$1={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function useDropzone(){var He=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Qe=_objectSpread(_objectSpread({},defaultProps),He),it=Qe.accept,lt=Qe.disabled,ut=Qe.getFilesFromEvent,dt=Qe.maxSize,xt=Qe.minSize,ft=Qe.multiple,vt=Qe.maxFiles,kt=Qe.onDragEnter,St=Qe.onDragLeave,Tt=Qe.onDragOver,Mt=Qe.onDrop,Nt=Qe.onDropAccepted,At=Qe.onDropRejected,$t=Qe.onFileDialogCancel,Dt=Qe.onFileDialogOpen,Ft=Qe.useFsAccessApi,Bt=Qe.autoFocus,Ot=Qe.preventDropOnDocument,Qt=Qe.noClick,Wt=Qe.noKeyboard,Xt=Qe.noDrag,Kt=Qe.noDragEventsBubbling,Jt=Qe.onError,hr=Qe.validator,xr=reactExports.useMemo(function(){return acceptPropAsAcceptAttr(it)},[it]),gr=reactExports.useMemo(function(){return pickerOptionsFromAccept(it)},[it]),br=reactExports.useMemo(function(){return typeof Dt=="function"?Dt:noop$1},[Dt]),vr=reactExports.useMemo(function(){return typeof $t=="function"?$t:noop$1},[$t]),yr=reactExports.useRef(null),Cr=reactExports.useRef(null),Rr=reactExports.useReducer(reducer,initialState$1),Ir=_slicedToArray(Rr,2),Tr=Ir[0],$r=Ir[1],Zr=Tr.isFocused,Sr=Tr.isFileDialogActive,Dr=reactExports.useRef(typeof window<"u"&&window.isSecureContext&&Ft&&canUseFileSystemAccessAPI()),wr=function(){!Dr.current&&Sr&&setTimeout(function(){if(Cr.current){var ts=Cr.current.files;ts.length||($r({type:"closeDialog"}),vr())}},300)};reactExports.useEffect(function(){return window.addEventListener("focus",wr,!1),function(){window.removeEventListener("focus",wr,!1)}},[Cr,Sr,vr,Dr]);var qr=reactExports.useRef([]),Nr=function(ts){yr.current&&yr.current.contains(ts.target)||(ts.preventDefault(),qr.current=[])};reactExports.useEffect(function(){return Ot&&(document.addEventListener("dragover",onDocumentDragOver,!1),document.addEventListener("drop",Nr,!1)),function(){Ot&&(document.removeEventListener("dragover",onDocumentDragOver),document.removeEventListener("drop",Nr))}},[yr,Ot]),reactExports.useEffect(function(){return!lt&&Bt&&yr.current&&yr.current.focus(),function(){}},[yr,Bt,lt]);var Jr=reactExports.useCallback(function(tn){Jt?Jt(tn):console.error(tn)},[Jt]),Qr=reactExports.useCallback(function(tn){tn.preventDefault(),tn.persist(),cs(tn),qr.current=[].concat(_toConsumableArray(qr.current),[tn.target]),isEvtWithFiles(tn)&&Promise.resolve(ut(tn)).then(function(ts){if(!(isPropagationStopped(tn)&&!Kt)){var as=ts.length,us=as>0&&allFilesAccepted({files:ts,accept:xr,minSize:xt,maxSize:dt,multiple:ft,maxFiles:vt,validator:hr}),ds=as>0&&!us;$r({isDragAccept:us,isDragReject:ds,isDragActive:!0,type:"setDraggedFiles"}),kt&&kt(tn)}}).catch(function(ts){return Jr(ts)})},[ut,kt,Jr,Kt,xr,xt,dt,ft,vt,hr]),Ur=reactExports.useCallback(function(tn){tn.preventDefault(),tn.persist(),cs(tn);var ts=isEvtWithFiles(tn);if(ts&&tn.dataTransfer)try{tn.dataTransfer.dropEffect="copy"}catch{}return ts&&Tt&&Tt(tn),!1},[Tt,Kt]),nn=reactExports.useCallback(function(tn){tn.preventDefault(),tn.persist(),cs(tn);var ts=qr.current.filter(function(us){return yr.current&&yr.current.contains(us)}),as=ts.indexOf(tn.target);as!==-1&&ts.splice(as,1),qr.current=ts,!(ts.length>0)&&($r({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),isEvtWithFiles(tn)&&St&&St(tn))},[yr,St,Kt]),Cn=reactExports.useCallback(function(tn,ts){var as=[],us=[];tn.forEach(function(ds){var gs=fileAccepted(ds,xr),xs=_slicedToArray(gs,2),fs=xs[0],bs=xs[1],js=fileMatchSize(ds,xt,dt),Es=_slicedToArray(js,2),ys=Es[0],vs=Es[1],Rs=hr?hr(ds):null;if(fs&&ys&&!Rs)as.push(ds);else{var ws=[bs,vs];Rs&&(ws=ws.concat(Rs)),us.push({file:ds,errors:ws.filter(function(Cs){return Cs})})}}),(!ft&&as.length>1||ft&&vt>=1&&as.length>vt)&&(as.forEach(function(ds){us.push({file:ds,errors:[TOO_MANY_FILES_REJECTION]})}),as.splice(0)),$r({acceptedFiles:as,fileRejections:us,isDragReject:us.length>0,type:"setFiles"}),Mt&&Mt(as,us,ts),us.length>0&&At&&At(us,ts),as.length>0&&Nt&&Nt(as,ts)},[$r,ft,xr,xt,dt,vt,Mt,Nt,At,hr]),es=reactExports.useCallback(function(tn){tn.preventDefault(),tn.persist(),cs(tn),qr.current=[],isEvtWithFiles(tn)&&Promise.resolve(ut(tn)).then(function(ts){isPropagationStopped(tn)&&!Kt||Cn(ts,tn)}).catch(function(ts){return Jr(ts)}),$r({type:"reset"})},[ut,Cn,Jr,Kt]),Xr=reactExports.useCallback(function(){if(Dr.current){$r({type:"openDialog"}),br();var tn={multiple:ft,types:gr};window.showOpenFilePicker(tn).then(function(ts){return ut(ts)}).then(function(ts){Cn(ts,null),$r({type:"closeDialog"})}).catch(function(ts){isAbort(ts)?(vr(ts),$r({type:"closeDialog"})):isSecurityError(ts)?(Dr.current=!1,Cr.current?(Cr.current.value=null,Cr.current.click()):Jr(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):Jr(ts)});return}Cr.current&&($r({type:"openDialog"}),br(),Cr.current.value=null,Cr.current.click())},[$r,br,vr,Ft,Cn,Jr,gr,ft]),en=reactExports.useCallback(function(tn){!yr.current||!yr.current.isEqualNode(tn.target)||(tn.key===" "||tn.key==="Enter"||tn.keyCode===32||tn.keyCode===13)&&(tn.preventDefault(),Xr())},[yr,Xr]),rn=reactExports.useCallback(function(){$r({type:"focus"})},[]),sn=reactExports.useCallback(function(){$r({type:"blur"})},[]),os=reactExports.useCallback(function(){Qt||(isIeOrEdge()?setTimeout(Xr,0):Xr())},[Qt,Xr]),ls=function(ts){return lt?null:ts},rs=function(ts){return Wt?null:ls(ts)},ss=function(ts){return Xt?null:ls(ts)},cs=function(ts){Kt&&ts.stopPropagation()},ps=reactExports.useMemo(function(){return function(){var tn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ts=tn.refKey,as=ts===void 0?"ref":ts,us=tn.role,ds=tn.onKeyDown,gs=tn.onFocus,xs=tn.onBlur,fs=tn.onClick,bs=tn.onDragEnter,js=tn.onDragOver,Es=tn.onDragLeave,ys=tn.onDrop,vs=_objectWithoutProperties(tn,_excluded3);return _objectSpread(_objectSpread(_defineProperty({onKeyDown:rs(composeEventHandlers(ds,en)),onFocus:rs(composeEventHandlers(gs,rn)),onBlur:rs(composeEventHandlers(xs,sn)),onClick:ls(composeEventHandlers(fs,os)),onDragEnter:ss(composeEventHandlers(bs,Qr)),onDragOver:ss(composeEventHandlers(js,Ur)),onDragLeave:ss(composeEventHandlers(Es,nn)),onDrop:ss(composeEventHandlers(ys,es)),role:typeof us=="string"&&us!==""?us:"presentation"},as,yr),!lt&&!Wt?{tabIndex:0}:{}),vs)}},[yr,en,rn,sn,os,Qr,Ur,nn,es,Wt,Xt,lt]),hs=reactExports.useCallback(function(tn){tn.stopPropagation()},[]),ns=reactExports.useMemo(function(){return function(){var tn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ts=tn.refKey,as=ts===void 0?"ref":ts,us=tn.onChange,ds=tn.onClick,gs=_objectWithoutProperties(tn,_excluded4),xs=_defineProperty({accept:xr,multiple:ft,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:ls(composeEventHandlers(us,es)),onClick:ls(composeEventHandlers(ds,hs)),tabIndex:-1},as,Cr);return _objectSpread(_objectSpread({},xs),gs)}},[Cr,it,ft,es,lt]);return _objectSpread(_objectSpread({},Tr),{},{isFocused:Zr&&!lt,getRootProps:ps,getInputProps:ns,rootRef:yr,inputRef:Cr,open:ls(Xr)})}function reducer(He,Qe){switch(Qe.type){case"focus":return _objectSpread(_objectSpread({},He),{},{isFocused:!0});case"blur":return _objectSpread(_objectSpread({},He),{},{isFocused:!1});case"openDialog":return _objectSpread(_objectSpread({},initialState$1),{},{isFileDialogActive:!0});case"closeDialog":return _objectSpread(_objectSpread({},He),{},{isFileDialogActive:!1});case"setDraggedFiles":return _objectSpread(_objectSpread({},He),{},{isDragActive:Qe.isDragActive,isDragAccept:Qe.isDragAccept,isDragReject:Qe.isDragReject});case"setFiles":return _objectSpread(_objectSpread({},He),{},{acceptedFiles:Qe.acceptedFiles,fileRejections:Qe.fileRejections,isDragReject:Qe.isDragReject});case"reset":return _objectSpread({},initialState$1);default:return He}}function noop$1(){}const uploadMedia=async(He,{provider:Qe=MediaProvider.S3,preserveFileType:it,onProgress:lt,signal:ut}={})=>{const dt=He.type.startsWith("image")?MediaType.Image:He.type.startsWith("video")?MediaType.Video:void 0;if(!dt)throw new Error(`Unsupported media type ${dt}`);lt?.(0);const{data:xt}=await executeUploadMedia({input:{type:dt,provider:Qe}},{context:{fetchOptions:{signal:ut}}}),ft=xt?.uploadMedia.uploadUrl,vt=xt?.uploadMedia.externalId;if(!ft)throw new Error("Upload url is not specified");lt?.(.15);const kt=new FormData;kt.append("file",He);const St=dt===MediaType.Image&&Qe!==MediaProvider.S3?{method:"POST",data:kt}:{method:"PUT",data:He},Tt=await axios.request({url:ft,...St,onUploadProgress:At=>{At.progress&&lt?.(.15+At.progress*.7)},signal:ut}),Mt=Qe===MediaProvider.S3?getIdFromS3Url(ft):dt===MediaType.Image?Tt.data?.result?.id:vt,Nt=await executeUploadMedia({input:{type:dt,provider:Qe,externalId:Mt,imageType:it?He.type:void 0}},{context:{fetchOptions:{signal:ut}}});return lt?.(1),{...Nt.data?.uploadMedia,type:dt}};function getIdFromS3Url(He){const Qe=new URL(He),{pathname:it}=Qe;return it.split("/").pop()}function i(He){var Qe=reactExports.useState(function(){return freeze(typeof He=="function"?He():He,!0)}),it=Qe[1];return[Qe[0],reactExports.useCallback(function(lt){it(typeof lt=="function"?produce(lt):freeze(lt))},[])]}const fluentCheckmarkCircle32Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 32 32",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M2 16C2 8.268 8.268 2 16 2s14 6.268 14 14s-6.268 14-14 14S2 23.732 2 16m20.707-3.293a1 1 0 0 0-1.414-1.414L14.5 18.086l-3.293-3.293a1 1 0 0 0-1.414 1.414l4 4a1 1 0 0 0 1.414 0z"})}),fluentDismiss24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m4.21 4.387l.083-.094a1 1 0 0 1 1.32-.083l.094.083L12 10.585l6.293-6.292a1 1 0 1 1 1.414 1.414L13.415 12l6.292 6.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.32.083l-.094-.083L12 13.415l-6.293 6.292a1 1 0 0 1-1.414-1.414L10.585 12L4.293 5.707a1 1 0 0 1-.083-1.32l.083-.094z"})}),$personalEvents=client.subscribePersonalEvents({}).pipe(map$2(He=>He.personalEvents),filter$3(He=>He!=null));window.$personalEvents=$personalEvents;const mapEvents=(He,Qe)=>He.pipe(map$2(it=>it[Qe]),filter$3(it=>it!=null)),$taskUpdated=new Subject,$newNotification=new Subject;mapEvents($personalEvents,"taskUpdated").subscribe($taskUpdated);mapEvents($personalEvents,"newNotification").subscribe($newNotification);const useListMyTasks=modifyQueryHook(createQueryHook(ListMyTasksDocument),{transform:He=>({...He,parameterFields:taskParameterFieldsForTaskList}),reduce:He=>He?.me?.tasks}),useInfinityListMyTasks=infiniteQueryHook(useListMyTasks),fetchListMyTasks=createFetchQueryHelper(ListMyTasksDocument),useListUserTasks=modifyQueryHook(createQueryHook(ListUserTasksDocument),{transform:He=>({...He,parameterFields:taskParameterFieldsForTaskList}),reduce:He=>He?.tasks}),usePagedListUserTasks=pagedQueryHook(useListUserTasks),fetchListUserTasks=createFetchQueryHelper(ListUserTasksDocument),useListUserTaskSummaries=modifyQueryHook(createQueryHook(ListUserTaskSummariesDocument),{reduce:He=>He?.taskSummaries}),useGetTaskById=modifyQueryHook(createQueryHook(GetTaskByIdDocument),{transform:He=>({id:He}),reduce:He=>He?.task}),useTaskById=(He,Qe)=>{const it=useWsConnectionStatus({detailed:!1});return useGetTaskById(He,{pollInterval:it?0:5e3,...Qe})},updateGetTaskById=(He,Qe)=>{cache$1.updateQuery({query:GetTaskByIdDocument,variables:{id:He}},()=>({task:{__typename:"Task",...Qe}}))},refetchGetTaskById=He=>{baseApolloClient.refetchQueries({updateCache(Qe){Qe.evict({id:Qe.identify({__typename:"Task",id:He})})}})};$taskUpdated.subscribe(He=>{updateGetTaskById(He.id,He)});const fetchGetTaskById=createFetchQueryHelper(GetTaskByIdDocument),[useCreateGenerationTask,executeCreateGenerationTask]=createMutationHelper(CreateGenerationTaskDocument),[useCreateArtworkFromTaskV2,executeCreateArtworkFromTaskV2]=createMutationHelper(CreateArtworkFromTaskV2Document),[useCancelGenerationTask,executeCancelGenerationTask]=createMutationHelper(CancelGenerationTaskDocument),[useDeleteGenerationTask,executeDeleteGenerationTask]=createMutationHelper(DeleteGenerationTaskDocument),[useRerunGenerationTask,executeRerunGenerationTask]=createMutationHelper(RerunGenerationTaskDocument),[useUpdateGenerationTask,executeUpdateGenerationTask]=createMutationHelper(UpdateGenerationTaskDocument),[useCreateTrainingTask,executeCreateTrainingTask]=createMutationHelper(CreateTrainingTaskDocument),[useCreateGrowthEventTask,executeCreateGrowthEventTask]=createMutationHelper(CreateGrowthEventTaskDocument),GRID_CLASSNAME="grid grid-cols-[repeat(auto-fill,var(--item-width))] gap-[--gap-size] mx-[--gap-size] justify-center",PAGE_SIZE$1=30;function TaskOutputGrid(He){const{renderItem:Qe=({content:Ft})=>Ft,itemWidth:it=120,gapSize:lt=4,...ut}=He,{me:dt}=useMe(),{data:xt,loading:ft,loadingMore:vt,fetchMore:kt}=useInfinityListMyTasks(dt?{last:PAGE_SIZE$1}:skipToken),St=ft||vt,Tt=reactExports.useMemo(()=>ft||!!xt?.pageInfo.hasPreviousPage,[xt,ft]),Mt=reactExports.useMemo(()=>{const Ft=uniq(compact(getNodesFromConnection(xt).reverse().flatMap(Bt=>Bt.outputs?.batch?.length>0?Bt.outputs.batch.map(Ot=>Ot.mediaId):Bt.mediaId)))??[];return Tt&&St&&Ft.push(...Array.from({length:3})),Ft},[xt,Tt,St]),[Nt,At]=reactExports.useState(null),{ref:$t,entry:Dt}=useIntersection({root:Nt});return useDebounce(()=>{!St&&Dt?.isIntersecting&&kt({variables:{before:xt?.pageInfo?.startCursor}})},100,[Dt?.isIntersecting,St,kt]),jsxRuntimeExports.jsx("div",{...ut,style:{...He.style,"--item-width":typeof it=="number"?it+"px":it,"--gap-size":lt+"px"},children:jsxRuntimeExports.jsx(Yr,{scrollerRef:At,data:Mt,context:{havingMore:Tt,empty:!ft&&Mt.length===0,setFooter:$t},itemContent:(Ft,Bt)=>Bt==null?jsxRuntimeExports.jsx("div",{className:"w-full aspect-square",style:{opacity:1-1/3*(3-(Mt.length-Ft))},children:jsxRuntimeExports.jsx("div",{className:"size-full bg-black/20 dark:bg-white/20 rounded animate-pulse"})}):Qe({content:jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:Bt,thumbnail:!0,preferStill:!0,className:"w-full aspect-square rounded ring-1 ring-black/10 dark:ring-black/20"},Bt),mediaId:Bt}),listClassName:cx(GRID_CLASSNAME),components:{Footer:TaskOutputGridFooter}})})}function TaskOutputGridFooter(He){const{havingMore:Qe,empty:it}=He.context??{};return jsxRuntimeExports.jsxs("div",{ref:He.context?.setFooter,className:cx("pb-[--gap-size] text-sm text-center text-neutral-500",GRID_CLASSNAME),children:[jsxRuntimeExports.jsx("div",{className:"row-start-1 col-start-1 w-full aspect-square"}),jsxRuntimeExports.jsx("div",{className:"row-start-1 col-start-1 col-span-full flex justify-center items-center",children:Qe?jsxRuntimeExports.jsx(Text,{i18nKey:"common:hint.loading"}):it?jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:search-results.empty-without-keyword"}):jsxRuntimeExports.jsx(Text,{i18nKey:"common:list-reached-the-end"})})]})}function TaskMediaPicker(He){const[Qe,it]=i(()=>new Set);reactExports.useEffect(()=>{He.open&&He.defaultValue?it(new Set([He.defaultValue].flat())):He.open||it(new Set)},[He.defaultValue,He.open,it]);function lt(ut){He.multiple?it(dt=>{dt.has(ut)?dt.delete(ut):dt.add(ut)}):(He.onSubmit?.(ut),He.onClose?.())}return jsxRuntimeExports.jsxs(UIDialogResponsive,{open:He.open,onClose:He.onClose,className:"flex flex-col mmd:w-[796px] h-[calc(var(--visible-height)-80px)]",dismissable:!0,children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:jsxRuntimeExports.jsx("span",{className:"capitalize",children:jsxRuntimeExports.jsx(Text,{i18nKey:"workflow:parameter.inputs.media.dialog.title"})})}),jsxRuntimeExports.jsxs(UIDialogContent,{className:"flex-1 flex flex-col",children:[jsxRuntimeExports.jsx("section",{className:"flex-1",children:jsxRuntimeExports.jsx(TaskOutputGrid,{renderItem:({content:ut,mediaId:dt})=>{const xt=Qe.has(dt);return jsxRuntimeExports.jsxs("div",{className:cx("relative transition",xt&&"scale-90"),onClick:()=>lt(dt),children:[jsxRuntimeExports.jsx("div",{className:cx(xt&&"opacity-50"),children:ut}),xt&&jsxRuntimeExports.jsx(fluentCheckmarkCircle32Filled,{className:"absolute inset-0 m-auto size-8 text-purple-600 bg-black rounded-full"})]})},className:"h-full"})}),He.multiple&&jsxRuntimeExports.jsxs("section",{className:"flex-none mt-4 flex gap-2 h-12 overflow-x-auto",children:[jsxRuntimeExports.jsxs("button",{className:"group sticky left-0 grid place-content-center h-full aspect-square bg-background-light rounded",onClick:()=>{it(ut=>{ut.clear()})},children:[jsxRuntimeExports.jsx("div",{className:"contents group-hover:hidden",children:jsxRuntimeExports.jsx("span",{children:Qe.size})}),jsxRuntimeExports.jsx(fluentDismiss24Filled,{className:"size-6 hidden group-hover:block"})]}),Array.from(Qe).map(ut=>jsxRuntimeExports.jsxs("button",{className:"group flex-none relative h-full aspect-square overflow-hidden rounded",onClick:()=>{it(dt=>{dt.delete(ut)})},children:[jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:ut,thumbnail:!0,preferStill:!0,className:"size-full"}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 grid place-content-center bg-black/50 invisible group-hover:visible",children:jsxRuntimeExports.jsx(fluentDismiss24Filled,{className:"size-6 text-white"})})]},ut))]})]}),jsxRuntimeExports.jsxs(UIDialogFooter,{className:"flex gap-2 msm:justify-start",children:[He.showFileUpload&&jsxRuntimeExports.jsx($1e2864c73f66a4da$export$6fb4a10d2c950550,{acceptedFileTypes:["image/jpeg","image/png"],allowsMultiple:He.multiple,onSelect:async ut=>{ut&&He.onSelectedFiles?.([...ut])},children:jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",className:"capitalize",children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:image-edit.upload-image"})})}),jsxRuntimeExports.jsx(UIButton$1,{className:"capitalize",variant:"outlined",onPress:He.onClose,children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:cancel"})}),He.multiple&&jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",className:"capitalize",onPress:()=>{He.onSubmit?.(Array.from(Qe)),He.onClose?.()},children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:confirm"})})]})]})}const DEFAULT_MIME_TYPES=["image/jpeg","image/png","image/heic","image/heif","image/webp"],DEFAULT_FEATURES={dragDrop:!0,uploadButton:!0,taskPicker:!0,nativeGallery:!0,nativeCamera:!0,buttons:!0};function mergeConfig(He,Qe){return{...He,...Qe}}function getImageUrl(He,Qe){if(He)return getPublicUrl(He);if(Qe)return URL.createObjectURL(Qe)}const ImageSource=reactExports.forwardRef(({value:He,onChange:Qe=()=>{},disabled:it,supportedMimeTypes:lt,size:ut="md",onUpload:dt=()=>{},onImageSelect:xt=()=>{},preHandleImage:ft=Qt=>Qt,onTaskMediaPicked:vt=()=>{},features:kt,labels:St,buttonProps:Tt,buttonGroupProps:Mt,dropzoneOptions:Nt,taskPickerShowFileUpload:At=!1,placeholderElement:$t,fileHandleElement:Dt,className:Ft,...Bt},Ot)=>{const{t:Qt}=useTranslation(["action","generation","common"]),[Wt,Xt]=reactExports.useState(),[Kt,Jt]=reactExports.useState(!1),hr=reactExports.useMemo(()=>({features:mergeConfig(DEFAULT_FEATURES,kt)}),[kt]),xr=lt||DEFAULT_MIME_TYPES,gr=reactExports.useMemo(()=>xr.reduce((en,rn)=>(en[rn]=[],en),{}),[xr]),br=reactExports.useMemo(()=>getImageUrl(He,Wt),[He,Wt]),vr=reactExports.useMemo(()=>{switch(ut){case"sm":return"size-[200px] md:size-[250px]";case"md":return"size-[300px] md:size-[400px]";case"lg":return"size-[400px] md:size-[500px]";case"custom":return"";default:return"size-[300px] md:size-[400px]"}},[ut]),[yr,Cr]=reactExports.useState(),[Rr,Ir]=useLoadingCallback(async en=>{dt(!0);try{Cr(void 0);const rn=await uploadMedia(en);Qe(rn.media),Xt(void 0)}catch(rn){console.error(rn),Cr(rn)}finally{dt(!1)}},[dt]),Tr=reactExports.useCallback(async en=>{const rn=en[0];if(rn){xt(rn);const sn=await ft(rn);Xt(sn),Ir(sn)}},[]),{getRootProps:$r,getInputProps:Zr,inputRef:Sr}=useDropzone({onDrop:Tr,multiple:!1,disabled:it||!hr.features.dragDrop,accept:gr,...Nt}),Dr=reactExports.useCallback(async en=>{en&&(Xt(en),Ir(en))},[He]),wr=reactExports.useCallback(async en=>{const rn=await fetchGetMedia({id:en});rn.data.media&&(vt?.(rn.data.media),Qe(rn.data.media)),Jt(!1)},[Qe]),qr=reactExports.useCallback(async en=>{const rn=en[0];if(rn){xt(rn);const sn=await ft(rn);Xt(sn),Ir(sn)}},[xt,ft,Ir]),Nr=isAndroidWebview(),Jr=isAppWebview(),Qr=reactExports.useCallback(async()=>{const en=await pickMedia({mimeTypes:xr});if(en?.mediaId){const rn=await fetchGetMedia({id:en.mediaId});rn.data.media&&Qe(rn.data.media)}},[xr,Qe]),Ur=reactExports.useCallback(async()=>{const en=await takePhoto();if(en?.mediaId){const rn=await fetchGetMedia({id:en.mediaId});rn.data.media&&Qe(rn.data.media)}},[Qe]),nn=()=>{Sr.current?.click()};reactExports.useImperativeHandle(Ot,()=>({click:()=>Jt(!0)}),[nn]);const Cn=reactExports.useMemo(()=>typeof $t=="function"?$t(Jr):$t??jsxRuntimeExports.jsx("div",{className:"text-center font-bold underline",dangerouslySetInnerHTML:{__html:Qt("action:image-source.hint",{br:"<br />",context:Jr?"native":""})}}),[$t,Jr,Qt]),es=jsxRuntimeExports.jsxs("div",{className:cx(vr,`
        border-2 border-dashed rounded-2xl
        flex justify-center items-center
        transition-all hover:transition-all
        text-primary-light font-mono
        `,{"hover:bg-hover/80 text-black/80 dark:hover:text-white/80  cursor-pointer":!it&&hr.features.dragDrop},Ft),...Bt,...hr.features.dragDrop?$r():{},children:[br?jsxRuntimeExports.jsxs("div",{className:"w-full h-full relative flex items-center overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"w-full h-full bg-center bg-contain bg-no-repeat rounded-2xl",style:{backgroundImage:`url(${br})`}}),yr?jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 p-8 bg-black bg-opacity-70 text-white flex flex-col justify-center items-center",children:[jsxRuntimeExports.jsx("span",{children:St?.uploadFailed||Qt("common:error:failed-to-upload")}),jsxRuntimeExports.jsx("span",{className:"whitespace-pre-wrap break-all",children:yr?.message})]}):Rr?jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70 text-white flex justify-center items-center rounded-2xl",children:St?.uploading||Qt("action:uploading")}):null]}):Cn,!Nr&&jsxRuntimeExports.jsx("input",{...Zr()}),!Rr&&!yr?Dt?.({action:Dr}):null]}),Xr=()=>{if(!hr.features.buttons)return null;const{variant:en,...rn}=Tt??{},sn=en??"outlined",os=[];if(hr.features.taskPicker&&os.push(jsxRuntimeExports.jsx(UIButton$1,{variant:sn,onPress:()=>Jt(!0),...rn,children:St?.fromTask||Qt("action:image-source.from-task")},"task-picker")),hr.features.uploadButton&&!Nr&&os.push(jsxRuntimeExports.jsx(UIButton$1,{variant:sn,onPress:nn,...rn,children:St?.fromUpload||Qt("action:image-source.from-upload")},"upload")),Nr&&hr.features.nativeGallery&&os.push(jsxRuntimeExports.jsx(UIButton$1,{variant:sn,onPress:Qr,...rn,children:St?.fromNativeGallery||Qt("action:image-source.from-native-photo-gallery")},"gallery")),Nr&&hr.features.nativeCamera&&os.push(jsxRuntimeExports.jsx(UIButton$1,{variant:sn,onPress:Ur,...rn,children:St?.fromNativeCamera||Qt("action:image-source.from-native-camera")},"camera")),os.length===0)return null;const{className:ls,...rs}=Mt??{};return jsxRuntimeExports.jsx("div",{className:ls??"flex flex-col gap-2 flex-wrap w-full",...rs,children:os})};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[es,Xr(),hr.features.taskPicker&&jsxRuntimeExports.jsx(TaskMediaPicker,{open:Kt,onClose:()=>Jt(!1),multiple:!1,onSubmit:wr,showFileUpload:At,onSelectedFiles:qr})]})});function UIForm({form:He,onSubmit:Qe,...it}){return jsxRuntimeExports.jsx($d3e0e05bdfcf66bd$export$a7fed597f4b8afd8,{onSubmit:He.onSubmit(Qe),...it})}const uiFormLabelStyles=ce$1({base:"text-sm font-medium text-gray-800 dark:text-gray-200",variants:{size:{sm:"text-xs",md:"text-sm",lg:"text-base"},weight:{normal:"font-normal",medium:"font-medium",semibold:"font-semibold",bold:"font-bold"},color:{default:"text-gray-800 dark:text-gray-200",muted:"text-gray-600 dark:text-gray-400"},required:{true:'after:content-["*"] after:text-red-500 after:ml-1'}},defaultVariants:{size:"md",weight:"medium",color:"default",required:!1}});function UIFormLabel({size:He,weight:Qe,color:it,required:lt,className:ut,children:dt,...xt}){const ft=uiFormLabelStyles({size:He,weight:Qe,color:it,required:lt,className:ut});return jsxRuntimeExports.jsx($01b77f81d0f07f68$export$b04be29aa201d4f5,{className:ft,...xt,children:dt})}const uiFormTextFieldStyles=ce$1({variants:{layout:{vertical:"flex flex-col gap-2",horizontal:"flex flex-row gap-3"}}});function UIFormTextField({input:He,children:Qe,layout:it,...lt}){const ut=He.error!==void 0,dt=uiFormTextFieldStyles({layout:it});return jsxRuntimeExports.jsx($bcdf0525bf22703d$export$2c73285ae9390cec,{isInvalid:ut,className:dt,...lt,children:Qe(He)})}function UIFormRadioGroup({input:He,children:Qe,...it}){const{value:lt,defaultValue:ut}=He;return jsxRuntimeExports.jsx($b6c3ddc6086f204d$export$a98f0dcb43a68a25,{value:lt,defaultValue:ut,...it,children:Qe})}const uiFormDescriptionStyles=ce$1({slots:{description:"text-sm text-gray-600 dark:text-gray-400",error:"text-sm text-red-600 dark:text-red-400"}});function UIFormDescription({input:He,children:Qe,textProps:it,errorProps:lt}){const ut=uiFormDescriptionStyles(),{className:dt,...xt}=it||{};return He?.error?jsxRuntimeExports.jsx($ee014567cb39d3f0$export$f551688fc98f2e09,{className:ut.error(),...lt,children:He.error}):Qe?jsxRuntimeExports.jsx($514c0188e459b4c0$export$5f1af8db9871e1d6,{slot:"description",className:ut.description({className:dt}),...xt,children:Qe}):null}const useGetTag=modifyQueryHook(createQueryHook(GetTagDocument),{transform:He=>({name:He}),reduce:He=>He?.tag}),useListTags=modifyQueryHook(createQueryHook(ListTagsDocument),{reduce:He=>He?.tags}),useGetContest=modifyQueryHook(createQueryHook(GetContestDocument),{transform:He=>({id:He}),reduce:He=>He?.contest}),useListContests=modifyQueryHook(createQueryHook(ListContestsDocument),{reduce:He=>He?.contests}),isContestEnded=He=>new Date(He.endAt).getTime()<=new Date().getTime(),isContestInProgress=He=>new Date().getTime()>=new Date(He.startAt).valueOf()&&!isContestEnded(He),useContestConfig=()=>{const{data:He}=useListContests({last:5}),[{preview:Qe}]=useQs(),it=reactExports.useMemo(()=>getNodesFromConnection(He),[He]);return reactExports.useMemo(()=>it.map(ut=>({...ut,isEnded:isContestEnded(ut),isInProgress:isContestInProgress(ut)})),[it,Qe])},icBaselineRemove=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 13H5v-2h14v2z"})});function createTagPageUrl(He,Qe){const it=encodeURIComponent(Qe);return $$3(He).with("artwork",()=>`/artwork/tags/${it}`).with("model",()=>`/model/tags/${it}`).exhaustive()}const TagCategory={Contest:"contest",Category:"category",Feature:"feature",Other:"other"},isTagObject=He=>typeof He=="object"&&He!==null,getTagName=He=>isTagObject(He)?He.name:He,getTagCategory=He=>{const Qe=He.extra?.recommendType||He.extra?.category;return $$3(Qe).with(N$4.union("style","ip","character"),()=>TagCategory.Category).with("feature",()=>TagCategory.Feature).with("contest",()=>TagCategory.Contest).otherwise(()=>TagCategory.Other)},TagChipVariant=ce$1({defaultVariants:{variant:"selection",size:"medium"},slots:{tag:"rounded-full ",button:"rounded-full ",media:"rounded-full ",icon:"rounded-full "},variants:{variant:{selection:{tag:"bg-gray-100 dark:bg-gray-700",icon:"text-black dark:text-white bg-gray-300 dark:bg-gray-500"},recommendation:{}},size:{small:{button:"text-xs py-0.5 px-1 gap-1",media:"size-3",icon:"size-3"},medium:{button:"text-sm py-1 px-2 gap-2",media:"size-4",icon:"size-4"},large:{button:"text-md py-2 px-4 gap-3",media:"size-5",icon:"size-5"}},category:{contest:{},feature:{},category:{},other:{}},type:{add:{},remove:{}}},compoundVariants:[{category:["contest","feature","category","other"],type:"add",variant:"recommendation",className:{button:"outline outline-1"}},{category:["contest","feature","category","other"],type:"remove",variant:"recommendation",className:{button:"outline outline-2"}},{category:"contest",variant:"selection",className:{button:"text-orange-500"}},{category:"contest",variant:"recommendation",className:{button:"text-[var(--contest-accent-light)] outline-[var(--contest-accent-light)] dark:text-[var(--contest-accent-dark)] dark:outline-[var(--contest-accent-dark)]"}},{category:"category",variant:"recommendation",className:{button:"text-purple-500 outline-purple-500"}},{category:"feature",variant:"recommendation",className:{button:"text-green-500 outline-green-500"}}]}),TagChip=({type:He,tag:Qe,onAdd:it,onRemove:lt,variant:ut,size:dt,category:xt})=>{const{t:ft}=useTranslation(["artwork"]),vt=Mt=>{He==="add"?it(Mt):He==="remove"&&lt(Mt)},kt=TagChipVariant({variant:ut,size:dt,category:xt,type:He}),St=Qe.contest?{"--contest-accent-light":Qe.contest.lightAccentColor,"--contest-accent-dark":Qe.contest.darkAccentColor}:{},Tt=jsxRuntimeExports.jsx(UIButton$1,{slot:"remove",variant:"ghost",onPress:()=>vt(Qe.tag),className:cx(kt.button()),style:St,size:"large",icon:isTagObject(Qe.tag)&&Qe.tag.mediaId&&jsxRuntimeExports.jsx(MediaPreview$1,{className:kt.media(),mediaId:Qe.tag.mediaId}),endIcon:$$3(He).with("add",()=>jsxRuntimeExports.jsx(icBaselineAdd,{className:kt.icon()})).with("remove",()=>jsxRuntimeExports.jsx(icBaselineRemove,{className:kt.icon()})).exhaustive(),children:Qe.name});return Qe.contest?jsxRuntimeExports.jsx($eaf9e70818b436db$export$3288d34c523a1192,{className:kt.tag(),children:jsxRuntimeExports.jsx(UITooltipTriggerWrapper,{placement:"top",delay:100,trigger:Tt,children:jsxRuntimeExports.jsx("span",{className:"p-2",children:ft("artwork:join-contest.click-to-join")})})}):jsxRuntimeExports.jsx($eaf9e70818b436db$export$3288d34c523a1192,{className:kt.tag(),children:Tt})},TagChipGroup=({chips:He,size:Qe})=>jsxRuntimeExports.jsx($eaf9e70818b436db$export$67ea30858aaf75e3,{children:jsxRuntimeExports.jsx($eaf9e70818b436db$export$f9fef0f55402315b,{className:"flex flex-wrap gap-2",children:He.map(it=>jsxRuntimeExports.jsx(TagChip,{...it,size:Qe},it.tag.name))})}),TagRecommendationComponent=({selectedTags:He,onTagSelected:Qe,onTagRemove:it,onTagRecommendationLoaded:lt,challenge:ut,onChallengeChange:dt,mediaId:xt,isVideoTask:ft})=>{const{t:vt}=useTranslation(["common"]),{tags:kt,loading:St,error:Tt}=useRecommendedTags({mediaId:xt,isVideoTask:ft,limit:20});reactExports.useEffect(()=>{const $t=kt.find(Dt=>Dt.category===TagCategory.Category);$t&&lt?.($t.data.map(Dt=>Dt.tag))},[lt,kt]);const Mt=reactExports.useCallback(($t,Dt)=>$t===TagCategory.Contest&&Dt.contest?.contestId?ut===Dt.contest.contestId:He.some(Ft=>getTagName(Ft)===Dt.name),[ut,He]),Nt=reactExports.useCallback(($t,Dt,Ft)=>{if(track("add_tag",{name:Ft.name,challenge:ut,recommendType:$t,selected:Dt==="add"}),Dt==="add"?Qe(Ft.tag):it(Ft.tag),$t===TagCategory.Contest&&Ft.contest?.contestId){const Bt=$$3(Dt).with("add",()=>Ft.contest?.contestId).with("remove",()=>{}).exhaustive();dt(Bt)}},[ut,dt,it,Qe]),At=reactExports.useMemo(()=>kt.map($t=>({category:$t.category,tags:$t.data.map(Dt=>({type:Mt($t.category,Dt)?"remove":"add",tag:Dt,onAdd:()=>Nt($t.category,"add",Dt),onRemove:()=>Nt($t.category,"remove",Dt),variant:"recommendation",category:$t.category}))})),[kt,Mt,Nt]);return St?jsxRuntimeExports.jsx("div",{className:"flex flex-col flex-wrap justify-center gap-2 p-4 rounded-md relative",children:jsxRuntimeExports.jsx(Preloader,{})}):Tt?(console.error(`failed to recommend tags by media: ${xt}`,Tt),null):jsxRuntimeExports.jsxs("div",{className:cx("flex flex-col flex-wrap justify-center gap-2 p-4 rounded-md relative"),children:[jsxRuntimeExports.jsx("h4",{className:"text-gray-400 pb-1 absolute top-2 right-2",children:vt("common:common.suggested")}),At.map($t=>{if($t.category===TagCategory.Other||$t.tags.length===0)return null;let Dt=$t.category;return $t.category==="category"&&(Dt=vt("common:category.label")),$t.category==="feature"&&(Dt=vt("common:common.feature")),jsxRuntimeExports.jsxs("div",{className:"inline-flex flex-col gap-2",children:[jsxRuntimeExports.jsx("div",{className:"text-gray-700 dark:text-gray-300 uppercase text-sm tracking-wider",children:Dt}),jsxRuntimeExports.jsx(TagChipGroup,{chips:$t.tags.slice(0,12),size:"medium"})]},$t.category)})]})},TagRecommendation=reactExports.memo(TagRecommendationComponent),useRecommendedTags=({mediaId:He,isVideoTask:Qe,limit:it=30})=>{const lt=useContestConfig(),{data:ut,loading:dt,error:xt}=useListTags(He?{first:it,mediaId:He}:skipToken),ft=reactExports.useMemo(()=>getNodesFromConnection(ut),[ut]),vt=reactExports.useMemo(()=>lt.filter(Mt=>!(!Mt.isInProgress||Mt.extra.artworkType===ArtworkType.AnimatedArtwork&&!Qe)),[lt,Qe]),kt=reactExports.useMemo(()=>ft.filter(Mt=>vt.every(Nt=>Nt.name!==Mt.name))||[],[ft,vt]),St=reactExports.useMemo(()=>{const Nt=kt.map(Dt=>({category:getTagCategory(Dt),tag:Dt,name:getTagName(Dt),contest:void 0})).reduce((Dt,Ft)=>(Dt[Ft.category]||(Dt[Ft.category]=[]),Dt[Ft.category].push(Ft),Dt),{}),At=Object.entries(Nt).map(([Dt,Ft])=>({category:Dt,data:Ft.map(Bt=>({tag:Bt.tag,name:Bt.name,contest:Bt.contest}))})),$t={category:TagCategory.Contest,data:vt.map(Dt=>({tag:{__typename:"Tag",id:Dt.id,name:Dt.name,createdAt:Dt.createdAt,updatedAt:Dt.updatedAt,media:Dt.media,mediaId:Dt.mediaId,extra:{recommendType:"contest"}},name:Dt.name,contest:{contestId:Dt.cid,lightAccentColor:Dt.extra.lightAccentColor,darkAccentColor:Dt.extra.darkAccentColor}}))};return[...At,$t]},[vt,kt]),Tt=[TagCategory.Contest,TagCategory.Category,TagCategory.Feature,TagCategory.Other];return St.sort((Mt,Nt)=>Tt.indexOf(Mt.category)-Tt.indexOf(Nt.category)),{tags:St,loading:dt,error:xt}},useSearchTag$1=He=>{const[Qe,it]=reactExports.useState(""),[lt,ut]=reactExports.useState(""),dt=reactExports.useMemo(()=>debounce(St=>ut(St),200),[]),xt=reactExports.useCallback(St=>{it(St),dt(St)},[dt]),{data:ft,loading:vt}=useListTags({first:20,q:lt,feed:"auto_complete"}),kt=reactExports.useMemo(()=>getNodesFromConnection(ft),[ft]);return{inputValue:Qe,onInputValueChange:xt,tags:kt,loading:vt}},TagSelect$1=({value:He,label:Qe,onTagSelected:it,onTagRemove:lt})=>{const{t:ut}=useTranslation(["artwork"]),[dt,xt]=reactExports.useState(!1),{onInputValueChange:ft,tags:vt}=useSearchTag$1(),kt=useForm({initialValues:{input:""},onValuesChange:Mt=>{ft(Mt.input)}}),St=Mt=>{const Nt=vt.find(At=>At.id===Mt);Nt&&(xt(!1),it(Nt),kt.setFieldValue("input",""))},Tt=Mt=>{if(Mt.key==="Enter"){Mt.preventDefault(),Mt.stopPropagation();const At=kt.getValues().input.split(",").map($t=>$t.trim()).filter($t=>$t.length>0);for(const $t of At){const Dt=vt.find(Ft=>Ft.name===$t);it(Dt||$t)}kt.setFieldValue("input","")}};return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(UIFormTextField,{layout:"vertical",input:kt.getInputProps("input"),children:Mt=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIFormLabel,{children:Qe}),jsxRuntimeExports.jsx(TagChipGroup,{chips:He.map(Nt=>({tag:{name:getTagName(Nt),tag:Nt},type:"remove",onAdd:it,onRemove:lt,variant:"selection",category:isTagObject(Nt)?getTagCategory(Nt):void 0})),size:"medium"}),jsxRuntimeExports.jsx(UIInput,{...Mt,variant:"rounded-normal",placeholder:ut("artwork:tag-placeholder"),onFocus:()=>xt(!0),onKeyDownCapture:Tt})]})}),dt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>xt(!1)}),jsxRuntimeExports.jsx("div",{className:cx("absolute top-full left-0 right-0 z-20 mt-1","transform transition-all duration-200 ease-out","animate-in fade-in-0 zoom-in-95 slide-in-from-top-2"),children:jsxRuntimeExports.jsx($eed445e0843c11d0$export$41f133550aa26f48,{items:vt,className:cx("outline-none rounded-lg shadow-lg overflow-y-auto border flex flex-col max-h-80","bg-white dark:bg-neutral-800 border-gray-200 dark:border-neutral-700"),onAction:St,renderEmptyState:()=>jsxRuntimeExports.jsx(Preloader,{}),children:Mt=>jsxRuntimeExports.jsxs($eed445e0843c11d0$export$a11e76429ed99b4,{className:twMerge("flex items-center gap-2 text-base cursor-pointer","px-4 py-2","hover:bg-neutral-200 dark:hover:bg-neutral-700","text-gray-900 dark:text-gray-100"),children:[Mt.mediaId&&jsxRuntimeExports.jsx(MediaPreview$1,{className:"w-6 h-6 rounded-full",mediaId:Mt.mediaId}),jsxRuntimeExports.jsx("span",{children:Mt.name})]},Mt.id)})})]})]})},materialSymbolsCheck=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m9.55 18l-5.7-5.7l1.425-1.425L9.55 15.15l9.175-9.175L20.15 7.4L9.55 18Z"})}),checkboxStyles=ce$1({slots:{root:"group flex gap-2 items-start cursor-pointer disabled:cursor-not-allowed",checkbox:["mt-0.5 size-4 rounded border-2 border-black/50 dark:border-white/50 flex items-center justify-center transition-colors","group-hover:border-black/70 dark:group-hover:border-white/70","group-focus-visible:outline outline-2 outline-offset-1 outline-black/80 dark:outline-white/80","group-selected:bg-black dark:group-selected:bg-white group-selected:border-black dark:group-selected:border-white","group-disabled:opacity-50"],content:"flex flex-col gap-1",label:"text-sm leading-tight",description:"text-xs text-black/60 dark:text-white/60 leading-tight",error:"text-xs text-red-500 dark:text-red-400 leading-tight",checkIcon:["size-3 text-white dark:text-black opacity-0 transition-opacity","group-selected:opacity-100"]},variants:{hasDescription:{true:{},false:{}}},defaultVariants:{hasDescription:!1}}),UICheckbox=reactExports.forwardRef(function He(Qe,it){const{className:lt,style:ut,children:dt,description:xt,isSelected:ft,onChange:vt,mantineInput:kt,...St}=Qe,Tt=ft??kt?.value??!1,Mt=At=>{vt?.(At),kt?.onChange?.(At)},Nt=checkboxStyles({hasDescription:!!xt});return jsxRuntimeExports.jsx($bc237834342dbd75$export$48513f6b9f8ce62d,{ref:it,className:Nt.root({className:lt}),style:ut,isSelected:Tt,onChange:Mt,...St,children:$64fa3d84918910a7$export$c245e6201fed2f75(dt,At=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:Nt.checkbox(),children:jsxRuntimeExports.jsx(materialSymbolsCheck,{className:Nt.checkIcon()})}),jsxRuntimeExports.jsxs("div",{className:Nt.content(),children:[At&&jsxRuntimeExports.jsx("div",{className:Nt.label(),children:At}),xt&&jsxRuntimeExports.jsx("div",{className:Nt.description(),children:xt}),kt?.error&&jsxRuntimeExports.jsx("div",{className:Nt.error(),children:kt.error})]})]}))})}),defaultGeneratorOptions=["NovelAI","Waifu Diffusion","Stable Diffusion","TrinArt","Midjourney","Dalle-2","Ernie-vilg","Unstable Diffusion","Hentai Diffusion","Custom Model","niji・journey","Anything3","Meitu AI Painting","Rivera","Holara","ACertainThing","Anything4","CounterfeitV2"],DetailParamsEditFormItems=({form:He})=>{const{t:Qe}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIFormTextField,{input:He.getInputProps("extra.externalParameters.negativePrompts"),layout:"vertical",children:it=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIFormLabel,{children:Qe("generation:negative-prompts.label")}),jsxRuntimeExports.jsx(UITextArea,{variant:"rounded-normal",value:it.value||"",defaultValue:it.defaultValue,onChange:lt=>He.setFieldValue("extra.externalParameters.negativePrompts",lt.target.value),rows:3})]})}),jsxRuntimeExports.jsx(UIFormTextField,{input:He.getInputProps("extra.externalParameters.samplingSteps"),layout:"vertical",children:it=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIFormLabel,{children:Qe("generation:sampling-steps.label")}),jsxRuntimeExports.jsx(UIInput,{...it,type:"number",value:it.value||""})]})}),jsxRuntimeExports.jsx(UIFormTextField,{input:He.getInputProps("extra.externalParameters.samplingMethod"),layout:"vertical",children:it=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIFormLabel,{children:Qe("generation:sampling-method.label")}),jsxRuntimeExports.jsx(UIInput,{...it,value:it.value||""})]})}),jsxRuntimeExports.jsx(UIFormTextField,{input:He.getInputProps("extra.externalParameters.cfgScale"),layout:"vertical",children:it=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIFormLabel,{children:Qe("generation:cfg-scale.label")}),jsxRuntimeExports.jsx(UIInput,{...it,type:"number",value:it.value||""})]})}),jsxRuntimeExports.jsx(UIFormTextField,{input:He.getInputProps("extra.externalParameters.seed"),layout:"vertical",children:it=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIFormLabel,{children:Qe("generation:seed.label")}),jsxRuntimeExports.jsx(UIInput,{...it,value:it.value||""})]})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx(UIFormLabel,{children:Qe("generation:generator.label")}),jsxRuntimeExports.jsx(Autocomplete,{freeSolo:!0,value:He.getInputProps("extra.externalParameters.generator").value||"",onChange:(it,lt)=>He.setFieldValue("extra.externalParameters.generator",lt),options:defaultGeneratorOptions,renderInput:it=>jsxRuntimeExports.jsx(TextField,{...it,size:"small"})})]})]})},mapTaskToArtworkInfoFormValue=(He,Qe)=>{const it=He.artworks??[],lt=it.length>0?it[0]:void 0;return{title:Qe?.title??lt?.title??"",prompts:Qe?.prompts??lt?.prompts??He.parameters?.prompts??"",tags:Qe?.tags??lt?.tags??[],hidePrompts:Qe?.hidePrompts??lt?.hidePrompts??!1,isPrivate:Qe?.isPrivate??lt?.isPrivate??!1,autoPublish:Qe?.autoPublish??!1,challenge:Qe?.challenge??void 0,description:Qe?.description??"",extra:Qe?.extra??{}}},mergeArtworkInfoFormValue=(He,Qe)=>({title:He?.title??Qe?.title??"",prompts:He?.prompts??Qe?.prompts??"",tags:[...He?.tags??[],...Qe?.tags??[]],hidePrompts:He?.hidePrompts??Qe?.hidePrompts??!1,isPrivate:He?.isPrivate??Qe?.isPrivate??!1,autoPublish:He?.autoPublish??Qe?.autoPublish??!1,challenge:He?.challenge??Qe?.challenge,description:He?.description??Qe?.description??"",extra:{externalParameters:He?.extra?.externalParameters??Qe?.extra?.externalParameters}}),mergeArtworkInfoFormFields=(He,Qe)=>({prompts:He?.prompts??Qe?.prompts,tags:He?.tags??Qe?.tags,description:He?.description??Qe?.description,parameters:He?.parameters??Qe?.parameters,hidePrompts:He?.hidePrompts??Qe?.hidePrompts,setPrivate:He?.setPrivate??Qe?.setPrivate,autoPublish:He?.autoPublish??Qe?.autoPublish}),ArtworkInfoForm=He=>{const{form:Qe,fields:{prompts:it=!0,tags:lt=!0,description:ut=!1,parameters:dt=!1,hidePrompts:xt=!0,setPrivate:ft=!0,autoPublish:vt=!1}={},mediaId:kt,taskIsVideoTask:St,isEditingArtwork:Tt}=He,{t:Mt}=useTranslation(["artwork"]),Nt=reactExports.useRef(!1),At=Bt=>{if(Nt.current||(Nt.current=!0,Tt))return;const Ot=Qe.getValues().tags,Qt=uniqBy([...Bt,...Ot],getTagName);Qe.setFieldValue("tags",Qt)},$t=Bt=>{const Ot=getTagName(Bt),Wt=Qe.getValues().tags.filter(Xt=>getTagName(Xt)!==Ot);Qe.setFieldValue("tags",Wt)},Dt=Bt=>{const Ot=Qe.getValues().tags;Ot.some(Qt=>getTagName(Qt)===getTagName(Bt))||Qe.setFieldValue("tags",[...Ot,Bt])},Ft=Bt=>{Qe.setFieldValue("challenge",Bt)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIFormTextField,{input:Qe.getInputProps("title"),layout:"vertical",children:Bt=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIFormLabel,{children:Mt("artwork:title")}),jsxRuntimeExports.jsx(UIInput,{...Bt,variant:"rounded-normal",placeholder:Mt("artwork:title-placeholder")})]})}),ut&&jsxRuntimeExports.jsx(UIFormTextField,{input:Qe.getInputProps("description"),layout:"vertical",children:Bt=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIFormLabel,{children:Mt("artwork:description")}),jsxRuntimeExports.jsx(UITextArea,{variant:"rounded-normal",value:Bt.value,defaultValue:Bt.defaultValue,onChange:Ot=>Qe.setFieldValue("description",Ot.target.value),rows:3})]})}),it&&jsxRuntimeExports.jsx(UIFormTextField,{input:Qe.getInputProps("prompts"),layout:"vertical",children:Bt=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIFormLabel,{children:Mt("artwork:prompts.prompts")}),jsxRuntimeExports.jsx(UITextArea,{variant:"rounded-normal",value:Bt.value,defaultValue:Bt.defaultValue,onChange:Ot=>Qe.setFieldValue("prompts",Ot.target.value),placeholder:Mt("artwork:prompts-placeholder"),rows:3})]})}),dt&&jsxRuntimeExports.jsxs($28f4fd908f0de97f$export$74a362b31437ec83,{children:[jsxRuntimeExports.jsx($5cb03073d3f54797$export$a8a3e93435678ff9,{children:jsxRuntimeExports.jsx($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{slot:"trigger",children:Mt("artwork:detail-parameters")})}),jsxRuntimeExports.jsx($28f4fd908f0de97f$export$feabaa331e1d464c,{children:jsxRuntimeExports.jsx("div",{className:"flex flex-col gap-4 pb-4",children:jsxRuntimeExports.jsx(DetailParamsEditFormItems,{form:Qe})})})]}),lt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(TagSelect$1,{value:Qe.getValues().tags,label:Mt("artwork:tags"),onTagSelected:Dt,onTagRemove:$t}),jsxRuntimeExports.jsx(TagRecommendation,{selectedTags:Qe.getValues().tags,onTagSelected:Dt,onTagRemove:$t,onTagRecommendationLoaded:At,challenge:Qe.getValues().challenge,onChallengeChange:Ft,mediaId:kt,isVideoTask:St??!1})]}),xt&&jsxRuntimeExports.jsx(UICheckbox,{mantineInput:Qe.getInputProps("hidePrompts"),description:Mt("artwork:generation.hide-prompts-description"),children:Mt("artwork:generation.hide-prompts")}),ft&&jsxRuntimeExports.jsx(UICheckbox,{mantineInput:Qe.getInputProps("isPrivate"),description:Mt("artwork:generation.is-private-description"),children:Mt("artwork:generation.is-private")}),vt&&jsxRuntimeExports.jsx(UICheckbox,{mantineInput:Qe.getInputProps("autoPublish"),description:Mt("artwork:auto-publish-description"),children:Mt("artwork:generation.auto-publish")})]})},SubmitForm=({onSuccess:He,media:Qe,artworkId:it,allowEditImage:lt=!0,allowSelectFromTask:ut=!1,initialValues:dt,fields:xt})=>{const{t:ft}=useTranslation(["action","artwork"]),vt=useForm({initialValues:{media:Qe,...mergeArtworkInfoFormValue(dt,{title:"",prompts:"",tags:[],hidePrompts:!1,isPrivate:!1,autoPublish:!0,description:"",extra:{externalParameters:void 0}})},validate:{media:isNotEmpty("Media is empty")}}),[kt,St]=useLoadingCallback(async Tt=>{if(Tt.media)try{const{data:Mt}=await executeUpsertArtwork({id:it,input:{mediaId:Tt.media.id,title:Tt.title,tags:normalizeTags(Tt.tags),prompts:Tt.prompts,hidePrompts:Tt.hidePrompts,isPrivate:Tt.isPrivate,extra:{...Tt.extra,description:Tt.description}}}),Nt=Mt?.upsertArtwork;if(!Nt){toast.error("Submission failed!");return}toast.success("Submitted successfully!"),He?.(Nt),track("upload_success",{...getUpsertArtworkTrackAttrs({...Tt,artworkId:it})}),updateGetArtwork(Nt.id,Nt)}catch(Mt){toast.error(`Fail to submit. ${Mt?.message}`),track("upload_failed",{error:Mt?.message})}},[]);return jsxRuntimeExports.jsxs(UIForm,{form:vt,onSubmit:St,className:"flex flex-col md:grid md:grid-cols-2 p-8 items-stretch gap-8",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-col gap-4 items-center",children:jsxRuntimeExports.jsx(ImageSource,{...vt.getInputProps("media"),className:"w-full h-auto md:w-full md:h-auto aspect-square",features:{buttons:!0,uploadButton:lt,nativeGallery:!1,nativeCamera:!1,taskPicker:ut},disabled:!lt})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col gap-4",children:[jsxRuntimeExports.jsx(ArtworkInfoForm,{form:vt,mediaId:vt.getValues().media?.id,fields:mergeArtworkInfoFormFields(xt,{prompts:!1}),isEditingArtwork:!!it}),jsxRuntimeExports.jsx(UIButton$1,{busy:kt,variant:"filled",size:"large",type:"submit",children:ft("artwork:generation.upload-submit")})]})]})},EditArtworkDialogContent=({close:He,artwork:Qe,...it})=>{const{t:lt}=useTranslation(["artwork"]);return jsxRuntimeExports.jsxs(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(LoadingPage,{}),children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:jsxRuntimeExports.jsxs("span",{className:"inline-flex w-full items-center justify-between",children:[lt("artwork:edit-artwork-form-title"),jsxRuntimeExports.jsx(IconButton,{edge:"end",onClick:He,children:jsxRuntimeExports.jsx(icBaselineClose,{})})]})}),jsxRuntimeExports.jsx(SubmitForm,{onSuccess:He,artworkId:Qe.id,media:Qe.media,initialValues:{...Qe,description:Qe.extra?.description||"",tags:Qe.tags?.map(({name:ut})=>ut)},fields:{description:!0},allowEditImage:!1,...it})]})},dialogEditArtwork=async(He,Qe)=>UIDialog.create({dismissable:!0,children:({close:it})=>jsxRuntimeExports.jsx(EditArtworkDialogContent,{artwork:He,close:it,...Qe}),className:"max-w-screen-mlg"}),AdminActionWarning=()=>jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-2",children:["Admin Actions",jsxRuntimeExports.jsx(UITooltipHelpIcon,{variant:"normal",children:jsxRuntimeExports.jsx("p",{className:"text-sm w-80",children:"You are not the author of this artwork. But you are admin so that you can manage this item. Operate with caution."})})]}),setArtworkArchivedState=async(He,Qe)=>{try{if(!await UIDialog.confirm({confirmProps:{color:"danger"},heading:`Set artwork archived state to ${Qe}`,content:"The artwork wont be shown in home page if the artwork marked as archived. But it still can be seen in detail page and user personal page."}))return;await executeUpsertArtwork({id:He,input:{extra:{archived:Qe}}}),toast.success("success")}catch(it){toast.error(it?.message)}},ArtworkActionButton=({artwork:He,taskParameters:Qe,className:it})=>{const{t:lt}=useTranslation(["artwork","common"]),{data:ut}=useUserInfo(),dt=useNavigate();if(!He)return null;const xt=He.authorId===ut?.id,ft=ut?.isAdmin,vt=ut&&xt&&isArtworkAppealable(He),kt=async()=>{dialogReport(RefType.Artwork,He.id)},St=async()=>{dialogAppeal(RefType.Artwork,He.id)},Tt=async()=>{dialogEditArtwork(He)},Mt=async()=>{dialogModerationEdit({refIds:[He.id],refType:RefType.Artwork,values:{...pick$1(He.flag,["isRealistic","isSensitive","isMinors","isSexyPic","isSexyText"])},mutate:()=>refetchGetArtwork(He.id)})},Nt=async()=>{dialogInspectionForRAC({...He,task:Qe})},At=[{id:"explore",onAction:async()=>{trackArtwork("explore_this_style_btn_click",He),dt(`/artwork/${He.id}/relevant`)},children:lt("artwork:explore-this-style")},ut&&!xt&&{id:"report",onAction:kt,children:lt("artwork:action.report"),icon:jsxRuntimeExports.jsx(icRoundFlag,{})},vt&&{id:"appeal",onAction:St,icon:jsxRuntimeExports.jsx(icRoundFlag,{}),children:lt("common:appeal.action-label")},...!xt&&ft?[jsxRuntimeExports.jsx(UIMenuSeparator,{},"admin-override-actions-separator"),jsxRuntimeExports.jsx(UIMenuLabel,{className:"flex items-center gap-4 font-bold",children:jsxRuntimeExports.jsx("span",{children:"Admin (override) Actions"})},"subheader-admin-override-actions")]:[],...xt||ft?[{id:"edit",onAction:Tt,children:lt("artwork:action.edit"),icon:jsxRuntimeExports.jsx(fluentTextboxSettings20Regular,{className:"size-5"})},{id:"delete",onAction:async()=>{track("delete_click"),await deleteArtwork(He.id)},color:"danger",children:lt("artwork:action.delete")}]:[],...ft?[jsxRuntimeExports.jsx(UIMenuSeparator,{},"admin-actions-separator"),jsxRuntimeExports.jsx(UIMenuLabel,{className:"flex items-center gap-4 font-bold text-orange-600 dark:text-orange-500",children:jsxRuntimeExports.jsx(AdminActionWarning,{})},"subheader-admin-moderation")]:[],...ft?[{id:"mark-moderation-sfw",color:"admin",onAction:Mt,children:"Adjust Artwork Moderation"},{id:"inspect",color:"admin",onAction:Nt,children:"Inspect",icon:jsxRuntimeExports.jsx(fluentDatabaseSearch20Regular,{})},{id:"archive",onAction:()=>{setArtworkArchivedState(He.id,!He.extra?.archived)},color:"admin",children:jsxRuntimeExports.jsx("span",{children:He.extra?.archived?"Unarchive artwork":"Archive artwork"})}]:[]].filter($t=>!!$t);return jsxRuntimeExports.jsxs(UIMenuTrigger,{children:[jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",className:cx(it,"inline-grid place-items-center"),children:jsxRuntimeExports.jsx(fluentMoreVertical20Filled,{className:"size-5"})}),jsxRuntimeExports.jsx(UIMenu,{placement:"bottom end",items:At,children:$t=>{if("id"in $t)return jsxRuntimeExports.jsx(UIMenuItem,{...$t});if(reactExports.isValidElement($t))return $t}})]})},solarAltArrowDownBold=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m12.37 15.835l6.43-6.63C19.201 8.79 18.958 8 18.43 8H5.57c-.528 0-.771.79-.37 1.205l6.43 6.63c.213.22.527.22.74 0Z"})}),ClickableTag=({name:He,className:Qe,children:it=jsxRuntimeExports.jsxs("h2",{children:["#",jsxRuntimeExports.jsx("span",{className:"font-bold",children:He})]}),...lt})=>jsxRuntimeExports.jsx(ButtonBase,{className:cx("px-2 py-1 rounded-full transition active:scale-90 focus:bg-active",Qe),...lt,children:it}),TagList=reactExports.forwardRef(function He(Qe,it){const{tags:lt,type:ut,className:dt}=Qe;return jsxRuntimeExports.jsx("div",{ref:it,className:cx("flex flex-wrap gap-1 dark:text-white text-sm text-neutral-600",dt),children:uniqBy(lt,xt=>xt.id).map(({name:xt,id:ft})=>jsxRuntimeExports.jsx(ClickableTag,{to:ut?createTagPageUrl(ut,xt):void 0,target:"_blank",name:xt,component:Link,className:"bg-background-light"},ft))})});function ExpandableTagList(He){const Qe=reactExports.useRef(null),[it,lt]=reactExports.useState(!0),[ut,dt]=reactExports.useState(!1);return reactExports.useEffect(()=>{dt(Qe.current.clientHeight>28),setTimeout(()=>{lt(!1)},0)},[He.tags.length]),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(TagList,{className:cx(ut&&"pr-8",it?"":"h-[28px] overflow-hidden"),ref:Qe,...He}),ut&&jsxRuntimeExports.jsx("button",{className:"absolute right-0 top-0 rounded-full px-2 dark:text-white text-neutral-600 bg-[#EEE] dark:bg-[#58585A] w-min h-[28px] flex items-center justify-center",onClick:()=>{lt(xt=>!xt)},children:jsxRuntimeExports.jsx(solarAltArrowDownBold,{className:cx("text-sm transition",it&&"rotate-180")})})]})}const ProfilePageTab={artworks:"artworks",likes:"likes",tasks:"tasks",characters:"characters",credits:"credits",theme:"theme",models:"models",bookmarkedModels:"bookmarked-models",manga:"manga",likedManga:"liked-manga",likedSdv1Model:"liked-sdv1-model",likedModel:"liked-model",likedLoraModel:"liked-lora-model",likedLora:"liked-lora",bookmarks:"favorites",files:"files",workflows:"workflows",decorations:"decorations"};var FollowType=(He=>(He.follower="follower",He.following="following",He.world="world",He))(FollowType||{});const ALL_FOLLOW_TYPES=["follower","following","world"],DecorationPageTab={Badge:"badge",AvatarFrame:"avatar-frame",CollectionCard:"collection-card"},icBaselineKeyboardArrowDown=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6l-6-6l1.41-1.41z"})}),materialSymbolsChevronRightRounded=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12.6 12L8.7 8.1q-.275-.275-.275-.7t.275-.7q.275-.275.7-.275t.7.275l4.6 4.6q.15.15.213.325t.062.375q0 .2-.063.375t-.212.325l-4.6 4.6q-.275.275-.7.275t-.7-.275q-.275-.275-.275-.7t.275-.7l3.9-3.9Z"})}),icRoundIosShare=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M18 8h-2c-.55 0-1 .45-1 1s.45 1 1 1h2v11H6V10h2c.55 0 1-.45 1-1s-.45-1-1-1H6c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 16c.55 0 1-.45 1-1V5h1.79c.45 0 .67-.54.35-.85l-2.79-2.79c-.2-.2-.51-.2-.71 0L8.85 4.15a.5.5 0 0 0 .36.85H11v10c0 .55.45 1 1 1z"})]});function ArtworkDetailActions(He){const{trackingArgs:Qe}=He,{t:it}=useTranslation(["artwork","action"]),{data:lt}=useGetArtwork(He.artworkId??skipToken),ut=lt??He.artwork,dt=isAnimatedArtwork(ut),xt=getMediaUrl(ut?.videoMediaId,"orig"),[{loading:ft},vt]=useAsyncFn(async()=>{if(!ut?.media)return;track("share_image_dl_click",Qe);const kt=getImageDownloadFileExt({artwork:ut,media:ut.media}),St=`${getImageDownloadFilename({artwork:ut})}.${kt}`,Tt=xt||getMediaUrl(ut.mediaId,"orig");if(Tt)try{await downloadFile(Tt,St,{skipConversion:dt}),track("share_image_dl_dialog_show",Qe),openArtworkShareActionSuccessDialog(it,{type:"download"})}catch(Mt){toast.error(it("artwork:share.watermark-dialog.notice.failed-to-download")+": ",Mt.message)}},[ut]);return ut?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(IconButton,{onClick:()=>{track("copy_link_click",{...Qe,location:"artwork-detail"}),copy(formatParamURL(getArtworkShareLink(ut.id),{utm_source:"copy_web"}))},children:jsxRuntimeExports.jsx(fluentLinkMultiple16Filled,{className:"size-4"})}),jsxRuntimeExports.jsx(IconButton,{disabled:ft,onClick:vt,children:ft?jsxRuntimeExports.jsx(CircularProgress,{size:20,className:"text-primary"}):jsxRuntimeExports.jsx(materialSymbolsDownload,{className:"size-5"})}),jsxRuntimeExports.jsx(ShareButton,{artwork:ut,trackingArgs:Qe})]}):null}function ShareButton(He){const[Qe,it]=reactExports.useState(!1),lt=reactExports.useRef(null);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(IconButton,{ref:lt,onClick:()=>{track("share_btn_click",He.trackingArgs),it(!0)},children:jsxRuntimeExports.jsx(icRoundIosShare,{className:"size-4"})}),jsxRuntimeExports.jsx(ArtworkSharePopover,{open:Qe,onOpenChange:it,triggerRef:lt,artwork:He.artwork,trackingArgs:He.trackingArgs})]})}const video="_video_r8r30_15",styles$a={"artwork-detail-content-container":"_artwork-detail-content-container_r8r30_1","artwork-image-bg":"_artwork-image-bg_r8r30_6","artwork-image-container":"_artwork-image-container_r8r30_11",video,"artwork-image-element":"_artwork-image-element_r8r30_19","show-more-horizontal-gradient":"_show-more-horizontal-gradient_r8r30_32","artwork-main-wrapper":"_artwork-main-wrapper_r8r30_48","single-page":"_single-page_r8r30_62"},useNarrowScreenForArtworkDetail=He=>{const Qe=useBreakpoint("lg"),it=useBreakpoint("mmd");return He?Qe:it};function ArtworkDetailTitle(He){const{artwork:Qe,isSinglePage:it,className:lt}=He,{author:ut,id:dt,liked:xt,likedCount:ft}=Qe,{onClose:vt,onLikeClickForRec:kt,trackingArgs:St}=reactExports.useContext(ArtworkDetailContext);return jsxRuntimeExports.jsx("section",{className:cx("w-full flex flex-col gap-2",lt),children:jsxRuntimeExports.jsxs("div",{className:cx("flex justify-between items-start flex-col",it?"lg:flex-row":"mmd:flex-row"),children:[jsxRuntimeExports.jsx("h1",{className:"font-bold text-2xl flex-1 min-w-0 max-w-full break-words",title:getArtworkTitle(Qe),children:getArtworkTitle(Qe)}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center",children:[jsxRuntimeExports.jsx(ArtworkDetailActions,{artwork:Qe,trackingArgs:{scene:"artwork-detail",modal:it?void 0:!0}}),jsxRuntimeExports.jsx(ArtworkLikeButton,{artworkId:dt,artwork:Qe,initialCount:ft,initialValue:xt,countStyle:{color:"inherit"},afterClick:kt,trackingArgs:{...St,scene:"artwork-detail"},oauthReturnOpensDetail:!it})]})]})})}function ArtworkDetailAuthorInfo$1(He){const{artwork:Qe}=He,{author:it}=Qe,{onClose:lt}=reactExports.useContext(ArtworkDetailContext),{data:ut}=useUserInfo();return jsxRuntimeExports.jsx("div",{className:"flex gap-2 items-center",children:it&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"min-w-0",onClick:dt=>{dt.stopPropagation(),lt?.()},children:jsxRuntimeExports.jsx(UserLink,{size:32,user:it,scene:"image"})}),ut&&ut.id!==it.id?jsxRuntimeExports.jsx(UserFollowButton,{user:it,userId:it.id,followProps:{startIcon:null,variant:"outlined",className:"!rounded-full font-medium text-xs min-w-0 !px-2"},followingProps:{startIcon:null,className:"!rounded-full font-base text-xs min-w-0 !px-2",variant:"contained"},className:"shrink-0",scene:"artwork"}):null]})})}function ArtworkDetailAuthorArtworks(He){const{artwork:Qe,isSinglePage:it}=He,{author:lt}=Qe,{data:ut}=usePagedListArtworks(lt?.id?{authorId:lt?.id,last:4}:skipToken),dt=useNarrowScreenForArtworkDetail(it),xt=getNodesFromConnection(ut).reverse().slice(0,dt?3:4),[ft]=useBlurNsfw(),{t:vt}=useTranslation(["artwork"]);if(!lt)return null;const kt=`/@${lt.username}/${ProfilePageTab.artworks}`;return jsxRuntimeExports.jsxs("div",{className:"w-full",children:[jsxRuntimeExports.jsxs("div",{className:cx("w-full relative grid gap-2",dt?"grid-cols-3":"grid-cols-5"),children:[xt.map(St=>{const Tt=shouldArtworkBeBlurred(St)&&ft,Mt=getArtworkTitle(St);return jsxRuntimeExports.jsx(BaseArtworkItemPreviewCard,{mediaId:St?.mediaId||St?.manga?.coverMediaId||St?.manga?.chapter?.coverMediaId,nsfwBlur:Tt,showExplicitIcon:Tt,artwork:St,label:jsxRuntimeExports.jsx("span",{className:"truncate",title:Mt,children:Mt}),contentClassName:"no-underline",border:"plain",hideShare:!0,showInfo:!1,showLikeBtn:!0,likeBtn:jsxRuntimeExports.jsx(ArtworkLikeButton,{artworkId:St.id,initialCount:St.likedCount,initialValue:St.liked,hideValueOnZero:!0}),to:getArtworkLink(St),target:"_blank"},St.id)}),jsxRuntimeExports.jsxs("div",{className:cx("group isolate -col-end-1 p-0.5 aspect-square flex-1 relative",dt?"hidden":"block"),children:[jsxRuntimeExports.jsx("div",{className:"z-[-1] absolute inset-px rounded-lg bg-black/10 group-hover:bg-black/30 transition ease-out duration-300 group-hover:shadow-xl"}),jsxRuntimeExports.jsxs($4f118338184dc1d9$export$a6c7ac8248d6e38a,{href:kt,target:"_blank",className:"no-underline bg-background-secondary w-full h-full rounded-lg flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx(materialSymbolsChevronRightRounded,{className:"size-10"}),jsxRuntimeExports.jsx("span",{children:vt("artwork:author-artwork.more")})]})]})]}),jsxRuntimeExports.jsx(UILink,{href:kt,target:"_blank",endIcon:jsxRuntimeExports.jsx(materialSymbolsChevronRightRounded,{className:"size-6"}),className:cx("w-full relative no-underline items-center justify-center py-2",dt?"flex":"hidden"),children:vt("author-artwork.more")})]})}function ArtworkDescriptionAndTags$1(He){const{extra:Qe,tags:it}=He.artwork,lt=Qe?.description;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[lt&&jsxRuntimeExports.jsx(ArtworkDescription$1,{description:lt}),it&&it.length>0&&jsxRuntimeExports.jsx(ExpandableTagList,{type:"artwork",tags:it})]})}function ArtworkDescription$1(He){const{description:Qe}=He,it=reactExports.useRef(null),[lt,ut]=reactExports.useState(!1),[dt,xt]=reactExports.useState(!1),{t:ft}=useTranslation(["artwork"]);return reactExports.useEffect(()=>{Qe&&it.current&&xt(it.current.scrollHeight>it.current.clientHeight)},[Qe]),jsxRuntimeExports.jsxs("div",{className:"relative rounded-lg flex flex-col items-start gap-1 w-full",children:[jsxRuntimeExports.jsx("p",{ref:it,className:cx(lt?"table table-fixed break-words":"line-clamp-2 break-all","w-full","text-sm","text-left","whitespace-pre-line"),children:Qe}),dt&&!lt&&jsxRuntimeExports.jsx("button",{className:cx(styles$a["show-more-horizontal-gradient"],"grid grid-rows-[1fr_auto] grid-cols-[auto] justify-center absolute right-0 bottom-0"),onClick:()=>ut(vt=>!vt),children:jsxRuntimeExports.jsxs("span",{className:"row-span-full col-start-1 pl-2 pr-4 flex items-center",children:[lt?jsxRuntimeExports.jsx(icBaselineKeyboardArrowUp,{className:"size-5"}):jsxRuntimeExports.jsx(icBaselineKeyboardArrowDown,{className:"size-5"}),jsxRuntimeExports.jsx("span",{className:"text-xs opacity-75",children:ft(lt?"artwork:show.less":"artwork:show.more")})]})})]})}function ArtworkDetailMembershipAdUnit(He){return null}const useEmbedded=()=>useLocation().pathname.startsWith("/embedded/"),useEmbeddedNavigate=()=>{const He=useEmbedded(),Qe=useNavigate();return(lt,ut)=>{He?Qe(withBase(lt.embedded.toString(),"/embedded"),ut):(ut?.newPage&&window.open(lt.web.toString(),"_blank"),Qe(lt.web,ut))}},icBaselinePersonAddAlt=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M13 8c0-2.21-1.79-4-4-4S5 5.79 5 8s1.79 4 4 4s4-1.79 4-4zm-2 0c0 1.1-.9 2-2 2s-2-.9-2-2s.9-2 2-2s2 .9 2 2zM1 18v2h16v-2c0-2.66-5.33-4-8-4s-8 1.34-8 4zm2 0c.2-.71 3.3-2 6-2c2.69 0 5.78 1.28 6 2H3zm17-3v-3h3v-2h-3V7h-2v3h-3v2h3v3h2z"})}),icRoundTranslate=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12.65 15.67c.14-.36.05-.77-.23-1.05l-2.09-2.06l.03-.03A17.52 17.52 0 0 0 14.07 6h1.94c.54 0 .99-.45.99-.99v-.02c0-.54-.45-.99-.99-.99H10V3c0-.55-.45-1-1-1s-1 .45-1 1v1H1.99c-.54 0-.99.45-.99.99c0 .55.45.99.99.99h10.18A15.66 15.66 0 0 1 9 11.35c-.81-.89-1.49-1.86-2.06-2.88A.885.885 0 0 0 6.16 8c-.69 0-1.13.75-.79 1.35c.63 1.13 1.4 2.21 2.3 3.21L3.3 16.87a.99.99 0 0 0 0 1.42c.39.39 1.02.39 1.42 0L9 14l2.02 2.02c.51.51 1.38.32 1.63-.35zM17.5 10c-.6 0-1.14.37-1.35.94l-3.67 9.8c-.24.61.22 1.26.87 1.26c.39 0 .74-.24.88-.61l.89-2.39h4.75l.9 2.39c.14.36.49.61.88.61c.65 0 1.11-.65.88-1.26l-3.67-9.8c-.22-.57-.76-.94-1.36-.94zm-1.62 7l1.62-4.33L19.12 17h-3.24z"})}),prefix="Invariant failed";function invariant(He,Qe){if(He)return;const it=typeof Qe=="function"?Qe():Qe,lt=it?`${prefix}: ${it}`:prefix;throw new Error(lt)}const fluentArrowExit20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12.5 17a.5.5 0 0 0 0-1H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h6.5a.5.5 0 0 0 0-1H6a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3zm1.146-10.854a.5.5 0 0 1 .708 0l3.5 3.5a.5.5 0 0 1 0 .708l-3.5 3.5a.5.5 0 0 1-.708-.708l2.647-2.646H7.5a.5.5 0 0 1 0-1h8.793l-2.647-2.646a.5.5 0 0 1 0-.708"})}),fluentDarkTheme20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10 3a7 7 0 1 1 0 14zm0-1a8 8 0 1 0 0 16a8 8 0 0 0 0-16"})}),fluentDesktop20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M4 2a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h3v2H5.5a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1H13v-2h3a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2zm8 13v2H8v-2zM3 4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v9a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1z"})}),fluentGift20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M9.5 11v7h-3a2.5 2.5 0 0 1-2.495-2.336L4 15.5V11zm6.5 0v4.5a2.5 2.5 0 0 1-2.336 2.495L13.5 18h-3v-7zm-4-9a2.5 2.5 0 0 1 2 4.001L16 6a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-5.5V6h-1v4H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1l2 .001a2.5 2.5 0 1 1 4-3A2.49 2.49 0 0 1 12 2m0 1a1.5 1.5 0 0 0-1.5 1.5V6H12a1.5 1.5 0 0 0 0-3M8 3a1.5 1.5 0 0 0-.144 2.993L8 6h1.5V4.5l-.007-.144A1.5 1.5 0 0 0 8 3"})}),fluentIosChevronRight20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12.646 5.854a.5.5 0 0 1 .708-.708l4.5 4.5a.5.5 0 0 1 0 .708l-4.5 4.5a.5.5 0 0 1-.708-.708L16.793 10z"})}),fluentPerson20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10 2a4 4 0 1 0 0 8a4 4 0 0 0 0-8M7 6a3 3 0 1 1 6 0a3 3 0 0 1-6 0m-1.991 5A2 2 0 0 0 3 13c0 1.691.833 2.966 2.135 3.797C6.417 17.614 8.145 18 10 18s3.583-.386 4.865-1.203C16.167 15.967 17 14.69 17 13a2 2 0 0 0-2-2zM4 13c0-.553.448-1 1.009-1H15a1 1 0 0 1 1 1c0 1.309-.622 2.284-1.673 2.953C13.257 16.636 11.735 17 10 17s-3.257-.364-4.327-1.047C4.623 15.283 4 14.31 4 13"})}),fluentPersonEdit20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10 2a4 4 0 1 0 0 8a4 4 0 0 0 0-8M7 6a3 3 0 1 1 6 0a3 3 0 0 1-6 0m-1.991 5A2 2 0 0 0 3 13c0 1.691.833 2.966 2.135 3.797c1.05.669 2.398 1.049 3.87 1.165q.014-.153.052-.309l.17-.678c-1.413-.093-2.646-.442-3.554-1.022C4.623 15.283 4 14.31 4 13c0-.553.448-1 1.009-1h7.934l1-1zm5.97 4.377l4.83-4.83a1.87 1.87 0 1 1 2.645 2.646l-4.83 4.829a2.2 2.2 0 0 1-1.02.578l-1.498.374a.89.89 0 0 1-1.079-1.078l.375-1.498a2.2 2.2 0 0 1 .578-1.02"})}),fluentWeatherMoon20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M15.493 13.497a6.98 6.98 0 0 1-11.483.892c2.831-1.087 4.558-2.42 5.593-4.397c1.048-2 1.337-4.16.76-6.909a6.98 6.98 0 0 1 5.13 10.414M5.457 16.918A7.981 7.981 0 1 0 9.88 2.035a.6.6 0 0 0-.614.74c.688 2.819.434 4.876-.55 6.753c-.934 1.784-2.544 3.031-5.55 4.107a.6.6 0 0 0-.292.903a7.95 7.95 0 0 0 2.582 2.38"})}),fluentWeatherSunny20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10 2a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-1 0v-1A.5.5 0 0 1 10 2m0 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8m0-1a3 3 0 1 1 0-6a3 3 0 0 1 0 6m7.5-2.5a.5.5 0 0 0 0-1h-1a.5.5 0 0 0 0 1zM10 16a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-1 0v-1a.5.5 0 0 1 .5-.5m-6.5-5.5a.5.5 0 0 0 0-1H2.463a.5.5 0 0 0 0 1zm.646-6.354a.5.5 0 0 1 .708 0l1 1a.5.5 0 1 1-.708.708l-1-1a.5.5 0 0 1 0-.708m.708 11.708a.5.5 0 0 1-.708-.708l1-1a.5.5 0 0 1 .708.708zm11-11.708a.5.5 0 0 0-.708 0l-1 1a.5.5 0 0 0 .708.708l1-1a.5.5 0 0 0 0-.708m-.708 11.708a.5.5 0 0 0 .708-.708l-1-1a.5.5 0 0 0-.708.708z"})}),icRoundArrowOutward=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M6 7c0 .55.45 1 1 1h7.59l-8.88 8.88a.996.996 0 1 0 1.41 1.41L16 9.41V17c0 .55.45 1 1 1s1-.45 1-1V7c0-.55-.45-1-1-1H7c-.55 0-1 .45-1 1z"})}),useResolvedHref=He=>{const Qe=useHref(He);return He.startsWith("/")?Qe:He},separator=jsxRuntimeExports.jsx($431f98aba6844401$export$1ff3c3f08ae963c0,{className:"my-1 h-px bg-black/20 dark:bg-white/20"});function AccountMenu({children:He}){const Qe=useNavigate(),{me:it}=useMe(),{t:lt}=useTranslation("common"),ut=reactExports.useRef("");return jsxRuntimeExports.jsxs($3674c52c6b3c5bce$export$27d2ad3c5815583e,{onOpenChange:dt=>{dt?(ut.current=document.body.style.overflow,document.body.style.overflow="visible"):(document.body.style.overflow=ut.current,ut.current="")},children:[He,jsxRuntimeExports.jsx($07b14b47974efb58$export$5b6b19405a83ff9d,{placement:"bottom end",offset:4,crossOffset:4,className:popoverStyle({animation:!0}),children:jsxRuntimeExports.jsx($ea8dcbcb9ea1b556$export$323e4fc2fa4753fb,{navigate:Qe,useHref:useResolvedHref,children:jsxRuntimeExports.jsxs($3674c52c6b3c5bce$export$d9b273488cd8ce6f,{className:menuStyle(),children:[it&&jsxRuntimeExports.jsx(UserProfileButton,{}),it&&jsxRuntimeExports.jsx(UserSettingsButton,{}),it&&separator,jsxRuntimeExports.jsx(MenuItem,{href:"/membership/plans",icon:jsxRuntimeExports.jsx(MembershipIconCircled,{className:"size-full scale-90"}),onAction:()=>{const dt="menu";track("enter_member_click",{location:dt}),startEventGroup("member_source",dt,{persistent:!0})},children:jsxRuntimeExports.jsx("span",{className:"bg-gradient-to-r from-purple-500 to-fuchsia-500 dark:to-fuchsia-400 bg-clip-text text-transparent font-medium",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership.label",context:"short"})})}),it&&jsxRuntimeExports.jsx(MenuItem,{href:"/user-referral",icon:jsxRuntimeExports.jsx(fluentGift20Filled,{className:"size-full text-amber-500"}),onAction:()=>{track("menu_referral_click")},children:jsxRuntimeExports.jsx("span",{className:"bg-gradient-to-r from-amber-500 to-amber-600 dark:to-amber-400 bg-clip-text text-transparent font-medium",children:jsxRuntimeExports.jsx(Text,{i18nKey:"user:referral.menu-label"})})}),separator,jsxRuntimeExports.jsx(ColorThemeButton,{}),jsxRuntimeExports.jsx(LanguageButton,{}),separator,jsxRuntimeExports.jsx(MenuItem,{href:lt("common:help-center.link.href")||config$1.helpCenterUrl,target:"_blank",onAction:()=>{track("menu_how_to_use_click")},children:jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx(Text,{i18nKey:"common:help-center.link.label"}),jsxRuntimeExports.jsx(icRoundArrowOutward,{className:"size-3 ml-1"})]})}),jsxRuntimeExports.jsx(MenuItem,{href:lt("common:video-tutorial.link.href")||config$1.youtubeChannelUrl,target:"_blank",onAction:()=>{track("menu_video_tutorial_click")},children:jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx(Text,{i18nKey:"common:video-tutorial.link.label"}),jsxRuntimeExports.jsx(icRoundArrowOutward,{className:"size-3 ml-1"})]})}),jsxRuntimeExports.jsx(MenuItem,{href:"/feedback",onAction:()=>{track("menu_feedback_click")},children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:feedback"})}),it&&separator,it&&jsxRuntimeExports.jsx(MenuItem,{icon:jsxRuntimeExports.jsx(fluentArrowExit20Regular,{className:"size-full"}),onAction:()=>{track("logout_click",{scene:"account-button"}),logoutUser()},children:jsxRuntimeExports.jsx(Text,{i18nKey:"auth:logout"})})]})})})]})}const popoverStyle=ce$1({base:"flex flex-col outline-none",variants:{animation:{true:["origin-top","entering:animate-in entering:fade-in entering:placement-bottom:slide-in-from-top-1 entering:placement-top:slide-in-from-bottom-1","exiting:animate-out exiting:fade-out exiting:placement-bottom:slide-out-to-top-1 exiting:placement-top:slide-out-to-bottom-1"]}}}),menuStyle=ce$1({base:["group/menu","flex-1 overflow-auto min-w-[150px] py-1 text-sm rounded-[10px] ring-1 shadow-xl outline-none","text-neutral-900 bg-white ring-black/10","dark:text-neutral-100 dark:bg-zinc-900 dark:ring-white/10"]});function MenuItem({icon:He,children:Qe,...it}){const lt=menuItemStyles({withIcon:He!=null});return jsxRuntimeExports.jsx($3674c52c6b3c5bce$export$2ce376c2cc3355c8,{...it,className:lt.root(),children:jsxRuntimeExports.jsxs("div",{className:lt.inner(),children:[jsxRuntimeExports.jsx("div",{className:lt.icon(),children:He}),jsxRuntimeExports.jsx("div",{className:lt.label(),children:Qe})]})})}const menuItemStyles=ce$1({slots:{root:["group/menu-item","min-h-8 px-1 flex no-underline outline-none cursor-default"],inner:["flex-1 px-3 flex items-start rounded-md","group-focus-visible/menu-item:outline outline-2 -outline-offset-1","after:size-1.5 after:my-auto after:ml-4 after:rounded-full","after:hidden group-selected/menu-item:after:block","group-focus/menu-item:text-black group-focus/menu-item:bg-black/5","group-open/menu-item:text-black group-open/menu-item:bg-black/5","outline-black","after:bg-black","dark:group-focus/menu-item:text-neutral-200 dark:group-focus/menu-item:bg-white/10","dark:group-open/menu-item:text-neutral-200 dark:group-open/menu-item:bg-white/10","outline-white","dark:after:bg-white"],icon:"flex-none size-5 my-1.5 -ml-1 mr-2 grid place-items-center",label:"flex-1 py-1.5 whitespace-nowrap"},variants:{withIcon:{false:{icon:"hidden"}}}});function UserProfileButton(){const{me:He}=useMe(),{data:Qe,previousData:it}=useMyQuota(),lt=Qe??it;return He?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(MenuItem,{href:`/@${He.username}`,onAction:()=>{track("menu_profile_click")},children:jsxRuntimeExports.jsxs("div",{className:"flex-1 flex items-center",children:[jsxRuntimeExports.jsx(UserAvatar,{user:He,className:"flex-none size-12 -ml-0.5 mr-2.5"}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("p",{children:getUserDisplayName(He)}),jsxRuntimeExports.jsx("p",{className:"text-xs",children:jsxRuntimeExports.jsx(CreditMeter,{value:lt})})]})]})}),jsxRuntimeExports.jsx(MenuItem,{href:`/@${He.username}`,icon:jsxRuntimeExports.jsx(fluentPerson20Regular,{className:"size-full"}),onAction:()=>{track("menu_profile_click",{from:"normal-item"})},children:jsxRuntimeExports.jsx(Text,{i18nKey:"user:your-profile-page"})})]}):null}function UserSettingsButton(){const{me:He}=useMe(),[Qe,it]=useShowEmailVerificationDot("account-menu",He);return jsxRuntimeExports.jsxs(MenuItem,{href:Qe?"/profile/edit/accounts":"/profile/edit",icon:jsxRuntimeExports.jsx(fluentPersonEdit20Regular,{className:"size-full"}),onAction:()=>{track("edit_profile_click",{scene:"account-button"}),it()},children:[jsxRuntimeExports.jsx(Text,{i18nKey:"user:settings.label"}),Qe&&jsxRuntimeExports.jsxs($514c0188e459b4c0$export$5f1af8db9871e1d6,{slot:"description",className:"flex items-center mt-1 px-1 -mx-1 text-xs text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-500/15 rounded",children:[jsxRuntimeExports.jsxs("span",{className:"size-2 mr-1 grid *:row-start-1 *:col-start-1 *:rounded-full",children:[jsxRuntimeExports.jsx("span",{className:"bg-blue-400 dark:bg-blue-500 animate-ping"}),jsxRuntimeExports.jsx("span",{className:"bg-blue-500 dark:bg-blue-400 relative"})]}),jsxRuntimeExports.jsx(Text,{i18nKey:"user:email.verify-for-credit-discount"})]})]})}function ColorThemeButton(){const{mode:He,changeColorMode:Qe}=useColorModeContext();return jsxRuntimeExports.jsxs($3674c52c6b3c5bce$export$ecabc99eeffab7ca,{children:[jsxRuntimeExports.jsx(MenuItem,{icon:jsxRuntimeExports.jsx(fluentDarkTheme20Regular,{className:"size-full"}),children:jsxRuntimeExports.jsxs("div",{className:"flex-1 flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"mr-4",children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:preferences.color-mode.label"})}),jsxRuntimeExports.jsx("span",{className:"ml-auto text-neutral-500",children:$$3(He).with("light",()=>jsxRuntimeExports.jsx(Text,{i18nKey:"common:preferences.color-mode.light"})).with("dark",()=>jsxRuntimeExports.jsx(Text,{i18nKey:"common:preferences.color-mode.dark"})).with("auto",()=>jsxRuntimeExports.jsx(Text,{i18nKey:"common:preferences.color-mode.auto"})).otherwise(()=>null)}),jsxRuntimeExports.jsx(fluentIosChevronRight20Regular,{className:"size-5 -mr-1"})]})}),jsxRuntimeExports.jsx($07b14b47974efb58$export$5b6b19405a83ff9d,{offset:-4,crossOffset:-4,className:popoverStyle(),children:jsxRuntimeExports.jsxs($3674c52c6b3c5bce$export$d9b273488cd8ce6f,{selectionMode:"single",disallowEmptySelection:!0,selectedKeys:He&&[He],onSelectionChange:it=>{invariant(it instanceof Set,"The selection should be a Set");const lt=it.values().next().value;track("color_mode_select",{value:lt}),Qe(lt)},className:menuStyle(),children:[jsxRuntimeExports.jsx(MenuItem,{id:"light",icon:jsxRuntimeExports.jsx(fluentWeatherSunny20Regular,{className:"size-full scale-125"}),children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:preferences.color-mode.light"})}),jsxRuntimeExports.jsx(MenuItem,{id:"dark",icon:jsxRuntimeExports.jsx(fluentWeatherMoon20Regular,{className:"size-full scale-90"}),children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:preferences.color-mode.dark"})}),jsxRuntimeExports.jsx(MenuItem,{id:"auto",icon:jsxRuntimeExports.jsx(fluentDesktop20Regular,{className:"size-full scale-95"}),children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:preferences.color-mode.auto"})})]})})]})}function LanguageButton(){const[He,Qe]=useAtom(localeAtom);return jsxRuntimeExports.jsxs($3674c52c6b3c5bce$export$ecabc99eeffab7ca,{children:[jsxRuntimeExports.jsx(MenuItem,{icon:jsxRuntimeExports.jsx(icRoundTranslate,{className:"size-full scale-90"}),children:jsxRuntimeExports.jsxs("div",{className:"flex-1 flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"mr-4",children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:language"})}),jsxRuntimeExports.jsx("span",{className:"ml-auto text-neutral-500",children:SUPPORTED_LOCALES[He].label}),jsxRuntimeExports.jsx(fluentIosChevronRight20Regular,{className:"size-5 -mr-1"})]})}),jsxRuntimeExports.jsx($07b14b47974efb58$export$5b6b19405a83ff9d,{offset:-4,crossOffset:-4,className:popoverStyle(),children:jsxRuntimeExports.jsx($3674c52c6b3c5bce$export$d9b273488cd8ce6f,{items:Object.values(SUPPORTED_LOCALES),selectionMode:"single",disallowEmptySelection:!0,selectedKeys:[He],onSelectionChange:it=>{invariant(it instanceof Set,"The selection should be a Set");const lt=it.values().next().value;track("menu_language_click",{value:lt}),updateLangPreference(lt).catch(noop$6),Qe(lt)},className:menuStyle(),children:it=>jsxRuntimeExports.jsx(MenuItem,{id:it.code,children:it.label})})})]})}const SignButton=He=>{const{t:Qe}=useTranslation(["auth"]);return jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",onPress:()=>{track("signup_login_click",{isLogin:!0}),openSignModal(null,{fromPath:"login"})},className:"bg-background !border-theme-primary hover:bg-violet-100 dark:hover:bg-slate-800 !text-theme-primary no-underline whitespace-nowrap rounded-full",size:He.size,children:Qe("auth:sign-in")})})},buttonStyles$1=ce$1({slots:{button:"cursor-pointer",icon:""},variants:{size:{normal:{button:"!size-8",icon:"size-5"},large:{button:"!size-10",icon:"size-6"}}},defaultVariants:{size:"normal"}});function AccountButton(He){const{t:Qe}=useTranslation(["auth"]),{me:it}=useMe(),[lt,ut]=useShowEmailVerificationDot("account-btn",it),dt=useExperimentParam("exp2510-login-register-button-v2"),xt=buttonStyles$1({size:He.size});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[!it&&(dt==="treatment"?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",color:"normal",onPress:()=>{openSignModal(null,{fromPath:"login"})},size:He.size,className:"rounded-full",children:Qe("auth:sign-in")}),jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",color:"normal",onPress:()=>{openSignModal({isLoginInit:!1})},size:He.size,icon:jsxRuntimeExports.jsx(icBaselinePersonAddAlt,{className:xt.icon()}),className:"rounded-full",children:Qe("auth:signup.label",{context:"treatment"})})]}):jsxRuntimeExports.jsx(SignButton,{size:He.size})),jsxRuntimeExports.jsx(AccountMenu,{children:jsxRuntimeExports.jsx($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{className:xt.button({className:["shrink-0 rounded-full",!it&&"grid place-content-center bg-background-secondary border border-black/50 dark:border-white/50 rounded-full",He.className]}),style:He.style,onPress:()=>{ut()},children:it?jsxRuntimeExports.jsx(UserAvatar,{user:it,displayRedDot:lt,className:"size-full"}):jsxRuntimeExports.jsx(icRoundTranslate,{className:xt.icon()})})})]})}const twemojiMoneyBag=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 36 36",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"#FDD888",d:"M31.898 23.938C31.3 17.32 28 14 28 14l-6-8h-8l-6 8s-1.419 1.433-2.567 4.275C3.444 18.935 2 20.789 2 23a4.97 4.97 0 0 0 1.609 3.655A4.94 4.94 0 0 0 3 29c0 1.958 1.136 3.636 2.775 4.456C7.058 35.378 8.772 36 10 36h16c1.379 0 3.373-.779 4.678-3.31C32.609 31.999 34 30.17 34 28a4.99 4.99 0 0 0-2.102-4.062M18 6c.55 0 1.058-.158 1.5-.416c.443.258.951.416 1.5.416c1.657 0 4-2.344 4-4c0 0 0-2-2-2c-.788 0-1 1-2 1s-1-1-3-1s-2 1-3 1s-1.211-1-2-1c-2 0-2 2-2 2c0 1.656 2.344 4 4 4c.549 0 1.057-.158 1.5-.416c.443.258.951.416 1.5.416"}),jsxRuntimeExports.jsx("path",{fill:"#BF6952",d:"M24 6a1 1 0 0 1-1 1H13a1 1 0 0 1 0-2h10a1 1 0 0 1 1 1"}),jsxRuntimeExports.jsx("path",{fill:"#67757F",d:"M23.901 24.542c0-4.477-8.581-4.185-8.581-6.886c0-1.308 1.301-1.947 2.811-1.947c2.538 0 2.99 1.569 4.139 1.569c.813 0 1.205-.493 1.205-1.046c0-1.284-2.024-2.256-3.965-2.592V12.4c0-.773-.65-1.4-1.454-1.4c-.805 0-1.456.627-1.456 1.4v1.283c-2.116.463-3.937 1.875-3.937 4.176c0 4.299 8.579 4.125 8.579 7.145c0 1.047-1.178 2.093-3.111 2.093c-2.901 0-3.867-1.889-5.045-1.889c-.574 0-1.087.464-1.087 1.164c0 1.113 1.938 2.451 4.603 2.824l-.001.01v1.398c0 .772.652 1.4 1.456 1.4s1.455-.628 1.455-1.4v-1.398c0-.017-.008-.03-.009-.045c2.398-.43 4.398-1.932 4.398-4.619"})]});function GeneratorEntry(He){return jsxRuntimeExports.jsx(UILink,{className:cx(He.className,"rounded-2xl","pr-4"),href:"/user-referral",icon:jsxRuntimeExports.jsx(twemojiMoneyBag,{className:"size-4"}),variant:"outlined",children:jsxRuntimeExports.jsx(Text,{i18nKey:["growth:generation.referral-entry.label","user:referral.menu-label"]})})}const IMG_LOGO="data:image/svg+xml,%3csvg%20width='128'%20height='128'%20viewBox='0%200%20128%20128'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_2_3)'%3e%3cpath%20d='M0%2032C0%2020.799%200%2015.1984%202.17987%2010.9202C4.09734%207.15695%207.15695%204.09734%2010.9202%202.17987C15.1984%200%2020.799%200%2032%200H96C107.201%200%20112.802%200%20117.08%202.17987C120.843%204.09734%20123.903%207.15695%20125.82%2010.9202C128%2015.1984%20128%2020.799%20128%2032V96C128%20107.201%20128%20112.802%20125.82%20117.08C123.903%20120.843%20120.843%20123.903%20117.08%20125.82C112.802%20128%20107.201%20128%2096%20128H32C20.799%20128%2015.1984%20128%2010.9202%20125.82C7.15695%20123.903%204.09734%20120.843%202.17987%20117.08C0%20112.802%200%20107.201%200%2096V32Z'%20fill='url(%23paint0_linear_2_3)'/%3e%3cpath%20d='M36%20100.727V28H66.0426C71.4877%2028%2076.187%2029.0653%2080.1406%2031.196C84.1179%2033.303%2087.1837%2036.2505%2089.3381%2040.0383C91.4924%2043.8026%2092.5696%2048.1823%2092.5696%2053.1776C92.5696%2058.1965%2091.4687%2062.5881%2089.267%2066.3523C87.089%2070.0928%2083.9759%2072.9929%2079.9276%2075.0526C75.8793%2077.1122%2071.0734%2078.142%2065.5099%2078.142H46.973V64.2926H62.2429C64.8944%2064.2926%2067.108%2063.831%2068.8835%2062.9077C70.6828%2061.9844%2072.044%2060.6941%2072.9673%2059.0369C73.8906%2057.3561%2074.3523%2055.4029%2074.3523%2053.1776C74.3523%2050.9285%2073.8906%2048.9872%2072.9673%2047.3537C72.044%2045.6965%2070.6828%2044.4181%2068.8835%2043.5185C67.0843%2042.6188%2064.8707%2042.169%2062.2429%2042.169H53.5781V100.727H36Z'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_2_3'%20x1='64'%20y1='0'%20x2='64'%20y2='128'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%234D4D4D'/%3e%3cstop%20offset='1'%20stop-color='%23161313'/%3e%3c/linearGradient%3e%3cclipPath%20id='clip0_2_3'%3e%3crect%20width='128'%20height='128'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",IMG_LOGO_EVENT="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/logo-D3XGo6hv.svg";function useResolvedLogo(){const{ongoing:He}=useGrowthEvent(GrowthEventName.AugustEvent2025);return He?IMG_LOGO_EVENT:IMG_LOGO}function Logo(He){const{vanilla:Qe,...it}=He,lt=useResolvedLogo(),ut=(Qe?IMG_LOGO:lt)??IMG_LOGO,dt=ut===IMG_LOGO;return jsxRuntimeExports.jsx("img",{alt:"PixAI Logo",...it,className:cx(dt&&"dark:invert",He.className),src:ut})}const useGetNotification=modifyQueryHook(createQueryHook(GetNotificationDocument),{transform:He=>({id:He}),reduce:He=>He?.notification}),useListNotifications=modifyQueryHook(createQueryHook(ListNotificationsDocument),{reduce:He=>He?.notifications}),fetchListNotifications=createFetchQueryHelper(ListNotificationsDocument);modifyQueryHook(createQueryHook(ListMyNotificationsDocument),{reduce:He=>He?.me?.notifications});const refetchListMyNotifications=createRefetchQueryHelper(ListMyNotificationsDocument),fetchListMyNotifications=createFetchQueryHelper(ListMyNotificationsDocument),useGetMyUnreadNotiCount=modifyQueryHook(createQueryHook(GetMyUnreadNotiCountDocument),{reduce:He=>He?.me?.unreadNotificationCounts}),useMyUnreadNotiCounts=()=>{const He=useCheckTokenForArgs({}),Qe=useGetMyUnreadNotiCount(He??skipToken);return reactExports.useEffect(()=>{const it=$newNotification.subscribe(lt=>{lt.unread&&baseApolloClient.readQuery({query:GetMyUnreadNotiCountDocument,variables:{}})?.me?.unreadNotificationCounts!=null&&baseApolloClient.refetchQueries({include:[GetMyUnreadNotiCountDocument]})});return()=>it.unsubscribe()},[]),Qe},[useMarkNotificationRead,executeMarkNotificationRead]=createMutationHelper(MarkNotificationReadDocument),icBaselineNotificationsNone=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"})}),WORLD_CHARACTER_EXPERIMENT_NAME="enable-world-character",useWorldCharacterExperiment=()=>useExperimentParam(WORLD_CHARACTER_EXPERIMENT_NAME),rankingNotificationTypes=[NotificationType.DailyRanking,NotificationType.WeeklyRanking,NotificationType.MonthlyRanking,NotificationType.NewbiesRanking],systemNotificationTypes=[NotificationType.System,NotificationType.ContestReward,NotificationType.ModelClaim,NotificationType.ModelClaimedByOthers,NotificationType.TrainingTaskCompleted,NotificationType.Privilege,NotificationType.MembershipGifted,NotificationType.MembershipExpired,NotificationType.MembershipRenewed,NotificationType.MembershipRenewalFailed,NotificationType.PaymentFailed,NotificationType.ModelCoverNsfw,NotificationType.UserAvatarNsfw,NotificationType.UserCoverNsfw,NotificationType.AppealAccepted,NotificationType.AppealRejected,...rankingNotificationTypes],useNotificationTabs=()=>{const He=useWorldCharacterExperiment();return reactExports.useMemo(()=>[{id:"likes",label:"likes",listType:"plain",types:[NotificationType.Like,NotificationType.ItemLike]},{id:"comments",label:"comments",listType:"plain",types:[NotificationType.Comment,NotificationType.CommentReply]},{id:"followers",label:"followers",listType:"plain",types:[NotificationType.Follow]},...He?[{id:"subscription",label:"subscriptions",listType:"plain",types:[NotificationType.WorldNewCharacter]}]:[],{id:"system",label:"system",listType:"plain",types:systemNotificationTypes},{id:"news",label:"news",listType:"external",types:[NotificationType.News]}],[He])},useAllNotificationTypesInTabs=()=>useNotificationTabs().map(Qe=>Qe.types).flat(),warningNotificationTypes=[NotificationType.PaymentFailed],highlightedNotificationTypes=[NotificationType.Privilege,NotificationType.MembershipGifted,NotificationType.MembershipExpired,NotificationType.MembershipRenewed,NotificationType.MembershipRenewalFailed,NotificationType.System],appealNotificationTypes=[NotificationType.AppealAccepted,NotificationType.AppealRejected];function useUnreadNotificationNews(){const[He,Qe]=useLocalStorage({key:"last-read-news"}),{data:it,loading:lt}=useListNotifications({last:1,type:NotificationType.News}),ut=getNodesFromConnection(it),dt=ut?.[0]?.updatedAt?new Date(ut[0].updatedAt).getTime():void 0,xt=(He??0)<(dt??0),ft=reactExports.useCallback(()=>{Qe(new Date().getTime())},[]);return{hasUnread:xt,updateLastRead:ft}}const tabStyles=ce$1({base:"outline-none",variants:{variant:{underlined:["uppercase font-medium text-center text-sm","text-black/60 dark:text-white/80","py-[10px]","cursor-pointer"]},color:{theme:{}}},compoundVariants:[{variant:"underlined",isSelected:!0,className:["text-black/100 dark:text-white/100","shadow-[inset_0_-0.1em_black] dark:shadow-[inset_0_-0.1em_white]"]},{variant:"underlined",color:"theme",isSelected:!0,className:["text-purple-600/100 dark:text-purple-500/100","shadow-[inset_0_-0.1em_theme(colors.purple.600)] dark:shadow-[inset_0_-0.1em_theme(colors.purple.500)]"]}]});function UITab(He){const{variant:Qe,color:it,...lt}=He;return jsxRuntimeExports.jsx($5e8ad37a45e1c704$export$3e41faf802a29e71,{...lt,className:$64fa3d84918910a7$export$c245e6201fed2f75(He.className,(ut,dt)=>tabStyles({...dt,variant:Qe,color:it,className:ut}))})}const tabListStyles=ce$1({base:"flex gap-1",variants:{orientation:{horizontal:"flex-row",vertical:"flex-col items-start"},variant:{underlined:"items-center"}}});function UITabList(He){const{variant:Qe}=He;return jsxRuntimeExports.jsx($5e8ad37a45e1c704$export$e51a686c67fdaa2d,{...He,className:$64fa3d84918910a7$export$c245e6201fed2f75(He.className,(it,lt)=>tabListStyles({...lt,variant:Qe,className:it}))})}function DitModelReleaseFeedbackDialogContent(He){const{t:Qe}=useTranslation(["growth"]),it="growth:model-release-event.dit-model",lt=useNavigate(),ut=useModelReleaseGeneratorLink();return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:jsxRuntimeExports.jsx(Text,{i18nKey:`${it}.feedback-dialog.title`})}),jsxRuntimeExports.jsx(UIDialogContent,{children:jsxRuntimeExports.jsx("div",{className:"prose dark:prose-invert [&_p]:whitespace-pre-wrap",children:jsxRuntimeExports.jsx(Markdown,{options:{forceBlock:!0,wrapper:reactExports.Fragment,overrides:{a:{props:{target:"_blank"}}}},children:Qe(`${it}.feedback-dialog.content`)})})}),jsxRuntimeExports.jsxs(UIDialogFooter,{children:[jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",onPress:()=>He.onClose(),children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:close"})}),jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",color:"theme",onPress:()=>{lt(ut),He.onClose()},children:jsxRuntimeExports.jsx(Text,{i18nKey:`${it}.feedback-dialog.navigate-label`})})]})]})}function useDitModelReleaseEvent(){return useGrowthEvent(DIT_MODEL_RELEASE_EVENT_NAME)}function openDitModelReleaseFeedbackDialog(){return UIDialog.create({children:({close:He})=>jsxRuntimeExports.jsx(DitModelReleaseFeedbackDialogContent,{onClose:He}),className:"w-screen md:w-auto md:min-w-[400px]"})}function useOpenDitModelReleaseFeedbackDialogEffect(){const{me:He}=useMe(),{ongoing:Qe}=useDitModelReleaseEvent(),it=Qe,[lt,ut]=useLocalStorage({key:DIT_MODEL_RELEASE_EVENT_DIALOG_STORAGE_KEY,defaultValue:{started:!1}});reactExports.useEffect(()=>{He?.id&&it&&!lt.started&&(openDitModelReleaseFeedbackDialog(),ut(dt=>({...dt,started:!0})))},[it,He?.id])}function useModelReleaseGeneratorLink(){const{t:He}=useTranslation(["growth"]),Qe=He("growth:model-release-event.dit-model.notification.link");return hasLeadingSlash(Qe)?Qe:"/pixai"}function usePinnedDitModelReleaseEventNotification(){const{me:He}=useMe(),{startDate:Qe,ongoing:it}=useDitModelReleaseEvent(),{t:lt}=useTranslation(["growth"]),ut=useModelReleaseGeneratorLink();return He?[it&&{id:"dit-model-release-event-pinned-noti",type:NotificationType.Privilege,content:lt("growth:model-release-event.dit-model.notification.content"),link:ut,createdAt:Qe,updatedAt:Qe,userId:"",extra:void 0,unread:!0,className:"bg-orange-200 hover:bg-orange-300 dark:bg-orange-800 dark:hover:bg-orange-700"}].filter(Boolean):[]}const fluentCheckmarkNote20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M6.032 12.907L2.561 9.002a.75.75 0 1 0-1.122.996l4 4.5a.75.75 0 0 0 1.091.032l10.5-10.5a.75.75 0 0 0-1.06-1.06zM11 13a2 2 0 0 1 2-2h5a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2zm6.5 3h-4a.5.5 0 1 0 0 1h4a.5.5 0 1 0 0-1m-4-3a.5.5 0 1 0 0 1h4a.5.5 0 1 0 0-1z"})}),fluentProhibitedNote20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17.998 10.17L18 10a8 8 0 1 0-8.844 7.956A3 3 0 0 1 9 17v-.576a6.47 6.47 0 0 1-3.035-1.328l1.564-1.565h.001l7.566-7.566A6.47 6.47 0 0 1 16.5 10h.5c.35 0 .686.06.998.17m-3.963-5.266l-9.131 9.131a6.5 6.5 0 0 1 9.131-9.131M10 13a2 2 0 0 1 2-2h5a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2zm6.5 3h-4a.5.5 0 1 0 0 1h4a.5.5 0 1 0 0-1m-4-3a.5.5 0 1 0 0 1h4a.5.5 0 1 0 0-1z"})}),fluentWarning24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10.03 3.659c.856-1.548 3.081-1.548 3.937 0l7.746 14.001c.83 1.5-.255 3.34-1.969 3.34H4.254c-1.715 0-2.8-1.84-1.97-3.34zM12.997 17A.999.999 0 1 0 11 17a.999.999 0 0 0 1.997 0m-.259-7.853a.75.75 0 0 0-1.493.103l.004 4.501l.007.102a.75.75 0 0 0 1.493-.103l-.004-4.502z"})}),icRoundMarkEmailUnread=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 10c1.13 0 2.16-.39 3-1.02V18c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2h10.1c-.06.32-.1.66-.1 1c0 1.48.65 2.79 1.67 3.71L12 11L5.3 6.81a.85.85 0 1 0-.9 1.44l7.07 4.42c.32.2.74.2 1.06 0l4.77-2.98c.54.19 1.1.31 1.7.31zm-3-5c0 1.66 1.34 3 3 3s3-1.34 3-3s-1.34-3-3-3s-3 1.34-3 3z"})}),mdiCrownCircle=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2C6.47 2 2 6.5 2 12s4.5 10 10 10s10-4.5 10-10S17.5 2 12 2m4 13.44c0 .34-.22.56-.56.56H8.56c-.34 0-.56-.22-.56-.56V15h8v.44M16 14H8L7 8l3 2l2-3l2 3l3-2l-1 6Z"})});function resolveUrl(He,Qe){if(He.match(/^[a-z]+:\/\//i))return He;if(He.match(/^\/\//))return window.location.protocol+He;if(He.match(/^[a-z]+:/i))return He;const it=document.implementation.createHTMLDocument(),lt=it.createElement("base"),ut=it.createElement("a");return it.head.appendChild(lt),it.body.appendChild(ut),Qe&&(lt.href=Qe),ut.href=He,ut.href}const uuid=(()=>{let He=0;const Qe=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(He+=1,`u${Qe()}${He}`)})();function toArray(He){const Qe=[];for(let it=0,lt=He.length;it<lt;it++)Qe.push(He[it]);return Qe}function px(He,Qe){const lt=(He.ownerDocument.defaultView||window).getComputedStyle(He).getPropertyValue(Qe);return lt?parseFloat(lt.replace("px","")):0}function getNodeWidth(He){const Qe=px(He,"border-left-width"),it=px(He,"border-right-width");return He.clientWidth+Qe+it}function getNodeHeight(He){const Qe=px(He,"border-top-width"),it=px(He,"border-bottom-width");return He.clientHeight+Qe+it}function getImageSize(He,Qe={}){const it=Qe.width||getNodeWidth(He),lt=Qe.height||getNodeHeight(He);return{width:it,height:lt}}function getPixelRatio(){let He,Qe;try{Qe=process$1}catch{}const it=Qe&&Qe.env?Qe.env.devicePixelRatio:null;return it&&(He=parseInt(it,10),Number.isNaN(He)&&(He=1)),He||window.devicePixelRatio||1}const canvasDimensionLimit=16384;function checkCanvasDimensions(He){(He.width>canvasDimensionLimit||He.height>canvasDimensionLimit)&&(He.width>canvasDimensionLimit&&He.height>canvasDimensionLimit?He.width>He.height?(He.height*=canvasDimensionLimit/He.width,He.width=canvasDimensionLimit):(He.width*=canvasDimensionLimit/He.height,He.height=canvasDimensionLimit):He.width>canvasDimensionLimit?(He.height*=canvasDimensionLimit/He.width,He.width=canvasDimensionLimit):(He.width*=canvasDimensionLimit/He.height,He.height=canvasDimensionLimit))}function createImage$1(He){return new Promise((Qe,it)=>{const lt=new Image;lt.decode=()=>Qe(lt),lt.onload=()=>Qe(lt),lt.onerror=it,lt.crossOrigin="anonymous",lt.decoding="async",lt.src=He})}async function svgToDataURL(He){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(He)).then(encodeURIComponent).then(Qe=>`data:image/svg+xml;charset=utf-8,${Qe}`)}async function nodeToDataURL(He,Qe,it){const lt="http://www.w3.org/2000/svg",ut=document.createElementNS(lt,"svg"),dt=document.createElementNS(lt,"foreignObject");return ut.setAttribute("width",`${Qe}`),ut.setAttribute("height",`${it}`),ut.setAttribute("viewBox",`0 0 ${Qe} ${it}`),dt.setAttribute("width","100%"),dt.setAttribute("height","100%"),dt.setAttribute("x","0"),dt.setAttribute("y","0"),dt.setAttribute("externalResourcesRequired","true"),ut.appendChild(dt),dt.appendChild(He),svgToDataURL(ut)}const isInstanceOfElement=(He,Qe)=>{if(He instanceof Qe)return!0;const it=Object.getPrototypeOf(He);return it===null?!1:it.constructor.name===Qe.name||isInstanceOfElement(it,Qe)};function formatCSSText(He){const Qe=He.getPropertyValue("content");return`${He.cssText} content: '${Qe.replace(/'|"/g,"")}';`}function formatCSSProperties(He){return toArray(He).map(Qe=>{const it=He.getPropertyValue(Qe),lt=He.getPropertyPriority(Qe);return`${Qe}: ${it}${lt?" !important":""};`}).join(" ")}function getPseudoElementStyle(He,Qe,it){const lt=`.${He}:${Qe}`,ut=it.cssText?formatCSSText(it):formatCSSProperties(it);return document.createTextNode(`${lt}{${ut}}`)}function clonePseudoElement(He,Qe,it){const lt=window.getComputedStyle(He,it),ut=lt.getPropertyValue("content");if(ut===""||ut==="none")return;const dt=uuid();try{Qe.className=`${Qe.className} ${dt}`}catch{return}const xt=document.createElement("style");xt.appendChild(getPseudoElementStyle(dt,it,lt)),Qe.appendChild(xt)}function clonePseudoElements(He,Qe){clonePseudoElement(He,Qe,":before"),clonePseudoElement(He,Qe,":after")}const WOFF="application/font-woff",JPEG="image/jpeg",mimes={woff:WOFF,woff2:WOFF,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:JPEG,jpeg:JPEG,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function getExtension(He){const Qe=/\.([^./]*?)$/g.exec(He);return Qe?Qe[1]:""}function getMimeType(He){const Qe=getExtension(He).toLowerCase();return mimes[Qe]||""}function getContentFromDataUrl(He){return He.split(/,/)[1]}function isDataUrl(He){return He.search(/^(data:)/)!==-1}function makeDataUrl(He,Qe){return`data:${Qe};base64,${He}`}async function fetchAsDataURL(He,Qe,it){const lt=await fetch(He,Qe);if(lt.status===404)throw new Error(`Resource "${lt.url}" not found`);const ut=await lt.blob();return new Promise((dt,xt)=>{const ft=new FileReader;ft.onerror=xt,ft.onloadend=()=>{try{dt(it({res:lt,result:ft.result}))}catch(vt){xt(vt)}},ft.readAsDataURL(ut)})}const cache={};function getCacheKey(He,Qe,it){let lt=He.replace(/\?.*/,"");return it&&(lt=He),/ttf|otf|eot|woff2?/i.test(lt)&&(lt=lt.replace(/.*\//,"")),Qe?`[${Qe}]${lt}`:lt}async function resourceToDataURL(He,Qe,it){const lt=getCacheKey(He,Qe,it.includeQueryParams);if(cache[lt]!=null)return cache[lt];it.cacheBust&&(He+=(/\?/.test(He)?"&":"?")+new Date().getTime());let ut;try{const dt=await fetchAsDataURL(He,it.fetchRequestInit,({res:xt,result:ft})=>(Qe||(Qe=xt.headers.get("Content-Type")||""),getContentFromDataUrl(ft)));ut=makeDataUrl(dt,Qe)}catch(dt){ut=it.imagePlaceholder||"";let xt=`Failed to fetch resource: ${He}`;dt&&(xt=typeof dt=="string"?dt:dt.message),xt&&console.warn(xt)}return cache[lt]=ut,ut}async function cloneCanvasElement(He){const Qe=He.toDataURL();return Qe==="data:,"?He.cloneNode(!1):createImage$1(Qe)}async function cloneVideoElement(He,Qe){if(He.currentSrc){const dt=document.createElement("canvas"),xt=dt.getContext("2d");dt.width=He.clientWidth,dt.height=He.clientHeight,xt?.drawImage(He,0,0,dt.width,dt.height);const ft=dt.toDataURL();return createImage$1(ft)}const it=He.poster,lt=getMimeType(it),ut=await resourceToDataURL(it,lt,Qe);return createImage$1(ut)}async function cloneIFrameElement(He){var Qe;try{if(!((Qe=He?.contentDocument)===null||Qe===void 0)&&Qe.body)return await cloneNode(He.contentDocument.body,{},!0)}catch{}return He.cloneNode(!1)}async function cloneSingleNode(He,Qe){return isInstanceOfElement(He,HTMLCanvasElement)?cloneCanvasElement(He):isInstanceOfElement(He,HTMLVideoElement)?cloneVideoElement(He,Qe):isInstanceOfElement(He,HTMLIFrameElement)?cloneIFrameElement(He):He.cloneNode(!1)}const isSlotElement=He=>He.tagName!=null&&He.tagName.toUpperCase()==="SLOT";async function cloneChildren(He,Qe,it){var lt,ut;let dt=[];return isSlotElement(He)&&He.assignedNodes?dt=toArray(He.assignedNodes()):isInstanceOfElement(He,HTMLIFrameElement)&&(!((lt=He.contentDocument)===null||lt===void 0)&&lt.body)?dt=toArray(He.contentDocument.body.childNodes):dt=toArray(((ut=He.shadowRoot)!==null&&ut!==void 0?ut:He).childNodes),dt.length===0||isInstanceOfElement(He,HTMLVideoElement)||await dt.reduce((xt,ft)=>xt.then(()=>cloneNode(ft,it)).then(vt=>{vt&&Qe.appendChild(vt)}),Promise.resolve()),Qe}function cloneCSSStyle(He,Qe){const it=Qe.style;if(!it)return;const lt=window.getComputedStyle(He);lt.cssText?(it.cssText=lt.cssText,it.transformOrigin=lt.transformOrigin):toArray(lt).forEach(ut=>{let dt=lt.getPropertyValue(ut);ut==="font-size"&&dt.endsWith("px")&&(dt=`${Math.floor(parseFloat(dt.substring(0,dt.length-2)))-.1}px`),isInstanceOfElement(He,HTMLIFrameElement)&&ut==="display"&&dt==="inline"&&(dt="block"),ut==="d"&&Qe.getAttribute("d")&&(dt=`path(${Qe.getAttribute("d")})`),it.setProperty(ut,dt,lt.getPropertyPriority(ut))})}function cloneInputValue(He,Qe){isInstanceOfElement(He,HTMLTextAreaElement)&&(Qe.innerHTML=He.value),isInstanceOfElement(He,HTMLInputElement)&&Qe.setAttribute("value",He.value)}function cloneSelectValue(He,Qe){if(isInstanceOfElement(He,HTMLSelectElement)){const it=Qe,lt=Array.from(it.children).find(ut=>He.value===ut.getAttribute("value"));lt&&lt.setAttribute("selected","")}}function decorate(He,Qe){return isInstanceOfElement(Qe,Element)&&(cloneCSSStyle(He,Qe),clonePseudoElements(He,Qe),cloneInputValue(He,Qe),cloneSelectValue(He,Qe)),Qe}async function ensureSVGSymbols(He,Qe){const it=He.querySelectorAll?He.querySelectorAll("use"):[];if(it.length===0)return He;const lt={};for(let dt=0;dt<it.length;dt++){const ft=it[dt].getAttribute("xlink:href");if(ft){const vt=He.querySelector(ft),kt=document.querySelector(ft);!vt&&kt&&!lt[ft]&&(lt[ft]=await cloneNode(kt,Qe,!0))}}const ut=Object.values(lt);if(ut.length){const dt="http://www.w3.org/1999/xhtml",xt=document.createElementNS(dt,"svg");xt.setAttribute("xmlns",dt),xt.style.position="absolute",xt.style.width="0",xt.style.height="0",xt.style.overflow="hidden",xt.style.display="none";const ft=document.createElementNS(dt,"defs");xt.appendChild(ft);for(let vt=0;vt<ut.length;vt++)ft.appendChild(ut[vt]);He.appendChild(xt)}return He}async function cloneNode(He,Qe,it){return!it&&Qe.filter&&!Qe.filter(He)?null:Promise.resolve(He).then(lt=>cloneSingleNode(lt,Qe)).then(lt=>cloneChildren(He,lt,Qe)).then(lt=>decorate(He,lt)).then(lt=>ensureSVGSymbols(lt,Qe))}const URL_REGEX=/url\((['"]?)([^'"]+?)\1\)/g,URL_WITH_FORMAT_REGEX=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,FONT_SRC_REGEX=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function toRegex(He){const Qe=He.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${Qe})(['"]?\\))`,"g")}function parseURLs(He){const Qe=[];return He.replace(URL_REGEX,(it,lt,ut)=>(Qe.push(ut),it)),Qe.filter(it=>!isDataUrl(it))}async function embed(He,Qe,it,lt,ut){try{const dt=it?resolveUrl(Qe,it):Qe,xt=getMimeType(Qe);let ft;return ut||(ft=await resourceToDataURL(dt,xt,lt)),He.replace(toRegex(Qe),`$1${ft}$3`)}catch{}return He}function filterPreferredFontFormat(He,{preferredFontFormat:Qe}){return Qe?He.replace(FONT_SRC_REGEX,it=>{for(;;){const[lt,,ut]=URL_WITH_FORMAT_REGEX.exec(it)||[];if(!ut)return"";if(ut===Qe)return`src: ${lt};`}}):He}function shouldEmbed(He){return He.search(URL_REGEX)!==-1}async function embedResources(He,Qe,it){if(!shouldEmbed(He))return He;const lt=filterPreferredFontFormat(He,it);return parseURLs(lt).reduce((dt,xt)=>dt.then(ft=>embed(ft,xt,Qe,it)),Promise.resolve(lt))}async function embedProp(He,Qe,it){var lt;const ut=(lt=Qe.style)===null||lt===void 0?void 0:lt.getPropertyValue(He);if(ut){const dt=await embedResources(ut,null,it);return Qe.style.setProperty(He,dt,Qe.style.getPropertyPriority(He)),!0}return!1}async function embedBackground(He,Qe){await embedProp("background",He,Qe)||await embedProp("background-image",He,Qe),await embedProp("mask",He,Qe)||await embedProp("mask-image",He,Qe)}async function embedImageNode(He,Qe){const it=isInstanceOfElement(He,HTMLImageElement);if(!(it&&!isDataUrl(He.src))&&!(isInstanceOfElement(He,SVGImageElement)&&!isDataUrl(He.href.baseVal)))return;const lt=it?He.src:He.href.baseVal,ut=await resourceToDataURL(lt,getMimeType(lt),Qe);await new Promise((dt,xt)=>{He.onload=dt,He.onerror=xt;const ft=He;ft.decode&&(ft.decode=dt),ft.loading==="lazy"&&(ft.loading="eager"),it?(He.srcset="",He.src=ut):He.href.baseVal=ut})}async function embedChildren(He,Qe){const lt=toArray(He.childNodes).map(ut=>embedImages(ut,Qe));await Promise.all(lt).then(()=>He)}async function embedImages(He,Qe){isInstanceOfElement(He,Element)&&(await embedBackground(He,Qe),await embedImageNode(He,Qe),await embedChildren(He,Qe))}function applyStyle(He,Qe){const{style:it}=He;Qe.backgroundColor&&(it.backgroundColor=Qe.backgroundColor),Qe.width&&(it.width=`${Qe.width}px`),Qe.height&&(it.height=`${Qe.height}px`);const lt=Qe.style;return lt!=null&&Object.keys(lt).forEach(ut=>{it[ut]=lt[ut]}),He}const cssFetchCache={};async function fetchCSS(He){let Qe=cssFetchCache[He];if(Qe!=null)return Qe;const lt=await(await fetch(He)).text();return Qe={url:He,cssText:lt},cssFetchCache[He]=Qe,Qe}async function embedFonts(He,Qe){let it=He.cssText;const lt=/url\(["']?([^"')]+)["']?\)/g,dt=(it.match(/url\([^)]+\)/g)||[]).map(async xt=>{let ft=xt.replace(lt,"$1");return ft.startsWith("https://")||(ft=new URL(ft,He.url).href),fetchAsDataURL(ft,Qe.fetchRequestInit,({result:vt})=>(it=it.replace(xt,`url(${vt})`),[xt,vt]))});return Promise.all(dt).then(()=>it)}function parseCSS(He){if(He==null)return[];const Qe=[],it=/(\/\*[\s\S]*?\*\/)/gi;let lt=He.replace(it,"");const ut=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const vt=ut.exec(lt);if(vt===null)break;Qe.push(vt[0])}lt=lt.replace(ut,"");const dt=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,xt="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",ft=new RegExp(xt,"gi");for(;;){let vt=dt.exec(lt);if(vt===null){if(vt=ft.exec(lt),vt===null)break;dt.lastIndex=ft.lastIndex}else ft.lastIndex=dt.lastIndex;Qe.push(vt[0])}return Qe}async function getCSSRules(He,Qe){const it=[],lt=[];return He.forEach(ut=>{if("cssRules"in ut)try{toArray(ut.cssRules||[]).forEach((dt,xt)=>{if(dt.type===CSSRule.IMPORT_RULE){let ft=xt+1;const vt=dt.href,kt=fetchCSS(vt).then(St=>embedFonts(St,Qe)).then(St=>parseCSS(St).forEach(Tt=>{try{ut.insertRule(Tt,Tt.startsWith("@import")?ft+=1:ut.cssRules.length)}catch(Mt){console.error("Error inserting rule from remote css",{rule:Tt,error:Mt})}})).catch(St=>{console.error("Error loading remote css",St.toString())});lt.push(kt)}})}catch(dt){const xt=He.find(ft=>ft.href==null)||document.styleSheets[0];ut.href!=null&&lt.push(fetchCSS(ut.href).then(ft=>embedFonts(ft,Qe)).then(ft=>parseCSS(ft).forEach(vt=>{xt.insertRule(vt,ut.cssRules.length)})).catch(ft=>{console.error("Error loading remote stylesheet",ft)})),console.error("Error inlining remote css file",dt)}}),Promise.all(lt).then(()=>(He.forEach(ut=>{if("cssRules"in ut)try{toArray(ut.cssRules||[]).forEach(dt=>{it.push(dt)})}catch(dt){console.error(`Error while reading CSS rules from ${ut.href}`,dt)}}),it))}function getWebFontRules(He){return He.filter(Qe=>Qe.type===CSSRule.FONT_FACE_RULE).filter(Qe=>shouldEmbed(Qe.style.getPropertyValue("src")))}async function parseWebFontRules(He,Qe){if(He.ownerDocument==null)throw new Error("Provided element is not within a Document");const it=toArray(He.ownerDocument.styleSheets),lt=await getCSSRules(it,Qe);return getWebFontRules(lt)}async function getWebFontCSS(He,Qe){const it=await parseWebFontRules(He,Qe);return(await Promise.all(it.map(ut=>{const dt=ut.parentStyleSheet?ut.parentStyleSheet.href:null;return embedResources(ut.cssText,dt,Qe)}))).join(`
`)}async function embedWebFonts(He,Qe){const it=Qe.fontEmbedCSS!=null?Qe.fontEmbedCSS:Qe.skipFonts?null:await getWebFontCSS(He,Qe);if(it){const lt=document.createElement("style"),ut=document.createTextNode(it);lt.appendChild(ut),He.firstChild?He.insertBefore(lt,He.firstChild):He.appendChild(lt)}}async function toSvg(He,Qe={}){const{width:it,height:lt}=getImageSize(He,Qe),ut=await cloneNode(He,Qe,!0);return await embedWebFonts(ut,Qe),await embedImages(ut,Qe),applyStyle(ut,Qe),await nodeToDataURL(ut,it,lt)}async function toCanvas(He,Qe={}){const{width:it,height:lt}=getImageSize(He,Qe),ut=await toSvg(He,Qe),dt=await createImage$1(ut),xt=document.createElement("canvas"),ft=xt.getContext("2d"),vt=Qe.pixelRatio||getPixelRatio(),kt=Qe.canvasWidth||it,St=Qe.canvasHeight||lt;return xt.width=kt*vt,xt.height=St*vt,Qe.skipAutoScale||checkCanvasDimensions(xt),xt.style.width=`${kt}`,xt.style.height=`${St}`,Qe.backgroundColor&&(ft.fillStyle=Qe.backgroundColor,ft.fillRect(0,0,xt.width,xt.height)),ft.drawImage(dt,0,0,xt.width,xt.height),xt}async function toPng(He,Qe={}){return(await toCanvas(He,Qe)).toDataURL()}const emojioneV1Fireworks=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 64 64",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"#0c567d",d:"M63.68 56.51c0 3.753-3.208 6.859-6.957 6.859H7.333c-3.745 0-7.02-3.106-7.02-6.859V7.13C.314 3.382 3.588.002 7.333.002h49.39c3.749 0 6.957 3.38 6.957 7.128v49.38"}),jsxRuntimeExports.jsx("path",{fill:"#fff",d:"M17.548 40.3c.911.905-1 4.292-4.267 7.556c-3.27 3.267-6.649 5.178-7.562 4.271c-.907-.911 1-4.298 4.27-7.563c3.265-3.266 6.656-5.179 7.559-4.264M57.27 51.26c.915-.907-1-4.292-4.267-7.556c-3.268-3.269-6.648-5.178-7.56-4.269c-.906.909 1 4.296 4.271 7.56c3.267 3.269 6.654 5.18 7.556 4.265",opacity:.3}),jsxRuntimeExports.jsxs("g",{fill:"#f5eb35",children:[jsxRuntimeExports.jsx("ellipse",{cx:5.495,cy:30.771,rx:4.01,ry:2.326}),jsxRuntimeExports.jsx("ellipse",{cx:58.27,cy:30.771,rx:4.01,ry:2.33}),jsxRuntimeExports.jsx("ellipse",{cx:21.23,cy:3.583,rx:2.076,ry:1.207,transform:"rotate(65.165 21.231 3.581)"})]}),jsxRuntimeExports.jsx("path",{fill:"#fff",d:"M27.301 17.769c-.926.43-3.482-3.125-5.712-7.947c-2.227-4.815-3.284-9.06-2.355-9.495c.926-.427 3.482 3.127 5.71 7.942c2.227 4.82 3.282 9.07 2.357 9.5",opacity:.3}),jsxRuntimeExports.jsx("ellipse",{cx:42.793,cy:3.584,fill:"#f5eb35",rx:2.077,ry:1.205,transform:"rotate(-65.172 42.792 3.584)"}),jsxRuntimeExports.jsx("path",{fill:"#fff",d:"M23.66 48.03c-.837-.354-2.086.505-2.793 1.914c-.707 1.413-.605 2.842.231 3.195c.833.354 2.085-.502 2.792-1.911c.708-1.413.605-2.843-.23-3.198",opacity:.8}),jsxRuntimeExports.jsx("path",{fill:"#fff",d:"M23.418 48.807c-1.446-.615-3.608.868-4.829 3.309c-1.222 2.44-1.047 4.913.399 5.525c1.442.613 3.607-.866 4.827-3.307c1.225-2.44 1.048-4.916-.397-5.527m16.842-.002c1.446-.613 3.608.87 4.829 3.311c1.222 2.44 1.047 4.913-.399 5.525c-1.442.613-3.606-.866-4.827-3.307c-1.225-2.44-1.048-4.916.397-5.529",opacity:.8}),jsxRuntimeExports.jsx("path",{fill:"#fff",d:"M42.684 53.14c-.837.354-2.087-.502-2.795-1.911c-.708-1.413-.605-2.844.229-3.198c.837-.354 2.087.505 2.795 1.914c.707 1.408.604 2.841-.229 3.195",opacity:.8}),jsxRuntimeExports.jsx("path",{fill:"#f5eb35",d:"M9.06 54.51c.911.913.377 2.92-1.188 4.483c-1.565 1.564-3.571 2.098-4.48 1.19c-.909-.908-.377-2.915 1.188-4.484c1.567-1.564 3.573-2.093 4.48-1.189m47.649-41.27c-.909-.91-.377-2.914 1.191-4.479c1.563-1.569 3.569-2.099 4.479-1.193c.909.912.378 2.919-1.189 4.483c-1.565 1.567-3.57 2.098-4.481 1.189M53.43 54.51c.911-.906 2.916-.377 4.48 1.189c1.564 1.567 2.099 3.574 1.188 4.482c-.907.907-2.912.374-4.48-1.19c-1.566-1.563-2.098-3.57-1.188-4.481M8.328 13.24c-.909.911-2.914.376-4.479-1.188C2.285 10.484 1.751 8.48 2.66 7.568c.909-.906 2.918-.376 4.481 1.193c1.567 1.566 2.098 3.573 1.187 4.479M32 19.666l7.608-9.135L39.15 22.1l12.11-2.434l-8.308 8.584l10.95 5.413l-12.271 1.587L46.3 45.973l-10.495-6.155L32 63.3l-3.8-23.482l-10.496 6.155l4.667-10.723L10.1 33.663l10.95-5.413l-8.309-8.584l12.11 2.434l-.457-11.569z"}),jsxRuntimeExports.jsxs("g",{fill:"#fff",children:[jsxRuntimeExports.jsx("path",{d:"m32 20.08l6.472-7.778l-.392 9.838l10.31-2.06l-7.07 7.303l9.317 4.605L40.19 33.34l3.97 9.12l-8.92-5.24L32 43.25l-3.237-6.03l-8.926 5.24l3.969-9.12l-10.443-1.352l9.32-4.605l-7.07-7.303l10.306 2.06l-.389-9.838z",opacity:.8}),jsxRuntimeExports.jsx("ellipse",{cx:32.25,cy:30.666,opacity:.8,rx:9.149,ry:8.545}),jsxRuntimeExports.jsx("path",{d:"M39.916 35.528c0 3.957-3.432 7.164-7.665 7.164c-4.235 0-7.667-3.207-7.667-7.164c0-3.953 3.431-7.161 7.667-7.161c4.233 0 7.665 3.208 7.665 7.161",opacity:.7})]}),jsxRuntimeExports.jsx("path",{fill:"#fff",d:"M44.751.326c-.927-.431-3.484 3.125-5.715 7.948c-2.227 4.813-3.281 9.06-2.355 9.495c.927.426 3.484-3.128 5.711-7.943c2.228-4.821 3.281-9.07 2.359-9.5m-30.57 18.116c-.907.913-4.294-1-7.556-4.268c-3.27-3.269-5.177-6.648-4.27-7.561c.911-.907 4.295 1 7.56 4.271c3.266 3.265 5.181 6.654 4.266 7.558M62.18 6.616c-.907-.913-4.294 1-7.556 4.267c-3.271 3.269-5.178 6.65-4.271 7.561c.911.907 4.296-1 7.56-4.27c3.266-3.266 5.182-6.656 4.267-7.558",opacity:.3})]}),openShareRankingArtworkDialog=(He,Qe)=>new Promise((it,lt)=>{const ut=dialog({children:jsxRuntimeExports.jsx(RankingArtworkShareDialogContent,{onClose:()=>{ut.current?.close(),it(null)},artwork:He,opts:Qe}),onClose:()=>{it(null)},fullWidth:!1,responsive:!0,dialogProps:{maxWidth:"sm"}})});function RankingArtworkShareDialogContent(He){const{t:Qe}=useTranslation(["common"]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("section",{className:"flex flex-col items-center pt-6 pb-1",children:[jsxRuntimeExports.jsx(emojioneV1Fireworks,{width:48,height:48}),jsxRuntimeExports.jsx("h1",{className:"mt-1 text-center font-semibold text-lg sm:text-xl",children:Qe("common:ranking.title.share-dialog.top-congrats")}),jsxRuntimeExports.jsx("p",{className:"whitespace-pre-line text-center font-semibold text-lg sm:text-xl",children:Qe("common:ranking.title.share-dialog.top",{filterType:He.opts.filterType,type:He.opts.type})})]}),jsxRuntimeExports.jsx("section",{className:"mt-1",children:jsxRuntimeExports.jsx(RankingArtworkDialogContent,{...He})})]})}function RankingArtworkDialogContent(He){const{artwork:Qe,opts:it}=He;return Qe.media?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(RankingArtworkShareActionBar,{artwork:Qe}),jsxRuntimeExports.jsx(RankingArtworkPreview,{artwork:Qe,rankingOpts:it})]}):null}function RankingArtworkShareActionBar(He){return jsxRuntimeExports.jsx("div",{className:"overflow-x-auto py-[5px] w-full",children:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center gap-2 mx-auto w-fit",children:jsxRuntimeExports.jsx(ArtworkSocialShareButtons,{artwork:He.artwork,scene:"ranking"})})})}const displayHeightDeduction=32*2+136+4+58+16*2+64,mobileDisplayHeightDeduction=278+16*2+64;function RankingArtworkPreview(He){const Qe=useIsMobile(),{artwork:it,rankingOpts:lt}=He,{media:ut}=it;if(!ut?.height)return null;const dt=document.documentElement.style.getPropertyValue("--visible-height"),xt=(Number(dt.replace("px",""))||0)-(Qe?mobileDisplayHeightDeduction:displayHeightDeduction),vt=ut.height/12/75,kt=xt/ut.height*vt,St=xt;return jsxRuntimeExports.jsx(RankingArtworkWithWatermarkImage,{className:"my-4 px-4",imageHeight:St,artwork:He.artwork,scale:kt,mode:"preview",rankingOpts:lt})}function RankingArtworkWithWatermarkImage(He){const{t:Qe}=useTranslation(["common"]),{imageHeight:it,artwork:lt,scale:ut,mode:dt,rankingOpts:xt}=He,{media:ft}=lt;if(!ft)return null;const vt=getPublicUrl(ft),kt=isAnimatedArtwork(lt)&&getMediaUrl(lt.videoMediaId,"orig"),St=globalThis.devicePixelRatio??1;return jsxRuntimeExports.jsx("div",{className:cx("flex flex-col items-center justify-center",He.className),children:jsxRuntimeExports.jsxs("div",{className:"relative",style:{fontSize:`calc(16px * ${ut})`,paddingBottom:64,minHeight:it,minWidth:ft.width&&ft.height&&it?ft.width/ft.height*it:0},children:[kt?jsxRuntimeExports.jsx(VideoMedia,{autoPlay:!0,src:kt,className:"h-full object-cover rounded-lg",style:{maxHeight:it}}):jsxRuntimeExports.jsx("img",{src:vt,className:"h-full object-cover rounded-lg",style:{maxHeight:it??(dt==="snapshot"?(ft.height??512)/St:void 0)},loading:"lazy",crossOrigin:"anonymous"}),jsxRuntimeExports.jsx("div",{className:"absolute select-none top-0 left-0 w-full flex",style:{height:"calc(100% - 64px)"},children:jsxRuntimeExports.jsx(RankingOverlay,{rankingOpts:xt,media:ft,imageHeight:it,scale:ut,title:Qe("common:ranking.title.share-dialog.bottom",{filterType:He.rankingOpts.filterType,type:He.rankingOpts.type}),className:"rounded-b-lg"})}),jsxRuntimeExports.jsx(RankingBottomActionBar,{artwork:lt,rankingOpts:xt})]})})}function RankingOverlay(He){return jsxRuntimeExports.jsxs("div",{className:cx("mt-auto items-center w-full bg-black/50 px-6 gap-4",He.className),style:{display:"flex",height:"6em"},children:[jsxRuntimeExports.jsx("p",{className:"flex items-center justify-center text-white font-semibold rounded bg-purple-700 tabular-nums pointer-events-none",style:{fontSize:"2em",width:"2.25em",padding:"0.325em 0"},children:He.rankingOpts.rankNumber}),jsxRuntimeExports.jsx("p",{className:cx("font-semibold capitalize shrink-0 text-white"),style:{fontSize:"1.5em"},children:He.title})]})}function RankingBottomActionBar(He){const{t:Qe}=useTranslation(["common"]),it=reactExports.useRef(null),{artwork:lt,rankingOpts:ut}=He,dt=isAnimatedArtwork(lt),[xt,ft]=useLoadingCallback(async()=>{track("share_image_dl_click",{scene:"ranking"});const St=getImageDownloadFileExt({artwork:lt,media:lt.media}),Tt=`${getImageDownloadFilename({artwork:lt})}.${St}`,Mt=dt?getMediaUrl(lt.videoMediaId,"orig"):await it.current?.snapshot?.();if(Mt)try{await downloadFile(Mt,Tt,{skipConversion:dt}),track("share_image_dl_dialog_show",{scene:"ranking"}),openArtworkShareActionSuccessDialog(Qe,{type:"download"})}catch(Nt){toast.error(Qe("artwork:share.watermark-dialog.notice.failed-to-download")+": ",Nt.message)}},[lt,dt]),[vt,kt]=useLoadingCallback(async()=>{track("share_copy_image_click",{scene:"ranking"});const St="image/png";try{const Tt=async()=>{const Mt=await it.current?.snapshot?.();if(!Mt)throw new Error("File URL not available");let Nt;const At=await fetch(Mt).then($t=>$t.blob());if(At.type==="image/png"?Nt=At:Nt=await convertBlobToPng(At,"image.png"),!Nt)throw new Error("image not exists");return Nt};await navigator.clipboard.write([new ClipboardItem({[St]:Tt()})]),track("share_copy_image_dialog_show",{scene:"ranking"}),openArtworkShareActionSuccessDialog(Qe,{type:"copy"})}catch(Tt){toast.error(Qe("artwork:share.watermark-dialog.notice.failed-to-copy")+": "+Tt.message)}},[lt]);return isSafari()?null:jsxRuntimeExports.jsxs("div",{className:"flex items-center absolute bottom-0 px-2 py-3 w-full gap-4 min-w-[120px] justify-end",style:{fontSize:"16px"},children:[!dt&&jsxRuntimeExports.jsx(Button,{className:"min-w-0 w-10 h-10 rounded-full",disabled:vt,onClick:kt,children:vt?jsxRuntimeExports.jsx(CircularProgress,{className:"text-primary",size:20}):jsxRuntimeExports.jsx(icBaselineContentCopy,{width:20,height:20})}),jsxRuntimeExports.jsx(Button,{disabled:xt,className:"min-w-0 w-10 h-10 rounded-full",onClick:ft,children:xt?jsxRuntimeExports.jsx(CircularProgress,{className:"text-primary",size:20}):jsxRuntimeExports.jsx(materialSymbolsDownload,{fontSize:20})}),lt.media&&jsxRuntimeExports.jsx(RankingArtworkSnapshot,{...He,media:lt.media,title:Qe("common:ranking.title.share-dialog.bottom",{filterType:ut.filterType,type:ut.type}),ref:it})]})}const RankingArtworkSnapshot=reactExports.forwardRef(function He(Qe,it){const[lt,ut]=reactExports.useState(void 0),{media:dt,title:xt}=Qe,ft=reactExports.useCallback(async()=>{const Mt=document.getElementById("snapshot");if(!Mt)return;const Nt={width:Mt.clientWidth,height:Mt.clientHeight,pixelRatio:1};try{return await toPng(Mt,Nt)}catch(At){toast.error(`${At?.message}`)}},[]);if(reactExports.useImperativeHandle(it,()=>({snapshot:ft}),[ft]),reactExports.useEffect(()=>{const Mt=getPublicUrl(dt);Mt&&fetchToBase64(Mt).then(Nt=>Nt&&ut(Nt))},[dt.id]),!dt.height)return null;const vt=(dt.height??512)/12,kt=globalThis.devicePixelRatio??1,St=vt/72/kt,Tt=jsxRuntimeExports.jsxs("div",{id:"snapshot",className:"relative",children:[jsxRuntimeExports.jsx("img",{src:lt,className:"object-cover",loading:"lazy",crossOrigin:"anonymous",style:{maxHeight:dt.height/kt}}),jsxRuntimeExports.jsx("div",{className:"absolute select-none bottom-0 left-0 w-full",style:{fontSize:`calc(16px * ${St})`},children:jsxRuntimeExports.jsx(RankingOverlay,{...Qe,title:xt})})]});return reactDomExports.createPortal(jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:-99999,top:-99999,pointerEvents:"none"},children:Tt}),document.body)}),RankingContentType={Artwork:"artwork",Animated:"animated",Comic:"comic",Model:"model",Lora:"lora"},RankingRangeType={Today:"today",Weekly:"weekly",Monthly:"monthly",Newbies:"newbies"},getDayToDisplayForRanking=()=>defaultDayjs(new Date).format("MMM DD"),getRankingPageTitle=(He,Qe,it)=>{const lt=He(`common:ranking.${Qe}.label`);return $$3(it).with(RankingRangeType.Today,()=>He("common:ranking.title.daily-artwork",{type:lt})).with(RankingRangeType.Weekly,()=>{const ut=new Date,dt=defaultDayjs(ut).subtract(6,"day"),xt=defaultDayjs(dt).format("MMM DD")+"-"+defaultDayjs(ut).format("MMM DD");return He("common:ranking.title.filter-type-artwork",{filterType:xt,type:lt})}).with(RankingRangeType.Monthly,()=>{const dt=defaultDayjs(new Date).format("MMM");return He("common:ranking.title.filter-type-artwork",{filterType:dt,type:lt})}).with(RankingRangeType.Newbies,()=>He("common:ranking.title.filter-type-artwork",{filterType:He("common:ranking.filter-type.newbies"),type:lt})).exhaustive()},getRankingPageGridTitle=(He,Qe,it)=>{const lt=He(`common:ranking.${Qe}.label`);return $$3(it).with(RankingRangeType.Today,()=>He("common:ranking.title.filter-type-artwork",{type:lt,filterType:He("common:ranking.filter-type.daily")})).with(RankingRangeType.Weekly,()=>He("common:ranking.title.filter-type-artwork",{type:lt,filterType:He("common:ranking.filter-type.weekly")})).with(RankingRangeType.Monthly,()=>He("common:ranking.title.filter-type-artwork",{filterType:He("common:ranking.filter-type.monthly"),type:lt})).with(RankingRangeType.Newbies,()=>He("common:ranking.title.filter-type-artwork",{filterType:He("common:ranking.filter-type.newbies"),type:lt})).exhaustive()},getArtworkTypeLabelKeyForRanking=He=>{switch(He?.data?.rank?.mediaType){case RankMediaType.Comic:return RankingContentType.Comic;case RankMediaType.ArtworkAnimated:return RankingContentType.Animated;default:return RankingContentType.Artwork}},notiIdSet=new Set;function ackNotification(He){notiIdSet.add(He),debounce(()=>performMutateAck(),2e3)()}async function performMutateAck(){const He=Array.from(notiIdSet);if(He.length!==0)try{await executeMarkNotificationRead({ids:He}),He.forEach(Qe=>notiIdSet.delete(Qe)),refetchListMyNotifications()}catch(Qe){console.log(Qe)}}function NotificationActions(He){const{type:Qe}=He.item;return Qe===NotificationType.Follow?jsxRuntimeExports.jsx(NotificationFollowAction,{item:He.item}):null}function NotificationFollowAction(He){const{t:Qe}=useTranslation(["user"]),{relatedUserIds:it}=He.item,{data:lt}=useGetUserInfoById(it?.[0]??skipToken);return lt?jsxRuntimeExports.jsx(UserFollowButton,{userId:lt.id,initialValue:lt.followedByMe,className:"font-semibold text-xs text-white py-1 px-3",followProps:{className:"bg-purple-600",label:Qe("user:follow-back")},followingProps:{className:"bg-gray-400",variant:"contained"},disableUnfollow:!0,scene:"notification"}):null}const getTabTypeForDataTracking=(He,Qe)=>{const it=He.find(lt=>lt.types.includes(Qe));return it?it.label:void 0},_NotificationItem=({item:He})=>{const{t:Qe}=useTranslation(["common"]),{closePanel:it}=reactExports.useContext(NotificationListContext),{ref:lt,entry:ut}=useIntersection({root:document.getElementById("notifications-container"),rootMargin:"0px",threshold:1}),dt=useNavigate(),{data:xt}=useUserInfo(),ft=useNotificationTabs();reactExports.useEffect(()=>{if(He.unread&&ut?.isIntersecting){if(Number.isNaN(Number(He.id)))return;ackNotification(He.id)}},[ut,He.id,He.unread]);const{relatedUsers:vt,artwork:kt,createdAt:St,refId:Tt,refMedia:Mt,refType:Nt,refTitle:At,updatedAt:$t,type:Dt,unread:Ft}=He,Bt=reactExports.useMemo(()=>{if(!vt||vt.length===0)return;const gr=getUserDisplayName(vt[0]),br=jsxRuntimeExports.jsx("div",{className:"inline-block",children:jsxRuntimeExports.jsx(Link,{target:"_blank",to:`/@${vt[0].username}`,onClick:vr=>{vr.preventDefault(),vr.stopPropagation(),window.open(`/@${vt[0].username}`,"_blank")},children:jsxRuntimeExports.jsx("span",{className:"text-primary font-bold",children:gr})})});return vt.length>1?jsxRuntimeExports.jsx(Trans,{i18nKey:"common:someone-and-x-others",values:{x:vt.length-1,name:gr},children:br}):br},[vt]),Ot=At&&jsxRuntimeExports.jsxs("span",{className:"text-primary font-medium",children:[Qe("common:punctuations.colon")," ",At]}),Qt=reactExports.useMemo(()=>{if(kt&&!appealNotificationTypes.includes(Dt)){const gr=getArtworkTypeLabelKeyForRanking(He),br=$$3(He).with({type:NotificationType.Like},()=>$$3(He).with({artwork:{type:ArtworkType.ComfyFlow}},()=>Qe("common:notification.liked-your-workflow")).otherwise(()=>Qe("common:notification.liked-your-artwork"))).with({type:NotificationType.Comment},()=>$$3(He).with({artwork:{type:ArtworkType.ComfyFlow}},()=>Qe("common:notification.comment-your-workflow")).otherwise(()=>Qe("common:notification.comment-your-artwork"))).with({type:NotificationType.CommentReply},()=>Qe("common:notification.reply-to-your-comment")).with({type:NotificationType.DailyRanking},yr=>Qe("common:notification.your-artwork-made-ranking",{filterType:Qe("common:ranking.filter-type.daily"),type:Qe(`common:ranking.${gr}.label`)})).with({type:NotificationType.WeeklyRanking},()=>Qe("common:notification.your-artwork-made-ranking",{filterType:Qe("common:ranking.filter-type.weekly"),type:Qe(`common:ranking.${gr}.label`)})).with({type:NotificationType.MonthlyRanking},()=>Qe("common:notification.your-artwork-made-ranking",{filterType:Qe("common:ranking.filter-type.monthly"),type:Qe(`common:ranking.${gr}.label`)})).with({type:NotificationType.NewbiesRanking},()=>Qe("common:notification.your-artwork-made-ranking",{filterType:Qe("common:ranking.filter-type.new-user"),type:Qe(`common:ranking.${gr}.label`)})).with({type:NotificationType.ContestReward},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.contest-reward")})).with({type:NotificationType.WorldNewCharacter},()=>jsxRuntimeExports.jsx("span",{className:"text-primary-light",children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:notification.added-character",components:{b:jsxRuntimeExports.jsx("span",{className:"text-primary font-medium"})},tOptions:{worldName:He.data?.world?.name}})})).otherwise(()=>null),vr=He.type===NotificationType.Comment||He.type===NotificationType.CommentReply?He.content:kt.title;return jsxRuntimeExports.jsxs("span",{className:"text-primary-light",children:[Bt," ",br,vr?jsxRuntimeExports.jsxs("span",{className:"text-primary",children:[Qe("common:punctuations.colon")," ",vr]}):null]})}return $$3(He).returnType().with({type:NotificationType.Follow},()=>jsxRuntimeExports.jsxs("span",{children:[Bt," ",Qe("common:notification.followed-you")]})).with({type:NotificationType.ModelClaim},()=>jsxRuntimeExports.jsxs("span",{className:"",children:[jsxRuntimeExports.jsx("span",{className:"mr-1",children:"🎊"}),Qe("common:notification.claimed-model"),Ot]})).with({type:NotificationType.ModelClaimedByOthers},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.model-claimed-by-others",{modelName:At??"unknown"})})).with({type:NotificationType.ItemLike,refType:RefType.Model},()=>jsxRuntimeExports.jsxs("span",{className:"text-primary-light",children:[Bt," ",Qe("common:notification.liked-your-model"),Ot]})).with({type:NotificationType.ItemLike},()=>jsxRuntimeExports.jsxs("span",{className:"text-primary-light",children:[Bt," ",Qe("common:notification.liked-your-unknown-item"),Ot]})).with({type:NotificationType.TrainingTaskCompleted},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.your-training-task-is-completed")})).with({type:NotificationType.Privilege,content:N$4.when(gr=>!!gr)},gr=>jsxRuntimeExports.jsx("span",{children:gr.content})).with({type:NotificationType.Privilege,data:N$4.when(gr=>!!gr?.memberGift)},gr=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.privilege-relaunch-gift-received",{percentage:gr.data.memberGift.percentage??50})})).with({type:NotificationType.Privilege},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.privilege-received")})).with({type:NotificationType.MembershipGifted},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.membership-gifted")})).with({type:NotificationType.MembershipExpired},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.membership-expired")})).with({type:NotificationType.MembershipRenewed},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.membership-renewed")})).with({type:NotificationType.MembershipRenewalFailed},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.membership-renewal-failed")})).with({type:NotificationType.PaymentFailed},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.payment-failed")})).with({type:NotificationType.ModelCoverNsfw},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.model-cover-nsfw")})).with({type:NotificationType.UserAvatarNsfw},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.user-avatar-nsfw")})).with({type:NotificationType.UserCoverNsfw},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.user-cover-nsfw")})).with({type:NotificationType.AppealAccepted},()=>jsxRuntimeExports.jsx("span",{children:Qe(`common:notification.appeal-accepted.${He.refType?.toLowerCase()??"unknown"}`)})).with({type:NotificationType.AppealRejected},()=>jsxRuntimeExports.jsx("span",{children:Qe(`common:notification.appeal-rejected.${He.refType?.toLowerCase()??"unknown"}`)})).with({type:NotificationType.ContestReward},()=>jsxRuntimeExports.jsx("span",{children:Qe("common:notification.contest-reward")})).with({type:NotificationType.System},()=>jsxRuntimeExports.jsx("span",{className:"whitespace-break-spaces",children:He.content})).otherwise(()=>null)},[He,Bt,kt,Qe]),Wt=reactExports.useMemo(()=>$$3({artworkId:kt?.id,characterId:kt?.character?.id,type:He.type,refType:Nt,refId:Tt,firstUsername:vt?.[0]?.username,link:He.link}).returnType().with({link:N$4.string},gr=>gr.link).with({type:N$4.when(gr=>rankingNotificationTypes.includes(gr))},()=>"").with({characterId:N$4.string},({characterId:gr})=>`/character/${gr}`).with({artworkId:N$4.string},({artworkId:gr})=>`/artwork/${gr}`).with({firstUsername:N$4.string},({firstUsername:gr})=>`/@${gr}`).with({refType:RefType.Model,refId:N$4.string},({refId:gr})=>`/model/${gr}`).with({type:NotificationType.Privilege},()=>`/@${xt?.username}/credits`).with({type:NotificationType.PaymentFailed},()=>"/me").with({type:NotificationType.MembershipExpired},()=>"/membership/plans").with({type:NotificationType.MembershipGifted},()=>"/me").otherwise(()=>""),[kt?.id,Tt,Nt,He.type,vt?.[0]?.username]),Xt=reactExports.useMemo(()=>kt?$$3({type:He.type}).with({type:N$4.when(gr=>rankingNotificationTypes.includes(gr))},()=>()=>{const gr=getArtworkTypeLabelKeyForRanking(),br=Dt===NotificationType.DailyRanking?"today":Dt===NotificationType.WeeklyRanking?"weekly":Dt===NotificationType.MonthlyRanking?"monthly":"newbies";it(),openShareRankingArtworkDialog(kt,{rankNumber:He.data?.rank?.rankNumber??1,type:gr,filterType:br})}).otherwise(()=>null):null,[He.type,kt?.id]);if(!Qt)return jsxRuntimeExports.jsx("div",{className:"h-px"});const Kt=systemNotificationTypes.includes(Dt),Jt=Dt===NotificationType.MembershipExpired,hr=$$3({unread:Ft,type:Dt}).returnType().with({type:N$4.when(gr=>warningNotificationTypes.includes(gr))},()=>"warning").with({type:N$4.when(gr=>highlightedNotificationTypes.includes(gr))},()=>"highlight").with({unread:!0},()=>"unread").otherwise(()=>"normal"),xr=notificationStyleClassNames[hr];return jsxRuntimeExports.jsxs(ButtonBase,{className:cx("w-full p-2 mb-1 rounded-2xl flex items-center gap-2 text-sm transition duration-100 group",He.className??xr),ref:lt,onClick:()=>{Kt?track("notification_system_content_click",{type:Dt}):track("notification_content_click",{type:getTabTypeForDataTracking(ft,Dt)}),Jt&&startEventGroup("member_source","membership-expired-noti",{persistent:!0}),Wt&&(Wt.startsWith("/")?dt(Wt):window.open(Wt,"_blank","noopener")),Xt?.()},children:[jsxRuntimeExports.jsx(NotificationLeft,{item:He}),jsxRuntimeExports.jsxs("div",{className:"flex-1 no-underline block text-left self-stretch",children:[Qt," ",jsxRuntimeExports.jsx("span",{className:"text-primary-light text-xs whitespace-nowrap block mt-1",children:formatTime(St)})]}),jsxRuntimeExports.jsx(NotificationRight,{item:He})]})},NotificationItem=reactExports.memo(_NotificationItem),avatarAsPreviewTypes=[NotificationType.Follow],NotificationLeft=He=>{const{item:Qe}=He,{relatedUsers:it,type:lt}=Qe;if(systemNotificationTypes.includes(lt)){const ft=getSystemIconMap(lt);return ft?jsxRuntimeExports.jsx("div",{children:ft({className:"w-8 h-8 text-[32px] opacity-40 group-hover:opacity-80 transition"})}):null}const dt=it&&it.length>0?jsxRuntimeExports.jsx(Link,{to:`/@${it[0].username}`,target:"_blank",onClick:()=>{track("notification_avatar_click")},className:"shrink-0",children:jsxRuntimeExports.jsx(UserAvatar,{user:it[0],style:{width:42,height:42}})}):jsxRuntimeExports.jsx("div",{className:"rounded-full h-[42px] w-[42px] bg-slate-500 shrink-0"});return avatarAsPreviewTypes.includes(lt)?dt:jsxRuntimeExports.jsx(MediaPreview,{item:Qe})},NotificationRight=He=>{const{type:Qe}=He.item;return systemNotificationTypes.includes(Qe)?jsxRuntimeExports.jsx(MediaPreview,{item:He.item}):jsxRuntimeExports.jsx(NotificationActions,{item:He.item})},MediaPreview=He=>{const{artwork:Qe,refId:it,refMedia:lt,refType:ut}=He.item,dt=ut===RefType.Artwork?`/artwork/${it}`:Qe!=null?`/artwork/${Qe.id}`:ut===RefType.Model?`/model/${it}`:"",xt=getThumbnailUrl(lt??Qe?.media);return xt?jsxRuntimeExports.jsx(Link,{to:dt,target:"_blank",className:"w-[62px] h-[62px] rounded-xl bg-cover bg-center",style:{backgroundImage:`url(${xt})`},title:"related artwork image",onClick:vt=>{vt.stopPropagation(),track("notification_preview_click")}}):null};function getSystemIconMap(He){return $$3({type:He}).returnType().when(({type:Qe})=>[NotificationType.ModelClaim,NotificationType.TrainingTaskCompleted,NotificationType.ModelClaimedByOthers].includes(Qe),()=>icRoundMarkEmailUnread).when(({type:Qe})=>[NotificationType.ContestReward,NotificationType.MembershipExpired,NotificationType.MembershipRenewalFailed].includes(Qe),()=>icRoundMarkEmailUnread).when(({type:Qe})=>[NotificationType.PaymentFailed,NotificationType.ModelCoverNsfw,NotificationType.UserAvatarNsfw,NotificationType.UserCoverNsfw].includes(Qe),()=>fluentWarning24Filled).when(({type:Qe})=>[NotificationType.Privilege,NotificationType.MembershipGifted,NotificationType.MembershipRenewed].includes(Qe),()=>mdiCrownCircle).when(({type:Qe})=>[NotificationType.AppealAccepted].includes(Qe),()=>fluentCheckmarkNote20Filled).when(({type:Qe})=>[NotificationType.AppealRejected].includes(Qe),()=>fluentProhibitedNote20Filled).otherwise(()=>()=>null)}const notificationStyleClassNames={unread:"bg-hover",normal:"hover:bg-background-light active:bg-background-light active:brightness-90",warning:"bg-amber-100 hover:bg-amber-200 dark:bg-amber-700 dark:hover:bg-amber-600",highlight:"bg-violet-100 hover:bg-violet-200 dark:bg-violet-700 dark:hover:bg-violet-600"};function NotificationList(He){const Qe=usePinnedDitModelReleaseEventNotification(),{t:it}=useTranslation(["common"]),[lt,ut]=reactExports.useState([]),[dt,xt]=reactExports.useState(),[ft,vt]=reactExports.useState(!0),kt=reactExports.useRef(),St=5,Tt=He.id==="system"&&Qe?Qe:[],[Mt,Nt]=useLoadingCallback(async()=>{try{const Bt=(await fetchListMyNotifications({last:St,type:He.types,before:kt.current})).data?.me?.notifications,Ot=getNodesFromConnection(Bt).reverse();ut(Qt=>uniqBy([...Qt,...Ot.filter(Wt=>!!Wt.id)],"id")),xt(Bt?.totalCount),vt(!!Bt?.pageInfo?.hasPreviousPage),kt.current=Bt?.pageInfo?.startCursor}catch(Ft){console.error("notificaiton list",Ft)}},[He.types]);reactExports.useEffect(()=>{He.onMarkRead(He.types),ut([]),xt(void 0),vt(!0),kt.current=void 0,Nt()},[He.types]);const At=reactExports.useMemo(()=>$newNotification.pipe(filter$3(Ft=>He.types.includes(Ft.type)),scan((Ft,Bt)=>[Bt,...Ft],[])),[He.types]),$t=useObservable(At,[]);reactExports.useEffect(()=>{ut(Ft=>uniqBy([...$t.filter(Bt=>!!Bt.id),...Ft],"id"))},[$t]);const Dt=[...Tt,...lt];return Dt.length===0?Mt?jsxRuntimeExports.jsx(Preloader,{}):jsxRuntimeExports.jsx(Empty,{description:it("common:notification.empty")}):jsxRuntimeExports.jsx("div",{className:"h-[min(384px,calc(100vh-176px))] md:h-[500px]",id:"notifications-container",children:jsxRuntimeExports.jsx(Kr,{totalCount:dt,data:Dt,endReached:()=>{ft&&Nt()},itemContent:(Ft,Bt)=>Bt?jsxRuntimeExports.jsx(NotificationItem,{item:Bt},Bt.id):jsxRuntimeExports.jsx("div",{className:"h-px"})})})}function NotificationNewsPreviewModalContent(He){const{t:Qe}=useTranslation(["action"]),{item:it}=He;return jsxRuntimeExports.jsx("div",{className:"p-4 min-w-[320px] max-w-[650px]",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full",children:[jsxRuntimeExports.jsxs("header",{className:"mb-4 flex flex-col gap-3 pb-4 border-b border-card-border",children:[jsxRuntimeExports.jsx("h1",{className:"font-bold text-2xl",children:it.title}),it.id&&jsxRuntimeExports.jsxs("a",{href:`/news/${it.id}`,target:"_blank",className:"inline-flex items-center gap-1 whitespace-nowrap text-sm text-theme-primary",onClick:()=>track("news_open_new_window_click"),rel:"noreferrer",children:[jsxRuntimeExports.jsx(icBaselineOpenInNew,{className:"flex-none size-5"}),Qe("action:open-in-new-window")]})]}),jsxRuntimeExports.jsx(MarkdownRenderer,{as:"p",className:"prose dark:prose-invert p-2",children:it.content??""})]})})}function openNotificationNewsModal(He){return dialog({children:jsxRuntimeExports.jsx(NotificationNewsPreviewModalContent,{item:He}),maxWidth:"md",responsive:!1})}const DAY_MS=24*3600*1e3;function groupNotisByDate(He){const Qe={};let it=new Date;return He.forEach(lt=>{const ut=new Date(lt.createdAt);Math.abs(it.getTime()-ut.getTime())>DAY_MS&&(it=ut),Qe[it.toLocaleDateString()]=[...Qe[it.toLocaleDateString()]??[],lt]}),Object.entries(Qe).map(([lt,ut])=>({date:lt,notis:ut}))}function NotificationNewsContent(){const{data:He,loading:Qe}=useListNotifications({last:20,type:NotificationType.News}),{t:it}=useTranslation(["common"]),lt=reactExports.useMemo(()=>getNodesFromConnection(He).reverse(),[He]),ut=reactExports.useMemo(()=>groupNotisByDate(lt??[]),[lt]);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:ut.length<1?Qe?jsxRuntimeExports.jsx(CircularSpinner,{}):jsxRuntimeExports.jsx("p",{className:"w-full text-xl md:text-2xl text-slate-400 dark:text-slate-500 pb-4 text-center",children:it("common:news.empty-placeholder")}):jsxRuntimeExports.jsx(NewsDateTabs,{groups:ut})})}function NewsDateTabs(He){const{t:Qe}=useTranslation(["common"]),{groups:it}=He,[lt,ut]=reactExports.useState(0),dt=reactExports.useMemo(()=>it[lt],[lt]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"w-full flex items-center px-6",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-xs",children:dt.date}),jsxRuntimeExports.jsx("button",{disabled:lt===0,className:"ml-auto disabled:opacity-20 disabled:cursor-not-allowed",onClick:()=>ut(xt=>xt-1),children:jsxRuntimeExports.jsx(icBaselineChevronLeft,{})}),jsxRuntimeExports.jsx("button",{disabled:lt>=it.length-1,className:"disabled:opacity-20 disabled:cursor-not-allowed",onClick:()=>ut(xt=>xt+1),children:jsxRuntimeExports.jsx(icBaselineChevronRight,{})})]}),jsxRuntimeExports.jsx("div",{className:"h-px mx-6 mt-3 bg-slate-300"}),jsxRuntimeExports.jsx(NewsList,{items:dt.notis}),jsxRuntimeExports.jsx("div",{className:"py-4 flex justify-center",children:jsxRuntimeExports.jsxs("a",{href:"/news",target:"_blank",className:"inline-flex items-center gap-1 text-sm text-theme-primary",onClick:()=>track("see_all_news_click"),children:[Qe("common:news.buttons.see-all-news.label"),jsxRuntimeExports.jsx(icBaselineChevronRight,{className:"size-5"})]})})]})}function NewsList(He){return jsxRuntimeExports.jsx("div",{className:"max-h-[min(400px,calc(100vh-160px))] md:max-h-[min(800px,calc(100vh-160px))] overflow-y-auto flex flex-col gap-4 bg-[#9333EA]/[0.03] px-6 py-2",children:He.items.map(Qe=>jsxRuntimeExports.jsx(NewsItem,{item:Qe},Qe.id))})}function NewsItem(He){const{i18n:Qe}=useTranslation(),{item:it}=He,lt=reactExports.useMemo(()=>it.locales?.[Qe.language]?{id:it.id,...it.locales[Qe.language]}:it.title&&it.content?it:{content:"",title:""},[it.id]);return jsxRuntimeExports.jsxs("div",{className:"pl-4 relative cursor-pointer hover:dark:bg-gray-700 hover:bg-gray-100 transition rounded-sm max-w-full",role:"button",onClick:()=>{track("news_content_click"),openNotificationNewsModal(lt)},children:[jsxRuntimeExports.jsx("div",{className:"absolute h-[calc(100%-10px)] w-px top-2 left-0 bg-theme-primary"}),jsxRuntimeExports.jsx("div",{className:"rounded-full w-2 h-2 bg-theme-primary absolute top-2 left-0 -translate-x-1/2"}),jsxRuntimeExports.jsx("h3",{className:"font-bold mb-2",children:lt.title}),jsxRuntimeExports.jsx("p",{className:"text-neutral-500 dark:text-neutral-400 line-clamp-2",children:lt.content?.slice(0,200)})]})}const NotificationPanel=He=>{const{t:Qe}=useTranslation(["common"]),[it,lt]=reactExports.useState("likes"),[ut,dt]=reactExports.useState(0),xt=reactExports.useRef(null),ft=useNotificationTabs(),[vt,kt]=reactExports.useState(!0),[St,Tt]=useLocalStorage({key:"notification::dismissed-inbox-permission-prompt",defaultValue:!1}),Mt=isNotificationAvailable&&Notification.permission!=="granted",Nt=isServiceWorkerAvailable&&Mt&&vt&&!St,At=Ft=>{track("notification_tab_click",{tab:Ft}),lt(Ft),He.onTabChange?.()},[$t,Dt]=useLoadingCallback(async Ft=>{if(!(Ft.length<1))try{await executeMarkNotificationRead({types:Ft})}catch(Bt){toast.error(`${Qe("common:notification.maar.failed")}: ${Bt.message}`)}});return reactExports.useEffect(()=>{dt(xt.current?.clientWidth??0)},[it]),jsxRuntimeExports.jsxs("div",{className:"max-w-full p-2 w-min min-w-[340px]",ref:xt,style:{"--panel-width":`${ut}px`},children:[jsxRuntimeExports.jsxs("div",{className:"relative w-full flex items-center justify-center p-3",children:[jsxRuntimeExports.jsx("h1",{className:"font-bold",children:Qe("common:updates")}),jsxRuntimeExports.jsx(IconButton,{className:"absolute right-1",href:"/profile/edit/notification",onClick:()=>{track("setting_push_click")},children:jsxRuntimeExports.jsx(icBaselineSettings,{className:"size-[1em]"})})]}),jsxRuntimeExports.jsxs($5e8ad37a45e1c704$export$b2539bed5023c21c,{selectedKey:it,onSelectionChange:Ft=>At(Ft),orientation:"horizontal",children:[jsxRuntimeExports.jsx("div",{className:"w-full sm:w-max px-0 md:px-8 border-b border-background-light",children:jsxRuntimeExports.jsx(UITabList,{variant:"underlined",className:"w-full",children:ft.map(Ft=>jsxRuntimeExports.jsx(UITab,{variant:"underlined",color:"theme",className:"normal-case text-sm px-2 min-w-0 md:min-w-[90px] md:px-4 md:text-base",id:Ft.label,children:jsxRuntimeExports.jsxs("p",{className:"flex items-center justify-center",children:[Qe(`common:notification.type.${Ft.label}`),jsxRuntimeExports.jsx(BadgeWrapper,{types:Ft.types})]})},Ft.label))})}),ft.map(Ft=>jsxRuntimeExports.jsxs($5e8ad37a45e1c704$export$3d96ec278d3efce4,{id:Ft.label,className:"max-h-[min(400px,calc(100vh-160px))] md:max-h-[800px] overflow-y-auto w-full py-1 px-2",children:[Nt&&jsxRuntimeExports.jsx(Alert,{className:"flex-wrap",icon:jsxRuntimeExports.jsx(icBaselineNotifications,{className:"size-[1em]",style:{fontSize:"inherit"}}),severity:"info",action:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{className:"font-semibold",color:"inherit",size:"small",onClick:()=>{refreshPushToken(!0,"inbox_banner"),kt(!1)},children:Qe("common:notification.permission-banner.action")}),jsxRuntimeExports.jsx(IconButton,{color:"inherit",size:"small",onClick:()=>{track("notification_permission_dismiss_click",{scene:"inbox_banner"}),Tt(!0),kt(!1)},children:jsxRuntimeExports.jsx(icBaselineClose,{className:"size-[1em] text-lg"})})]}),children:Qe("common:notification.permission-banner.label")}),$$3(Ft).with({listType:"plain"},()=>jsxRuntimeExports.jsx(NotificationList,{id:Ft.id,types:Ft.types,onMarkRead:Dt})).when(Bt=>Bt.listType==="external"&&Bt.types[0]===NotificationType.News,()=>jsxRuntimeExports.jsx(NotificationNewsTabContent,{})).otherwise(()=>null)]},Ft.label))]})]})};function NotificationNewsTabContent(){const{updateLastRead:He}=useUnreadNotificationNews();return reactExports.useEffect(()=>{He()},[]),jsxRuntimeExports.jsx("div",{className:"w-[calc(var(--panel-width)-1.5rem)] pt-2",children:jsxRuntimeExports.jsx(NotificationNewsContent,{})})}const BadgeWrapper=He=>{const{types:Qe}=He,{unreadCounts:it}=reactExports.useContext(NotificationListContext),lt=it.filter(ut=>ut.type&&Qe.includes(ut.type)).reduce((ut,dt)=>ut+(dt.count??0),0);return Qe[0]===NotificationType.News?jsxRuntimeExports.jsx(NewsBadgeWrapper,{}):lt<1?null:jsxRuntimeExports.jsx("span",{className:"inline-flex bg-purple-600 text-white h-5 min-w-[20px] py-0.5 px-1.5 items-center justify-center rounded-full ml-[6px] text-xs",children:lt})},NewsBadgeWrapper=()=>{const{hasUnread:He}=useUnreadNotificationNews();return He?jsxRuntimeExports.jsx("span",{className:"bg-purple-600 size-[8px] rounded-full ml-[6px]"}):null},useUnreadNotifications=()=>{const{data:He=[],refetch:Qe}=useMyUnreadNotiCounts(),it=useAllNotificationTypesInTabs(),lt=He.filter(dt=>dt.type&&it.includes(dt.type)).reduce((dt,xt)=>dt+(xt.count??0),0);return{hasNewNotifications:lt>0,unreadCount:lt,notis:He,refetch:Qe}},buttonStyles=ce$1({slots:{button:"bg-background-secondary border border-solid border-black/50 dark:border-white/50",icon:"text-primary"},variants:{size:{normal:{button:"size-8",icon:"box-content size-5 p-1.5 -m-px"},large:{button:"size-10",icon:"box-content size-6 p-2 -m-px"}}},defaultVariants:{size:"normal"}}),NotificationButton=He=>{const[Qe,it]=reactExports.useState(),lt=reactExports.useId(),{hasNewNotifications:ut,unreadCount:dt,notis:xt,refetch:ft}=useUnreadNotifications(),{hasUnread:vt}=useUnreadNotificationNews(),{data:kt}=useUserInfo();if(!kt)return null;const St=buttonStyles({size:He.size});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(IconButton,{title:"open notification","aria-describedby":lt,className:St.button({size:He.size}),onClick:Tt=>{it(Tt.currentTarget),track("notification_open")},children:jsxRuntimeExports.jsx(Badge,{overlap:"circular",color:"error",variant:dt<1?"dot":void 0,invisible:!ut&&!vt,badgeContent:dt||"",showZero:!0,children:jsxRuntimeExports.jsx(icBaselineNotificationsNone,{className:St.icon()})})}),jsxRuntimeExports.jsx(NotificationListContext.Provider,{value:{open:!!Qe,unreadCounts:xt,closePanel:()=>it(void 0)},children:jsxRuntimeExports.jsx(Popover,{id:lt,anchorEl:Qe,open:!!Qe,disableRestoreFocus:!0,onClose:()=>{ft(),it(void 0)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},slotProps:{paper:{style:{borderRadius:"24px",border:"1px solid var(--card-border)"}}},children:jsxRuntimeExports.jsx(NotificationPanel,{onTabChange:()=>ft()})})})]})},NotificationListContext=reactExports.createContext({open:!1,unreadCounts:[],closePanel:()=>{}}),defaultStore$1=getDefaultStore(),membershipCommonOfferCode="commonOffer",membershipRecallOfferCode="recallOffer",DISCOUNT_VALID_BEFORE_KEY="growth:new-member-discount-valid-before",discountValidBeforeAtom=atomWithStorage(DISCOUNT_VALID_BEFORE_KEY,void 0);function useMembershipDiscountValidBefore(){return useAtom(discountValidBeforeAtom,{store:defaultStore$1})}function useSetMembershipDiscountValidBefore(){return useSetAtom(discountValidBeforeAtom,{store:defaultStore$1})}function getNewTargetTime(){return defaultDayjs().add(10,"minute").subtract(1,"seconds").valueOf()}function useMembershipDiscountValidCountdownUpdate(){const He=useSetMembershipDiscountValidBefore();return Qe=>He(it=>!it||Qe?.forceUpdate?getNewTargetTime():it-Date.now()>0?it:getNewTargetTime())}function getPricesForMonthlyPlans(He){const Qe=Object.entries(He).map(([it,lt])=>[it.replace(`-${Interval.Month}`,""),lt]);return Object.fromEntries(Qe)}function useMembershipMonthlyDiscountedPrices(He){const{data:Qe}=usePublicDynamicConfig(He?"constants":void 0);if(!He||!Qe)return;const lt=Qe?.[membershipCommonOfferCode]?.prices;if(lt)return getPricesForMonthlyPlans(lt)}function useUserIsEligibleForDiscount(){const{data:He}=useUserInfo(),{data:Qe,...it}=useGetAllPaymentItems(He?{}:skipToken),lt=Qe?.map(xt=>xt.prices).flat(),ut=lt?.some(xt=>xt?.promotionalCode===membershipCommonOfferCode),dt=lt?.some(xt=>xt?.promotionalCode===membershipRecallOfferCode);return{data:{commonAvailable:ut,recallAvailable:dt},...it}}function useDiscountBannerConditions(){const{data:{commonAvailable:He,recallAvailable:Qe}}=useUserIsEligibleForDiscount(),[it]=useMembershipDiscountValidBefore();if(He)return"common";if(Qe&&it&&it>Date.now())return"recall"}const membershipDiscountCommonStyles={"--accent-color":"#FDC729","--accent-color-dark":"#EEBB26","--accent-color-text":"#665200","--accent-color-text-dark":"#665200","--accent-color-highlight":"#662500","--accent-color-highlight-dark":"#F3BF27"};function getMembershipDiscountStylesByTier(He){const Qe=$$3(He).returnType().with(1,()=>({"--plan-bg-color":"#0000","--plan-bg-color-dark":"#0000"})).with(2,()=>({"--plan-bg-color":"#FFFAE7","--plan-bg-color-dark":"#FDC7293F"})).with(3,()=>({"--plan-bg-color":"#e2e8f0","--plan-bg-color-dark":"#374151"})).otherwise(()=>({"--plan-bg-color":"#FFF","--plan-bg-color-dark":"#000"}));return{...membershipDiscountCommonStyles,...Qe}}function getDiscountTypeForTracking(He){return $$3(He).with("common",()=>"new-user-2406").with("recall",()=>"recall-2406").otherwise(()=>{})}function Countdown(He){const Qe=reactExports.useMemo(()=>(He.utc?defaultDayjs.utc():defaultDayjs()).valueOf(),[He.utc]),it=reactExports.useMemo(()=>(He.utc?defaultDayjs.utc(He.targetDate):defaultDayjs(He.targetDate)).valueOf()-Qe,[He.targetDate,He.utc,Qe]),lt=useCountdownTimer(it);return He.children?He.children({timeLeft:lt}):renderDefaultCountdown({timeLeft:lt,format:He.format,className:He.className,style:He.style})}function renderDefaultCountdown(He){return jsxRuntimeExports.jsx("span",{className:He.className,style:He.style,children:defaultDayjs.duration(He.timeLeft,"ms").format(He.format||"D:HH:mm:ss")})}const mdiChevronRight=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M8.59 16.58L13.17 12L8.59 7.41L10 6l6 6l-6 6l-1.41-1.42Z"})}),riDiscountPercentFill=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M13.946 2.094a3 3 0 0 0-3.892 0L8.706 3.243a1 1 0 0 1-.569.236l-1.765.14A3 3 0 0 0 3.62 6.371l-.14 1.766a1 1 0 0 1-.237.569l-1.148 1.348a3 3 0 0 0 0 3.891l1.148 1.349a1 1 0 0 1 .236.569l.141 1.765a3 3 0 0 0 2.752 2.752l1.765.14a1 1 0 0 1 .57.237l1.347 1.148a3 3 0 0 0 3.892 0l1.348-1.148a1 1 0 0 1 .57-.236l1.765-.141a3 3 0 0 0 2.752-2.752l.14-1.765a1 1 0 0 1 .236-.57l1.149-1.347a3 3 0 0 0 0-3.892l-1.149-1.348a1 1 0 0 1-.236-.57l-.14-1.765a3 3 0 0 0-2.752-2.752l-1.766-.14a1 1 0 0 1-.569-.236zm.882 5.663l1.415 1.414l-7.071 7.072l-1.415-1.415zm-4.596 2.475a1.5 1.5 0 1 1-2.121-2.121a1.5 1.5 0 0 1 2.121 2.121m3.536 5.657a1.5 1.5 0 1 1 2.12-2.121a1.5 1.5 0 0 1-2.12 2.12"})}),membershipPlansStateStore=createStore$1(),membershipPlansStateAtom=atom({couponCode:"",claimedNewMemberDiscount:!1}),useMembershipPlansStatePageContextAtom=()=>useAtom(membershipPlansStateAtom,{store:membershipPlansStateStore}),MembershipPlansStateContextProvider=He=>jsxRuntimeExports.jsx(Provider,{store:membershipPlansStateStore,children:He.children});function MembershipCommonDiscountTopBanner(He){const{t:Qe}=useTranslation(["growth"]);return jsxRuntimeExports.jsx("div",{className:cx("bg-gradient-discount",He.className),style:He.style,children:jsxRuntimeExports.jsxs(Link,{to:"/membership/plans",className:"h-8 flex justify-center items-center hover:bg-black/10 no-underline text-white font-medium text-shadow shadow-black/50 transition",onClick:()=>{const it="common-discount-banner";track("enter_member_click",{location:it}),startEventGroup("member_source",it,{persistent:!0})},children:[jsxRuntimeExports.jsx(MembershipIcon,{className:"w-5 h-5 mr-2 -translate-y-px drop-shadow"}),jsxRuntimeExports.jsx("span",{children:Qe("growth:member-discount-event.banner.one-time.description")}),jsxRuntimeExports.jsx(mdiChevronRight,{className:"w-6 h-6 drop-shadow"})]})})}function MembershipRecallDiscountTopBanner(He){const{t:Qe}=useTranslation(["growth"]),[it]=useMembershipDiscountValidBefore(),lt=new Date().getTime(),ut=useCountdownTimer((it??lt)-lt);return jsxRuntimeExports.jsx("div",{className:cx("bg-gradient-to-r from-purple-600 via-fuchsia-400 to-rose-400",He.className),style:He.style,children:jsxRuntimeExports.jsxs(Link,{to:"/membership/plans",className:"h-8 flex justify-center items-center hover:bg-black/10 no-underline text-white font-medium text-shadow shadow-black/50 transition",onClick:()=>{const dt="recall-discount-banner";track("enter_member_click",{location:dt}),startEventGroup("member_source",dt,{persistent:!0})},children:[jsxRuntimeExports.jsx(MembershipIcon,{className:"w-5 h-5 mr-2 -translate-y-px drop-shadow"}),jsxRuntimeExports.jsx("span",{children:Qe("growth:member-discount-event.banner.payment-cancel.description",{time:defaultDayjs.duration(ut).format("HH:mm:ss")})}),jsxRuntimeExports.jsx(mdiChevronRight,{className:"w-6 h-6 drop-shadow"})]})})}function MembershipDiscountClaimDialogContent(He){const Qe=useNavigate(),{t:it}=useTranslation(["growth"]),lt=reactExports.useCallback(()=>{track("claim_recall_discount_click",{type:"plans-dialog"}),He.onClose(),Qe(withQuery("/membership/plans",{claimDiscount:1,startCountdown:1}))},[]);return jsxRuntimeExports.jsxs("div",{className:"bg-white flex flex-col gap-4 pb-4 items-center",children:[jsxRuntimeExports.jsx("p",{className:"w-full py-4 bg-gradient-featured flex justify-center text-white",children:it("growth:member-discount-event.claim-dialog.subtitle")}),jsxRuntimeExports.jsx("h1",{className:"font-bold text-black text-xl px-8",children:jsxRuntimeExports.jsx(Trans,{t:it,i18nKey:"growth:member-discount-event.claim-dialog.title",components:{discount:jsxRuntimeExports.jsx("span",{className:"bg-gradient-featured bg-clip-text text-transparent text-3xl"})},values:{amount:20}})}),jsxRuntimeExports.jsx("p",{className:"text-neutral-600 px-8 whitespace-pre-wrap text-center text-sm",children:it("growth:member-discount-event.claim-dialog.description",{amount:20})}),jsxRuntimeExports.jsx("button",{onClick:lt,className:"py-3 px-6 bg-theme-primary text-white rounded-full text-sm",children:it("growth:member-discount-event.claim-dialog.action-btn.label")})]})}function openMembershipDiscountClaimDialog(He){return new Promise((Qe,it)=>{const lt=dialog({children:jsxRuntimeExports.jsx(MembershipDiscountClaimDialogContent,{onClose:()=>{He?.onClose?.(),lt.current?.close()}}),onClose:()=>Qe(null),fullWidth:!1,responsive:!1,maxWidth:"lg",dialogProps:{maxWidth:"md"}})})}function CreditPackDiscountCountdownBannerForNewUser(He){const lt=useMembershipExtraPackages()?.map(ut=>ut.extraPackageBoosts).filter(Boolean)?.find(ut=>ut?.find(xt=>xt.category===ExtraPackageCampaignCategory.EventBased&&xt.type===ExtraPackageBoostType.Campaign&&xt.name==="NewUser")!=null)?.[0].endTime;return lt?jsxRuntimeExports.jsxs("section",{className:cx("flex flex-col items-center gap-2",He.className),children:[jsxRuntimeExports.jsxs("h2",{className:"flex flex-col md:flex-row items-center gap-3",children:[jsxRuntimeExports.jsx(riDiscountPercentFill,{className:"size-9 text-[--event-yellow]"}),jsxRuntimeExports.jsx("span",{className:"font-bold text-2xl",children:jsxRuntimeExports.jsx(Text,{i18nKey:"growth:credit-pack-discount-event.new-member-discount.title"})})]}),jsxRuntimeExports.jsxs("p",{className:"flex flex-col md:flex-row items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-lg text-dspurple-400 dark:text-purple-500",children:jsxRuntimeExports.jsx(Text,{i18nKey:"growth:credit-pack-discount-event.new-member-discount.countdown-text"})}),jsxRuntimeExports.jsx(Countdown,{targetDate:lt,utc:!0,children:({timeLeft:ut})=>jsxRuntimeExports.jsx("span",{className:cx("inline-grid grid-flow-col items-center px-1 tabular-nums text-white"),children:defaultDayjs.duration(ut).format("H:m:s").split(":").map(Number).map((dt,xt)=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:"text-dspurple-400 dark:text-purple-500 px-px",children:xt>0&&":"}),jsxRuntimeExports.jsx(NumberFlow,{className:"bg-dspurple-400 rounded px-0.5 py-px",value:dt,trend:-1,digits:xt===0?void 0:{1:{max:5}},format:xt===0?void 0:{minimumIntegerDigits:2}},xt)]}))})})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-neutral-400",children:jsxRuntimeExports.jsx(Text,{i18nKey:"growth:credit-pack-discount-event.new-member-discount.side-note"})})]}):null}function useMembershipPriceCurrencyExperiment(){return useExperimentParam("exp2503-purchase-usd-to-jpy")==="treatment"}const AUGUST_EVENT_MEMBERSHIP_DEFAULT_MONTHLY_FEATURE_FLAG_KEY="exp2509-august-event-membership-default-monthly";function useAugustEventMembershipDefaultMonthly(){return useExperimentParam(AUGUST_EVENT_MEMBERSHIP_DEFAULT_MONTHLY_FEATURE_FLAG_KEY)==="treatment"}const icBaselineArrowRightAlt=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M16.01 11H4v2h12.01v3L20 12l-3.99-4z"})}),sortBoostsPriority=He=>He?.map(Qe=>$$3(Qe.type).with(ExtraPackageBoostType.Campaign,()=>({...Qe,priority:0})).with(ExtraPackageBoostType.Tier,()=>({...Qe,priority:1})).with(ExtraPackageBoostType.Membership,()=>({...Qe,priority:2})).exhaustive()).sort((Qe,it)=>Qe.priority-it.priority),fluentPremium24Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17.999 3a.75.75 0 0 1 .605.306l.055.087l3.263 6.028l.038.093l.012.04l.02.102l.006.094a.8.8 0 0 1-.027.2l-.047.125l-.038.069a1 1 0 0 1-.075.102l.06-.078l-.025.035l-9.25 10.505a.7.7 0 0 1-.297.232l-.098.033l-.078.017L12 21l-.1-.006l-.118-.026a.7.7 0 0 1-.174-.076l-.009-.007a.7.7 0 0 1-.13-.104l-9.29-10.546l-.026-.032l-.04-.059a.75.75 0 0 1-.106-.301L2 9.75l.003-.066l.013-.089l.024-.086l.022-.059l.028-.057l3.25-6a.75.75 0 0 1 .557-.386L5.999 3zm-3.002 7.5H8.998l3 7.687zm-7.608 0h-2.98l5.351 6.074zm12.198 0h-2.979l-2.368 6.07zm-10.616-6H6.445L4.007 9h3.524zm4.48 0h-2.905L9.105 9h5.785zm4.1 0h-2.525l1.44 4.5h3.522z"})}),icBaselineAccessTime=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8s8 3.58 8 8s-3.58 8-8 8z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12.5 7H11v6l5.25 3.15l.75-1.23l-4.5-2.67z"})]}),iconoirBrightCrown=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M22 12h1M12 2V1m0 22v-1m8-2l-1-1m1-15l-1 1M4 20l1-1M4 4l1 1m-4 7h1m14.8 3.5l1.2-7l-4.2 2.1L12 8.5l-1.8 2.1L6 8.5l1.2 7z"})}),mdiCheckCircle=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10s10-4.5 10-10S17.5 2 12 2m-2 15l-5-5l1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9Z"})}),qlementineIconsStars16=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M8.8 8.44L9.497 11l.697-2.56c.175-.643.263-.965.435-1.23a2 2 0 0 1 .583-.583c.263-.172.585-.259 1.23-.435l2.56-.697l-2.56-.697c-.643-.175-.964-.263-1.23-.435a2 2 0 0 1-.583-.583c-.172-.263-.259-.585-.435-1.23L9.497-.01L8.8 2.55c-.175.643-.263.965-.435 1.23a2 2 0 0 1-.583.583c-.263.172-.585.259-1.23.435l-2.56.697l2.56.697c.643.175.965.263 1.23.435a2 2 0 0 1 .583.583c.172.263.259.585.435 1.23M2.68 13.7c.169.244.264.542.456 1.14l.362 1.12l.362-1.12c.191-.595.287-.893.456-1.14c.149-.216.34-.4.561-.543c.249-.161.55-.247 1.15-.418l.971-.277l-.971-.277c-.601-.172-.902-.258-1.15-.418a2 2 0 0 1-.561-.543c-.169-.244-.264-.542-.456-1.14l-.362-1.12l-.362 1.12c-.191.595-.287.893-.456 1.14c-.149.216-.34.4-.561.543c-.249.161-.55.247-1.15.418l-.971.277l.971.277c.601.172.902.258 1.15.418a2 2 0 0 1 .561.543"})}),riPriceTag3Fill=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m10.904 2.1l9.9 1.414l1.414 9.9l-9.192 9.192a1 1 0 0 1-1.415 0l-9.9-9.9a1 1 0 0 1 0-1.413zm2.829 8.486a2 2 0 1 0 2.828-2.829a2 2 0 0 0-2.828 2.829"})}),styles$9={"boosted-credits":"_boosted-credits_181cj_12"};function CreditPackCard({oneTimePurchase:He,monthlyPurchase:Qe,baseCredits:it,boostedCredits:lt,boosts:ut,onPurchase:dt,currency:xt,price:ft,showNumberFlow:vt,showSuccess:kt}){const St=it!==lt;return jsxRuntimeExports.jsxs("div",{className:cx("w-full min-w-28 xs:min-w-40 xs:max-w-48 md:min-w-60 md:w-60 h-52 flex flex-col relative bg-[var(--credit-card-background)] dark:bg-[var(--credit-card-background-dark)] rounded-2xl overflow-hidden ring-1 ring-transparent size-fit font-inter hover:shadow-lg transition cursor-pointer",ut.length>2?"md:h-60":"md:min-h-56 md:h-full"),onClick:dt,children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 rounded-2xl border border-[var(--credit-card-border)] dark:border-[var(--credit-card-border-dark)] pointer-events-none"}),He&&jsxRuntimeExports.jsx("div",{className:"flex-none m-1 mb-0 bg-theme-primary text-white py-1 text-center text-xs font-medium uppercase [text-shadow:0_0_4px_#fffa] h-6 rounded-xl",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:package.one-time.badge.label"})}),Qe&&jsxRuntimeExports.jsx("div",{className:"flex-none m-1 mb-0 bg-[--event-yellow] text-purple-600 py-1 text-center text-xs font-medium uppercase [text-shadow:0_0_4px_#fffa] h-6 rounded-xl",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:package.monthly-one-time.badge.label"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 pt-4 md:pt-6 pl-1 xs:pl-2 md:pl-4 pr-2 md:pr-6 flex flex-col justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 pl-2 relative",children:[jsxRuntimeExports.jsx(CreditsIcon,{className:"text-dspurple-500 size-4"}),jsxRuntimeExports.jsx("span",{className:cx("flex-1 text-sm font-medium",St&&"line-through"),children:new Intl.NumberFormat().format(it)}),St&&jsxRuntimeExports.jsx("div",{className:"absolute -top-1 -right-1 flex items-center",children:Array.from({length:ut.length}).map((Tt,Mt)=>jsxRuntimeExports.jsx("div",{className:"inline-block",style:{marginLeft:Mt>0?"-8px":"0",zIndex:ut.length-Mt},children:jsxRuntimeExports.jsx(qlementineIconsStars16,{className:"text-[var(--event-yellow)]"})},Mt))})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1 mb-1 md:mb-2",children:ut.length>0?ut.map(Tt=>jsxRuntimeExports.jsx(CreditBoostChip,{type:Tt.type,amount:Tt.percentage},Tt.type)):jsxRuntimeExports.jsx("div",{className:"h-6 md:h-8"})}),jsxRuntimeExports.jsx("div",{className:"flex items-end justify-between pl-2",children:jsxRuntimeExports.jsx("span",{className:cx("text-xl xs:text-2xl md:text-3xl mt-2 md:mt-0 font-bold mb-3","text-dspurple-400",!vt&&styles$9["boosted-credits"]),children:vt?jsxRuntimeExports.jsx(NumberFlow,{value:lt}):new Intl.NumberFormat().format(lt)})})]})]}),jsxRuntimeExports.jsx(UIButton$1,{className:cx("h-8 md:h-12 flex items-center z-10 justify-center text-xs md:text-lg font-bold transition-all duration-200 rounded-t-none",kt?"bg-green-700":"bg-dspurple-500 hover:bg-dspurple-500/90 dark:bg-dspurple-500 dark:hover:bg-dspurple-500"),labelClassName:"dark:text-white",variant:"filled",disabled:!dt,onPress:dt,children:kt?jsxRuntimeExports.jsx(mdiCheckCircle,{className:"size-5 inset-0 m-auto text-white animate-[scale-up_300ms_cubic-bezier(0.34,1.56,0.64,1)]"}):formatPrice(xt,ft)})]})}const CREDIT_BOOST_ICONS={[ExtraPackageBoostType.Tier]:riPriceTag3Fill,[ExtraPackageBoostType.Membership]:MembershipIcon,[ExtraPackageBoostType.Campaign]:icBaselineAccessTime};function CreditBoostChip({type:He,amount:Qe}){const it=CREDIT_BOOST_ICONS[He];return jsxRuntimeExports.jsxs("div",{className:cx("flex items-center h-6 md:h-8 rounded-[35.5px] md:rounded-[50px] py-1 gap-1 md:gap-1.5",Qe>0?"bg-[var(--event-yellow)]":"bg-[var(--boost-chip-no-bonus)]"),children:[jsxRuntimeExports.jsx("span",{className:"flex items-center justify-center rounded-full bg-white aspect-square h-full ml-1",children:jsxRuntimeExports.jsx(it,{className:cx("size-2.5 md:size-3.5",Qe===0?"text-[var(--on-boost-chip-no-bonus)]":"text-dspurple-500")})}),jsxRuntimeExports.jsxs("span",{className:cx("text-sm font-medium font-inter pr-3",Qe>0?"text-dspurple-500":"text-[var(--on-boost-chip-no-bonus)]"),children:["+",Qe,"%"]})]})}const TIERS=[{id:"free",tier:0,precentage:0},{id:"starter",tier:1,precentage:50},{id:"hobbyist",tier:2,precentage:100},{id:"pro",tier:3,precentage:150}];function MembershipBoostSwitcher({tier:He,onSelect:Qe,setMode:it}){const{t:lt}=useTranslation(["membership"]),{me:ut,beingMember:dt}=useMe();useMembershipActions(),useMembershipPlans().find(vt=>vt.tier===He);function ft(){if(!ut){openSignModal();return}return it("plans")}return jsxRuntimeExports.jsxs("section",{className:"flex flex-col items-center gap-1",children:[jsxRuntimeExports.jsx("p",{className:"text-dspurple-500 dark:text-dspurple-400 font-semibold text-sm",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:more-credits.boost.membership-upgrade.title"})}),jsxRuntimeExports.jsx("p",{className:"text-neutral-600 dark:text-neutral-400 mb-2 font-medium text-sm",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:more-credits.boost.membership-upgrade.subtitle"})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-center font-inter mb-4 gap-5 lg:gap-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-2.5 mx-12",children:[jsxRuntimeExports.jsx(iconoirBrightCrown,{className:cx("size-12",dt?"text-[--event-yellow]":"text-dspurple-500 dark:text-dspurple-400")}),jsxRuntimeExports.jsx("span",{className:"text-base font-medium",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:more-credits.boost.membership-benefit"})})]}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 md:gap-4 lg:gap-6 lg:mr-6",children:TIERS.map(vt=>jsxRuntimeExports.jsx(MembershipBoostSwitcherItem,{tier:vt.tier,active:He===vt.tier,percentage:vt.precentage,onClick:()=>Qe(vt.tier)},vt.id))}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-1",children:[jsxRuntimeExports.jsx(UIButton$1,{className:"w-full",icon:jsxRuntimeExports.jsx(fluentPremium24Regular,{}),color:"theme",variant:"filled",size:"large",onPress:ft,children:jsxRuntimeExports.jsx(Text,{i18nKey:He===0?"membership:more-credits.boost.upgrade.label":"membership:more-credits.boost.upgrade-to-tier.label",values:{tier:lt(`membership:membership.tier.${He}.label`)}})}),jsxRuntimeExports.jsx("span",{className:"text-xs text-zinc-700 dark:text-zinc-400 font-inter font-semibold",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:more-credits.boost.upgrade.hint"})})]})]})]})}function MembershipBoostSwitcherItem({active:He,percentage:Qe,tier:it,onClick:lt}){return jsxRuntimeExports.jsxs("button",{className:cx("flex flex-col items-center justify-center size-20 md:size-24 bg-neutral-100 dark:bg-neutral-700 rounded-xl",He&&"ring-2 ring-dspurple-500"),onClick:lt,children:[jsxRuntimeExports.jsxs("span",{className:cx("text-center justify-start text-lg md:text-xl font-medium mt-2 mb-3",Qe>0?He?"text-[#621D9E] dark:text-dspurple-400":"text-dspurple-500 dark:text-dspurple-400/75":"text-neutral-500 dark:text-neutral-400"),children:["+",Qe,"%"]}),jsxRuntimeExports.jsxs("span",{className:cx("flex items-center gap-1.5 text-xs md:text-sm font-medium",He?"text-dspurple-500 dark:text-dspurple-400":"text-stone-300"),children:[jsxRuntimeExports.jsx(MembershipIcon,{className:"size-3 md:size-4"}),jsxRuntimeExports.jsx(Text,{i18nKey:`membership:membership.tier.${it}.label`})]})]})}function MembershipCouponCodeBtn(He){const{data:Qe}=useUserInfo(),[{code:it},lt]=useQs(),{t:ut}=useTranslation(["membership","action"]),dt=useIsMobile(),[xt,ft]=reactExports.useState(!1),vt=reactExports.useRef(null),[kt,St]=reactExports.useState(0),[Tt,Mt]=useAsyncFn(async(At,$t)=>{try{track("coupon_code_submit",{code:At,...$t});const Ft=100-((await fetchGetCoupon({code:At})).data.coupon?.amount??0);St(Ft);const Bt=await fetchGetAllPaymentItems({couponCode:At});track("coupon_code_submit_success",{code:At,discount:Ft,...$t}),updateGetAllPaymentItems({couponCode:At},Bt.data),toast.success(ut("membership:membership.coupon.notice.code-applied")),He.setCouponCode(At),ft(!1)}catch(Dt){track("coupon_code_submit_failed",{code:At,...$t}),toast.error(ut("membership:membership.coupon.notice.code-verification-failed",{message:Dt.message}))}},[]);reactExports.useEffect(()=>{Qe?.id&&it&&(Mt(it,{scene:"from-url",...He.trackingArgs}),lt({code:null}))},[it,Qe?.id,He.trackingArgs]);const Nt=()=>{track("coupon_code_remove"),He.setCouponCode(""),St(0),toast.info(ut("membership:membership.coupon.notice.code-removed")),ft(!1)};return jsxRuntimeExports.jsxs("section",{className:He.className,children:[jsxRuntimeExports.jsx("button",{onClick:()=>{if(track("coupon_code_click",He.trackingArgs),!Qe?.id)return openSignModal();ft(!0)},className:He.btnClassName,children:He.couponCode?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[ut("membership:membership.coupon.code-using"),jsxRuntimeExports.jsx("span",{className:"pl-1 font-mono",children:He.couponCode}),kt>0&&jsxRuntimeExports.jsx("span",{className:"ml-1 rounded tabular-nums px-1 py-[2px] text-xs text-white bg-green-700 font-normal",children:`-${kt}%`})]}):ut("membership:membership.coupon.enter-coupon-code")}),jsxRuntimeExports.jsx(Dialog,{open:xt,onClose:()=>ft(!1),fullWidth:dt,children:jsxRuntimeExports.jsxs("form",{onSubmit:At=>{At.preventDefault(),Mt(vt.current.value,He.trackingArgs)},className:"flex flex-col p-4 md:min-w-[400px]",children:[jsxRuntimeExports.jsx(OutlinedInput,{inputRef:vt,defaultValue:He.couponCode,type:"text",placeholder:ut("membership:membership.coupon.dialog.input-placeholder"),spellCheck:!1,autoCapitalize:"off",autoCorrect:"off"}),jsxRuntimeExports.jsxs("div",{className:"p-2 flex flex-wrap-reverse gap-4 w-full",children:[He.couponCode&&jsxRuntimeExports.jsx(Button,{type:"reset",disabled:!He.couponCode,color:"warning",onClick:Nt,className:"w-full sm:w-auto",children:ut("membership:membership.coupon.dialog.remove.label")}),jsxRuntimeExports.jsx(Button,{className:"ml-auto w-full sm:w-auto",onClick:()=>{track("coupon_code_cancel",He.trackingArgs),ft(!1)},children:ut("action:cancel")}),jsxRuntimeExports.jsx(UIButton$1,{busy:Tt.loading,variant:"filled",color:"theme",type:"submit",className:"w-full sm:w-auto",children:ut("action:confirm")})]})]})})]})}function MembershipHeadingContent(He){const{t:Qe}=useTranslation(["membership"]);return jsxRuntimeExports.jsx("p",{className:He.className,children:jsxRuntimeExports.jsx(Trans,{t:Qe,i18nKey:"membership:plans-page.heading-content",components:{strong:jsxRuntimeExports.jsx("strong",{className:"font-medium"})}})})}function MembershipSwitchModeBtn(He){const{t:Qe}=useTranslation(["membership","growth"]);return jsxRuntimeExports.jsxs("button",{className:cx(He.className),onClick:He.onClick,children:[jsxRuntimeExports.jsx(icBaselineArrowRightAlt,{className:"size-4 shrink-0"}),jsxRuntimeExports.jsx("span",{children:He.mode==="plans"?Qe("membership:switch-to.credit-packs"):Qe("membership:switch-to.membership")})]})}function ExtraPackItem(He){const{extraPackage:Qe,showSuccess:it,onSubmit:lt,currentTier:ut,tier:dt}=He,[xt]=useCurrency();return jsxRuntimeExports.jsx(CreditPackCard,{oneTimePurchase:Qe.oneTimePurchase,monthlyPurchase:Qe.monthlyPurchase,currency:xt,price:Qe.prices[xt],baseCredits:Qe.values[0].value,boostedCredits:Qe.values[dt].creditsAfterBoosts,boosts:Qe.values[dt].boosts??[],showNumberFlow:ut===0,onPurchase:ut===dt?()=>lt(Qe.id):void 0,showSuccess:it})}function ExtraPackItems(He){const{data:Qe}=useUserInfo(),{data:{membership:it,subscription:lt}={}}=useMyMembership();reactExports.useEffect(()=>{it?.tier&&Nt(it.tier)},[it?.tier]);const ut=useMembershipExtraPackages(it?.tier),{purchaseExtraPackage:dt}=useMembershipActions();async function xt(Dt){if(!Qe)return openSignModal(void 0,{fromPath:"membership"});if(!ut||ft)return;const Ft=ut.find(Ot=>Ot.id===Dt);if(!Ft)return;track("refuel_purchase_click",{extraPackageId:Dt,...He.trackingArgs}),await dt(Dt,Ft.prices)&&At(Dt)}const[ft,vt]=reactExports.useState(null),{refetch:kt}=useListMyQuotaLogs({last:20}),{refetch:St}=useMyQuota(),{refetch:Tt}=useGetAllPaymentItems({}),[Mt,Nt]=reactExports.useState(getSubscriptionTier(lt));function At(Dt){vt(Dt),setTimeout(()=>{vt(null),He.afterSuccess?.(),St(),kt(),Tt()},2e3)}if(!ut)return null;const $t=groupBy$1(ut,Dt=>Dt.oneTimePurchase||Dt.monthlyPurchase?"special":"regular");return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("ul",{...He.packListStyleProps,children:[$t.special&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("li",{className:"col-span-full text-lg text-center font-medium uppercase tracking-wide",children:jsxRuntimeExports.jsx("span",{className:"inline-block bg-gradient-to-l from-purple-600 to-fuchsia-500 text-transparent bg-clip-text",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:extra-pack.groups.special.label"})})}),$t.special.sort((Dt,Ft)=>Dt.oneTimePurchase?-1:Dt.prices.USD-Ft.prices.USD).map(Dt=>jsxRuntimeExports.jsx(ExtraPackItem,{extraPackage:Dt,showSuccess:ft===Dt.id,onSubmit:xt,currentTier:it?.tier??0,tier:Mt,className:He.itemClassName,featuredClassName:He.featuredItemClassName},Dt.id)),jsxRuntimeExports.jsx("li",{className:"col-span-full text-lg text-center font-medium uppercase tracking-wide mt-4",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:extra-pack.groups.regular.label"})})]}),$t.regular.map(Dt=>{const Ft=sortBoostsPriority(Dt.values[Mt].boosts);return{...Dt,values:{...Dt.values,[Mt]:{...Dt.values[Mt],boosts:Ft}}}}).sort((Dt,Ft)=>Dt.prices.USD-Ft.prices.USD).map(Dt=>jsxRuntimeExports.jsx(ExtraPackItem,{extraPackage:Dt,showSuccess:ft===Dt.id,onSubmit:xt,currentTier:it?.tier??0,tier:Mt,className:He.itemClassName,featuredClassName:He.featuredItemClassName},Dt.id))]}),jsxRuntimeExports.jsx("div",{className:"w-full flex justify-center mt-4",children:jsxRuntimeExports.jsx(CreditBonusExplanationHelp,{className:"text-neutral-600 font-medium text-sm"})}),jsxRuntimeExports.jsx("div",{className:"mt-16"}),getSubscriptionTier(lt)===0&&jsxRuntimeExports.jsx(MembershipBoostSwitcher,{tier:Mt,onSelect:Nt,setMode:He.setMode})]})}function intlFormatNum(He){return new Intl.NumberFormat().format(He)}function CreditBonusExplanationHelp(He){const Qe=it=>jsxRuntimeExports.jsxs($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{onPress:it,className:cx("flex items-center gap-1",He.className),children:[jsxRuntimeExports.jsx(icOutlineHelpOutline,{className:cx("size-4")}),jsxRuntimeExports.jsx("span",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:more-credits.bonus-help.label"})})]});return jsxRuntimeExports.jsx(UITooltipResponsive,{trigger:Qe,variant:"normal",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("hgroup",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-neutral-400",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:more-credits.bonus-help.base-amount"})}),jsxRuntimeExports.jsxs("p",{children:[intlFormatNum(1e5),jsxRuntimeExports.jsxs("small",{className:"pl-1",children:["(",jsxRuntimeExports.jsx(Text,{i18nKey:"membership:more-credits.bonus-help.example"}),")"]})]})]}),jsxRuntimeExports.jsxs("table",{className:"mt-4 mb-1 [&_td:first-child]:text-neutral-500 [&_td:first-child]:pl-3 [&_td:first-child]:pr-12 [&_td:last-child]:text-right  [&_td:last-child]:pl-4 [&_td:last-child]:pr-3 [&_td:nth-child(2)]:text-right [&_td:nth-child(2)]:text-blue-500 [&_td]:py-1 [&_td]:px-1 w-full",children:[jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership.label"})}),jsxRuntimeExports.jsx("td",{children:"+100%"}),jsxRuntimeExports.jsx("td",{children:intlFormatNum(1e5)})]}),jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:more-credits.bonus-help.first-deposit"})}),jsxRuntimeExports.jsx("td",{children:"+100%"}),jsxRuntimeExports.jsx("td",{children:intlFormatNum(1e5)})]}),jsxRuntimeExports.jsxs("tr",{className:"[&>td]:pb-2",children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:more-credits.bonus-help.promo-bonus"})}),jsxRuntimeExports.jsx("td",{children:"+20%"}),jsxRuntimeExports.jsx("td",{children:intlFormatNum(2e4)})]}),jsxRuntimeExports.jsxs("tr",{className:"[&>td]:pt-2 border-t",children:[jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:more-credits.bonus-help.total-bonus"})}),jsxRuntimeExports.jsx("td",{className:"font-semibold",children:"+220%"}),jsxRuntimeExports.jsx("td",{className:"font-semibold",children:intlFormatNum(22e4)})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-sky-100 rounded-lg flex items-center justify-between px-3 py-1 mb-4",children:[jsxRuntimeExports.jsx("span",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:more-credits.bonus-help.final-amount"})}),jsxRuntimeExports.jsx("span",{className:"font-semibold text-blue-500",children:intlFormatNum(32e4)})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-neutral-400",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:more-credits.bonus-help.footnote"})})]})})}function getSubscriptionTier(He){return He?.status===UserSubscriptionStatus.active?He.tier??0:0}const icBaselineExpandMore=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17L7.41 8.59L6 10l6 6l6-6z"})}),motionLiProps={initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}};function ExpandedPrivilegeListItem(He){return jsxRuntimeExports.jsx(motion.li,{...motionLiProps,children:He.children})}const pendingSubscriptionStatus=[UserSubscriptionStatus.pending,UserSubscriptionStatus.inactive];function MembershipPlanCard(He){const[Qe]=useCurrency(),it=He.prices[He.interval][Qe],{data:lt}=useUserInfo(),{data:{membership:ut,subscription:dt}={},refetch:xt}=useMyMembership();reactExports.useEffect(()=>{xt()},[lt,xt]);const{isActive:ft,isManageableProvider:vt,isProviderOnlySupportsOneTimePurchase:kt,isDeprecatedProvider:St,isUpgradeDowngradeSupportedProvider:Tt,isUnknownProvider:Mt,hasFuturePlan:Nt}=useSubscriptionInfo(),{t:At}=useTranslation(["membership","action"]),$t=dt&&pendingSubscriptionStatus.includes(dt.status||"")&&!!dt?.invoice?.hostedInvoiceUrl,Dt=$t&&He.id===dt.planId&&He.interval===dt.interval,Ft=!!dt?.cancelAtPeriodEnd,Bt=!ut||!dt||He.interval===(dt.interval??Interval.Month),Ot={...$$3({tierDiff:(He.tier??Number.NaN)-(ut?.tier??Number.NaN),isCanceled:Ft,enableCancel:!!He.enableCancel,isPending:$t,isCurrentCardPending:Dt,hasFuturePlan:Nt,isFutureSubscription:dt?.futureSubscription?.[0]?.tier===He.tier}).returnType().with({isPending:!0,isCurrentCardPending:N$4.optional(N$4.boolean)},({isCurrentCardPending:xr})=>({name:"pending",label:At(xr?"membership:plan.action.pending.label":"membership:plan.action.subscribe.label"),type:"primary"})).with({tierDiff:0,enableCancel:!1},()=>({name:"current",label:At("membership:plan.state.subscribed.label"),type:"secondary"})).with({isFutureSubscription:!0},()=>({name:"current",label:At("membership:plan.state.next-plan.label",{date:defaultDayjs(dt?.endAt).add(1,"day").toDate().toLocaleDateString()}),type:"secondary"})).with({tierDiff:0,isCanceled:!1},()=>({name:"cancel",label:At("membership:plan.action.cancel.label"),type:"danger"})).with({tierDiff:0,isCanceled:!0},()=>({name:"resubscribe",label:At("membership:plan.action.resubscribe.label"),type:"primary"})).with({tierDiff:N$4.number.positive()},()=>({name:"upgrade",label:At("membership:plan.action.upgrade.label"),type:"primary"})).with({tierDiff:N$4.number.negative()},()=>({name:"downgrade",label:At("membership:plan.action.downgrade.label"),type:"secondary"})).otherwise(()=>({name:"subscribe",label:At("membership:plan.action.subscribe.label"),type:"primary"})),...$$3({tierDiff:(He.tier??Number.NaN)-(ut?.tier??Number.NaN),isCanceled:Ft}).returnType().when(()=>Mt,()=>({disabled:!0,reason:At("membership:plan.state.disabled-by-payment-provider.label")})).when(()=>!Bt,()=>({disabled:!0,reason:At("membership:plan.state.disabled-by-interval.label")})).when(()=>ft&&He.interval===Interval.Year,()=>({disabled:!0,reason:At("membership:plan.state.diabled-monthly-repurchase.label")})).when(({tierDiff:xr})=>ft&&!Tt&&xr!==0,()=>({disabled:!0,reason:At("membership:plan.state.payment-provider-not-support-updowngrade.label")})).when(()=>$t&&!Dt,()=>({disabled:!0,reason:At("membership:plan.state.another-pending.label")})).when(()=>Nt,()=>({disabled:!0,reason:At("membership:plan.state.disabled-by-attended-event.label")})).when(()=>He.tier<(ut?.tier??Number.NaN)&&He.interval===dt?.interval,()=>({disabled:!0,reason:At("membership:plan.state.downgrade-is-disabled.label")})).otherwise(()=>({}))},{subscribe:Qt,unsubscribe:Wt}=useMembershipActions(),Xt=useNavigate();async function Kt(){if(!lt){openSignModal();return}function xr(gr){return Qt({isActive:ft,planId:He.id,oneTimeMembership:He.oneTimeMembership,tier:He.tier,prices:(()=>{const br=He.prices[He.interval];return Object.entries(br).reduce((vr,[yr,Cr])=>({...vr,[yr]:He.interval===Interval.Month?Cr.perMonth:Cr.perYear}),{})})(),interval:He.interval,isNewSubscribe:gr?.isNewSubscribe,trackingOpts:{upgradeFromTier:ut?.tier,discountType:He.trackingArgs?.discountType},couponCode:He.couponCode,shouldDiscount:He.shouldDiscount,afterCancelSurvey:He.afterCancelSurvey,extraParamsForSubscribeRedirection:He.extraParamsForSubscribeRedirection})}switch(Ot.name){case"cancel":track("plan_cancel_click",He.trackingArgs),await Wt();return;case"current":track("your_plan_click",He.trackingArgs),Xt("/me/credits");return;case"extend":(kt||St)&&await xr();return;case"pending":{const gr=dt?.invoice?.hostedInvoiceUrl;gr&&window.open(gr,"_blank");return}case"upgrade":track("upgrade_member_click",He.trackingArgs),await xr();return;case"resubscribe":track("plan_resubscribe_click",He.trackingArgs),await xr();return;case"downgrade":track("downgrade_member_click",He.trackingArgs),await xr();return;default:await xr({isNewSubscribe:!0});return}}const Jt=getMembershipTierConfig(He.tier),hr="relative text-transparent bg-clip-text bg-gradient-purple-pink !pr-8 mlg:!pr-9";return jsxRuntimeExports.jsxs("section",{className:cx("flex flex-col bg-white dark:bg-background rounded-2xl ring-1 ring-black/10 dark:ring-black/20 shadow-lg dark:shadow-black/20 divide-y divide-black/10 dark:divide-white/10 relative",He.featured&&"mmd:-mt-8",He.className),style:{"--plan-bg-color":Jt.color,"--plan-bg-color-dark":Jt.darkColor,"--accent-color":"#9333ea","--accent-color-dark":"#a855f7","--accent-color-text":"#FFF","--accent-color-text-dark":"#FFF","--accent-hover-color":"#9333ea0A","--accent-color-highlight":"#9333ea","--accent-color-highlight-dark":"#a855f7",...He.style},children:[He.featured&&jsxRuntimeExports.jsx("div",{className:"h-8 flex justify-center items-center text-xs uppercase tracking-wider font-medium bg-[--accent-color] text-[--accent-color-text] rounded-t-2xl",children:At("membership:membership.featured-badge.label")}),jsxRuntimeExports.jsx(MembershipPriceAndLabel,{label:Jt.label,currency:Qe,prices:it,interval:He.interval,tier:He.tier,featured:He.featured,discountComponent:He.discountComponent}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col bg-white dark:bg-white/5 rounded-b-2xl",children:[jsxRuntimeExports.jsxs("ul",{className:"flex-1 text-sm grid auto-rows-[minmax(3em,1fr)] border-b border-black/10 dark:border-white/5 divide-y divide-black/10 dark:divide-white/5 [&_li]:px-4 mlg:[&_li]:px-8 [&_li]:py-1 [&_li]:flex [&_li]:flex-col [&_li]:justify-center",children:[jsxRuntimeExports.jsxs("li",{className:hr,children:[jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership.privilege.video-generation"}),jsxRuntimeExports.jsx(MembershipNewFeatureBadge,{})]}),He.privileges.professionalMode&&jsxRuntimeExports.jsxs("li",{className:hr,children:[At("membership:membership.privilege.professional-mode"),jsxRuntimeExports.jsx(MembershipNewFeatureBadge,{})]}),jsxRuntimeExports.jsxs("li",{className:hr,children:[At("membership:membership.privilege.turbo-mode"),jsxRuntimeExports.jsx(MembershipNewFeatureBadge,{})]}),jsxRuntimeExports.jsx("li",{children:At("membership:membership.privilege.early-access-model-free-try")}),jsxRuntimeExports.jsx("li",{children:At("membership:membership.privilege.extra-lora-training",{amount:He.privileges.freeUserLora??"…"})}),jsxRuntimeExports.jsx("li",{children:At("membership:membership.privilege.extra-lora-usage",{amount:He.privileges.lora??"…"})}),jsxRuntimeExports.jsx("li",{children:At("membership:membership.privilege.cheaper-topup")}),jsxRuntimeExports.jsx("li",{children:At("membership:membership.privilege.more-credits-to-claim",{amount:`${(Number(He.privileges.dailyClaimAdded)||1e4)/100}%`})}),jsxRuntimeExports.jsx("li",{children:At("membership:membership.privilege.credits-per-month",{amount:He.privileges?.paidCredit?.toLocaleString()})}),jsxRuntimeExports.jsx(AnimatePresence,{mode:"wait",children:He.expanded&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ExpandedPrivilegeListItem,{children:At("membership:membership.privilege.private-models",{amount:He.privileges.privateModel??"…"})}),jsxRuntimeExports.jsx(ExpandedPrivilegeListItem,{children:At("membership:membership.privilege.membership-badge")}),jsxRuntimeExports.jsx(ExpandedPrivilegeListItem,{children:At("membership:membership.privilege.profile-banner-and-gif-avatar")}),jsxRuntimeExports.jsx(ExpandedPrivilegeListItem,{children:At("membership:membership.privilege.larger-image-dimensions")}),jsxRuntimeExports.jsx(ExpandedPrivilegeListItem,{children:At("membership:membership.privilege.custom-model-list")}),jsxRuntimeExports.jsx(ExpandedPrivilegeListItem,{children:At("membership:membership.privilege.custom-quality-tags")}),jsxRuntimeExports.jsx(ExpandedPrivilegeListItem,{children:At("membership:membership.privilege.more-coming-soon")})]})})]}),!He.expanded&&jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",className:"flex items-center justify-center w-full rounded-none focus:outline-none border-b border-black/10 dark:border-white/5",onPress:()=>{He.setExpanded?.(xr=>!xr)},children:jsxRuntimeExports.jsx(icBaselineExpandMore,{className:"size-6"})}),jsxRuntimeExports.jsx("div",{className:"flex-1 pt-4 pb-2 flex flex-col justify-end text-center",children:Ot.reason&&jsxRuntimeExports.jsx("p",{className:"px-4 mlg:px-8 text-sm font-medium text-balance text-black dark:text-white",children:Ot.reason})}),jsxRuntimeExports.jsx("div",{className:"flex bg-white dark:bg-zinc-700 sticky bottom-0 w-full rounded-b-2xl",children:jsxRuntimeExports.jsx(UIButton$1,{disabled:Ot.disabled,busy:"auto",className:cx("w-full m-3 px-8 py-4 leading-none grid place-content-center font-medium rounded-lg disabled:opacity-50 disabled:pointer-events-none disabled:cursor-not-allowed disabled:font-normal transition",{primary:"bg-[--accent-color] hover:bg-[--accent-color-dark] dark:hover:bg-[--accent-color-dark] text-[--accent-color-text]",secondary:"hover:bg-[--accent-hover-color] ring-1 ring-inset ring-[--accent-color] text-[--accent-color] dark:text-[--accent-color-dark]",danger:"bg-red-500 hover:bg-red-600 text-white dark:text-white"}[Ot.type]),variant:"ghost",color:Ot.type==="danger"?"danger":void 0,onPress:()=>(track("join_member_click",He.trackingArgs),Kt()),children:jsxRuntimeExports.jsx("span",{className:cx("capitalize",Ot.serviceLabel&&"-mt-2"),children:Ot.label})})})]})]})}function MembershipNewFeatureBadge(){return jsxRuntimeExports.jsx("p",{className:"absolute right-0 top-0 rounded-bl-lg pl-2 pr-1 py-[2px] leading-none text-white bg-gradient-purple-pink text-[10px]",children:"New"})}function MembershipPriceAndLabel(He){const{t:Qe}=useTranslation(["membership"]),it=He.currency||Currency.Usd,ut=useCurrencyDetails(it)?.symbol||it,{perMonth:dt=0,perWeek:xt=0,perYear:ft=0,perMonthOriginal:vt=0,perYearOriginal:kt=0}=He.prices,St=!!(vt&&dt!==vt),Tt=St?Math.ceil(dt/vt*100):void 0,Mt=getPriceNumber(He.interval,dt,ft),Nt=getPriceNumber(He.interval,vt,kt),At=Qe("membership:membership.price-tag.per-month");Qe("membership:membership.price-tag.per-week");const $t=()=>He.interval===Interval.Month?Qe("membership:membership.price-tag.charged-monthly"):jsxRuntimeExports.jsxs("span",{className:"flex gap-1",children:[jsxRuntimeExports.jsxs("span",{children:[ut,ft]}),jsxRuntimeExports.jsx("span",{children:Qe("membership:membership.price-tag.charged-annually")})]}),Dt=()=>{if(He.interval===Interval.Month)return Qe("membership:membership.price-tag.monthly-notice",{price:`${ut}${Nt}`})};return jsxRuntimeExports.jsxs(motion.div,{className:cx("p-4 mlg:pl-8 text-black dark:text-white dark:bg-zinc-800","[--from:transparent] [--to:var(--plan-bg-color)]","dark:[--from:var(--plan-bg-color-dark)] dark:[--to:transparent]",!He.featured&&"rounded-t-2xl"),style:{background:"radial-gradient(100% 100% at 0% 0%, var(--from) 30%, var(--to))"},layout:!0,children:[jsxRuntimeExports.jsxs("p",{className:"-mb-1 flex items-center text-lg font-light uppercase tracking-wider",children:[jsxRuntimeExports.jsx(Text,{i18nKey:He.label}),Tt&&jsxRuntimeExports.jsx("span",{className:"ml-2 inline-flex items-center h-0",children:jsxRuntimeExports.jsx("span",{className:cx("relative ml-0 px-1.5 text-sm tabular-nums text-white rounded-full tracking-tight","bg-green-700"),children:He.discountComponent?.({discount:100-Tt})??`${Tt-100}%`})})]}),jsxRuntimeExports.jsxs("p",{className:"my-3 grid grid-cols-[auto_1fr] items-center gap-x-2 gap-y-0.5",children:[jsxRuntimeExports.jsxs("span",{className:"row-span-2 col-start-1 flex items-center text-4xl font-medium whitespace-nowrap",children:[St&&jsxRuntimeExports.jsxs("span",{className:"mr-2 text-3xl font-light text-black line-through dark:text-white opacity-50 decoration-2",children:[ut,Nt]}),ut,jsxRuntimeExports.jsx(TweenNumber,{number:Number(Mt.toFixed(2))}),jsxRuntimeExports.jsx("span",{className:"ml-2 flex items-center text-lg translate-y-1 leading-none whitespace-nowrap",children:At})]}),jsxRuntimeExports.jsxs("span",{className:"row-start-3 col-start-1 self-end text-sm leading-none text-neutral-600 dark:text-neutral-400",children:[jsxRuntimeExports.jsx("span",{children:$t()}),jsxRuntimeExports.jsx("span",{className:"ml-2 text-xs text-neutral-600/50",children:Dt()})]})]})]})}const getPriceNumber=(He,Qe,it)=>He===Interval.Month?Qe:it/12;function TweenNumber(He){const[Qe,it]=reactExports.useState(He.number),[lt,ut]=reactExports.useState(He.number);return useDebounce(()=>{He.number!==lt&&(it(lt),ut(He.number))},50,[He.number,lt]),jsxRuntimeExports.jsx("span",{className:"inline-grid grid-rows-1 grid-cols-1",children:jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,children:jsxRuntimeExports.jsx(motion.span,{className:"row-start-1 col-start-1",initial:{transform:`translateY(${lt>=Qe?"100%":"-100%"})`,opacity:0},animate:{transform:"translateY(0)",opacity:1},exit:{transform:`translateY(${lt>=Qe?"100%":"-100%"})`,opacity:0,position:"absolute"},children:Intl.NumberFormat().format(lt)},lt)})})}function MembershipPlansIntervalSwitch(He){const{billingInterval:Qe,setBillingInterval:it,className:lt,saleLabelOnTopIfMsm:ut,trackingArgs:dt,hideSaleLabel:xt}=He,{t:ft}=useTranslation(["membership","growth"]),vt={intervalTabContainer:"mmd:w-screen max-w-[365px] p-0.5 flex bg-white dark:bg-black/50 ring-1 dark:ring-0 ring-black/5 rounded-lg shadow-md",intervalTabItem:"flex-1 mlg:w-[180px] h-8 mmd:h-9 px-4 msm:px-8 flex justify-center items-center max-mmd:text-sm font-medium relative data-[state=active]:bg-purple-700 dark:data-[state=active]:bg-purple-200 data-[state=active]:text-white dark:data-[state=active]:text-black rounded-md",intervalLabel:"whitespace-nowrap font-medium text-neutral-700 dark:text-neutral-300 data-[active]:text-purple-700 dark:data-[active]:text-purple-500"},kt=Interval.Month,St=Interval.Year,{ongoing:Tt}=useGrowthEvent(GrowthEventName.AugustEvent2025);return jsxRuntimeExports.jsxs("div",{className:cx("flex justify-center items-center gap-3 pb-4",lt),children:[jsxRuntimeExports.jsx("span",{className:"flex justify-end w-0",children:jsxRuntimeExports.jsxs("button",{"data-active":Qe===Interval.Year?"":null,className:cx(vt.intervalLabel,"relative flex items-center gap-2"),onClick:()=>{track("member_plan_tab_click",{tab:Interval.Year,...dt}),it(Interval.Year)},children:[jsxRuntimeExports.jsxs("span",{className:cx("left-1/2 bottom-full px-2.5 py-0.5 text-sm font-normal whitespace-nowrap rounded-full transition",Qe===Interval.Year?"text-white bg-purple-700 dark:bg-purple-600":"bg-black/10 dark:bg-black/50",ut&&"max-msm:absolute max-msm:-translate-x-1/2 max-msm:-translate-y-2",xt&&"hidden"),children:[ft("membership:plans-page.plan-tab-promo-label"),jsxRuntimeExports.jsx("i",{className:cx("absolute top-full left-1/2 -translate-x-2 block border-8 border-b-0 border-transparent transition",Qe===Interval.Year?"border-t-purple-700 dark:border-t-purple-600":"border-t-black/10 dark:border-t-black/50",ut?"msm:hidden":"hidden")})]}),ft("membership:payment.annually")]})}),jsxRuntimeExports.jsx($8e59e948500a8fe1$export$b5d5cf8927ab7262,{isSelected:Qe===kt,onChange:Mt=>{track("member_plan_tab_click",{tab:Mt?kt:St,...dt}),it(Mt?kt:St)},className:"group flex w-14 h-8 p-0.5 ring-1 ring-purple-500 rounded-full shadow shadow-purple-500/50",children:jsxRuntimeExports.jsx("span",{className:"block h-full aspect-square bg-purple-600 dark:bg-purple-500 ring-1 ring-black/10 rounded-full shadow-md group-selected:translate-x-6 transition ease-in-out"})}),jsxRuntimeExports.jsx("span",{className:"flex justify-start w-0",children:jsxRuntimeExports.jsxs("button",{"data-active":Qe===Interval.Month?"":null,className:cx(vt.intervalLabel,"relative flex items-center gap-2"),onClick:()=>{track("member_plan_tab_click",{tab:Interval.Month,...dt}),it(Interval.Month)},children:[ft("membership:payment.monthly"),Tt&&jsxRuntimeExports.jsxs("span",{className:cx("left-1/2 bottom-full px-2.5 py-0.5 text-sm font-normal whitespace-nowrap rounded-full transition",Qe===Interval.Month?"text-white bg-purple-700 dark:bg-purple-600":"bg-black/10 dark:bg-black/50",ut&&"max-msm:absolute max-msm:-translate-x-1/2 max-msm:-translate-y-2",xt&&"hidden"),children:[ft("membership:plans-page.plan-tab-promo-label-monthly"),jsxRuntimeExports.jsx("i",{className:cx("absolute top-full left-1/2 -translate-x-2 block border-8 border-b-0 border-transparent transition",Qe===Interval.Month?"border-t-purple-700 dark:border-t-purple-600":"border-t-black/10 dark:border-t-black/50",ut?"msm:hidden":"hidden")})]})]})})]})}async function openProceedMembershipModal(He){await UIDialog.confirm(He.confirmationDialogProps)&&openMembershipMoreCreditsModal(He.membershipModalProps)}function openMembershipMoreCreditsModal(He){return track(He?.defaultMode==="packs"?"more_credit_click":"enter_member_click",{location:He?.trackingLocation,scene:He?.scene,displayType:"dialog"}),startEventGroup("member_source",He?.trackingLocation,{persistent:!0}),UIDialog.create({dismissable:!0,children:({close:Qe})=>jsxRuntimeExports.jsx(MembershipMoreCreditsModalContent,{...He,onClose:Qe}),type:getIsMobile()?"drawer":"dialog",className:"w-screen max-w-none mmd:w-[calc(100vw-64px)] mmd:max-w-screen-mlg"})}function MembershipMoreCreditsModalContent({reason:He,onClose:Qe,scene:it,afterPurchaseSuccess:lt,extraParamsForSubscribeRedirection:ut,defaultMode:dt}){return jsxRuntimeExports.jsx(MembershipMoreCreditsDialogContent,{reason:He,onClose:()=>{Qe?.()},scene:it,defaultMode:dt,afterPurchaseSuccess:lt,extraParamsForSubscribeRedirection:ut})}const trackingArgs={displayType:"dialog"};function MembershipMoreCreditsDialogContent(He){const[Qe,it]=reactExports.useState(He.defaultMode??"plans"),[lt,ut]=reactExports.useState(!1),dt=jsxRuntimeExports.jsx(MembershipSwitchModeBtn,{onClick:()=>{track(Qe==="plans"?"switch_membership_click":"switch_credit_packs_click",trackingArgs),it(xt=>xt==="plans"?"packs":"plans")},mode:Qe,className:"mr-4 flex items-center gap-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-500 py-1 px-1 relative"});return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs(UIDialogContent,{className:"",children:[He.reason&&jsxRuntimeExports.jsx("p",{className:"px-4 py-2 mb-4 md:mr-4 bg-amber-100 dark:bg-amber-500/20 text-amber-800 dark:text-amber-400 rounded",children:He.reason}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[Qe==="plans"&&jsxRuntimeExports.jsx(PlansPanel,{onClose:He.onClose,scene:He.scene,switchBtn:dt,extraParamsForSubscribeRedirection:He.extraParamsForSubscribeRedirection,expanded:lt,setExpanded:ut}),Qe==="packs"&&jsxRuntimeExports.jsx(ExtraPackagesPanel,{switchBtn:dt,afterPurchaseSuccess:()=>{He.onClose?.(),He.afterPurchaseSuccess?.()},setMode:it})]})]})})}function ExtraPackagesPanel(He){const{t:Qe}=useTranslation(["membership"]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap justify-between",children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold",children:Qe("membership:more-credits.dialog.title")}),He.switchBtn]}),jsxRuntimeExports.jsx(CreditPackDiscountCountdownBannerForNewUser,{}),jsxRuntimeExports.jsx("div",{className:"flex flex-col",children:jsxRuntimeExports.jsx(ExtraPackItems,{afterSuccess:He.afterPurchaseSuccess,itemClassName:"mmd:w-[288px]",featuredItemClassName:"text-white bg-gradient-featured mmd:w-[288px]",trackingArgs,packListStyleProps:{className:"mx-auto w-fit grid grid-cols-1 xs:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 md:gap-4 justify-items-center"},setMode:He.setMode})})]})}function PlansPanel(He){const{t:Qe}=useTranslation(["membership"]),[it,lt]=reactExports.useState(""),[ut,dt]=reactExports.useState(Interval.Year),{data:{recallAvailable:xt,commonAvailable:ft}}=useUserIsEligibleForDiscount(),vt=useMembershipMonthlyDiscountedPrices(ft?"common":void 0),kt=useMembershipPlans({discountedMonthlyPrices:vt});return useMembershipPriceCurrencyExperiment(),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap justify-between",children:[jsxRuntimeExports.jsx("h1",{className:"font-rhodium text-4xl",children:Qe("membership:membership.label_long")}),He.switchBtn]}),jsxRuntimeExports.jsx("div",{className:"flex max-mmd:flex-col mmd:items-start gap-4",children:jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx(MembershipHeadingContent,{className:"text-sm font-light mt-1"}),jsxRuntimeExports.jsx(MembershipCouponCodeBtn,{couponCode:it,setCouponCode:lt,btnClassName:"hover:underline font-semibold text-theme-primary text-sm",trackingArgs})]})})]}),jsxRuntimeExports.jsxs("section",{className:"flex flex-col gap-8",children:[jsxRuntimeExports.jsx(MembershipPlansIntervalSwitch,{billingInterval:ut,setBillingInterval:dt,className:"mr-auto [&>span]:w-auto",trackingArgs,hideSaleLabel:ft}),jsxRuntimeExports.jsx("div",{className:"flex max-mmd:flex-col gap-4 justify-center",children:kt.map((St,Tt)=>jsxRuntimeExports.jsx(MembershipPlanCard,{...St,interval:ut,featured:Tt===2,className:"flex-1",style:ft?getMembershipDiscountStylesByTier(St.tier):void 0,trackingArgs:{...trackingArgs,discountType:getDiscountTypeForTracking(ft?"common":void 0)},extraParamsForSubscribeRedirection:He.extraParamsForSubscribeRedirection,afterCancelSurvey:xt?()=>(track("membership_discount_popup",{type:"plans-dialog"}),openMembershipDiscountClaimDialog({onClose:He.onClose})):void 0,shouldDiscount:vt!=null,discountComponent:ft&&ut===Interval.Month?Mt=>jsxRuntimeExports.jsx("span",{className:"text-xs",children:Qe("growth:member-discount-event.common-discount.sale-label",{discount:Mt.discount})}):void 0,setExpanded:He.setExpanded,expanded:He.expanded},St.id))})]})]})}const mdiPlus=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2Z"})}),classes={"purple-pink":{wrapper:cx("ring-violet-600 hover:ring-violet-700 bg-background-secondary pl-1 py-[2px] rounded-lg p-[2px]"),meter:cx("[&>span>svg>path]:fill-[url(#member-purple-pink-gradient)]")},monochrome:{wrapper:cx("ring-neutral-300 hover:ring-neutral-600 rounded p-px"),meter:cx("hover:bg-black/10 dark:hover:bg-white/10")}};function MyCredits({className:He,style:Qe,onClick:it,variant:lt="monochrome",...ut}){const{t:dt}=useTranslation(["membership"]),{data:xt}=useUserInfo(),{data:ft,loading:vt}=useMyQuota(),kt=!xt;return jsxRuntimeExports.jsxs("span",{className:cx("inline-flex gap-px hover:ring-1 group",classes[lt].wrapper,He),style:Qe,children:[jsxRuntimeExports.jsx(CreditMeter,{as:Link,to:xt?`/@${xt.username}/credits`:"",target:"_blank",value:ft,updating:vt,className:cx("flex-none h-6 px-1 flex items-center no-underline  rounded-[3px] transition",classes[lt].meter,kt&&"pointer-events-none"),...ut,onClick:(...St)=>{track("credit_balance_click"),it?.(...St)}}),!kt&&lt==="monochrome"&&jsxRuntimeExports.jsx("button",{className:"flex-none w-6 h-6 -ml-1 flex justify-center items-center hover:bg-theme-primary text-neutral-500 dark:text-neutral-400 hover:!text-white rounded-[3px] transition",onClick:()=>{openMembershipMoreCreditsModal({scene:"gen-plan",trackingLocation:"gen-plan",defaultMode:"packs"})},children:jsxRuntimeExports.jsx(mdiPlus,{className:"w-5 h-5"})}),!kt&&lt==="purple-pink"&&jsxRuntimeExports.jsxs("button",{className:"flex justify-center items-center bg-gradient-purple-pink text-white text-xs font-medium px-1 mlg:px-3 rounded-md transition",onClick:()=>{openMembershipMoreCreditsModal({scene:"gen-plan",trackingLocation:"gen-plan",defaultMode:"packs"})},children:[jsxRuntimeExports.jsx("span",{className:"hidden mlg:inline",children:dt("membership:membership.top-up.label")}),jsxRuntimeExports.jsx(mdiPlus,{className:"size-4 inline mlg:hidden"})]})]})}const fluentChevronCircleLeft24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2s10 4.477 10 10m-7.97-4.53a.75.75 0 0 0-1.06 0l-4 4a.75.75 0 0 0 0 1.06l4 4a.75.75 0 1 0 1.06-1.06L10.56 12l3.47-3.47a.75.75 0 0 0 0-1.06"})});function AppFooter({className:He,style:Qe}){const{t:it}=useTranslation(["common"]);return jsxRuntimeExports.jsxs("div",{className:cx("relative flex items-start gap-4 msm:gap-10 px-4 msm:px-6 py-8 text-sm text-primary-light bg-background border-t border-black/10 dark:border-white/10","max-mmd:mb-[60px]",He),style:Qe,children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col gap-4",children:[jsxRuntimeExports.jsx(Logo,{vanilla:!0,className:"size-8"}),jsxRuntimeExports.jsxs("p",{className:"mmd:mr-auto",children:["© ",new Date().getFullYear()," PixAI.Art"]})]}),jsxRuntimeExports.jsxs("div",{className:cx("space-y-4","msm:contents msm:space-y-0"),children:[jsxRuntimeExports.jsxs("ul",{className:"space-y-4",children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsxs("a",{href:it("common:help-center.link.href")||config$1.helpCenterUrl,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1",onClick:()=>{track("footer_how_to_use_click")},children:[it("common:help-center.link.label"),jsxRuntimeExports.jsx(icBaselineOpenInNew,{className:"size-4"})]})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsxs("a",{href:it("common:content-rules.link.href"),target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1",onClick:()=>{track("footer_content_rules_click")},children:[it("common:content-rules.link.label"),jsxRuntimeExports.jsx(icBaselineOpenInNew,{className:"size-4"})]})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsxs("a",{href:"https://pixai.art/anime-ai-generator",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1",onClick:()=>{track("footer_anime_ai_generator_click")},children:[it("common:tab.sites.anime-ai-generator"),jsxRuntimeExports.jsx(icBaselineOpenInNew,{className:"size-4"})]})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsxs("a",{href:"https://pixai.art/ai-art-generator",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1",onClick:()=>{track("footer_anime_ai_art_generator_click")},children:[it("common:tab.sites.ai-art-generator"),jsxRuntimeExports.jsx(icBaselineOpenInNew,{className:"size-4"})]})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsxs("a",{href:"https://pixai.art/theme",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1",onClick:()=>{track("footer_thematic_generator_click")},children:[it("common:tab.sites.thematic-generator"),jsxRuntimeExports.jsx(icBaselineOpenInNew,{className:"size-4"})]})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsxs("a",{href:"https://pixai.art/articles",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1",onClick:()=>{track("footer_guide")},children:[it("common:footer.guide"),jsxRuntimeExports.jsx(icBaselineOpenInNew,{className:"size-4"})]})})]}),jsxRuntimeExports.jsxs("ul",{className:"space-y-4",children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(Link,{to:"/tags",onClick:()=>{track("footer_tags_click"),scrollToTop()},children:it("common:tags.page.title")})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(Link,{to:"/privacy",onClick:()=>{track("footer_policy_click"),scrollToTop()},children:it("common:privacy-policy")})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(Link,{to:"/copyright",onClick:()=>{track("footer_copyright_click"),scrollToTop()},children:it("common:copyright-policy")})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(Link,{to:"/terms",onClick:()=>{track("footer_terms_click"),scrollToTop()},children:it("common:tos")})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(Link,{to:"/legal",onClick:()=>{track("footer_legal_information_click"),scrollToTop()},children:it("common:legal-information")})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(Link,{to:"/feedback",onClick:()=>{track("footer_feedback_click"),scrollToTop()},children:it("common:contact")})})]})]})]})}function scrollToTop(){window.scrollTo({top:0})}const SiteNameWithDescription=He=>jsxRuntimeExports.jsx(CustomHeroTitleWithDescription,{title:"PixAI",description:"The AI Character Engine",...He}),CustomHeroTitleWithDescription=He=>{const Qe=He.descComponent??"h2";return jsxRuntimeExports.jsxs("div",{className:cx("py-2 text-center mt-5",He.className),children:[jsxRuntimeExports.jsx("div",{className:cx("font-rhodium relative",He.size==="small"?"msm:text-2xl":"text-2xl sm:text-5xl"),children:He.title}),He.description&&jsxRuntimeExports.jsx(Qe,{className:cx("font-medium leading-none uppercase tracking-widest",He.size==="small"?"-mt-2 text-xs leading-none scale-50":"text-[13px]"),children:jsxRuntimeExports.jsx("span",{className:cx(He.size==="small"&&"inline-flex flex-col items-center w-0 whitespace-nowrap"),children:He.description})})]})};function DiscordIcon(He){return jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",...He,role:"img",children:[jsxRuntimeExports.jsx("title",{children:"Discord"}),jsxRuntimeExports.jsx("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z",fill:"currentColor"})]})}function DiscordButton(He){const{data:Qe}=useDynamicConstants();return jsxRuntimeExports.jsxs(ButtonBase,{component:"a",href:Qe?.externalUrls?.discordJoin,target:"_blank",rel:"noopener noreferrer",className:cx("inline-flex items-center no-underline font-semibold text-white bg-gradient-to-b from-[#787eec] to-[#5761e6] rounded-full",He.size==="small"?"p-1.5":"p-2",He.label&&(He.size==="small"?"px-2":"px-4"),He.className),style:He.style,onClick:()=>{track("discord_banner_click")},children:[jsxRuntimeExports.jsx(DiscordIcon,{className:cx("flex-none",He.size==="small"?"size-3":"size-6")}),He.label&&jsxRuntimeExports.jsx("span",{className:cx("opacity-90",He.size==="small"?"ml-1.5 text-sm leading-none":"ml-2"),children:"Discord"})]})}const stateAtom=atomWithImmer({scrolledOut:!1});function useObserveSimpleGenIntersection(){const He=useSetAtom(stateAtom),{ref:Qe,entry:it}=useIntersection({threshold:1});return reactExports.useEffect(()=>(it&&He(lt=>{lt.scrolledOut=!it.isIntersecting}),()=>{He(lt=>{lt.scrolledOut=!1})}),[it,He]),Qe}function NewLabel({className:He,style:Qe}){return jsxRuntimeExports.jsx("span",{className:twMerge("inline-block px-1 py-0.5 text-[10px] leading-none font-medium text-white bg-gradient-purple-pink rounded-sm",He),style:Qe,children:"NEW"})}const SvgNaverCafe=He=>reactExports.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"4 4 24 24",id:"aside_cafe_logo",...He},reactExports.createElement("rect",{width:32,height:32,fill:"none",rx:16}),reactExports.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M16.16 12.025H11.68c.12-2.476 2.182-4.447 4.708-4.447h4.482c-.12 2.477-2.182 4.447-4.709 4.447z",clipRule:"evenodd"}),reactExports.createElement("path",{fill:"currentColor",d:"M8.211 14.545c0-.483.393-.876.876-.876h12.439c.484 0 .876.393.876.876V18.4a7.095 7.095 0 11-14.19 0v-3.854z"}),reactExports.createElement("path",{stroke:"currentColor",strokeWidth:1.263,d:"M21.852 14.3h1.34a2.916 2.916 0 010 5.833h-1.34V14.3z"})),icBaselineDiscord=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09 0 0 0-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09 0 0 0-4.8 0c-.14-.34-.35-.76-.54-1.09c-.01-.02-.04-.03-.07-.03c-1.5.26-2.93.71-4.27 1.33c-.01 0-.02.01-.03.02c-2.72 4.07-3.47 8.03-3.1 11.95c0 .02.01.04.03.05c1.8 1.32 3.53 2.12 5.24 2.65c.03.01.06 0 .07-.02c.4-.55.76-1.13 1.07-1.74c.02-.04 0-.08-.04-.09c-.57-.22-1.11-.48-1.64-.78c-.04-.02-.04-.08-.01-.11c.11-.08.22-.17.33-.25c.02-.02.05-.02.07-.01c3.44 1.57 7.15 1.57 10.55 0c.02-.01.05-.01.07.01c.11.09.22.17.33.26c.04.03.04.09-.01.11c-.52.31-1.07.56-1.64.78c-.04.01-.05.06-.04.09c.32.61.68 1.19 1.07 1.74c.03.01.06.02.09.01c1.72-.53 3.45-1.33 5.25-2.65c.02-.01.03-.03.03-.05c.44-4.53-.73-8.46-3.1-11.95c-.01-.01-.02-.02-.04-.02zM8.52 14.91c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.84 2.12-1.89 2.12zm6.97 0c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.83 2.12-1.89 2.12z"})}),mdiInstagram=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4H7.6m9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8A1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5a5 5 0 0 1-5 5a5 5 0 0 1-5-5a5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3Z"})}),mdiYoutube=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m10 15l5.19-3L10 9v6m11.56-7.83c.13.47.22 1.1.28 1.9c.07.8.1 1.49.1 2.09L22 12c0 2.19-.16 3.8-.44 4.83c-.25.9-.83 1.48-1.73 1.73c-.47.13-1.33.22-2.65.28c-1.3.07-2.49.1-3.59.1L12 19c-4.19 0-6.8-.16-7.83-.44c-.9-.25-1.48-.83-1.73-1.73c-.13-.47-.22-1.1-.28-1.9c-.07-.8-.1-1.49-.1-2.09L2 12c0-2.19.16-3.8.44-4.83c.25-.9.83-1.48 1.73-1.73c.47-.13 1.33-.22 2.65-.28c1.3-.07 2.49-.1 3.59-.1L12 5c4.19 0 6.8.16 7.83.44c.9.25 1.48.83 1.73 1.73Z"})}),riTwitterXLine=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10.488 14.651L15.25 21h7l-7.858-10.478L20.93 3h-2.65l-5.117 5.886L8.75 3h-7l7.51 10.015L2.32 21h2.65zM16.25 19L5.75 5h2l10.5 14z"})});function useSocialMedia(){const{data:He}=useDynamicConstants(),{i18n:Qe}=useTranslation(),it=Qe.language,lt={name:"Discord",icon:icBaselineDiscord,link:He?.externalUrls?.discordJoin},ut={name:"X",icon:({className:St})=>React.createElement(riTwitterXLine,{className:cx(St,"scale-90")}),link:He?.externalUrls?.twitterAccounts??He?.externalUrls?.twitter},dt={name:"Instagram",icon:mdiInstagram,link:He?.externalUrls?.instagram},xt={name:"YouTube",icon:mdiYoutube,link:He?.externalUrls?.youtubeAccounts},ft={name:"Naver Cafe",icon:SvgNaverCafe,link:He?.externalUrls?.naverCafe},vt={en:[lt,ut,dt,xt],kr:[lt,ft,dt,xt]};return(vt[it]||vt.en).map(St=>({...St,link:typeof St.link=="string"?St.link:St.link?.[it]??St.link?.en}))}const desktopNavigationExpandAtom=atomWithStorage("desktopNavigationExpand",!0,void 0,{getOnInit:!0}),fluentAdd24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M11.883 3.007L12 3a1 1 0 0 1 .993.883L13 4v7h7a1 1 0 0 1 .993.883L21 12a1 1 0 0 1-.883.993L20 13h-7v7a1 1 0 0 1-.883.993L12 21a1 1 0 0 1-.993-.883L11 20v-7H4a1 1 0 0 1-.993-.883L3 12a1 1 0 0 1 .883-.993L4 11h7V4a1 1 0 0 1 .883-.993L12 3z"})}),fluentChat24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10a9.96 9.96 0 0 1-4.644-1.142l-4.29 1.117a.85.85 0 0 1-1.037-1.036l1.116-4.289A9.96 9.96 0 0 1 2 12C2 6.477 6.477 2 12 2m1.252 11H8.75l-.102.007a.75.75 0 0 0 0 1.486l.102.007h4.502l.101-.007a.75.75 0 0 0 0-1.486zm1.998-3.5h-6.5l-.102.007a.75.75 0 0 0 0 1.486L8.75 11h6.5l.102-.007a.75.75 0 0 0 0-1.486z"})}),fluentHome24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M13.45 2.533a2.25 2.25 0 0 0-2.9 0L3.8 8.228a2.25 2.25 0 0 0-.8 1.72v9.305c0 .966.784 1.75 1.75 1.75h3a1.75 1.75 0 0 0 1.75-1.75V15.25c0-.68.542-1.232 1.217-1.25h2.566a1.25 1.25 0 0 1 1.217 1.25v4.003c0 .966.784 1.75 1.75 1.75h3a1.75 1.75 0 0 0 1.75-1.75V9.947a2.25 2.25 0 0 0-.8-1.72z"})}),fluentHome24Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10.55 2.532a2.25 2.25 0 0 1 2.9 0l6.75 5.692c.507.428.8 1.057.8 1.72v9.31a1.75 1.75 0 0 1-1.75 1.75h-3.5a1.75 1.75 0 0 1-1.75-1.75v-5.007a.25.25 0 0 0-.25-.25h-3.5a.25.25 0 0 0-.25.25v5.007a1.75 1.75 0 0 1-1.75 1.75h-3.5A1.75 1.75 0 0 1 3 19.254v-9.31c0-.663.293-1.292.8-1.72zm1.933 1.147a.75.75 0 0 0-.966 0L4.767 9.37a.75.75 0 0 0-.267.573v9.31c0 .138.112.25.25.25h3.5a.25.25 0 0 0 .25-.25v-5.007c0-.967.784-1.75 1.75-1.75h3.5c.966 0 1.75.783 1.75 1.75v5.007c0 .138.112.25.25.25h3.5a.25.25 0 0 0 .25-.25v-9.31a.75.75 0 0 0-.267-.573z"})}),fluentImage24Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17.75 3A3.25 3.25 0 0 1 21 6.25v11.5A3.25 3.25 0 0 1 17.75 21H6.25A3.25 3.25 0 0 1 3 17.75V6.25A3.25 3.25 0 0 1 6.25 3zm.58 16.401l-5.805-5.686a.75.75 0 0 0-.966-.071l-.084.07l-5.807 5.687q.274.097.582.099h11.5c.203 0 .399-.035.58-.099l-5.805-5.686zM17.75 4.5H6.25A1.75 1.75 0 0 0 4.5 6.25v11.5q.001.313.103.594l5.823-5.701a2.25 2.25 0 0 1 3.02-.116l.128.116l5.822 5.702q.102-.28.104-.595V6.25a1.75 1.75 0 0 0-1.75-1.75m-2.498 2a2.252 2.252 0 1 1 0 4.504a2.252 2.252 0 0 1 0-4.504m0 1.5a.752.752 0 1 0 0 1.504a.752.752 0 0 0 0-1.504"})}),fluentImageArrowForward24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M1 6.5a5.5 5.5 0 1 0 11 0a5.5 5.5 0 0 0-11 0m6.646-2.146a.5.5 0 1 1 .708-.708l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 1 1-.708-.708L8.293 6H6.25A2.25 2.25 0 0 0 4 8.25v.25a.5.5 0 0 1-1 0v-.25A3.25 3.25 0 0 1 6.25 5h2.043zM15.752 7.5a.752.752 0 1 1 0 1.504a.752.752 0 0 1 0-1.504M13 6.5a6.5 6.5 0 0 1-10 5.478v5.772c0 .627.178 1.213.485 1.71l6.939-6.812l.135-.123a2.25 2.25 0 0 1 2.889.006l.128.117l6.939 6.811A3.24 3.24 0 0 0 21 17.75V6.25A3.25 3.25 0 0 0 17.75 3h-5.772A6.47 6.47 0 0 1 13 6.5m2.752-.5a2.252 2.252 0 1 1 0 4.504a2.252 2.252 0 0 1 0-4.504m-4.277 7.718l.083-.071a.75.75 0 0 1 .874-.007l.093.078l6.928 6.8A3.24 3.24 0 0 1 17.75 21H6.25a3.24 3.24 0 0 1-1.703-.481z"})}),fluentImageStack20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M6 3a3 3 0 0 0-3 3v3h3.293l2.47-2.47a1.75 1.75 0 0 1 2.474 0L13.707 9H17V6a3 3 0 0 0-3-3zm11 7v4a3 3 0 0 1-2.361 2.932l-3.402-3.402a1.75 1.75 0 0 0-2.474 0L5.36 16.932A3 3 0 0 1 3 14v-4zM6.707 17h6.586l-2.763-2.763a.75.75 0 0 0-1.06 0zm1-8h4.586L10.53 7.237a.75.75 0 0 0-1.06 0zM15.5 5.5a1 1 0 1 1-2 0a1 1 0 0 1 2 0m-1 8a1 1 0 1 0 0-2a1 1 0 0 0 0 2"})}),fluentWand24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m11.405 9.465l-8.707 8.714a2.27 2.27 0 0 0 3.211 3.208l8.706-8.712zm5.447 5.542L16.75 15a.75.75 0 0 0-.743.648L16 15.75v.75h-.75a.75.75 0 0 0-.743.648l-.007.102c0 .38.282.694.648.743l.102.007H16v.75c0 .38.282.694.648.743l.102.007a.75.75 0 0 0 .743-.648l.007-.102V18h.75a.75.75 0 0 0 .743-.648L19 17.25a.75.75 0 0 0-.648-.743l-.102-.007h-.75v-.75a.75.75 0 0 0-.648-.743L16.75 15zm-3.538-7.442l-.136.126l-.712.713l3.21 3.21l.712-.714a2.25 2.25 0 0 0-.001-3.182l-.157-.146a2.25 2.25 0 0 0-2.916-.007M6.852 5.007L6.75 5a.75.75 0 0 0-.743.648L6 5.75v.75h-.75a.75.75 0 0 0-.743.648L4.5 7.25c0 .38.282.693.648.743L5.25 8H6v.75c0 .38.282.693.648.743l.102.007a.75.75 0 0 0 .743-.648L7.5 8.75V8h.75a.75.75 0 0 0 .743-.648L9 7.25a.75.75 0 0 0-.648-.743L8.25 6.5H7.5v-.75a.75.75 0 0 0-.648-.743L6.75 5zm12-2L18.75 3a.75.75 0 0 0-.743.648L18 3.75v.75h-.75a.75.75 0 0 0-.743.648l-.007.102c0 .38.282.693.648.743L17.25 6H18v.75c0 .38.282.693.648.743l.102.007a.75.75 0 0 0 .743-.648l.007-.102V6h.75a.75.75 0 0 0 .743-.648L21 5.25a.75.75 0 0 0-.648-.743L20.25 4.5h-.75v-.75a.75.75 0 0 0-.648-.743L18.75 3z"})}),fluentWand24Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m13.314 7.565l-.136.126l-10.48 10.488a2.27 2.27 0 0 0 3.211 3.208L16.388 10.9a2.25 2.25 0 0 0-.001-3.182l-.157-.146a2.25 2.25 0 0 0-2.916-.007m-.848 2.961l1.088 1.088l-8.706 8.713a.77.77 0 1 1-1.089-1.088zm4.386 4.48L16.75 15a.75.75 0 0 0-.743.648L16 15.75v.75h-.75a.75.75 0 0 0-.743.648l-.007.102c0 .38.282.694.648.743l.102.007H16v.75c0 .38.282.694.648.743l.102.007a.75.75 0 0 0 .743-.648l.007-.102V18h.75a.75.75 0 0 0 .743-.648L19 17.25a.75.75 0 0 0-.648-.743l-.102-.007h-.75v-.75a.75.75 0 0 0-.648-.743L16.75 15zm-1.553-6.254l.027.027a.75.75 0 0 1 0 1.061l-.711.713l-1.089-1.089l.73-.73a.75.75 0 0 1 1.043.018M6.852 5.007L6.75 5a.75.75 0 0 0-.743.648L6 5.75v.75h-.75a.75.75 0 0 0-.743.648L4.5 7.25c0 .38.282.693.648.743L5.25 8H6v.75c0 .38.282.693.648.743l.102.007a.75.75 0 0 0 .743-.648L7.5 8.75V8h.75a.75.75 0 0 0 .743-.648L9 7.25a.75.75 0 0 0-.648-.743L8.25 6.5H7.5v-.75a.75.75 0 0 0-.648-.743L6.75 5zm12-2L18.75 3a.75.75 0 0 0-.743.648L18 3.75v.75h-.75a.75.75 0 0 0-.743.648l-.007.102c0 .38.282.693.648.743L17.25 6H18v.75c0 .38.282.693.648.743l.102.007a.75.75 0 0 0 .743-.648l.007-.102V6h.75a.75.75 0 0 0 .743-.648L21 5.25a.75.75 0 0 0-.648-.743L20.25 4.5h-.75v-.75a.75.75 0 0 0-.648-.743L18.75 3z"})}),icBaselineAutoFixHigh=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7.5 5.6L10 7L8.6 4.5L10 2L7.5 3.4L5 2l1.4 2.5L5 7zm12 9.8L17 14l1.4 2.5L17 19l2.5-1.4L22 19l-1.4-2.5L22 14zM22 2l-2.5 1.4L17 2l1.4 2.5L17 7l2.5-1.4L22 7l-1.4-2.5zm-7.63 5.29a.996.996 0 0 0-1.41 0L1.29 18.96a.996.996 0 0 0 0 1.41l2.34 2.34c.39.39 1.02.39 1.41 0L16.7 11.05a.996.996 0 0 0 0-1.41l-2.33-2.35zm-1.03 5.49l-2.12-2.12l2.44-2.44l2.12 2.12l-2.44 2.44z"})}),icOutlineColorLens=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 22C6.49 22 2 17.51 2 12S6.49 2 12 2s10 4.04 10 9c0 3.31-2.69 6-6 6h-1.77c-.28 0-.5.22-.5.5c0 .12.05.23.13.33c.41.47.64 1.06.64 1.67A2.5 2.5 0 0 1 12 22zm0-18c-4.41 0-8 3.59-8 8s3.59 8 8 8c.28 0 .5-.22.5-.5a.54.54 0 0 0-.14-.35c-.41-.46-.63-1.05-.63-1.65a2.5 2.5 0 0 1 2.5-2.5H16c2.21 0 4-1.79 4-4c0-3.86-3.59-7-8-7z"}),jsxRuntimeExports.jsx("circle",{cx:6.5,cy:11.5,r:1.5,fill:"currentColor"}),jsxRuntimeExports.jsx("circle",{cx:9.5,cy:7.5,r:1.5,fill:"currentColor"}),jsxRuntimeExports.jsx("circle",{cx:14.5,cy:7.5,r:1.5,fill:"currentColor"}),jsxRuntimeExports.jsx("circle",{cx:17.5,cy:11.5,r:1.5,fill:"currentColor"})]}),icRoundRocketLaunch=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M9.19 6.35c-2.04 2.29-3.44 5.58-3.57 5.89l-2.26-.97c-.65-.28-.81-1.13-.31-1.63l3.01-3.01c.47-.47 1.15-.68 1.81-.55l1.32.27zm1.49 10.16c.3.3.74.38 1.12.2c1.16-.54 3.65-1.81 5.26-3.42c4.59-4.59 4.63-8.33 4.36-9.93a.979.979 0 0 0-.79-.79c-1.6-.27-5.34-.23-9.93 4.36c-1.61 1.61-2.87 4.1-3.42 5.26c-.18.38-.09.83.2 1.12l3.2 3.2zm6.97-1.7c-2.29 2.04-5.58 3.44-5.89 3.57l.97 2.26c.28.65 1.13.81 1.63.31l3.01-3.01c.47-.47.68-1.15.55-1.81l-.27-1.32zm-8.71 2.6a3 3 0 0 1-.82 2.71c-.77.77-3.16 1.34-4.71 1.64c-.69.13-1.3-.48-1.17-1.17c.3-1.55.86-3.94 1.64-4.71a3 3 0 0 1 2.71-.82c1.17.22 2.13 1.18 2.35 2.35zM13 9c0-1.1.9-2 2-2s2 .9 2 2s-.9 2-2 2s-2-.9-2-2z"})}),iconoirTools=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,children:[jsxRuntimeExports.jsx("path",{d:"m10.05 10.607l-7.07 7.07a2 2 0 0 0 0 2.83v0a2 2 0 0 0 2.828 0l7.07-7.072m4.315.365l3.878 3.878a2 2 0 0 1 0 2.828v0a2 2 0 0 1-2.828 0l-6.209-6.208M6.733 5.904L4.61 6.61L2.49 3.075l1.414-1.414L7.44 3.782zm0 0l2.83 2.83"}),jsxRuntimeExports.jsx("path",{d:"M10.05 10.607c-.844-2.153-.679-4.978 1.061-6.718s4.95-2.121 6.717-1.06l-3.04 3.04l-.283 3.111l3.111-.282l3.04-3.041c1.062 1.768.68 4.978-1.06 6.717c-1.74 1.74-4.564 1.905-6.717 1.061"})]})}),materialSymbolsBrush=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M6 21q-1.125 0-2.225-.55T2 19q.65 0 1.325-.513T4 17q0-1.25.875-2.125T7 14q1.25 0 2.125.875T10 17q0 1.65-1.175 2.825T6 21Zm5.75-6L9 12.25l8.95-8.95q.275-.275.688-.288t.712.288l1.35 1.35q.3.3.3.7t-.3.7L11.75 15Z"})}),materialSymbolsGlobe=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 22q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22Zm0-2q3.35 0 5.675-2.325T20 12q0-.175-.013-.363t-.012-.312q-.125.725-.675 1.2T18 13h-2q-.825 0-1.413-.587T14 11v-1h-4V8q0-.825.588-1.413T12 6h1q0-.575.313-1.012t.762-.713q-.5-.125-1.012-.2T12 4Q8.65 4 6.325 6.325T4 12h5q1.65 0 2.825 1.175T13 16v1h-3v2.75q.5.125.988.188T12 20Z"})}),materialSymbolsInstallMobileRounded=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7 23q-.825 0-1.413-.588T5 21V3q0-.825.588-1.413T7 1h7v2H7v1h7v2H7v12h10v-2h2v5q0 .825-.588 1.413T17 23H7Zm10-12.8V4q0-.425.288-.713T18 3q.425 0 .713.288T19 4v6.2l1.9-1.9q.275-.275.7-.275t.7.275q.275.275.275.7t-.275.7l-3.6 3.6q-.3.3-.7.3t-.7-.3l-3.6-3.6q-.275-.275-.275-.7t.275-.7q.275-.275.7-.275t.7.275l1.9 1.9ZM14 4H7V3h7v1Z"})}),materialSymbolsNavigateBefore=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m14 18l-6-6l6-6l1.4 1.4l-4.6 4.6l4.6 4.6L14 18Z"})}),enableUserRank=!1;function AppNavigationDesktop(){const[He,Qe]=useAtom(desktopNavigationExpandAtom),it=()=>{Qe(dt=>!dt)},lt=reactExports.useMemo(()=>{const dt=[{name:"tool-realtime-generation",title:"common:tab.sites.realtime-generation",icon:icRoundRocketLaunch,link:"/generator/realtime/drawing"},{name:"tool-upscaler",title:"common:post-menu.image-upscaler",icon:fluentImage24Regular,link:"/generator/upscaler"},{name:"image-stitching-kiss",title:"common:tab.sites.image-stitching-kiss",icon:fluentImageStack20Filled,link:"/generator/stitching/kiss"},{name:"image-stitching-hug",title:"common:tab.sites.image-stitching-hug",icon:fluentImageStack20Filled,link:"/generator/stitching/hug"},{name:"chat-editing-preset",title:"common:tab.sites.chat-editing-preset",icon:fluentImageArrowForward24Filled,link:"/generator/preset",badge:"new"}],xt=dt.some(ft=>ft.badge==="new");return{data:dt,badge:xt?"new":void 0}},[]),ut=He?"expanded":"shrinked";return jsxRuntimeExports.jsxs("div",{className:"flex flex-col justify-start w-[--app-nav-width] shadow-[1px_0px_#0002] dark:shadow-[inset_-1px_0px_#fff2] relative transition-[width]",children:[jsxRuntimeExports.jsx("div",{className:"sticky top-[calc(var(--app-header-height)+1em)] w-[calc(100%+0.75em)] h-0 overflow-visible flex justify-end z-100 transition-all",children:jsxRuntimeExports.jsx("button",{className:"rounded-full bg-background hover:bg-background-secondary drop-shadow-lg transition-transform duration-150 size-6 dark:ring-2 dark:ring-neutral-500",onClick:it,children:jsxRuntimeExports.jsx(materialSymbolsNavigateBefore,{className:cx("size-6",He?"rotate-0":"rotate-180")})})}),jsxRuntimeExports.jsxs("div",{className:"sticky top-[--app-header-height] flex flex-col py-1",children:[jsxRuntimeExports.jsx(NavItem,{type:ut,item:{name:"home",title:"common:home.label",icon:fluentHome24Regular,link:"/"}}),jsxRuntimeExports.jsx(NavItem,{type:ut,item:{name:"generation",title:"common:tab.generation",icon:icOutlineColorLens,link:"//pixai",onClick:()=>{startEventGroup("generate_source")}}}),jsxRuntimeExports.jsx(NavItem,{type:ut,item:{name:"market",title:"common:tab.models",icon:icBaselineAutoFixHigh,link:"/market"}}),jsxRuntimeExports.jsx(NavItem,{type:ut,item:{name:"worlds",title:"common:tab.worlds",icon:materialSymbolsGlobe,experiment:WORLD_CHARACTER_EXPERIMENT_NAME,link:"/worlds"}}),enableUserRank,jsxRuntimeExports.jsx(NavItem,{type:ut,item:{name:"generation-chat-editing",title:"common:tab.sites.generation-chat-editing",icon:fluentChat24Filled,link:"/generator/chat-editing",tracker:{event:"chat_editing_tool_clicked"}}}),jsxRuntimeExports.jsx("hr",{className:cx("border-[#DDD] dark:border-[#424345]",!He&&"hidden")}),jsxRuntimeExports.jsx(NavItem,{type:ut,item:{name:"tool",title:"common:tab.sites.category",icon:iconoirTools,badge:lt.badge,children:lt.data}})]}),jsxRuntimeExports.jsx("span",{className:"mt-auto"}),jsxRuntimeExports.jsxs("div",{className:"sticky bottom-0 bg-background",children:[jsxRuntimeExports.jsx(NavItem,{type:ut,item:{name:"mobile",title:"common:tab.mobile.label",icon:materialSymbolsInstallMobileRounded,onClick:()=>{openAppDownloadDialog({trackingArgs:{source:"user"}})}}}),jsxRuntimeExports.jsx(NavItemIconGroup,{expanded:He})]})]})}function NavItemIconGroup({expanded:He}){const{data:Qe}=useDynamicConstants(),it=useSocialMedia();return He?jsxRuntimeExports.jsx("ul",{className:"flex px-3 my-2 justify-between",children:it.map((lt,ut)=>jsxRuntimeExports.jsx(UITooltipTriggerWrapper,{delay:250,className:"px-2 py-1",trigger:jsxRuntimeExports.jsx($4f118338184dc1d9$export$a6c7ac8248d6e38a,{href:lt.link,target:"_blank",rel:"nofollow noopener",children:jsxRuntimeExports.jsx("li",{className:"bg-neutral-50 dark:bg-neutral-700 hover:bg-neutral-200 dark:hover:bg-neutral-600 drop-shadow-sm hover:drop-shadow-md p-2 rounded-md transition-all cursor-pointer group",children:jsxRuntimeExports.jsx(lt.icon,{className:"size-5 opacity-80 group-hover:opacity-100"})})}),children:lt.name},ut))}):jsxRuntimeExports.jsx(NavItem,{type:"shrinked",item:{name:"discord",title:"common:join-discord",icon:icBaselineDiscord,link:Qe?.externalUrls?.discordJoin}})}const navItemStyles=ce$1({slots:{root:"",icon:"flex-none opacity-70 transition-all",label:"",labelText:"md:text-sm text-xs leading-none"},variants:{type:{shrinked:"",expanded:"","list-item":""}},compoundSlots:[{slots:["root"],type:"list-item",className:"md:h-8"},{slots:["root"],type:"expanded",className:"md:h-12"},{slots:["root"],type:"shrinked",className:"md:h-20"},{slots:["root"],type:["expanded","list-item"],className:"flex-row gap-2 ml-0 justify-start px-3"},{slots:["root"],type:"shrinked",className:"flex-col grow gap-1 justify-center h-16 text-primary"},{slots:["icon"],type:"list-item",className:"size-5"},{slots:["icon"],type:"expanded",className:"size-6"},{slots:["icon"],type:"shrinked",className:"size-8"},{slots:["label"],type:["expanded","list-item"],className:"flex-grow"},{slots:["labelText"],type:["expanded","list-item"],className:"text-left"},{slots:["labelText"],type:"shrinked",className:"text-center"},{slots:["labelText"],type:["shrinked","expanded"],className:"font-medium"},{slots:["labelText"],type:"list-item",className:"font-normal"}]});function NavItem({item:He,type:Qe,className:it,hidden:lt=!1,style:ut}){const dt=useLocation(),xt=He.link?He.link==="/"?dt.pathname===He.link:dt.pathname.startsWith(He.link):!1,ft=Qe!=="shrinked",vt=He.children&&He.children.length>0,[kt,St]=reactExports.useState(),Tt=useExperimentParam(He.experiment??"",!He.experiment),[Mt,Nt]=reactExports.useState(!1);if(!Tt)return null;const At=navItemStyles({type:Qe}),$t={variant:"ghost",slot:"trigger",className:cx("w-[calc(100%-0.5em)] rounded-none items-center flex transition-all","md:rounded-md md:mx-1 md:my-0.5 md:grow-0 relative ring-0 outline-0","hover:bg-purple-600 hover:bg-opacity-10",xt?"bg-purple-600 bg-opacity-10 dark:bg-opacity-30":"",At.root(),lt&&"hidden",it,He.badge&&"[&>:last-child]:shrink-0"),style:ut,onPress:Ft=>{track("nav_btn_click",{cate:He.name}),He.onClick?.(),vt&&!ft&&St(Ft.target)},icon:He.icon&&jsxRuntimeExports.jsx(He.icon,{className:At.icon()}),labelClassName:At.label(),endIcon:typeof He.badge=="string"?jsxRuntimeExports.jsx(NavItemBadge,{type:He.badge}):He.badge?He.badge:ft&&vt?jsxRuntimeExports.jsx(icBaselineExpandMore,{className:cx("transition-all",Mt&&"rotate-180")}):void 0},Dt=jsxRuntimeExports.jsx(UIButton$1,{...$t,children:jsxRuntimeExports.jsx("div",{className:At.labelText(),children:jsxRuntimeExports.jsx(Text,{i18nKey:He.title})})});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[!vt&&(He.link?jsxRuntimeExports.jsx(UILink,{href:He.link,...$t,children:jsxRuntimeExports.jsx("div",{className:At.labelText(),children:jsxRuntimeExports.jsx(Text,{i18nKey:He.title})})}):Dt),vt&&!ft&&jsxRuntimeExports.jsx(NavItemMenu,{button:Dt,items:He.children,anchorEl:kt,hide:()=>St(void 0)}),vt&&ft&&jsxRuntimeExports.jsx(NavItemCollapseMenu,{button:Dt,items:He.children,isExpanded:Mt,onExpandedChange:Nt})]})}function NavItemBadge(He){switch(He.type){case"new":return jsxRuntimeExports.jsx(NewLabel,{className:"absolute top-0 right-0"});default:return null}}function NavItemMenu({button:He,items:Qe,anchorEl:it,hide:lt}){const ut=useIsMobile(),dt=it!=null,{t:xt}=useTranslation(["common","action","generation","workflow"]);function ft(kt){kt.tracker&&track(kt.tracker.event,kt.tracker.attrs),kt.onClick?.(),kt.link&&/^https?:\/\//.test(kt.link)&&window.open(kt.link,"_blank","noopener,noreferrer")}const vt=ut?jsxRuntimeExports.jsx(Drawer,{anchor:"bottom",open:dt,onClose:lt,elevation:4,children:jsxRuntimeExports.jsxs(List,{className:"bg-background-secondary",children:[Qe.map(kt=>jsxRuntimeExports.jsx(NavItemMenuMobileListItem,{item:kt,onClick:()=>ft(kt),className:"h-full text-base font-medium"},kt.title)),jsxRuntimeExports.jsx(ListItem$3,{children:jsxRuntimeExports.jsx(ListItemButton,{onClick:lt,children:xt("action:cancel")})})]})}):jsxRuntimeExports.jsx(Menu,{open:dt,anchorEl:it,anchorOrigin:{vertical:"top",horizontal:ut?"left":"right"},transformOrigin:{vertical:ut?"bottom":"top",horizontal:"left"},onClose:lt,disableScrollLock:!0,elevation:2,slotProps:{paper:{className:"bg-background-secondary"}},children:Qe.map(kt=>jsxRuntimeExports.jsx(NavItemMenuDesktopMenuItem,{item:kt,className:"h-10",onClick:()=>{ft(kt),lt()}},kt.title))});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[He,vt]})}const NavItemMenuMobileListItem=({item:He,onClick:Qe,className:it,style:lt})=>{const{t:ut}=useTranslation(["common","action","generation","workflow"]);return useExperimentParam(He.experiment??"",!He.experiment)?jsxRuntimeExports.jsx(ListItem$3,{children:jsxRuntimeExports.jsx(ListItemButton,{onClick:Qe,className:cx(it,He.className),style:lt,children:ut(He.title)})},He.title):null},NavItemMenuDesktopMenuItem=({item:He,onClick:Qe,className:it,style:lt})=>{const{t:ut}=useTranslation(["common","action","generation","workflow"]);return useExperimentParam(He.experiment??"",!He.experiment)?jsxRuntimeExports.jsx(MenuItem$1,{component:Link,to:He.link??"#",className:cx(it,He.className),onClick:Qe,style:lt,children:jsxRuntimeExports.jsxs("div",{className:cx("flex items-center gap-2 w-full h-10 text-base"),children:[He.icon&&jsxRuntimeExports.jsx(He.icon,{className:"size-5"}),jsxRuntimeExports.jsx("span",{children:ut(He.title)}),typeof He.badge=="string"?jsxRuntimeExports.jsx(NavMenuItemBadge,{type:He.badge}):He.badge]})},He.title):null};function NavMenuItemBadge(He){switch(He.type){case"new":return jsxRuntimeExports.jsx(NewLabel,{});default:return null}}function NavItemCollapseMenu({button:He,items:Qe,isExpanded:it,onExpandedChange:lt}){return jsxRuntimeExports.jsxs($28f4fd908f0de97f$export$74a362b31437ec83,{isExpanded:it,onExpandedChange:lt,children:[He,jsxRuntimeExports.jsx($28f4fd908f0de97f$export$feabaa331e1d464c,{children:jsxRuntimeExports.jsx("ul",{className:"ml-2",children:Qe.map(ut=>jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(NavItem,{item:ut,className:"text-wrap",type:"list-item"})},ut.title))})})]})}const APP_NAVIGATION_HEIGHT=60;function AppNavigationMobile(){const{t:He}=useTranslation("common"),Qe=useLocation(),it=xt=>xt==="/"?Qe.pathname===xt:Qe.pathname.startsWith(xt),lt=useWorldCharacterExperiment(),ut=useExperimentParam("exp2509-mobileweb-bottom-nav-button-size");function dt(){return lt?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(materialSymbolsBrush,{className:"size-6 mr-[3px]"}),He("common:generate.label")]}):$$3(ut).with("treatment-b",()=>jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsx(fluentAdd24Filled,{className:"size-4"}),jsxRuntimeExports.jsx("div",{className:"text-[8px] leading-3",children:He("common:generate.label")})]})).otherwise(()=>jsxRuntimeExports.jsx(fluentAdd24Filled,{className:"size-6"}))}return jsxRuntimeExports.jsxs("div",{className:cx("grid grid-cols-[1fr_auto_1fr] place-items-center text-xs fixed inset-x-0 bottom-0 z-20","bg-gradient-to-t from-background to-background/80 backdrop-blur shadow-[0_-1px_#0002] dark:shadow-[inset_0_1px_#fff2]"),style:{height:APP_NAVIGATION_HEIGHT},children:[jsxRuntimeExports.jsxs(Link,{to:"/pixai","data-active":it("/pixai")?"":null,className:cx("group flex flex-col items-center no-underline dark:data-[active]:text-white opacity-60 data-[active]:opacity-100",ut?.includes("treatment")&&"w-24"),onClick:()=>track("nav_btn_click",{cate:"home"}),children:[jsxRuntimeExports.jsx(fluentHome24Regular,{className:"size-6 group-data-[active]:hidden"}),jsxRuntimeExports.jsx(fluentHome24Filled,{className:"size-6 hidden group-data-[active]:block"}),jsxRuntimeExports.jsx("span",{className:"-mb-0.5 font-medium",children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:home.label"})})]}),jsxRuntimeExports.jsx(IconButton,{component:Link,to:"//pixai",className:cx("bg-purple-600 dark:bg-purple-400 text-white font-semibold text-base",ut?.includes("treatment")&&"scale-[1.75] -translate-y-3 shadow-md shadow-purple-500",ut==="treatment-b"&&"px-3.5",lt?"absolute -top-14 px-10 py-3 rounded-2xl":"rounded-full"),onClick:()=>{track("mobile_new_btn_click")},children:dt()}),jsxRuntimeExports.jsxs(Link,{to:"/market","data-active":it("/market")?"":null,className:cx("group flex flex-col items-center no-underline dark:data-[active]:text-white opacity-60 data-[active]:opacity-100",ut?.includes("treatment")&&"w-24"),onClick:()=>track("nav_btn_click",{cate:"market"}),children:[jsxRuntimeExports.jsx(fluentWand24Regular,{className:"size-6 group-data-[active]:hidden"}),jsxRuntimeExports.jsx(fluentWand24Filled,{className:"size-6 hidden group-data-[active]:block"}),jsxRuntimeExports.jsx("span",{className:"-mb-0.5 font-medium",children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:tab.models"})})]}),lt&&jsxRuntimeExports.jsxs(Link,{to:"/worlds",className:cx("flex flex-col items-center no-underline",{"opacity-60":!it("/worlds")}),onClick:()=>track("nav_btn_click",{cate:"worlds"}),children:[jsxRuntimeExports.jsx(materialSymbolsGlobe,{className:"size-6"}),jsxRuntimeExports.jsx("span",{className:"-mb-0.5 font-medium",children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:tab.worlds"})})]})]})}function AppNavigation(){return useIsMobile()?jsxRuntimeExports.jsx(AppNavigationMobile,{}):jsxRuntimeExports.jsx(AppNavigationDesktop,{})}const IMG_APP_ICON="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQ7SURBVHgB7ZfLa1x1FMc/9zGTO49O0iTNq5ZprE1ptVRR0NqFQpGCUkV3/gUuXLlQEVy7diviHyBSwYJ9WKgVH00UIylt0jxMGvIoeU3mzsx9vzwzrixxRtLBbHqYgXvnd+ae7+/7O+d7zlV6e3sT9tBU9tgeAdhzAHqzRaPD4OP3PsAJYzrzHSiGjmeFBF4MiiLwFZIkIZJvqVRmeu4us7OTLC0v0h4AhsHw4WOoiUKmYEg8hVxnBteXwoliFF3Dc0NiuY3l/rVzZymZAdMzU3z2xadsbq7TypofgTy4VqmiGinCSMF2fLn3SGmy6yggm1fJZjSyWQ09peAFEbblcGzkOB+9/wlDQ4d4KACyccIwIgkFiVw7AiCMEhzZdc202F63seXasgJc28cTZsxKTdZdCvv28e47H8pJNd9j0yMIA9llLoeiwfLkHbp6+nCsNBO/j7O5sdGgvdDVxXDxCP0HBiUfYqIwJPJD1I40HemMsHGKu9N/7A6ApmnCgoLruPRnheKUhrm9zdVrV7h1e+Ifvq+ee50333gbU4Dh2/QMDeEJY8+cOr17AHXeXdtBdU0ynQV8xyPxPGKpigft0tWLHB56nOHu/ehumcA9gJE1GOx/DFVVieN4xwhqi/hUl+Y4kNMIPRffdSTdY4Ig3NF9evY2SUeWUNEpl8uNfIljqaBM9l9DNGUgCnwG9husLS+TSqdR9QyaMBA49o7+WSKyakCuK8NaxcRNVNEIeU4U7Q5ASnLgq0vXmVkrYdsBIweLnD99FD29899GuruJqyYLi+tUxV/JD1CONNw6c7sBUFe7F44UefnceS7+MI+WLvLN99dIJeEDbgpvvXiG+2tb3Jgps7iyRCGn0CNA01I5zaw5AJHYkadPsr2xzUtnz3B8oI/5hV58c5xX7JpIcogS+hwrHqYzt48bsw5POIP09VfoHqhRGr3M5OrM7gGEvk86iejPa/SwiFLd4sn+hHTxpNSoZLYoX9LAGYkcKzwvimike1m4Jz5eie3nTnL5wpfsGkAiZRB5DnlDGpFkfxLbxLohwSI0Ubh8ISvSbMvvcWN9SHOIahucMKr8aVX4/Oq3tLLmzSiXJS26r+k6ST2TlfonaRxNPmdIY8phm6b0paQBQGRQxMfiwugYX4+NSRlGDwcgjiMOnXmWyuyy6HvQCIyq8fPELTZLJdS4nowqssKmKOTc0jIzUrJBGPJfrXkZSu0PHj1BUrFw71cJkr/V7MrNUcanpmiHtZyIYumGXcVhUikaDNQhtHOMbg1AOl6qsJ+DT52gp68gme/VpY12WYuBJJFGApOSA52iAetqHrtSERbax4HeymF8apX5lXUsYeLXOyvkfR3fcmiXNQUQSNArN6dlKOmQOWABc3Wen368jlmt8L8AqNYsfvvlu8aUo1pblKsWq4v3cOOAdpny6N2QPbY9B/AXzOwI2E31w+AAAAAASUVORK5CYII=",isMobileDevice=()=>{const He=navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(He)},BANNER_HEIGHT=50;function OpenAppBannerContent(){const He=useLocation(),{t:Qe}=useTranslation("common"),[it,lt]=reactExports.useState(!1),ut=reactExports.useRef(!1),dt=()=>{ut.current=!1},xt=()=>{ut.current=!0},ft=async()=>{if("getInstalledRelatedApps"in navigator&&typeof navigator.getInstalledRelatedApps=="function")try{const kt=await navigator.getInstalledRelatedApps();Array.isArray(kt)&&kt.length>0&&lt(!0)}catch{}};reactExports.useEffect(()=>{isAndroid()&&ft()},[]),reactExports.useEffect(()=>(window.addEventListener("focus",dt),window.addEventListener("blur",xt),()=>{window.removeEventListener("focus",dt),window.removeEventListener("blur",xt)}),[]);const vt=isAndroid()&&!it?config$1.playStoreLink:isIOS$1()?config$1.iosAppStoreLink:`https://pixai.art${He.pathname}`;return reactExports.useEffect(()=>(document.documentElement.style.setProperty("--open-in-app-banner-height",BANNER_HEIGHT+"px"),()=>{document.documentElement.style.removeProperty("--open-in-app-banner-height")}),[]),jsxRuntimeExports.jsxs("section",{className:"box-content px-3 flex items-center gap-2 text-xs bg-background border-b border-neutral-200 dark:border-neutral-700",style:{height:BANNER_HEIGHT},children:[jsxRuntimeExports.jsx("img",{src:IMG_APP_ICON,className:"w-7 h-7 rounded"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col leading-none overflow-hidden",children:[jsxRuntimeExports.jsx("strong",{className:"text-sm",children:"PixAI"}),jsxRuntimeExports.jsx("span",{className:"w-full truncate opacity-60",children:Qe("common:use-app-for-the-better-xp")})]}),jsxRuntimeExports.jsx("a",{href:vt,target:"_blank",rel:"noreferrer",className:"px-3 py-1.5 text-[15px] font-medium text-white bg-[#017AFE] rounded-full ml-auto",onClick:kt=>{track("download_click"),isAndroid()&&(kt.preventDefault(),openAppDownloadDialog({hideIos:!0,trackingArgs:{source:"user"}}))},children:Qe("common:open-in-app")})]})}function OpenAppBanner(){return isMobileDevice()&&!isSafari()?jsxRuntimeExports.jsx(OpenAppBannerContent,{}):null}const icBaselineClear=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z"})}),icBaselineSearch=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5A6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14z"})});function SearchBar(He){const[{q:Qe}]=useQs(),[it,lt]=reactExports.useState(Qe||""),{t:ut}=useTranslation(["common"]),dt=useNavigate(),{data:xt}=useUserInfo(),ft=kt=>{kt.preventDefault(),lt(it),dt(`/search?${formatQs({q:it,showSignUpModal:xt?void 0:"1"})}`),kt.currentTarget.querySelector("input")?.blur(),track("search",{scene:"home",value:it})},vt=useLocation();return reactExports.useEffect(()=>{vt.pathname!=="/search"&&lt("")},[vt.pathname]),jsxRuntimeExports.jsx("form",{className:cx("flex justify-center items-center self-stretch flex-grow w-[145px] focus-within:w-[412px] transition-all duration-200 ease-in-out border rounded-full border-black/50 dark:border-white/50",it&&"w-[412px]",He.className),style:He.style,noValidate:!0,action:"",onSubmit:ft,children:jsxRuntimeExports.jsx(OutlinedInput,{placeholder:ut("common:search"),className:"w-full h-9 bg-background-secondary rounded-full",classes:{notchedOutline:"border-none"},startAdornment:jsxRuntimeExports.jsx(InputAdornment,{position:"start",children:jsxRuntimeExports.jsx(icBaselineSearch,{className:"text-primary size-6"})}),endAdornment:it.length>0&&jsxRuntimeExports.jsx(InputAdornment,{position:"end",children:jsxRuntimeExports.jsx(IconButton,{onClick:()=>{lt(""),dt("/")},children:jsxRuntimeExports.jsx(icBaselineClear,{className:"text-primary size-6"})})}),value:it,onChange:kt=>lt(kt.target.value),inputProps:{enterKeyHint:"search"},fullWidth:!0})})}const StyledOutlinedInput$1=styled(OutlinedInput)(()=>({backgroundColor:"var(--secondary)","& .MuiOutlinedInput-input":{padding:"0.75rem 0"}}));function MobileSearchBar(He){const{t:Qe}=useTranslation(["common","action"]),[{q:it},lt]=useQs(),[ut,dt]=reactExports.useState(it||""),xt=useNavigate(),ft=vt=>{vt.preventDefault(),dt(ut),xt(`/search?${formatQs({q:ut})}`,{replace:!0})};return jsxRuntimeExports.jsxs("form",{noValidate:!0,action:"",onSubmit:ft,className:cx("flex w-full justify-center items-center gap-4",He.className),children:[jsxRuntimeExports.jsx(StyledOutlinedInput$1,{className:"grow rounded-2xl",startAdornment:jsxRuntimeExports.jsx(InputAdornment,{position:"start",children:jsxRuntimeExports.jsx(icBaselineSearch,{className:"size-6"})}),endAdornment:jsxRuntimeExports.jsx(InputAdornment,{position:"end",children:jsxRuntimeExports.jsx(IconButton,{onClick:()=>{dt(""),xt("/")},children:jsxRuntimeExports.jsx(icBaselineClear,{className:"size-6"})})}),value:ut,onChange:vt=>dt(vt.target.value),inputProps:{enterKeyHint:"search"},placeholder:Qe("common:home.search-placeholder"),autoFocus:!it}),jsxRuntimeExports.jsx("input",{type:"submit",className:"hidden"})]})}const MembershipCountdown=({className:He,style:Qe,expireAt:it})=>jsxRuntimeExports.jsx(Countdown,{targetDate:it,children:({timeLeft:lt})=>jsxRuntimeExports.jsx(CountdownNumberFlow,{timeLeft:lt,className:He,style:Qe})}),CountdownNumberFlow=({timeLeft:He,className:Qe,style:it})=>{const lt=defaultDayjs.duration(He),ut=Math.floor(lt.asDays()),[dt,xt,ft]=lt.format("H:m:s").split(":").map(Number),vt=[ut,dt,xt,ft];return jsxRuntimeExports.jsx("span",{className:cx("inline-grid grid-flow-col items-center tabular-nums",Qe),style:it,children:jsxRuntimeExports.jsx(NumberFlowGroup,{children:vt.map((kt,St)=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[St>0&&":",jsxRuntimeExports.jsx(NumberFlow,{value:kt,trend:-1,suffix:St===0?"D":void 0,digits:St===0?void 0:{1:{max:5}},format:St===0?void 0:{minimumIntegerDigits:2}},St)]}))})})},bg="_bg_5584j_1",content="_content_5584j_46",styles$8={bg,"bg-gradient":"_bg-gradient_5584j_1",content,"content-translate":"_content-translate_5584j_1","bg-bounce":"_bg-bounce_5584j_1","icon-pop":"_icon-pop_5584j_1","icon-shake":"_icon-shake_5584j_1","icon-shadow":"_icon-shadow_5584j_1"};function MembershipHeaderBanner(He){const Qe=useBreakpoint("mlg","up"),{ongoing:it,countdown:lt,endDate:ut}=useGrowthEvent(GrowthEventName.AugustEvent2025),{data:dt}=useMyMembership(),xt=getMembershipExpireTime(dt?.subscription?.endAt),ft=!it&&xt!==void 0&&shouldShowMembershipCountdown(xt,3),vt=()=>it&&lt&&ut?jsxRuntimeExports.jsx(MembershipCountdown,{expireAt:defaultDayjs(ut),className:"ml-2"}):ft&&jsxRuntimeExports.jsx(MembershipCountdown,{expireAt:xt,className:"ml-2"}),kt=Qe?"long":"short",St=ft?`countdown_${kt}`:kt,Tt=it?kt:St,Mt=dt?.subscription?.tier?"/membership/credit-packs":"/membership/plans";return jsxRuntimeExports.jsxs("div",{className:cx("[--height:32px]","relative z-10 grid h-[--height]",He.className),style:He.style,children:[jsxRuntimeExports.jsx("div",{className:cx(styles$8.bg,"row-start-1 col-start-1"),style:it?{"--color-1":"#e1d5ff","--color-2":"#e1fbd2","--color-3":"#ffe1c9"}:void 0}),jsxRuntimeExports.jsxs(Link,{to:it?"/membership/credit-packs":Mt,className:cx("row-start-1 col-start-1 relative flex justify-center items-center hover:bg-black/10 no-underline transition",it?"text-black":"text-white font-medium text-shadow shadow-black/50"),onClick:()=>{const Nt="top-bar";track("enter_member_click",{location:Nt}),startEventGroup("member_source",Nt,{persistent:!0})},children:[!it&&jsxRuntimeExports.jsx(MembershipIcon,{className:cx("w-5 h-5 mr-2 -translate-y-px drop-shadow")}),jsxRuntimeExports.jsx("span",{className:"leading-[100%] text-center lg:text-left",children:jsxRuntimeExports.jsx(Text,{i18nKey:`${it?"growth":"membership"}:membership.banner.label`,context:Tt,components:{br:jsxRuntimeExports.jsx("br",{}),small:jsxRuntimeExports.jsx("span",{className:"text-xs"})}})}),vt(),jsxRuntimeExports.jsx(mdiChevronRight,{className:"w-6 h-6 drop-shadow"})]})]})}const store$3=getDefaultStore(),headerBannerAtom=atom(!1),setHeaderBanner=He=>{store$3.set(headerBannerAtom,He)};atom("default");const footerDisplayAtom=atom(!1),setFooterDisplay=He=>{store$3.set(footerDisplayAtom,He)};function useHideableNavbar(He=!0){const[Qe,it]=reactExports.useState(He),lt=reactExports.useRef(!1),ut=reactExports.useRef(0),dt=reactExports.useCallback(ft=>{ft!==null&&(ut.current=ft.getBoundingClientRect().height)},[]),xt=reactExports.useRef(0);return reactExports.useEffect(()=>{const ft=()=>{const vt=xt.current;if(!He)return;if(window.scrollY<ut.current){it(!0);return}if(lt.current){lt.current=!1;return}const kt=vt,St=document.documentElement.scrollHeight-ut.current,Tt=window.innerHeight;kt&&window.scrollY>=kt?it(!1):window.scrollY+Tt<St&&it(!0),xt.current=window.scrollY};return window.addEventListener("scroll",ft,{passive:!0}),()=>window.removeEventListener("scroll",ft)},[He]),{navbarRef:dt,isNavbarVisible:Qe}}const id=He=>He,Left=He=>({_tag:"Left",value:He}),Right=He=>({_tag:"Right",value:He}),either=(He,Qe,it)=>it._tag==="Left"?He(it.value):Qe(it.value),profunctorFn={dimap:(He,Qe,it)=>lt=>Qe(it(He(lt))),first:He=>([Qe,it])=>[He(Qe),it],right:He=>Qe=>Qe._tag==="Left"?Qe:Right(He(Qe.value)),wander:He=>Qe=>Qe.map(He)},monoidFirst={empty:()=>{},foldMap:(He,Qe)=>{for(let it=0;it<Qe.length;it++){const lt=He(Qe[it]);if(lt!=null)return lt}}},monoidArray={empty:()=>[],foldMap:(He,Qe)=>{let it=[];return Qe.forEach(lt=>{it=it.concat(He(lt))}),it}},profunctorConst=He=>({dimap:(Qe,it,lt)=>ut=>lt(Qe(ut)),first:Qe=>([it,lt])=>Qe(it),right:Qe=>it=>it._tag==="Left"?He.empty():Qe(it.value),wander:Qe=>it=>He.foldMap(Qe,it)}),compositionType={Equivalence:{Equivalence:"Equivalence",Iso:"Iso",Lens:"Lens",Prism:"Prism",Traversal:"Traversal",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Iso:{Equivalence:"Iso",Iso:"Iso",Lens:"Lens",Prism:"Prism",Traversal:"Traversal",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Lens:{Equivalence:"Lens",Iso:"Lens",Lens:"Lens",Prism:"Prism",Traversal:"Traversal",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Prism:{Equivalence:"Prism",Iso:"Prism",Lens:"Prism",Prism:"Prism",Traversal:"Traversal",Getter:"AffineFold",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Traversal:{Equivalence:"Traversal",Iso:"Traversal",Lens:"Traversal",Prism:"Traversal",Traversal:"Traversal",Getter:"Fold",AffineFold:"Fold",Fold:"Fold",Setter:"Setter"},Getter:{Equivalence:"Getter",Iso:"Getter",Lens:"Getter",Prism:"AffineFold",Traversal:"Fold",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:void 0},AffineFold:{Equivalence:"AffineFold",Iso:"AffineFold",Lens:"AffineFold",Prism:"AffineFold",Traversal:"Fold",Getter:"AffineFold",AffineFold:"AffineFold",Fold:"Fold",Setter:void 0},Fold:{Equivalence:"Fold",Iso:"Fold",Lens:"Fold",Prism:"Fold",Traversal:"Fold",Getter:"Fold",AffineFold:"Fold",Fold:"Fold",Setter:void 0},Setter:{Equivalence:void 0,Iso:void 0,Lens:void 0,Prism:void 0,Traversal:void 0,Getter:void 0,AffineFold:void 0,Fold:void 0,Setter:void 0}},withTag=(He,Qe)=>{const it=Qe;return it._tag=He,it},removable=He=>(He._removable=!0,He);function compose$1(He,Qe,it){switch(arguments.length){case 2:{const lt=(ut,dt)=>He(ut,Qe(ut,dt));return lt._tag=compositionType[He._tag][Qe._tag],lt._removable=Qe._removable||!1,lt}default:{const lt=compositionType[He._tag][Qe._tag],ut=(dt,xt)=>He(dt,Qe(dt,it(dt,xt)));return ut._tag=compositionType[lt][it._tag],ut._removable=it._removable||!1,ut}}}const eq=withTag("Equivalence",(He,Qe)=>Qe),iso=(He,Qe)=>withTag("Iso",(it,lt)=>it.dimap(He,Qe,lt)),lens=(He,Qe)=>withTag("Lens",(it,lt)=>it.dimap(ut=>[He(ut),ut],Qe,it.first(lt))),prism=(He,Qe)=>withTag("Prism",(it,lt)=>it.dimap(He,ut=>either(id,Qe,ut),it.right(lt))),elems=withTag("Traversal",(He,Qe)=>He.dimap(id,id,He.wander(Qe))),to=He=>withTag("Getter",(Qe,it)=>Qe.dimap(He,id,it)),modify$1=(He,Qe,it)=>He(profunctorFn,Qe)(it),set$1=(He,Qe,it)=>He(profunctorFn,()=>Qe)(it),get$1=(He,Qe)=>He(profunctorConst({}),id)(Qe),preview$1=(He,Qe)=>He(profunctorConst(monoidFirst),id)(Qe),collect$1=(He,Qe)=>He(profunctorConst(monoidArray),it=>[it])(Qe),indexed=iso(He=>He.map((Qe,it)=>[it,Qe]),He=>{const Qe=[...He].sort((lt,ut)=>lt[0]-ut[0]),it=[];for(let lt=0;lt<Qe.length;++lt)(lt===Qe.length-1||Qe[lt][0]!==Qe[lt+1][0])&&it.push(Qe[lt][1]);return it}),prop=He=>lens(Qe=>Qe[He],([Qe,it])=>Object.assign(Object.assign({},it),{[He]:Qe})),pick=He=>lens(Qe=>{const it={};for(const lt of He)it[lt]=Qe[lt];return it},([Qe,it])=>{const lt=Object.assign({},it);for(const ut of He)delete lt[ut];return Object.assign(lt,Qe)}),nth=He=>lens(Qe=>Qe[He],([Qe,it])=>{const lt=it.slice();return lt[He]=Qe,lt}),fst=nth(0),when=He=>prism(Qe=>He(Qe)?Right(Qe):Left(Qe),id),noMatch=Symbol("__no_match__"),mustMatch=when(He=>He!==noMatch),removeMe=Symbol("__remove_me__"),at=He=>removable(compose$1(lens(Qe=>0<=He&&He<Qe.length?Qe[He]:noMatch,([Qe,it])=>{if(Qe===noMatch)return it;if(Qe===removeMe)return typeof it=="string"?it.substring(0,He)+it.substring(He+1):[...it.slice(0,He),...it.slice(He+1)];if(typeof it=="string")return He===0?Qe+it.substring(1):He===it.length?it.substring(0,He-1)+Qe:it.substring(0,He)+Qe+it.substring(He+1);{const lt=it.slice();return lt[He]=Qe,lt}}),mustMatch)),optional$1=prism(He=>He===void 0?Left(void 0):Right(He),id),guard=He=>prism(Qe=>He(Qe)?Right(Qe):Left(Qe),id),find=He=>removable(compose$1(lens(Qe=>{const it=Qe.findIndex(He);return it===-1?[noMatch,-1]:[Qe[it],it]},([[Qe,it],lt])=>{if(Qe===noMatch)return lt;if(Qe===removeMe)return[...lt.slice(0,it),...lt.slice(it+1)];const ut=lt.slice();return ut[it]=Qe,ut}),fst,mustMatch)),filter$2=He=>compose$1(lens(Qe=>{const it=Qe.map((lt,ut)=>He(lt)?ut:null).filter(lt=>lt!=null);return[it.map(lt=>Qe[lt]),it]},([[Qe,it],lt])=>{const ut=lt.length,dt=Qe.length;let xt=0,ft=0,vt=0;const kt=[];for(;xt<ut;)it[ft]===xt?(++ft,vt<dt&&(kt.push(Qe[vt]),++vt)):kt.push(lt[xt]),++xt;for(;vt<dt;)kt.push(Qe[vt++]);return kt}),fst),valueOr=He=>lens(Qe=>Qe===void 0?He:Qe,([Qe,it])=>Qe),partsOf=He=>compose$1(lens(Qe=>{const it=collect$1(He,Qe);return[it,it.length]},([[Qe,it],lt])=>{if(Qe.length!==it)throw new Error("cannot add/remove elements through partsOf");let ut=0;return modify$1(He,()=>Qe[ut++],lt)}),fst),reread=He=>lens(Qe=>He(Qe),([Qe,it])=>Qe),rewrite=He=>lens(Qe=>Qe,([Qe,it])=>He(Qe)),prependTo=lens(He=>{},([He,Qe])=>He===void 0?Qe:[He,...Qe]),appendTo=lens(He=>{},([He,Qe])=>He===void 0?Qe:[...Qe,He]),chars=compose$1(iso(He=>He.split(""),He=>He.join("")),elems),words=compose$1(iso(He=>He.split(/\b/),He=>He.join("")),elems,when(He=>!/\s+/.test(He)));class Optic{constructor(Qe){this._ref=Qe}get _tag(){return this._ref._tag}get _removable(){return this._ref._removable}compose(Qe){return new Optic(compose$1(this._ref,Qe._ref))}iso(Qe,it){return new Optic(compose$1(this._ref,iso(Qe,it)))}lens(Qe,it){return new Optic(compose$1(this._ref,lens(Qe,([lt,ut])=>it(ut,lt))))}indexed(){return new Optic(compose$1(this._ref,indexed))}prop(Qe){return new Optic(compose$1(this._ref,prop(Qe)))}path(...Qe){return Qe.length===1&&(Qe=Qe[0].split(".")),new Optic(Qe.reduce((it,lt)=>compose$1(it,prop(lt)),this._ref))}pick(Qe){return new Optic(compose$1(this._ref,pick(Qe)))}nth(Qe){return new Optic(compose$1(this._ref,nth(Qe)))}filter(Qe){return new Optic(compose$1(this._ref,filter$2(Qe)))}valueOr(Qe){return new Optic(compose$1(this._ref,valueOr(Qe)))}partsOf(Qe){const it=typeof Qe=="function"?Qe(optic$1):Qe;return new Optic(compose$1(this._ref,partsOf(it._ref)))}reread(Qe){return new Optic(compose$1(this._ref,reread(Qe)))}rewrite(Qe){return new Optic(compose$1(this._ref,rewrite(Qe)))}optional(){return new Optic(compose$1(this._ref,optional$1))}guard_(){return Qe=>this.guard(Qe)}guard(Qe){return new Optic(compose$1(this._ref,guard(Qe)))}at(Qe){return new Optic(compose$1(this._ref,at(Qe)))}head(){return new Optic(compose$1(this._ref,at(0)))}index(Qe){return new Optic(compose$1(this._ref,at(Qe)))}find(Qe){return new Optic(compose$1(this._ref,find(Qe)))}elems(){return new Optic(compose$1(this._ref,elems))}to(Qe){return new Optic(compose$1(this._ref,to(Qe)))}when(Qe){return new Optic(compose$1(this._ref,when(Qe)))}chars(){return new Optic(compose$1(this._ref,chars))}words(){return new Optic(compose$1(this._ref,words))}prependTo(){return new Optic(compose$1(this._ref,prependTo))}appendTo(){return new Optic(compose$1(this._ref,appendTo))}}const optic$1=new Optic(eq);function optic(){return optic$1}function get(He){return Qe=>get$1(He._ref,Qe)}function preview(He){return Qe=>preview$1(He._ref,Qe)}function collect(He){return Qe=>collect$1(He._ref,Qe)}function modify(He){return Qe=>it=>modify$1(He._ref,Qe,it)}function set(He){return Qe=>it=>set$1(He._ref,Qe,it)}const getCached=(He,Qe,it)=>(Qe.has(it)?Qe:Qe.set(it,He())).get(it),cache1=new WeakMap,memo2=(He,Qe,it)=>{const lt=getCached(()=>new WeakMap,cache1,Qe);return getCached(He,lt,it)},isFunction=He=>typeof He=="function";function focusAtom(He,Qe){return memo2(()=>{const it=Qe(optic());return atom(ut=>{const dt=ut(He);return dt instanceof Promise?dt.then(xt=>getValueUsingOptic(it,xt)):getValueUsingOptic(it,dt)},(ut,dt,xt)=>{const ft=isFunction(xt)?modify(it)(xt):set(it)(xt),vt=ut(He);return dt(He,vt instanceof Promise?vt.then(ft):ft(vt))})},He,Qe)}const getValueUsingOptic=(He,Qe)=>He._tag==="Traversal"?collect(He)(Qe):He._tag==="Prism"?preview(He)(Qe):get(He)(Qe);function usePickAtomValue(He,Qe){const it=JSON.stringify(Qe.slice().sort()),lt=reactExports.useMemo(()=>focusAtom(He,ut=>ut.pick(Qe)),[He,it]);return useAtomValue(lt)}const mingcuteSearchLine=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsxs("g",{fill:"none",fillRule:"evenodd",children:[jsxRuntimeExports.jsx("path",{d:"M24 0v24H0V0h24ZM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018Zm.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01l-.184-.092Z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10.5 2a8.5 8.5 0 1 0 5.262 15.176l3.652 3.652a1 1 0 0 0 1.414-1.414l-3.652-3.652A8.5 8.5 0 0 0 10.5 2ZM4 10.5a6.5 6.5 0 1 1 13 0a6.5 6.5 0 0 1-13 0Z"})]})}),styles$7={"app-layout":"_app-layout_fwolc_1","app-layout-expanded":"_app-layout-expanded_fwolc_22"},ROUTES_TO_SHOW_SEARCH_BAR={"/":"top","/market":!0,"/search":!0},AppHeader=reactExports.memo(()=>{const He=useIsMobile(),Qe=!He,it=He?48:64,[lt,{height:ut}]=useMeasure$1();reactExports.useEffect(()=>{document.documentElement.style.setProperty("--app-header-height",it+ut+"px")},[it,ut]);const dt=useLocation(),{scrolledOut:xt}=usePickAtomValue(stateAtom,["scrolledOut"]),ft=ROUTES_TO_SHOW_SEARCH_BAR[dt.pathname],vt=!!ft&&(ft==="top"?!xt:!0);return jsxRuntimeExports.jsxs("div",{className:"sticky top-0 z-20",children:[jsxRuntimeExports.jsx("div",{ref:lt,children:jsxRuntimeExports.jsx(LayoutHeaderBanner,{})}),jsxRuntimeExports.jsxs("header",{className:cx("flex items-center bg-background shadow-md",He?"px-3 gap-2":"px-4 gap-4"),style:{height:it},children:[jsxRuntimeExports.jsxs(Link,{to:"/",className:cx("group flex-none inline-flex items-center py-3 no-underline",Qe&&"px-3"),children:[jsxRuntimeExports.jsx(Logo,{className:"size-7 mmd:size-9"}),jsxRuntimeExports.jsx(CustomHeroTitleWithDescription,{title:jsxRuntimeExports.jsx(Text,{i18nKey:"common:artwork-list.hero.title"}),size:"small",className:"ml-2 !mt-0 -mb-2 max-mmd:hidden"})]}),jsxRuntimeExports.jsx(DiscordButton,{size:"small",className:"mmd:hidden"}),jsxRuntimeExports.jsx("span",{className:"ml-auto"}),jsxRuntimeExports.jsxs(AnimatePresence,{children:[Qe&&jsxRuntimeExports.jsx(motion.span,{animate:{opacity:dt.pathname!=="/"||xt?1:0,display:dt.pathname!=="/"||xt?"":"none"},transition:{duration:.1},children:jsxRuntimeExports.jsx(GenerationButton,{})},"desktop-generate"),Qe?jsxRuntimeExports.jsx(motion.span,{animate:{opacity:vt?1:0,display:vt?"":"none"},transition:{duration:.1},children:jsxRuntimeExports.jsx(SearchBar,{})},"desktop-search"):jsxRuntimeExports.jsx(IconButton,{component:Link,to:"/search",className:"size-8 bg-background-secondary border border-solid border-black/50 dark:border-white/50",children:jsxRuntimeExports.jsx(mingcuteSearchLine,{className:"flex-none size-5 text-primary"})},"mobile-search")]}),jsxRuntimeExports.jsx(NotificationButton,{size:He?"normal":"large"}),jsxRuntimeExports.jsx(AccountButton,{size:He?"normal":"large",className:"-mr-1"})]})]})});AppHeader.displayName="AppHeader";const ROUTES_SHOWING_APP_NAV=["/market","/artwork/","/model/","/workflows","/workflow/","/contest/","/worlds","/tags"];function AppLayout({children:He}){const Qe=useLocation(),it=useAtomValue(footerDisplayAtom),lt=useAtomValue(desktopNavigationExpandAtom),ut=useIsMobile(),dt=Qe.pathname==="/"||ROUTES_SHOWING_APP_NAV.some(St=>Qe.pathname.startsWith(St)),xt=Qe.pathname.startsWith("/artwork"),ft=Qe.pathname.startsWith("/search"),vt=ut&&ft;reactExports.useEffect(()=>{document.documentElement.style.setProperty("--app-bottom-navigation-height",(ut?APP_NAVIGATION_HEIGHT:0)+"px")},[ut]);const kt=reactExports.useMemo(()=>{const St={largeMaxWidth:{classes:{root:`max-w-[108rem] ${ut?"px-2 md:px-6":"px-0"}`}},fullWidth:{maxWidth:!1,classes:{root:"!px-0"}}};return xt?{classes:{root:`max-w-[108rem] ${ut?"px-0 md:px-6":"px-0"}`}}:Object.entries({"/":St.largeMaxWidth,"/ranking":St.largeMaxWidth,"/search":St.largeMaxWidth,"/market":St.largeMaxWidth,"/market/":St.largeMaxWidth,"^/workflows":St.fullWidth,"/contest":St.fullWidth,"/train-lora":St.fullWidth,"/user-rank":St.fullWidth,"/membership/plans":{maxWidth:!1,classes:{root:"!px-0"}},"/membership/credit-packs":{maxWidth:!1,classes:{root:"!px-0"}},"^/referral":{maxWidth:!1,classes:{root:"!px-0"}},"^/world/":St.fullWidth,"^/event":St.fullWidth}).find(([Tt])=>Tt.startsWith("^")?Qe.pathname.startsWith(Tt.slice(1)):Qe.pathname===Tt)?.[1]??{}},[Qe,ut,xt]);return vt?jsxRuntimeExports.jsx(MobileSearchResultLayout,{children:He}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col min-h-screen",children:[dt&&jsxRuntimeExports.jsx(OpenAppBanner,{}),jsxRuntimeExports.jsx(AppHeader,{}),jsxRuntimeExports.jsxs("div",{className:cx("flex-1 transition-all duration-300",lt?styles$7["app-layout-expanded"]:styles$7["app-layout"]),children:[dt&&jsxRuntimeExports.jsx(AppNavigation,{}),jsxRuntimeExports.jsx(Container$1,{className:cx("min-w-0 mmd:pl-3 mmd:pr-1",!dt&&"col-span-full"),style:{gridArea:dt?"main":void 0},...kt,children:He})]}),it&&jsxRuntimeExports.jsx(AppFooter,{className:"mt-auto"})]})})}function MobileSearchResultLayout(He){const{navbarRef:Qe,isNavbarVisible:it}=useHideableNavbar(),lt=jsxRuntimeExports.jsx("nav",{ref:Qe,className:cx("w-full bg-background z-20 sticky top-0 transition-transform"),style:{boxShadow:"0 4px 12px #00000014, 0 0 1px #0100001a",transform:it?"":"translate3d(0, calc(-100% - 2px), 0)"},children:jsxRuntimeExports.jsx(MobileSearchBar,{className:"px-4 py-2"})});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[lt,jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx(Container$1,{className:"lg:px-36 md:px-20",children:He.children}),jsxRuntimeExports.jsx(AppNavigation,{})]})]})}function LayoutHeaderBanner(){const He=useAtomValue(headerBannerAtom),Qe=useDiscountBannerConditions();return He?Qe==="common"?jsxRuntimeExports.jsx(MembershipCommonDiscountTopBanner,{}):Qe==="recall"?jsxRuntimeExports.jsx(MembershipRecallDiscountTopBanner,{}):jsxRuntimeExports.jsx(MembershipHeaderBanner,{}):null}function GenerationButton(){const{data:He}=useUserInfo(),Qe=reactExports.useMemo(()=>withQuery("/pixai",He?.id?{}:{showSignUpModal:1}),[He?.id]);return jsxRuntimeExports.jsxs(ButtonBase,{component:Link,className:cx("px-3.5 py-2 font-medium no-underline bg-theme-primary hover:bg-violet-500 dark:bg-violet-600 text-white rounded-full transition active:bg-violet-600 dark:active:bg-violet-700 border-none h-10"),onClick:()=>{startEventGroup("generate_source"),track("new_btn_click")},to:Qe,children:[jsxRuntimeExports.jsx(icBaselineAdd,{className:"size-6"}),jsxRuntimeExports.jsx(Text,{i18nKey:"common:generate.label"})]})}const WorkbenchTrackingContext=React.createContext({});WorkbenchTrackingContext.displayName="WorkbenchTrackingContext";function LogoButton(){const He=reactExports.useContext(WorkbenchTrackingContext);return jsxRuntimeExports.jsxs(Link,{to:"/",className:"absolute flex-none h-full px-2 md:px-4 grid items-center gap-2 no-underline hover:bg-black/5 group",onClick:()=>{track("panel_home_select",{scene:He.scene})},children:[jsxRuntimeExports.jsx("span",{className:"contents group-hover:invisible",children:jsxRuntimeExports.jsx(Logo,{className:"row-start-1 col-start-1 size-7"})}),jsxRuntimeExports.jsx("span",{className:"contents invisible group-hover:visible w-full",children:jsxRuntimeExports.jsx(fluentChevronCircleLeft24Filled,{className:"row-start-1 col-start-1 size-7"})})]})}function Header({className:He,style:Qe,children:it}){const{data:lt}=useUserInfo();return lt?jsxRuntimeExports.jsx(HeaderWithUserInfoReady,{className:He,style:Qe,children:it}):jsxRuntimeExports.jsx(HeaderSkeleton,{className:He,style:Qe,children:it})}function HeaderWithUserInfoReady({className:He,style:Qe,children:it}){return jsxRuntimeExports.jsxs("div",{className:cx("sticky top-0 z-30",He),style:Qe,children:[jsxRuntimeExports.jsx(LayoutHeaderBanner,{}),jsxRuntimeExports.jsxs("header",{className:"relative h-12 pr-3 mlg:pr-4 flex items-center gap-2 mlg:gap-4 overflow-auto",children:[jsxRuntimeExports.jsx(LogoButton,{}),jsxRuntimeExports.jsx("div",{className:"ml-9 mlg:ml-[40px] flex items-center",children:it}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx(MyCredits,{variant:"purple-pink",className:"relative md:absolute md:right-[50%] md:translate-x-[50%]"}),jsxRuntimeExports.jsx(GeneratorEntry,{className:"max-mlg:hidden"}),jsxRuntimeExports.jsx(NotificationButton,{}),jsxRuntimeExports.jsx(AccountButton,{})]})]})}function HeaderSkeleton({className:He,style:Qe,children:it}){return jsxRuntimeExports.jsxs("div",{className:cx("sticky top-0 z-30",He),style:Qe,children:[jsxRuntimeExports.jsx(LayoutHeaderBanner,{}),jsxRuntimeExports.jsxs("header",{className:"relative h-12 pr-3 mlg:pr-4 flex items-center gap-2 mlg:gap-4 overflow-auto",children:[jsxRuntimeExports.jsx(LogoButton,{}),jsxRuntimeExports.jsx("div",{className:"ml-9 mlg:ml-[40px] flex items-center",children:it}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx(AccountButton,{})]})]})}const styles$6={"workbench-layout":"_workbench-layout_noywb_1"},WORKBENCH_OVERLAY_ID="workbench-layout-overlays";function WorkbenchLayout({scene:He,headerSlot:Qe,main:it,left:lt,right:ut,children:dt,mainProps:xt}){return jsxRuntimeExports.jsx(WorkbenchTrackingContext.Provider,{value:{scene:He},children:jsxRuntimeExports.jsxs(WorkbenchLayoutBase,{headerSlot:Qe,children:[lt&&jsxRuntimeExports.jsx("div",{className:"hidden mlg:flex flex-col mlg:overflow-hidden",style:{gridArea:"left"},children:lt}),it&&jsxRuntimeExports.jsx("main",{className:cx("relative flex flex-col",xt?.className),style:{gridArea:"main",gridColumnStart:lt?2:1,gridColumnEnd:ut?-2:-1,...xt?.style},children:it}),ut&&jsxRuntimeExports.jsx("div",{className:"flex flex-col mlg:border-l border-neutral-300 dark:border-neutral-700 mlg:overflow-hidden",style:{gridArea:"right"},children:ut}),dt]})})}function WorkbenchLayoutBase({scene:He,headerSlot:Qe,children:it}){return useEmbedded()?jsxRuntimeExports.jsx(WorkbenchTrackingContext.Provider,{value:{scene:He},children:jsxRuntimeExports.jsx(WorkbenchLayoutEmbedded,{children:it})}):jsxRuntimeExports.jsx(WorkbenchTrackingContext.Provider,{value:{scene:He},children:jsxRuntimeExports.jsx(WorkbenchLayoutPc,{headerSlot:Qe,children:it})})}function WorkbenchLayoutPc({headerSlot:He,children:Qe}){return jsxRuntimeExports.jsxs("div",{id:"workbench-layout",className:cx(styles$6["workbench-layout"],"mlg:h-screen min-h-screen grid text-sm text-[var(--fg-color)] bg-[var(--bg-color)] overflow-visible mlg:overflow-hidden","relative z-0"),children:[jsxRuntimeExports.jsx(Header,{className:"bg-background backdrop-blur-lg border-b border-neutral-100 dark:border-neutral-700",style:{gridArea:"header"},children:He}),Qe,jsxRuntimeExports.jsx("div",{id:WORKBENCH_OVERLAY_ID,className:"fixed top-0 left-0 z-40 w-full h-0"})]})}function WorkbenchLayoutEmbedded({children:He}){return jsxRuntimeExports.jsxs("div",{id:"workbench-layout",className:cx(styles$6["workbench-layout"],"mlg:h-screen min-h-screen grid text-sm text-[var(--fg-color)] bg-[var(--bg-color)] overflow-visible mlg:overflow-hidden","relative z-0"),children:[He,jsxRuntimeExports.jsx("div",{id:WORKBENCH_OVERLAY_ID,className:"fixed top-0 left-0 z-20 w-full h-0"})]})}function WorkbenchLayoutPortal(He){const Qe=reactExports.useRef(null);if(!Qe.current){const it=document.getElementById(WORKBENCH_OVERLAY_ID);it&&(Qe.current=it)}return Qe.current?reactDomExports.createPortal(He.children,document.getElementById(WORKBENCH_OVERLAY_ID)):(console.warn("Rendering null due to Portal Container not found."),null)}const icOutlineKeyboardArrowRight=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M8.59 16.59L13.17 12L8.59 7.41L10 6l6 6l-6 6l-1.41-1.41z"})});function CollapsibleControlSection(He){const[Qe,it]=reactExports.useState(He.defaultExpanded??!0),lt=He.expanded??Qe,ut=He.onExpandedChange??it,dt=He.help?jsxRuntimeExports.jsx(UITooltipHelpIcon,{TooltipProps:{placement:"start",UNSTABLE_portalContainer:document.getElementById(WORKBENCH_OVERLAY_ID)},...He.helpIconProps,children:He.help}):null,xt=()=>ut(!lt),ft=vt=>{(vt.key==="Enter"||vt.key===" ")&&(vt.preventDefault(),xt())};return jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,children:jsxRuntimeExports.jsxs(motion.section,{className:cx(He.compact?"p-0":"p-4","flex flex-col text-sm",He.className),style:He.style,layout:!0,transition:{duration:.1},children:[(He.title||He.titleSlot||dt)&&jsxRuntimeExports.jsxs(motion.header,{className:"flex items-center gap-2 relative cursor-pointer select-none rounded-md px-2 -mx-2 py-1 hover:bg-black/5 dark:hover:bg-white/5 transition-colors",layout:!0,transition:{duration:.1},onClick:xt,onKeyDown:ft,role:"button",tabIndex:0,"aria-expanded":lt,children:[jsxRuntimeExports.jsx(icOutlineKeyboardArrowRight,{className:cx("transition-transform",lt&&"rotate-90")}),He.title&&jsxRuntimeExports.jsx("h2",{className:cx("flex-none","font-semibold"),children:He.title}),dt,He.titleSlot]}),He.children&&lt&&jsxRuntimeExports.jsx(motion.div,{className:cx("flex flex-col gap-2",(He.title||He.titleSlot||dt)&&"mt-2"),layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},children:He.children})]})})}function GeneratorControlSection(He){const Qe=He.help?jsxRuntimeExports.jsx(UITooltipHelpIcon,{TooltipProps:{placement:"start",UNSTABLE_portalContainer:document.getElementById(WORKBENCH_OVERLAY_ID)},...He.helpIconProps,children:He.help}):null;return jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,children:jsxRuntimeExports.jsxs(motion.section,{className:cx(He.compact?"p-0":"p-4","flex flex-col text-sm",He.className),style:He.style,layout:!0,transition:{duration:.1},children:[He.title&&jsxRuntimeExports.jsxs(motion.header,{className:"flex items-center gap-2 relative",layout:!0,transition:{duration:.1},children:[jsxRuntimeExports.jsx("h2",{className:cx("flex-none","font-semibold"),children:He.title}),Qe,He.titleSlot&&He.titleSlot,He.toggle!=null&&jsxRuntimeExports.jsx(UISwitch,{isSelected:He.toggle,onChange:He.onToggle,className:"flex-none ml-auto"})]}),He.children&&He.toggle!==!1&&jsxRuntimeExports.jsx(motion.div,{className:cx("flex flex-col gap-2",He.title&&"mt-2"),layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},children:He.children})]})})}function createCtx(He){const Qe=()=>(console.error("Missing context provider!"),He),it=reactExports.createContext([He,Qe]);function lt(ut){return jsxRuntimeExports.jsx(it.Provider,{value:reactExports.useState(ut.defaultValue??He),...ut})}return[it,lt]}function createCtxReducer(He,Qe){const it=reactExports.createContext({state:Qe,dispatch:()=>{}});function lt(ut){const[dt,xt]=reactExports.useReducer(He,ut.defaultValue??Qe);return jsxRuntimeExports.jsx(it.Provider,{value:{state:dt,dispatch:xt},...ut})}return[it,lt]}const ImageItemListGroup={default:"default",i2vProTailFrame:"i2v-pro-tail-frame"},createImageItemListStateAtom=()=>atom({[ImageItemListGroup.default]:atom([]),[ImageItemListGroup.i2vProTailFrame]:atom([])}),MediaSelectPreviewPanelItemListContext=reactExports.createContext({}),useImageItemListValue=(He=ImageItemListGroup.default)=>{const Qe=reactExports.useContext(MediaSelectPreviewPanelItemListContext),it=useAtomValue(Qe);return useAtomValue(it[He])},useSetImageItemList=(He=ImageItemListGroup.default)=>{const Qe=reactExports.useContext(MediaSelectPreviewPanelItemListContext),it=useAtomValue(Qe);return useSetAtom(it[He])},useImageItemList=(He=ImageItemListGroup.default)=>{const Qe=reactExports.useContext(MediaSelectPreviewPanelItemListContext),it=useAtomValue(Qe);return useAtom(it[He])},useImageItemListCount=(He=ImageItemListGroup.default)=>useImageItemListValue(He).length,useImageItemListIsNotEmpty=(He=ImageItemListGroup.default)=>useImageItemListCount(He)>0,MediaSelectPreviewPanelItemsRefContext=reactExports.createContext({current:null});function MediaSelectPreviewPanelItemsRefContextProvider(He){const Qe=reactExports.useRef(new Map);return jsxRuntimeExports.jsx(MediaSelectPreviewPanelItemsRefContext.Provider,{value:Qe,children:He.children})}const[MediaSelectPreviewPanelItemsProgressContext,MediaSelectPreviewPanelItemsProgressContextProvider]=createCtx({});function MediaSelectPreviewPanelUploadProvider(He){return jsxRuntimeExports.jsx(MediaSelectPreviewPanelItemsRefContextProvider,{children:jsxRuntimeExports.jsx(MediaSelectPreviewPanelItemsProgressContextProvider,{children:He.children})})}function openMembershipFeatureDialog(He){UIDialog.create({dismissable:!0,className:"max-w-sm",heading:He.dialogTitle??jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership-only-feature-dialog.title"}),content:He.dialogBody,footer:({close:Qe})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIButton$1,{size:"large",className:"w-full text-white bg-gradient-purple-pink border-none",onPress:()=>{Qe(),openMembershipMoreCreditsModal({defaultMode:"plans",trackingLocation:He.trackingLocation})},children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership-only-feature-dialog.action.view-plans"})}),jsxRuntimeExports.jsx(UIButton$1,{className:"w-full border-0",onPress:()=>Qe(),children:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:feedback.early-access-dialog.action.may-be-later"})})]}),modalLayerProps:{className:"z-[1400]"}})}const QuotaBalance=({className:He,moreButtonState:Qe,trackingLocation:it,afterOpenMoreCredits:lt,...ut})=>{const{data:dt}=useUserInfo(),{data:xt,loading:ft}=useMyQuota(),vt=!dt,{t:kt}=useTranslation(["membership"]),St=useBreakpoint("msm");return jsxRuntimeExports.jsxs(Link,{className:cx("flex gap-1 items-center text-lg font-bold font-quicksand text-theme-primary",{"pointer-events-none":vt},He),...ut,to:`/@${dt?.username}/credits`,onClick:()=>{track("credit_balance_click",{location:it})},children:[jsxRuntimeExports.jsx(gameIconsCrystalBars,{className:"text-[1em]"}),jsxRuntimeExports.jsx("span",{children:!xt&&ft?"…":xt?.toLocaleString()}),!vt&&Qe!=="hidden"&&jsxRuntimeExports.jsxs("button",{className:cx("flex-none capitalize hover:bg-theme-primary hover:text-white rounded transition",Qe==="expanded"&&"p-1 pr-2 ml-1 flex items-center text-sm ring-1 ring-theme-primary"),onClick:Tt=>{Tt.preventDefault(),openMembershipMoreCreditsModal({scene:it,trackingLocation:it,defaultMode:"packs"}),lt?.()},children:[jsxRuntimeExports.jsx(mdiPlus,{className:"text-[1em]"}),Qe==="expanded"&&jsxRuntimeExports.jsx("span",{children:kt("membership:more-credits.label",{context:St?"short":null})})]})]})},QuotaCost=({value:He,className:Qe,loading:it,iconSize:lt,iconClassName:ut,valueClassName:dt,originalValue:xt,...ft})=>{if(He==null)return null;const vt=xt&&xt===He?void 0:xt,kt=typeof He=="number"?He.toLocaleString():He;return jsxRuntimeExports.jsxs("div",{className:cx("flex gap-2 items-center font-quicksand font-bold text-theme-primary",Qe),...ft,children:[jsxRuntimeExports.jsx(gameIconsCrystalBars,{className:cx("text-2xl",ut),style:{fontSize:lt}}),jsxRuntimeExports.jsxs("span",{className:cx(it&&"opacity-50 transition",dt),children:[kt,vt&&jsxRuntimeExports.jsx("span",{className:"ml-[0.25em] line-through opacity-80",children:vt.toLocaleString()})]})]})},radioGroupStyles=ce$1({base:"group relative"});function UIRadioGroup(He){return jsxRuntimeExports.jsxs($b6c3ddc6086f204d$export$a98f0dcb43a68a25,{...He,className:$64fa3d84918910a7$export$c245e6201fed2f75(He.className,(Qe,it)=>radioGroupStyles({...it,className:Qe})),children:[He.label,He.children]})}const radioStyles=ce$1({slots:{root:"group flex",radio:"shrink-0 place-content-center rounded-full me-1 border transition"},variants:{variant:{circle:{root:"items-center gap-1 before:size-[1.2em] before:border-2 before:border-black before:rounded-full before:transition-all",radio:"hidden"},"rounded-label-only":{root:"rounded-lg",radio:"hidden"},"rounded-radio":{root:["items-center","disabled:cursor-not-allowed"],radio:["grid items-center border-zinc-400 dark:border-zinc-400 shadow-sm","relative after:absolute after:rounded-full after:size-[10px] after:left-1/2 after:-translate-x-1/2 after:bg-transparent after:transition-colors","group-disabled:border-zinc-200 group-disabled:dark:border-zinc-600"]}},color:{theme:{},external:{}},isSelected:{true:""},size:{normal:{radio:"size-4"},small:{radio:"size-3  after:size-[6px]"}}},compoundVariants:[{variant:"circle",isSelected:!0,className:{root:"before:border-feat-brand-100 before:border-[0.4em]"}},{variant:["rounded-radio"],color:"theme",isSelected:!0,className:{radio:["after:bg-purple-600 after:hover:bg-purple-500 group-disabled:after:bg-purple-600/60"]}},{variant:["rounded-radio"],color:"external",isSelected:!0,className:{radio:["after:bg-[--radio-active] after:hover:[--radio-active-hover] group-disabled:after:[--radio-active-disabled]"]}}]});function UIRadio(He){const{variant:Qe,size:it,color:lt,className:ut,radioClassName:dt,children:xt,...ft}=He,vt=radioStyles({variant:Qe,size:it,color:lt});return jsxRuntimeExports.jsx($b6c3ddc6086f204d$export$d7b12c4107be0d61,{...ft,className:$64fa3d84918910a7$export$c245e6201fed2f75(ut,(kt,St)=>vt.root({...St,variant:Qe,className:kt})),children:kt=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:vt.radio({...kt,className:dt})}),xt]})})}const selectStyles=ce$1({slots:{root:"",button:"text-xs rounded-md border items-center",list:"bg-background w-full rounded-md border-[1px] border-card-border gap-0.5 flex flex-col py-1",selectValue:"flex [&>span]:flex-initial"},variants:{variant:{filled:{button:""}}}});function UISelect(He){const{children:Qe,items:it,labelSlot:lt,buttonClassName:ut,...dt}=He,xt=selectStyles({variant:He.variant});return jsxRuntimeExports.jsxs($82d7e5349645de74$export$ef9b1a59e592288f,{...dt,className:xt.root({className:He.className}),children:[lt,jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",size:"small",endIcon:jsxRuntimeExports.jsx("span",{"aria-hidden":"true",children:"▼"}),className:xt.button({className:ut}),children:jsxRuntimeExports.jsx($82d7e5349645de74$export$e288731fd71264f0,{className:xt.selectValue()})}),jsxRuntimeExports.jsx($07b14b47974efb58$export$5b6b19405a83ff9d,{children:jsxRuntimeExports.jsx($eed445e0843c11d0$export$41f133550aa26f48,{className:xt.list(),items:it,children:Qe})})]})}const selectItemStyles=ce$1({slots:{root:["flex items-center outline-none py-1.5 px-2 text-xs gap-1","hover:bg-neutral-50 dark:hover:bg-neutral-600 selected:bg-neutral-200 selected:dark:bg-neutral-700 overflow-hidden cursor-pointer selected:font-medium"],label:"flex-1",dropdownIcon:"ml-1 invisible"},variants:{isSelected:{true:{dropdownIcon:"visible"}}}});function UISelectItem({startIcon:He,children:Qe,...it}){const lt=selectItemStyles();return jsxRuntimeExports.jsx($eed445e0843c11d0$export$a11e76429ed99b4,{...it,className:lt.root({className:it.className}),children:$64fa3d84918910a7$export$c245e6201fed2f75(Qe,(ut,{isSelected:dt})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[He,jsxRuntimeExports.jsx("span",{className:lt.label({className:it.labelClassName}),children:ut}),jsxRuntimeExports.jsx(materialSymbolsCheck,{className:lt.dropdownIcon({isSelected:dt})})]}))})}const nativeStyle=ce$1({slots:{select:["appearance-none pl-1.5 pr-5 py-0.5","border outline-2 rounded-lg outline-offset-1 transition duration-75","hover:bg-black/5 border-black/50 focus:border-black/20 outline-black/80","disabled:text-black/40 disabled:border-black/20","dark:not-focus:hover:bg-white/5 dark:border-neutral-600 dark:focus:border-transparent dark:outline-neutral-400 dark:bg-background","col-start-1 row-start-1"],wrapper:["z-1","outline-none border-none",'grid grid-cols-1 grid-rows-1 items-center after:col-start-1 after:row-start-1 after:content-[""] after:w-2 after:h-1.5 after:bg-neutral-600 dark:after:bg-neutral-300 after:[clip-path:polygon(100%_0%,0_0%,50%_100%)] after:justify-self-end after:mr-2']}});function UISelectNative(He){const Qe=nativeStyle();return jsxRuntimeExports.jsx("div",{className:Qe.wrapper({className:He.className}),children:jsxRuntimeExports.jsx("select",{...He,className:Qe.select(),children:He.children})})}var store$2;function getGlobalConfig(He){return{lang:He?.lang??store$2?.lang,message:He?.message,abortEarly:He?.abortEarly??store$2?.abortEarly,abortPipeEarly:He?.abortPipeEarly??store$2?.abortPipeEarly}}var store2;function getGlobalMessage(He){return store2?.get(He)}var store3;function getSchemaMessage(He){return store3?.get(He)}var store4;function getSpecificMessage(He,Qe){return store4?.get(He)?.get(Qe)}function _stringify(He){const Qe=typeof He;return Qe==="string"?`"${He}"`:Qe==="number"||Qe==="bigint"||Qe==="boolean"?`${He}`:Qe==="object"||Qe==="function"?(He&&Object.getPrototypeOf(He)?.constructor?.name)??"null":Qe}function _addIssue(He,Qe,it,lt,ut){const dt=ut&&"input"in ut?ut.input:it.value,xt=ut?.expected??He.expects??null,ft=ut?.received??_stringify(dt),vt={kind:He.kind,type:He.type,input:dt,expected:xt,received:ft,message:`Invalid ${Qe}: ${xt?`Expected ${xt} but r`:"R"}eceived ${ft}`,requirement:He.requirement,path:ut?.path,issues:ut?.issues,lang:lt.lang,abortEarly:lt.abortEarly,abortPipeEarly:lt.abortPipeEarly},kt=He.kind==="schema",St=ut?.message??He.message??getSpecificMessage(He.reference,vt.lang)??(kt?getSchemaMessage(vt.lang):null)??lt.message??getGlobalMessage(vt.lang);St!==void 0&&(vt.message=typeof St=="function"?St(vt):St),kt&&(it.typed=!1),it.issues?it.issues.push(vt):it.issues=[vt]}function _getStandardProps(He){return{version:1,vendor:"valibot",validate(Qe){return He["~run"]({value:Qe},getGlobalConfig())}}}function _isValidObjectKey(He,Qe){return Object.hasOwn(He,Qe)&&Qe!=="__proto__"&&Qe!=="prototype"&&Qe!=="constructor"}function _joinExpects(He,Qe){const it=[...new Set(He)];return it.length>1?`(${it.join(` ${Qe} `)})`:it[0]??"never"}var ValiError=class extends Error{constructor(He){super(He[0].message),this.name="ValiError",this.issues=He}},ISO_DATE_REGEX=/^\d{4}-(?:0[1-9]|1[0-2])-(?:[12]\d|0[1-9]|3[01])$/u,ISO_TIMESTAMP_REGEX=/^\d{4}-(?:0[1-9]|1[0-2])-(?:[12]\d|0[1-9]|3[01])[T ](?:0\d|1\d|2[0-3])(?::[0-5]\d){2}(?:\.\d{1,9})?(?:Z|[+-](?:0\d|1\d|2[0-3])(?::?[0-5]\d)?)$/u;function isoDate(He){return{kind:"validation",type:"iso_date",reference:isoDate,async:!1,expects:null,requirement:ISO_DATE_REGEX,message:He,"~run"(Qe,it){return Qe.typed&&!this.requirement.test(Qe.value)&&_addIssue(this,"date",Qe,it),Qe}}}function isoTimestamp(He){return{kind:"validation",type:"iso_timestamp",reference:isoTimestamp,async:!1,expects:null,requirement:ISO_TIMESTAMP_REGEX,message:He,"~run"(Qe,it){return Qe.typed&&!this.requirement.test(Qe.value)&&_addIssue(this,"timestamp",Qe,it),Qe}}}function length(He,Qe){return{kind:"validation",type:"length",reference:length,async:!1,expects:`${He}`,requirement:He,message:Qe,"~run"(it,lt){return it.typed&&it.value.length!==this.requirement&&_addIssue(this,"length",it,lt,{received:`${it.value.length}`}),it}}}function maxLength(He,Qe){return{kind:"validation",type:"max_length",reference:maxLength,async:!1,expects:`<=${He}`,requirement:He,message:Qe,"~run"(it,lt){return it.typed&&it.value.length>this.requirement&&_addIssue(this,"length",it,lt,{received:`${it.value.length}`}),it}}}function transform$1(He){return{kind:"transformation",type:"transform",reference:transform$1,async:!1,operation:He,"~run"(Qe){return Qe.value=this.operation(Qe.value),Qe}}}function getFallback(He,Qe,it){return typeof He.fallback=="function"?He.fallback(Qe,it):He.fallback}function getDefault(He,Qe,it){return typeof He.default=="function"?He.default(Qe,it):He.default}function array(He,Qe){return{kind:"schema",type:"array",reference:array,expects:"Array",async:!1,item:He,message:Qe,get"~standard"(){return _getStandardProps(this)},"~run"(it,lt){const ut=it.value;if(Array.isArray(ut)){it.typed=!0,it.value=[];for(let dt=0;dt<ut.length;dt++){const xt=ut[dt],ft=this.item["~run"]({value:xt},lt);if(ft.issues){const vt={type:"array",origin:"value",input:ut,key:dt,value:xt};for(const kt of ft.issues)kt.path?kt.path.unshift(vt):kt.path=[vt],it.issues?.push(kt);if(it.issues||(it.issues=ft.issues),lt.abortEarly){it.typed=!1;break}}ft.typed||(it.typed=!1),it.value.push(ft.value)}}else _addIssue(this,"type",it,lt);return it}}}function boolean(He){return{kind:"schema",type:"boolean",reference:boolean,expects:"boolean",async:!1,message:He,get"~standard"(){return _getStandardProps(this)},"~run"(Qe,it){return typeof Qe.value=="boolean"?Qe.typed=!0:_addIssue(this,"type",Qe,it),Qe}}}function literal(He,Qe){return{kind:"schema",type:"literal",reference:literal,expects:_stringify(He),async:!1,literal:He,message:Qe,get"~standard"(){return _getStandardProps(this)},"~run"(it,lt){return it.value===this.literal?it.typed=!0:_addIssue(this,"type",it,lt),it}}}function looseObject(He,Qe){return{kind:"schema",type:"loose_object",reference:looseObject,expects:"Object",async:!1,entries:He,message:Qe,get"~standard"(){return _getStandardProps(this)},"~run"(it,lt){const ut=it.value;if(ut&&typeof ut=="object"){it.typed=!0,it.value={};for(const dt in this.entries){const xt=this.entries[dt];if(dt in ut||(xt.type==="exact_optional"||xt.type==="optional"||xt.type==="nullish")&&xt.default!==void 0){const ft=dt in ut?ut[dt]:getDefault(xt),vt=xt["~run"]({value:ft},lt);if(vt.issues){const kt={type:"object",origin:"value",input:ut,key:dt,value:ft};for(const St of vt.issues)St.path?St.path.unshift(kt):St.path=[kt],it.issues?.push(St);if(it.issues||(it.issues=vt.issues),lt.abortEarly){it.typed=!1;break}}vt.typed||(it.typed=!1),it.value[dt]=vt.value}else if(xt.fallback!==void 0)it.value[dt]=getFallback(xt);else if(xt.type!=="exact_optional"&&xt.type!=="optional"&&xt.type!=="nullish"&&(_addIssue(this,"key",it,lt,{input:void 0,expected:`"${dt}"`,path:[{type:"object",origin:"key",input:ut,key:dt,value:ut[dt]}]}),lt.abortEarly))break}if(!it.issues||!lt.abortEarly)for(const dt in ut)_isValidObjectKey(ut,dt)&&!(dt in this.entries)&&(it.value[dt]=ut[dt])}else _addIssue(this,"type",it,lt);return it}}}function null_(He){return{kind:"schema",type:"null",reference:null_,expects:"null",async:!1,message:He,get"~standard"(){return _getStandardProps(this)},"~run"(Qe,it){return Qe.value===null?Qe.typed=!0:_addIssue(this,"type",Qe,it),Qe}}}function nullable(He,Qe){return{kind:"schema",type:"nullable",reference:nullable,expects:`(${He.expects} | null)`,async:!1,wrapped:He,default:Qe,get"~standard"(){return _getStandardProps(this)},"~run"(it,lt){return it.value===null&&(this.default!==void 0&&(it.value=getDefault(this,it,lt)),it.value===null)?(it.typed=!0,it):this.wrapped["~run"](it,lt)}}}function nullish(He,Qe){return{kind:"schema",type:"nullish",reference:nullish,expects:`(${He.expects} | null | undefined)`,async:!1,wrapped:He,default:Qe,get"~standard"(){return _getStandardProps(this)},"~run"(it,lt){return(it.value===null||it.value===void 0)&&(this.default!==void 0&&(it.value=getDefault(this,it,lt)),it.value===null||it.value===void 0)?(it.typed=!0,it):this.wrapped["~run"](it,lt)}}}function number(He){return{kind:"schema",type:"number",reference:number,expects:"number",async:!1,message:He,get"~standard"(){return _getStandardProps(this)},"~run"(Qe,it){return typeof Qe.value=="number"&&!isNaN(Qe.value)?Qe.typed=!0:_addIssue(this,"type",Qe,it),Qe}}}function object(He,Qe){return{kind:"schema",type:"object",reference:object,expects:"Object",async:!1,entries:He,message:Qe,get"~standard"(){return _getStandardProps(this)},"~run"(it,lt){const ut=it.value;if(ut&&typeof ut=="object"){it.typed=!0,it.value={};for(const dt in this.entries){const xt=this.entries[dt];if(dt in ut||(xt.type==="exact_optional"||xt.type==="optional"||xt.type==="nullish")&&xt.default!==void 0){const ft=dt in ut?ut[dt]:getDefault(xt),vt=xt["~run"]({value:ft},lt);if(vt.issues){const kt={type:"object",origin:"value",input:ut,key:dt,value:ft};for(const St of vt.issues)St.path?St.path.unshift(kt):St.path=[kt],it.issues?.push(St);if(it.issues||(it.issues=vt.issues),lt.abortEarly){it.typed=!1;break}}vt.typed||(it.typed=!1),it.value[dt]=vt.value}else if(xt.fallback!==void 0)it.value[dt]=getFallback(xt);else if(xt.type!=="exact_optional"&&xt.type!=="optional"&&xt.type!=="nullish"&&(_addIssue(this,"key",it,lt,{input:void 0,expected:`"${dt}"`,path:[{type:"object",origin:"key",input:ut,key:dt,value:ut[dt]}]}),lt.abortEarly))break}}else _addIssue(this,"type",it,lt);return it}}}function optional(He,Qe){return{kind:"schema",type:"optional",reference:optional,expects:`(${He.expects} | undefined)`,async:!1,wrapped:He,default:Qe,get"~standard"(){return _getStandardProps(this)},"~run"(it,lt){return it.value===void 0&&(this.default!==void 0&&(it.value=getDefault(this,it,lt)),it.value===void 0)?(it.typed=!0,it):this.wrapped["~run"](it,lt)}}}function picklist(He,Qe){return{kind:"schema",type:"picklist",reference:picklist,expects:_joinExpects(He.map(_stringify),"|"),async:!1,options:He,message:Qe,get"~standard"(){return _getStandardProps(this)},"~run"(it,lt){return this.options.includes(it.value)?it.typed=!0:_addIssue(this,"type",it,lt),it}}}function record(He,Qe,it){return{kind:"schema",type:"record",reference:record,expects:"Object",async:!1,key:He,value:Qe,message:it,get"~standard"(){return _getStandardProps(this)},"~run"(lt,ut){const dt=lt.value;if(dt&&typeof dt=="object"){lt.typed=!0,lt.value={};for(const xt in dt)if(_isValidObjectKey(dt,xt)){const ft=dt[xt],vt=this.key["~run"]({value:xt},ut);if(vt.issues){const St={type:"object",origin:"key",input:dt,key:xt,value:ft};for(const Tt of vt.issues)Tt.path=[St],lt.issues?.push(Tt);if(lt.issues||(lt.issues=vt.issues),ut.abortEarly){lt.typed=!1;break}}const kt=this.value["~run"]({value:ft},ut);if(kt.issues){const St={type:"object",origin:"value",input:dt,key:xt,value:ft};for(const Tt of kt.issues)Tt.path?Tt.path.unshift(St):Tt.path=[St],lt.issues?.push(Tt);if(lt.issues||(lt.issues=kt.issues),ut.abortEarly){lt.typed=!1;break}}(!vt.typed||!kt.typed)&&(lt.typed=!1),vt.typed&&(lt.value[vt.value]=kt.value)}}else _addIssue(this,"type",lt,ut);return lt}}}function strictObject(He,Qe){return{kind:"schema",type:"strict_object",reference:strictObject,expects:"Object",async:!1,entries:He,message:Qe,get"~standard"(){return _getStandardProps(this)},"~run"(it,lt){const ut=it.value;if(ut&&typeof ut=="object"){it.typed=!0,it.value={};for(const dt in this.entries){const xt=this.entries[dt];if(dt in ut||(xt.type==="exact_optional"||xt.type==="optional"||xt.type==="nullish")&&xt.default!==void 0){const ft=dt in ut?ut[dt]:getDefault(xt),vt=xt["~run"]({value:ft},lt);if(vt.issues){const kt={type:"object",origin:"value",input:ut,key:dt,value:ft};for(const St of vt.issues)St.path?St.path.unshift(kt):St.path=[kt],it.issues?.push(St);if(it.issues||(it.issues=vt.issues),lt.abortEarly){it.typed=!1;break}}vt.typed||(it.typed=!1),it.value[dt]=vt.value}else if(xt.fallback!==void 0)it.value[dt]=getFallback(xt);else if(xt.type!=="exact_optional"&&xt.type!=="optional"&&xt.type!=="nullish"&&(_addIssue(this,"key",it,lt,{input:void 0,expected:`"${dt}"`,path:[{type:"object",origin:"key",input:ut,key:dt,value:ut[dt]}]}),lt.abortEarly))break}if(!it.issues||!lt.abortEarly){for(const dt in ut)if(!(dt in this.entries)){_addIssue(this,"key",it,lt,{input:dt,expected:"never",path:[{type:"object",origin:"key",input:ut,key:dt,value:ut[dt]}]});break}}}else _addIssue(this,"type",it,lt);return it}}}function string(He){return{kind:"schema",type:"string",reference:string,expects:"string",async:!1,message:He,get"~standard"(){return _getStandardProps(this)},"~run"(Qe,it){return typeof Qe.value=="string"?Qe.typed=!0:_addIssue(this,"type",Qe,it),Qe}}}function _subIssues(He){let Qe;if(He)for(const it of He)Qe?Qe.push(...it.issues):Qe=it.issues;return Qe}function union(He,Qe){return{kind:"schema",type:"union",reference:union,expects:_joinExpects(He.map(it=>it.expects),"|"),async:!1,options:He,message:Qe,get"~standard"(){return _getStandardProps(this)},"~run"(it,lt){let ut,dt,xt;for(const ft of this.options){const vt=ft["~run"]({value:it.value},lt);if(vt.typed)if(vt.issues)dt?dt.push(vt):dt=[vt];else{ut=vt;break}else xt?xt.push(vt):xt=[vt]}if(ut)return ut;if(dt){if(dt.length===1)return dt[0];_addIssue(this,"type",it,lt,{issues:_subIssues(dt)}),it.typed=!0}else{if(xt?.length===1)return xt[0];_addIssue(this,"type",it,lt,{issues:_subIssues(xt)})}return it}}}function unknown(){return{kind:"schema",type:"unknown",reference:unknown,expects:"unknown",async:!1,get"~standard"(){return _getStandardProps(this)},"~run"(He){return He.typed=!0,He}}}function parse(He,Qe,it){const lt=He["~run"]({value:Qe},getGlobalConfig(it));if(lt.issues)throw new ValiError(lt.issues);return lt.value}function partial(He,Qe){const it={};for(const lt in He.entries)it[lt]=optional(He.entries[lt]);return{...He,entries:it,get"~standard"(){return _getStandardProps(this)}}}function pipe(...He){return{...He[0],pipe:He,get"~standard"(){return _getStandardProps(this)},"~run"(Qe,it){for(const lt of He)if(lt.kind!=="metadata"){if(Qe.issues&&(lt.kind==="schema"||lt.kind==="transformation")){Qe.typed=!1;break}(!Qe.issues||!it.abortEarly&&!it.abortPipeEarly)&&(Qe=lt["~run"](Qe,it))}return Qe}}}function safeParse(He,Qe,it){const lt=He["~run"]({value:Qe},getGlobalConfig(it));return{typed:lt.typed,success:!lt.issues,output:lt.value,issues:lt.issues}}const QualityTagSchema=object({prefix:optional(pipe(string(),maxLength(256))),suffix:optional(pipe(string(),maxLength(256)))}),TaskParametersWorkflowSchema=looseObject({priority:number(),workflowId:string(),workflowName:string(),workflowVersionId:string(),inputs:record(string(),unknown())}),TaskParametersI2vProSchema=looseObject({width:number(),height:number(),modelId:optional(string()),priority:number(),i2vPro:object({mode:optional(picklist(["basic","professional"])),model:string(),mediaId:string(),tailMediaId:optional(string()),prompts:optional(string()),duration:optional(picklist(["5","10"])),negativePrompts:optional(string()),cameraMovement:optional(string()),usePromptsHelper:optional(boolean()),controlMediaId:optional(string()),controlMediaType:optional(string())}),extra:optional(object({naturalPrompts:optional(string()),referenceImagePrompts:optional(string())})),sceneId:optional(string())}),TaskParametersGeneratorSchema=looseObject({priority:optional(number()),seed:optional(union([string(),number()])),width:number(),height:number(),mediaId:optional(string()),modelId:optional(string()),prompts:optional(string()),cfgScale:optional(number()),samplingSteps:optional(number()),samplingMethod:optional(string()),negativePrompts:optional(string()),sceneId:optional(string()),clipSkip:optional(number()),batchSize:optional(number()),controlNets:optional(array(looseObject({type:string(),mediaId:string(),weight:optional(number()),thresholdA:optional(number()),maskMediaId:optional(string())}))),qualityTag:optional(QualityTagSchema),lightning:optional(boolean()),upscale:optional(number()),upscaleDenoisingSteps:optional(number()),upscaleDenoisingStrength:optional(number()),enlarge:optional(number()),enlargeModel:optional(string()),enableADetailer:optional(boolean()),styleMix:optional(object({enabled:optional(boolean()),seed:optional(number())})),inferenceConfig:optional(object({rescaleCFG:optional(union([number(),null_()])),modelSampling:optional(object({inputs:optional(object({shift:optional(number())}))}))})),promptHelper:optional(object({withStage:optional(boolean()),userWantToEnable:optional(boolean()),enable:optional(boolean())}))}),TaskParametersT2i2vSchema=looseObject({...TaskParametersGeneratorSchema.entries,t2i2v:looseObject({duration:optional(string(),"5"),model:optional(string(),"v2.5.1")})}),riVideoAiLine=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m19.713 8.128l-.246.566a.506.506 0 0 1-.934 0l-.246-.566a4.36 4.36 0 0 0-2.22-2.25l-.759-.339a.53.53 0 0 1 0-.963l.717-.319a4.37 4.37 0 0 0 2.251-2.326l.253-.611a.506.506 0 0 1 .942 0l.253.61a4.37 4.37 0 0 0 2.25 2.327l.718.32a.53.53 0 0 1 0 .962l-.76.338a4.36 4.36 0 0 0-2.219 2.251M3.993 3H13v2H5v14h14v-8h2v9.007a.994.994 0 0 1-.993.993H3.993A.993.993 0 0 1 3 20.007V3.993C3 3.445 3.445 3 3.993 3m6.629 5.415l4.879 3.252a.4.4 0 0 1 0 .666l-4.88 3.252a.4.4 0 0 1-.621-.332V8.747a.4.4 0 0 1 .622-.332"})});async function toastAwaitAll(He,Qe,it){const lt=toast.info(He,{...it,progress:0});let ut=0;for(const dt of Qe)dt instanceof Promise&&dt.finally(()=>{ut++,toast.update(lt,{progress:ut/Qe.length})});try{return await Promise.all(Qe)}finally{toast.dismiss(lt)}}function generateAssetIdFromMedia(He,Qe){const it=getPublicUrl(Qe);invariant(it,"Media has no url");const lt=AssetRecordType.createId(Qe.id);return He.createAssets([{id:lt,type:"image",typeName:"asset",props:{name:"Generated Image "+lt,src:it,w:Qe.width??0,h:Qe.height??0,mimeType:Qe.imageType||"image/png",isAnimated:!1},meta:{mediaId:Qe.id,media:Qe}}]),new Image().src=it,lt}async function generateAssetIdsFromTask(He,Qe){return(await toastAwaitAll("Loading images...",getMediaIdsFromTask(Qe).map(lt=>fetchGetMedia({id:lt})))).map(lt=>lt.data.media).filter(lt=>lt!=null).map(lt=>generateAssetIdFromMedia(He,lt))}function createFillEditorContextUtils(){let He=null;const Qe=[],it=dt=>{He?dt(He):Qe.push(dt)};return{get editor(){return He},set editor(dt){if(He!==dt&&(He=dt,He)){for(const xt of Qe)try{xt(He)}catch(ft){console.error(ft)}Qe.length=0}},queueOp:it,setBaseImageFromMedia:(dt,{task:xt,cate:ft}={})=>it(vt=>{const kt=createShapeId(),St=generateAssetIdFromMedia(vt,dt);vt.deleteShapes([...vt.getCurrentPageShapeIds()]).createShape({id:kt,type:"genmedia",x:0,y:0,props:{w:dt.width??0,h:dt.height??0,prompts:xt?.parameters.prompts||null,currentAssetId:St,assetIds:[St],pending:null},meta:{generationTask:JSON.parse(JSON.stringify(xt??null)),pixai_isBaseImage:!0}}).select(kt).zoomToBounds(vt.getShapePageBounds(kt)),track("panel_image_import",{scene:"fill",cate:ft})}),setBaseImageFromFile:(dt,{cate:xt}={})=>it(async ft=>{const vt=createShapeId(),kt=await ft.getAssetForExternalContent({type:"file",file:dt});invariant(kt,"Failed to get asset for file"),invariant(kt.type==="image","Asset type is not an image"),ft.deleteShapes([...ft.getCurrentPageShapeIds()]).createAssets([kt]).createShape({id:vt,type:"image",x:0,y:0,props:{w:kt.props.w??0,h:kt.props.h??0,assetId:kt.id},meta:{pixai_isBaseImage:!0}}).select(vt).zoomToBounds(ft.getShapePageBounds(vt)),track("panel_image_import",{scene:"fill",cate:xt})})}}const[GeneratedItemsContext,GeneratedItemsContextProvider]=createCtx([]);GeneratedItemsContext.displayName="GeneratedItemsContext";const[SelectedTaskContext,SelectedTaskContextProvider]=createCtx({});SelectedTaskContext.displayName="SelectedTaskContext";const[HoveredItemContext,HoveredItemContextProvider]=createCtx(void 0);HoveredItemContext.displayName="HoveredItemContext";const[OpenHistoryPanelContext,OpenHistoryPanelContextProvider]=createCtx({open:!1});OpenHistoryPanelContext.displayName="OpenHistoryPanelContext";const[ImageEditorContext,ImageEditorContextProvider]=createCtx({showEditor:!1,isInpaintOn:!1,dirty:!1});ImageEditorContext.displayName="ImageEditorContext";const[LastImportedItemContext,LastImportedItemContextProvider]=createCtx(void 0),[InitialValueLoadedContext,InitialValueLoadedContextProvider]=createCtx(!1),FillEditorContext=reactExports.createContext({current:createFillEditorContextUtils()});FillEditorContext.displayName="FillEditorContext";const[FillEditorGenParamsContext,FillEditorGenParamsContextProvider]=createCtx({inputPrompts:"",originalPrompts:""});function generatorModeFromParamsTab(He){return $$3(He).with("editor",()=>GeneratorMode.Fill).with("enhancement",()=>GeneratorMode.EnhanceImage).with("animation",()=>GeneratorMode.ImageToVideo).otherwise(()=>GeneratorMode.Generate)}function createGeneratorModeUrl(He){switch(He){case GeneratorMode.Fill:return"/generator/image/editor";case GeneratorMode.EnhanceImage:return"/generator/image/enhancement";case GeneratorMode.ImageToVideo:return"/generator/image/animation";default:return"/pixai"}}var GeneratorType=(He=>(He.Image="image",He.Realtime="realtime",He.AnimatedComic="animated-comic",He.Upscaler="upscaler",He.ImageStitching="image-sticthing",He.ChatEditing="chat-editing",He.ChatEditingPreset="preset",He))(GeneratorType||{});const[GeneratorContext,GeneratorContextProvider]=createCtxReducer((He,Qe)=>{switch(Qe.type){case"set-mode":return He.navigate?.(createGeneratorModeUrl(Qe.value)),He;case"set-mode-value":return{...He,mode:Qe.value};case"set-type":return{...He,type:Qe.value}}throw new Error(`Unknown action type ${Qe.type}`)},{navigate:void 0,mode:GeneratorMode.Generate,type:"image"}),myTasksAtom=atom([]),useSetTaskInMyTasks=()=>{const He=useSetAtom(myTasksAtom);function Qe(dt){He(xt=>{const ft=xt.slice(),vt=ft.findIndex(kt=>kt.id===dt.id);return vt>=0?ft.splice(vt,1,dt):ft.push(dt),ft})}function it(dt,xt){He(ft=>{const vt=ft.slice(),kt=vt.findIndex(St=>St.id===dt);if(kt>=0){const St=ft[kt],Tt=xt(St);vt.splice(kt,1,Tt)}return vt})}function lt(dt){He(xt=>{const ft=xt.slice(),vt=ft.findIndex(kt=>kt.id===dt);return vt>=0&&ft.splice(vt,1),ft})}function ut(dt,xt){const ft=xt.type==="favorite"?"favoritedAt":"deletedAt";return!xt.mediaId&&xt.type==="delete"&&xt.target?lt(dt):it(dt,vt=>{if(xt.mediaId&&vt.outputs.batch){const kt=[...vt.outputs.batch],St=kt.findIndex(Tt=>Tt.mediaId===xt.mediaId);return St>=0?(kt[St]={...kt[St],[ft]:xt.target?new Date().toISOString():void 0},{...vt,outputs:{...vt.outputs,batch:kt}}):vt}return{...vt,[ft]:xt.target?new Date().toISOString():void 0}})}return{setTask:Qe,updateTask:it,updateTaskFavoriteDelete:ut}},GeneratorControlsRefContext=reactExports.createContext({current:null});function GeneratorControlsRefContextProvider(He){const Qe=reactExports.useRef({});return jsxRuntimeExports.jsx(GeneratorControlsRefContext.Provider,{value:Qe,children:He.children})}const[ChannelContext,ChannelContextProvider]=createCtx("normal"),icRoundWarning=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M4.47 21h15.06c1.54 0 2.5-1.67 1.73-3L13.73 4.99c-.77-1.33-2.69-1.33-3.46 0L2.74 18c-.77 1.33.19 3 1.73 3zM12 14c-.55 0-1-.45-1-1v-2c0-.55.45-1 1-1s1 .45 1 1v2c0 .55-.45 1-1 1zm1 4h-2v-2h2v2z"})});var ControlSectionMessageType=(He=>(He[He.Message=0]="Message",He[He.Warning=1]="Warning",He))(ControlSectionMessageType||{});function ControlSectionMessage(He){const Qe=He.type||0;return jsxRuntimeExports.jsxs("p",{className:cx("p-2 leading-5 flex rounded-md select-none",$$3(Qe).with(1,()=>"bg-amber-100 dark:bg-amber-500/10 text-amber-600 dark:text-amber-500").otherwise(()=>null),He.className),style:He.style,children:[$$3(Qe).with(1,()=>jsxRuntimeExports.jsx(icRoundWarning,{className:"flex-none w-5 h-5 inline-block mr-1"})).otherwise(()=>null),He.children]})}function HelpImage(He){return jsxRuntimeExports.jsx("div",{className:(He.className??"")+" rounded-lg overflow-hidden",children:jsxRuntimeExports.jsx("img",{src:He.src,alt:He.alt,className:"w-full h-full object-contain",loading:"lazy"})})}function ActionPresetsHelp(){return jsxRuntimeExports.jsxs("div",{className:"w-[480px] max-w-[min(80vw,480px)]",children:[jsxRuntimeExports.jsxs("div",{className:"mb-3",children:[jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold mb-2",children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:image-to-video.action-presets.help.recommended.title"})}),jsxRuntimeExports.jsx("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 whitespace-pre-line",children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:image-to-video.action-presets.help.recommended.description"})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[jsxRuntimeExports.jsx(HelpImage,{src:"https://images-ng.pixai.art/images/orig/adf87053-d34b-46fb-b2ca-828b5e899fcf",alt:"Recommended example 1",className:"aspect-[3/4] w-full"}),jsxRuntimeExports.jsx(HelpImage,{src:"https://images-ng.pixai.art/images/orig/d72604dd-e980-4c3b-bc6b-a39c9d470a34",alt:"Recommended example 2",className:"aspect-[3/4] w-full"})]}),jsxRuntimeExports.jsx("div",{className:"mb-2",children:jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold",children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:image-to-video.action-presets.help.not-recommended.title"})})}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(HelpImage,{src:"https://images-ng.pixai.art/images/orig/6fb8c01e-88e9-4e71-a389-c98b93db720c",alt:"Not recommended example 1",className:"aspect-[3/4] w-full"}),jsxRuntimeExports.jsx(HelpImage,{src:"https://images-ng.pixai.art/images/orig/df9ad4b3-398d-47c6-90bd-71f8f255b4dc",alt:"Not recommended example 2",className:"aspect-[3/4] w-full"})]})]})}var floorWith=(He,Qe)=>(He/Qe<<0)*Qe,PriceType={prepaid:"prepaid",postpaid:"postpaid"},getPriceMeter=()=>{const He=[];return{type:PriceType.prepaid,items:He,curPrice:0,discount:0,exp:"",addItem(Qe,{explanation:it,name:lt,spec:ut,...dt}={}){const xt=Qe(this.curPrice)-this.curPrice<<0;lt!=null&&ut!=null&&He.push({name:lt,spec:ut,...dt,totalPrice:xt}),it&&(this.exp=it(this.exp)),this.curPrice+=xt,xt<0&&(this.discount-=xt)},toPriceInfo(){return{type:this.type,items:He,originalPrice:Math.max(0,this.curPrice+this.discount),actualPrice:Math.max(0,this.curPrice)}}}},defaults=(He,Qe)=>{const it={...Qe};for(const lt in He)it[lt]==null&&(it[lt]=He[lt]);return it},cloneParameters=He=>JSON.parse(JSON.stringify(He)),isDITModelType=He=>He?.startsWith("DIT5")||He?.startsWith("DIT7"),GenerationModelTypeSubSet={SdxlModel:"SDXL_MODEL",Sd3MediumModel:"SD3_MEDIUM_MODEL"},PriorityChannel={TurboModePriority:500,HighPriority:1e3,XHighPriority:1500},ParametersDefaults={width:512,height:512,samplingSteps:28,samplingMethod:"Euler a",priority:PriorityChannel.HighPriority,strength:.7,upscale:1,batchSize:1,enableTile:!1,controlNets:[],enlarge:0},Pricing=class{parameters;config;constructor(He,Qe){this.parameters=defaults(ParametersDefaults,He),this.config=defaults({baseStep:20,baseWidth:512,baseHeight:512,basePrice:400,maxDiscount:800,samplerMultiple:{},sdxlMultiple:1.25,sd3MediumMultiple:1.625,ditMinPrice:1e3,minPrice:200,priorityLastCutOff:17583264e5,highPriority:PriorityChannel.HighPriority,xHighPriority:PriorityChannel.XHighPriority,shouldDiscount:!1,isSDXL:!1,isSD3Medium:!1,modelType:""},Qe)}_getBasePrice(He){const{basePrice:Qe,modelType:it}={...this.config,...He};let lt=Qe;if(isDITModelType(it))if(this.parameters.mediaId)lt=Qe*2;else{const{width:ut,height:dt,samplingSteps:xt}=this.parameters,vt=[[768,1280],[1280,768],[1024,1024]].some(([Tt,Mt])=>Tt===ut&&Mt===dt),kt=xt>=20&&xt<=25;lt=Qe*(vt&&kt?1.5:1.6)}return lt}_getMeterWithBasePrice(He){const Qe=this._getBasePrice(He),it=getPriceMeter();return it.addItem(()=>Qe,{key:"generate-image",name:"generate image",spec:"",explanation:()=>`${Qe}_{\\text{ base price }}`,description:"base price",expression:`+${Qe}`}),it}_animateDiffPrice(He,Qe,it){const{width:lt,height:ut,animateDiff:dt}=Qe,{baseWidth:xt,baseHeight:ft}={...this.config,...it},vt=Math.min(1,768/Math.max(ut,lt)),kt=lt*ut*vt*vt/xt/ft;if(kt!==1&&He.addItem(St=>St*kt,{key:"size",name:"size",spec:`x${kt.toFixed(2)}`,explanation:St=>`${St} \\times {${kt}}_{\\text{ size power }}`,expression:`x${kt.toFixed(2)}`,description:"size power"}),dt.v2)He.addItem(St=>St*16,{key:"animate-v2",name:"animate-v2",spec:"x16",expression:"x16",description:"animate v2 power"});else{const St=dt.smooth?25:10;He.addItem(Mt=>Mt*St,{key:"animate",name:"animate",spec:`x${St}`,expression:`x${St}`,description:"animate power"});const Tt=dt.long?3:1;Tt!==1&&He.addItem(Mt=>Mt*Tt,{key:"animate-long",name:"long animation",spec:`x${Tt}`,expression:`x${Tt}`,description:"animate long"})}return He}_diffusePrice(He,Qe,it){let{width:lt,height:ut,samplingSteps:dt,upscaleDenoisingSteps:xt=dt,samplingMethod:ft,mediaId:vt,strength:kt,upscale:St,batchSize:Tt,enableTile:Mt,controlNets:Nt,lightning:At}=Qe,$t=St;(!Number.isFinite($t)||$t<1)&&($t=1);const{baseStep:Dt,baseWidth:Ft,baseHeight:Bt,samplerMultiple:Ot,floorBeforeTimesBatchSize:Qt,sdxlMultiple:Wt,sd3MediumMultiple:Xt,isSDXL:Kt,isSD3Medium:Jt,modelType:hr}={...this.config,...it};At&&(dt=14,xt=14,ft="");const xr=Mt?1:lt*ut*$t*$t/Ft/Bt;let gr=dt;vt?gr=1+kt*dt:$t>1?gr=xt:gr=dt;const br=gr/Dt,vr=Ot[ft]??1;if(isDITModelType(hr)){const yr=Wt;He.addItem(Cr=>Cr*yr,{key:"dit",name:"dit",spec:`x${yr}`,explanation:Cr=>`${Cr} \\times {${yr}}_{\\text{ dit }}`,expression:`x${yr}`,description:"dit multiple"})}else Kt||hr===GenerationModelTypeSubSet.SdxlModel?He.addItem(yr=>yr*Wt,{key:"sdxl",name:"sdxl",spec:`x${Wt}`,explanation:yr=>`${yr} \\times {${Wt}}_{\\text{ sdxl }}`,expression:`x${Wt}`,description:"sdxl multiple"}):(Jt||hr===GenerationModelTypeSubSet.Sd3MediumModel)&&He.addItem(yr=>yr*Xt,{key:"sd3m",name:"sd3m",spec:`x${Xt}`,explanation:yr=>`${yr} \\times {${Xt}}_{\\text{ sd3m }}`,expression:`x${Xt}`,description:"sd3 medium multiple"});return xr!==1&&He.addItem(yr=>yr*xr,{key:"size",name:"size",spec:`x${xr.toFixed(2)}`,explanation:yr=>`${yr} \\times {${xr}}_{\\text{ size power }}`,expression:`x${xr.toFixed(2)}`,description:"size power"}),br!==1&&He.addItem(yr=>yr*br,{key:"sampling-steps",name:"sampling steps",spec:`x${br.toFixed(2)}`,explanation:yr=>`${yr} \\times {${br}}_{\\text{ step power }}`,expression:`x${br.toFixed(2)}`,description:"step power"}),vr!==1&&He.addItem(yr=>yr*vr,{key:"sampling-method",name:"sampling method",spec:`x${vr}`,explanation:yr=>`${yr} \\times {${vr}}_{\\text{ sampler power }}`,expression:`x${vr.toFixed(2)}`,description:"sampler power"}),Array.isArray(Nt)&&Nt.length&&He.addItem(yr=>yr*1.4**(Nt.length-1),{key:"control-nets",name:"control nets",spec:`x${Nt.length}`,explanation:yr=>`${yr} \\times {1.4^{${Nt.length-1}}} {\\text{ control nets }}`,expression:`x1.4^${Nt.length-1}`,description:"control nets"}),Qt&&He.addItem(yr=>floorWith(yr,100),{key:"floor",name:"floor",spec:"",explanation:yr=>`\\lfloor{${yr}}\\rfloor`,description:"round down to 100",hidden:!0}),Tt!==1&&He.addItem(yr=>yr*Tt,{key:"batch-size",name:"batch size",spec:`x${Tt}`,explanation:yr=>`(${yr}) \\times {${Tt}}_{\\text{ batch size }}`,expression:`x${Tt}`,description:"batch size"}),He}_priorityChannelPrice(He,Qe){const{priority:it}=this.parameters,{highPriority:lt,xHighPriority:ut}={...this.config,...Qe};(it===lt||it===ut)&&He.addItem(dt=>dt+it,{key:"task-priority",name:"priority channel",spec:"",explanation:dt=>`${dt} + ${it}_{\\text{ priority }}`,expression:`+${it}`,description:"priority"})}isAnimateDiff(He){return He.animateDiff!=null&&He.animateDiff.enabled}_pricingBaseParameters(He,Qe,it){const{height:lt,width:ut,enlarge:dt,upscale:xt,enableTile:ft,batchSize:vt,enableADetailer:kt,modelId:St,ipAdapter:Tt}=Qe,{baseHeight:Mt,baseWidth:Nt,maxDiscount:At,shouldDiscount:$t,modelVersionDiscount:Dt,minPrice:Ft,ditMinPrice:Bt,modelType:Ot,priorityLastCutOff:Qt}={...this.config,...it},Wt=this._getBasePrice(it);if(this.isAnimateDiff(Qe)){this._animateDiffPrice(He,Qe,it);const Kt=.5;He.addItem(Jt=>Jt*Kt,{key:"animate-discount",name:"animate discount",spec:`x${Kt*100}%`,explanation:Jt=>`${Jt} \\times {${Kt}}_{\\text{ discount }}`,expression:`x${Kt.toFixed(2)}`,description:"animate discount"})}else if(!(dt>1))if(ft&&xt>1){const Kt=this._getMeterWithBasePrice(),Jt=Math.ceil(lt*ut*xt*xt/Mt/Nt);this._diffusePrice(Kt,Qe,it);const hr=Kt.toPriceInfo();He.addItem(xr=>xr+hr.actualPrice*Jt,{key:"tile",name:"tile",unitPrice:hr.actualPrice,spec:`x${Jt}`,items:hr.items,explanation:xr=>`\\def\\tilePrice{${xr}} tilePrice \\times ${Jt}_{\\text{ tile times }}`,expression:`+${hr.actualPrice}x${Jt}`,description:"tile"})}else if(xt>1){this._diffusePrice(He,{...Qe,upscale:1},it);const{modelType:Kt}={...this.config,...it};let Jt;isDITModelType(Kt)?Jt=this._getMeterWithBasePrice({...it,modelType:GenerationModelTypeSubSet.SdxlModel}):Jt=this._getMeterWithBasePrice(it),this._diffusePrice(Jt,Qe,it);const hr=Jt.toPriceInfo(),xr=.5;He.addItem(gr=>gr+hr.actualPrice,{key:"upscale",name:"upscale",spec:`x${xt}`,items:hr.items,explanation:gr=>`${gr} \\times {${xt}}_{\\text{ upscale }}`,expression:`+${hr.actualPrice<<0}`,description:"upscale (hires fix)"}),He.addItem(gr=>gr-hr.actualPrice*xr,{key:"upscale-discount",name:"upscale discount",spec:`-${xr*100}%`,explanation:gr=>`${gr} - {${xt}}_{\\text{ upscale }} \\times {${xr}}_{\\text{ discount }}`,expression:`-${(hr.actualPrice*xr).toFixed(2)}`,description:"upscale (hires fix) discount"})}else this._diffusePrice(He,Qe,{...it,floorBeforeTimesBatchSize:!0,baseStep:28});if(kt){const Kt=this._getMeterWithBasePrice();this._diffusePrice(Kt,{...Qe,height:512,width:512,upscale:1,enlarge:1,strength:.8,mediaId:"1",controlNets:[]},it);const Jt=Kt.toPriceInfo();He.addItem(hr=>hr+Jt.actualPrice,{key:"adetailer",name:"adetailer",unitPrice:Jt.actualPrice,spec:"x1",explanation:hr=>`${hr} + {${Jt.actualPrice}}_{\\text{ adetailer }}`,expression:`+${Jt.actualPrice}`,description:"adetailer"})}if(He.addItem(Kt=>floorWith(Kt-Wt*vt,100),{key:"minus-base-price",name:"minus base price",spec:"",explanation:Kt=>`${Kt} - ${Wt}_{\\text{ base price }} \\times ${vt}_{\\text{ batch size }}`,expression:`-${Wt}x${vt}`,description:"minus base price",hidden:!0}),vt>1&&He.curPrice>0&&$t&&He.addItem(Kt=>Kt*.5,{key:"email-verification-discount",name:"email verification discount",spec:"-50%",explanation:Kt=>`${Kt} \\times {0.5}_{\\text{ discount }}`,expression:"x0.5",description:"email verification discount"}),Tt&&Tt.enabled&&He.addItem(Kt=>Kt+500,{key:"wdtagger",name:"wdtagger",unitPrice:500,spec:"x1",explanation:Kt=>`${Kt} + {500}_{\\text{ wdtagger }}`,expression:"+500",description:"wdtagger"}),St&&Dt&&Dt[St]){const Kt=Dt[St]/100;He.addItem(Jt=>Jt*Kt,{key:"model-discount",name:"model discount",spec:`-${100-Dt[St]}%`,explanation:Jt=>`${Jt} \\times {${Kt}}_{\\text{ discount }}`,expression:`x${Kt}`,description:"model discount: {modelVersionId}"})}He.curPrice<-At&&He.addItem(()=>-At,{key:"max-discount",name:"max discount",spec:"",explanation:Kt=>`\\max(-${At}, ${Kt})`,expression:`=${-At}`,description:"max discount"});const Xt=Date.now()>Qt;return Xt||this._priorityChannelPrice(He,it),Ft>0&&He.curPrice<Ft&&He.addItem(()=>Ft,{key:"min-price",name:"min price",spec:"",explanation:Kt=>`\\max(${Ft}, ${Kt})`,expression:`=${Ft}`,description:"min price"}),isDITModelType(Ot)&&He.curPrice<Bt&&He.addItem(()=>Bt,{key:"dit-min-price",name:"dit min price",spec:"",explanation:Kt=>`\\max(${Bt}, ${Kt})`,expression:`=${Bt}`,description:"dit min price"}),Xt&&this._priorityChannelPrice(He,it),He}_pricingPrepaidWorkflow(He,Qe,it){const lt=this._getBasePrice(it),{workflowPrepaidPrice:ut}={...this.config,...it},dt=ut[Qe];return He.addItem(xt=>xt-lt,{key:"minus-base-price",name:"minus base price",spec:"",explanation:xt=>`${xt} - ${lt}_{\\text{ base price }}`,description:"minus base price",expression:`-${lt}`}),He.addItem(xt=>xt+dt,{key:"workflow-prepaid-fixed",name:"workflow prepaid fixed",spec:"",explanation:xt=>`${xt} + ${dt}_{\\text{ workflow_${Qe} }}`,expression:`+${dt}`,description:"workflow prepaid fixed"}),He}_pricingT2i2v(He,Qe){const{t2i2v:it,...lt}=Qe;(Qe.upscale??1)>1&&He.addItem(dt=>dt+6e3,{key:"t2i2v-upscale",name:"t2i2v upscale",spec:"",explanation:dt=>`${dt} + {6000}_{\\text{ t2i2v upscale }}`,expression:"+6000"});const ut={...this.config.t2i2vDefaultParameters,...it};return this._pricingI2vPro(He,{...lt,i2vPro:ut})}_pricingI2vPro(He,Qe){const it=this._getBasePrice(),lt=cloneParameters(Qe.i2vPro);if(lt.model){const[ft]=(lt.model??"").split("-");lt.model=ft}const ut=cloneParameters(this.config.i2vProPriceList??[]);ut.push({id:"unknown",parameters:{},price:5e4}),ut.forEach(ft=>{ft.price-=it,ft.originalPrice&&(ft.originalPrice-=it)});const dt=(ft,vt)=>ut.find(St=>St.sceneId!==vt?!1:Object.entries(St.parameters).every(([Tt,Mt])=>ft[Tt]===Mt)),xt=dt(lt);if(xt){const ft=xt.id,vt=xt.originalPrice??xt.price;He.addItem(kt=>kt+vt,{key:`i2v-pro-${ft}`,name:`i2v pro ${ft}`,spec:"",explanation:kt=>`${kt} + ${vt}_{\\text{ i2v_pro_${ft} }}`,expression:`+${vt}`,description:`i2v pro ${ft}`})}if(xt){const ft=xt.originalPrice??xt.price,vt=dt(lt,Qe.sceneId);if(vt?.price&&vt?.price!==ft){const{id:kt,sceneId:St,price:Tt}=vt,Mt=ft-Tt;He.addItem(Nt=>Nt-Mt,{key:`i2v-pro-${kt}-${St}-discount`,name:`i2v pro ${kt} ${St} discount`,spec:"",explanation:Nt=>`${Nt} - ${Mt}_{\\text{ i2v_pro_${kt} }}`,expression:`-${Mt}`,description:`i2v pro ${kt} ${St} discount`})}}return He}_isI2vPro(He){return He.i2vPro!=null}_isT2i2v(He){return He.t2i2v!=null}_pricingChat(He,Qe){const lt=this.config.basePrice,ut=cloneParameters(Qe.chat),dt=cloneParameters(this.config.chatPriceList??[]),xt=ut.modelId,ft=dt.find(kt=>kt.modelId===xt)??{modelId:"default",price:3e3,originalPrice:3e3},vt=ft.originalPrice?ft.originalPrice-lt:ft.price-lt;if(He.addItem(kt=>kt+vt,{key:`chat-price-${ft.modelId}`,name:`chat price ${ft.modelId}`,spec:"",explanation:kt=>`${kt} + ${vt}_{\\text{ chat_price_${ft.modelId} }}`,expression:`+${vt}`,description:`chat price ${ft.modelId}`}),ft.originalPrice&&ft.originalPrice!==ft.price){const kt=ft.originalPrice-ft.price;He.addItem(St=>St-kt,{key:`chat-price-${ft.modelId}-discount`,name:`chat price ${ft.modelId} discount`,spec:"",explanation:St=>`${St} - ${kt}_{\\text{ chat_price_${ft.modelId} }}`,expression:`-${kt}`,description:`chat price ${ft.modelId} discount`})}return He}_isChat(He){return He.chat!=null}_pricing(){const{workflow:He,workflowName:Qe,inputs:it}=this.parameters,{highPriority:lt}=this.config,ut=this._getMeterWithBasePrice();if(Qe?.startsWith("a/ipa"))return this._pricingBaseParameters(ut,it||{});if(Qe?.startsWith("komiyama/inpaint-"))return this._pricingBaseParameters(ut,this.parameters,{isSDXL:!0});if(this._isT2i2v(this.parameters))return this._pricingT2i2v(ut,this.parameters);if(this._isI2vPro(this.parameters))return this._pricingI2vPro(ut,this.parameters);if(this._isChat(this.parameters))return this._pricingChat(ut,this.parameters);if(this.config.workflowPrepaidPrice&&Qe){const[dt]=Qe.split(":");if(Qe in this.config.workflowPrepaidPrice)return this._pricingPrepaidWorkflow(ut,Qe);if(dt in this.config.workflowPrepaidPrice)return this._pricingPrepaidWorkflow(ut,dt)}if(He){const dt=getPriceMeter();return dt.type=PriceType.postpaid,this._priorityChannelPrice(dt),dt.addItem(xt=>xt-lt,{key:"workflow-priority-discount",name:"workflow priority discount",spec:"",explanation:xt=>`${xt} - ${lt}_{\\text{ workflow discount }}`,expression:`-${lt}`,description:"workflow discount"}),dt}return this._pricingBaseParameters(ut,this.parameters)}toPriceInfo(){return this._pricing().toPriceInfo()}};const store$1=getDefaultStore(),modelCacheAtom=atom({}),THROTTLE=6e5;function getModelVersion(He){if(!He)return;const Qe=store$1.get(modelCacheAtom)[He];return(!Qe||Date.now()-Qe.updatedAt>=THROTTLE)&&syncModelVersion(He),Qe?.value}function setModelVersion(He,Qe){store$1.set(modelCacheAtom,produce(it=>{it[He]={value:Qe,updatedAt:Date.now()}}))}const fetchers=new Map;async function fetchModelVersion(He){if(fetchers.has(He))return fetchers.get(He);{const Qe=client.getGenerationModelByVersionId({id:He}).then(it=>{const lt=it.generationModelVersion;return setModelVersion(He,lt),lt}).finally(()=>{fetchers.delete(He)});return fetchers.set(He,Qe),Qe}}async function syncModelVersion(He){await fetchModelVersion(He)}function useModelVersion(He){const Qe=Array.isArray(He)?JSON.stringify(He):He,it=useAtomValue(reactExports.useMemo(()=>selectAtom(modelCacheAtom,lt=>{if(He)return typeof He=="string"?lt[He]:He.map(ut=>lt[ut])},(lt,ut)=>(Array.isArray(lt)?lt.map(dt=>dt?.updatedAt).sort().join():lt?.updatedAt)===(Array.isArray(ut)?ut.map(dt=>dt?.updatedAt).sort().join():ut?.updatedAt)),[Qe]));return reactExports.useMemo(()=>He?typeof He=="string"?getModelVersion(He):Object.fromEntries(He.map(lt=>[lt,getModelVersion(lt)])):void 0,[Qe,it])}function useBaseModelIdsForMarkFilter(){const{data:He}=useDynamicConstants(),Qe=He?.baseModelsForModelMarketFilter??{};return Object.entries(Qe).map(([it,lt])=>({value:it,label:lt}))}function useLoraCategories(){const{data:He}=useDynamicConstants(),Qe=He?.loraCategories??{};return Object.entries(Qe).map(([it,lt])=>({value:it,label:lt}))}const usePricingTask=(He,Qe=it=>it)=>{const{data:it,isValidating:lt}=usePublicDynamicConfig("jslib",{revalidateIfStale:!0,revalidateOnFocus:!1}),{data:ut}=useUserInfo(),dt=isUserVerified(ut),xt=userHasMembership(ut),ft=Qe(He),vt=typeof ft.modelId=="string"?ft.modelId:void 0,kt=useModelVersion(vt),St=JSON.stringify(ft),Tt=it?.config;return{data:reactExports.useMemo(()=>new Pricing(ft,{...Tt,shouldDiscount:dt||xt,modelType:kt?.modelType}),[St,Tt,dt,kt?.modelType]).toPriceInfo(),isValidating:lt}},EMPTY_SELECT_KEY$1="unset",DEFAULT_I2VPRO_NEG_PROMPTS="realistic, blur, distortion, disfigurement, low quality, collage, grainy, logos, abstract, warped",DEFAULT_I2VPRO_PARAMS={model:"v2.7",mode:"professional",duration:"5",prompts:"",negativePrompts:DEFAULT_I2VPRO_NEG_PROMPTS,cameraMovement:EMPTY_SELECT_KEY$1,usePromptsHelper:!0};function getFreeGenEvent(He){const{events:Qe,genArgs:it}=He;return Qe?Qe.filter(ut=>ut.i2vPro==null||ut.i2vPro.length===0||ut.userType==="member"&&!He?.membershipTier||ut.userType==="member-t1"&&He?.membershipTier!==1||ut.userType==="member-t2"&&He?.membershipTier!==2||ut.userType==="member-t3"&&He?.membershipTier!==3?!1:!!(He.sceneId&&ut.sceneId===He.sceneId||ut.i2vPro.find(dt=>dt.model===it.model&&dt.mode===it.mode&&dt.duration===it.duration)))[0]:null}function useI2vGenerationSubmissionArgs(He){const{data:Qe,mutate:it}=useMyFreeGenerationEvents(),{membershipTier:lt,submissionArgs:ut}=He,{data:dt,isValidating:xt}=usePricingTask(ut),ft=getFreeGenEvent({events:Qe,membershipTier:lt,genArgs:ut.i2vPro,sceneId:ut.sceneId}),vt=ft!=null&&ft.countRemains>0;return{priceInfo:dt,priceValidating:xt,hasFreeEvent:vt,activeFreeEvent:ft,mutateMyFreeGenerationEvents:it}}function parseI2vProTaskSubmitParams(He,Qe){const it=getConfigurationTypeFromPanelId(He),lt=["model","mediaId","usePromptsHelper"],ut=[];return it.cameraMovement&&ut.push("cameraMovement"),it.prompts&&ut.push("prompts"),it.negativePrompts&&ut.push("negativePrompts"),it.mode?.enable&&!it.mode.omitted&&ut.push("mode"),it.duration?.enable&&!it.duration.omitted&&ut.push("duration"),it.tailFrame&&ut.push("tailMediaId"),pick$1(Qe,[...lt,...ut])}const i2vModelsDynamicSchema=looseObject({models:array(looseObject({model:string(),panelId:string(),isNew:optional(boolean()),image:optional(string()),tags:optional(array(string())),demoVideo:object({id:string(),hls:string()}),speedTier:optional(union([literal(0),literal(1),literal(2),literal(3)])),supportsPrivateMode:optional(boolean()),supportsTailFrame:optional(boolean()),hidden:optional(boolean()),loras:optional(array(object({key:string(),id:string(),triggerWords:string(),backgroundImage:string()}))),actionPresets:optional(array(object({key:string(),label:string(),id:string(),type:string(),backgroundImage:string()})))})),defaultModel:optional(string())});function getConfigurationTypeFromPanelId(He){return $$3(He).with(N$4.union("1894d698-c87d-4f87-932c-26af20e78562","v2.5"),()=>({prompts:!0,duration:{readonly:!0,enable:!0,omitted:!0,options:[5],default:5}})).with(N$4.union("79b4c306-bdb8-4700-ab6f-9aaf508b1d39","v1"),()=>({prompts:!0,negativePrompts:!0,duration:{enable:!0},mode:{enable:!0},tailFrame:!0,modesWhenTailFrameNotAvailable:["basic"]})).with(N$4.union("ccdfe579-9433-4a25-b317-77e87f221270","v2","v2.6","v2.7"),()=>({prompts:!0,negativePrompts:!0,cameraMovement:!0,duration:{enable:!0},mode:{enable:!0,options:["basic","professional"],default:"professional"},tailFrame:!0,modesWhenTailFrameNotAvailable:["basic"]})).with(N$4.union("db0b9e06-1c6c-4a94-8e35-a3aa55957556","v2.5.1"),()=>({prompts:!0,tailFrame:!0,duration:{enable:!0,options:[5,10]},durationWithTailFrame:{enable:!0,options:[5,10]}})).with(N$4.union("cc2fcd16-1bb0-4f2f-ab29-11960cdaf862","v3.0"),()=>({prompts:!0,negativePrompts:!0,cameraMovement:!1,duration:{readonly:!0,enable:!0,omitted:!1,options:[5],default:5},mode:{enable:!0,options:["basic","professional"],default:"professional"},tailFrame:!1})).otherwise(()=>({}))}function useAvaliableI2vModels(){const{data:He,isLoading:Qe}=usePublicDynamicConfig("tools"),{output:it,success:lt}=safeParse(i2vModelsDynamicSchema,He?.i2vPro);return{models:lt?it.models.map(dt=>({model:dt.model,panelId:dt.panelId,panelConfig:getConfigurationTypeFromPanelId(dt.panelId),isNew:dt.isNew,image:dt.image,tags:dt.tags,demoVideoId:dt.demoVideo.id,demoVideoHlsUrl:dt.demoVideo.hls,isDefault:dt.model===it.defaultModel,speedTier:dt.speedTier,supportsPrivateMode:!!dt.supportsPrivateMode,supportsTailFrame:!!dt.supportsTailFrame,hiddenByDefault:!!dt.hidden,loras:dt.loras,actionPresets:dt.actionPresets})):[],defaultModel:lt?it?.defaultModel:void 0,isLoading:Qe}}const FRAMEPACK_MODEL_ID="v2.5.1";function isFramepackModel(He){return He===FRAMEPACK_MODEL_ID}function modelSupportsActionControlVideo(He){return He==="v3.0"}const PROMPT_NON_ASCII_RATIO_THRESHOLD=.1,PROMPT_NON_ASCII_COUNT_THRESHOLD=5;function usePromptExceedsAsciiThresholdForI2vMode(He,Qe){const it=canUseI2vProPromptHelper(),lt=reactExports.useMemo(()=>Qe?getNonAsciiStats(Qe.replaceAll(/\s/g,"")):{totalCount:0,nonAsciiCount:0,nonAsciiRatio:0},[Qe]);return it&&lt.nonAsciiRatio>PROMPT_NON_ASCII_RATIO_THRESHOLD&&lt.nonAsciiCount>PROMPT_NON_ASCII_COUNT_THRESHOLD}function canUseI2vProPromptHelper(He,Qe){return!0}const imageToVideoStateStore=createStore$1(),imageToVideoStateAtom=atom({}),ImageToVideoStateContextProvider=He=>Provider({children:He.children,store:imageToVideoStateStore});function useSetImageToVideoState(){return useSetImmerAtom(imageToVideoStateAtom,{store:imageToVideoStateStore})}function useImageToVideoStateValue(){return useAtomValue(imageToVideoStateAtom,{store:imageToVideoStateStore})}const imageToVideoFormStageAtom=atomWithImmer(DEFAULT_I2VPRO_PARAMS),ImageToVideoFormStateContextProvider=He=>Provider({children:He.children,store:imageToVideoStateStore});function useImageToVideoFormState(){return useAtom(imageToVideoFormStageAtom,{store:imageToVideoStateStore})}function useSelectedI2vProModel(){const{models:He}=useAvaliableI2vModels(),[Qe]=useImageToVideoFormState();return reactExports.useMemo(()=>He.find(lt=>lt.model===Qe.model),[He,Qe.model])}function useSelectedI2vLoRA(){const He=useSelectedI2vProModel(),{lora:Qe}=useImageToVideoStateValue();return reactExports.useMemo(()=>(He?.loras?.length??0)>0&&(Qe?.length??0)>0,[He,Qe])}const SpeedIndicatorIcon=He=>jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M14 2a1 1 0 0 0-1.864-.504l-7 12A1 1 0 0 0 6 15h4v7a1 1 0 0 0 1.864.504l7-12A1 1 0 0 0 18 9h-4z",clipRule:"evenodd"})}),SpeedIndicators=({tier:He})=>He===0?null:jsxRuntimeExports.jsx("div",{className:"inline-flex items-center gap-0.5 ml-2",children:Array.from({length:He},(Qe,it)=>jsxRuntimeExports.jsx(SpeedIndicatorIcon,{className:"w-3 h-3 text-pix-warning-normal dark:text-pix-yellow"},it))});function CapabilityTag(He){return jsxRuntimeExports.jsx("div",{className:"inline border border-pix-gray-light text-pix-black-dim rounded-xl px-2 mt-1 text-xs leading-4 truncate dark:text-neutral-300",children:jsxRuntimeExports.jsxs("span",{children:[" ",He.capability," "]})})}function ModelCapabilityTags$1(He){const{tags:Qe}=He;return Qe.length===0?null:jsxRuntimeExports.jsx("div",{className:"inline-flex gap-1 flex-wrap",children:Qe.map(it=>jsxRuntimeExports.jsx(CapabilityTag,{capability:it},it))})}const I2VModelCard=({image:He,title:Qe,tags:it,isSelected:lt=!1,onSelectionChange:ut,showNewLabel:dt=!1,speedTier:xt=0})=>{const ft=reactExports.useCallback(()=>{ut?.()},[ut]),vt=reactExports.useCallback(kt=>{(kt.key==="Enter"||kt.key===" ")&&(kt.preventDefault(),ft())},[ft]);return jsxRuntimeExports.jsx("div",{className:cx("rounded-xl cursor-pointer border-2 transition-all focus:outline-none focus-visible:shadow-lg focus-visible:shadow-purple-500/20 dark:focus-visible:shadow-purple-400/20 text-left w-full",{"border-purple-500 dark:border-purple-400 bg-purple-50 dark:bg-purple-900/20":lt,"border-transparent dark:border-transparent hover:border-pix-gray-dark dark:hover:border-pix-gray-light hover:bg-gray-50 dark:hover:bg-gray-800/50":!lt}),onClick:ft,onKeyDown:vt,role:"button","aria-pressed":lt,"aria-label":`${Qe} model. ${lt?"Currently selected":"Not selected"}`,tabIndex:0,children:jsxRuntimeExports.jsxs("div",{className:"flex flex-row items-center justify-start gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"shrink-0 rounded-xl w-16 h-16 relative overflow-hidden",children:[jsxRuntimeExports.jsx("img",{src:He,alt:Qe,className:"rounded-xl w-full h-full object-cover"}),dt&&jsxRuntimeExports.jsx(NewLabel,{className:"absolute top-0 right-0 z-10"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("div",{className:"hyphens-auto relative",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-sm text-pix-black-normal dark:text-pix-white-normal truncate",children:Qe}),jsxRuntimeExports.jsx(SpeedIndicators,{tier:xt})]})}),jsxRuntimeExports.jsx(ModelCapabilityTags$1,{tags:it})]})]})})};function I2vActionPresetTiles(He){const Qe=He.selectionMode??"multiple",it=new Set(He.value??[]);function lt(ut){if(Qe==="single"){He.onChange(it.has(ut)?[]:[ut]);return}const dt=new Set(it);dt.has(ut)?dt.delete(ut):dt.add(ut),He.onChange(Array.from(dt))}return jsxRuntimeExports.jsx("div",{className:cx("flex flex-wrap items-center gap-2",He.className),children:He.items.map(ut=>{const dt=it.has(ut.id),ft={backgroundImage:`${(typeof ut.label=="string"?ut.label.trim().length>0:!!ut.label)?"linear-gradient(to right, #FFF8, #FFF8), ":""}url("${ut.backgroundImage}")`};return ut.to?jsxRuntimeExports.jsx(Link,{to:ut.to,className:cx("rounded-xl size-16 flex items-center bg-cover bg-clip-padding bg-center justify-center text-black border-2 transition-all font-bold cursor-pointer focus:outline-none focus-visible:shadow-lg focus-visible:shadow-purple-500/20","border-transparent dark:border-transparent hover:border-pix-gray-dark dark:hover:border-pix-gray-light hover:bg-gray-50 dark:hover:bg-gray-800/50",He.tileClassName),style:ft,children:ut.label},ut.id):jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",className:cx("rounded-xl size-16 flex items-center bg-cover bg-clip-padding bg-center justify-center text-black border-2 transition-all font-bold cursor-pointer focus:outline-none focus-visible:shadow-lg focus-visible:shadow-purple-500/20",{"border-purple-500 dark:border-purple-400 bg-purple-50 dark:bg-purple-900/20":dt,"border-transparent dark:border-transparent hover:border-pix-gray-dark dark:hover:border-pix-gray-light hover:bg-gray-50 dark:hover:bg-gray-800/50":!dt},He.tileClassName),style:ft,onPress:()=>lt(ut.id),children:ut.label},ut.id)})})}const EMPTY_SELECT_KEY="unset",MOVEMENT_OPTIONS_MAP={horizontal:"Horizontal","vertical-pan":"Vertical Pan",zoom:"Zoom",pan:"Pan",tilt:"Tilt",roll:"Roll"},DEFAULT_PRESETS=[{id:"kiss",label:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:image-to-video.action-presets.kiss.label"}),backgroundImage:"https://images-ng.pixai.art/images/thumb/b65f7781-60fc-44b3-9a87-19abb4e8091b"},{id:"hug",label:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:image-stitching.preset.hug.label"}),backgroundImage:"https://images-ng.pixai.art/images/thumb/71448d2a-e8c2-4613-a2fa-e67be2231c29"}];let demoVideoShown=!1;function showDemoVideo(He,Qe){demoVideoShown||(track("i2v_demo_video_open",{videoId:He,videoHlsUrl:Qe}),UIDialog.create({content:jsxRuntimeExports.jsx(DemoVideo,{videoId:He,videoHlsUrl:Qe}),className:"max-w-[calc(100vw-2rem)] w-[1080px] p-0 [&>div]:p-0 rounded-none",dismissable:!0,onClose(){demoVideoShown=!1}}),demoVideoShown=!0)}function DemoVideo(He){const[Qe,it]=reactExports.useState(!1);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx($5cb03073d3f54797$export$a8a3e93435678ff9,{slot:"title",className:"hidden",children:"Demo"}),jsxRuntimeExports.jsxs("div",{className:"relative aspect-video",children:[!Qe&&jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center absolute",children:jsxRuntimeExports.jsx(Preloader,{})}),He.videoHlsUrl&&jsxRuntimeExports.jsx(HlsStream,{src:He.videoHlsUrl,controls:!1,autoPlay:!0,playsInline:!0,onLoaded:()=>it(!0),muted:!0}),!He.videoHlsUrl&&He.videoId&&jsxRuntimeExports.jsx(Stream,{src:He.videoId,controls:!1,autoplay:!0,onLoadedData:()=>it(!0),muted:!0})]})]})}function ImageToVideoSubmit(He){const Qe=useImageItemListValue()[0],it=Qe?.startsWith("upload")?null:Qe,lt=useImageItemListValue(ImageItemListGroup.i2vProTailFrame)[0],ut=lt?.startsWith("upload")?void 0:lt;return jsxRuntimeExports.jsx(ImageToVideoSubmitForm,{...He,mediaId:it,tailMediaId:ut,showStitchEntries:!0})}function ImageToVideoSubmitForm(He){const{models:Qe,defaultModel:it,isLoading:lt}=useAvaliableI2vModels(),ut=reactExports.useMemo(()=>Qe.filter(wr=>!wr.hiddenByDefault),[Qe]),dt=reactExports.useMemo(()=>Qe.filter(wr=>wr.hiddenByDefault),[Qe]),[xt,ft]=reactExports.useState(!1),[vt,kt]=useImageToVideoFormState(),{beingMember:St,me:Tt,membershipTier:Mt}=useMe(),[Nt]=reactExports.useContext(ChannelContext),[At,$t]=reactExports.useState(void 0),Dt=reactExports.useRef(null),[{lastResultTask:Ft,initialValue:Bt,lora:Ot,actionPresets:Qt},Wt]=useAtom(imageToVideoStateAtom),Xt=reactExports.useCallback(wr=>Wt(qr=>({...qr,lora:typeof wr=="function"?wr(qr.lora):wr})),[Wt]),Kt=reactExports.useCallback(wr=>Wt(qr=>({...qr,actionPresets:typeof wr=="function"?wr(qr.actionPresets):wr})),[Wt]),Jt=usePromptExceedsAsciiThresholdForI2vMode(vt.model,vt.prompts);reactExports.useEffect(()=>{Jt&&kt(wr=>{wr.usePromptsHelper=!0})},[Jt]);const hr=canUseI2vProPromptHelper(vt.model);reactExports.useEffect(()=>{},[hr]),reactExports.useEffect(()=>{!xt&&dt.find(wr=>wr.model===vt.model)&&ft(!0)},[xt,ft,dt,vt.model]),reactExports.useEffect(()=>{if(He.skipImportLastTaskResult)return;const wr=Ft,{success:qr,output:Nr}=safeParse(TaskParametersI2vProSchema,wr?.parameters);if(qr){const Jr=!Qe.some(Qr=>Qr.model===Nr.i2vPro.model);kt(Qr=>{const Ur={...omit(Qr,["prompts"]),...pick$1(Nr.i2vPro,["mode","model","duration","negativePrompts","prompts","cameraMovement"]),...Jr?{model:DEFAULT_I2VPRO_PARAMS.model}:{},usingDeprecatedModel:Jr};return Nr.extra?.naturalPrompts!=null?(Ur.prompts=Nr.extra.naturalPrompts,Ur.usePromptsHelper=!0):Ur.usePromptsHelper=!1,Ur}),Xt(Object.keys(wr?.loras??{})),Kt(Nr.i2vPro.controlMediaId?[Nr.i2vPro.controlMediaId]:[]),Nr.extra?.naturalPrompts!=null&&Nr.extra?.naturalPrompts!==Nr.i2vPro.prompts?$t(Nr.i2vPro.prompts):$t(void 0)}else kt(Jr=>({...DEFAULT_I2VPRO_PARAMS,...omit(Jr,["prompts"])})),$t(void 0),Xt([]),Kt([])},[Ft,He.skipImportLastTaskResult,Kt]),reactExports.useEffect(()=>{it||vt.model==="v2"&&kt(wr=>{wr.mode="professional"})},[vt.model,it]),reactExports.useEffect(()=>{const wr=Object.keys(Bt?.lora??{});wr.length>0?(kt(qr=>{qr.model="v2.5.1"}),Xt(wr)):it&&kt(qr=>{qr.model=it})},[Bt,it]);const{t:xr}=useTranslation(["generation","common"]),gr=reactExports.useCallback(wr=>wr?wr.map(qr=>xr(`generation:image-to-video.tag.${qr}`)):[],[xr]);reactExports.useEffect(()=>{Kt([])},[vt.model,Kt]);const br=reactExports.useMemo(()=>{const wr=Ft?.parameters?.extra?.referenceImagePrompts??Ft?.parameters?.prompts;return{i2vPro:{...vt,mediaId:He.mediaId,tailMediaId:He.tailMediaId},channel:Nt,lora:Ot&&Object.fromEntries(Ot.map(qr=>[qr,.7])),...wr?{extra:{referenceImagePrompts:wr}}:{}}},[He.mediaId,He.tailMediaId,vt,Nt,Ot,Ft]),{activeFreeEvent:vr,priceInfo:yr,priceValidating:Cr,hasFreeEvent:Rr,mutateMyFreeGenerationEvents:Ir}=useI2vGenerationSubmissionArgs({membershipTier:Mt,submissionArgs:br}),Tr=useSelectedI2vProModel(),$r=useCanUsePrivateChannel(),[Zr,Sr]=useAsyncFn(async()=>{try{const wr=Object.fromEntries(new FormData(Dt.current));if(!Tt?.id)return openSignModal({oauthRedirectUrl:`${joinURL(window.location.origin,"generator/image/animation")}`},{fromPath:"i2v-pro-generation"});if(Nt==="private"&&!$r)return openMembershipFeatureDialog({dialogTitle:xr("generation:image-to-video.private-membership-dialog.title"),dialogBody:xr("generation:image-to-video.private-membership-dialog.description"),trackingLocation:"i2v-pro-private-channel"});if(!St)return openMembershipFeatureDialog({dialogBody:xr("generation:image-to-video.membership-dialog.description"),trackingLocation:"i2v-pro-generation"});if(!Tr?.panelId)throw new Error("Unknown config");const Nr=getCameraMovement(wr),Jr=parseI2vProTaskSubmitParams(Tr?.panelId,{...br.i2vPro,cameraMovement:Nr});track("image_to_video_generate_click",omit(Jr,["mediaId","tailMediaId","prompts","negativePrompts"]));const Qr=Tr?.actionPresets?.find(Cn=>(Qt??[]).includes(Cn.id)||(Qt??[]).includes(Cn.key)),Ur=await executeCreateGenerationTask({parameters:{i2vPro:{...Jr,...Qr?{controlMediaId:Qr.id,controlMediaType:Qr.type}:{}},channel:br.channel,lora:br.lora,...br.extra?{extra:br.extra}:{}}});Ir(),Wt(Cn=>({...Cn,lastResultTaskId:Ur.data?.createGenerationTask?.id,lastResultTask:Ur.data?.createGenerationTask}));const nn=document.getElementById("i2v-task-result-scroll-into-view");nn&&requestAnimationFrame(()=>{nn.scrollIntoView({block:"start"})}),Ur.data?.createGenerationTask&&He.afterSubmission?.(Ur.data?.createGenerationTask)}catch(wr){toast.error(wr.message)}},[br,St,He.afterSubmission,Tr?.panelId,Tr?.actionPresets,Qt]);if(reactExports.useEffect(()=>{Nt==="private"&&!Qe.find(wr=>wr.model===vt.model)?.supportsPrivateMode&&kt(wr=>({...wr,model:Qe.find(qr=>qr.supportsPrivateMode)?.model}))},[Nt,it,Qe,vt.model]),lt)return jsxRuntimeExports.jsx(LoadingPage,{});const Dr=Tr?.actionPresets??DEFAULT_PRESETS;return jsxRuntimeExports.jsxs($d3e0e05bdfcf66bd$export$a7fed597f4b8afd8,{className:cx("flex flex-col gap-2",He.className),onSubmit:wr=>wr.preventDefault(),ref:Dt,children:[jsxRuntimeExports.jsx(ControlSectionMessage,{type:ControlSectionMessageType.Warning,className:"mlg:mb-0",children:xr(Nt==="private"?"generation:image-to-video.professional-mode-warning":"generation:image-to-video.incompatible-with-nsfw")}),jsxRuntimeExports.jsx(GeneratorControlSection,{compact:!0,title:xr("generation:image-to-video.parameters.model.label"),children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[ut.filter(wr=>Nt!=="private"||wr.supportsPrivateMode).map(wr=>jsxRuntimeExports.jsx(I2VModelCard,{image:wr.image??xr("common:resources.miochan_sad"),title:xr([`generation:image-to-video.parameters.model.${getI18nKeyForI2vModelName(wr.model)}.label`,"common:unknown"]),speedTier:wr.speedTier,tags:gr(wr.tags),isSelected:vt.model===wr.model,onSelectionChange:()=>{kt(qr=>{qr.model=wr.model})},showNewLabel:wr.isNew},wr.model)),!xt&&dt.length>0&&jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",className:"h-6 text-neutral-500 dark:text-neutral-400",endIcon:jsxRuntimeExports.jsx(icBaselineKeyboardArrowDown,{className:"size-4"}),onPress:()=>ft(!0),"aria-label":xr("generation:image-to-video.parameters.model.show-more-models","Show more models")}),xt&&dt.filter(wr=>Nt!=="private"||wr.supportsPrivateMode).map(wr=>jsxRuntimeExports.jsx(I2VModelCard,{image:wr.image??xr("common:resources.miochan_sad"),title:xr([`generation:image-to-video.parameters.model.${getI18nKeyForI2vModelName(wr.model)}.label`,"common:unknown"]),tags:gr(wr.tags),isSelected:vt.model===wr.model,onSelectionChange:()=>{kt(qr=>{qr.model=wr.model})},showNewLabel:wr.isNew},wr.model)),xt&&dt.length>0&&jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",className:"h-6 text-neutral-500 dark:text-neutral-400",endIcon:jsxRuntimeExports.jsx(icBaselineKeyboardArrowUp,{className:"size-4"}),onPress:()=>{dt.some(qr=>qr.model===vt.model)||ft(!1)},"aria-label":xr("generation:image-to-video.parameters.model.show-fewer-models","Show fewer models")})]})}),Tr&&jsxRuntimeExports.jsx(ModelConfigSection,{rewrittenPrompt:At,modelItem:Tr,mediaId:He.mediaId,tailMediaId:He.tailMediaId,formState:vt,setFormState:kt,lora:Ot,setLora:Xt,submitArea:jsxRuntimeExports.jsxs(UIButton$1,{type:"submit",variant:"filled",color:"theme",className:"w-full mt-2 shrink-0",labelClassName:"flex justify-center items-center gap-2",disabled:!He.mediaId,onPress:Sr,busy:Zr.loading,children:[jsxRuntimeExports.jsx(MembershipIconCircled,{className:"size-4"}),xr("generation:image-to-video.action.submit"),Tt&&!Rr&&jsxRuntimeExports.jsx(CreditMeter,{children:jsxRuntimeExports.jsx(QuotaCost,{value:yr?.actualPrice??0,originalValue:yr?.originalPrice,loading:Cr,className:"!text-inherit font-normal",iconClassName:"hidden",valueClassName:"text-xs"})}),Tt&&Rr&&jsxRuntimeExports.jsxs(CreditMeter,{children:[jsxRuntimeExports.jsx("span",{className:"font-bold",children:vr?.countRemains}),"/",jsxRuntimeExports.jsx("span",{className:"text-xs",children:xr("generation:submit.free-generation.remaining-times",{remaining:vr?.countTotal})})]})]})}),!isFramepackModel(vt.model)&&jsxRuntimeExports.jsx(GeneratorControlSection,{compact:!0,title:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:image-to-video.action-presets.label"}),help:jsxRuntimeExports.jsx(ActionPresetsHelp,{}),helpIconProps:{wrapperClassName:"p-4"},children:jsxRuntimeExports.jsx("div",{className:"px-0",children:jsxRuntimeExports.jsx(I2vActionPresetTiles,{items:Dr.map(wr=>({id:wr.id,label:wr.label,backgroundImage:wr.backgroundImage,to:modelSupportsActionControlVideo(vt.model)?void 0:`/generator/stitching/${wr.id}`})),value:Qt??[],selectionMode:"single",onChange:wr=>{Kt(wr)}})})}),isFramepackModel(vt.model)&&jsxRuntimeExports.jsx(GeneratorControlSection,{compact:!0,title:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:lora.list.title"}),children:jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Tr?.loras?.length?jsxRuntimeExports.jsx(I2vActionPresetTiles,{items:Tr.loras.map(wr=>({id:wr.id,label:jsxRuntimeExports.jsx(Text,{i18nKey:`generation:image-to-video.parameters.loras.${wr.key}.label`}),backgroundImage:wr.backgroundImage})),value:Ot??[],selectionMode:"single",onChange:wr=>{Xt(wr)}}):null,jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",color:"normal",className:"rounded h-16 w-32 flex items-center justify-center border font-bold",onPress:()=>{track("i2v_pro_train_lora_click"),UIDialog.alert(jsxRuntimeExports.jsx(Text,{i18nKey:"common:coming-soon"}))},children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:meta.title.train-lora"})})]})}),Tr?.panelConfig.negativePrompts&&jsxRuntimeExports.jsx(CollapsibleControlSection,{compact:!0,defaultExpanded:!1,title:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:advanced.label"}),className:"pb-2",children:jsxRuntimeExports.jsxs($bcdf0525bf22703d$export$2c73285ae9390cec,{value:vt.negativePrompts,onChange:wr=>kt(qr=>{qr.negativePrompts=wr}),className:cx("flex flex-col gap-1",!Tr?.panelConfig.negativePrompts&&"hidden"),children:[jsxRuntimeExports.jsxs($01b77f81d0f07f68$export$b04be29aa201d4f5,{className:"inline-flex gap-2",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold",children:xr("generation:negative-prompts.label")}),jsxRuntimeExports.jsx(UITooltipHelpIcon,{TooltipProps:{placement:"start",UNSTABLE_portalContainer:document.getElementById(WORKBENCH_OVERLAY_ID)},variant:"normal",children:jsxRuntimeExports.jsx("p",{className:"max-w-[36em]",children:xr("generation:image-to-video.parameters.negative-propmpts.placeholder")})})]}),jsxRuntimeExports.jsx(UITextArea,{variant:"rounded-normal",className:"rounded-md p-2 resize-none",placeholder:xr("generation:image-to-video.parameters.negative-propmpts.placeholder"),name:"negativePrompts",inputMode:"text",autoCapitalize:"off",spellCheck:"false",autoCorrect:"off"})]})})]})}function ModelConfigSection(He){const{formState:Qe,setFormState:it}=He,{isNew:lt,demoVideoId:ut,demoVideoHlsUrl:dt,panelConfig:xt}=He.modelItem,{t:ft}=useTranslation(["generation"]),vt=reactExports.useMemo(()=>(He.tailMediaId?xt.durationWithTailFrame?.options??[5]:xt.duration?.options??[5,10]).map(At=>At.toString()),[xt,He.tailMediaId]),kt=xt.mode?.options??["basic","professional"],St=Qe.cameraMovement??EMPTY_SELECT_KEY,Tt=He.tailMediaId?xt.durationWithTailFrame?.default:xt.duration?.default;reactExports.useEffect(()=>{it(At=>{Tt&&(At.duration=Tt.toString()),xt.mode?.default&&(At.mode=xt.mode.default)})},[Tt,xt.mode?.default,He.tailMediaId]),reactExports.useEffect(()=>{it(At=>{vt.includes(At.duration)||(Tt?At.duration=Tt.toString():At.duration=vt[0])})},[xt,vt,Tt]),canUseI2vProPromptHelper(Qe.model);const Mt=He.tailMediaId?xt.durationWithTailFrame?.enable??xt.duration?.enable:xt.duration?.enable,Nt=He.tailMediaId?xt.durationWithTailFrame?.readonly??xt.duration?.readonly:xt.duration?.readonly;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GeneratorControlSection,{compact:!0,className:cx(!xt.mode?.enable&&"hidden"),title:ft("generation:image-to-video.parameters.mode.label"),children:jsxRuntimeExports.jsx(UIRadioGroup,{className:cx("flex mlg:flex-col gap-4 mlg:gap-1"),value:Qe.mode,onChange:At=>it($t=>{$t.mode=At}),isDisabled:xt.mode?.readonly,name:"mode",children:kt.map(At=>jsxRuntimeExports.jsx(UIRadio,{variant:"rounded-radio",value:At,color:"theme",size:"normal",children:jsxRuntimeExports.jsx("span",{className:"text-sm",children:ft(`generation:image-to-video.parameters.mode.${At}`)})},At))})}),jsxRuntimeExports.jsx(GeneratorControlSection,{compact:!0,className:cx(!Mt&&"hidden"),title:ft("generation:image-to-video.parameters.duration.label"),children:jsxRuntimeExports.jsx(UIRadioGroup,{className:cx("flex mlg:flex-col gap-4 mlg:gap-1"),value:Qe.duration,onChange:At=>it($t=>{$t.duration=At}),name:"duration",isDisabled:Nt,children:vt.map(At=>jsxRuntimeExports.jsx(UIRadio,{variant:"rounded-radio",value:At,color:"theme",size:"normal",children:jsxRuntimeExports.jsx("span",{className:"text-sm",children:ft(`generation:image-to-video.parameters.duration.${At}`)})},At))})}),jsxRuntimeExports.jsxs(GeneratorControlSection,{compact:!0,title:ft("generation:image-to-video.parameters.prompts.label"),titleSlot:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx(UISwitch,{className:"flex items-center text-xs",size:"xsmall",labelPlacement:"start",isSelected:Qe.usePromptsHelper,onChange:At=>it($t=>{$t.usePromptsHelper=At}),children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:image-to-video.prompts-helper.label"})})]}),children:[jsxRuntimeExports.jsxs($bcdf0525bf22703d$export$2c73285ae9390cec,{value:Qe.prompts,onChange:At=>it($t=>{$t.prompts=At}),className:"flex flex-col gap-1",name:"prompts",children:[He.modelItem.loras?.filter(At=>He.lora?.includes(At.id))?.map((At,$t)=>jsxRuntimeExports.jsx(UITooltipResponsive,{wrapperClassName:"p-2",TooltipProps:{delay:250},trigger:Dt=>jsxRuntimeExports.jsxs(UIButton$1,{className:"flex items-center whitespace-nowrap w-fit pl-2 py-0.5 rounded-2xl gap-0 h-6 overflow-hidden",endIcon:jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",className:"outline-0 rounded-full overflow-hidden",onPress:()=>He.setLora([]),children:jsxRuntimeExports.jsx(icRoundClose,{})}),size:"small",onPress:()=>Dt?Dt():He.setLora([]),labelClassName:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"border-r-[1px] border-neutral-300 dark:border-neutral-600 pr-1 mr-1 text-xs font-inter text-black/60 dark:text-white/60",children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:lora.list.title"})}),ft(`generation:image-to-video.parameters.loras.${At.key}.label`)]}),children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:image-to-video.parameters.prompts.lora-trigger-words-added"})},$t)),jsxRuntimeExports.jsx(UITextArea,{variant:"rounded-normal",className:"min-h-24 rounded-md p-2 resize-none",inputMode:"text",autoCapitalize:"off",spellCheck:"false",autoCorrect:"off",placeholder:ft("generation:image-to-video.parameters.prompts.placeholder")}),jsxRuntimeExports.jsx("p",{className:"text-xs text-neutral-500 dark:text-neutral-400 mt-1",children:jsxRuntimeExports.jsx("a",{className:"text-blue-600 dark:text-blue-400 hover:underline",target:"_blank",href:ft("generation:image-to-video.prompts-writing-guide.link"),rel:"noopener noreferrer",onClick:()=>{track("i2v_prompt_guide_click")},children:ft("generation:image-to-video.prompts-writing-guide.helper-text")})})]}),He.rewrittenPrompt?jsxRuntimeExports.jsxs("p",{className:"text-neutral-600 dark:text-neutral-300 text-xs",children:[ft("generation:image-to-video.rewritten-prompt.description")," ",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("button",{className:"underline decoration-neutral-600 dark:decoration-neutral-300",onClick:()=>{UIDialog.alert({heading:ft("generation:image-to-video.rewritten-prompt.inspect-dialog.title"),content:He.rewrittenPrompt??"",dismissable:!0})},children:ft("generation:image-to-video.rewritten-prompt.inspect-button.label")})]}):null]}),jsxRuntimeExports.jsx(CollapsibleControlSection,{compact:!0,className:cx(!xt.cameraMovement&&"hidden"),title:ft("generation:image-to-video.parameters.camera.label"),defaultExpanded:St!==EMPTY_SELECT_KEY,children:jsxRuntimeExports.jsx(CameraSection,{defaultMovement:St})}),jsxRuntimeExports.jsx("div",{className:"sticky bottom-0 bg-background pb-2",children:He.submitArea}),(ut||dt)&&jsxRuntimeExports.jsxs(UIButton$1,{className:"shrink-0",labelClassName:"flex items-center justify-center gap-1",variant:"outlined",onPress:()=>showDemoVideo(ut,dt),children:[jsxRuntimeExports.jsx(riVideoAiLine,{}),ft("generation:image-to-video.action.show-demo-video"),lt&&jsxRuntimeExports.jsx(NewLabel,{})]})]})}function CameraSection(He){return jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-[auto_1fr] items-center gap-x-3 gap-y-2 px-2 pb-2 pt-1",children:[jsxRuntimeExports.jsx($01b77f81d0f07f68$export$b04be29aa201d4f5,{children:jsxRuntimeExports.jsx("h4",{className:"font-medium text-sm",children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:image-to-video.parameters.movement.label"})})}),jsxRuntimeExports.jsxs(UISelectNative,{name:"movement","aria-label":"movement",defaultValue:He.defaultMovement,className:"max-w-40",children:[jsxRuntimeExports.jsx("option",{id:EMPTY_SELECT_KEY,value:EMPTY_SELECT_KEY,children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:image-to-video.parameters.movement.option.unset"})}),Object.keys(MOVEMENT_OPTIONS_MAP).map(Qe=>jsxRuntimeExports.jsx("option",{id:Qe,value:MOVEMENT_OPTIONS_MAP[Qe],children:jsxRuntimeExports.jsx(Text,{i18nKey:`generation:image-to-video.parameters.movement.option.${Qe}`})},Qe))]})]})}function getCameraMovement(He){const{movement:Qe}=He;if(!(!Qe||Qe===EMPTY_SELECT_KEY))return Qe}function openImageToVideoSubmissionDialog(He){const{afterSubmission:Qe,type:it,...lt}=He;return UIDialog.create({dismissable:!0,className:"max-w-sm",heading:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:generate.tab.image-to-video.label"}),type:it,content:jsxRuntimeExports.jsx(ImageToVideoSubmitForm,{afterSubmission:ut=>{Qe?.(ut)},skipImportLastTaskResult:!0,...lt})})}var UINT32_MAX=4294967295;function setUint64(He,Qe,it){var lt=it/4294967296,ut=it;He.setUint32(Qe,lt),He.setUint32(Qe+4,ut)}function setInt64(He,Qe,it){var lt=Math.floor(it/4294967296),ut=it;He.setUint32(Qe,lt),He.setUint32(Qe+4,ut)}function getInt64(He,Qe){var it=He.getInt32(Qe),lt=He.getUint32(Qe+4);return it*4294967296+lt}function getUint64(He,Qe){var it=He.getUint32(Qe),lt=He.getUint32(Qe+4);return it*4294967296+lt}var define_process_env_default={},_a,_b,_c,TEXT_ENCODING_AVAILABLE=(typeof process$1>"u"||((_a=process$1===null||process$1===void 0?void 0:define_process_env_default)===null||_a===void 0?void 0:_a.TEXT_ENCODING)!=="never")&&typeof TextEncoder<"u"&&typeof TextDecoder<"u";function utf8Count(He){for(var Qe=He.length,it=0,lt=0;lt<Qe;){var ut=He.charCodeAt(lt++);if(ut&4294967168)if(!(ut&4294965248))it+=2;else{if(ut>=55296&&ut<=56319&&lt<Qe){var dt=He.charCodeAt(lt);(dt&64512)===56320&&(++lt,ut=((ut&1023)<<10)+(dt&1023)+65536)}ut&4294901760?it+=4:it+=3}else{it++;continue}}return it}function utf8EncodeJs(He,Qe,it){for(var lt=He.length,ut=it,dt=0;dt<lt;){var xt=He.charCodeAt(dt++);if(xt&4294967168)if(!(xt&4294965248))Qe[ut++]=xt>>6&31|192;else{if(xt>=55296&&xt<=56319&&dt<lt){var ft=He.charCodeAt(dt);(ft&64512)===56320&&(++dt,xt=((xt&1023)<<10)+(ft&1023)+65536)}xt&4294901760?(Qe[ut++]=xt>>18&7|240,Qe[ut++]=xt>>12&63|128,Qe[ut++]=xt>>6&63|128):(Qe[ut++]=xt>>12&15|224,Qe[ut++]=xt>>6&63|128)}else{Qe[ut++]=xt;continue}Qe[ut++]=xt&63|128}}var sharedTextEncoder=TEXT_ENCODING_AVAILABLE?new TextEncoder:void 0,TEXT_ENCODER_THRESHOLD=TEXT_ENCODING_AVAILABLE?typeof process$1<"u"&&((_b=process$1===null||process$1===void 0?void 0:define_process_env_default)===null||_b===void 0?void 0:_b.TEXT_ENCODING)!=="force"?200:0:UINT32_MAX;function utf8EncodeTEencode(He,Qe,it){Qe.set(sharedTextEncoder.encode(He),it)}function utf8EncodeTEencodeInto(He,Qe,it){sharedTextEncoder.encodeInto(He,Qe.subarray(it))}var utf8EncodeTE=sharedTextEncoder?.encodeInto?utf8EncodeTEencodeInto:utf8EncodeTEencode,CHUNK_SIZE$1=4096;function utf8DecodeJs(He,Qe,it){for(var lt=Qe,ut=lt+it,dt=[],xt="";lt<ut;){var ft=He[lt++];if(!(ft&128))dt.push(ft);else if((ft&224)===192){var vt=He[lt++]&63;dt.push((ft&31)<<6|vt)}else if((ft&240)===224){var vt=He[lt++]&63,kt=He[lt++]&63;dt.push((ft&31)<<12|vt<<6|kt)}else if((ft&248)===240){var vt=He[lt++]&63,kt=He[lt++]&63,St=He[lt++]&63,Tt=(ft&7)<<18|vt<<12|kt<<6|St;Tt>65535&&(Tt-=65536,dt.push(Tt>>>10&1023|55296),Tt=56320|Tt&1023),dt.push(Tt)}else dt.push(ft);dt.length>=CHUNK_SIZE$1&&(xt+=String.fromCharCode.apply(String,dt),dt.length=0)}return dt.length>0&&(xt+=String.fromCharCode.apply(String,dt)),xt}var sharedTextDecoder=TEXT_ENCODING_AVAILABLE?new TextDecoder:null,TEXT_DECODER_THRESHOLD=TEXT_ENCODING_AVAILABLE?typeof process$1<"u"&&((_c=process$1===null||process$1===void 0?void 0:define_process_env_default)===null||_c===void 0?void 0:_c.TEXT_DECODER)!=="force"?200:0:UINT32_MAX;function utf8DecodeTD(He,Qe,it){var lt=He.subarray(Qe,Qe+it);return sharedTextDecoder.decode(lt)}var ExtData=function(){function He(Qe,it){this.type=Qe,this.data=it}return He}(),__extends$1=function(){var He=function(Qe,it){return He=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(lt,ut){lt.__proto__=ut}||function(lt,ut){for(var dt in ut)Object.prototype.hasOwnProperty.call(ut,dt)&&(lt[dt]=ut[dt])},He(Qe,it)};return function(Qe,it){if(typeof it!="function"&&it!==null)throw new TypeError("Class extends value "+String(it)+" is not a constructor or null");He(Qe,it);function lt(){this.constructor=Qe}Qe.prototype=it===null?Object.create(it):(lt.prototype=it.prototype,new lt)}}(),DecodeError=function(He){__extends$1(Qe,He);function Qe(it){var lt=He.call(this,it)||this,ut=Object.create(Qe.prototype);return Object.setPrototypeOf(lt,ut),Object.defineProperty(lt,"name",{configurable:!0,enumerable:!1,value:Qe.name}),lt}return Qe}(Error),EXT_TIMESTAMP=-1,TIMESTAMP32_MAX_SEC=4294967296-1,TIMESTAMP64_MAX_SEC=17179869184-1;function encodeTimeSpecToTimestamp(He){var Qe=He.sec,it=He.nsec;if(Qe>=0&&it>=0&&Qe<=TIMESTAMP64_MAX_SEC)if(it===0&&Qe<=TIMESTAMP32_MAX_SEC){var lt=new Uint8Array(4),ut=new DataView(lt.buffer);return ut.setUint32(0,Qe),lt}else{var dt=Qe/4294967296,xt=Qe&4294967295,lt=new Uint8Array(8),ut=new DataView(lt.buffer);return ut.setUint32(0,it<<2|dt&3),ut.setUint32(4,xt),lt}else{var lt=new Uint8Array(12),ut=new DataView(lt.buffer);return ut.setUint32(0,it),setInt64(ut,4,Qe),lt}}function encodeDateToTimeSpec(He){var Qe=He.getTime(),it=Math.floor(Qe/1e3),lt=(Qe-it*1e3)*1e6,ut=Math.floor(lt/1e9);return{sec:it+ut,nsec:lt-ut*1e9}}function encodeTimestampExtension(He){if(He instanceof Date){var Qe=encodeDateToTimeSpec(He);return encodeTimeSpecToTimestamp(Qe)}else return null}function decodeTimestampToTimeSpec(He){var Qe=new DataView(He.buffer,He.byteOffset,He.byteLength);switch(He.byteLength){case 4:{var it=Qe.getUint32(0),lt=0;return{sec:it,nsec:lt}}case 8:{var ut=Qe.getUint32(0),dt=Qe.getUint32(4),it=(ut&3)*4294967296+dt,lt=ut>>>2;return{sec:it,nsec:lt}}case 12:{var it=getInt64(Qe,4),lt=Qe.getUint32(0);return{sec:it,nsec:lt}}default:throw new DecodeError("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(He.length))}}function decodeTimestampExtension(He){var Qe=decodeTimestampToTimeSpec(He);return new Date(Qe.sec*1e3+Qe.nsec/1e6)}var timestampExtension={type:EXT_TIMESTAMP,encode:encodeTimestampExtension,decode:decodeTimestampExtension},ExtensionCodec=function(){function He(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(timestampExtension)}return He.prototype.register=function(Qe){var it=Qe.type,lt=Qe.encode,ut=Qe.decode;if(it>=0)this.encoders[it]=lt,this.decoders[it]=ut;else{var dt=1+it;this.builtInEncoders[dt]=lt,this.builtInDecoders[dt]=ut}},He.prototype.tryToEncode=function(Qe,it){for(var lt=0;lt<this.builtInEncoders.length;lt++){var ut=this.builtInEncoders[lt];if(ut!=null){var dt=ut(Qe,it);if(dt!=null){var xt=-1-lt;return new ExtData(xt,dt)}}}for(var lt=0;lt<this.encoders.length;lt++){var ut=this.encoders[lt];if(ut!=null){var dt=ut(Qe,it);if(dt!=null){var xt=lt;return new ExtData(xt,dt)}}}return Qe instanceof ExtData?Qe:null},He.prototype.decode=function(Qe,it,lt){var ut=it<0?this.builtInDecoders[-1-it]:this.decoders[it];return ut?ut(Qe,it,lt):new ExtData(it,Qe)},He.defaultCodec=new He,He}();function ensureUint8Array(He){return He instanceof Uint8Array?He:ArrayBuffer.isView(He)?new Uint8Array(He.buffer,He.byteOffset,He.byteLength):He instanceof ArrayBuffer?new Uint8Array(He):Uint8Array.from(He)}function createDataView(He){if(He instanceof ArrayBuffer)return new DataView(He);var Qe=ensureUint8Array(He);return new DataView(Qe.buffer,Qe.byteOffset,Qe.byteLength)}var DEFAULT_MAX_DEPTH=100,DEFAULT_INITIAL_BUFFER_SIZE=2048,Encoder=function(){function He(Qe,it,lt,ut,dt,xt,ft,vt){Qe===void 0&&(Qe=ExtensionCodec.defaultCodec),it===void 0&&(it=void 0),lt===void 0&&(lt=DEFAULT_MAX_DEPTH),ut===void 0&&(ut=DEFAULT_INITIAL_BUFFER_SIZE),dt===void 0&&(dt=!1),xt===void 0&&(xt=!1),ft===void 0&&(ft=!1),vt===void 0&&(vt=!1),this.extensionCodec=Qe,this.context=it,this.maxDepth=lt,this.initialBufferSize=ut,this.sortKeys=dt,this.forceFloat32=xt,this.ignoreUndefined=ft,this.forceIntegerToFloat=vt,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return He.prototype.reinitializeState=function(){this.pos=0},He.prototype.encodeSharedRef=function(Qe){return this.reinitializeState(),this.doEncode(Qe,1),this.bytes.subarray(0,this.pos)},He.prototype.encode=function(Qe){return this.reinitializeState(),this.doEncode(Qe,1),this.bytes.slice(0,this.pos)},He.prototype.doEncode=function(Qe,it){if(it>this.maxDepth)throw new Error("Too deep objects in depth ".concat(it));Qe==null?this.encodeNil():typeof Qe=="boolean"?this.encodeBoolean(Qe):typeof Qe=="number"?this.encodeNumber(Qe):typeof Qe=="string"?this.encodeString(Qe):this.encodeObject(Qe,it)},He.prototype.ensureBufferSizeToWrite=function(Qe){var it=this.pos+Qe;this.view.byteLength<it&&this.resizeBuffer(it*2)},He.prototype.resizeBuffer=function(Qe){var it=new ArrayBuffer(Qe),lt=new Uint8Array(it),ut=new DataView(it);lt.set(this.bytes),this.view=ut,this.bytes=lt},He.prototype.encodeNil=function(){this.writeU8(192)},He.prototype.encodeBoolean=function(Qe){Qe===!1?this.writeU8(194):this.writeU8(195)},He.prototype.encodeNumber=function(Qe){Number.isSafeInteger(Qe)&&!this.forceIntegerToFloat?Qe>=0?Qe<128?this.writeU8(Qe):Qe<256?(this.writeU8(204),this.writeU8(Qe)):Qe<65536?(this.writeU8(205),this.writeU16(Qe)):Qe<4294967296?(this.writeU8(206),this.writeU32(Qe)):(this.writeU8(207),this.writeU64(Qe)):Qe>=-32?this.writeU8(224|Qe+32):Qe>=-128?(this.writeU8(208),this.writeI8(Qe)):Qe>=-32768?(this.writeU8(209),this.writeI16(Qe)):Qe>=-2147483648?(this.writeU8(210),this.writeI32(Qe)):(this.writeU8(211),this.writeI64(Qe)):this.forceFloat32?(this.writeU8(202),this.writeF32(Qe)):(this.writeU8(203),this.writeF64(Qe))},He.prototype.writeStringHeader=function(Qe){if(Qe<32)this.writeU8(160+Qe);else if(Qe<256)this.writeU8(217),this.writeU8(Qe);else if(Qe<65536)this.writeU8(218),this.writeU16(Qe);else if(Qe<4294967296)this.writeU8(219),this.writeU32(Qe);else throw new Error("Too long string: ".concat(Qe," bytes in UTF-8"))},He.prototype.encodeString=function(Qe){var it=5,lt=Qe.length;if(lt>TEXT_ENCODER_THRESHOLD){var ut=utf8Count(Qe);this.ensureBufferSizeToWrite(it+ut),this.writeStringHeader(ut),utf8EncodeTE(Qe,this.bytes,this.pos),this.pos+=ut}else{var ut=utf8Count(Qe);this.ensureBufferSizeToWrite(it+ut),this.writeStringHeader(ut),utf8EncodeJs(Qe,this.bytes,this.pos),this.pos+=ut}},He.prototype.encodeObject=function(Qe,it){var lt=this.extensionCodec.tryToEncode(Qe,this.context);if(lt!=null)this.encodeExtension(lt);else if(Array.isArray(Qe))this.encodeArray(Qe,it);else if(ArrayBuffer.isView(Qe))this.encodeBinary(Qe);else if(typeof Qe=="object")this.encodeMap(Qe,it);else throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(Qe)))},He.prototype.encodeBinary=function(Qe){var it=Qe.byteLength;if(it<256)this.writeU8(196),this.writeU8(it);else if(it<65536)this.writeU8(197),this.writeU16(it);else if(it<4294967296)this.writeU8(198),this.writeU32(it);else throw new Error("Too large binary: ".concat(it));var lt=ensureUint8Array(Qe);this.writeU8a(lt)},He.prototype.encodeArray=function(Qe,it){var lt=Qe.length;if(lt<16)this.writeU8(144+lt);else if(lt<65536)this.writeU8(220),this.writeU16(lt);else if(lt<4294967296)this.writeU8(221),this.writeU32(lt);else throw new Error("Too large array: ".concat(lt));for(var ut=0,dt=Qe;ut<dt.length;ut++){var xt=dt[ut];this.doEncode(xt,it+1)}},He.prototype.countWithoutUndefined=function(Qe,it){for(var lt=0,ut=0,dt=it;ut<dt.length;ut++){var xt=dt[ut];Qe[xt]!==void 0&&lt++}return lt},He.prototype.encodeMap=function(Qe,it){var lt=Object.keys(Qe);this.sortKeys&&lt.sort();var ut=this.ignoreUndefined?this.countWithoutUndefined(Qe,lt):lt.length;if(ut<16)this.writeU8(128+ut);else if(ut<65536)this.writeU8(222),this.writeU16(ut);else if(ut<4294967296)this.writeU8(223),this.writeU32(ut);else throw new Error("Too large map object: ".concat(ut));for(var dt=0,xt=lt;dt<xt.length;dt++){var ft=xt[dt],vt=Qe[ft];this.ignoreUndefined&&vt===void 0||(this.encodeString(ft),this.doEncode(vt,it+1))}},He.prototype.encodeExtension=function(Qe){var it=Qe.data.length;if(it===1)this.writeU8(212);else if(it===2)this.writeU8(213);else if(it===4)this.writeU8(214);else if(it===8)this.writeU8(215);else if(it===16)this.writeU8(216);else if(it<256)this.writeU8(199),this.writeU8(it);else if(it<65536)this.writeU8(200),this.writeU16(it);else if(it<4294967296)this.writeU8(201),this.writeU32(it);else throw new Error("Too large extension object: ".concat(it));this.writeI8(Qe.type),this.writeU8a(Qe.data)},He.prototype.writeU8=function(Qe){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,Qe),this.pos++},He.prototype.writeU8a=function(Qe){var it=Qe.length;this.ensureBufferSizeToWrite(it),this.bytes.set(Qe,this.pos),this.pos+=it},He.prototype.writeI8=function(Qe){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,Qe),this.pos++},He.prototype.writeU16=function(Qe){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,Qe),this.pos+=2},He.prototype.writeI16=function(Qe){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,Qe),this.pos+=2},He.prototype.writeU32=function(Qe){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,Qe),this.pos+=4},He.prototype.writeI32=function(Qe){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,Qe),this.pos+=4},He.prototype.writeF32=function(Qe){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,Qe),this.pos+=4},He.prototype.writeF64=function(Qe){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,Qe),this.pos+=8},He.prototype.writeU64=function(Qe){this.ensureBufferSizeToWrite(8),setUint64(this.view,this.pos,Qe),this.pos+=8},He.prototype.writeI64=function(Qe){this.ensureBufferSizeToWrite(8),setInt64(this.view,this.pos,Qe),this.pos+=8},He}();function prettyByte(He){return"".concat(He<0?"-":"","0x").concat(Math.abs(He).toString(16).padStart(2,"0"))}var DEFAULT_MAX_KEY_LENGTH=16,DEFAULT_MAX_LENGTH_PER_KEY=16,CachedKeyDecoder=function(){function He(Qe,it){Qe===void 0&&(Qe=DEFAULT_MAX_KEY_LENGTH),it===void 0&&(it=DEFAULT_MAX_LENGTH_PER_KEY),this.maxKeyLength=Qe,this.maxLengthPerKey=it,this.hit=0,this.miss=0,this.caches=[];for(var lt=0;lt<this.maxKeyLength;lt++)this.caches.push([])}return He.prototype.canBeCached=function(Qe){return Qe>0&&Qe<=this.maxKeyLength},He.prototype.find=function(Qe,it,lt){var ut=this.caches[lt-1];e:for(var dt=0,xt=ut;dt<xt.length;dt++){for(var ft=xt[dt],vt=ft.bytes,kt=0;kt<lt;kt++)if(vt[kt]!==Qe[it+kt])continue e;return ft.str}return null},He.prototype.store=function(Qe,it){var lt=this.caches[Qe.length-1],ut={bytes:Qe,str:it};lt.length>=this.maxLengthPerKey?lt[Math.random()*lt.length|0]=ut:lt.push(ut)},He.prototype.decode=function(Qe,it,lt){var ut=this.find(Qe,it,lt);if(ut!=null)return this.hit++,ut;this.miss++;var dt=utf8DecodeJs(Qe,it,lt),xt=Uint8Array.prototype.slice.call(Qe,it,it+lt);return this.store(xt,dt),dt},He}(),__awaiter$1=function(He,Qe,it,lt){function ut(dt){return dt instanceof it?dt:new it(function(xt){xt(dt)})}return new(it||(it=Promise))(function(dt,xt){function ft(St){try{kt(lt.next(St))}catch(Tt){xt(Tt)}}function vt(St){try{kt(lt.throw(St))}catch(Tt){xt(Tt)}}function kt(St){St.done?dt(St.value):ut(St.value).then(ft,vt)}kt((lt=lt.apply(He,Qe||[])).next())})},__generator$1=function(He,Qe){var it={label:0,sent:function(){if(dt[0]&1)throw dt[1];return dt[1]},trys:[],ops:[]},lt,ut,dt,xt;return xt={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(xt[Symbol.iterator]=function(){return this}),xt;function ft(kt){return function(St){return vt([kt,St])}}function vt(kt){if(lt)throw new TypeError("Generator is already executing.");for(;it;)try{if(lt=1,ut&&(dt=kt[0]&2?ut.return:kt[0]?ut.throw||((dt=ut.return)&&dt.call(ut),0):ut.next)&&!(dt=dt.call(ut,kt[1])).done)return dt;switch(ut=0,dt&&(kt=[kt[0]&2,dt.value]),kt[0]){case 0:case 1:dt=kt;break;case 4:return it.label++,{value:kt[1],done:!1};case 5:it.label++,ut=kt[1],kt=[0];continue;case 7:kt=it.ops.pop(),it.trys.pop();continue;default:if(dt=it.trys,!(dt=dt.length>0&&dt[dt.length-1])&&(kt[0]===6||kt[0]===2)){it=0;continue}if(kt[0]===3&&(!dt||kt[1]>dt[0]&&kt[1]<dt[3])){it.label=kt[1];break}if(kt[0]===6&&it.label<dt[1]){it.label=dt[1],dt=kt;break}if(dt&&it.label<dt[2]){it.label=dt[2],it.ops.push(kt);break}dt[2]&&it.ops.pop(),it.trys.pop();continue}kt=Qe.call(He,it)}catch(St){kt=[6,St],ut=0}finally{lt=dt=0}if(kt[0]&5)throw kt[1];return{value:kt[0]?kt[1]:void 0,done:!0}}},__asyncValues$1=function(He){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Qe=He[Symbol.asyncIterator],it;return Qe?Qe.call(He):(He=typeof __values=="function"?__values(He):He[Symbol.iterator](),it={},lt("next"),lt("throw"),lt("return"),it[Symbol.asyncIterator]=function(){return this},it);function lt(dt){it[dt]=He[dt]&&function(xt){return new Promise(function(ft,vt){xt=He[dt](xt),ut(ft,vt,xt.done,xt.value)})}}function ut(dt,xt,ft,vt){Promise.resolve(vt).then(function(kt){dt({value:kt,done:ft})},xt)}},__await$1=function(He){return this instanceof __await$1?(this.v=He,this):new __await$1(He)},__asyncGenerator$1=function(He,Qe,it){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var lt=it.apply(He,Qe||[]),ut,dt=[];return ut={},xt("next"),xt("throw"),xt("return"),ut[Symbol.asyncIterator]=function(){return this},ut;function xt(Mt){lt[Mt]&&(ut[Mt]=function(Nt){return new Promise(function(At,$t){dt.push([Mt,Nt,At,$t])>1||ft(Mt,Nt)})})}function ft(Mt,Nt){try{vt(lt[Mt](Nt))}catch(At){Tt(dt[0][3],At)}}function vt(Mt){Mt.value instanceof __await$1?Promise.resolve(Mt.value.v).then(kt,St):Tt(dt[0][2],Mt)}function kt(Mt){ft("next",Mt)}function St(Mt){ft("throw",Mt)}function Tt(Mt,Nt){Mt(Nt),dt.shift(),dt.length&&ft(dt[0][0],dt[0][1])}},isValidMapKeyType=function(He){var Qe=typeof He;return Qe==="string"||Qe==="number"},HEAD_BYTE_REQUIRED=-1,EMPTY_VIEW=new DataView(new ArrayBuffer(0)),EMPTY_BYTES=new Uint8Array(EMPTY_VIEW.buffer),DataViewIndexOutOfBoundsError=function(){try{EMPTY_VIEW.getInt8(0)}catch(He){return He.constructor}throw new Error("never reached")}(),MORE_DATA=new DataViewIndexOutOfBoundsError("Insufficient data"),sharedCachedKeyDecoder=new CachedKeyDecoder,Decoder=function(){function He(Qe,it,lt,ut,dt,xt,ft,vt){Qe===void 0&&(Qe=ExtensionCodec.defaultCodec),it===void 0&&(it=void 0),lt===void 0&&(lt=UINT32_MAX),ut===void 0&&(ut=UINT32_MAX),dt===void 0&&(dt=UINT32_MAX),xt===void 0&&(xt=UINT32_MAX),ft===void 0&&(ft=UINT32_MAX),vt===void 0&&(vt=sharedCachedKeyDecoder),this.extensionCodec=Qe,this.context=it,this.maxStrLength=lt,this.maxBinLength=ut,this.maxArrayLength=dt,this.maxMapLength=xt,this.maxExtLength=ft,this.keyDecoder=vt,this.totalPos=0,this.pos=0,this.view=EMPTY_VIEW,this.bytes=EMPTY_BYTES,this.headByte=HEAD_BYTE_REQUIRED,this.stack=[]}return He.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=HEAD_BYTE_REQUIRED,this.stack.length=0},He.prototype.setBuffer=function(Qe){this.bytes=ensureUint8Array(Qe),this.view=createDataView(this.bytes),this.pos=0},He.prototype.appendBuffer=function(Qe){if(this.headByte===HEAD_BYTE_REQUIRED&&!this.hasRemaining(1))this.setBuffer(Qe);else{var it=this.bytes.subarray(this.pos),lt=ensureUint8Array(Qe),ut=new Uint8Array(it.length+lt.length);ut.set(it),ut.set(lt,it.length),this.setBuffer(ut)}},He.prototype.hasRemaining=function(Qe){return this.view.byteLength-this.pos>=Qe},He.prototype.createExtraByteError=function(Qe){var it=this,lt=it.view,ut=it.pos;return new RangeError("Extra ".concat(lt.byteLength-ut," of ").concat(lt.byteLength," byte(s) found at buffer[").concat(Qe,"]"))},He.prototype.decode=function(Qe){this.reinitializeState(),this.setBuffer(Qe);var it=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return it},He.prototype.decodeMulti=function(Qe){return __generator$1(this,function(it){switch(it.label){case 0:this.reinitializeState(),this.setBuffer(Qe),it.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return it.sent(),[3,1];case 3:return[2]}})},He.prototype.decodeAsync=function(Qe){var it,lt,ut,dt;return __awaiter$1(this,void 0,void 0,function(){var xt,ft,vt,kt,St,Tt,Mt,Nt;return __generator$1(this,function(At){switch(At.label){case 0:xt=!1,At.label=1;case 1:At.trys.push([1,6,7,12]),it=__asyncValues$1(Qe),At.label=2;case 2:return[4,it.next()];case 3:if(lt=At.sent(),!!lt.done)return[3,5];if(vt=lt.value,xt)throw this.createExtraByteError(this.totalPos);this.appendBuffer(vt);try{ft=this.doDecodeSync(),xt=!0}catch($t){if(!($t instanceof DataViewIndexOutOfBoundsError))throw $t}this.totalPos+=this.pos,At.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return kt=At.sent(),ut={error:kt},[3,12];case 7:return At.trys.push([7,,10,11]),lt&&!lt.done&&(dt=it.return)?[4,dt.call(it)]:[3,9];case 8:At.sent(),At.label=9;case 9:return[3,11];case 10:if(ut)throw ut.error;return[7];case 11:return[7];case 12:if(xt){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,ft]}throw St=this,Tt=St.headByte,Mt=St.pos,Nt=St.totalPos,new RangeError("Insufficient data in parsing ".concat(prettyByte(Tt)," at ").concat(Nt," (").concat(Mt," in the current buffer)"))}})})},He.prototype.decodeArrayStream=function(Qe){return this.decodeMultiAsync(Qe,!0)},He.prototype.decodeStream=function(Qe){return this.decodeMultiAsync(Qe,!1)},He.prototype.decodeMultiAsync=function(Qe,it){return __asyncGenerator$1(this,arguments,function(){var ut,dt,xt,ft,vt,kt,St,Tt,Mt;return __generator$1(this,function(Nt){switch(Nt.label){case 0:ut=it,dt=-1,Nt.label=1;case 1:Nt.trys.push([1,13,14,19]),xt=__asyncValues$1(Qe),Nt.label=2;case 2:return[4,__await$1(xt.next())];case 3:if(ft=Nt.sent(),!!ft.done)return[3,12];if(vt=ft.value,it&&dt===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(vt),ut&&(dt=this.readArraySize(),ut=!1,this.complete()),Nt.label=4;case 4:Nt.trys.push([4,9,,10]),Nt.label=5;case 5:return[4,__await$1(this.doDecodeSync())];case 6:return[4,Nt.sent()];case 7:return Nt.sent(),--dt===0?[3,8]:[3,5];case 8:return[3,10];case 9:if(kt=Nt.sent(),!(kt instanceof DataViewIndexOutOfBoundsError))throw kt;return[3,10];case 10:this.totalPos+=this.pos,Nt.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return St=Nt.sent(),Tt={error:St},[3,19];case 14:return Nt.trys.push([14,,17,18]),ft&&!ft.done&&(Mt=xt.return)?[4,__await$1(Mt.call(xt))]:[3,16];case 15:Nt.sent(),Nt.label=16;case 16:return[3,18];case 17:if(Tt)throw Tt.error;return[7];case 18:return[7];case 19:return[2]}})})},He.prototype.doDecodeSync=function(){e:for(;;){var Qe=this.readHeadByte(),it=void 0;if(Qe>=224)it=Qe-256;else if(Qe<192)if(Qe<128)it=Qe;else if(Qe<144){var lt=Qe-128;if(lt!==0){this.pushMapState(lt),this.complete();continue e}else it={}}else if(Qe<160){var lt=Qe-144;if(lt!==0){this.pushArrayState(lt),this.complete();continue e}else it=[]}else{var ut=Qe-160;it=this.decodeUtf8String(ut,0)}else if(Qe===192)it=null;else if(Qe===194)it=!1;else if(Qe===195)it=!0;else if(Qe===202)it=this.readF32();else if(Qe===203)it=this.readF64();else if(Qe===204)it=this.readU8();else if(Qe===205)it=this.readU16();else if(Qe===206)it=this.readU32();else if(Qe===207)it=this.readU64();else if(Qe===208)it=this.readI8();else if(Qe===209)it=this.readI16();else if(Qe===210)it=this.readI32();else if(Qe===211)it=this.readI64();else if(Qe===217){var ut=this.lookU8();it=this.decodeUtf8String(ut,1)}else if(Qe===218){var ut=this.lookU16();it=this.decodeUtf8String(ut,2)}else if(Qe===219){var ut=this.lookU32();it=this.decodeUtf8String(ut,4)}else if(Qe===220){var lt=this.readU16();if(lt!==0){this.pushArrayState(lt),this.complete();continue e}else it=[]}else if(Qe===221){var lt=this.readU32();if(lt!==0){this.pushArrayState(lt),this.complete();continue e}else it=[]}else if(Qe===222){var lt=this.readU16();if(lt!==0){this.pushMapState(lt),this.complete();continue e}else it={}}else if(Qe===223){var lt=this.readU32();if(lt!==0){this.pushMapState(lt),this.complete();continue e}else it={}}else if(Qe===196){var lt=this.lookU8();it=this.decodeBinary(lt,1)}else if(Qe===197){var lt=this.lookU16();it=this.decodeBinary(lt,2)}else if(Qe===198){var lt=this.lookU32();it=this.decodeBinary(lt,4)}else if(Qe===212)it=this.decodeExtension(1,0);else if(Qe===213)it=this.decodeExtension(2,0);else if(Qe===214)it=this.decodeExtension(4,0);else if(Qe===215)it=this.decodeExtension(8,0);else if(Qe===216)it=this.decodeExtension(16,0);else if(Qe===199){var lt=this.lookU8();it=this.decodeExtension(lt,1)}else if(Qe===200){var lt=this.lookU16();it=this.decodeExtension(lt,2)}else if(Qe===201){var lt=this.lookU32();it=this.decodeExtension(lt,4)}else throw new DecodeError("Unrecognized type byte: ".concat(prettyByte(Qe)));this.complete();for(var dt=this.stack;dt.length>0;){var xt=dt[dt.length-1];if(xt.type===0)if(xt.array[xt.position]=it,xt.position++,xt.position===xt.size)dt.pop(),it=xt.array;else continue e;else if(xt.type===1){if(!isValidMapKeyType(it))throw new DecodeError("The type of key must be string or number but "+typeof it);if(it==="__proto__")throw new DecodeError("The key __proto__ is not allowed");xt.key=it,xt.type=2;continue e}else if(xt.map[xt.key]=it,xt.readCount++,xt.readCount===xt.size)dt.pop(),it=xt.map;else{xt.key=null,xt.type=1;continue e}}return it}},He.prototype.readHeadByte=function(){return this.headByte===HEAD_BYTE_REQUIRED&&(this.headByte=this.readU8()),this.headByte},He.prototype.complete=function(){this.headByte=HEAD_BYTE_REQUIRED},He.prototype.readArraySize=function(){var Qe=this.readHeadByte();switch(Qe){case 220:return this.readU16();case 221:return this.readU32();default:{if(Qe<160)return Qe-144;throw new DecodeError("Unrecognized array type byte: ".concat(prettyByte(Qe)))}}},He.prototype.pushMapState=function(Qe){if(Qe>this.maxMapLength)throw new DecodeError("Max length exceeded: map length (".concat(Qe,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:Qe,key:null,readCount:0,map:{}})},He.prototype.pushArrayState=function(Qe){if(Qe>this.maxArrayLength)throw new DecodeError("Max length exceeded: array length (".concat(Qe,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:Qe,array:new Array(Qe),position:0})},He.prototype.decodeUtf8String=function(Qe,it){var lt;if(Qe>this.maxStrLength)throw new DecodeError("Max length exceeded: UTF-8 byte length (".concat(Qe,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+it+Qe)throw MORE_DATA;var ut=this.pos+it,dt;return this.stateIsMapKey()&&(!((lt=this.keyDecoder)===null||lt===void 0)&&lt.canBeCached(Qe))?dt=this.keyDecoder.decode(this.bytes,ut,Qe):Qe>TEXT_DECODER_THRESHOLD?dt=utf8DecodeTD(this.bytes,ut,Qe):dt=utf8DecodeJs(this.bytes,ut,Qe),this.pos+=it+Qe,dt},He.prototype.stateIsMapKey=function(){if(this.stack.length>0){var Qe=this.stack[this.stack.length-1];return Qe.type===1}return!1},He.prototype.decodeBinary=function(Qe,it){if(Qe>this.maxBinLength)throw new DecodeError("Max length exceeded: bin length (".concat(Qe,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(Qe+it))throw MORE_DATA;var lt=this.pos+it,ut=this.bytes.subarray(lt,lt+Qe);return this.pos+=it+Qe,ut},He.prototype.decodeExtension=function(Qe,it){if(Qe>this.maxExtLength)throw new DecodeError("Max length exceeded: ext length (".concat(Qe,") > maxExtLength (").concat(this.maxExtLength,")"));var lt=this.view.getInt8(this.pos+it),ut=this.decodeBinary(Qe,it+1);return this.extensionCodec.decode(ut,lt,this.context)},He.prototype.lookU8=function(){return this.view.getUint8(this.pos)},He.prototype.lookU16=function(){return this.view.getUint16(this.pos)},He.prototype.lookU32=function(){return this.view.getUint32(this.pos)},He.prototype.readU8=function(){var Qe=this.view.getUint8(this.pos);return this.pos++,Qe},He.prototype.readI8=function(){var Qe=this.view.getInt8(this.pos);return this.pos++,Qe},He.prototype.readU16=function(){var Qe=this.view.getUint16(this.pos);return this.pos+=2,Qe},He.prototype.readI16=function(){var Qe=this.view.getInt16(this.pos);return this.pos+=2,Qe},He.prototype.readU32=function(){var Qe=this.view.getUint32(this.pos);return this.pos+=4,Qe},He.prototype.readI32=function(){var Qe=this.view.getInt32(this.pos);return this.pos+=4,Qe},He.prototype.readU64=function(){var Qe=getUint64(this.view,this.pos);return this.pos+=8,Qe},He.prototype.readI64=function(){var Qe=getInt64(this.view,this.pos);return this.pos+=8,Qe},He.prototype.readF32=function(){var Qe=this.view.getFloat32(this.pos);return this.pos+=4,Qe},He.prototype.readF64=function(){var Qe=this.view.getFloat64(this.pos);return this.pos+=8,Qe},He}();const encoder=()=>new Encoder,decoder=()=>new Decoder;function urlSafeEncode(He){return He.replaceAll("/","_").replaceAll("+","-")}function urlSafeDecode(He){return He.replaceAll("_","/").replaceAll("-","+")}function base64ToBytes(He){const Qe=window.atob(urlSafeDecode(He));return Uint8Array.from(Qe,it=>it.codePointAt(0))}function bytesToBase64(He){const Qe=String.fromCodePoint(...He);return urlSafeEncode(window.btoa(Qe))}const msgpack={encode:He=>encoder().encode(He),decode:He=>decoder().decode(He),encodeBase64:He=>bytesToBase64(encoder().encode(He)),decodeBase64:He=>decoder().decode(base64ToBytes(He))};function encodeImportAsParams(He){return He?msgpack.encodeBase64(He):""}function decodeImportAsParams(He){if(He)try{return msgpack.decodeBase64(He)}catch{}}function encodeArtworkForImport(He){const Qe=omitBy(He?.media,isNil),it={...pick$1(He,["id","prompts","hidePrompts"]),media:Qe,extra:pick$1(He?.extra,["naturalPrompts"])};return encodeImportAsParams(it)}function encodeTaskForImport(He){if(!He)return null;const Qe="media"in He?omitBy(He.media,isNil):void 0,it={...omitBy(pick$1(He,["id","outputs","parameters","favoritedAt"]),isNil),media:Qe};return encodeImportAsParams(it)}function encodeInitialValuesForImport(He){return encodeImportAsParams(parseInitialValuesForImport(He))}function encodeCharacterForImport({characterId:He}){return encodeImportAsParams({characterId:He})}function decodeTaskForImport(He){return decodeImportAsParams(He)}function decodeArtworkForImport(He){return decodeImportAsParams(He)}function decodeInitialValuesForImport(He){return decodeImportAsParams(He)}function decodeCharacterForImport(He){return decodeImportAsParams(He)}function parseInitialValuesForImport(He){return omitBy(pick$1(He,taskParameterFieldsForTaskList),it=>it===void 0)}const modelChipStyles=ce$1({slots:{base:"flex items-center gap-2",label:"font-medium text-xs"},variants:{type:{normal:{base:"rounded-2xl px-3 py-1",label:"md:text-base"},compact:{base:"rounded w-fit h-auto px-1.5 py-0 mr-0",label:":md:text-xs"}}},defaultVariants:{type:"normal"}});var TrainingTaskStatus=(He=>(He.waiting="waiting",He.running="running",He.completed="completed",He.failed="failed",He))(TrainingTaskStatus||{}),GenerationModelVersionStatus=(He=>(He.available="available",He.waiting="waiting",He.importing="importing",He.validating="validating",He.archived="archived",He.invalid="invalid",He))(GenerationModelVersionStatus||{});const TYPE_REPLACEMENT={[GenerationModelType.UnknownModel]:GenerationModelType.SdV1Model,[GenerationModelType.UnknownLora]:GenerationModelType.Lora,[GenerationModelType.MultiLora]:GenerationModelType.Lora,[GenerationModelType.UserMultiLora]:GenerationModelType.Lora,[GenerationModelType.UserLora]:GenerationModelType.Lora,[GenerationModelType.UserSdxlLora]:GenerationModelType.Lora,[GenerationModelType.SdxlLora]:GenerationModelType.Lora,[GenerationModelType.Dit7BLora]:GenerationModelType.Dit7Lora,[GenerationModelType.Dit7BModel]:GenerationModelType.Dit7Model,[GenerationModelType.Dit7BVae]:GenerationModelType.Dit7Vae},TYPE_REPLACEMENT_XL={...TYPE_REPLACEMENT,[GenerationModelType.SdxlModel]:GenerationModelType.SdV1Model,[GenerationModelType.SdxlVae]:GenerationModelType.Vae},typeReplacementMap=He=>He?TYPE_REPLACEMENT_XL:TYPE_REPLACEMENT,formatModelType=(He,Qe)=>(()=>{let lt=He;return Qe?.replacement&&(lt=Qe.replacement[He]||He),Qe?.tagType&&(lt=`${Qe.tagType}-${lt}`),lt})().replaceAll("_","").toLowerCase(),getModelTypeChipConfig=(He,Qe)=>{const{type:it}=Qe,lt=isModelPixaiInhouse(Qe.tags)?"pixai":void 0,dt=He(`market:model.type.${formatModelType(it,((...ft)=>({replacement:typeReplacementMap(...ft),tagType:lt}))())}`),xt=$$3({type:it,tagType:lt}).with({tagType:"pixai"},()=>"bg-[#E4C1F9]").with({type:isUserLoraUnion},()=>"bg-[#E4C1F9]").with({type:GenerationModelType.UserMultiLora},()=>"bg-[#E4C1F9]").with({type:isLoraUnion},()=>"bg-indigo-300").with({type:GenerationModelType.MultiLora},()=>"bg-indigo-300").with({type:GenerationModelType.SdV1Model},()=>"bg-[#FCF6BD]").with({type:GenerationModelType.SdxlModel},()=>"bg-[#D0F4DD]").with({type:GenerationModelType.Sd3MediumModel},()=>"bg-[#A9DDF9]").with({type:isSDModelUnion},()=>"bg-blue-300").otherwise(()=>"bg-stone-300");return{label:dt,bgClassName:xt}};function ModelTypeChip(He){const{t:Qe}=useTranslation(["market"]),{label:it,bgClassName:lt}=getModelTypeChipConfig(Qe,{type:He.model.type,tags:He.model.tags}),ut=modelChipStyles({type:He.type});return jsxRuntimeExports.jsx("div",{className:ut.base({class:["text-black",He.className,lt]}),style:He.style,children:jsxRuntimeExports.jsx("p",{className:ut.label(),children:it})})}const getModelEarlyAccessChipConfig=He=>isModelEarlyAccess(He)?{label:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.early-access.label"}),bgClassName:"bg-purple-600"}:null;function ModelEarlyAccessChip(He){const Qe=getModelEarlyAccessChipConfig(He.model.extra);if(!Qe)return null;const it=modelChipStyles({type:He.type});return jsxRuntimeExports.jsx("div",{className:it.base({class:["text-white",He.className,Qe.bgClassName]}),style:He.style,children:jsxRuntimeExports.jsx("p",{className:it.label(),children:Qe.label})})}const getModelAlphaTestChipConfig=He=>isModelEarlyAccess(He)?{label:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.beta.label"}),bgClassName:"bg-purple-600"}:isAlphaTestModel(He)?{label:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.alpha.label"}),bgClassName:"bg-purple-600"}:null;function AlphaTestModelChip(He){const Qe=getModelAlphaTestChipConfig(He.model.extra);if(!Qe)return null;const it=modelChipStyles({type:He.type});return jsxRuntimeExports.jsx("div",{className:it.base({class:["text-white",He.className,Qe.bgClassName]}),style:He.style,children:jsxRuntimeExports.jsx("p",{className:it.label(),children:Qe.label})})}function getModelLoraBaseModelChipsConfig(He){const{loraBaseModelTypes:Qe,type:it}=He;return(isMultiUnionLora(it)?Qe:[it])?.flatMap(ut=>{const dt=getModelLoraBaseModelChipConfig(ut);return dt?[dt]:[]})}function getModelLoraBaseModelChipConfig(He){return $$3(He).when(isDitV1Model,()=>({label:"DiT",bgClassName:"bg-[#E4C1F9]"})).when(a$3(N$4.union(GenerationModelType.SdxlModel,GenerationModelType.SdxlLora,GenerationModelType.UserSdxlLora)),()=>({label:"XL",bgClassName:"bg-[#D0F4DD]"})).when(a$3(N$4.union(GenerationModelType.SdV1Model,GenerationModelType.Lora,GenerationModelType.UserLora)),()=>({label:"SD",bgClassName:"bg-[#FCF6BD]"})).otherwise(()=>{})}function ModelLoraBaseTypeChips(He){if(!isLora(He.model.type))return null;const Qe=getModelLoraBaseModelChipsConfig(He.model)??[],it=modelChipStyles({type:He.type});return jsxRuntimeExports.jsx("div",{className:twMerge("inline-flex items-center",He.className),style:He.style,children:Qe.map(lt=>jsxRuntimeExports.jsx("span",{className:it.base({class:["text-black first-of-type:rounded-l-2xl first-of-type:pl-3 last-of-type:rounded-r-2xl last-of-type:pr-3",He.labelStyleProps?.className,lt.bgClassName]}),style:He.labelStyleProps?.style,children:jsxRuntimeExports.jsx("span",{className:it.label(),children:lt.label})},lt.label))})}function getModelVersionStatusChipConfig(He,Qe,it){return Qe?$$3(Qe.status).with("waiting",()=>({label:He("market:model.version-status.waiting"),bgClassName:"bg-yellow-500"})).with("validating",()=>({label:He("market:model.version-status.running"),bgClassName:"bg-yellow-500"})).with("archived",()=>({label:He("market:model.version-status.archived"),bgClassName:"bg-slate-300"})).with("invalid",()=>({label:He("market:model.version-status.invalid"),bgClassName:"bg-red-300"})).with("available",()=>it?.showAvailable?{label:He("market:model.version-status.available"),bgClassName:"bg-green-300"}:void 0).otherwise(()=>{}):{label:He("market:model.versions-empty"),bgClassName:"bg-slate-300"}}function ModelVersionStatusChip(He){const{t:Qe}=useTranslation("market"),it=getModelVersionStatusChipConfig(Qe,He.modelVersion,He.chipConfigOpts);if(!it)return null;const lt=modelChipStyles({type:He.type});return jsxRuntimeExports.jsx("div",{className:lt.base({class:["text-white",He.className,it.bgClassName]}),style:He.style,children:jsxRuntimeExports.jsx("p",{className:lt.label(),children:it.label})})}function CharacterModelCard({model:He,onClick:Qe}){const{t:it}=useTranslation("market");return jsxRuntimeExports.jsx(Link,{to:`/model/${He.model?.id}/${He.id}`,target:"_blank",onClick:Qe,children:jsxRuntimeExports.jsxs("div",{className:"flex flex-shrink-0 h-[94px] lg:h-[132px] w-[218px] lg:w-[274px] gap-2 bg-background-secondary dark:bg-background-light hover:shadow-xl rounded-md lg:rounded-xl overflow-hidden transition-all cursor-pointer",children:[jsxRuntimeExports.jsx("div",{className:"h-full aspect-1",children:jsxRuntimeExports.jsx(MediaPreview$1,{className:"h-full object-fill",mediaId:He.mediaId})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col justify-between pr-2 pt-2 pb-2 lg:pb-[10px] text-black dark:text-white",children:[jsxRuntimeExports.jsx("span",{className:"rounded px-1 text-xs font-semibold bg-neutral-200 dark:bg-gray-500 mr-auto",children:it(`market:model.type.${formatModelType(He.modelType,{})}`)}),jsxRuntimeExports.jsx("div",{className:"text-base font-semibold lg:text-xl font-roboto overflow-ellipsis line-clamp-2",children:He.model?.title})]})]})})}function CharacterModelPreviewCard({model:He}){const{t:Qe}=useTranslation("market");return jsxRuntimeExports.jsx(Link,{to:`/model/${He.model?.id}/${He.id}`,target:"_blank",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-2 rounded-lg h-[72px] bg-background-secondary overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"h-full m-0.5 aspect-1 rounded-lg overflow-hidden flex-shrink-0",children:jsxRuntimeExports.jsx(MediaPreview$1,{className:"h-full object-fill",mediaId:He.mediaId})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col justify-between pr-2 pt-2 pb-2 text-black dark:text-white",children:[jsxRuntimeExports.jsx("span",{className:"rounded px-1 text-xs font-semibold bg-neutral-200 dark:bg-gray-500 mr-auto",children:Qe(`market:model.type.${formatModelType(He.modelType,{})}`)}),jsxRuntimeExports.jsx("div",{className:"text-base font-semibold font-roboto overflow-ellipsis truncate",children:He.model?.title})]})]})})}const materialSymbolsKeyboardArrowDown=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m12 15.4l-6-6L7.4 8l4.6 4.6L16.6 8L18 9.4l-6 6Z"})});function ExpandableText({text:He,lines:Qe,expandPosition:it="inline",onExpand:lt,...ut}){const{t:dt}=useTranslation("common"),xt=it==="inline",ft=reactExports.useRef(null),[vt,kt]=reactExports.useState(!1);function St(){if(ft.current){const Mt=ft.current.clientHeight,Nt=ft.current.scrollHeight;kt(Mt<Nt)}}reactExports.useEffect(St,[He,Qe]),reactExports.useEffect(()=>{const Mt=new ResizeObserver(St);return ft.current&&Mt.observe(ft.current),()=>Mt.disconnect()},[]);const Tt=vt?jsxRuntimeExports.jsxs("div",{className:"inline-flex items-center relative float-right clear-both cursor-pointer rounded-md px-1 ml-auto opacity-40",onClick:lt,style:{marginLeft:"auto"},children:[dt("common:more"),jsxRuntimeExports.jsx(materialSymbolsKeyboardArrowDown,{})]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});return jsxRuntimeExports.jsxs("div",{...ut,className:cx("flex text-xs leading-4",!xt&&"flex-col gap-1",ut?.className),children:[jsxRuntimeExports.jsxs("div",{ref:ft,className:cx("overflow-hidden relative",xt&&'before:float-right before:content-[""] before:h-[calc(100%-16px)]'),style:{maxHeight:`${Qe}rem`},children:[xt&&Tt,He]}),!xt&&Tt]})}function ExpandableTextWithDialog({title:He,text:Qe,...it}){const[lt,ut]=reactExports.useState(!1),dt=reactExports.useCallback(()=>{ut(!0)},[]),xt=reactExports.useCallback(()=>{ut(!1)},[]),ft=jsxRuntimeExports.jsxs(UIDialog,{dismissable:!0,open:lt,onClose:xt,children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:He,className:"flex justify-between items-center",children:({heading:vt})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:"font-semibold font-roboto",children:vt}),jsxRuntimeExports.jsx(UIButton$1,{className:"text-gray-500 p-0",variant:"ghost",onPress:xt,icon:jsxRuntimeExports.jsx(icBaselineClose,{className:"w-6 h-6"})})]})}),jsxRuntimeExports.jsx("p",{className:"px-4 msm:px-6 pb-2 msm:pb-4",children:Qe})]});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ExpandableText,{...it,text:Qe,onExpand:dt}),ft]})}function WorldCharacterDetailHeader(He){return jsxRuntimeExports.jsxs("div",{className:"font-semibold font-roboto mb-3 lg:mb-6 items-end",children:[jsxRuntimeExports.jsx("span",{className:"text-base lg:text-2xl mr-[6px] lg:mr-3",children:He.heading}),jsxRuntimeExports.jsx("span",{className:"text-sm lg:text-xl text-black dark:text-gray-300 text-opacity-40",children:He.trailing})]})}function WorldTagList({tags:He}){const[Qe,it]=reactExports.useState(!1),lt=reactExports.useRef(null),[ut,dt]=reactExports.useState(!1);return reactExports.useEffect(()=>{if(lt.current){const xt=lt.current.clientHeight,ft=lt.current.scrollHeight;dt(xt<ft)}},[He]),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("div",{ref:lt,className:cx("flex flex-wrap gap-2",!Qe&&"h-[28px] overflow-hidden w-min-0"),children:He.map(({name:xt,mediaId:ft},vt)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center px-3 py-1 gap-1 rounded-2xl bg-background-secondary text-black dark:text-inherit text-nowrap",children:[ft&&jsxRuntimeExports.jsx("img",{className:"-ml-1 w-4 h-4 rounded-full",src:getImageThumbnailUrl(ft)}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold",children:xt})]},`tag-${vt}`))}),ut&&jsxRuntimeExports.jsx(IconButton,{className:"float-right ml-2 h-7 rounded-[30px] bg-background-secondary",onClick:()=>{it(xt=>!xt)},children:jsxRuntimeExports.jsx(solarAltArrowDownBold,{className:cx("text-sm transition",Qe&&"rotate-180")})})]})}const store=getDefaultStore(),characterModelAtom=atom(void 0),getPreviousCharacterParameters=()=>store.get(characterModelAtom),setPreviousCharacterParameters=He=>store.set(characterModelAtom,He),clearPreviousCharacterParameters=()=>store.set(characterModelAtom,void 0),characterApplyModelAtom=atom(!1),getCharacterMayApplyModel=()=>store.get(characterApplyModelAtom),setCharacterMayApplyModel=()=>store.set(characterApplyModelAtom,!0),setCharacterModelApplyAccepted=()=>store.set(characterApplyModelAtom,!1);function useLocalizedField(He,Qe,it){const lt=useAtomValue(localeAtom);return(He[lt]??He[DEFAULT_LOCALE])?.[Qe]||it}const icBaselineShare=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81c1.66 0 3-1.34 3-3s-1.34-3-3-3s-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65c0 1.61 1.31 2.92 2.92 2.92c1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"})}),materialSymbolsBookmarkAdd=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M5 21V5q0-.825.588-1.413T7 3h7q-.5.75-.75 1.438T13 6q0 1.8 1.137 3.175T17 10.9q.575.075 1 .075t1-.075V21l-7-3l-7 3ZM17 9V7h-2V5h2V3h2v2h2v2h-2v2h-2Z"})}),materialSymbolsChevronRight=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12.6 12L8 7.4L9.4 6l6 6l-6 6L8 16.6l4.6-4.6Z"})}),mdiBookmarkCheck=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17 3a2 2 0 0 1 2 2v16l-7-3l-7 3V5a2 2 0 0 1 2-2h10m-6 11l6.25-6.24l-1.41-1.42L11 11.18L8.41 8.59L7 10l4 4Z"})});function WorldCharacterCommentArea({artworkId:He}){const{data:Qe}=useGetArtwork(He),[it,lt]=reactExports.useState(!1);return Qe?jsxRuntimeExports.jsx("div",{className:cx("w-full bg-neutral-100 dark:bg-neutral-700 rounded-lg p-4"),children:jsxRuntimeExports.jsx(reactExports.Suspense,{children:jsxRuntimeExports.jsxs(CommentProvider,{topicId:Qe.id,refType:RefType.Artwork,initLoadSize:3,onLoadMore:()=>{lt(ut=>(ut||track("show_more_comments"),!0))},children:[jsxRuntimeExports.jsx(CommentComposer,{className:"mb-4 pb-4 border-b border-black/20 dark:border-white/20"}),jsxRuntimeExports.jsx(CommentList,{windowed:it,loadMode:it?"scroll":"button",style:{height:it?440:void 0}})]})})}):null}const icBaselineAdminPanelSettings=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17 11c.34 0 .67.04 1 .09V6.27L10.5 3L3 6.27v4.91c0 4.54 3.2 8.79 7.5 9.82c.55-.13 1.08-.32 1.6-.55c-.69-.98-1.1-2.17-1.1-3.45c0-3.31 2.69-6 6-6z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17 13c-2.21 0-4 1.79-4 4s1.79 4 4 4s4-1.79 4-4s-1.79-4-4-4zm0 1.38c.62 0 1.12.51 1.12 1.12s-.51 1.12-1.12 1.12s-1.12-.51-1.12-1.12s.5-1.12 1.12-1.12zm0 5.37c-.93 0-1.74-.46-2.24-1.17c.05-.72 1.51-1.08 2.24-1.08s2.19.36 2.24 1.08c-.5.71-1.31 1.17-2.24 1.17z"})]}),icBaselineError=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),opAction=async(He,Qe)=>{try{await dialogConfirm({title:jsxRuntimeExports.jsx("div",{className:"font-semibold text-red-500",children:"Are you sure about this?"}),description:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs(Alert,{color:"error",icon:jsxRuntimeExports.jsx(icBaselineError,{className:"size-6"}),className:"text-sm",children:["This operation is possible only because you are a designated admin. Proceed of the operation is"," ",jsxRuntimeExports.jsx("strong",{children:"permanent and cannot be undone"}),". Please proceed with caution."]}),Qe]}),ConfirmButtonProps:{className:"bg-red-600 text-white",variant:"contained"}}),await He(),toast.success("success")}catch(it){if(it===UserCancelled)return;toast.error(it?.message)}},icBaselinePlus=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 12.998h-6v6h-2v-6H5v-2h6v-6h2v6h6z"})}),useSearchTag=()=>{const[He,Qe]=reactExports.useState(""),[it,lt]=reactExports.useState(""),ut=reactExports.useCallback(debounce(kt=>lt(kt),200),[]),dt=reactExports.useCallback(kt=>{const St=kt.target.value;Qe(St),ut(St)},[]),{data:xt,loading:ft}=useListTags({first:20,q:it,feed:"auto_complete"}),vt=reactExports.useMemo(()=>getNodesFromConnection(xt),[xt]);return{inputValue:He,onInputChange:dt,tags:vt,loading:ft}},renderOption=({className:He,...Qe},it)=>jsxRuntimeExports.jsxs("li",{...Qe,className:cx("flex gap-2",He),children:[it.mediaId?jsxRuntimeExports.jsx(MediaPreview$1,{className:"w-6 h-6 rounded-full",mediaId:it.mediaId}):null,jsxRuntimeExports.jsx("div",{children:it.name})]}),TagSelect=({value:He,onChange:Qe,textFieldProps:it})=>{const{inputValue:lt,onInputChange:ut,tags:dt,loading:xt}=useSearchTag();return jsxRuntimeExports.jsx(Autocomplete,{disablePortal:!0,autoSelect:!0,multiple:!0,freeSolo:!0,value:He,onChange:(ft,vt)=>Qe(vt),options:dt,onInputChange:(ft,vt)=>{const kt=vt.split(",");kt.length>1?(Qe((He??[]).concat(kt).filter(St=>!!St)),ut({target:{value:""}})):ut({target:{value:vt}})},inputValue:lt,renderInput:ft=>jsxRuntimeExports.jsx(TextField,{value:lt,...ft,...it}),loading:xt,renderOption,renderValue:(ft,vt)=>jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:ft.map((kt,St)=>jsxRuntimeExports.jsx(Chip,{...vt({index:St}),avatar:kt?.mediaId?jsxRuntimeExports.jsx(MediaPreview$1,{className:"rounded-full",mediaId:kt.mediaId}):void 0,label:jsxRuntimeExports.jsx("span",{className:cx({"text-orange-500":kt.isContest},"text-sm"),children:kt?.name||kt||""})}))}),getOptionLabel:ft=>typeof ft=="string"?ft:ft.name})};function localeToLocaleInput(He,Qe){const it=[];for(const lt in He){const ut=He[lt]?.[Qe];ut&&it.push({lang:lt,text:ut})}return it}function WorldInputForm(He){const[Qe,it]=reactExports.useState({name:localeToLocaleInput(He.world.locales,"name"),description:localeToLocaleInput(He.world.locales,"description"),mediaId:He.world.media?.id,artwork:{}}),lt=(ut,dt,xt)=>{it(ft=>{const vt=ft[ut],kt=vt.findIndex(St=>St.lang===dt);return kt===-1?vt.push({lang:dt,text:xt}):vt[kt].text=xt,{...ft,[ut]:vt}})};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col p-4 gap-2",children:[jsxRuntimeExports.jsxs(DialogTitle,{className:"flex justify-between",children:["Edit World",jsxRuntimeExports.jsxs(Button,{variant:"contained",onClick:()=>{const ut=prompt("Enter language to add");ut&&(lt("name",ut,""),lt("description",ut,""))},children:[jsxRuntimeExports.jsx(icBaselinePlus,{}),"Add Locale"]})]}),jsxRuntimeExports.jsx(WorldForm,{input:Qe,names:Qe.name,descriptions:Qe.description,onChange:ut=>dt=>{it(xt=>({...xt,[ut]:dt.target.value}))},onChangeArtwork:ut=>dt=>{it(xt=>({...xt,artwork:{...xt.artwork,[ut]:dt}}))},onLocaleChange:(ut,dt)=>xt=>{const ft=xt.target.value;lt(ut,dt,ft)}}),jsxRuntimeExports.jsx(DialogActions,{children:jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",busy:"auto",onPress:()=>He.onSubmit(Qe),children:"Submit"})})]})}function WorldForm({input:He,names:Qe,descriptions:it,onChange:lt,onChangeArtwork:ut,onLocaleChange:dt}){return jsxRuntimeExports.jsxs(DialogContent,{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(InputLabel,{children:"World Name"}),Qe.map((xt,ft)=>jsxRuntimeExports.jsx(TextField,{label:xt.lang,value:xt.text,onChange:dt("name",xt.lang),required:!0},ft))]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(InputLabel,{children:"World Description"}),it.map((xt,ft)=>jsxRuntimeExports.jsx(TextField,{fullWidth:!0,label:xt.lang,value:xt.text,onChange:dt("description",xt.lang),required:!0,multiline:!0},ft))]}),jsxRuntimeExports.jsx(TextField,{label:"Media ID",placeholder:"World banner media id",value:He.mediaId,onChange:lt("mediaId"),required:!0,type:"number"}),jsxRuntimeExports.jsx(TagSelect,{value:He.artwork?.tags??[],onChange:xt=>ut("tags")(xt.map(ft=>typeof ft=="string"?ft:ft.name)),textFieldProps:{label:"Tags"}})]})}function CharacterInputForm(He){const[Qe,it]=reactExports.useState({name:localeToLocaleInput(He.input.locales,"name"),description:localeToLocaleInput(He.input.locales,"description"),mediaId:He.input.media?.id,artwork:{}}),lt=(ut,dt,xt)=>{it(ft=>{const vt=ft[ut],kt=vt.findIndex(St=>St.lang===dt);return kt===-1?vt.push({lang:dt,text:xt}):vt[kt].text=xt,{...ft,[ut]:vt}})};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col p-4 gap-2",children:[jsxRuntimeExports.jsxs(DialogTitle,{className:"flex justify-between",children:["Edit Character",jsxRuntimeExports.jsxs(Button,{variant:"contained",onClick:()=>{const ut=prompt("Enter language to add");ut&&(lt("name",ut,""),lt("description",ut,""))},children:[jsxRuntimeExports.jsx(icBaselinePlus,{}),"Add Locale"]})]}),jsxRuntimeExports.jsx(CharacterForm,{input:Qe,names:Qe.name,descriptions:Qe.description,onChange:ut=>dt=>{it(xt=>({...xt,[ut]:dt.target.value}))},onChangeArtwork:ut=>dt=>{it(xt=>({...xt,artwork:{...xt.artwork,[ut]:dt}}))},onLocaleChange:(ut,dt)=>xt=>{const ft=xt.target.value;lt(ut,dt,ft)}}),jsxRuntimeExports.jsx(DialogActions,{children:jsxRuntimeExports.jsx(UIButton$1,{busy:"auto",variant:"filled",onPress:()=>He.onSubmit(Qe),children:"Submit"})})]})}function CharacterForm({input:He,names:Qe,descriptions:it,onChange:lt,onChangeArtwork:ut,onLocaleChange:dt}){return jsxRuntimeExports.jsxs(DialogContent,{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(InputLabel,{children:"Character Name"}),Qe.map((xt,ft)=>jsxRuntimeExports.jsx(TextField,{label:xt.lang,defaultValue:xt.text,onChange:dt("name",xt.lang),required:!0},ft))]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(InputLabel,{children:"Character Description"}),it.map((xt,ft)=>jsxRuntimeExports.jsx(TextField,{fullWidth:!0,label:xt.lang,defaultValue:xt.text,onChange:dt("description",xt.lang),required:!0,multiline:!0},ft))]}),jsxRuntimeExports.jsx(TextField,{label:"Media ID",placeholder:"World banner media id",defaultValue:He.mediaId,onChange:lt("mediaId"),required:!0,type:"number"}),jsxRuntimeExports.jsx(TagSelect,{value:He.artwork?.tags??[],onChange:xt=>ut("tags")(xt.map(ft=>typeof ft=="string"?ft:ft.name)),textFieldProps:{label:"Tags"}})]})}function CharacterAdminButton({character:He}){const Qe=()=>{dialogInspection(He)},it=()=>{const ut=dialog({children:jsxRuntimeExports.jsx(CharacterInputForm,{input:He,onSubmit:async dt=>{await client.upsertCharacter({id:He.id,input:dt}),ut.current?.close()}}),fullWidth:!0,maxWidth:"lg"})},lt=()=>{opAction(async()=>{await client.deleteCharacter({id:He.id})},jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"py-4",children:"Are you sure to delete this character?"}),He.name]}))};return jsxRuntimeExports.jsxs(DropdownMenu,{anchor:jsxRuntimeExports.jsx(Button,{startIcon:jsxRuntimeExports.jsx(icBaselineAdminPanelSettings,{}),variant:"outlined",color:"warning",className:"ml-4 rounded-md",children:"Admin"}),children:[jsxRuntimeExports.jsx(MenuItem$1,{onClick:Qe,children:jsxRuntimeExports.jsx("span",{className:"normal-case",children:"inspect"})}),jsxRuntimeExports.jsx(MenuItem$1,{onClick:it,children:jsxRuntimeExports.jsx("span",{className:"normal-case",children:"edit"})}),jsxRuntimeExports.jsx(MenuItem$1,{className:"bg-red-100 text-red-500 hover:bg-red-200 transition duration-75",onClick:lt,children:jsxRuntimeExports.jsx("span",{className:"normal-case",children:"delete"})})]})}const getBaseCursorPagingArgs=({before:He,after:Qe,pageSize:it,isPosSeq:lt})=>{const ut={after:Qe,before:He};return lt?He?ut.last=it:ut.first=it:Qe?ut.first=it:ut.last=it,ut},DEFAULT_COLLECTION_NAME="$$default$$",DEFAULT_CHARACTER_COLLECTION_NAME="$$dcc$$";function isDefaultCollection(He){return He===DEFAULT_COLLECTION_NAME}function isDefaultCharacterCollection(He){return He===DEFAULT_CHARACTER_COLLECTION_NAME}function getCharacterCollectionName(He,Qe){return isDefaultCharacterCollection(Qe)?He("user:character-collection.default.name"):Qe}const CHARACTER_BOOKMARK_TYPE="character_collection";async function createCollection(He){const{upsertBookmark:Qe}=await client.upsertBookmark({input:He});return Qe}async function updateCollection(He,Qe){const{upsertBookmark:it}=await client.upsertBookmark({id:He,input:Qe});return it}async function removeCollection(He){await client.deleteBookmark({id:He})}const PAGE_SIZE=20;function useCollections({userId:He,username:Qe,before:it,after:lt,pageSize:ut=PAGE_SIZE,type:dt=""}){const{data:xt,isLoading:ft,mutate:vt}=useBookmarks({userId:He,username:Qe,type:dt,...getBaseCursorPagingArgs({before:it,after:lt,pageSize:ut})});return{collections:getNodesFromConnection(xt).reverse(),pageInfo:xt?.pageInfo,loading:ft,reload:vt}}async function addCollectionItem(He,Qe){await client.updateBookmarkItem({input:{bookmarkId:He,...Qe}})}async function removeCollectionItem(He,Qe){await client.updateBookmarkItem({input:{bookmarkId:He,...Qe,remove:!0}})}const materialSymbolsClose=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M6.4 19L5 17.6l5.6-5.6L5 6.4L6.4 5l5.6 5.6L17.6 5L19 6.4L13.4 12l5.6 5.6l-1.4 1.4l-5.6-5.6L6.4 19Z"})}),fluentCheckmarkCircle24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2m3.22 6.97l-4.47 4.47l-1.97-1.97a.75.75 0 0 0-1.06 1.06l2.5 2.5a.75.75 0 0 0 1.06 0l5-5a.75.75 0 1 0-1.06-1.06"})}),artworkCache=new Map,ArtworkPicker=reactExports.forwardRef(function He(Qe,it){const{min:lt=1,max:ut=1/0}=Qe,{me:dt}=useMe(),[xt,ft]=reactExports.useState(!1),{data:vt,loading:kt,fetchMore:St,loadingMore:Tt}=useInfiniteListArtworks(dt&&xt?{authorId:dt.id,[isLora(Qe.modelType)?"loraVersionId":"modelVersionId"]:Qe.modelVersionId,orderBy:"-createdAt",first:5}:skipToken),Mt=reactExports.useMemo(()=>vt?.pageInfo?.hasNextPage??!0,[vt]),Nt=reactExports.useMemo(()=>getNodesFromConnection(vt)??[],[vt]),[At,$t]=reactExports.useState(null),{ref:Dt,entry:Ft}=useIntersection({root:At});reactExports.useEffect(()=>{xt&&Ft?.isIntersecting&&Mt&&!kt&&St({variables:{after:vt?.pageInfo?.endCursor}})},[Mt,Ft?.isIntersecting,kt,xt,vt?.pageInfo,St]);const[Bt,Ot]=i(()=>new Set);function Qt(Xt){const Kt=Xt.id;Qe.multiple?Bt.has(Kt)?Bt.size>lt&&Ot(Jt=>{Jt.delete(Kt)}):(Bt.size<ut&&Ot(Jt=>{Jt.add(Kt)}),Xt.media&&!artworkCache.has(Kt)&&artworkCache.set(Kt,Xt)):Qe.onSubmit?.(Kt)}function Wt(){ft(!1),Qe.onClose?.(),Ot(()=>new Set)}return reactExports.useImperativeHandle(it,()=>({open:()=>{Qe.multiple&&Qe.value&&Ot(new Set(Qe.value)),ft(!0)}}),[Qe.multiple,Qe.value,Ot]),dt?jsxRuntimeExports.jsxs(UIDialogResponsive,{open:xt,onClose:Wt,className:"text-sm mmd:w-[calc(100vw-64px)]",children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:artwork-picker.title",values:{count:Qe.multiple?2:1}})}),jsxRuntimeExports.jsxs(UIDialogContent,{children:[jsxRuntimeExports.jsx(Yr,{data:Nt,context:{sentinelRef:Dt,havingMore:Mt,loading:kt||Tt},style:{height:600},scrollerRef:$t,components:gridComponents,listClassName:"grid grid-cols-[repeat(auto-fill,minmax(160px,1fr))] gap-1",itemContent:(Xt,Kt)=>jsxRuntimeExports.jsxs("div",{className:"relative aspect-square",children:[jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:Kt.mediaId,thumbnail:!0,className:cx("size-full rounded-md transition ease-in-out",Bt.has(Kt.id)&&"opacity-80 scale-90"),onClick:()=>Qt(Kt)}),Bt.has(Kt.id)&&jsxRuntimeExports.jsx(fluentCheckmarkCircle24Filled,{className:"absolute inset-0 m-auto size-6 text-purple-600 bg-white rounded-full pointer-events-none"})]})}),Qe.multiple&&jsxRuntimeExports.jsx(SelectionList,{selection:Bt,onChange:Ot,max:Qe.max})]}),jsxRuntimeExports.jsxs(UIDialogFooter,{children:[jsxRuntimeExports.jsx(UIButton$1,{onPress:Wt,children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:cancel"})}),Qe.multiple&&jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",onPress:()=>{Qe.onSubmit?.(Array.from(Bt.keys())),Wt()},children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:confirm"})})]})]}):null}),gridComponents={Footer:({context:He})=>jsxRuntimeExports.jsx("div",{ref:He?.sentinelRef,className:"mt-1 text-center text-sm text-neutral-500",children:!He||He.loading?jsxRuntimeExports.jsx("div",{className:"mx-auto overflow-hidden",style:{width:42,height:14},children:jsxRuntimeExports.jsx(Preloader,{inline:!0})}):He.havingMore?null:jsxRuntimeExports.jsx(Text,{i18nKey:"common:list-reached-the-end"})})};function SelectionList(He){return jsxRuntimeExports.jsxs("div",{className:"mt-4 flex gap-1",children:[jsxRuntimeExports.jsxs("div",{className:"grid place-content-center size-12 border border-zinc-300 dark:border-zinc-600 rounded",children:[He.selection.size,Number(He.max)>0&&`/${He.max}`]}),Array.from(He.selection).map(Qe=>jsxRuntimeExports.jsx(SelectionItem,{artworkId:Qe,onRemove:()=>He.onChange?.(produce(He.selection,it=>{it.delete(Qe)}))},Qe))]})}function SelectionItem(He){const{data:Qe=artworkCache.get(He.artworkId)}=useGetArtwork(artworkCache.has(He.artworkId)?skipToken:He.artworkId);return!artworkCache.has(He.artworkId)&&Qe&&artworkCache.set(He.artworkId,Qe),jsxRuntimeExports.jsxs("div",{className:"group/item relative",children:[jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:Qe?.mediaId,thumbnail:!0,className:"size-12 rounded group-hover/item:opacity-50",onClick:He.onRemove}),jsxRuntimeExports.jsx(fluentDismiss24Filled,{className:"absolute inset-0 m-auto size-6 text-black dark:text-white invisible group-hover/item:visible pointer-events-none"})]})}const UploadImage=({value:He,onChange:Qe=()=>{},onUpload:it=()=>{},onImageSelect:lt=()=>{},preHandleImage:ut=Tt=>Tt,className:dt,disabled:xt,placeholderElement:ft,dropzoneOptions:vt,fileHandleElement:kt,...St})=>{const{t:Tt}=useTranslation(["action"]),[Mt,Nt]=reactExports.useState(),At=reactExports.useMemo(()=>{const Kt=getPublicUrl(He);if(Kt)return Kt;if(Mt)return URL.createObjectURL(Mt)},[He,Mt]),[$t,Dt]=reactExports.useState(),[Ft,Bt]=useLoadingCallback(async Kt=>{it(!0);try{Dt(void 0);const Jt=await uploadMedia(Kt);Qe(Jt.media),Nt(void 0)}catch(Jt){console.error(Jt),Dt(Jt)}finally{it(!1)}},[it]),Ot=reactExports.useCallback(async Kt=>{const Jt=Kt[0];if(Jt){lt(Jt);const hr=await ut(Jt);Nt(hr),Bt(hr)}},[]),{getRootProps:Qt,getInputProps:Wt}=useDropzone({onDrop:Ot,multiple:!1,disabled:xt,accept:{"image/*":[]},...vt}),Xt=reactExports.useCallback(async Kt=>{Kt&&(Nt(Kt),Bt(Kt))},[He]);return jsxRuntimeExports.jsxs("div",{className:cx(`
          size-[300px] md:size-[400px]
          border-2 border-dashed rounded-2xl
          flex justify-center items-center
          transition-all hover:transition-all
          text-primary-light font-mono
          `,{"hover:bg-hover cursor-pointer":!xt},dt),...St,...Qt(),children:[At?jsxRuntimeExports.jsxs("div",{className:"w-full h-full relative flex items-center overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"w-full h-full bg-center bg-contain bg-no-repeat rounded-2xl",style:{backgroundImage:`url(${At})`}}),$t?jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 p-8 bg-black bg-opacity-70 text-white flex flex-col justify-center items-center",children:[jsxRuntimeExports.jsx("span",{children:"Failed to upload image. Please try again."}),jsxRuntimeExports.jsx("span",{className:"whitespace-pre-wrap break-all",children:$t?.message})]}):Ft?jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70 text-white flex justify-center items-center rounded-2xl",children:"uploading..."}):null]}):ft??jsxRuntimeExports.jsx("div",{className:"text-center font-medium",dangerouslySetInnerHTML:{__html:Tt("action:drag-and-drop-hint",{br:"<br />"})}}),jsxRuntimeExports.jsx("input",{...Wt()}),!Ft&&!$t?kt?.({action:Xt}):null]})};var _populated=!1,_ie,_firefox,_opera,_webkit,_chrome,_ie_real_version,_osx,_windows,_linux,_android,_win64,_iphone,_ipad,_native,_mobile;function _populate(){if(!_populated){_populated=!0;var He=navigator.userAgent,Qe=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(He),it=/(Mac OS X)|(Windows)|(Linux)/.exec(He);if(_iphone=/\b(iPhone|iP[ao]d)/.exec(He),_ipad=/\b(iP[ao]d)/.exec(He),_android=/Android/i.exec(He),_native=/FBAN\/\w+;/i.exec(He),_mobile=/Mobile/i.exec(He),_win64=!!/Win64/.exec(He),Qe){_ie=Qe[1]?parseFloat(Qe[1]):Qe[5]?parseFloat(Qe[5]):NaN,_ie&&document&&document.documentMode&&(_ie=document.documentMode);var lt=/(?:Trident\/(\d+.\d+))/.exec(He);_ie_real_version=lt?parseFloat(lt[1])+4:_ie,_firefox=Qe[2]?parseFloat(Qe[2]):NaN,_opera=Qe[3]?parseFloat(Qe[3]):NaN,_webkit=Qe[4]?parseFloat(Qe[4]):NaN,_webkit?(Qe=/(?:Chrome\/(\d+\.\d+))/.exec(He),_chrome=Qe&&Qe[1]?parseFloat(Qe[1]):NaN):_chrome=NaN}else _ie=_firefox=_opera=_chrome=_webkit=NaN;if(it){if(it[1]){var ut=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(He);_osx=ut?parseFloat(ut[1].replace("_",".")):!0}else _osx=!1;_windows=!!it[2],_linux=!!it[3]}else _osx=_windows=_linux=!1}}var UserAgent_DEPRECATED$1={ie:function(){return _populate()||_ie},ieCompatibilityMode:function(){return _populate()||_ie_real_version>_ie},ie64:function(){return UserAgent_DEPRECATED$1.ie()&&_win64},firefox:function(){return _populate()||_firefox},opera:function(){return _populate()||_opera},webkit:function(){return _populate()||_webkit},safari:function(){return UserAgent_DEPRECATED$1.webkit()},chrome:function(){return _populate()||_chrome},windows:function(){return _populate()||_windows},osx:function(){return _populate()||_osx},linux:function(){return _populate()||_linux},iphone:function(){return _populate()||_iphone},mobile:function(){return _populate()||_iphone||_ipad||_android||_mobile},nativeApp:function(){return _populate()||_native},android:function(){return _populate()||_android},ipad:function(){return _populate()||_ipad}},UserAgent_DEPRECATED_1=UserAgent_DEPRECATED$1,canUseDOM=!!(typeof window<"u"&&window.document&&window.document.createElement),ExecutionEnvironment$1={canUseDOM,canUseWorkers:typeof Worker<"u",canUseEventListeners:canUseDOM&&!!(window.addEventListener||window.attachEvent),canUseViewport:canUseDOM&&!!window.screen,isInWorker:!canUseDOM},ExecutionEnvironment_1=ExecutionEnvironment$1,ExecutionEnvironment=ExecutionEnvironment_1,useHasFeature;ExecutionEnvironment.canUseDOM&&(useHasFeature=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function isEventSupported$1(He,Qe){if(!ExecutionEnvironment.canUseDOM||Qe&&!("addEventListener"in document))return!1;var it="on"+He,lt=it in document;if(!lt){var ut=document.createElement("div");ut.setAttribute(it,"return;"),lt=typeof ut[it]=="function"}return!lt&&useHasFeature&&He==="wheel"&&(lt=document.implementation.hasFeature("Events.wheel","3.0")),lt}var isEventSupported_1=isEventSupported$1,UserAgent_DEPRECATED=UserAgent_DEPRECATED_1,isEventSupported=isEventSupported_1,PIXEL_STEP=10,LINE_HEIGHT=40,PAGE_HEIGHT=800;function normalizeWheel$2(He){var Qe=0,it=0,lt=0,ut=0;return"detail"in He&&(it=He.detail),"wheelDelta"in He&&(it=-He.wheelDelta/120),"wheelDeltaY"in He&&(it=-He.wheelDeltaY/120),"wheelDeltaX"in He&&(Qe=-He.wheelDeltaX/120),"axis"in He&&He.axis===He.HORIZONTAL_AXIS&&(Qe=it,it=0),lt=Qe*PIXEL_STEP,ut=it*PIXEL_STEP,"deltaY"in He&&(ut=He.deltaY),"deltaX"in He&&(lt=He.deltaX),(lt||ut)&&He.deltaMode&&(He.deltaMode==1?(lt*=LINE_HEIGHT,ut*=LINE_HEIGHT):(lt*=PAGE_HEIGHT,ut*=PAGE_HEIGHT)),lt&&!Qe&&(Qe=lt<1?-1:1),ut&&!it&&(it=ut<1?-1:1),{spinX:Qe,spinY:it,pixelX:lt,pixelY:ut}}normalizeWheel$2.getEventType=function(){return UserAgent_DEPRECATED.firefox()?"DOMMouseScroll":isEventSupported("wheel")?"wheel":"mousewheel"};var normalizeWheel_1=normalizeWheel$2,normalizeWheel=normalizeWheel_1;const normalizeWheel$1=getDefaultExportFromCjs(normalizeWheel);function getCropSize(He,Qe,it,lt,ut,dt){dt===void 0&&(dt=0);var xt=rotateSize$1(He,Qe,dt),ft=xt.width,vt=xt.height,kt=Math.min(ft,it),St=Math.min(vt,lt);return kt>St*ut?{width:St*ut,height:St}:{width:kt,height:kt/ut}}function getMediaZoom(He){return He.width>He.height?He.width/He.naturalWidth:He.height/He.naturalHeight}function restrictPosition(He,Qe,it,lt,ut){ut===void 0&&(ut=0);var dt=rotateSize$1(Qe.width,Qe.height,ut),xt=dt.width,ft=dt.height;return{x:restrictPositionCoord(He.x,xt,it.width,lt),y:restrictPositionCoord(He.y,ft,it.height,lt)}}function restrictPositionCoord(He,Qe,it,lt){var ut=Qe*lt/2-it/2;return clamp(He,-ut,ut)}function getDistanceBetweenPoints(He,Qe){return Math.sqrt(Math.pow(He.y-Qe.y,2)+Math.pow(He.x-Qe.x,2))}function getRotationBetweenPoints(He,Qe){return Math.atan2(Qe.y-He.y,Qe.x-He.x)*180/Math.PI}function computeCroppedArea(He,Qe,it,lt,ut,dt,xt){dt===void 0&&(dt=0),xt===void 0&&(xt=!0);var ft=xt?limitArea:noOp,vt=rotateSize$1(Qe.width,Qe.height,dt),kt=rotateSize$1(Qe.naturalWidth,Qe.naturalHeight,dt),St={x:ft(100,((vt.width-it.width/ut)/2-He.x/ut)/vt.width*100),y:ft(100,((vt.height-it.height/ut)/2-He.y/ut)/vt.height*100),width:ft(100,it.width/vt.width*100/ut),height:ft(100,it.height/vt.height*100/ut)},Tt=Math.round(ft(kt.width,St.width*kt.width/100)),Mt=Math.round(ft(kt.height,St.height*kt.height/100)),Nt=kt.width>=kt.height*lt,At=Nt?{width:Math.round(Mt*lt),height:Mt}:{width:Tt,height:Math.round(Tt/lt)},$t=__assign$1(__assign$1({},At),{x:Math.round(ft(kt.width-At.width,St.x*kt.width/100)),y:Math.round(ft(kt.height-At.height,St.y*kt.height/100))});return{croppedAreaPercentages:St,croppedAreaPixels:$t}}function limitArea(He,Qe){return Math.min(He,Math.max(0,Qe))}function noOp(He,Qe){return Qe}function getInitialCropFromCroppedAreaPercentages(He,Qe,it,lt,ut,dt){var xt=rotateSize$1(Qe.width,Qe.height,it),ft=clamp(lt.width/xt.width*(100/He.width),ut,dt),vt={x:ft*xt.width/2-lt.width/2-xt.width*ft*(He.x/100),y:ft*xt.height/2-lt.height/2-xt.height*ft*(He.y/100)};return{crop:vt,zoom:ft}}function getZoomFromCroppedAreaPixels(He,Qe,it){var lt=getMediaZoom(Qe);return it.height>it.width?it.height/(He.height*lt):it.width/(He.width*lt)}function getInitialCropFromCroppedAreaPixels(He,Qe,it,lt,ut,dt){it===void 0&&(it=0);var xt=rotateSize$1(Qe.naturalWidth,Qe.naturalHeight,it),ft=clamp(getZoomFromCroppedAreaPixels(He,Qe,lt),ut,dt),vt=lt.height>lt.width?lt.height/He.height:lt.width/He.width,kt={x:((xt.width-He.width)/2-He.x)*vt,y:((xt.height-He.height)/2-He.y)*vt};return{crop:kt,zoom:ft}}function getCenter(He,Qe){return{x:(Qe.x+He.x)/2,y:(Qe.y+He.y)/2}}function getRadianAngle$1(He){return He*Math.PI/180}function rotateSize$1(He,Qe,it){var lt=getRadianAngle$1(it);return{width:Math.abs(Math.cos(lt)*He)+Math.abs(Math.sin(lt)*Qe),height:Math.abs(Math.sin(lt)*He)+Math.abs(Math.cos(lt)*Qe)}}function clamp(He,Qe,it){return Math.min(Math.max(He,Qe),it)}function classNames(){for(var He=[],Qe=0;Qe<arguments.length;Qe++)He[Qe]=arguments[Qe];return He.filter(function(it){return typeof it=="string"&&it.length>0}).join(" ").trim()}var css_248z=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,MIN_ZOOM=1,MAX_ZOOM=3,KEYBOARD_STEP=1,Cropper=function(He){__extends$2(Qe,He);function Qe(){var it=He!==null&&He.apply(this,arguments)||this;return it.imageRef=reactExports.createRef(),it.videoRef=reactExports.createRef(),it.containerPosition={x:0,y:0},it.containerRef=null,it.styleRef=null,it.containerRect=null,it.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},it.dragStartPosition={x:0,y:0},it.dragStartCrop={x:0,y:0},it.gestureZoomStart=0,it.gestureRotationStart=0,it.isTouching=!1,it.lastPinchDistance=0,it.lastPinchRotation=0,it.rafDragTimeout=null,it.rafPinchTimeout=null,it.wheelTimer=null,it.currentDoc=typeof document<"u"?document:null,it.currentWindow=typeof window<"u"?window:null,it.resizeObserver=null,it.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},it.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!it.containerRef)){var lt=!0;it.resizeObserver=new window.ResizeObserver(function(ut){if(lt){lt=!1;return}it.computeSizes()}),it.resizeObserver.observe(it.containerRef)}},it.preventZoomSafari=function(lt){return lt.preventDefault()},it.cleanEvents=function(){it.currentDoc&&(it.currentDoc.removeEventListener("mousemove",it.onMouseMove),it.currentDoc.removeEventListener("mouseup",it.onDragStopped),it.currentDoc.removeEventListener("touchmove",it.onTouchMove),it.currentDoc.removeEventListener("touchend",it.onDragStopped),it.currentDoc.removeEventListener("gesturemove",it.onGestureMove),it.currentDoc.removeEventListener("gestureend",it.onGestureEnd),it.currentDoc.removeEventListener("scroll",it.onScroll))},it.clearScrollEvent=function(){it.containerRef&&it.containerRef.removeEventListener("wheel",it.onWheel),it.wheelTimer&&clearTimeout(it.wheelTimer)},it.onMediaLoad=function(){var lt=it.computeSizes();lt&&(it.emitCropData(),it.setInitialCrop(lt)),it.props.onMediaLoaded&&it.props.onMediaLoaded(it.mediaSize)},it.setInitialCrop=function(lt){if(it.props.initialCroppedAreaPercentages){var ut=getInitialCropFromCroppedAreaPercentages(it.props.initialCroppedAreaPercentages,it.mediaSize,it.props.rotation,lt,it.props.minZoom,it.props.maxZoom),dt=ut.crop,xt=ut.zoom;it.props.onCropChange(dt),it.props.onZoomChange&&it.props.onZoomChange(xt)}else if(it.props.initialCroppedAreaPixels){var ft=getInitialCropFromCroppedAreaPixels(it.props.initialCroppedAreaPixels,it.mediaSize,it.props.rotation,lt,it.props.minZoom,it.props.maxZoom),dt=ft.crop,xt=ft.zoom;it.props.onCropChange(dt),it.props.onZoomChange&&it.props.onZoomChange(xt)}},it.computeSizes=function(){var lt,ut,dt,xt,ft,vt,kt=it.imageRef.current||it.videoRef.current;if(kt&&it.containerRef){it.containerRect=it.containerRef.getBoundingClientRect(),it.saveContainerPosition();var St=it.containerRect.width/it.containerRect.height,Tt=((lt=it.imageRef.current)===null||lt===void 0?void 0:lt.naturalWidth)||((ut=it.videoRef.current)===null||ut===void 0?void 0:ut.videoWidth)||0,Mt=((dt=it.imageRef.current)===null||dt===void 0?void 0:dt.naturalHeight)||((xt=it.videoRef.current)===null||xt===void 0?void 0:xt.videoHeight)||0,Nt=kt.offsetWidth<Tt||kt.offsetHeight<Mt,At=Tt/Mt,$t=void 0;if(Nt)switch(it.state.mediaObjectFit){default:case"contain":$t=St>At?{width:it.containerRect.height*At,height:it.containerRect.height}:{width:it.containerRect.width,height:it.containerRect.width/At};break;case"horizontal-cover":$t={width:it.containerRect.width,height:it.containerRect.width/At};break;case"vertical-cover":$t={width:it.containerRect.height*At,height:it.containerRect.height};break}else $t={width:kt.offsetWidth,height:kt.offsetHeight};it.mediaSize=__assign$1(__assign$1({},$t),{naturalWidth:Tt,naturalHeight:Mt}),it.props.setMediaSize&&it.props.setMediaSize(it.mediaSize);var Dt=it.props.cropSize?it.props.cropSize:getCropSize(it.mediaSize.width,it.mediaSize.height,it.containerRect.width,it.containerRect.height,it.props.aspect,it.props.rotation);return(((ft=it.state.cropSize)===null||ft===void 0?void 0:ft.height)!==Dt.height||((vt=it.state.cropSize)===null||vt===void 0?void 0:vt.width)!==Dt.width)&&it.props.onCropSizeChange&&it.props.onCropSizeChange(Dt),it.setState({cropSize:Dt},it.recomputeCropPosition),it.props.setCropSize&&it.props.setCropSize(Dt),Dt}},it.saveContainerPosition=function(){if(it.containerRef){var lt=it.containerRef.getBoundingClientRect();it.containerPosition={x:lt.left,y:lt.top}}},it.onMouseDown=function(lt){it.currentDoc&&(lt.preventDefault(),it.currentDoc.addEventListener("mousemove",it.onMouseMove),it.currentDoc.addEventListener("mouseup",it.onDragStopped),it.saveContainerPosition(),it.onDragStart(Qe.getMousePoint(lt)))},it.onMouseMove=function(lt){return it.onDrag(Qe.getMousePoint(lt))},it.onScroll=function(lt){it.currentDoc&&(lt.preventDefault(),it.saveContainerPosition())},it.onTouchStart=function(lt){it.currentDoc&&(it.isTouching=!0,!(it.props.onTouchRequest&&!it.props.onTouchRequest(lt))&&(it.currentDoc.addEventListener("touchmove",it.onTouchMove,{passive:!1}),it.currentDoc.addEventListener("touchend",it.onDragStopped),it.saveContainerPosition(),lt.touches.length===2?it.onPinchStart(lt):lt.touches.length===1&&it.onDragStart(Qe.getTouchPoint(lt.touches[0]))))},it.onTouchMove=function(lt){lt.preventDefault(),lt.touches.length===2?it.onPinchMove(lt):lt.touches.length===1&&it.onDrag(Qe.getTouchPoint(lt.touches[0]))},it.onGestureStart=function(lt){it.currentDoc&&(lt.preventDefault(),it.currentDoc.addEventListener("gesturechange",it.onGestureMove),it.currentDoc.addEventListener("gestureend",it.onGestureEnd),it.gestureZoomStart=it.props.zoom,it.gestureRotationStart=it.props.rotation)},it.onGestureMove=function(lt){if(lt.preventDefault(),!it.isTouching){var ut=Qe.getMousePoint(lt),dt=it.gestureZoomStart-1+lt.scale;if(it.setNewZoom(dt,ut,{shouldUpdatePosition:!0}),it.props.onRotationChange){var xt=it.gestureRotationStart+lt.rotation;it.props.onRotationChange(xt)}}},it.onGestureEnd=function(lt){it.cleanEvents()},it.onDragStart=function(lt){var ut,dt,xt=lt.x,ft=lt.y;it.dragStartPosition={x:xt,y:ft},it.dragStartCrop=__assign$1({},it.props.crop),(dt=(ut=it.props).onInteractionStart)===null||dt===void 0||dt.call(ut)},it.onDrag=function(lt){var ut=lt.x,dt=lt.y;it.currentWindow&&(it.rafDragTimeout&&it.currentWindow.cancelAnimationFrame(it.rafDragTimeout),it.rafDragTimeout=it.currentWindow.requestAnimationFrame(function(){if(it.state.cropSize&&!(ut===void 0||dt===void 0)){var xt=ut-it.dragStartPosition.x,ft=dt-it.dragStartPosition.y,vt={x:it.dragStartCrop.x+xt,y:it.dragStartCrop.y+ft},kt=it.props.restrictPosition?restrictPosition(vt,it.mediaSize,it.state.cropSize,it.props.zoom,it.props.rotation):vt;it.props.onCropChange(kt)}}))},it.onDragStopped=function(){var lt,ut;it.isTouching=!1,it.cleanEvents(),it.emitCropData(),(ut=(lt=it.props).onInteractionEnd)===null||ut===void 0||ut.call(lt)},it.onWheel=function(lt){if(it.currentWindow&&!(it.props.onWheelRequest&&!it.props.onWheelRequest(lt))){lt.preventDefault();var ut=Qe.getMousePoint(lt),dt=normalizeWheel$1(lt).pixelY,xt=it.props.zoom-dt*it.props.zoomSpeed/200;it.setNewZoom(xt,ut,{shouldUpdatePosition:!0}),it.state.hasWheelJustStarted||it.setState({hasWheelJustStarted:!0},function(){var ft,vt;return(vt=(ft=it.props).onInteractionStart)===null||vt===void 0?void 0:vt.call(ft)}),it.wheelTimer&&clearTimeout(it.wheelTimer),it.wheelTimer=it.currentWindow.setTimeout(function(){return it.setState({hasWheelJustStarted:!1},function(){var ft,vt;return(vt=(ft=it.props).onInteractionEnd)===null||vt===void 0?void 0:vt.call(ft)})},250)}},it.getPointOnContainer=function(lt,ut){var dt=lt.x,xt=lt.y;if(!it.containerRect)throw new Error("The Cropper is not mounted");return{x:it.containerRect.width/2-(dt-ut.x),y:it.containerRect.height/2-(xt-ut.y)}},it.getPointOnMedia=function(lt){var ut=lt.x,dt=lt.y,xt=it.props,ft=xt.crop,vt=xt.zoom;return{x:(ut+ft.x)/vt,y:(dt+ft.y)/vt}},it.setNewZoom=function(lt,ut,dt){var xt=dt===void 0?{}:dt,ft=xt.shouldUpdatePosition,vt=ft===void 0?!0:ft;if(!(!it.state.cropSize||!it.props.onZoomChange)){var kt=clamp(lt,it.props.minZoom,it.props.maxZoom);if(vt){var St=it.getPointOnContainer(ut,it.containerPosition),Tt=it.getPointOnMedia(St),Mt={x:Tt.x*kt-St.x,y:Tt.y*kt-St.y},Nt=it.props.restrictPosition?restrictPosition(Mt,it.mediaSize,it.state.cropSize,kt,it.props.rotation):Mt;it.props.onCropChange(Nt)}it.props.onZoomChange(kt)}},it.getCropData=function(){if(!it.state.cropSize)return null;var lt=it.props.restrictPosition?restrictPosition(it.props.crop,it.mediaSize,it.state.cropSize,it.props.zoom,it.props.rotation):it.props.crop;return computeCroppedArea(lt,it.mediaSize,it.state.cropSize,it.getAspect(),it.props.zoom,it.props.rotation,it.props.restrictPosition)},it.emitCropData=function(){var lt=it.getCropData();if(lt){var ut=lt.croppedAreaPercentages,dt=lt.croppedAreaPixels;it.props.onCropComplete&&it.props.onCropComplete(ut,dt),it.props.onCropAreaChange&&it.props.onCropAreaChange(ut,dt)}},it.emitCropAreaChange=function(){var lt=it.getCropData();if(lt){var ut=lt.croppedAreaPercentages,dt=lt.croppedAreaPixels;it.props.onCropAreaChange&&it.props.onCropAreaChange(ut,dt)}},it.recomputeCropPosition=function(){if(it.state.cropSize){var lt=it.props.restrictPosition?restrictPosition(it.props.crop,it.mediaSize,it.state.cropSize,it.props.zoom,it.props.rotation):it.props.crop;it.props.onCropChange(lt),it.emitCropData()}},it.onKeyDown=function(lt){var ut=it.props,dt=ut.crop,xt=ut.onCropChange,ft=ut.keyboardStep,vt=ut.zoom,kt=ut.rotation,St=ft;if(it.state.cropSize){lt.shiftKey&&(St*=.2);var Tt=__assign$1({},dt);switch(lt.key){case"ArrowUp":Tt.y-=St,lt.preventDefault();break;case"ArrowDown":Tt.y+=St,lt.preventDefault();break;case"ArrowLeft":Tt.x-=St,lt.preventDefault();break;case"ArrowRight":Tt.x+=St,lt.preventDefault();break;default:return}it.props.restrictPosition&&(Tt=restrictPosition(Tt,it.mediaSize,it.state.cropSize,vt,kt)),xt(Tt)}},it}return Qe.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=css_248z,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef))},Qe.prototype.componentWillUnmount=function(){var it,lt;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(it=this.resizeObserver)===null||it===void 0||it.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((lt=this.styleRef.parentNode)===null||lt===void 0||lt.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},Qe.prototype.componentDidUpdate=function(it){var lt,ut,dt,xt,ft,vt,kt,St,Tt;it.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):it.aspect!==this.props.aspect?this.computeSizes():it.objectFit!==this.props.objectFit?this.computeSizes():it.zoom!==this.props.zoom?this.recomputeCropPosition():((lt=it.cropSize)===null||lt===void 0?void 0:lt.height)!==((ut=this.props.cropSize)===null||ut===void 0?void 0:ut.height)||((dt=it.cropSize)===null||dt===void 0?void 0:dt.width)!==((xt=this.props.cropSize)===null||xt===void 0?void 0:xt.width)?this.computeSizes():(((ft=it.crop)===null||ft===void 0?void 0:ft.x)!==((vt=this.props.crop)===null||vt===void 0?void 0:vt.x)||((kt=it.crop)===null||kt===void 0?void 0:kt.y)!==((St=this.props.crop)===null||St===void 0?void 0:St.y))&&this.emitCropAreaChange(),it.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),it.video!==this.props.video&&((Tt=this.videoRef.current)===null||Tt===void 0||Tt.load());var Mt=this.getObjectFit();Mt!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:Mt},this.computeSizes)},Qe.prototype.getAspect=function(){var it=this.props,lt=it.cropSize,ut=it.aspect;return lt?lt.width/lt.height:ut},Qe.prototype.getObjectFit=function(){var it,lt,ut,dt;if(this.props.objectFit==="cover"){var xt=this.imageRef.current||this.videoRef.current;if(xt&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var ft=this.containerRect.width/this.containerRect.height,vt=((it=this.imageRef.current)===null||it===void 0?void 0:it.naturalWidth)||((lt=this.videoRef.current)===null||lt===void 0?void 0:lt.videoWidth)||0,kt=((ut=this.imageRef.current)===null||ut===void 0?void 0:ut.naturalHeight)||((dt=this.videoRef.current)===null||dt===void 0?void 0:dt.videoHeight)||0,St=vt/kt;return St<ft?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},Qe.prototype.onPinchStart=function(it){var lt=Qe.getTouchPoint(it.touches[0]),ut=Qe.getTouchPoint(it.touches[1]);this.lastPinchDistance=getDistanceBetweenPoints(lt,ut),this.lastPinchRotation=getRotationBetweenPoints(lt,ut),this.onDragStart(getCenter(lt,ut))},Qe.prototype.onPinchMove=function(it){var lt=this;if(!(!this.currentDoc||!this.currentWindow)){var ut=Qe.getTouchPoint(it.touches[0]),dt=Qe.getTouchPoint(it.touches[1]),xt=getCenter(ut,dt);this.onDrag(xt),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var ft=getDistanceBetweenPoints(ut,dt),vt=lt.props.zoom*(ft/lt.lastPinchDistance);lt.setNewZoom(vt,xt,{shouldUpdatePosition:!1}),lt.lastPinchDistance=ft;var kt=getRotationBetweenPoints(ut,dt),St=lt.props.rotation+(kt-lt.lastPinchRotation);lt.props.onRotationChange&&lt.props.onRotationChange(St),lt.lastPinchRotation=kt})}},Qe.prototype.render=function(){var it=this,lt,ut=this.props,dt=ut.image,xt=ut.video,ft=ut.mediaProps,vt=ut.transform,kt=ut.crop,St=kt.x,Tt=kt.y,Mt=ut.rotation,Nt=ut.zoom,At=ut.cropShape,$t=ut.showGrid,Dt=ut.style,Ft=Dt.containerStyle,Bt=Dt.cropAreaStyle,Ot=Dt.mediaStyle,Qt=ut.classes,Wt=Qt.containerClassName,Xt=Qt.cropAreaClassName,Kt=Qt.mediaClassName,Jt=(lt=this.state.mediaObjectFit)!==null&&lt!==void 0?lt:this.getObjectFit();return reactExports.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(xr){return it.containerRef=xr},"data-testid":"container",style:Ft,className:classNames("reactEasyCrop_Container",Wt)},dt?reactExports.createElement("img",__assign$1({alt:"",className:classNames("reactEasyCrop_Image",Jt==="contain"&&"reactEasyCrop_Contain",Jt==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",Jt==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",Kt)},ft,{src:dt,ref:this.imageRef,style:__assign$1(__assign$1({},Ot),{transform:vt||"translate(".concat(St,"px, ").concat(Tt,"px) rotate(").concat(Mt,"deg) scale(").concat(Nt,")")}),onLoad:this.onMediaLoad})):xt&&reactExports.createElement("video",__assign$1({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:classNames("reactEasyCrop_Video",Jt==="contain"&&"reactEasyCrop_Contain",Jt==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",Jt==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",Kt)},ft,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:__assign$1(__assign$1({},Ot),{transform:vt||"translate(".concat(St,"px, ").concat(Tt,"px) rotate(").concat(Mt,"deg) scale(").concat(Nt,")")}),controls:!1}),(Array.isArray(xt)?xt:[{src:xt}]).map(function(hr){return reactExports.createElement("source",__assign$1({key:hr.src},hr))})),this.state.cropSize&&reactExports.createElement("div",{style:__assign$1(__assign$1({},Bt),{width:this.state.cropSize.width,height:this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,"data-testid":"cropper",className:classNames("reactEasyCrop_CropArea",At==="round"&&"reactEasyCrop_CropAreaRound",$t&&"reactEasyCrop_CropAreaGrid",Xt)}))},Qe.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:MAX_ZOOM,minZoom:MIN_ZOOM,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:KEYBOARD_STEP},Qe.getMousePoint=function(it){return{x:Number(it.clientX),y:Number(it.clientY)}},Qe.getTouchPoint=function(it){return{x:Number(it.clientX),y:Number(it.clientY)}},Qe}(reactExports.Component);class UnFile{constructor(Qe,it){this.obj=Qe,this.name=it,this.file=Qe.file,this.media=Qe.media}file;media;url;rc=0;static fromMedia(Qe,it=`pixai-media_${Qe.id}.${getImageDownloadFileExt({media:Qe})}`){return new UnFile({media:Qe},it)}static fromFile(Qe,it=Qe.name){return new UnFile({file:Qe},it)}static async fromCanvas(Qe,it="canvas.png",lt="image/png"){const ut=await new Promise(dt=>Qe.toBlob(dt,lt));if(!ut)throw new Error("Canvas to blob failed");return UnFile.fromFile(new File([ut],it,{type:lt}))}static async fromOffscreenCanvas(Qe,it="canvas.png",lt="image/png"){const ut=await Qe.convertToBlob({type:lt});if(!ut)throw new Error("Offscreen canvas to blob failed");return UnFile.fromFile(new File([ut],it,{type:lt}))}ifIs(Qe,it){if(this.obj[Qe])return it(this.obj[Qe])}ifHas(Qe,it){if(this[Qe])return it(this[Qe])}createUrl(){if(this.url)return this.rc&&this.rc++,this.url;if(this.file)return this.rc++,this.url=URL.createObjectURL(this.file);if(this.media){if(this.url=getPublicUrl(this.media),!this.url)throw new Error("Media has no public URL");return this.rc++,this.url}throw new Error("No file or media, this should be unreachable")}revokeUrl(){!this.url||this.rc<=0||(this.rc--,this.rc===0&&(URL.revokeObjectURL(this.url),this.url=void 0))}async toCompressed(Qe){const{maxWidthOrHeight:it=2048,maxSizeMB:lt=4,divisibleBy:ut,preferExistingMedia:dt=!0,onCompressed:xt}=Qe,ft=await this.getDimensions();if(await(async()=>ut&&(ft.width%ut||ft.height%ut)?!1:dt&&this.media?!0:!(ft.width>it||ft.height>it||(await this.toFile()).size>lt*1024*1024))())return this;let kt=await this.toFile();if(ut){const{width:Mt,height:Nt}=getCompressedDimensions({...ft,divisibleBy:ut,maxEdge:it});if(!Mt||!Nt)throw new Error("Invalid compressed dimensions");kt=await resizeImage(kt,Mt,Nt)}let St;try{St=await imageCompression(kt,{maxWidthOrHeight:it,maxSizeMB:lt,useWebWorker:!0,fileType:"image/webp"})}catch{try{St=await imageCompression(kt,{maxWidthOrHeight:it,maxSizeMB:lt,useWebWorker:!0,fileType:"image/png"})}catch{St=await imageCompression(kt,{maxWidthOrHeight:it,maxSizeMB:lt,fileType:"image/png"})}}const Tt=UnFile.fromFile(St);return await xt?.(Tt),Tt}async toFile(){if(this.file)return this.file;if(this.media){if(this.file=await downloadMedia(this.obj.media),!this.file)throw new Error("Download media failed");return this.file}throw new Error("No file or media, this should be unreachable")}async _toMedia(Qe){if(this.media)return this.media;if(this.file)return this.media=(await uploadMedia(this.file,Qe)).media;throw new Error("No file or media, this should be unreachable")}async toMedia({uploadMedia:Qe,...it}){return(await this.toCompressed(it))._toMedia(Qe)}dimCache;getDimensions(){return this.dimCache||(this.dimCache=this._getDimensions()),this.dimCache}async _getDimensions(){if(this.media){const{width:Qe,height:it}=this.media;if(Qe&&it)return{width:Qe,height:it}}return asyncScopedObjectUrl(this,getImageUrlDimensionOrThrow)}}const createObjectURL=He=>He instanceof UnFile?He.createUrl():URL.createObjectURL(He),revokeObjectURL=(He,Qe)=>He instanceof UnFile?He.revokeUrl():URL.revokeObjectURL(Qe);function useObjectUrl(He){const Qe=reactExports.useRef(),it=reactExports.useRef();return He!==it.current&&(Qe.current&&revokeObjectURL(it.current,Qe.current),He?Qe.current=createObjectURL(He):Qe.current=void 0,it.current=He),useUnmount(()=>{Qe.current&&revokeObjectURL(it.current,Qe.current)}),Qe.current}async function asyncScopedObjectUrl(He,Qe){const it=createObjectURL(He);try{return await Qe(it)}finally{it&&revokeObjectURL(He,it)}}const icBaselineZoomIn=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5A6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]}),icBaselineZoomOut=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5A6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14zM7 9h5v1H7z"})}),createImage=He=>new Promise((Qe,it)=>{const lt=new Image;lt.addEventListener("load",()=>Qe(lt)),lt.addEventListener("error",ut=>it(ut)),lt.setAttribute("crossOrigin","anonymous"),lt.src=He});function getRadianAngle(He){return He*Math.PI/180}function rotateSize(He,Qe,it){const lt=getRadianAngle(it);return{width:Math.abs(Math.cos(lt)*He)+Math.abs(Math.sin(lt)*Qe),height:Math.abs(Math.sin(lt)*He)+Math.abs(Math.cos(lt)*Qe)}}async function getCroppedImg(He,Qe,it=0,lt={horizontal:!1,vertical:!1}){const ut=await createImage(He),dt=document.createElement("canvas"),xt=dt.getContext("2d");if(!xt)return null;const ft=getRadianAngle(it),{width:vt,height:kt}=rotateSize(ut.width,ut.height,it);dt.width=vt,dt.height=kt,xt.translate(vt/2,kt/2),xt.rotate(ft),xt.scale(lt.horizontal?-1:1,lt.vertical?-1:1),xt.translate(-ut.width/2,-ut.height/2),xt.drawImage(ut,0,0);const St=document.createElement("canvas"),Tt=St.getContext("2d");return Tt?(St.width=Qe.width,St.height=Qe.height,Tt.drawImage(dt,Qe.x,Qe.y,Qe.width,Qe.height,0,0,Qe.width,Qe.height),new Promise(Mt=>St.toBlob(Nt=>Mt(Nt)))):null}const DEFAULT_SIZE=200,getFileSize=async He=>{const Qe=document.createElement("img");Qe.src=URL.createObjectURL(He),Qe.style.display="none",document.body.appendChild(Qe),await new Promise(lt=>{Qe.onload=()=>{lt()}});const it={width:Qe.width,height:Qe.height};return document.body.removeChild(Qe),it},CropAndUploadImage=reactExports.forwardRef(function He(Qe,it){const{allowedFileTypes:lt="image/png, image/jpeg",maxHeight:ut=DEFAULT_SIZE,maxWidth:dt=DEFAULT_SIZE,cropShape:xt}=Qe,[ft,vt]=reactExports.useState(!1),{t:kt}=useTranslation(["action"]),[St,Tt]=reactExports.useState(1),[Mt,Nt]=reactExports.useState(1),[At,$t]=reactExports.useState(3),[Dt,Ft]=reactExports.useState({x:0,y:0}),[Bt,Ot]=reactExports.useState(!1),[Qt,Wt]=reactExports.useState(null),Xt=useObjectUrl(Qt),[Kt,Jt]=reactExports.useState(null),hr=useObjectUrl(Kt),xr=Math.max(dt,ut),gr=reactExports.useCallback(async vr=>{const yr=await getFileSize(vr),Cr=Math.min(1,Number((Math.min(yr.width,yr.height)/xr).toFixed(2))),Rr=Math.max(1,Number((Math.max(yr.width,yr.height)/xr).toFixed(2)));Nt(Cr),$t(Rr),Tt(Cr),Wt(vr),Ot(vr.type==="image/gif"),br(void 0,{width:yr.width,height:yr.height,x:0,y:0})},[xr]),br=reactExports.useCallback(throttle(async(vr,yr)=>{if(Qt)try{vt(!0);const Cr=Bt?await __vitePreload(async()=>{const{cropGif:Rr}=await import("./vendor-gifsicle-DkWzb2rW.js");return{cropGif:Rr}},[],import.meta.url).then(({cropGif:Rr})=>Rr(Qt,yr)):await asyncScopedObjectUrl(Qt,Rr=>getCroppedImg(Rr,yr));Cr&&(Jt(Cr),vt(!1))}catch(Cr){toast.error("Failed to crop image: ",Cr.message)}},1e3),[Bt,Qt]);return reactExports.useImperativeHandle(it,()=>({getImage:async()=>{let vr=null;return Bt?vr=Kt:vr=await imageCompression(Kt,{maxWidthOrHeight:xr,maxSizeMB:1,useWebWorker:!0,fileType:"image/png"}),vr},zoom:St}),[Kt,Bt,xr,St]),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap w-full p-8 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{children:kt("action:drag-and-move-hint")}),Xt?jsxRuntimeExports.jsx(Dropzone,{onDrop:vr=>{gr(vr[0])},noClick:!0,noKeyboard:!0,children:({getRootProps:vr,getInputProps:yr})=>jsxRuntimeExports.jsxs("div",{...vr(),className:"relative h-[250px] w-[250px] m-[25px]",children:[jsxRuntimeExports.jsx(Cropper,{image:Xt,crop:Dt,zoom:St,maxZoom:At,minZoom:Mt,aspect:dt/ut,showGrid:!1,onCropChange:Ft,onCropComplete:br,onZoomChange:Cr=>{Tt(Number(Cr.toFixed(2)))},cropShape:xt}),jsxRuntimeExports.jsx("input",{...yr()})]})}):jsxRuntimeExports.jsx("div",{style:{width:250,height:250}})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 relative",children:[jsxRuntimeExports.jsx("h3",{children:kt("action:preview")}),jsxRuntimeExports.jsxs("div",{className:"w-full h-full mt-4 flex items-center justify-center relative",children:[hr&&jsxRuntimeExports.jsx("img",{width:dt,height:ut,src:hr,className:cx("object-cover",xt==="round"&&"rounded-full")}),ft&&jsxRuntimeExports.jsx("div",{className:"absolute w-full h-full bg-stone-800/80 top-0 left-0 flex items-center justify-center text-xl text-white backdrop-blur-sm",children:"Loading…"})]})]})]}),hr&&jsxRuntimeExports.jsxs("div",{className:"w-full flex gap-2 items-center",children:[jsxRuntimeExports.jsx(icBaselineZoomOut,{className:"size-6"}),jsxRuntimeExports.jsx(Slider,{disabled:ft,className:"flex-1",value:St,step:.01,min:Mt,max:At,onChange:(vr,yr)=>{typeof yr=="number"&&Tt(Number(yr.toFixed(2)))}}),jsxRuntimeExports.jsx(icBaselineZoomIn,{className:"size-6"})]}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("input",{disabled:ft,type:"file",onChange:vr=>{if(!(!vr.target.files||vr.target.files.length===0))return gr(vr.target.files[0])},accept:lt})})]})});function CropImageDialogContent(He){const{maxHeight:Qe=DEFAULT_SIZE,maxWidth:it=DEFAULT_SIZE,cropShape:lt}=He,ut=He.file,[dt,xt]=reactExports.useState(),[ft,vt]=reactExports.useState(1),[kt,St]=reactExports.useState(1),[Tt,Mt]=reactExports.useState(3),[Nt,At]=reactExports.useState(!1),[$t,Dt]=reactExports.useState(null),Ft=useObjectUrl($t),Bt=Math.max(it,Qe),[Ot,Qt]=reactExports.useState({x:0,y:0}),Wt=reactExports.useCallback(async hr=>{At(!1);const xr=await getFileSize(hr),gr=Math.min(1,Number((Math.min(xr.width,xr.height)/Bt).toFixed(2))),br=Math.max(1,Number((Math.max(xr.width,xr.height)/Bt).toFixed(2)));St(gr),Mt(br),vt(gr),setTimeout(()=>{At(!0)},300)},[Bt]);reactExports.useEffect(()=>{Wt(ut);const hr=URL.createObjectURL(ut);return xt(hr),()=>{URL.revokeObjectURL(hr)}},[ut]);const Xt=reactExports.useCallback(throttle(async(hr,xr)=>{if(ut)try{const gr=await asyncScopedObjectUrl(ut,br=>getCroppedImg(br,xr));gr&&Dt(gr)}catch(gr){toast.error("Failed to crop image: ",gr.message)}},1e3),[ut]),Kt=reactExports.useCallback(()=>{$t?(He.resolve($t),He.close()):toast.error("Result not exists")},[$t]),Jt=reactExports.useCallback(()=>{He.resolve(void 0),He.close()},[]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:jsxRuntimeExports.jsx(Text,{i18nKey:"action:drag-and-move-hint"})}),jsxRuntimeExports.jsxs(UIDialogContent,{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap w-full gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:drag-and-move-hint"})}),jsxRuntimeExports.jsx("div",{className:"relative mt-1",style:{width:it,height:Qe},children:Nt&&jsxRuntimeExports.jsx(Cropper,{image:dt,crop:Ot,zoom:ft,maxZoom:Tt,minZoom:kt,aspect:it/Qe,showGrid:!1,onCropChange:Qt,onCropComplete:Xt,onZoomChange:hr=>{vt(Number(hr.toFixed(2)))},cropShape:lt})})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 relative",children:[jsxRuntimeExports.jsx("h3",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:preview"})}),jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center relative mt-1",style:{width:it,height:Qe},children:Ft&&jsxRuntimeExports.jsx("img",{width:it,height:Qe,src:Ft,className:cx("object-cover",lt==="round"&&"rounded-full")})})]})]}),jsxRuntimeExports.jsxs("div",{className:"w-full flex gap-2 items-center mt-4",children:[jsxRuntimeExports.jsx(icBaselineZoomOut,{className:"size-6"}),jsxRuntimeExports.jsx(Slider,{className:"flex-1",value:ft,step:.01,min:kt,max:Tt,onChange:(hr,xr)=>{typeof xr=="number"&&vt(Number(xr.toFixed(2)))}}),jsxRuntimeExports.jsx(icBaselineZoomIn,{className:"size-6"})]})]}),jsxRuntimeExports.jsxs(UIDialogFooter,{children:[jsxRuntimeExports.jsx(UIButton$1,{onPress:Jt,variant:"outlined",children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:crop.skip-crop.label"})}),jsxRuntimeExports.jsx(UIButton$1,{onPress:Kt,variant:"filled",children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:confirm"})})]})]})}async function dialogCropImage(He){return UIDialog.create({dismissable:!0,children:({resolve:Qe,closeDialog:it})=>jsxRuntimeExports.jsx(CropImageDialogContent,{file:He.file,resolve:Qe,close:it}),className:"max-w-screen-mlg"})}function CropCurrentImageForUploadButton(He){return He.media?jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",busy:"auto",onPress:async()=>{const Qe=await downloadMedia(He.media);if(!Qe)return;const it=await dialogCropImage({file:Qe});it&&He.action(it)},children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:crop.adjust-crop.label"})}):null}const index$1=Object.freeze(Object.defineProperty({__proto__:null,CropCurrentImageForUploadButton,default:CropAndUploadImage,dialogCropImage,getFileSize},Symbol.toStringTag,{value:"Module"})),icBaselineKeyboardArrowLeft=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6l6 6l1.41-1.41z"})}),icBaselineKeyboardArrowRight=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M8.59 16.59L13.17 12L8.59 7.41L10 6l6 6l-6 6l-1.41-1.41z"})});function TablePaginationActionsWrapper(He){const{pageInfo:Qe,onCursorChange:it=()=>{},isPosSeq:lt}=He,ut=()=>{it(lt?{before:Qe?.startCursor,after:void 0}:{before:void 0,after:Qe?.endCursor})},dt=()=>{it(lt?{before:void 0,after:Qe?.endCursor}:{before:Qe?.startCursor,after:void 0})};return jsxRuntimeExports.jsxs("div",{className:He.className,children:[jsxRuntimeExports.jsx(IconButton,{onClick:ut,disabled:lt?!Qe?.hasPreviousPage:!Qe?.hasNextPage,"aria-label":"previous page",children:jsxRuntimeExports.jsx(icBaselineKeyboardArrowLeft,{className:"size-6"})}),jsxRuntimeExports.jsx(IconButton,{onClick:dt,disabled:lt?!Qe?.hasNextPage:!Qe?.hasPreviousPage,"aria-label":"next page",children:jsxRuntimeExports.jsx(icBaselineKeyboardArrowRight,{className:"size-6"})})]})}function setTimeoutPoll(He,Qe=1e3,it){let lt=!0,ut;async function dt(){await Promise.all([new Promise(xt=>{ut=window.setTimeout(xt,Qe)}),Promise.resolve(He())]),lt&&dt()}return dt(),()=>{lt=!1,window.clearTimeout(ut)}}const use=React.use||(He=>{if(He.status==="pending")throw He;if(He.status==="fulfilled")return He.value;throw He.status==="rejected"?He.reason:(He.status="pending",He.then(Qe=>{He.status="fulfilled",He.value=Qe},Qe=>{He.status="rejected",He.reason=Qe}),He)}),WITH_DEDUPE={dedupe:!0},useSWRHandler=(He,Qe,it)=>{const{cache:lt,compare:ut,suspense:dt,fallbackData:xt,revalidateOnMount:ft,revalidateIfStale:vt,refreshInterval:kt,refreshWhenHidden:St,refreshWhenOffline:Tt,keepPreviousData:Mt}=it,[Nt,At,$t,Dt]=SWRGlobalState.get(lt),[Ft,Bt]=serialize$1(He),Ot=reactExports.useRef(!1),Qt=reactExports.useRef(!1),Wt=reactExports.useRef(Ft),Xt=reactExports.useRef(Qe),Kt=reactExports.useRef(it),Jt=()=>Kt.current,hr=()=>Jt().isVisible()&&Jt().isOnline(),[xr,gr,br,vr]=createCacheHelper(lt,Ft),yr=reactExports.useRef({}).current,Cr=isUndefined(xt)?it.fallback[Ft]:xt,Rr=(Xr,en)=>{for(const rn in yr){const sn=rn;if(sn==="data"){if(!ut(Xr[sn],en[sn])&&(!isUndefined(Xr[sn])||!ut(Nr,en[sn])))return!1}else if(en[sn]!==Xr[sn])return!1}return!0},Ir=reactExports.useMemo(()=>{const Xr=!Ft||!Qe?!1:isUndefined(ft)?Jt().isPaused()||dt?!1:isUndefined(vt)?!0:vt:ft,en=ss=>{const cs=mergeObjects(ss);return delete cs._k,Xr?{isValidating:!0,isLoading:!0,...cs}:cs},rn=xr(),sn=vr(),os=en(rn),ls=rn===sn?os:en(sn);let rs=os;return[()=>{const ss=en(xr());return Rr(ss,rs)?(rs.data=ss.data,rs.isLoading=ss.isLoading,rs.isValidating=ss.isValidating,rs.error=ss.error,rs):(rs=ss,ss)},()=>ls]},[lt,Ft]),Tr=shimExports.useSyncExternalStore(reactExports.useCallback(Xr=>br(Ft,(en,rn)=>{Rr(rn,en)||Xr()}),[lt,Ft]),Ir[0],Ir[1]),$r=!Ot.current,Zr=Nt[Ft]&&Nt[Ft].length>0,Sr=Tr.data,Dr=isUndefined(Sr)?Cr:Sr,wr=Tr.error,qr=reactExports.useRef(Dr),Nr=Mt?isUndefined(Sr)?qr.current:Sr:Dr,Jr=Zr&&!isUndefined(wr)?!1:$r&&!isUndefined(ft)?ft:Jt().isPaused()?!1:dt?isUndefined(Dr)?!1:vt:isUndefined(Dr)||vt,Qr=!!(Ft&&Qe&&$r&&Jr),Ur=isUndefined(Tr.isValidating)?Qr:Tr.isValidating,nn=isUndefined(Tr.isLoading)?Qr:Tr.isLoading,Cn=reactExports.useCallback(async Xr=>{const en=Xt.current;if(!Ft||!en||Qt.current||Jt().isPaused())return!1;let rn,sn,os=!0;const ls=Xr||{},rs=!$t[Ft]||!ls.dedupe,ss=()=>IS_REACT_LEGACY?!Qt.current&&Ft===Wt.current&&Ot.current:Ft===Wt.current,cs={isValidating:!1,isLoading:!1},ps=()=>{gr(cs)},hs=()=>{const tn=$t[Ft];tn&&tn[1]===sn&&delete $t[Ft]},ns={isValidating:!0};isUndefined(xr().data)&&(ns.isLoading=!0);try{if(rs&&(gr(ns),it.loadingTimeout&&isUndefined(xr().data)&&setTimeout(()=>{os&&ss()&&Jt().onLoadingSlow(Ft,it)},it.loadingTimeout),$t[Ft]=[en(Bt),getTimestamp()]),[rn,sn]=$t[Ft],rn=await rn,rs&&setTimeout(hs,it.dedupingInterval),!$t[Ft]||$t[Ft][1]!==sn)return rs&&ss()&&Jt().onDiscarded(Ft),!1;cs.error=UNDEFINED;const tn=At[Ft];if(!isUndefined(tn)&&(sn<=tn[0]||sn<=tn[1]||tn[1]===0))return ps(),rs&&ss()&&Jt().onDiscarded(Ft),!1;const ts=xr().data;cs.data=ut(ts,rn)?ts:rn,rs&&ss()&&Jt().onSuccess(rn,Ft,it)}catch(tn){hs();const ts=Jt(),{shouldRetryOnError:as}=ts;ts.isPaused()||(cs.error=tn,rs&&ss()&&(ts.onError(tn,Ft,ts),(as===!0||isFunction$2(as)&&as(tn))&&(!Jt().revalidateOnFocus||!Jt().revalidateOnReconnect||hr())&&ts.onErrorRetry(tn,Ft,ts,us=>{const ds=Nt[Ft];ds&&ds[0]&&ds[0](events.ERROR_REVALIDATE_EVENT,us)},{retryCount:(ls.retryCount||0)+1,dedupe:!0})))}return os=!1,ps(),!0},[Ft,lt]),es=reactExports.useCallback((...Xr)=>internalMutate(lt,Wt.current,...Xr),[]);if(useIsomorphicLayoutEffect$1(()=>{Xt.current=Qe,Kt.current=it,isUndefined(Sr)||(qr.current=Sr)}),useIsomorphicLayoutEffect$1(()=>{if(!Ft)return;const Xr=Cn.bind(UNDEFINED,WITH_DEDUPE);let en=0;const sn=subscribeCallback(Ft,Nt,(os,ls={})=>{if(os==events.FOCUS_EVENT){const rs=Date.now();Jt().revalidateOnFocus&&rs>en&&hr()&&(en=rs+Jt().focusThrottleInterval,Xr())}else if(os==events.RECONNECT_EVENT)Jt().revalidateOnReconnect&&hr()&&Xr();else{if(os==events.MUTATE_EVENT)return Cn();if(os==events.ERROR_REVALIDATE_EVENT)return Cn(ls)}});return Qt.current=!1,Wt.current=Ft,Ot.current=!0,gr({_k:Bt}),Jr&&(isUndefined(Dr)||IS_SERVER?Xr():rAF(Xr)),()=>{Qt.current=!0,sn()}},[Ft]),useIsomorphicLayoutEffect$1(()=>{let Xr;function en(){const sn=isFunction$2(kt)?kt(xr().data):kt;sn&&Xr!==-1&&(Xr=setTimeout(rn,sn))}function rn(){!xr().error&&(St||Jt().isVisible())&&(Tt||Jt().isOnline())?Cn(WITH_DEDUPE).then(en):en()}return en(),()=>{Xr&&(clearTimeout(Xr),Xr=-1)}},[kt,St,Tt,Ft]),reactExports.useDebugValue(Nr),dt&&isUndefined(Dr)&&Ft){if(!IS_REACT_LEGACY&&IS_SERVER)throw new Error("Fallback data is required when using suspense in SSR.");Xt.current=Qe,Kt.current=it,Qt.current=!1;const Xr=Dt[Ft];if(!isUndefined(Xr)){const en=es(Xr);use(en)}if(isUndefined(wr)){const en=Cn(WITH_DEDUPE);isUndefined(Nr)||(en.status="fulfilled",en.value=!0),use(en)}else throw wr}return{mutate:es,get data(){return yr.data=!0,Nr},get error(){return yr.error=!0,wr},get isValidating(){return yr.isValidating=!0,Ur},get isLoading(){return yr.isLoading=!0,nn}}};OBJECT.defineProperty(SWRConfig$1,"defaultValue",{value:defaultConfig});const useSWR=withArgs(useSWRHandler),getFirstPageKey=He=>serialize$1(He?He(0,null):null)[0],EMPTY_PROMISE=Promise.resolve(),infinite=He=>(Qe,it,lt)=>{const ut=reactExports.useRef(!1),{cache:dt,initialSize:xt=1,revalidateAll:ft=!1,persistSize:vt=!1,revalidateFirstPage:kt=!0,revalidateOnMount:St=!1,parallel:Tt=!1}=lt,[,,,Mt]=SWRGlobalState.get(cache$2);let Nt;try{Nt=getFirstPageKey(Qe),Nt&&(Nt=INFINITE_PREFIX+Nt)}catch{}const[At,$t,Dt]=createCacheHelper(dt,Nt),Ft=reactExports.useCallback(()=>isUndefined(At()._l)?xt:At()._l,[dt,Nt,xt]);shimExports.useSyncExternalStore(reactExports.useCallback(Jt=>Nt?Dt(Nt,()=>{Jt()}):()=>{},[dt,Nt]),Ft,Ft);const Bt=reactExports.useCallback(()=>{const Jt=At()._l;return isUndefined(Jt)?xt:Jt},[Nt,xt]),Ot=reactExports.useRef(Bt());useIsomorphicLayoutEffect$1(()=>{if(!ut.current){ut.current=!0;return}Nt&&$t({_l:vt?Ot.current:Bt()})},[Nt,dt]);const Qt=St&&!ut.current,Wt=He(Nt,async Jt=>{const hr=At()._i,xr=At()._r;$t({_r:UNDEFINED});const gr=[],br=Bt(),[vr]=createCacheHelper(dt,Jt),yr=vr().data,Cr=[];let Rr=null;for(let Ir=0;Ir<br;++Ir){const[Tr,$r]=serialize$1(Qe(Ir,Tt?null:Rr));if(!Tr)break;const[Zr,Sr]=createCacheHelper(dt,Tr);let Dr=Zr().data;const wr=ft||hr||isUndefined(Dr)||kt&&!Ir&&!isUndefined(yr)||Qt||yr&&!isUndefined(yr[Ir])&&!lt.compare(yr[Ir],Dr);if(it&&(typeof xr=="function"?xr(Dr,$r):wr)){const qr=async()=>{if(!(Tr in Mt))Dr=await it($r);else{const Jr=Mt[Tr];delete Mt[Tr],Dr=await Jr}Sr({data:Dr,_k:$r}),gr[Ir]=Dr};Tt?Cr.push(qr):await qr()}else gr[Ir]=Dr;Tt||(Rr=Dr)}return Tt&&await Promise.all(Cr.map(Ir=>Ir())),$t({_i:UNDEFINED}),gr},lt),Xt=reactExports.useCallback(function(Jt,hr){const xr=typeof hr=="boolean"?{revalidate:hr}:hr||{},gr=xr.revalidate!==!1;return Nt?(gr&&(isUndefined(Jt)?$t({_i:!0,_r:xr.revalidate}):$t({_i:!1,_r:xr.revalidate})),arguments.length?Wt.mutate(Jt,{...xr,revalidate:gr}):Wt.mutate()):EMPTY_PROMISE},[Nt,dt]),Kt=reactExports.useCallback(Jt=>{if(!Nt)return EMPTY_PROMISE;const[,hr]=createCacheHelper(dt,Nt);let xr;if(isFunction$2(Jt)?xr=Jt(Bt()):typeof Jt=="number"&&(xr=Jt),typeof xr!="number")return EMPTY_PROMISE;hr({_l:xr}),Ot.current=xr;const gr=[],[br]=createCacheHelper(dt,Nt);let vr=null;for(let yr=0;yr<xr;++yr){const[Cr]=serialize$1(Qe(yr,vr)),[Rr]=createCacheHelper(dt,Cr),Ir=Cr?Rr().data:UNDEFINED;if(isUndefined(Ir))return Xt(br().data);gr.push(Ir),vr=Ir}return Xt(gr)},[Nt,dt,Xt,Bt]);return{size:Bt(),setSize:Kt,mutate:Xt,get data(){return Wt.data},get error(){return Wt.error},get isValidating(){return Wt.isValidating},get isLoading(){return Wt.isLoading}}},useSWRInfinite=withMiddleware(useSWR,infinite);function confirmModelDeletion(){return UIDialog.confirm({heading:"Delete model?",content:"Are you sure you want to delete this model?",confirmProps:{children:"Delete",color:"danger"}})}async function deleteModel(He,Qe){if(He=typeof He=="string"?client.getGenerationModel({id:He}).then(it=>it.generationModel):He,await confirmModelDeletion()){if(He=await He,!He)return!0;track("delete_model_click",{modelId:He.id,type:He.type});try{return await client.deleteGenerationModel({id:He.id}),toast.success("Delete successfully"),!0}catch(it){return toast.error(`Failed to delete. ${String(it)}`),!1}}}async function publishModel(He){const{upsertGenerationModel:Qe}=await client.upsertGenerationModel({id:He,input:{isPrivate:!1}});return Qe&&mutateGenerationModel(Qe.id,Qe,!1),Qe}async function importExternalModel(He){const{importExternalModel:Qe}=await client.importExternalModel({url:He});return Qe??{}}async function checkUpload(He){const{fileUploadRecord:Qe}=await client.getFileUploadRecord({id:He});return Qe??{}}const ExternalModelStatus={Idle:"idle",Validating:"validating",Uploading:"uploading",Success:"success",Error:"error"};function useExternalModelHelpers(){const[He,Qe]=reactExports.useState(""),[it,lt]=reactExports.useState(),[ut,dt]=reactExports.useState(ExternalModelStatus.Idle),[xt,ft]=reactExports.useState();let vt;const{t:kt}=useTranslation(["market"]);async function St(Mt){Tt(),Qe(Mt),dt(ExternalModelStatus.Validating);try{const Nt=await importExternalModel(Mt);if(lt(Nt),Nt.fileId)if(Nt.exists)dt(ExternalModelStatus.Success),track("fetching_model_success",{exist:!0});else{dt(ExternalModelStatus.Uploading);const{fileId:At}=Nt,$t=vt=setTimeoutPoll(async()=>{const{isFinished:Dt}=await checkUpload(At);Dt&&($t(),dt(ExternalModelStatus.Success),track("fetching_model_success",{exist:!1}))},1e4)}else dt(ExternalModelStatus.Idle);return Nt}catch(Nt){return console.error(Nt),dt(ExternalModelStatus.Error),ft(Nt),toast.error(kt("market:importer.messages.importing-failed",{error:Nt.toString()})),Promise.reject(Nt)}}function Tt(){Qe(""),dt(ExternalModelStatus.Idle),ft(void 0),vt?.(),vt=void 0}return{importModel:St,url:He,modelInfo:it,status:ut,error:xt,validating:ut===ExternalModelStatus.Validating,uploading:ut===ExternalModelStatus.Uploading,success:ut===ExternalModelStatus.Success,reset:Tt}}const PRESET_AUTHOR_ID="1544489361907720074";async function getVaeModels(He){const{generationModels:Qe}=await client.listGenerationModels({first:30,...He,type:GenerationModelType.AnyVae,authorId:PRESET_AUTHOR_ID});return{data:getNodesFromConnection(Qe),pageInfo:Qe.pageInfo}}function useVaeModels(He){const Qe=isSDV1Model(He)?GenerationModelType.Vae:isXLModel(He)?GenerationModelType.SdxlVae:void 0;return useGenerationModels(Qe?{first:30,type:Qe,authorId:PRESET_AUTHOR_ID}:void 0)}function usePresetModels(){const He=useGenerationModels({feed:"preset",type:GenerationModelType.AnyModel});return{modelList:getNodesFromConnection(He.data),...He}}function useGenerationModelsInfinite(He,Qe){return useSWRInfinite(He,it=>it&&client.listGenerationModels(it).then(lt=>lt.generationModels),Qe)}function useMyBookmarkedGenerationModelsInfinite(He,Qe){return useSWRInfinite(He,it=>it&&client.listMyBookmarkedGenerationModels(it).then(lt=>lt.me?.bookmarkedGenerationModels),Qe)}function useListGenerationModelsWithTrainingTaskInfinite(He,Qe){return useSWRInfinite(He,it=>it&&client.listGenerationModelsWithTrainingTask(it).then(lt=>lt.generationModels),Qe)}function getCreateModelInputs(He,Qe){const{modelId:it,title:lt,tags:ut,type:dt,category:xt,uploadId:ft,extra:vt,isDownloadable:kt,media:St,isPrivate:Tt,firstVersionExtra:Mt}=Qe,Nt=!!Qe.modelId;if(!lt)throw new Error(He("market:submit.notice.title-needed"));if(!dt)throw new Error(He("market:submit.notice.type-needed"));if(!St)throw new Error(He("market:submit.notice.media-needed"));if(!Nt&&!ft)throw new Error(He("market:submit.notice.file-cant-be-empty"));const At={permissions:vt?.permissions,description:vt?.description,qualityTags:vt?.qualityTags},{name:$t,...Dt}=Mt??{},Ft=Object.fromEntries(Object.entries(Dt).filter(([Bt,Ot])=>Ot!=null&&Ot!==""));return{title:lt,category:xt,tags:normalizeTags(ut),mediaId:St?.id,isDownloadable:kt,extra:At,isPrivate:Nt&&Tt?void 0:Tt,type:Nt?void 0:dt,fileUploadId:Nt?void 0:ft,firstVersion:{extra:Ft,name:$t}}}function getCreateVersionInputs({versionVals:He,modelId:Qe,fileId:it,mediaId:lt}){const{name:ut,...dt}=He;return{name:ut,modelId:Qe,mediaId:lt,fileUploadId:it,extra:dt}}function getSubmitModelTrackAttrs({values:He}){const{name:Qe,...it}=He.firstVersionExtra??{},lt={version:Qe,...it};return{editMode:He.modelId!=null?"edit":"create",modelName:He.title,type:He.type,isPrivate:He.isPrivate,hasTag:(He.tags??[]).length>0,hasCover:!!He.media,isDownloadable:He.isDownloadable,...lt,...He.extra?.permissions}}function getSubmitModelVersionTrackAttrs({values:He,versionRes:Qe,modelId:it,versionId:lt}){const{name:ut,...dt}=He??{},xt={version:ut,...dt};return{editMode:lt!=null?"edit":"create",modelId:it,type:Qe?.model?.type,...xt}}function parseModelExtras(He){const{permissions:Qe,...it}=He??{};return{...it,permissions:Object.fromEntries(Object.entries(Qe??{}).map(([lt,ut])=>[camelCase(lt),ut]).filter(([lt])=>modelPermissions.includes(lt)))}}var build$1={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(He,Qe){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(it,lt){it.__proto__=lt}||function(it,lt){for(var ut in lt)lt.hasOwnProperty(ut)&&(it[ut]=lt[ut])},extendStatics(He,Qe)};function __extends(He,Qe){extendStatics(He,Qe);function it(){this.constructor=He}He.prototype=Qe===null?Object.create(Qe):(it.prototype=Qe.prototype,new it)}var __assign=function(){return __assign=Object.assign||function(Qe){for(var it,lt=1,ut=arguments.length;lt<ut;lt++){it=arguments[lt];for(var dt in it)Object.prototype.hasOwnProperty.call(it,dt)&&(Qe[dt]=it[dt])}return Qe},__assign.apply(this,arguments)};function __rest(He,Qe){var it={};for(var lt in He)Object.prototype.hasOwnProperty.call(He,lt)&&Qe.indexOf(lt)<0&&(it[lt]=He[lt]);if(He!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ut=0,lt=Object.getOwnPropertySymbols(He);ut<lt.length;ut++)Qe.indexOf(lt[ut])<0&&Object.prototype.propertyIsEnumerable.call(He,lt[ut])&&(it[lt[ut]]=He[lt[ut]]);return it}function __decorate(He,Qe,it,lt){var ut=arguments.length,dt=ut<3?Qe:lt===null?lt=Object.getOwnPropertyDescriptor(Qe,it):lt,xt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")dt=Reflect.decorate(He,Qe,it,lt);else for(var ft=He.length-1;ft>=0;ft--)(xt=He[ft])&&(dt=(ut<3?xt(dt):ut>3?xt(Qe,it,dt):xt(Qe,it))||dt);return ut>3&&dt&&Object.defineProperty(Qe,it,dt),dt}function __param(He,Qe){return function(it,lt){Qe(it,lt,He)}}function __metadata(He,Qe){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(He,Qe)}function __awaiter(He,Qe,it,lt){function ut(dt){return dt instanceof it?dt:new it(function(xt){xt(dt)})}return new(it||(it=Promise))(function(dt,xt){function ft(St){try{kt(lt.next(St))}catch(Tt){xt(Tt)}}function vt(St){try{kt(lt.throw(St))}catch(Tt){xt(Tt)}}function kt(St){St.done?dt(St.value):ut(St.value).then(ft,vt)}kt((lt=lt.apply(He,Qe||[])).next())})}function __generator(He,Qe){var it={label:0,sent:function(){if(dt[0]&1)throw dt[1];return dt[1]},trys:[],ops:[]},lt,ut,dt,xt;return xt={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(xt[Symbol.iterator]=function(){return this}),xt;function ft(kt){return function(St){return vt([kt,St])}}function vt(kt){if(lt)throw new TypeError("Generator is already executing.");for(;it;)try{if(lt=1,ut&&(dt=kt[0]&2?ut.return:kt[0]?ut.throw||((dt=ut.return)&&dt.call(ut),0):ut.next)&&!(dt=dt.call(ut,kt[1])).done)return dt;switch(ut=0,dt&&(kt=[kt[0]&2,dt.value]),kt[0]){case 0:case 1:dt=kt;break;case 4:return it.label++,{value:kt[1],done:!1};case 5:it.label++,ut=kt[1],kt=[0];continue;case 7:kt=it.ops.pop(),it.trys.pop();continue;default:if(dt=it.trys,!(dt=dt.length>0&&dt[dt.length-1])&&(kt[0]===6||kt[0]===2)){it=0;continue}if(kt[0]===3&&(!dt||kt[1]>dt[0]&&kt[1]<dt[3])){it.label=kt[1];break}if(kt[0]===6&&it.label<dt[1]){it.label=dt[1],dt=kt;break}if(dt&&it.label<dt[2]){it.label=dt[2],it.ops.push(kt);break}dt[2]&&it.ops.pop(),it.trys.pop();continue}kt=Qe.call(He,it)}catch(St){kt=[6,St],ut=0}finally{lt=dt=0}if(kt[0]&5)throw kt[1];return{value:kt[0]?kt[1]:void 0,done:!0}}}function __createBinding(He,Qe,it,lt){lt===void 0&&(lt=it),He[lt]=Qe[it]}function __exportStar(He,Qe){for(var it in He)it!=="default"&&!Qe.hasOwnProperty(it)&&(Qe[it]=He[it])}function __values$1(He){var Qe=typeof Symbol=="function"&&Symbol.iterator,it=Qe&&He[Qe],lt=0;if(it)return it.call(He);if(He&&typeof He.length=="number")return{next:function(){return He&&lt>=He.length&&(He=void 0),{value:He&&He[lt++],done:!He}}};throw new TypeError(Qe?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(He,Qe){var it=typeof Symbol=="function"&&He[Symbol.iterator];if(!it)return He;var lt=it.call(He),ut,dt=[],xt;try{for(;(Qe===void 0||Qe-- >0)&&!(ut=lt.next()).done;)dt.push(ut.value)}catch(ft){xt={error:ft}}finally{try{ut&&!ut.done&&(it=lt.return)&&it.call(lt)}finally{if(xt)throw xt.error}}return dt}function __spread(){for(var He=[],Qe=0;Qe<arguments.length;Qe++)He=He.concat(__read(arguments[Qe]));return He}function __spreadArrays(){for(var He=0,Qe=0,it=arguments.length;Qe<it;Qe++)He+=arguments[Qe].length;for(var lt=Array(He),ut=0,Qe=0;Qe<it;Qe++)for(var dt=arguments[Qe],xt=0,ft=dt.length;xt<ft;xt++,ut++)lt[ut]=dt[xt];return lt}function __await(He){return this instanceof __await?(this.v=He,this):new __await(He)}function __asyncGenerator(He,Qe,it){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var lt=it.apply(He,Qe||[]),ut,dt=[];return ut={},xt("next"),xt("throw"),xt("return"),ut[Symbol.asyncIterator]=function(){return this},ut;function xt(Mt){lt[Mt]&&(ut[Mt]=function(Nt){return new Promise(function(At,$t){dt.push([Mt,Nt,At,$t])>1||ft(Mt,Nt)})})}function ft(Mt,Nt){try{vt(lt[Mt](Nt))}catch(At){Tt(dt[0][3],At)}}function vt(Mt){Mt.value instanceof __await?Promise.resolve(Mt.value.v).then(kt,St):Tt(dt[0][2],Mt)}function kt(Mt){ft("next",Mt)}function St(Mt){ft("throw",Mt)}function Tt(Mt,Nt){Mt(Nt),dt.shift(),dt.length&&ft(dt[0][0],dt[0][1])}}function __asyncDelegator(He){var Qe,it;return Qe={},lt("next"),lt("throw",function(ut){throw ut}),lt("return"),Qe[Symbol.iterator]=function(){return this},Qe;function lt(ut,dt){Qe[ut]=He[ut]?function(xt){return(it=!it)?{value:__await(He[ut](xt)),done:ut==="return"}:dt?dt(xt):xt}:dt}}function __asyncValues(He){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Qe=He[Symbol.asyncIterator],it;return Qe?Qe.call(He):(He=typeof __values$1=="function"?__values$1(He):He[Symbol.iterator](),it={},lt("next"),lt("throw"),lt("return"),it[Symbol.asyncIterator]=function(){return this},it);function lt(dt){it[dt]=He[dt]&&function(xt){return new Promise(function(ft,vt){xt=He[dt](xt),ut(ft,vt,xt.done,xt.value)})}}function ut(dt,xt,ft,vt){Promise.resolve(vt).then(function(kt){dt({value:kt,done:ft})},xt)}}function __makeTemplateObject(He,Qe){return Object.defineProperty?Object.defineProperty(He,"raw",{value:Qe}):He.raw=Qe,He}function __importStar(He){if(He&&He.__esModule)return He;var Qe={};if(He!=null)for(var it in He)Object.hasOwnProperty.call(He,it)&&(Qe[it]=He[it]);return Qe.default=He,Qe}function __importDefault(He){return He&&He.__esModule?He:{default:He}}function __classPrivateFieldGet(He,Qe){if(!Qe.has(He))throw new TypeError("attempted to get private field on non-instance");return Qe.get(He)}function __classPrivateFieldSet(He,Qe,it){if(!Qe.has(He))throw new TypeError("attempted to set private field on non-instance");return Qe.set(He,it),it}const tslib_es6=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return __assign},__asyncDelegator,__asyncGenerator,__asyncValues,__await,__awaiter,__classPrivateFieldGet,__classPrivateFieldSet,__createBinding,__decorate,__exportStar,__extends,__generator,__importDefault,__importStar,__makeTemplateObject,__metadata,__param,__read,__rest,__spread,__spreadArrays,__values:__values$1},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(tslib_es6);var jsSha256={},constants={},hasRequiredConstants;function requireConstants(){return hasRequiredConstants||(hasRequiredConstants=1,Object.defineProperty(constants,"__esModule",{value:!0}),constants.MAX_HASHABLE_LENGTH=constants.INIT=constants.KEY=constants.DIGEST_LENGTH=constants.BLOCK_SIZE=void 0,constants.BLOCK_SIZE=64,constants.DIGEST_LENGTH=32,constants.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),constants.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],constants.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1),constants}var RawSha256={},hasRequiredRawSha256;function requireRawSha256(){if(hasRequiredRawSha256)return RawSha256;hasRequiredRawSha256=1,Object.defineProperty(RawSha256,"__esModule",{value:!0}),RawSha256.RawSha256=void 0;var He=requireConstants(),Qe=function(){function it(){this.state=Int32Array.from(He.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return it.prototype.update=function(lt){if(this.finished)throw new Error("Attempted to update an already finished hash.");var ut=0,dt=lt.byteLength;if(this.bytesHashed+=dt,this.bytesHashed*8>He.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;dt>0;)this.buffer[this.bufferLength++]=lt[ut++],dt--,this.bufferLength===He.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},it.prototype.digest=function(){if(!this.finished){var lt=this.bytesHashed*8,ut=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),dt=this.bufferLength;if(ut.setUint8(this.bufferLength++,128),dt%He.BLOCK_SIZE>=He.BLOCK_SIZE-8){for(var xt=this.bufferLength;xt<He.BLOCK_SIZE;xt++)ut.setUint8(xt,0);this.hashBuffer(),this.bufferLength=0}for(var xt=this.bufferLength;xt<He.BLOCK_SIZE-8;xt++)ut.setUint8(xt,0);ut.setUint32(He.BLOCK_SIZE-8,Math.floor(lt/4294967296),!0),ut.setUint32(He.BLOCK_SIZE-4,lt),this.hashBuffer(),this.finished=!0}for(var ft=new Uint8Array(He.DIGEST_LENGTH),xt=0;xt<8;xt++)ft[xt*4]=this.state[xt]>>>24&255,ft[xt*4+1]=this.state[xt]>>>16&255,ft[xt*4+2]=this.state[xt]>>>8&255,ft[xt*4+3]=this.state[xt]>>>0&255;return ft},it.prototype.hashBuffer=function(){for(var lt=this,ut=lt.buffer,dt=lt.state,xt=dt[0],ft=dt[1],vt=dt[2],kt=dt[3],St=dt[4],Tt=dt[5],Mt=dt[6],Nt=dt[7],At=0;At<He.BLOCK_SIZE;At++){if(At<16)this.temp[At]=(ut[At*4]&255)<<24|(ut[At*4+1]&255)<<16|(ut[At*4+2]&255)<<8|ut[At*4+3]&255;else{var $t=this.temp[At-2],Dt=($t>>>17|$t<<15)^($t>>>19|$t<<13)^$t>>>10;$t=this.temp[At-15];var Ft=($t>>>7|$t<<25)^($t>>>18|$t<<14)^$t>>>3;this.temp[At]=(Dt+this.temp[At-7]|0)+(Ft+this.temp[At-16]|0)}var Bt=(((St>>>6|St<<26)^(St>>>11|St<<21)^(St>>>25|St<<7))+(St&Tt^~St&Mt)|0)+(Nt+(He.KEY[At]+this.temp[At]|0)|0)|0,Ot=((xt>>>2|xt<<30)^(xt>>>13|xt<<19)^(xt>>>22|xt<<10))+(xt&ft^xt&vt^ft&vt)|0;Nt=Mt,Mt=Tt,Tt=St,St=kt+Bt|0,kt=vt,vt=ft,ft=xt,xt=Bt+Ot|0}dt[0]+=xt,dt[1]+=ft,dt[2]+=vt,dt[3]+=kt,dt[4]+=St,dt[5]+=Tt,dt[6]+=Mt,dt[7]+=Nt},it}();return RawSha256.RawSha256=Qe,RawSha256}var build={},convertToBuffer={};const fromUtf8$2=He=>{const Qe=[];for(let it=0,lt=He.length;it<lt;it++){const ut=He.charCodeAt(it);if(ut<128)Qe.push(ut);else if(ut<2048)Qe.push(ut>>6|192,ut&63|128);else if(it+1<He.length&&(ut&64512)===55296&&(He.charCodeAt(it+1)&64512)===56320){const dt=65536+((ut&1023)<<10)+(He.charCodeAt(++it)&1023);Qe.push(dt>>18|240,dt>>12&63|128,dt>>6&63|128,dt&63|128)}else Qe.push(ut>>12|224,ut>>6&63|128,ut&63|128)}return Uint8Array.from(Qe)},toUtf8$2=He=>{let Qe="";for(let it=0,lt=He.length;it<lt;it++){const ut=He[it];if(ut<128)Qe+=String.fromCharCode(ut);else if(192<=ut&&ut<224){const dt=He[++it];Qe+=String.fromCharCode((ut&31)<<6|dt&63)}else if(240<=ut&&ut<365){const xt="%"+[ut,He[++it],He[++it],He[++it]].map(ft=>ft.toString(16)).join("%");Qe+=decodeURIComponent(xt)}else Qe+=String.fromCharCode((ut&15)<<12|(He[++it]&63)<<6|He[++it]&63)}return Qe};function fromUtf8$1(He){return new TextEncoder().encode(He)}function toUtf8$1(He){return new TextDecoder("utf-8").decode(He)}const fromUtf8=He=>typeof TextEncoder=="function"?fromUtf8$1(He):fromUtf8$2(He),toUtf8=He=>typeof TextDecoder=="function"?toUtf8$1(He):toUtf8$2(He),distEs=Object.freeze(Object.defineProperty({__proto__:null,fromUtf8,toUtf8},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(distEs);var hasRequiredConvertToBuffer;function requireConvertToBuffer(){if(hasRequiredConvertToBuffer)return convertToBuffer;hasRequiredConvertToBuffer=1,Object.defineProperty(convertToBuffer,"__esModule",{value:!0}),convertToBuffer.convertToBuffer=void 0;var He=require$$0,Qe=typeof Buffer<"u"&&Buffer.from?function(lt){return Buffer.from(lt,"utf8")}:He.fromUtf8;function it(lt){return lt instanceof Uint8Array?lt:typeof lt=="string"?Qe(lt):ArrayBuffer.isView(lt)?new Uint8Array(lt.buffer,lt.byteOffset,lt.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(lt)}return convertToBuffer.convertToBuffer=it,convertToBuffer}var isEmptyData={},hasRequiredIsEmptyData;function requireIsEmptyData(){if(hasRequiredIsEmptyData)return isEmptyData;hasRequiredIsEmptyData=1,Object.defineProperty(isEmptyData,"__esModule",{value:!0}),isEmptyData.isEmptyData=void 0;function He(Qe){return typeof Qe=="string"?Qe.length===0:Qe.byteLength===0}return isEmptyData.isEmptyData=He,isEmptyData}var numToUint8={},hasRequiredNumToUint8;function requireNumToUint8(){if(hasRequiredNumToUint8)return numToUint8;hasRequiredNumToUint8=1,Object.defineProperty(numToUint8,"__esModule",{value:!0}),numToUint8.numToUint8=void 0;function He(Qe){return new Uint8Array([(Qe&4278190080)>>24,(Qe&16711680)>>16,(Qe&65280)>>8,Qe&255])}return numToUint8.numToUint8=He,numToUint8}var uint32ArrayFrom={},hasRequiredUint32ArrayFrom;function requireUint32ArrayFrom(){if(hasRequiredUint32ArrayFrom)return uint32ArrayFrom;hasRequiredUint32ArrayFrom=1,Object.defineProperty(uint32ArrayFrom,"__esModule",{value:!0}),uint32ArrayFrom.uint32ArrayFrom=void 0;function He(Qe){if(!Uint32Array.from){for(var it=new Uint32Array(Qe.length),lt=0;lt<Qe.length;)it[lt]=Qe[lt],lt+=1;return it}return Uint32Array.from(Qe)}return uint32ArrayFrom.uint32ArrayFrom=He,uint32ArrayFrom}var hasRequiredBuild;function requireBuild(){return hasRequiredBuild||(hasRequiredBuild=1,function(He){Object.defineProperty(He,"__esModule",{value:!0}),He.uint32ArrayFrom=He.numToUint8=He.isEmptyData=He.convertToBuffer=void 0;var Qe=requireConvertToBuffer();Object.defineProperty(He,"convertToBuffer",{enumerable:!0,get:function(){return Qe.convertToBuffer}});var it=requireIsEmptyData();Object.defineProperty(He,"isEmptyData",{enumerable:!0,get:function(){return it.isEmptyData}});var lt=requireNumToUint8();Object.defineProperty(He,"numToUint8",{enumerable:!0,get:function(){return lt.numToUint8}});var ut=requireUint32ArrayFrom();Object.defineProperty(He,"uint32ArrayFrom",{enumerable:!0,get:function(){return ut.uint32ArrayFrom}})}(build)),build}var hasRequiredJsSha256;function requireJsSha256(){if(hasRequiredJsSha256)return jsSha256;hasRequiredJsSha256=1,Object.defineProperty(jsSha256,"__esModule",{value:!0}),jsSha256.Sha256=void 0;var He=require$$0$1,Qe=requireConstants(),it=requireRawSha256(),lt=requireBuild(),ut=function(){function xt(ft){this.secret=ft,this.hash=new it.RawSha256,this.reset()}return xt.prototype.update=function(ft){if(!((0,lt.isEmptyData)(ft)||this.error))try{this.hash.update((0,lt.convertToBuffer)(ft))}catch(vt){this.error=vt}},xt.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},xt.prototype.digest=function(){return He.__awaiter(this,void 0,void 0,function(){return He.__generator(this,function(ft){return[2,this.digestSync()]})})},xt.prototype.reset=function(){if(this.hash=new it.RawSha256,this.secret){this.outer=new it.RawSha256;var ft=dt(this.secret),vt=new Uint8Array(Qe.BLOCK_SIZE);vt.set(ft);for(var kt=0;kt<Qe.BLOCK_SIZE;kt++)ft[kt]^=54,vt[kt]^=92;this.hash.update(ft),this.outer.update(vt);for(var kt=0;kt<ft.byteLength;kt++)ft[kt]=0}},xt}();jsSha256.Sha256=ut;function dt(xt){var ft=(0,lt.convertToBuffer)(xt);if(ft.byteLength>Qe.BLOCK_SIZE){var vt=new it.RawSha256;vt.update(ft),ft=vt.digest()}var kt=new Uint8Array(Qe.BLOCK_SIZE);return kt.set(ft),kt}return jsSha256}(function(He){Object.defineProperty(He,"__esModule",{value:!0});var Qe=require$$0$1;Qe.__exportStar(requireJsSha256(),He)})(build$1);function apply(He,...Qe){return(...it)=>He(...Qe,...it)}function initialParams(He){return function(...Qe){var it=Qe.pop();return He.call(this,Qe,it)}}var hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,hasSetImmediate=typeof setImmediate=="function"&&setImmediate,hasNextTick=typeof process$1=="object"&&typeof process$1.nextTick=="function";function fallback(He){setTimeout(He,0)}function wrap(He){return(Qe,...it)=>He(()=>Qe(...it))}var _defer;hasQueueMicrotask?_defer=queueMicrotask:hasSetImmediate?_defer=setImmediate:hasNextTick?_defer=process$1.nextTick:_defer=fallback;var setImmediate$1=wrap(_defer);function asyncify(He){return isAsync(He)?function(...Qe){const it=Qe.pop(),lt=He.apply(this,Qe);return handlePromise(lt,it)}:initialParams(function(Qe,it){var lt;try{lt=He.apply(this,Qe)}catch(ut){return it(ut)}if(lt&&typeof lt.then=="function")return handlePromise(lt,it);it(null,lt)})}function handlePromise(He,Qe){return He.then(it=>{invokeCallback(Qe,null,it)},it=>{invokeCallback(Qe,it&&it.message?it:new Error(it))})}function invokeCallback(He,Qe,it){try{He(Qe,it)}catch(lt){setImmediate$1(ut=>{throw ut},lt)}}function isAsync(He){return He[Symbol.toStringTag]==="AsyncFunction"}function isAsyncGenerator(He){return He[Symbol.toStringTag]==="AsyncGenerator"}function isAsyncIterable(He){return typeof He[Symbol.asyncIterator]=="function"}function wrapAsync(He){if(typeof He!="function")throw new Error("expected a function");return isAsync(He)?asyncify(He):He}function awaitify(He,Qe=He.length){if(!Qe)throw new Error("arity is undefined");function it(...lt){return typeof lt[Qe-1]=="function"?He.apply(this,lt):new Promise((ut,dt)=>{lt[Qe-1]=(xt,...ft)=>{if(xt)return dt(xt);ut(ft.length>1?ft:ft[0])},He.apply(this,lt)})}return it}function applyEach(He){return function(it,...lt){return awaitify(function(dt){var xt=this;return He(it,(ft,vt)=>{wrapAsync(ft).apply(xt,lt.concat(vt))},dt)})}}function _asyncMap(He,Qe,it,lt){Qe=Qe||[];var ut=[],dt=0,xt=wrapAsync(it);return He(Qe,(ft,vt,kt)=>{var St=dt++;xt(ft,(Tt,Mt)=>{ut[St]=Mt,kt(Tt)})},ft=>{lt(ft,ut)})}function isArrayLike(He){return He&&typeof He.length=="number"&&He.length>=0&&He.length%1===0}const breakLoop={};function once(He){function Qe(...it){if(He!==null){var lt=He;He=null,lt.apply(this,it)}}return Object.assign(Qe,He),Qe}function getIterator(He){return He[Symbol.iterator]&&He[Symbol.iterator]()}function createArrayIterator(He){var Qe=-1,it=He.length;return function(){return++Qe<it?{value:He[Qe],key:Qe}:null}}function createES2015Iterator(He){var Qe=-1;return function(){var lt=He.next();return lt.done?null:(Qe++,{value:lt.value,key:Qe})}}function createObjectIterator(He){var Qe=He?Object.keys(He):[],it=-1,lt=Qe.length;return function ut(){var dt=Qe[++it];return dt==="__proto__"?ut():it<lt?{value:He[dt],key:dt}:null}}function createIterator(He){if(isArrayLike(He))return createArrayIterator(He);var Qe=getIterator(He);return Qe?createES2015Iterator(Qe):createObjectIterator(He)}function onlyOnce(He){return function(...Qe){if(He===null)throw new Error("Callback was already called.");var it=He;He=null,it.apply(this,Qe)}}function asyncEachOfLimit(He,Qe,it,lt){let ut=!1,dt=!1,xt=!1,ft=0,vt=0;function kt(){ft>=Qe||xt||ut||(xt=!0,He.next().then(({value:Mt,done:Nt})=>{if(!(dt||ut)){if(xt=!1,Nt){ut=!0,ft<=0&&lt(null);return}ft++,it(Mt,vt,St),vt++,kt()}}).catch(Tt))}function St(Mt,Nt){if(ft-=1,!dt){if(Mt)return Tt(Mt);if(Mt===!1){ut=!0,dt=!0;return}if(Nt===breakLoop||ut&&ft<=0)return ut=!0,lt(null);kt()}}function Tt(Mt){dt||(xt=!1,ut=!0,lt(Mt))}kt()}var eachOfLimit=He=>(Qe,it,lt)=>{if(lt=once(lt),He<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!Qe)return lt(null);if(isAsyncGenerator(Qe))return asyncEachOfLimit(Qe,He,it,lt);if(isAsyncIterable(Qe))return asyncEachOfLimit(Qe[Symbol.asyncIterator](),He,it,lt);var ut=createIterator(Qe),dt=!1,xt=!1,ft=0,vt=!1;function kt(Tt,Mt){if(!xt)if(ft-=1,Tt)dt=!0,lt(Tt);else if(Tt===!1)dt=!0,xt=!0;else{if(Mt===breakLoop||dt&&ft<=0)return dt=!0,lt(null);vt||St()}}function St(){for(vt=!0;ft<He&&!dt;){var Tt=ut();if(Tt===null){dt=!0,ft<=0&&lt(null);return}ft+=1,it(Tt.value,Tt.key,onlyOnce(kt))}vt=!1}St()};function eachOfLimit$1(He,Qe,it,lt){return eachOfLimit(Qe)(He,wrapAsync(it),lt)}var eachOfLimit$2=awaitify(eachOfLimit$1,4);function eachOfArrayLike(He,Qe,it){it=once(it);var lt=0,ut=0,{length:dt}=He,xt=!1;dt===0&&it(null);function ft(vt,kt){vt===!1&&(xt=!0),xt!==!0&&(vt?it(vt):(++ut===dt||kt===breakLoop)&&it(null))}for(;lt<dt;lt++)Qe(He[lt],lt,onlyOnce(ft))}function eachOfGeneric(He,Qe,it){return eachOfLimit$2(He,1/0,Qe,it)}function eachOf(He,Qe,it){var lt=isArrayLike(He)?eachOfArrayLike:eachOfGeneric;return lt(He,wrapAsync(Qe),it)}var eachOf$1=awaitify(eachOf,3);function map(He,Qe,it){return _asyncMap(eachOf$1,He,Qe,it)}var map$1=awaitify(map,3),applyEach$1=applyEach(map$1);function eachOfSeries(He,Qe,it){return eachOfLimit$2(He,1,Qe,it)}var eachOfSeries$1=awaitify(eachOfSeries,3);function mapSeries(He,Qe,it){return _asyncMap(eachOfSeries$1,He,Qe,it)}var mapSeries$1=awaitify(mapSeries,3),applyEachSeries=applyEach(mapSeries$1);const PROMISE_SYMBOL=Symbol("promiseCallback");function promiseCallback(){let He,Qe;function it(lt,...ut){if(lt)return Qe(lt);He(ut.length>1?ut:ut[0])}return it[PROMISE_SYMBOL]=new Promise((lt,ut)=>{He=lt,Qe=ut}),it}function auto(He,Qe,it){typeof Qe!="number"&&(it=Qe,Qe=null),it=once(it||promiseCallback());var lt=Object.keys(He).length;if(!lt)return it(null);Qe||(Qe=lt);var ut={},dt=0,xt=!1,ft=!1,vt=Object.create(null),kt=[],St=[],Tt={};Object.keys(He).forEach(Ot=>{var Qt=He[Ot];if(!Array.isArray(Qt)){Mt(Ot,[Qt]),St.push(Ot);return}var Wt=Qt.slice(0,Qt.length-1),Xt=Wt.length;if(Xt===0){Mt(Ot,Qt),St.push(Ot);return}Tt[Ot]=Xt,Wt.forEach(Kt=>{if(!He[Kt])throw new Error("async.auto task `"+Ot+"` has a non-existent dependency `"+Kt+"` in "+Wt.join(", "));At(Kt,()=>{Xt--,Xt===0&&Mt(Ot,Qt)})})}),Ft(),Nt();function Mt(Ot,Qt){kt.push(()=>Dt(Ot,Qt))}function Nt(){if(!xt){if(kt.length===0&&dt===0)return it(null,ut);for(;kt.length&&dt<Qe;){var Ot=kt.shift();Ot()}}}function At(Ot,Qt){var Wt=vt[Ot];Wt||(Wt=vt[Ot]=[]),Wt.push(Qt)}function $t(Ot){var Qt=vt[Ot]||[];Qt.forEach(Wt=>Wt()),Nt()}function Dt(Ot,Qt){if(!ft){var Wt=onlyOnce((Kt,...Jt)=>{if(dt--,Kt===!1){xt=!0;return}if(Jt.length<2&&([Jt]=Jt),Kt){var hr={};if(Object.keys(ut).forEach(xr=>{hr[xr]=ut[xr]}),hr[Ot]=Jt,ft=!0,vt=Object.create(null),xt)return;it(Kt,hr)}else ut[Ot]=Jt,$t(Ot)});dt++;var Xt=wrapAsync(Qt[Qt.length-1]);Qt.length>1?Xt(ut,Wt):Xt(Wt)}}function Ft(){for(var Ot,Qt=0;St.length;)Ot=St.pop(),Qt++,Bt(Ot).forEach(Wt=>{--Tt[Wt]===0&&St.push(Wt)});if(Qt!==lt)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function Bt(Ot){var Qt=[];return Object.keys(He).forEach(Wt=>{const Xt=He[Wt];Array.isArray(Xt)&&Xt.indexOf(Ot)>=0&&Qt.push(Wt)}),Qt}return it[PROMISE_SYMBOL]}var FN_ARGS=/^(?:async\s+)?(?:function)?\s*\w*\s*\(\s*([^)]+)\s*\)(?:\s*{)/,ARROW_FN_ARGS=/^(?:async\s+)?\(?\s*([^)=]+)\s*\)?(?:\s*=>)/,FN_ARG_SPLIT=/,/,FN_ARG=/(=.+)?(\s*)$/;function stripComments(He){let Qe="",it=0,lt=He.indexOf("*/");for(;it<He.length;)if(He[it]==="/"&&He[it+1]==="/"){let ut=He.indexOf(`
`,it);it=ut===-1?He.length:ut}else if(lt!==-1&&He[it]==="/"&&He[it+1]==="*"){let ut=He.indexOf("*/",it);ut!==-1?(it=ut+2,lt=He.indexOf("*/",it)):(Qe+=He[it],it++)}else Qe+=He[it],it++;return Qe}function parseParams(He){const Qe=stripComments(He.toString());let it=Qe.match(FN_ARGS);if(it||(it=Qe.match(ARROW_FN_ARGS)),!it)throw new Error(`could not parse args in autoInject
Source:
`+Qe);let[,lt]=it;return lt.replace(/\s/g,"").split(FN_ARG_SPLIT).map(ut=>ut.replace(FN_ARG,"").trim())}function autoInject(He,Qe){var it={};return Object.keys(He).forEach(lt=>{var ut=He[lt],dt,xt=isAsync(ut),ft=!xt&&ut.length===1||xt&&ut.length===0;if(Array.isArray(ut))dt=[...ut],ut=dt.pop(),it[lt]=dt.concat(dt.length>0?vt:ut);else if(ft)it[lt]=ut;else{if(dt=parseParams(ut),ut.length===0&&!xt&&dt.length===0)throw new Error("autoInject task functions require explicit parameters.");xt||dt.pop(),it[lt]=dt.concat(vt)}function vt(kt,St){var Tt=dt.map(Mt=>kt[Mt]);Tt.push(St),wrapAsync(ut)(...Tt)}}),auto(it,Qe)}class DLL{constructor(){this.head=this.tail=null,this.length=0}removeLink(Qe){return Qe.prev?Qe.prev.next=Qe.next:this.head=Qe.next,Qe.next?Qe.next.prev=Qe.prev:this.tail=Qe.prev,Qe.prev=Qe.next=null,this.length-=1,Qe}empty(){for(;this.head;)this.shift();return this}insertAfter(Qe,it){it.prev=Qe,it.next=Qe.next,Qe.next?Qe.next.prev=it:this.tail=it,Qe.next=it,this.length+=1}insertBefore(Qe,it){it.prev=Qe.prev,it.next=Qe,Qe.prev?Qe.prev.next=it:this.head=it,Qe.prev=it,this.length+=1}unshift(Qe){this.head?this.insertBefore(this.head,Qe):setInitial(this,Qe)}push(Qe){this.tail?this.insertAfter(this.tail,Qe):setInitial(this,Qe)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var Qe=this.head;Qe;)yield Qe.data,Qe=Qe.next}remove(Qe){for(var it=this.head;it;){var{next:lt}=it;Qe(it)&&this.removeLink(it),it=lt}return this}}function setInitial(He,Qe){He.length=1,He.head=He.tail=Qe}function queue(He,Qe,it){if(Qe==null)Qe=1;else if(Qe===0)throw new RangeError("Concurrency must not be zero");var lt=wrapAsync(He),ut=0,dt=[];const xt={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function ft(Bt,Ot){xt[Bt].push(Ot)}function vt(Bt,Ot){const Qt=(...Wt)=>{kt(Bt,Qt),Ot(...Wt)};xt[Bt].push(Qt)}function kt(Bt,Ot){if(!Bt)return Object.keys(xt).forEach(Qt=>xt[Qt]=[]);if(!Ot)return xt[Bt]=[];xt[Bt]=xt[Bt].filter(Qt=>Qt!==Ot)}function St(Bt,...Ot){xt[Bt].forEach(Qt=>Qt(...Ot))}var Tt=!1;function Mt(Bt,Ot,Qt,Wt){if(Wt!=null&&typeof Wt!="function")throw new Error("task callback must be a function");Ft.started=!0;var Xt,Kt;function Jt(xr,...gr){if(xr)return Qt?Kt(xr):Xt();if(gr.length<=1)return Xt(gr[0]);Xt(gr)}var hr=Ft._createTaskItem(Bt,Qt?Jt:Wt||Jt);if(Ot?Ft._tasks.unshift(hr):Ft._tasks.push(hr),Tt||(Tt=!0,setImmediate$1(()=>{Tt=!1,Ft.process()})),Qt||!Wt)return new Promise((xr,gr)=>{Xt=xr,Kt=gr})}function Nt(Bt){return function(Ot,...Qt){ut-=1;for(var Wt=0,Xt=Bt.length;Wt<Xt;Wt++){var Kt=Bt[Wt],Jt=dt.indexOf(Kt);Jt===0?dt.shift():Jt>0&&dt.splice(Jt,1),Kt.callback(Ot,...Qt),Ot!=null&&St("error",Ot,Kt.data)}ut<=Ft.concurrency-Ft.buffer&&St("unsaturated"),Ft.idle()&&St("drain"),Ft.process()}}function At(Bt){return Bt.length===0&&Ft.idle()?(setImmediate$1(()=>St("drain")),!0):!1}const $t=Bt=>Ot=>{if(!Ot)return new Promise((Qt,Wt)=>{vt(Bt,(Xt,Kt)=>{if(Xt)return Wt(Xt);Qt(Kt)})});kt(Bt),ft(Bt,Ot)};var Dt=!1,Ft={_tasks:new DLL,_createTaskItem(Bt,Ot){return{data:Bt,callback:Ot}},*[Symbol.iterator](){yield*Ft._tasks[Symbol.iterator]()},concurrency:Qe,payload:it,buffer:Qe/4,started:!1,paused:!1,push(Bt,Ot){return Array.isArray(Bt)?At(Bt)?void 0:Bt.map(Qt=>Mt(Qt,!1,!1,Ot)):Mt(Bt,!1,!1,Ot)},pushAsync(Bt,Ot){return Array.isArray(Bt)?At(Bt)?void 0:Bt.map(Qt=>Mt(Qt,!1,!0,Ot)):Mt(Bt,!1,!0,Ot)},kill(){kt(),Ft._tasks.empty()},unshift(Bt,Ot){return Array.isArray(Bt)?At(Bt)?void 0:Bt.map(Qt=>Mt(Qt,!0,!1,Ot)):Mt(Bt,!0,!1,Ot)},unshiftAsync(Bt,Ot){return Array.isArray(Bt)?At(Bt)?void 0:Bt.map(Qt=>Mt(Qt,!0,!0,Ot)):Mt(Bt,!0,!0,Ot)},remove(Bt){Ft._tasks.remove(Bt)},process(){if(!Dt){for(Dt=!0;!Ft.paused&&ut<Ft.concurrency&&Ft._tasks.length;){var Bt=[],Ot=[],Qt=Ft._tasks.length;Ft.payload&&(Qt=Math.min(Qt,Ft.payload));for(var Wt=0;Wt<Qt;Wt++){var Xt=Ft._tasks.shift();Bt.push(Xt),dt.push(Xt),Ot.push(Xt.data)}ut+=1,Ft._tasks.length===0&&St("empty"),ut===Ft.concurrency&&St("saturated");var Kt=onlyOnce(Nt(Bt));lt(Ot,Kt)}Dt=!1}},length(){return Ft._tasks.length},running(){return ut},workersList(){return dt},idle(){return Ft._tasks.length+ut===0},pause(){Ft.paused=!0},resume(){Ft.paused!==!1&&(Ft.paused=!1,setImmediate$1(Ft.process))}};return Object.defineProperties(Ft,{saturated:{writable:!1,value:$t("saturated")},unsaturated:{writable:!1,value:$t("unsaturated")},empty:{writable:!1,value:$t("empty")},drain:{writable:!1,value:$t("drain")},error:{writable:!1,value:$t("error")}}),Ft}function cargo(He,Qe){return queue(He,1,Qe)}function cargo$1(He,Qe,it){return queue(He,Qe,it)}function reduce(He,Qe,it,lt){lt=once(lt);var ut=wrapAsync(it);return eachOfSeries$1(He,(dt,xt,ft)=>{ut(Qe,dt,(vt,kt)=>{Qe=kt,ft(vt)})},dt=>lt(dt,Qe))}var reduce$1=awaitify(reduce,4);function seq(...He){var Qe=He.map(wrapAsync);return function(...it){var lt=this,ut=it[it.length-1];return typeof ut=="function"?it.pop():ut=promiseCallback(),reduce$1(Qe,it,(dt,xt,ft)=>{xt.apply(lt,dt.concat((vt,...kt)=>{ft(vt,kt)}))},(dt,xt)=>ut(dt,...xt)),ut[PROMISE_SYMBOL]}}function compose(...He){return seq(...He.reverse())}function mapLimit(He,Qe,it,lt){return _asyncMap(eachOfLimit(Qe),He,it,lt)}var mapLimit$1=awaitify(mapLimit,4);function concatLimit(He,Qe,it,lt){var ut=wrapAsync(it);return mapLimit$1(He,Qe,(dt,xt)=>{ut(dt,(ft,...vt)=>ft?xt(ft):xt(ft,vt))},(dt,xt)=>{for(var ft=[],vt=0;vt<xt.length;vt++)xt[vt]&&(ft=ft.concat(...xt[vt]));return lt(dt,ft)})}var concatLimit$1=awaitify(concatLimit,4);function concat(He,Qe,it){return concatLimit$1(He,1/0,Qe,it)}var concat$1=awaitify(concat,3);function concatSeries(He,Qe,it){return concatLimit$1(He,1,Qe,it)}var concatSeries$1=awaitify(concatSeries,3);function constant(...He){return function(...Qe){var it=Qe.pop();return it(null,...He)}}function _createTester(He,Qe){return(it,lt,ut,dt)=>{var xt=!1,ft;const vt=wrapAsync(ut);it(lt,(kt,St,Tt)=>{vt(kt,(Mt,Nt)=>{if(Mt||Mt===!1)return Tt(Mt);if(He(Nt)&&!ft)return xt=!0,ft=Qe(!0,kt),Tt(null,breakLoop);Tt()})},kt=>{if(kt)return dt(kt);dt(null,xt?ft:Qe(!1))})}}function detect(He,Qe,it){return _createTester(lt=>lt,(lt,ut)=>ut)(eachOf$1,He,Qe,it)}var detect$1=awaitify(detect,3);function detectLimit(He,Qe,it,lt){return _createTester(ut=>ut,(ut,dt)=>dt)(eachOfLimit(Qe),He,it,lt)}var detectLimit$1=awaitify(detectLimit,4);function detectSeries(He,Qe,it){return _createTester(lt=>lt,(lt,ut)=>ut)(eachOfLimit(1),He,Qe,it)}var detectSeries$1=awaitify(detectSeries,3);function consoleFunc(He){return(Qe,...it)=>wrapAsync(Qe)(...it,(lt,...ut)=>{typeof console=="object"&&(lt?console.error&&console.error(lt):console[He]&&ut.forEach(dt=>console[He](dt)))})}var dir=consoleFunc("dir");function doWhilst(He,Qe,it){it=onlyOnce(it);var lt=wrapAsync(He),ut=wrapAsync(Qe),dt;function xt(vt,...kt){if(vt)return it(vt);vt!==!1&&(dt=kt,ut(...kt,ft))}function ft(vt,kt){if(vt)return it(vt);if(vt!==!1){if(!kt)return it(null,...dt);lt(xt)}}return ft(null,!0)}var doWhilst$1=awaitify(doWhilst,3);function doUntil(He,Qe,it){const lt=wrapAsync(Qe);return doWhilst$1(He,(...ut)=>{const dt=ut.pop();lt(...ut,(xt,ft)=>dt(xt,!ft))},it)}function _withoutIndex(He){return(Qe,it,lt)=>He(Qe,lt)}function eachLimit(He,Qe,it){return eachOf$1(He,_withoutIndex(wrapAsync(Qe)),it)}var each=awaitify(eachLimit,3);function eachLimit$1(He,Qe,it,lt){return eachOfLimit(Qe)(He,_withoutIndex(wrapAsync(it)),lt)}var eachLimit$2=awaitify(eachLimit$1,4);function eachSeries(He,Qe,it){return eachLimit$2(He,1,Qe,it)}var eachSeries$1=awaitify(eachSeries,3);function ensureAsync(He){return isAsync(He)?He:function(...Qe){var it=Qe.pop(),lt=!0;Qe.push((...ut)=>{lt?setImmediate$1(()=>it(...ut)):it(...ut)}),He.apply(this,Qe),lt=!1}}function every(He,Qe,it){return _createTester(lt=>!lt,lt=>!lt)(eachOf$1,He,Qe,it)}var every$1=awaitify(every,3);function everyLimit(He,Qe,it,lt){return _createTester(ut=>!ut,ut=>!ut)(eachOfLimit(Qe),He,it,lt)}var everyLimit$1=awaitify(everyLimit,4);function everySeries(He,Qe,it){return _createTester(lt=>!lt,lt=>!lt)(eachOfSeries$1,He,Qe,it)}var everySeries$1=awaitify(everySeries,3);function filterArray(He,Qe,it,lt){var ut=new Array(Qe.length);He(Qe,(dt,xt,ft)=>{it(dt,(vt,kt)=>{ut[xt]=!!kt,ft(vt)})},dt=>{if(dt)return lt(dt);for(var xt=[],ft=0;ft<Qe.length;ft++)ut[ft]&&xt.push(Qe[ft]);lt(null,xt)})}function filterGeneric(He,Qe,it,lt){var ut=[];He(Qe,(dt,xt,ft)=>{it(dt,(vt,kt)=>{if(vt)return ft(vt);kt&&ut.push({index:xt,value:dt}),ft(vt)})},dt=>{if(dt)return lt(dt);lt(null,ut.sort((xt,ft)=>xt.index-ft.index).map(xt=>xt.value))})}function _filter(He,Qe,it,lt){var ut=isArrayLike(Qe)?filterArray:filterGeneric;return ut(He,Qe,wrapAsync(it),lt)}function filter(He,Qe,it){return _filter(eachOf$1,He,Qe,it)}var filter$1=awaitify(filter,3);function filterLimit(He,Qe,it,lt){return _filter(eachOfLimit(Qe),He,it,lt)}var filterLimit$1=awaitify(filterLimit,4);function filterSeries(He,Qe,it){return _filter(eachOfSeries$1,He,Qe,it)}var filterSeries$1=awaitify(filterSeries,3);function forever(He,Qe){var it=onlyOnce(Qe),lt=wrapAsync(ensureAsync(He));function ut(dt){if(dt)return it(dt);dt!==!1&&lt(ut)}return ut()}var forever$1=awaitify(forever,2);function groupByLimit(He,Qe,it,lt){var ut=wrapAsync(it);return mapLimit$1(He,Qe,(dt,xt)=>{ut(dt,(ft,vt)=>ft?xt(ft):xt(ft,{key:vt,val:dt}))},(dt,xt)=>{for(var ft={},{hasOwnProperty:vt}=Object.prototype,kt=0;kt<xt.length;kt++)if(xt[kt]){var{key:St}=xt[kt],{val:Tt}=xt[kt];vt.call(ft,St)?ft[St].push(Tt):ft[St]=[Tt]}return lt(dt,ft)})}var groupByLimit$1=awaitify(groupByLimit,4);function groupBy(He,Qe,it){return groupByLimit$1(He,1/0,Qe,it)}function groupBySeries(He,Qe,it){return groupByLimit$1(He,1,Qe,it)}var log=consoleFunc("log");function mapValuesLimit(He,Qe,it,lt){lt=once(lt);var ut={},dt=wrapAsync(it);return eachOfLimit(Qe)(He,(xt,ft,vt)=>{dt(xt,ft,(kt,St)=>{if(kt)return vt(kt);ut[ft]=St,vt(kt)})},xt=>lt(xt,ut))}var mapValuesLimit$1=awaitify(mapValuesLimit,4);function mapValues(He,Qe,it){return mapValuesLimit$1(He,1/0,Qe,it)}function mapValuesSeries(He,Qe,it){return mapValuesLimit$1(He,1,Qe,it)}function memoize(He,Qe=it=>it){var it=Object.create(null),lt=Object.create(null),ut=wrapAsync(He),dt=initialParams((xt,ft)=>{var vt=Qe(...xt);vt in it?setImmediate$1(()=>ft(null,...it[vt])):vt in lt?lt[vt].push(ft):(lt[vt]=[ft],ut(...xt,(kt,...St)=>{kt||(it[vt]=St);var Tt=lt[vt];delete lt[vt];for(var Mt=0,Nt=Tt.length;Mt<Nt;Mt++)Tt[Mt](kt,...St)}))});return dt.memo=it,dt.unmemoized=He,dt}var _defer$1;hasNextTick?_defer$1=process$1.nextTick:hasSetImmediate?_defer$1=setImmediate:_defer$1=fallback;var nextTick=wrap(_defer$1),parallel=awaitify((He,Qe,it)=>{var lt=isArrayLike(Qe)?[]:{};He(Qe,(ut,dt,xt)=>{wrapAsync(ut)((ft,...vt)=>{vt.length<2&&([vt]=vt),lt[dt]=vt,xt(ft)})},ut=>it(ut,lt))},3);function parallel$1(He,Qe){return parallel(eachOf$1,He,Qe)}function parallelLimit(He,Qe,it){return parallel(eachOfLimit(Qe),He,it)}function queue$1(He,Qe){var it=wrapAsync(He);return queue((lt,ut)=>{it(lt[0],ut)},Qe,1)}class Heap{constructor(){this.heap=[],this.pushCount=Number.MIN_SAFE_INTEGER}get length(){return this.heap.length}empty(){return this.heap=[],this}percUp(Qe){let it;for(;Qe>0&&smaller(this.heap[Qe],this.heap[it=parent(Qe)]);){let lt=this.heap[Qe];this.heap[Qe]=this.heap[it],this.heap[it]=lt,Qe=it}}percDown(Qe){let it;for(;(it=leftChi(Qe))<this.heap.length&&(it+1<this.heap.length&&smaller(this.heap[it+1],this.heap[it])&&(it=it+1),!smaller(this.heap[Qe],this.heap[it]));){let lt=this.heap[Qe];this.heap[Qe]=this.heap[it],this.heap[it]=lt,Qe=it}}push(Qe){Qe.pushCount=++this.pushCount,this.heap.push(Qe),this.percUp(this.heap.length-1)}unshift(Qe){return this.heap.push(Qe)}shift(){let[Qe]=this.heap;return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.percDown(0),Qe}toArray(){return[...this]}*[Symbol.iterator](){for(let Qe=0;Qe<this.heap.length;Qe++)yield this.heap[Qe].data}remove(Qe){let it=0;for(let lt=0;lt<this.heap.length;lt++)Qe(this.heap[lt])||(this.heap[it]=this.heap[lt],it++);this.heap.splice(it);for(let lt=parent(this.heap.length-1);lt>=0;lt--)this.percDown(lt);return this}}function leftChi(He){return(He<<1)+1}function parent(He){return(He+1>>1)-1}function smaller(He,Qe){return He.priority!==Qe.priority?He.priority<Qe.priority:He.pushCount<Qe.pushCount}function priorityQueue(He,Qe){var it=queue$1(He,Qe),{push:lt,pushAsync:ut}=it;it._tasks=new Heap,it._createTaskItem=({data:xt,priority:ft},vt)=>({data:xt,priority:ft,callback:vt});function dt(xt,ft){return Array.isArray(xt)?xt.map(vt=>({data:vt,priority:ft})):{data:xt,priority:ft}}return it.push=function(xt,ft=0,vt){return lt(dt(xt,ft),vt)},it.pushAsync=function(xt,ft=0,vt){return ut(dt(xt,ft),vt)},delete it.unshift,delete it.unshiftAsync,it}function race(He,Qe){if(Qe=once(Qe),!Array.isArray(He))return Qe(new TypeError("First argument to race must be an array of functions"));if(!He.length)return Qe();for(var it=0,lt=He.length;it<lt;it++)wrapAsync(He[it])(Qe)}var race$1=awaitify(race,2);function reduceRight(He,Qe,it,lt){var ut=[...He].reverse();return reduce$1(ut,Qe,it,lt)}function reflect(He){var Qe=wrapAsync(He);return initialParams(function(lt,ut){return lt.push((dt,...xt)=>{let ft={};if(dt&&(ft.error=dt),xt.length>0){var vt=xt;xt.length<=1&&([vt]=xt),ft.value=vt}ut(null,ft)}),Qe.apply(this,lt)})}function reflectAll(He){var Qe;return Array.isArray(He)?Qe=He.map(reflect):(Qe={},Object.keys(He).forEach(it=>{Qe[it]=reflect.call(this,He[it])})),Qe}function reject(He,Qe,it,lt){const ut=wrapAsync(it);return _filter(He,Qe,(dt,xt)=>{ut(dt,(ft,vt)=>{xt(ft,!vt)})},lt)}function reject$1(He,Qe,it){return reject(eachOf$1,He,Qe,it)}var reject$2=awaitify(reject$1,3);function rejectLimit(He,Qe,it,lt){return reject(eachOfLimit(Qe),He,it,lt)}var rejectLimit$1=awaitify(rejectLimit,4);function rejectSeries(He,Qe,it){return reject(eachOfSeries$1,He,Qe,it)}var rejectSeries$1=awaitify(rejectSeries,3);function constant$1(He){return function(){return He}}const DEFAULT_TIMES=5,DEFAULT_INTERVAL=0;function retry(He,Qe,it){var lt={times:DEFAULT_TIMES,intervalFunc:constant$1(DEFAULT_INTERVAL)};if(arguments.length<3&&typeof He=="function"?(it=Qe||promiseCallback(),Qe=He):(parseTimes(lt,He),it=it||promiseCallback()),typeof Qe!="function")throw new Error("Invalid arguments for async.retry");var ut=wrapAsync(Qe),dt=1;function xt(){ut((ft,...vt)=>{ft!==!1&&(ft&&dt++<lt.times&&(typeof lt.errorFilter!="function"||lt.errorFilter(ft))?setTimeout(xt,lt.intervalFunc(dt-1)):it(ft,...vt))})}return xt(),it[PROMISE_SYMBOL]}function parseTimes(He,Qe){if(typeof Qe=="object")He.times=+Qe.times||DEFAULT_TIMES,He.intervalFunc=typeof Qe.interval=="function"?Qe.interval:constant$1(+Qe.interval||DEFAULT_INTERVAL),He.errorFilter=Qe.errorFilter;else if(typeof Qe=="number"||typeof Qe=="string")He.times=+Qe||DEFAULT_TIMES;else throw new Error("Invalid arguments for async.retry")}function retryable(He,Qe){Qe||(Qe=He,He=null);let it=He&&He.arity||Qe.length;isAsync(Qe)&&(it+=1);var lt=wrapAsync(Qe);return initialParams((ut,dt)=>{(ut.length<it-1||dt==null)&&(ut.push(dt),dt=promiseCallback());function xt(ft){lt(...ut,ft)}return He?retry(He,xt,dt):retry(xt,dt),dt[PROMISE_SYMBOL]})}function series(He,Qe){return parallel(eachOfSeries$1,He,Qe)}function some(He,Qe,it){return _createTester(Boolean,lt=>lt)(eachOf$1,He,Qe,it)}var some$1=awaitify(some,3);function someLimit(He,Qe,it,lt){return _createTester(Boolean,ut=>ut)(eachOfLimit(Qe),He,it,lt)}var someLimit$1=awaitify(someLimit,4);function someSeries(He,Qe,it){return _createTester(Boolean,lt=>lt)(eachOfSeries$1,He,Qe,it)}var someSeries$1=awaitify(someSeries,3);function sortBy(He,Qe,it){var lt=wrapAsync(Qe);return map$1(He,(dt,xt)=>{lt(dt,(ft,vt)=>{if(ft)return xt(ft);xt(ft,{value:dt,criteria:vt})})},(dt,xt)=>{if(dt)return it(dt);it(null,xt.sort(ut).map(ft=>ft.value))});function ut(dt,xt){var ft=dt.criteria,vt=xt.criteria;return ft<vt?-1:ft>vt?1:0}}var sortBy$1=awaitify(sortBy,3);function timeout(He,Qe,it){var lt=wrapAsync(He);return initialParams((ut,dt)=>{var xt=!1,ft;function vt(){var kt=He.name||"anonymous",St=new Error('Callback function "'+kt+'" timed out.');St.code="ETIMEDOUT",it&&(St.info=it),xt=!0,dt(St)}ut.push((...kt)=>{xt||(dt(...kt),clearTimeout(ft))}),ft=setTimeout(vt,Qe),lt(...ut)})}function range(He){for(var Qe=Array(He);He--;)Qe[He]=He;return Qe}function timesLimit(He,Qe,it,lt){var ut=wrapAsync(it);return mapLimit$1(range(He),Qe,ut,lt)}function times(He,Qe,it){return timesLimit(He,1/0,Qe,it)}function timesSeries(He,Qe,it){return timesLimit(He,1,Qe,it)}function transform(He,Qe,it,lt){arguments.length<=3&&typeof Qe=="function"&&(lt=it,it=Qe,Qe=Array.isArray(He)?[]:{}),lt=once(lt||promiseCallback());var ut=wrapAsync(it);return eachOf$1(He,(dt,xt,ft)=>{ut(Qe,dt,xt,ft)},dt=>lt(dt,Qe)),lt[PROMISE_SYMBOL]}function tryEach(He,Qe){var it=null,lt;return eachSeries$1(He,(ut,dt)=>{wrapAsync(ut)((xt,...ft)=>{if(xt===!1)return dt(xt);ft.length<2?[lt]=ft:lt=ft,it=xt,dt(xt?null:{})})},()=>Qe(it,lt))}var tryEach$1=awaitify(tryEach);function unmemoize(He){return(...Qe)=>(He.unmemoized||He)(...Qe)}function whilst(He,Qe,it){it=onlyOnce(it);var lt=wrapAsync(Qe),ut=wrapAsync(He),dt=[];function xt(vt,...kt){if(vt)return it(vt);dt=kt,vt!==!1&&ut(ft)}function ft(vt,kt){if(vt)return it(vt);if(vt!==!1){if(!kt)return it(null,...dt);lt(xt)}}return ut(ft)}var whilst$1=awaitify(whilst,3);function until(He,Qe,it){const lt=wrapAsync(He);return whilst$1(ut=>lt((dt,xt)=>ut(dt,!xt)),Qe,it)}function waterfall(He,Qe){if(Qe=once(Qe),!Array.isArray(He))return Qe(new Error("First argument to waterfall must be an array of functions"));if(!He.length)return Qe();var it=0;function lt(dt){var xt=wrapAsync(He[it++]);xt(...dt,onlyOnce(ut))}function ut(dt,...xt){if(dt!==!1){if(dt||it===He.length)return Qe(dt,...xt);lt(xt)}}lt([])}var waterfall$1=awaitify(waterfall),index={apply,applyEach:applyEach$1,applyEachSeries,asyncify,auto,autoInject,cargo,cargoQueue:cargo$1,compose,concat:concat$1,concatLimit:concatLimit$1,concatSeries:concatSeries$1,constant,detect:detect$1,detectLimit:detectLimit$1,detectSeries:detectSeries$1,dir,doUntil,doWhilst:doWhilst$1,each,eachLimit:eachLimit$2,eachOf:eachOf$1,eachOfLimit:eachOfLimit$2,eachOfSeries:eachOfSeries$1,eachSeries:eachSeries$1,ensureAsync,every:every$1,everyLimit:everyLimit$1,everySeries:everySeries$1,filter:filter$1,filterLimit:filterLimit$1,filterSeries:filterSeries$1,forever:forever$1,groupBy,groupByLimit:groupByLimit$1,groupBySeries,log,map:map$1,mapLimit:mapLimit$1,mapSeries:mapSeries$1,mapValues,mapValuesLimit:mapValuesLimit$1,mapValuesSeries,memoize,nextTick,parallel:parallel$1,parallelLimit,priorityQueue,queue:queue$1,race:race$1,reduce:reduce$1,reduceRight,reflect,reflectAll,reject:reject$2,rejectLimit:rejectLimit$1,rejectSeries:rejectSeries$1,retry,retryable,seq,series,setImmediate:setImmediate$1,some:some$1,someLimit:someLimit$1,someSeries:someSeries$1,sortBy:sortBy$1,timeout,times,timesLimit,timesSeries,transform,tryEach:tryEach$1,unmemoize,until,waterfall:waterfall$1,whilst:whilst$1,all:every$1,allLimit:everyLimit$1,allSeries:everySeries$1,any:some$1,anyLimit:someLimit$1,anySeries:someSeries$1,find:detect$1,findLimit:detectLimit$1,findSeries:detectSeries$1,flatMap:concat$1,flatMapLimit:concatLimit$1,flatMapSeries:concatSeries$1,forEach:each,forEachSeries:eachSeries$1,forEachLimit:eachLimit$2,forEachOf:eachOf$1,forEachOfSeries:eachOfSeries$1,forEachOfLimit:eachOfLimit$2,inject:reduce$1,foldl:reduce$1,foldr:reduceRight,select:filter$1,selectLimit:filterLimit$1,selectSeries:filterSeries$1,wrapSync:asyncify,during:whilst$1,doDuring:doWhilst$1};const SymbolPolyfill=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:He=>`Symbol(${He})`;function noop(){}function getGlobals(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}const globals=getGlobals();function typeIsObject(He){return typeof He=="object"&&He!==null||typeof He=="function"}const rethrowAssertionErrorRejection=noop,originalPromise=Promise,originalPromiseThen=Promise.prototype.then,originalPromiseResolve=Promise.resolve.bind(originalPromise),originalPromiseReject=Promise.reject.bind(originalPromise);function newPromise(He){return new originalPromise(He)}function promiseResolvedWith(He){return originalPromiseResolve(He)}function promiseRejectedWith(He){return originalPromiseReject(He)}function PerformPromiseThen(He,Qe,it){return originalPromiseThen.call(He,Qe,it)}function uponPromise(He,Qe,it){PerformPromiseThen(PerformPromiseThen(He,Qe,it),void 0,rethrowAssertionErrorRejection)}function uponFulfillment(He,Qe){uponPromise(He,Qe)}function uponRejection(He,Qe){uponPromise(He,void 0,Qe)}function transformPromiseWith(He,Qe,it){return PerformPromiseThen(He,Qe,it)}function setPromiseIsHandledToTrue(He){PerformPromiseThen(He,void 0,rethrowAssertionErrorRejection)}const queueMicrotask$1=(()=>{const He=globals&&globals.queueMicrotask;if(typeof He=="function")return He;const Qe=promiseResolvedWith(void 0);return it=>PerformPromiseThen(Qe,it)})();function reflectCall(He,Qe,it){if(typeof He!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(He,Qe,it)}function promiseCall(He,Qe,it){try{return promiseResolvedWith(reflectCall(He,Qe,it))}catch(lt){return promiseRejectedWith(lt)}}const QUEUE_MAX_ARRAY_SIZE=16384;class SimpleQueue{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(Qe){const it=this._back;let lt=it;it._elements.length===QUEUE_MAX_ARRAY_SIZE-1&&(lt={_elements:[],_next:void 0}),it._elements.push(Qe),lt!==it&&(this._back=lt,it._next=lt),++this._size}shift(){const Qe=this._front;let it=Qe;const lt=this._cursor;let ut=lt+1;const dt=Qe._elements,xt=dt[lt];return ut===QUEUE_MAX_ARRAY_SIZE&&(it=Qe._next,ut=0),--this._size,this._cursor=ut,Qe!==it&&(this._front=it),dt[lt]=void 0,xt}forEach(Qe){let it=this._cursor,lt=this._front,ut=lt._elements;for(;(it!==ut.length||lt._next!==void 0)&&!(it===ut.length&&(lt=lt._next,ut=lt._elements,it=0,ut.length===0));)Qe(ut[it]),++it}peek(){const Qe=this._front,it=this._cursor;return Qe._elements[it]}}function ReadableStreamReaderGenericInitialize(He,Qe){He._ownerReadableStream=Qe,Qe._reader=He,Qe._state==="readable"?defaultReaderClosedPromiseInitialize(He):Qe._state==="closed"?defaultReaderClosedPromiseInitializeAsResolved(He):defaultReaderClosedPromiseInitializeAsRejected(He,Qe._storedError)}function ReadableStreamReaderGenericCancel(He,Qe){const it=He._ownerReadableStream;return ReadableStreamCancel(it,Qe)}function ReadableStreamReaderGenericRelease(He){He._ownerReadableStream._state==="readable"?defaultReaderClosedPromiseReject(He,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):defaultReaderClosedPromiseResetToRejected(He,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),He._ownerReadableStream._reader=void 0,He._ownerReadableStream=void 0}function readerLockException(He){return new TypeError("Cannot "+He+" a stream using a released reader")}function defaultReaderClosedPromiseInitialize(He){He._closedPromise=newPromise((Qe,it)=>{He._closedPromise_resolve=Qe,He._closedPromise_reject=it})}function defaultReaderClosedPromiseInitializeAsRejected(He,Qe){defaultReaderClosedPromiseInitialize(He),defaultReaderClosedPromiseReject(He,Qe)}function defaultReaderClosedPromiseInitializeAsResolved(He){defaultReaderClosedPromiseInitialize(He),defaultReaderClosedPromiseResolve(He)}function defaultReaderClosedPromiseReject(He,Qe){He._closedPromise_reject!==void 0&&(setPromiseIsHandledToTrue(He._closedPromise),He._closedPromise_reject(Qe),He._closedPromise_resolve=void 0,He._closedPromise_reject=void 0)}function defaultReaderClosedPromiseResetToRejected(He,Qe){defaultReaderClosedPromiseInitializeAsRejected(He,Qe)}function defaultReaderClosedPromiseResolve(He){He._closedPromise_resolve!==void 0&&(He._closedPromise_resolve(void 0),He._closedPromise_resolve=void 0,He._closedPromise_reject=void 0)}const AbortSteps=SymbolPolyfill("[[AbortSteps]]"),ErrorSteps=SymbolPolyfill("[[ErrorSteps]]"),CancelSteps=SymbolPolyfill("[[CancelSteps]]"),PullSteps=SymbolPolyfill("[[PullSteps]]"),NumberIsFinite=Number.isFinite||function(He){return typeof He=="number"&&isFinite(He)},MathTrunc=Math.trunc||function(He){return He<0?Math.ceil(He):Math.floor(He)};function isDictionary(He){return typeof He=="object"||typeof He=="function"}function assertDictionary(He,Qe){if(He!==void 0&&!isDictionary(He))throw new TypeError(`${Qe} is not an object.`)}function assertFunction(He,Qe){if(typeof He!="function")throw new TypeError(`${Qe} is not a function.`)}function isObject(He){return typeof He=="object"&&He!==null||typeof He=="function"}function assertObject(He,Qe){if(!isObject(He))throw new TypeError(`${Qe} is not an object.`)}function assertRequiredArgument(He,Qe,it){if(He===void 0)throw new TypeError(`Parameter ${Qe} is required in '${it}'.`)}function assertRequiredField(He,Qe,it){if(He===void 0)throw new TypeError(`${Qe} is required in '${it}'.`)}function convertUnrestrictedDouble(He){return Number(He)}function censorNegativeZero(He){return He===0?0:He}function integerPart(He){return censorNegativeZero(MathTrunc(He))}function convertUnsignedLongLongWithEnforceRange(He,Qe){const lt=Number.MAX_SAFE_INTEGER;let ut=Number(He);if(ut=censorNegativeZero(ut),!NumberIsFinite(ut))throw new TypeError(`${Qe} is not a finite number`);if(ut=integerPart(ut),ut<0||ut>lt)throw new TypeError(`${Qe} is outside the accepted range of 0 to ${lt}, inclusive`);return!NumberIsFinite(ut)||ut===0?0:ut}function assertReadableStream(He,Qe){if(!IsReadableStream(He))throw new TypeError(`${Qe} is not a ReadableStream.`)}function AcquireReadableStreamDefaultReader(He){return new ReadableStreamDefaultReader(He)}function ReadableStreamAddReadRequest(He,Qe){He._reader._readRequests.push(Qe)}function ReadableStreamFulfillReadRequest(He,Qe,it){const ut=He._reader._readRequests.shift();it?ut._closeSteps():ut._chunkSteps(Qe)}function ReadableStreamGetNumReadRequests(He){return He._reader._readRequests.length}function ReadableStreamHasDefaultReader(He){const Qe=He._reader;return!(Qe===void 0||!IsReadableStreamDefaultReader(Qe))}class ReadableStreamDefaultReader{constructor(Qe){if(assertRequiredArgument(Qe,1,"ReadableStreamDefaultReader"),assertReadableStream(Qe,"First parameter"),IsReadableStreamLocked(Qe))throw new TypeError("This stream has already been locked for exclusive reading by another reader");ReadableStreamReaderGenericInitialize(this,Qe),this._readRequests=new SimpleQueue}get closed(){return IsReadableStreamDefaultReader(this)?this._closedPromise:promiseRejectedWith(defaultReaderBrandCheckException("closed"))}cancel(Qe=void 0){return IsReadableStreamDefaultReader(this)?this._ownerReadableStream===void 0?promiseRejectedWith(readerLockException("cancel")):ReadableStreamReaderGenericCancel(this,Qe):promiseRejectedWith(defaultReaderBrandCheckException("cancel"))}read(){if(!IsReadableStreamDefaultReader(this))return promiseRejectedWith(defaultReaderBrandCheckException("read"));if(this._ownerReadableStream===void 0)return promiseRejectedWith(readerLockException("read from"));let Qe,it;const lt=newPromise((dt,xt)=>{Qe=dt,it=xt});return ReadableStreamDefaultReaderRead(this,{_chunkSteps:dt=>Qe({value:dt,done:!1}),_closeSteps:()=>Qe({value:void 0,done:!0}),_errorSteps:dt=>it(dt)}),lt}releaseLock(){if(!IsReadableStreamDefaultReader(this))throw defaultReaderBrandCheckException("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ReadableStreamReaderGenericRelease(this)}}}Object.defineProperties(ReadableStreamDefaultReader.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(ReadableStreamDefaultReader.prototype,SymbolPolyfill.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function IsReadableStreamDefaultReader(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_readRequests")?!1:He instanceof ReadableStreamDefaultReader}function ReadableStreamDefaultReaderRead(He,Qe){const it=He._ownerReadableStream;it._disturbed=!0,it._state==="closed"?Qe._closeSteps():it._state==="errored"?Qe._errorSteps(it._storedError):it._readableStreamController[PullSteps](Qe)}function defaultReaderBrandCheckException(He){return new TypeError(`ReadableStreamDefaultReader.prototype.${He} can only be used on a ReadableStreamDefaultReader`)}const AsyncIteratorPrototype=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class ReadableStreamAsyncIteratorImpl{constructor(Qe,it){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=Qe,this._preventCancel=it}next(){const Qe=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?transformPromiseWith(this._ongoingPromise,Qe,Qe):Qe(),this._ongoingPromise}return(Qe){const it=()=>this._returnSteps(Qe);return this._ongoingPromise?transformPromiseWith(this._ongoingPromise,it,it):it()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});const Qe=this._reader;if(Qe._ownerReadableStream===void 0)return promiseRejectedWith(readerLockException("iterate"));let it,lt;const ut=newPromise((xt,ft)=>{it=xt,lt=ft});return ReadableStreamDefaultReaderRead(Qe,{_chunkSteps:xt=>{this._ongoingPromise=void 0,queueMicrotask$1(()=>it({value:xt,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,ReadableStreamReaderGenericRelease(Qe),it({value:void 0,done:!0})},_errorSteps:xt=>{this._ongoingPromise=void 0,this._isFinished=!0,ReadableStreamReaderGenericRelease(Qe),lt(xt)}}),ut}_returnSteps(Qe){if(this._isFinished)return Promise.resolve({value:Qe,done:!0});this._isFinished=!0;const it=this._reader;if(it._ownerReadableStream===void 0)return promiseRejectedWith(readerLockException("finish iterating"));if(!this._preventCancel){const lt=ReadableStreamReaderGenericCancel(it,Qe);return ReadableStreamReaderGenericRelease(it),transformPromiseWith(lt,()=>({value:Qe,done:!0}))}return ReadableStreamReaderGenericRelease(it),promiseResolvedWith({value:Qe,done:!0})}}const ReadableStreamAsyncIteratorPrototype={next(){return IsReadableStreamAsyncIterator(this)?this._asyncIteratorImpl.next():promiseRejectedWith(streamAsyncIteratorBrandCheckException("next"))},return(He){return IsReadableStreamAsyncIterator(this)?this._asyncIteratorImpl.return(He):promiseRejectedWith(streamAsyncIteratorBrandCheckException("return"))}};AsyncIteratorPrototype!==void 0&&Object.setPrototypeOf(ReadableStreamAsyncIteratorPrototype,AsyncIteratorPrototype);function AcquireReadableStreamAsyncIterator(He,Qe){const it=AcquireReadableStreamDefaultReader(He),lt=new ReadableStreamAsyncIteratorImpl(it,Qe),ut=Object.create(ReadableStreamAsyncIteratorPrototype);return ut._asyncIteratorImpl=lt,ut}function IsReadableStreamAsyncIterator(He){if(!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_asyncIteratorImpl"))return!1;try{return He._asyncIteratorImpl instanceof ReadableStreamAsyncIteratorImpl}catch{return!1}}function streamAsyncIteratorBrandCheckException(He){return new TypeError(`ReadableStreamAsyncIterator.${He} can only be used on a ReadableSteamAsyncIterator`)}const NumberIsNaN=Number.isNaN||function(He){return He!==He};function CreateArrayFromList(He){return He.slice()}function CopyDataBlockBytes(He,Qe,it,lt,ut){new Uint8Array(He).set(new Uint8Array(it,lt,ut),Qe)}function TransferArrayBuffer(He){return He}function IsDetachedBuffer(He){return!1}function ArrayBufferSlice(He,Qe,it){if(He.slice)return He.slice(Qe,it);const lt=it-Qe,ut=new ArrayBuffer(lt);return CopyDataBlockBytes(ut,0,He,Qe,lt),ut}function IsNonNegativeNumber(He){return!(typeof He!="number"||NumberIsNaN(He)||He<0)}function CloneAsUint8Array(He){const Qe=ArrayBufferSlice(He.buffer,He.byteOffset,He.byteOffset+He.byteLength);return new Uint8Array(Qe)}function DequeueValue(He){const Qe=He._queue.shift();return He._queueTotalSize-=Qe.size,He._queueTotalSize<0&&(He._queueTotalSize=0),Qe.value}function EnqueueValueWithSize(He,Qe,it){if(!IsNonNegativeNumber(it)||it===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");He._queue.push({value:Qe,size:it}),He._queueTotalSize+=it}function PeekQueueValue(He){return He._queue.peek().value}function ResetQueue(He){He._queue=new SimpleQueue,He._queueTotalSize=0}class ReadableStreamBYOBRequest{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!IsReadableStreamBYOBRequest(this))throw byobRequestBrandCheckException("view");return this._view}respond(Qe){if(!IsReadableStreamBYOBRequest(this))throw byobRequestBrandCheckException("respond");if(assertRequiredArgument(Qe,1,"respond"),Qe=convertUnsignedLongLongWithEnforceRange(Qe,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");IsDetachedBuffer(this._view.buffer),ReadableByteStreamControllerRespond(this._associatedReadableByteStreamController,Qe)}respondWithNewView(Qe){if(!IsReadableStreamBYOBRequest(this))throw byobRequestBrandCheckException("respondWithNewView");if(assertRequiredArgument(Qe,1,"respondWithNewView"),!ArrayBuffer.isView(Qe))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");IsDetachedBuffer(Qe.buffer),ReadableByteStreamControllerRespondWithNewView(this._associatedReadableByteStreamController,Qe)}}Object.defineProperties(ReadableStreamBYOBRequest.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(ReadableStreamBYOBRequest.prototype,SymbolPolyfill.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class ReadableByteStreamController{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("byobRequest");return ReadableByteStreamControllerGetBYOBRequest(this)}get desiredSize(){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("desiredSize");return ReadableByteStreamControllerGetDesiredSize(this)}close(){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");const Qe=this._controlledReadableByteStream._state;if(Qe!=="readable")throw new TypeError(`The stream (in ${Qe} state) is not in the readable state and cannot be closed`);ReadableByteStreamControllerClose(this)}enqueue(Qe){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("enqueue");if(assertRequiredArgument(Qe,1,"enqueue"),!ArrayBuffer.isView(Qe))throw new TypeError("chunk must be an array buffer view");if(Qe.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(Qe.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");const it=this._controlledReadableByteStream._state;if(it!=="readable")throw new TypeError(`The stream (in ${it} state) is not in the readable state and cannot be enqueued to`);ReadableByteStreamControllerEnqueue(this,Qe)}error(Qe=void 0){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("error");ReadableByteStreamControllerError(this,Qe)}[CancelSteps](Qe){ReadableByteStreamControllerClearPendingPullIntos(this),ResetQueue(this);const it=this._cancelAlgorithm(Qe);return ReadableByteStreamControllerClearAlgorithms(this),it}[PullSteps](Qe){const it=this._controlledReadableByteStream;if(this._queueTotalSize>0){const ut=this._queue.shift();this._queueTotalSize-=ut.byteLength,ReadableByteStreamControllerHandleQueueDrain(this);const dt=new Uint8Array(ut.buffer,ut.byteOffset,ut.byteLength);Qe._chunkSteps(dt);return}const lt=this._autoAllocateChunkSize;if(lt!==void 0){let ut;try{ut=new ArrayBuffer(lt)}catch(xt){Qe._errorSteps(xt);return}const dt={buffer:ut,bufferByteLength:lt,byteOffset:0,byteLength:lt,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(dt)}ReadableStreamAddReadRequest(it,Qe),ReadableByteStreamControllerCallPullIfNeeded(this)}}Object.defineProperties(ReadableByteStreamController.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(ReadableByteStreamController.prototype,SymbolPolyfill.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function IsReadableByteStreamController(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_controlledReadableByteStream")?!1:He instanceof ReadableByteStreamController}function IsReadableStreamBYOBRequest(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_associatedReadableByteStreamController")?!1:He instanceof ReadableStreamBYOBRequest}function ReadableByteStreamControllerCallPullIfNeeded(He){if(!ReadableByteStreamControllerShouldCallPull(He))return;if(He._pulling){He._pullAgain=!0;return}He._pulling=!0;const it=He._pullAlgorithm();uponPromise(it,()=>{He._pulling=!1,He._pullAgain&&(He._pullAgain=!1,ReadableByteStreamControllerCallPullIfNeeded(He))},lt=>{ReadableByteStreamControllerError(He,lt)})}function ReadableByteStreamControllerClearPendingPullIntos(He){ReadableByteStreamControllerInvalidateBYOBRequest(He),He._pendingPullIntos=new SimpleQueue}function ReadableByteStreamControllerCommitPullIntoDescriptor(He,Qe){let it=!1;He._state==="closed"&&(it=!0);const lt=ReadableByteStreamControllerConvertPullIntoDescriptor(Qe);Qe.readerType==="default"?ReadableStreamFulfillReadRequest(He,lt,it):ReadableStreamFulfillReadIntoRequest(He,lt,it)}function ReadableByteStreamControllerConvertPullIntoDescriptor(He){const Qe=He.bytesFilled,it=He.elementSize;return new He.viewConstructor(He.buffer,He.byteOffset,Qe/it)}function ReadableByteStreamControllerEnqueueChunkToQueue(He,Qe,it,lt){He._queue.push({buffer:Qe,byteOffset:it,byteLength:lt}),He._queueTotalSize+=lt}function ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(He,Qe){const it=Qe.elementSize,lt=Qe.bytesFilled-Qe.bytesFilled%it,ut=Math.min(He._queueTotalSize,Qe.byteLength-Qe.bytesFilled),dt=Qe.bytesFilled+ut,xt=dt-dt%it;let ft=ut,vt=!1;xt>lt&&(ft=xt-Qe.bytesFilled,vt=!0);const kt=He._queue;for(;ft>0;){const St=kt.peek(),Tt=Math.min(ft,St.byteLength),Mt=Qe.byteOffset+Qe.bytesFilled;CopyDataBlockBytes(Qe.buffer,Mt,St.buffer,St.byteOffset,Tt),St.byteLength===Tt?kt.shift():(St.byteOffset+=Tt,St.byteLength-=Tt),He._queueTotalSize-=Tt,ReadableByteStreamControllerFillHeadPullIntoDescriptor(He,Tt,Qe),ft-=Tt}return vt}function ReadableByteStreamControllerFillHeadPullIntoDescriptor(He,Qe,it){it.bytesFilled+=Qe}function ReadableByteStreamControllerHandleQueueDrain(He){He._queueTotalSize===0&&He._closeRequested?(ReadableByteStreamControllerClearAlgorithms(He),ReadableStreamClose(He._controlledReadableByteStream)):ReadableByteStreamControllerCallPullIfNeeded(He)}function ReadableByteStreamControllerInvalidateBYOBRequest(He){He._byobRequest!==null&&(He._byobRequest._associatedReadableByteStreamController=void 0,He._byobRequest._view=null,He._byobRequest=null)}function ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(He){for(;He._pendingPullIntos.length>0;){if(He._queueTotalSize===0)return;const Qe=He._pendingPullIntos.peek();ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(He,Qe)&&(ReadableByteStreamControllerShiftPendingPullInto(He),ReadableByteStreamControllerCommitPullIntoDescriptor(He._controlledReadableByteStream,Qe))}}function ReadableByteStreamControllerPullInto(He,Qe,it){const lt=He._controlledReadableByteStream;let ut=1;Qe.constructor!==DataView&&(ut=Qe.constructor.BYTES_PER_ELEMENT);const dt=Qe.constructor,xt=Qe.buffer,ft={buffer:xt,bufferByteLength:xt.byteLength,byteOffset:Qe.byteOffset,byteLength:Qe.byteLength,bytesFilled:0,elementSize:ut,viewConstructor:dt,readerType:"byob"};if(He._pendingPullIntos.length>0){He._pendingPullIntos.push(ft),ReadableStreamAddReadIntoRequest(lt,it);return}if(lt._state==="closed"){const vt=new dt(ft.buffer,ft.byteOffset,0);it._closeSteps(vt);return}if(He._queueTotalSize>0){if(ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(He,ft)){const vt=ReadableByteStreamControllerConvertPullIntoDescriptor(ft);ReadableByteStreamControllerHandleQueueDrain(He),it._chunkSteps(vt);return}if(He._closeRequested){const vt=new TypeError("Insufficient bytes to fill elements in the given buffer");ReadableByteStreamControllerError(He,vt),it._errorSteps(vt);return}}He._pendingPullIntos.push(ft),ReadableStreamAddReadIntoRequest(lt,it),ReadableByteStreamControllerCallPullIfNeeded(He)}function ReadableByteStreamControllerRespondInClosedState(He,Qe){const it=He._controlledReadableByteStream;if(ReadableStreamHasBYOBReader(it))for(;ReadableStreamGetNumReadIntoRequests(it)>0;){const lt=ReadableByteStreamControllerShiftPendingPullInto(He);ReadableByteStreamControllerCommitPullIntoDescriptor(it,lt)}}function ReadableByteStreamControllerRespondInReadableState(He,Qe,it){if(ReadableByteStreamControllerFillHeadPullIntoDescriptor(He,Qe,it),it.bytesFilled<it.elementSize)return;ReadableByteStreamControllerShiftPendingPullInto(He);const lt=it.bytesFilled%it.elementSize;if(lt>0){const ut=it.byteOffset+it.bytesFilled,dt=ArrayBufferSlice(it.buffer,ut-lt,ut);ReadableByteStreamControllerEnqueueChunkToQueue(He,dt,0,dt.byteLength)}it.bytesFilled-=lt,ReadableByteStreamControllerCommitPullIntoDescriptor(He._controlledReadableByteStream,it),ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(He)}function ReadableByteStreamControllerRespondInternal(He,Qe){const it=He._pendingPullIntos.peek();ReadableByteStreamControllerInvalidateBYOBRequest(He),He._controlledReadableByteStream._state==="closed"?ReadableByteStreamControllerRespondInClosedState(He):ReadableByteStreamControllerRespondInReadableState(He,Qe,it),ReadableByteStreamControllerCallPullIfNeeded(He)}function ReadableByteStreamControllerShiftPendingPullInto(He){return He._pendingPullIntos.shift()}function ReadableByteStreamControllerShouldCallPull(He){const Qe=He._controlledReadableByteStream;return Qe._state!=="readable"||He._closeRequested||!He._started?!1:!!(ReadableStreamHasDefaultReader(Qe)&&ReadableStreamGetNumReadRequests(Qe)>0||ReadableStreamHasBYOBReader(Qe)&&ReadableStreamGetNumReadIntoRequests(Qe)>0||ReadableByteStreamControllerGetDesiredSize(He)>0)}function ReadableByteStreamControllerClearAlgorithms(He){He._pullAlgorithm=void 0,He._cancelAlgorithm=void 0}function ReadableByteStreamControllerClose(He){const Qe=He._controlledReadableByteStream;if(!(He._closeRequested||Qe._state!=="readable")){if(He._queueTotalSize>0){He._closeRequested=!0;return}if(He._pendingPullIntos.length>0&&He._pendingPullIntos.peek().bytesFilled>0){const lt=new TypeError("Insufficient bytes to fill elements in the given buffer");throw ReadableByteStreamControllerError(He,lt),lt}ReadableByteStreamControllerClearAlgorithms(He),ReadableStreamClose(Qe)}}function ReadableByteStreamControllerEnqueue(He,Qe){const it=He._controlledReadableByteStream;if(He._closeRequested||it._state!=="readable")return;const lt=Qe.buffer,ut=Qe.byteOffset,dt=Qe.byteLength,xt=lt;if(He._pendingPullIntos.length>0){const ft=He._pendingPullIntos.peek();IsDetachedBuffer(ft.buffer),ft.buffer=ft.buffer}if(ReadableByteStreamControllerInvalidateBYOBRequest(He),ReadableStreamHasDefaultReader(it))if(ReadableStreamGetNumReadRequests(it)===0)ReadableByteStreamControllerEnqueueChunkToQueue(He,xt,ut,dt);else{He._pendingPullIntos.length>0&&ReadableByteStreamControllerShiftPendingPullInto(He);const ft=new Uint8Array(xt,ut,dt);ReadableStreamFulfillReadRequest(it,ft,!1)}else ReadableStreamHasBYOBReader(it)?(ReadableByteStreamControllerEnqueueChunkToQueue(He,xt,ut,dt),ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(He)):ReadableByteStreamControllerEnqueueChunkToQueue(He,xt,ut,dt);ReadableByteStreamControllerCallPullIfNeeded(He)}function ReadableByteStreamControllerError(He,Qe){const it=He._controlledReadableByteStream;it._state==="readable"&&(ReadableByteStreamControllerClearPendingPullIntos(He),ResetQueue(He),ReadableByteStreamControllerClearAlgorithms(He),ReadableStreamError(it,Qe))}function ReadableByteStreamControllerGetBYOBRequest(He){if(He._byobRequest===null&&He._pendingPullIntos.length>0){const Qe=He._pendingPullIntos.peek(),it=new Uint8Array(Qe.buffer,Qe.byteOffset+Qe.bytesFilled,Qe.byteLength-Qe.bytesFilled),lt=Object.create(ReadableStreamBYOBRequest.prototype);SetUpReadableStreamBYOBRequest(lt,He,it),He._byobRequest=lt}return He._byobRequest}function ReadableByteStreamControllerGetDesiredSize(He){const Qe=He._controlledReadableByteStream._state;return Qe==="errored"?null:Qe==="closed"?0:He._strategyHWM-He._queueTotalSize}function ReadableByteStreamControllerRespond(He,Qe){const it=He._pendingPullIntos.peek();if(He._controlledReadableByteStream._state==="closed"){if(Qe!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(Qe===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(it.bytesFilled+Qe>it.byteLength)throw new RangeError("bytesWritten out of range")}it.buffer=it.buffer,ReadableByteStreamControllerRespondInternal(He,Qe)}function ReadableByteStreamControllerRespondWithNewView(He,Qe){const it=He._pendingPullIntos.peek();if(He._controlledReadableByteStream._state==="closed"){if(Qe.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(Qe.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(it.byteOffset+it.bytesFilled!==Qe.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(it.bufferByteLength!==Qe.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(it.bytesFilled+Qe.byteLength>it.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");const ut=Qe.byteLength;it.buffer=Qe.buffer,ReadableByteStreamControllerRespondInternal(He,ut)}function SetUpReadableByteStreamController(He,Qe,it,lt,ut,dt,xt){Qe._controlledReadableByteStream=He,Qe._pullAgain=!1,Qe._pulling=!1,Qe._byobRequest=null,Qe._queue=Qe._queueTotalSize=void 0,ResetQueue(Qe),Qe._closeRequested=!1,Qe._started=!1,Qe._strategyHWM=dt,Qe._pullAlgorithm=lt,Qe._cancelAlgorithm=ut,Qe._autoAllocateChunkSize=xt,Qe._pendingPullIntos=new SimpleQueue,He._readableStreamController=Qe;const ft=it();uponPromise(promiseResolvedWith(ft),()=>{Qe._started=!0,ReadableByteStreamControllerCallPullIfNeeded(Qe)},vt=>{ReadableByteStreamControllerError(Qe,vt)})}function SetUpReadableByteStreamControllerFromUnderlyingSource(He,Qe,it){const lt=Object.create(ReadableByteStreamController.prototype);let ut=()=>{},dt=()=>promiseResolvedWith(void 0),xt=()=>promiseResolvedWith(void 0);Qe.start!==void 0&&(ut=()=>Qe.start(lt)),Qe.pull!==void 0&&(dt=()=>Qe.pull(lt)),Qe.cancel!==void 0&&(xt=vt=>Qe.cancel(vt));const ft=Qe.autoAllocateChunkSize;if(ft===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");SetUpReadableByteStreamController(He,lt,ut,dt,xt,it,ft)}function SetUpReadableStreamBYOBRequest(He,Qe,it){He._associatedReadableByteStreamController=Qe,He._view=it}function byobRequestBrandCheckException(He){return new TypeError(`ReadableStreamBYOBRequest.prototype.${He} can only be used on a ReadableStreamBYOBRequest`)}function byteStreamControllerBrandCheckException(He){return new TypeError(`ReadableByteStreamController.prototype.${He} can only be used on a ReadableByteStreamController`)}function AcquireReadableStreamBYOBReader(He){return new ReadableStreamBYOBReader(He)}function ReadableStreamAddReadIntoRequest(He,Qe){He._reader._readIntoRequests.push(Qe)}function ReadableStreamFulfillReadIntoRequest(He,Qe,it){const ut=He._reader._readIntoRequests.shift();it?ut._closeSteps(Qe):ut._chunkSteps(Qe)}function ReadableStreamGetNumReadIntoRequests(He){return He._reader._readIntoRequests.length}function ReadableStreamHasBYOBReader(He){const Qe=He._reader;return!(Qe===void 0||!IsReadableStreamBYOBReader(Qe))}class ReadableStreamBYOBReader{constructor(Qe){if(assertRequiredArgument(Qe,1,"ReadableStreamBYOBReader"),assertReadableStream(Qe,"First parameter"),IsReadableStreamLocked(Qe))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!IsReadableByteStreamController(Qe._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");ReadableStreamReaderGenericInitialize(this,Qe),this._readIntoRequests=new SimpleQueue}get closed(){return IsReadableStreamBYOBReader(this)?this._closedPromise:promiseRejectedWith(byobReaderBrandCheckException("closed"))}cancel(Qe=void 0){return IsReadableStreamBYOBReader(this)?this._ownerReadableStream===void 0?promiseRejectedWith(readerLockException("cancel")):ReadableStreamReaderGenericCancel(this,Qe):promiseRejectedWith(byobReaderBrandCheckException("cancel"))}read(Qe){if(!IsReadableStreamBYOBReader(this))return promiseRejectedWith(byobReaderBrandCheckException("read"));if(!ArrayBuffer.isView(Qe))return promiseRejectedWith(new TypeError("view must be an array buffer view"));if(Qe.byteLength===0)return promiseRejectedWith(new TypeError("view must have non-zero byteLength"));if(Qe.buffer.byteLength===0)return promiseRejectedWith(new TypeError("view's buffer must have non-zero byteLength"));if(IsDetachedBuffer(Qe.buffer),this._ownerReadableStream===void 0)return promiseRejectedWith(readerLockException("read from"));let it,lt;const ut=newPromise((xt,ft)=>{it=xt,lt=ft});return ReadableStreamBYOBReaderRead(this,Qe,{_chunkSteps:xt=>it({value:xt,done:!1}),_closeSteps:xt=>it({value:xt,done:!0}),_errorSteps:xt=>lt(xt)}),ut}releaseLock(){if(!IsReadableStreamBYOBReader(this))throw byobReaderBrandCheckException("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ReadableStreamReaderGenericRelease(this)}}}Object.defineProperties(ReadableStreamBYOBReader.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(ReadableStreamBYOBReader.prototype,SymbolPolyfill.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function IsReadableStreamBYOBReader(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_readIntoRequests")?!1:He instanceof ReadableStreamBYOBReader}function ReadableStreamBYOBReaderRead(He,Qe,it){const lt=He._ownerReadableStream;lt._disturbed=!0,lt._state==="errored"?it._errorSteps(lt._storedError):ReadableByteStreamControllerPullInto(lt._readableStreamController,Qe,it)}function byobReaderBrandCheckException(He){return new TypeError(`ReadableStreamBYOBReader.prototype.${He} can only be used on a ReadableStreamBYOBReader`)}function ExtractHighWaterMark(He,Qe){const{highWaterMark:it}=He;if(it===void 0)return Qe;if(NumberIsNaN(it)||it<0)throw new RangeError("Invalid highWaterMark");return it}function ExtractSizeAlgorithm(He){const{size:Qe}=He;return Qe||(()=>1)}function convertQueuingStrategy(He,Qe){assertDictionary(He,Qe);const it=He?.highWaterMark,lt=He?.size;return{highWaterMark:it===void 0?void 0:convertUnrestrictedDouble(it),size:lt===void 0?void 0:convertQueuingStrategySize(lt,`${Qe} has member 'size' that`)}}function convertQueuingStrategySize(He,Qe){return assertFunction(He,Qe),it=>convertUnrestrictedDouble(He(it))}function convertUnderlyingSink(He,Qe){assertDictionary(He,Qe);const it=He?.abort,lt=He?.close,ut=He?.start,dt=He?.type,xt=He?.write;return{abort:it===void 0?void 0:convertUnderlyingSinkAbortCallback(it,He,`${Qe} has member 'abort' that`),close:lt===void 0?void 0:convertUnderlyingSinkCloseCallback(lt,He,`${Qe} has member 'close' that`),start:ut===void 0?void 0:convertUnderlyingSinkStartCallback(ut,He,`${Qe} has member 'start' that`),write:xt===void 0?void 0:convertUnderlyingSinkWriteCallback(xt,He,`${Qe} has member 'write' that`),type:dt}}function convertUnderlyingSinkAbortCallback(He,Qe,it){return assertFunction(He,it),lt=>promiseCall(He,Qe,[lt])}function convertUnderlyingSinkCloseCallback(He,Qe,it){return assertFunction(He,it),()=>promiseCall(He,Qe,[])}function convertUnderlyingSinkStartCallback(He,Qe,it){return assertFunction(He,it),lt=>reflectCall(He,Qe,[lt])}function convertUnderlyingSinkWriteCallback(He,Qe,it){return assertFunction(He,it),(lt,ut)=>promiseCall(He,Qe,[lt,ut])}function assertWritableStream(He,Qe){if(!IsWritableStream(He))throw new TypeError(`${Qe} is not a WritableStream.`)}function isAbortSignal(He){if(typeof He!="object"||He===null)return!1;try{return typeof He.aborted=="boolean"}catch{return!1}}const supportsAbortController=typeof AbortController=="function";function createAbortController(){if(supportsAbortController)return new AbortController}class WritableStream{constructor(Qe={},it={}){Qe===void 0?Qe=null:assertObject(Qe,"First parameter");const lt=convertQueuingStrategy(it,"Second parameter"),ut=convertUnderlyingSink(Qe,"First parameter");if(InitializeWritableStream(this),ut.type!==void 0)throw new RangeError("Invalid type is specified");const xt=ExtractSizeAlgorithm(lt),ft=ExtractHighWaterMark(lt,1);SetUpWritableStreamDefaultControllerFromUnderlyingSink(this,ut,ft,xt)}get locked(){if(!IsWritableStream(this))throw streamBrandCheckException$2("locked");return IsWritableStreamLocked(this)}abort(Qe=void 0){return IsWritableStream(this)?IsWritableStreamLocked(this)?promiseRejectedWith(new TypeError("Cannot abort a stream that already has a writer")):WritableStreamAbort(this,Qe):promiseRejectedWith(streamBrandCheckException$2("abort"))}close(){return IsWritableStream(this)?IsWritableStreamLocked(this)?promiseRejectedWith(new TypeError("Cannot close a stream that already has a writer")):WritableStreamCloseQueuedOrInFlight(this)?promiseRejectedWith(new TypeError("Cannot close an already-closing stream")):WritableStreamClose(this):promiseRejectedWith(streamBrandCheckException$2("close"))}getWriter(){if(!IsWritableStream(this))throw streamBrandCheckException$2("getWriter");return AcquireWritableStreamDefaultWriter(this)}}Object.defineProperties(WritableStream.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(WritableStream.prototype,SymbolPolyfill.toStringTag,{value:"WritableStream",configurable:!0});function AcquireWritableStreamDefaultWriter(He){return new WritableStreamDefaultWriter(He)}function CreateWritableStream(He,Qe,it,lt,ut=1,dt=()=>1){const xt=Object.create(WritableStream.prototype);InitializeWritableStream(xt);const ft=Object.create(WritableStreamDefaultController.prototype);return SetUpWritableStreamDefaultController(xt,ft,He,Qe,it,lt,ut,dt),xt}function InitializeWritableStream(He){He._state="writable",He._storedError=void 0,He._writer=void 0,He._writableStreamController=void 0,He._writeRequests=new SimpleQueue,He._inFlightWriteRequest=void 0,He._closeRequest=void 0,He._inFlightCloseRequest=void 0,He._pendingAbortRequest=void 0,He._backpressure=!1}function IsWritableStream(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_writableStreamController")?!1:He instanceof WritableStream}function IsWritableStreamLocked(He){return He._writer!==void 0}function WritableStreamAbort(He,Qe){var it;if(He._state==="closed"||He._state==="errored")return promiseResolvedWith(void 0);He._writableStreamController._abortReason=Qe,(it=He._writableStreamController._abortController)===null||it===void 0||it.abort();const lt=He._state;if(lt==="closed"||lt==="errored")return promiseResolvedWith(void 0);if(He._pendingAbortRequest!==void 0)return He._pendingAbortRequest._promise;let ut=!1;lt==="erroring"&&(ut=!0,Qe=void 0);const dt=newPromise((xt,ft)=>{He._pendingAbortRequest={_promise:void 0,_resolve:xt,_reject:ft,_reason:Qe,_wasAlreadyErroring:ut}});return He._pendingAbortRequest._promise=dt,ut||WritableStreamStartErroring(He,Qe),dt}function WritableStreamClose(He){const Qe=He._state;if(Qe==="closed"||Qe==="errored")return promiseRejectedWith(new TypeError(`The stream (in ${Qe} state) is not in the writable state and cannot be closed`));const it=newPromise((ut,dt)=>{const xt={_resolve:ut,_reject:dt};He._closeRequest=xt}),lt=He._writer;return lt!==void 0&&He._backpressure&&Qe==="writable"&&defaultWriterReadyPromiseResolve(lt),WritableStreamDefaultControllerClose(He._writableStreamController),it}function WritableStreamAddWriteRequest(He){return newPromise((it,lt)=>{const ut={_resolve:it,_reject:lt};He._writeRequests.push(ut)})}function WritableStreamDealWithRejection(He,Qe){if(He._state==="writable"){WritableStreamStartErroring(He,Qe);return}WritableStreamFinishErroring(He)}function WritableStreamStartErroring(He,Qe){const it=He._writableStreamController;He._state="erroring",He._storedError=Qe;const lt=He._writer;lt!==void 0&&WritableStreamDefaultWriterEnsureReadyPromiseRejected(lt,Qe),!WritableStreamHasOperationMarkedInFlight(He)&&it._started&&WritableStreamFinishErroring(He)}function WritableStreamFinishErroring(He){He._state="errored",He._writableStreamController[ErrorSteps]();const Qe=He._storedError;if(He._writeRequests.forEach(ut=>{ut._reject(Qe)}),He._writeRequests=new SimpleQueue,He._pendingAbortRequest===void 0){WritableStreamRejectCloseAndClosedPromiseIfNeeded(He);return}const it=He._pendingAbortRequest;if(He._pendingAbortRequest=void 0,it._wasAlreadyErroring){it._reject(Qe),WritableStreamRejectCloseAndClosedPromiseIfNeeded(He);return}const lt=He._writableStreamController[AbortSteps](it._reason);uponPromise(lt,()=>{it._resolve(),WritableStreamRejectCloseAndClosedPromiseIfNeeded(He)},ut=>{it._reject(ut),WritableStreamRejectCloseAndClosedPromiseIfNeeded(He)})}function WritableStreamFinishInFlightWrite(He){He._inFlightWriteRequest._resolve(void 0),He._inFlightWriteRequest=void 0}function WritableStreamFinishInFlightWriteWithError(He,Qe){He._inFlightWriteRequest._reject(Qe),He._inFlightWriteRequest=void 0,WritableStreamDealWithRejection(He,Qe)}function WritableStreamFinishInFlightClose(He){He._inFlightCloseRequest._resolve(void 0),He._inFlightCloseRequest=void 0,He._state==="erroring"&&(He._storedError=void 0,He._pendingAbortRequest!==void 0&&(He._pendingAbortRequest._resolve(),He._pendingAbortRequest=void 0)),He._state="closed";const it=He._writer;it!==void 0&&defaultWriterClosedPromiseResolve(it)}function WritableStreamFinishInFlightCloseWithError(He,Qe){He._inFlightCloseRequest._reject(Qe),He._inFlightCloseRequest=void 0,He._pendingAbortRequest!==void 0&&(He._pendingAbortRequest._reject(Qe),He._pendingAbortRequest=void 0),WritableStreamDealWithRejection(He,Qe)}function WritableStreamCloseQueuedOrInFlight(He){return!(He._closeRequest===void 0&&He._inFlightCloseRequest===void 0)}function WritableStreamHasOperationMarkedInFlight(He){return!(He._inFlightWriteRequest===void 0&&He._inFlightCloseRequest===void 0)}function WritableStreamMarkCloseRequestInFlight(He){He._inFlightCloseRequest=He._closeRequest,He._closeRequest=void 0}function WritableStreamMarkFirstWriteRequestInFlight(He){He._inFlightWriteRequest=He._writeRequests.shift()}function WritableStreamRejectCloseAndClosedPromiseIfNeeded(He){He._closeRequest!==void 0&&(He._closeRequest._reject(He._storedError),He._closeRequest=void 0);const Qe=He._writer;Qe!==void 0&&defaultWriterClosedPromiseReject(Qe,He._storedError)}function WritableStreamUpdateBackpressure(He,Qe){const it=He._writer;it!==void 0&&Qe!==He._backpressure&&(Qe?defaultWriterReadyPromiseReset(it):defaultWriterReadyPromiseResolve(it)),He._backpressure=Qe}class WritableStreamDefaultWriter{constructor(Qe){if(assertRequiredArgument(Qe,1,"WritableStreamDefaultWriter"),assertWritableStream(Qe,"First parameter"),IsWritableStreamLocked(Qe))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=Qe,Qe._writer=this;const it=Qe._state;if(it==="writable")!WritableStreamCloseQueuedOrInFlight(Qe)&&Qe._backpressure?defaultWriterReadyPromiseInitialize(this):defaultWriterReadyPromiseInitializeAsResolved(this),defaultWriterClosedPromiseInitialize(this);else if(it==="erroring")defaultWriterReadyPromiseInitializeAsRejected(this,Qe._storedError),defaultWriterClosedPromiseInitialize(this);else if(it==="closed")defaultWriterReadyPromiseInitializeAsResolved(this),defaultWriterClosedPromiseInitializeAsResolved(this);else{const lt=Qe._storedError;defaultWriterReadyPromiseInitializeAsRejected(this,lt),defaultWriterClosedPromiseInitializeAsRejected(this,lt)}}get closed(){return IsWritableStreamDefaultWriter(this)?this._closedPromise:promiseRejectedWith(defaultWriterBrandCheckException("closed"))}get desiredSize(){if(!IsWritableStreamDefaultWriter(this))throw defaultWriterBrandCheckException("desiredSize");if(this._ownerWritableStream===void 0)throw defaultWriterLockException("desiredSize");return WritableStreamDefaultWriterGetDesiredSize(this)}get ready(){return IsWritableStreamDefaultWriter(this)?this._readyPromise:promiseRejectedWith(defaultWriterBrandCheckException("ready"))}abort(Qe=void 0){return IsWritableStreamDefaultWriter(this)?this._ownerWritableStream===void 0?promiseRejectedWith(defaultWriterLockException("abort")):WritableStreamDefaultWriterAbort(this,Qe):promiseRejectedWith(defaultWriterBrandCheckException("abort"))}close(){if(!IsWritableStreamDefaultWriter(this))return promiseRejectedWith(defaultWriterBrandCheckException("close"));const Qe=this._ownerWritableStream;return Qe===void 0?promiseRejectedWith(defaultWriterLockException("close")):WritableStreamCloseQueuedOrInFlight(Qe)?promiseRejectedWith(new TypeError("Cannot close an already-closing stream")):WritableStreamDefaultWriterClose(this)}releaseLock(){if(!IsWritableStreamDefaultWriter(this))throw defaultWriterBrandCheckException("releaseLock");this._ownerWritableStream!==void 0&&WritableStreamDefaultWriterRelease(this)}write(Qe=void 0){return IsWritableStreamDefaultWriter(this)?this._ownerWritableStream===void 0?promiseRejectedWith(defaultWriterLockException("write to")):WritableStreamDefaultWriterWrite(this,Qe):promiseRejectedWith(defaultWriterBrandCheckException("write"))}}Object.defineProperties(WritableStreamDefaultWriter.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(WritableStreamDefaultWriter.prototype,SymbolPolyfill.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function IsWritableStreamDefaultWriter(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_ownerWritableStream")?!1:He instanceof WritableStreamDefaultWriter}function WritableStreamDefaultWriterAbort(He,Qe){const it=He._ownerWritableStream;return WritableStreamAbort(it,Qe)}function WritableStreamDefaultWriterClose(He){const Qe=He._ownerWritableStream;return WritableStreamClose(Qe)}function WritableStreamDefaultWriterCloseWithErrorPropagation(He){const Qe=He._ownerWritableStream,it=Qe._state;return WritableStreamCloseQueuedOrInFlight(Qe)||it==="closed"?promiseResolvedWith(void 0):it==="errored"?promiseRejectedWith(Qe._storedError):WritableStreamDefaultWriterClose(He)}function WritableStreamDefaultWriterEnsureClosedPromiseRejected(He,Qe){He._closedPromiseState==="pending"?defaultWriterClosedPromiseReject(He,Qe):defaultWriterClosedPromiseResetToRejected(He,Qe)}function WritableStreamDefaultWriterEnsureReadyPromiseRejected(He,Qe){He._readyPromiseState==="pending"?defaultWriterReadyPromiseReject(He,Qe):defaultWriterReadyPromiseResetToRejected(He,Qe)}function WritableStreamDefaultWriterGetDesiredSize(He){const Qe=He._ownerWritableStream,it=Qe._state;return it==="errored"||it==="erroring"?null:it==="closed"?0:WritableStreamDefaultControllerGetDesiredSize(Qe._writableStreamController)}function WritableStreamDefaultWriterRelease(He){const Qe=He._ownerWritableStream,it=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");WritableStreamDefaultWriterEnsureReadyPromiseRejected(He,it),WritableStreamDefaultWriterEnsureClosedPromiseRejected(He,it),Qe._writer=void 0,He._ownerWritableStream=void 0}function WritableStreamDefaultWriterWrite(He,Qe){const it=He._ownerWritableStream,lt=it._writableStreamController,ut=WritableStreamDefaultControllerGetChunkSize(lt,Qe);if(it!==He._ownerWritableStream)return promiseRejectedWith(defaultWriterLockException("write to"));const dt=it._state;if(dt==="errored")return promiseRejectedWith(it._storedError);if(WritableStreamCloseQueuedOrInFlight(it)||dt==="closed")return promiseRejectedWith(new TypeError("The stream is closing or closed and cannot be written to"));if(dt==="erroring")return promiseRejectedWith(it._storedError);const xt=WritableStreamAddWriteRequest(it);return WritableStreamDefaultControllerWrite(lt,Qe,ut),xt}const closeSentinel={};class WritableStreamDefaultController{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!IsWritableStreamDefaultController(this))throw defaultControllerBrandCheckException$2("abortReason");return this._abortReason}get signal(){if(!IsWritableStreamDefaultController(this))throw defaultControllerBrandCheckException$2("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(Qe=void 0){if(!IsWritableStreamDefaultController(this))throw defaultControllerBrandCheckException$2("error");this._controlledWritableStream._state==="writable"&&WritableStreamDefaultControllerError(this,Qe)}[AbortSteps](Qe){const it=this._abortAlgorithm(Qe);return WritableStreamDefaultControllerClearAlgorithms(this),it}[ErrorSteps](){ResetQueue(this)}}Object.defineProperties(WritableStreamDefaultController.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(WritableStreamDefaultController.prototype,SymbolPolyfill.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function IsWritableStreamDefaultController(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_controlledWritableStream")?!1:He instanceof WritableStreamDefaultController}function SetUpWritableStreamDefaultController(He,Qe,it,lt,ut,dt,xt,ft){Qe._controlledWritableStream=He,He._writableStreamController=Qe,Qe._queue=void 0,Qe._queueTotalSize=void 0,ResetQueue(Qe),Qe._abortReason=void 0,Qe._abortController=createAbortController(),Qe._started=!1,Qe._strategySizeAlgorithm=ft,Qe._strategyHWM=xt,Qe._writeAlgorithm=lt,Qe._closeAlgorithm=ut,Qe._abortAlgorithm=dt;const vt=WritableStreamDefaultControllerGetBackpressure(Qe);WritableStreamUpdateBackpressure(He,vt);const kt=it(),St=promiseResolvedWith(kt);uponPromise(St,()=>{Qe._started=!0,WritableStreamDefaultControllerAdvanceQueueIfNeeded(Qe)},Tt=>{Qe._started=!0,WritableStreamDealWithRejection(He,Tt)})}function SetUpWritableStreamDefaultControllerFromUnderlyingSink(He,Qe,it,lt){const ut=Object.create(WritableStreamDefaultController.prototype);let dt=()=>{},xt=()=>promiseResolvedWith(void 0),ft=()=>promiseResolvedWith(void 0),vt=()=>promiseResolvedWith(void 0);Qe.start!==void 0&&(dt=()=>Qe.start(ut)),Qe.write!==void 0&&(xt=kt=>Qe.write(kt,ut)),Qe.close!==void 0&&(ft=()=>Qe.close()),Qe.abort!==void 0&&(vt=kt=>Qe.abort(kt)),SetUpWritableStreamDefaultController(He,ut,dt,xt,ft,vt,it,lt)}function WritableStreamDefaultControllerClearAlgorithms(He){He._writeAlgorithm=void 0,He._closeAlgorithm=void 0,He._abortAlgorithm=void 0,He._strategySizeAlgorithm=void 0}function WritableStreamDefaultControllerClose(He){EnqueueValueWithSize(He,closeSentinel,0),WritableStreamDefaultControllerAdvanceQueueIfNeeded(He)}function WritableStreamDefaultControllerGetChunkSize(He,Qe){try{return He._strategySizeAlgorithm(Qe)}catch(it){return WritableStreamDefaultControllerErrorIfNeeded(He,it),1}}function WritableStreamDefaultControllerGetDesiredSize(He){return He._strategyHWM-He._queueTotalSize}function WritableStreamDefaultControllerWrite(He,Qe,it){try{EnqueueValueWithSize(He,Qe,it)}catch(ut){WritableStreamDefaultControllerErrorIfNeeded(He,ut);return}const lt=He._controlledWritableStream;if(!WritableStreamCloseQueuedOrInFlight(lt)&&lt._state==="writable"){const ut=WritableStreamDefaultControllerGetBackpressure(He);WritableStreamUpdateBackpressure(lt,ut)}WritableStreamDefaultControllerAdvanceQueueIfNeeded(He)}function WritableStreamDefaultControllerAdvanceQueueIfNeeded(He){const Qe=He._controlledWritableStream;if(!He._started||Qe._inFlightWriteRequest!==void 0)return;if(Qe._state==="erroring"){WritableStreamFinishErroring(Qe);return}if(He._queue.length===0)return;const lt=PeekQueueValue(He);lt===closeSentinel?WritableStreamDefaultControllerProcessClose(He):WritableStreamDefaultControllerProcessWrite(He,lt)}function WritableStreamDefaultControllerErrorIfNeeded(He,Qe){He._controlledWritableStream._state==="writable"&&WritableStreamDefaultControllerError(He,Qe)}function WritableStreamDefaultControllerProcessClose(He){const Qe=He._controlledWritableStream;WritableStreamMarkCloseRequestInFlight(Qe),DequeueValue(He);const it=He._closeAlgorithm();WritableStreamDefaultControllerClearAlgorithms(He),uponPromise(it,()=>{WritableStreamFinishInFlightClose(Qe)},lt=>{WritableStreamFinishInFlightCloseWithError(Qe,lt)})}function WritableStreamDefaultControllerProcessWrite(He,Qe){const it=He._controlledWritableStream;WritableStreamMarkFirstWriteRequestInFlight(it);const lt=He._writeAlgorithm(Qe);uponPromise(lt,()=>{WritableStreamFinishInFlightWrite(it);const ut=it._state;if(DequeueValue(He),!WritableStreamCloseQueuedOrInFlight(it)&&ut==="writable"){const dt=WritableStreamDefaultControllerGetBackpressure(He);WritableStreamUpdateBackpressure(it,dt)}WritableStreamDefaultControllerAdvanceQueueIfNeeded(He)},ut=>{it._state==="writable"&&WritableStreamDefaultControllerClearAlgorithms(He),WritableStreamFinishInFlightWriteWithError(it,ut)})}function WritableStreamDefaultControllerGetBackpressure(He){return WritableStreamDefaultControllerGetDesiredSize(He)<=0}function WritableStreamDefaultControllerError(He,Qe){const it=He._controlledWritableStream;WritableStreamDefaultControllerClearAlgorithms(He),WritableStreamStartErroring(it,Qe)}function streamBrandCheckException$2(He){return new TypeError(`WritableStream.prototype.${He} can only be used on a WritableStream`)}function defaultControllerBrandCheckException$2(He){return new TypeError(`WritableStreamDefaultController.prototype.${He} can only be used on a WritableStreamDefaultController`)}function defaultWriterBrandCheckException(He){return new TypeError(`WritableStreamDefaultWriter.prototype.${He} can only be used on a WritableStreamDefaultWriter`)}function defaultWriterLockException(He){return new TypeError("Cannot "+He+" a stream using a released writer")}function defaultWriterClosedPromiseInitialize(He){He._closedPromise=newPromise((Qe,it)=>{He._closedPromise_resolve=Qe,He._closedPromise_reject=it,He._closedPromiseState="pending"})}function defaultWriterClosedPromiseInitializeAsRejected(He,Qe){defaultWriterClosedPromiseInitialize(He),defaultWriterClosedPromiseReject(He,Qe)}function defaultWriterClosedPromiseInitializeAsResolved(He){defaultWriterClosedPromiseInitialize(He),defaultWriterClosedPromiseResolve(He)}function defaultWriterClosedPromiseReject(He,Qe){He._closedPromise_reject!==void 0&&(setPromiseIsHandledToTrue(He._closedPromise),He._closedPromise_reject(Qe),He._closedPromise_resolve=void 0,He._closedPromise_reject=void 0,He._closedPromiseState="rejected")}function defaultWriterClosedPromiseResetToRejected(He,Qe){defaultWriterClosedPromiseInitializeAsRejected(He,Qe)}function defaultWriterClosedPromiseResolve(He){He._closedPromise_resolve!==void 0&&(He._closedPromise_resolve(void 0),He._closedPromise_resolve=void 0,He._closedPromise_reject=void 0,He._closedPromiseState="resolved")}function defaultWriterReadyPromiseInitialize(He){He._readyPromise=newPromise((Qe,it)=>{He._readyPromise_resolve=Qe,He._readyPromise_reject=it}),He._readyPromiseState="pending"}function defaultWriterReadyPromiseInitializeAsRejected(He,Qe){defaultWriterReadyPromiseInitialize(He),defaultWriterReadyPromiseReject(He,Qe)}function defaultWriterReadyPromiseInitializeAsResolved(He){defaultWriterReadyPromiseInitialize(He),defaultWriterReadyPromiseResolve(He)}function defaultWriterReadyPromiseReject(He,Qe){He._readyPromise_reject!==void 0&&(setPromiseIsHandledToTrue(He._readyPromise),He._readyPromise_reject(Qe),He._readyPromise_resolve=void 0,He._readyPromise_reject=void 0,He._readyPromiseState="rejected")}function defaultWriterReadyPromiseReset(He){defaultWriterReadyPromiseInitialize(He)}function defaultWriterReadyPromiseResetToRejected(He,Qe){defaultWriterReadyPromiseInitializeAsRejected(He,Qe)}function defaultWriterReadyPromiseResolve(He){He._readyPromise_resolve!==void 0&&(He._readyPromise_resolve(void 0),He._readyPromise_resolve=void 0,He._readyPromise_reject=void 0,He._readyPromiseState="fulfilled")}const NativeDOMException=typeof DOMException<"u"?DOMException:void 0;function isDOMExceptionConstructor(He){if(!(typeof He=="function"||typeof He=="object"))return!1;try{return new He,!0}catch{return!1}}function createDOMExceptionPolyfill(){const He=function(it,lt){this.message=it||"",this.name=lt||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return He.prototype=Object.create(Error.prototype),Object.defineProperty(He.prototype,"constructor",{value:He,writable:!0,configurable:!0}),He}const DOMException$1=isDOMExceptionConstructor(NativeDOMException)?NativeDOMException:createDOMExceptionPolyfill();function ReadableStreamPipeTo(He,Qe,it,lt,ut,dt){const xt=AcquireReadableStreamDefaultReader(He),ft=AcquireWritableStreamDefaultWriter(Qe);He._disturbed=!0;let vt=!1,kt=promiseResolvedWith(void 0);return newPromise((St,Tt)=>{let Mt;if(dt!==void 0){if(Mt=()=>{const Wt=new DOMException$1("Aborted","AbortError"),Xt=[];lt||Xt.push(()=>Qe._state==="writable"?WritableStreamAbort(Qe,Wt):promiseResolvedWith(void 0)),ut||Xt.push(()=>He._state==="readable"?ReadableStreamCancel(He,Wt):promiseResolvedWith(void 0)),Bt(()=>Promise.all(Xt.map(Kt=>Kt())),!0,Wt)},dt.aborted){Mt();return}dt.addEventListener("abort",Mt)}function Nt(){return newPromise((Wt,Xt)=>{function Kt(Jt){Jt?Wt():PerformPromiseThen(At(),Kt,Xt)}Kt(!1)})}function At(){return vt?promiseResolvedWith(!0):PerformPromiseThen(ft._readyPromise,()=>newPromise((Wt,Xt)=>{ReadableStreamDefaultReaderRead(xt,{_chunkSteps:Kt=>{kt=PerformPromiseThen(WritableStreamDefaultWriterWrite(ft,Kt),void 0,noop),Wt(!1)},_closeSteps:()=>Wt(!0),_errorSteps:Xt})}))}if(Dt(He,xt._closedPromise,Wt=>{lt?Ot(!0,Wt):Bt(()=>WritableStreamAbort(Qe,Wt),!0,Wt)}),Dt(Qe,ft._closedPromise,Wt=>{ut?Ot(!0,Wt):Bt(()=>ReadableStreamCancel(He,Wt),!0,Wt)}),Ft(He,xt._closedPromise,()=>{it?Ot():Bt(()=>WritableStreamDefaultWriterCloseWithErrorPropagation(ft))}),WritableStreamCloseQueuedOrInFlight(Qe)||Qe._state==="closed"){const Wt=new TypeError("the destination writable stream closed before all data could be piped to it");ut?Ot(!0,Wt):Bt(()=>ReadableStreamCancel(He,Wt),!0,Wt)}setPromiseIsHandledToTrue(Nt());function $t(){const Wt=kt;return PerformPromiseThen(kt,()=>Wt!==kt?$t():void 0)}function Dt(Wt,Xt,Kt){Wt._state==="errored"?Kt(Wt._storedError):uponRejection(Xt,Kt)}function Ft(Wt,Xt,Kt){Wt._state==="closed"?Kt():uponFulfillment(Xt,Kt)}function Bt(Wt,Xt,Kt){if(vt)return;vt=!0,Qe._state==="writable"&&!WritableStreamCloseQueuedOrInFlight(Qe)?uponFulfillment($t(),Jt):Jt();function Jt(){uponPromise(Wt(),()=>Qt(Xt,Kt),hr=>Qt(!0,hr))}}function Ot(Wt,Xt){vt||(vt=!0,Qe._state==="writable"&&!WritableStreamCloseQueuedOrInFlight(Qe)?uponFulfillment($t(),()=>Qt(Wt,Xt)):Qt(Wt,Xt))}function Qt(Wt,Xt){WritableStreamDefaultWriterRelease(ft),ReadableStreamReaderGenericRelease(xt),dt!==void 0&&dt.removeEventListener("abort",Mt),Wt?Tt(Xt):St(void 0)}})}class ReadableStreamDefaultController{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!IsReadableStreamDefaultController(this))throw defaultControllerBrandCheckException$1("desiredSize");return ReadableStreamDefaultControllerGetDesiredSize(this)}close(){if(!IsReadableStreamDefaultController(this))throw defaultControllerBrandCheckException$1("close");if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(this))throw new TypeError("The stream is not in a state that permits close");ReadableStreamDefaultControllerClose(this)}enqueue(Qe=void 0){if(!IsReadableStreamDefaultController(this))throw defaultControllerBrandCheckException$1("enqueue");if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(this))throw new TypeError("The stream is not in a state that permits enqueue");return ReadableStreamDefaultControllerEnqueue(this,Qe)}error(Qe=void 0){if(!IsReadableStreamDefaultController(this))throw defaultControllerBrandCheckException$1("error");ReadableStreamDefaultControllerError(this,Qe)}[CancelSteps](Qe){ResetQueue(this);const it=this._cancelAlgorithm(Qe);return ReadableStreamDefaultControllerClearAlgorithms(this),it}[PullSteps](Qe){const it=this._controlledReadableStream;if(this._queue.length>0){const lt=DequeueValue(this);this._closeRequested&&this._queue.length===0?(ReadableStreamDefaultControllerClearAlgorithms(this),ReadableStreamClose(it)):ReadableStreamDefaultControllerCallPullIfNeeded(this),Qe._chunkSteps(lt)}else ReadableStreamAddReadRequest(it,Qe),ReadableStreamDefaultControllerCallPullIfNeeded(this)}}Object.defineProperties(ReadableStreamDefaultController.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(ReadableStreamDefaultController.prototype,SymbolPolyfill.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function IsReadableStreamDefaultController(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_controlledReadableStream")?!1:He instanceof ReadableStreamDefaultController}function ReadableStreamDefaultControllerCallPullIfNeeded(He){if(!ReadableStreamDefaultControllerShouldCallPull(He))return;if(He._pulling){He._pullAgain=!0;return}He._pulling=!0;const it=He._pullAlgorithm();uponPromise(it,()=>{He._pulling=!1,He._pullAgain&&(He._pullAgain=!1,ReadableStreamDefaultControllerCallPullIfNeeded(He))},lt=>{ReadableStreamDefaultControllerError(He,lt)})}function ReadableStreamDefaultControllerShouldCallPull(He){const Qe=He._controlledReadableStream;return!ReadableStreamDefaultControllerCanCloseOrEnqueue(He)||!He._started?!1:!!(IsReadableStreamLocked(Qe)&&ReadableStreamGetNumReadRequests(Qe)>0||ReadableStreamDefaultControllerGetDesiredSize(He)>0)}function ReadableStreamDefaultControllerClearAlgorithms(He){He._pullAlgorithm=void 0,He._cancelAlgorithm=void 0,He._strategySizeAlgorithm=void 0}function ReadableStreamDefaultControllerClose(He){if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(He))return;const Qe=He._controlledReadableStream;He._closeRequested=!0,He._queue.length===0&&(ReadableStreamDefaultControllerClearAlgorithms(He),ReadableStreamClose(Qe))}function ReadableStreamDefaultControllerEnqueue(He,Qe){if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(He))return;const it=He._controlledReadableStream;if(IsReadableStreamLocked(it)&&ReadableStreamGetNumReadRequests(it)>0)ReadableStreamFulfillReadRequest(it,Qe,!1);else{let lt;try{lt=He._strategySizeAlgorithm(Qe)}catch(ut){throw ReadableStreamDefaultControllerError(He,ut),ut}try{EnqueueValueWithSize(He,Qe,lt)}catch(ut){throw ReadableStreamDefaultControllerError(He,ut),ut}}ReadableStreamDefaultControllerCallPullIfNeeded(He)}function ReadableStreamDefaultControllerError(He,Qe){const it=He._controlledReadableStream;it._state==="readable"&&(ResetQueue(He),ReadableStreamDefaultControllerClearAlgorithms(He),ReadableStreamError(it,Qe))}function ReadableStreamDefaultControllerGetDesiredSize(He){const Qe=He._controlledReadableStream._state;return Qe==="errored"?null:Qe==="closed"?0:He._strategyHWM-He._queueTotalSize}function ReadableStreamDefaultControllerHasBackpressure(He){return!ReadableStreamDefaultControllerShouldCallPull(He)}function ReadableStreamDefaultControllerCanCloseOrEnqueue(He){const Qe=He._controlledReadableStream._state;return!He._closeRequested&&Qe==="readable"}function SetUpReadableStreamDefaultController(He,Qe,it,lt,ut,dt,xt){Qe._controlledReadableStream=He,Qe._queue=void 0,Qe._queueTotalSize=void 0,ResetQueue(Qe),Qe._started=!1,Qe._closeRequested=!1,Qe._pullAgain=!1,Qe._pulling=!1,Qe._strategySizeAlgorithm=xt,Qe._strategyHWM=dt,Qe._pullAlgorithm=lt,Qe._cancelAlgorithm=ut,He._readableStreamController=Qe;const ft=it();uponPromise(promiseResolvedWith(ft),()=>{Qe._started=!0,ReadableStreamDefaultControllerCallPullIfNeeded(Qe)},vt=>{ReadableStreamDefaultControllerError(Qe,vt)})}function SetUpReadableStreamDefaultControllerFromUnderlyingSource(He,Qe,it,lt){const ut=Object.create(ReadableStreamDefaultController.prototype);let dt=()=>{},xt=()=>promiseResolvedWith(void 0),ft=()=>promiseResolvedWith(void 0);Qe.start!==void 0&&(dt=()=>Qe.start(ut)),Qe.pull!==void 0&&(xt=()=>Qe.pull(ut)),Qe.cancel!==void 0&&(ft=vt=>Qe.cancel(vt)),SetUpReadableStreamDefaultController(He,ut,dt,xt,ft,it,lt)}function defaultControllerBrandCheckException$1(He){return new TypeError(`ReadableStreamDefaultController.prototype.${He} can only be used on a ReadableStreamDefaultController`)}function ReadableStreamTee(He,Qe){return IsReadableByteStreamController(He._readableStreamController)?ReadableByteStreamTee(He):ReadableStreamDefaultTee(He)}function ReadableStreamDefaultTee(He,Qe){const it=AcquireReadableStreamDefaultReader(He);let lt=!1,ut=!1,dt=!1,xt=!1,ft,vt,kt,St,Tt;const Mt=newPromise(Ft=>{Tt=Ft});function Nt(){return lt?(ut=!0,promiseResolvedWith(void 0)):(lt=!0,ReadableStreamDefaultReaderRead(it,{_chunkSteps:Bt=>{queueMicrotask$1(()=>{ut=!1;const Ot=Bt,Qt=Bt;dt||ReadableStreamDefaultControllerEnqueue(kt._readableStreamController,Ot),xt||ReadableStreamDefaultControllerEnqueue(St._readableStreamController,Qt),lt=!1,ut&&Nt()})},_closeSteps:()=>{lt=!1,dt||ReadableStreamDefaultControllerClose(kt._readableStreamController),xt||ReadableStreamDefaultControllerClose(St._readableStreamController),(!dt||!xt)&&Tt(void 0)},_errorSteps:()=>{lt=!1}}),promiseResolvedWith(void 0))}function At(Ft){if(dt=!0,ft=Ft,xt){const Bt=CreateArrayFromList([ft,vt]),Ot=ReadableStreamCancel(He,Bt);Tt(Ot)}return Mt}function $t(Ft){if(xt=!0,vt=Ft,dt){const Bt=CreateArrayFromList([ft,vt]),Ot=ReadableStreamCancel(He,Bt);Tt(Ot)}return Mt}function Dt(){}return kt=CreateReadableStream(Dt,Nt,At),St=CreateReadableStream(Dt,Nt,$t),uponRejection(it._closedPromise,Ft=>{ReadableStreamDefaultControllerError(kt._readableStreamController,Ft),ReadableStreamDefaultControllerError(St._readableStreamController,Ft),(!dt||!xt)&&Tt(void 0)}),[kt,St]}function ReadableByteStreamTee(He){let Qe=AcquireReadableStreamDefaultReader(He),it=!1,lt=!1,ut=!1,dt=!1,xt=!1,ft,vt,kt,St,Tt;const Mt=newPromise(Wt=>{Tt=Wt});function Nt(Wt){uponRejection(Wt._closedPromise,Xt=>{Wt===Qe&&(ReadableByteStreamControllerError(kt._readableStreamController,Xt),ReadableByteStreamControllerError(St._readableStreamController,Xt),(!dt||!xt)&&Tt(void 0))})}function At(){IsReadableStreamBYOBReader(Qe)&&(ReadableStreamReaderGenericRelease(Qe),Qe=AcquireReadableStreamDefaultReader(He),Nt(Qe)),ReadableStreamDefaultReaderRead(Qe,{_chunkSteps:Xt=>{queueMicrotask$1(()=>{lt=!1,ut=!1;const Kt=Xt;let Jt=Xt;if(!dt&&!xt)try{Jt=CloneAsUint8Array(Xt)}catch(hr){ReadableByteStreamControllerError(kt._readableStreamController,hr),ReadableByteStreamControllerError(St._readableStreamController,hr),Tt(ReadableStreamCancel(He,hr));return}dt||ReadableByteStreamControllerEnqueue(kt._readableStreamController,Kt),xt||ReadableByteStreamControllerEnqueue(St._readableStreamController,Jt),it=!1,lt?Dt():ut&&Ft()})},_closeSteps:()=>{it=!1,dt||ReadableByteStreamControllerClose(kt._readableStreamController),xt||ReadableByteStreamControllerClose(St._readableStreamController),kt._readableStreamController._pendingPullIntos.length>0&&ReadableByteStreamControllerRespond(kt._readableStreamController,0),St._readableStreamController._pendingPullIntos.length>0&&ReadableByteStreamControllerRespond(St._readableStreamController,0),(!dt||!xt)&&Tt(void 0)},_errorSteps:()=>{it=!1}})}function $t(Wt,Xt){IsReadableStreamDefaultReader(Qe)&&(ReadableStreamReaderGenericRelease(Qe),Qe=AcquireReadableStreamBYOBReader(He),Nt(Qe));const Kt=Xt?St:kt,Jt=Xt?kt:St;ReadableStreamBYOBReaderRead(Qe,Wt,{_chunkSteps:xr=>{queueMicrotask$1(()=>{lt=!1,ut=!1;const gr=Xt?xt:dt;if(Xt?dt:xt)gr||ReadableByteStreamControllerRespondWithNewView(Kt._readableStreamController,xr);else{let vr;try{vr=CloneAsUint8Array(xr)}catch(yr){ReadableByteStreamControllerError(Kt._readableStreamController,yr),ReadableByteStreamControllerError(Jt._readableStreamController,yr),Tt(ReadableStreamCancel(He,yr));return}gr||ReadableByteStreamControllerRespondWithNewView(Kt._readableStreamController,xr),ReadableByteStreamControllerEnqueue(Jt._readableStreamController,vr)}it=!1,lt?Dt():ut&&Ft()})},_closeSteps:xr=>{it=!1;const gr=Xt?xt:dt,br=Xt?dt:xt;gr||ReadableByteStreamControllerClose(Kt._readableStreamController),br||ReadableByteStreamControllerClose(Jt._readableStreamController),xr!==void 0&&(gr||ReadableByteStreamControllerRespondWithNewView(Kt._readableStreamController,xr),!br&&Jt._readableStreamController._pendingPullIntos.length>0&&ReadableByteStreamControllerRespond(Jt._readableStreamController,0)),(!gr||!br)&&Tt(void 0)},_errorSteps:()=>{it=!1}})}function Dt(){if(it)return lt=!0,promiseResolvedWith(void 0);it=!0;const Wt=ReadableByteStreamControllerGetBYOBRequest(kt._readableStreamController);return Wt===null?At():$t(Wt._view,!1),promiseResolvedWith(void 0)}function Ft(){if(it)return ut=!0,promiseResolvedWith(void 0);it=!0;const Wt=ReadableByteStreamControllerGetBYOBRequest(St._readableStreamController);return Wt===null?At():$t(Wt._view,!0),promiseResolvedWith(void 0)}function Bt(Wt){if(dt=!0,ft=Wt,xt){const Xt=CreateArrayFromList([ft,vt]),Kt=ReadableStreamCancel(He,Xt);Tt(Kt)}return Mt}function Ot(Wt){if(xt=!0,vt=Wt,dt){const Xt=CreateArrayFromList([ft,vt]),Kt=ReadableStreamCancel(He,Xt);Tt(Kt)}return Mt}function Qt(){}return kt=CreateReadableByteStream(Qt,Dt,Bt),St=CreateReadableByteStream(Qt,Ft,Ot),Nt(Qe),[kt,St]}function convertUnderlyingDefaultOrByteSource(He,Qe){assertDictionary(He,Qe);const it=He,lt=it?.autoAllocateChunkSize,ut=it?.cancel,dt=it?.pull,xt=it?.start,ft=it?.type;return{autoAllocateChunkSize:lt===void 0?void 0:convertUnsignedLongLongWithEnforceRange(lt,`${Qe} has member 'autoAllocateChunkSize' that`),cancel:ut===void 0?void 0:convertUnderlyingSourceCancelCallback(ut,it,`${Qe} has member 'cancel' that`),pull:dt===void 0?void 0:convertUnderlyingSourcePullCallback(dt,it,`${Qe} has member 'pull' that`),start:xt===void 0?void 0:convertUnderlyingSourceStartCallback(xt,it,`${Qe} has member 'start' that`),type:ft===void 0?void 0:convertReadableStreamType(ft,`${Qe} has member 'type' that`)}}function convertUnderlyingSourceCancelCallback(He,Qe,it){return assertFunction(He,it),lt=>promiseCall(He,Qe,[lt])}function convertUnderlyingSourcePullCallback(He,Qe,it){return assertFunction(He,it),lt=>promiseCall(He,Qe,[lt])}function convertUnderlyingSourceStartCallback(He,Qe,it){return assertFunction(He,it),lt=>reflectCall(He,Qe,[lt])}function convertReadableStreamType(He,Qe){if(He=`${He}`,He!=="bytes")throw new TypeError(`${Qe} '${He}' is not a valid enumeration value for ReadableStreamType`);return He}function convertReaderOptions(He,Qe){assertDictionary(He,Qe);const it=He?.mode;return{mode:it===void 0?void 0:convertReadableStreamReaderMode(it,`${Qe} has member 'mode' that`)}}function convertReadableStreamReaderMode(He,Qe){if(He=`${He}`,He!=="byob")throw new TypeError(`${Qe} '${He}' is not a valid enumeration value for ReadableStreamReaderMode`);return He}function convertIteratorOptions(He,Qe){return assertDictionary(He,Qe),{preventCancel:!!He?.preventCancel}}function convertPipeOptions(He,Qe){assertDictionary(He,Qe);const it=He?.preventAbort,lt=He?.preventCancel,ut=He?.preventClose,dt=He?.signal;return dt!==void 0&&assertAbortSignal(dt,`${Qe} has member 'signal' that`),{preventAbort:!!it,preventCancel:!!lt,preventClose:!!ut,signal:dt}}function assertAbortSignal(He,Qe){if(!isAbortSignal(He))throw new TypeError(`${Qe} is not an AbortSignal.`)}function convertReadableWritablePair(He,Qe){assertDictionary(He,Qe);const it=He?.readable;assertRequiredField(it,"readable","ReadableWritablePair"),assertReadableStream(it,`${Qe} has member 'readable' that`);const lt=He?.writable;return assertRequiredField(lt,"writable","ReadableWritablePair"),assertWritableStream(lt,`${Qe} has member 'writable' that`),{readable:it,writable:lt}}let ReadableStream$1=class{constructor(Qe={},it={}){Qe===void 0?Qe=null:assertObject(Qe,"First parameter");const lt=convertQueuingStrategy(it,"Second parameter"),ut=convertUnderlyingDefaultOrByteSource(Qe,"First parameter");if(InitializeReadableStream(this),ut.type==="bytes"){if(lt.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");const dt=ExtractHighWaterMark(lt,0);SetUpReadableByteStreamControllerFromUnderlyingSource(this,ut,dt)}else{const dt=ExtractSizeAlgorithm(lt),xt=ExtractHighWaterMark(lt,1);SetUpReadableStreamDefaultControllerFromUnderlyingSource(this,ut,xt,dt)}}get locked(){if(!IsReadableStream(this))throw streamBrandCheckException$1("locked");return IsReadableStreamLocked(this)}cancel(Qe=void 0){return IsReadableStream(this)?IsReadableStreamLocked(this)?promiseRejectedWith(new TypeError("Cannot cancel a stream that already has a reader")):ReadableStreamCancel(this,Qe):promiseRejectedWith(streamBrandCheckException$1("cancel"))}getReader(Qe=void 0){if(!IsReadableStream(this))throw streamBrandCheckException$1("getReader");return convertReaderOptions(Qe,"First parameter").mode===void 0?AcquireReadableStreamDefaultReader(this):AcquireReadableStreamBYOBReader(this)}pipeThrough(Qe,it={}){if(!IsReadableStream(this))throw streamBrandCheckException$1("pipeThrough");assertRequiredArgument(Qe,1,"pipeThrough");const lt=convertReadableWritablePair(Qe,"First parameter"),ut=convertPipeOptions(it,"Second parameter");if(IsReadableStreamLocked(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(IsWritableStreamLocked(lt.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");const dt=ReadableStreamPipeTo(this,lt.writable,ut.preventClose,ut.preventAbort,ut.preventCancel,ut.signal);return setPromiseIsHandledToTrue(dt),lt.readable}pipeTo(Qe,it={}){if(!IsReadableStream(this))return promiseRejectedWith(streamBrandCheckException$1("pipeTo"));if(Qe===void 0)return promiseRejectedWith("Parameter 1 is required in 'pipeTo'.");if(!IsWritableStream(Qe))return promiseRejectedWith(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let lt;try{lt=convertPipeOptions(it,"Second parameter")}catch(ut){return promiseRejectedWith(ut)}return IsReadableStreamLocked(this)?promiseRejectedWith(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):IsWritableStreamLocked(Qe)?promiseRejectedWith(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):ReadableStreamPipeTo(this,Qe,lt.preventClose,lt.preventAbort,lt.preventCancel,lt.signal)}tee(){if(!IsReadableStream(this))throw streamBrandCheckException$1("tee");const Qe=ReadableStreamTee(this);return CreateArrayFromList(Qe)}values(Qe=void 0){if(!IsReadableStream(this))throw streamBrandCheckException$1("values");const it=convertIteratorOptions(Qe,"First parameter");return AcquireReadableStreamAsyncIterator(this,it.preventCancel)}};Object.defineProperties(ReadableStream$1.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(ReadableStream$1.prototype,SymbolPolyfill.toStringTag,{value:"ReadableStream",configurable:!0});typeof SymbolPolyfill.asyncIterator=="symbol"&&Object.defineProperty(ReadableStream$1.prototype,SymbolPolyfill.asyncIterator,{value:ReadableStream$1.prototype.values,writable:!0,configurable:!0});function CreateReadableStream(He,Qe,it,lt=1,ut=()=>1){const dt=Object.create(ReadableStream$1.prototype);InitializeReadableStream(dt);const xt=Object.create(ReadableStreamDefaultController.prototype);return SetUpReadableStreamDefaultController(dt,xt,He,Qe,it,lt,ut),dt}function CreateReadableByteStream(He,Qe,it){const lt=Object.create(ReadableStream$1.prototype);InitializeReadableStream(lt);const ut=Object.create(ReadableByteStreamController.prototype);return SetUpReadableByteStreamController(lt,ut,He,Qe,it,0,void 0),lt}function InitializeReadableStream(He){He._state="readable",He._reader=void 0,He._storedError=void 0,He._disturbed=!1}function IsReadableStream(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_readableStreamController")?!1:He instanceof ReadableStream$1}function IsReadableStreamLocked(He){return He._reader!==void 0}function ReadableStreamCancel(He,Qe){if(He._disturbed=!0,He._state==="closed")return promiseResolvedWith(void 0);if(He._state==="errored")return promiseRejectedWith(He._storedError);ReadableStreamClose(He);const it=He._reader;it!==void 0&&IsReadableStreamBYOBReader(it)&&(it._readIntoRequests.forEach(ut=>{ut._closeSteps(void 0)}),it._readIntoRequests=new SimpleQueue);const lt=He._readableStreamController[CancelSteps](Qe);return transformPromiseWith(lt,noop)}function ReadableStreamClose(He){He._state="closed";const Qe=He._reader;Qe!==void 0&&(defaultReaderClosedPromiseResolve(Qe),IsReadableStreamDefaultReader(Qe)&&(Qe._readRequests.forEach(it=>{it._closeSteps()}),Qe._readRequests=new SimpleQueue))}function ReadableStreamError(He,Qe){He._state="errored",He._storedError=Qe;const it=He._reader;it!==void 0&&(defaultReaderClosedPromiseReject(it,Qe),IsReadableStreamDefaultReader(it)?(it._readRequests.forEach(lt=>{lt._errorSteps(Qe)}),it._readRequests=new SimpleQueue):(it._readIntoRequests.forEach(lt=>{lt._errorSteps(Qe)}),it._readIntoRequests=new SimpleQueue))}function streamBrandCheckException$1(He){return new TypeError(`ReadableStream.prototype.${He} can only be used on a ReadableStream`)}function convertQueuingStrategyInit(He,Qe){assertDictionary(He,Qe);const it=He?.highWaterMark;return assertRequiredField(it,"highWaterMark","QueuingStrategyInit"),{highWaterMark:convertUnrestrictedDouble(it)}}const byteLengthSizeFunction=He=>He.byteLength;try{Object.defineProperty(byteLengthSizeFunction,"name",{value:"size",configurable:!0})}catch(He){}class ByteLengthQueuingStrategy{constructor(Qe){assertRequiredArgument(Qe,1,"ByteLengthQueuingStrategy"),Qe=convertQueuingStrategyInit(Qe,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=Qe.highWaterMark}get highWaterMark(){if(!IsByteLengthQueuingStrategy(this))throw byteLengthBrandCheckException("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!IsByteLengthQueuingStrategy(this))throw byteLengthBrandCheckException("size");return byteLengthSizeFunction}}Object.defineProperties(ByteLengthQueuingStrategy.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(ByteLengthQueuingStrategy.prototype,SymbolPolyfill.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function byteLengthBrandCheckException(He){return new TypeError(`ByteLengthQueuingStrategy.prototype.${He} can only be used on a ByteLengthQueuingStrategy`)}function IsByteLengthQueuingStrategy(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_byteLengthQueuingStrategyHighWaterMark")?!1:He instanceof ByteLengthQueuingStrategy}const countSizeFunction=()=>1;try{Object.defineProperty(countSizeFunction,"name",{value:"size",configurable:!0})}catch(He){}class CountQueuingStrategy{constructor(Qe){assertRequiredArgument(Qe,1,"CountQueuingStrategy"),Qe=convertQueuingStrategyInit(Qe,"First parameter"),this._countQueuingStrategyHighWaterMark=Qe.highWaterMark}get highWaterMark(){if(!IsCountQueuingStrategy(this))throw countBrandCheckException("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!IsCountQueuingStrategy(this))throw countBrandCheckException("size");return countSizeFunction}}Object.defineProperties(CountQueuingStrategy.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(CountQueuingStrategy.prototype,SymbolPolyfill.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function countBrandCheckException(He){return new TypeError(`CountQueuingStrategy.prototype.${He} can only be used on a CountQueuingStrategy`)}function IsCountQueuingStrategy(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_countQueuingStrategyHighWaterMark")?!1:He instanceof CountQueuingStrategy}function convertTransformer(He,Qe){assertDictionary(He,Qe);const it=He?.flush,lt=He?.readableType,ut=He?.start,dt=He?.transform,xt=He?.writableType;return{flush:it===void 0?void 0:convertTransformerFlushCallback(it,He,`${Qe} has member 'flush' that`),readableType:lt,start:ut===void 0?void 0:convertTransformerStartCallback(ut,He,`${Qe} has member 'start' that`),transform:dt===void 0?void 0:convertTransformerTransformCallback(dt,He,`${Qe} has member 'transform' that`),writableType:xt}}function convertTransformerFlushCallback(He,Qe,it){return assertFunction(He,it),lt=>promiseCall(He,Qe,[lt])}function convertTransformerStartCallback(He,Qe,it){return assertFunction(He,it),lt=>reflectCall(He,Qe,[lt])}function convertTransformerTransformCallback(He,Qe,it){return assertFunction(He,it),(lt,ut)=>promiseCall(He,Qe,[lt,ut])}class TransformStream{constructor(Qe={},it={},lt={}){Qe===void 0&&(Qe=null);const ut=convertQueuingStrategy(it,"Second parameter"),dt=convertQueuingStrategy(lt,"Third parameter"),xt=convertTransformer(Qe,"First parameter");if(xt.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(xt.writableType!==void 0)throw new RangeError("Invalid writableType specified");const ft=ExtractHighWaterMark(dt,0),vt=ExtractSizeAlgorithm(dt),kt=ExtractHighWaterMark(ut,1),St=ExtractSizeAlgorithm(ut);let Tt;const Mt=newPromise(Nt=>{Tt=Nt});InitializeTransformStream(this,Mt,kt,St,ft,vt),SetUpTransformStreamDefaultControllerFromTransformer(this,xt),xt.start!==void 0?Tt(xt.start(this._transformStreamController)):Tt(void 0)}get readable(){if(!IsTransformStream(this))throw streamBrandCheckException("readable");return this._readable}get writable(){if(!IsTransformStream(this))throw streamBrandCheckException("writable");return this._writable}}Object.defineProperties(TransformStream.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(TransformStream.prototype,SymbolPolyfill.toStringTag,{value:"TransformStream",configurable:!0});function InitializeTransformStream(He,Qe,it,lt,ut,dt){function xt(){return Qe}function ft(Mt){return TransformStreamDefaultSinkWriteAlgorithm(He,Mt)}function vt(Mt){return TransformStreamDefaultSinkAbortAlgorithm(He,Mt)}function kt(){return TransformStreamDefaultSinkCloseAlgorithm(He)}He._writable=CreateWritableStream(xt,ft,kt,vt,it,lt);function St(){return TransformStreamDefaultSourcePullAlgorithm(He)}function Tt(Mt){return TransformStreamErrorWritableAndUnblockWrite(He,Mt),promiseResolvedWith(void 0)}He._readable=CreateReadableStream(xt,St,Tt,ut,dt),He._backpressure=void 0,He._backpressureChangePromise=void 0,He._backpressureChangePromise_resolve=void 0,TransformStreamSetBackpressure(He,!0),He._transformStreamController=void 0}function IsTransformStream(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_transformStreamController")?!1:He instanceof TransformStream}function TransformStreamError(He,Qe){ReadableStreamDefaultControllerError(He._readable._readableStreamController,Qe),TransformStreamErrorWritableAndUnblockWrite(He,Qe)}function TransformStreamErrorWritableAndUnblockWrite(He,Qe){TransformStreamDefaultControllerClearAlgorithms(He._transformStreamController),WritableStreamDefaultControllerErrorIfNeeded(He._writable._writableStreamController,Qe),He._backpressure&&TransformStreamSetBackpressure(He,!1)}function TransformStreamSetBackpressure(He,Qe){He._backpressureChangePromise!==void 0&&He._backpressureChangePromise_resolve(),He._backpressureChangePromise=newPromise(it=>{He._backpressureChangePromise_resolve=it}),He._backpressure=Qe}class TransformStreamDefaultController{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!IsTransformStreamDefaultController(this))throw defaultControllerBrandCheckException("desiredSize");const Qe=this._controlledTransformStream._readable._readableStreamController;return ReadableStreamDefaultControllerGetDesiredSize(Qe)}enqueue(Qe=void 0){if(!IsTransformStreamDefaultController(this))throw defaultControllerBrandCheckException("enqueue");TransformStreamDefaultControllerEnqueue(this,Qe)}error(Qe=void 0){if(!IsTransformStreamDefaultController(this))throw defaultControllerBrandCheckException("error");TransformStreamDefaultControllerError(this,Qe)}terminate(){if(!IsTransformStreamDefaultController(this))throw defaultControllerBrandCheckException("terminate");TransformStreamDefaultControllerTerminate(this)}}Object.defineProperties(TransformStreamDefaultController.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}});typeof SymbolPolyfill.toStringTag=="symbol"&&Object.defineProperty(TransformStreamDefaultController.prototype,SymbolPolyfill.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function IsTransformStreamDefaultController(He){return!typeIsObject(He)||!Object.prototype.hasOwnProperty.call(He,"_controlledTransformStream")?!1:He instanceof TransformStreamDefaultController}function SetUpTransformStreamDefaultController(He,Qe,it,lt){Qe._controlledTransformStream=He,He._transformStreamController=Qe,Qe._transformAlgorithm=it,Qe._flushAlgorithm=lt}function SetUpTransformStreamDefaultControllerFromTransformer(He,Qe){const it=Object.create(TransformStreamDefaultController.prototype);let lt=dt=>{try{return TransformStreamDefaultControllerEnqueue(it,dt),promiseResolvedWith(void 0)}catch(xt){return promiseRejectedWith(xt)}},ut=()=>promiseResolvedWith(void 0);Qe.transform!==void 0&&(lt=dt=>Qe.transform(dt,it)),Qe.flush!==void 0&&(ut=()=>Qe.flush(it)),SetUpTransformStreamDefaultController(He,it,lt,ut)}function TransformStreamDefaultControllerClearAlgorithms(He){He._transformAlgorithm=void 0,He._flushAlgorithm=void 0}function TransformStreamDefaultControllerEnqueue(He,Qe){const it=He._controlledTransformStream,lt=it._readable._readableStreamController;if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(lt))throw new TypeError("Readable side is not in a state that permits enqueue");try{ReadableStreamDefaultControllerEnqueue(lt,Qe)}catch(dt){throw TransformStreamErrorWritableAndUnblockWrite(it,dt),it._readable._storedError}ReadableStreamDefaultControllerHasBackpressure(lt)!==it._backpressure&&TransformStreamSetBackpressure(it,!0)}function TransformStreamDefaultControllerError(He,Qe){TransformStreamError(He._controlledTransformStream,Qe)}function TransformStreamDefaultControllerPerformTransform(He,Qe){const it=He._transformAlgorithm(Qe);return transformPromiseWith(it,void 0,lt=>{throw TransformStreamError(He._controlledTransformStream,lt),lt})}function TransformStreamDefaultControllerTerminate(He){const Qe=He._controlledTransformStream,it=Qe._readable._readableStreamController;ReadableStreamDefaultControllerClose(it);const lt=new TypeError("TransformStream terminated");TransformStreamErrorWritableAndUnblockWrite(Qe,lt)}function TransformStreamDefaultSinkWriteAlgorithm(He,Qe){const it=He._transformStreamController;if(He._backpressure){const lt=He._backpressureChangePromise;return transformPromiseWith(lt,()=>{const ut=He._writable;if(ut._state==="erroring")throw ut._storedError;return TransformStreamDefaultControllerPerformTransform(it,Qe)})}return TransformStreamDefaultControllerPerformTransform(it,Qe)}function TransformStreamDefaultSinkAbortAlgorithm(He,Qe){return TransformStreamError(He,Qe),promiseResolvedWith(void 0)}function TransformStreamDefaultSinkCloseAlgorithm(He){const Qe=He._readable,it=He._transformStreamController,lt=it._flushAlgorithm();return TransformStreamDefaultControllerClearAlgorithms(it),transformPromiseWith(lt,()=>{if(Qe._state==="errored")throw Qe._storedError;ReadableStreamDefaultControllerClose(Qe._readableStreamController)},ut=>{throw TransformStreamError(He,ut),Qe._storedError})}function TransformStreamDefaultSourcePullAlgorithm(He){return TransformStreamSetBackpressure(He,!1),He._backpressureChangePromise}function defaultControllerBrandCheckException(He){return new TypeError(`TransformStreamDefaultController.prototype.${He} can only be used on a TransformStreamDefaultController`)}function streamBrandCheckException(He){return new TypeError(`TransformStream.prototype.${He} can only be used on a TransformStream`)}const exports$1={ReadableStream:ReadableStream$1,ReadableStreamDefaultController,ReadableByteStreamController,ReadableStreamBYOBRequest,ReadableStreamDefaultReader,ReadableStreamBYOBReader,WritableStream,WritableStreamDefaultController,WritableStreamDefaultWriter,ByteLengthQueuingStrategy,CountQueuingStrategy,TransformStream,TransformStreamDefaultController};if(typeof globals<"u")for(const He in exports$1)Object.prototype.hasOwnProperty.call(exports$1,He)&&Object.defineProperty(globals,He,{value:exports$1[He],writable:!0,configurable:!0});const useListFiles=modifyQueryHook(createQueryHook(ListFilesDocument),{reduce:He=>He?.files}),useGetFile=modifyQueryHook(createQueryHook(GetFileDocument),{transform:He=>({id:He}),reduce:He=>He?.fileUploadRecord}),useGetFileStatistics=modifyQueryHook(createQueryHook(GetFileStatisticsDocument),{reduce:He=>He?.fileStatistics}),[useDeleteFile,executeDeleteFile]=createMutationHelper(DeleteFileDocument),[useUploadFileMultiPart,executeUploadFileMultiPart]=createMutationHelper(UploadFileMultiPartDocument),CHUNK_SIZE=5*1024*1024,base64encode=He=>btoa(String.fromCharCode(...He));function blobToReadableStream(He){const Qe=He.stream().getReader();return new ReadableStream({start(it){function lt(){Qe.read().then(({done:ut,value:dt})=>{if(ut){it.close();return}it.enqueue(dt),lt()})}lt()}})}const sha256=async(He,Qe)=>{const it=blobToReadableStream(He),lt=new build$1.Sha256;for await(const dt of it){if(Qe?.abortSignal?.aborted)throw new Error("Hash aborted");lt.update(dt)}const ut=await lt.digest();return base64encode(ut)};async function uploadFileMultiPart(He,Qe,it){if(it?.abortSignal?.aborted)throw new Error("Aborted");const{name:lt,type:ut,size:dt}=He,xt={fileSize:0,filename:lt,fileType:ut},vt=(await executeUploadFileMultiPart({step:UploadMultiPartStep.Init,input:{fileMeta:xt,hash:Qe,scope:it?.scope}},{context:{headers:{checksum:"v2"}}})).data?.uploadFileMultiPart,{uploadId:kt,exists:St}=vt??{};if(!kt)throw new Error("uploadId invalid");if(St)return vt;let Tt=0;const Mt=Math.ceil(dt/CHUNK_SIZE),Nt=Array.from(Array(Mt).fill(""),(Dt,Ft)=>Ft+1),At=async Dt=>{const Ft=He.slice((Dt-1)*CHUNK_SIZE,Dt===Nt.length?dt:Dt*CHUNK_SIZE),Bt=await sha256(Ft),Ot=await executeUploadFileMultiPart({step:UploadMultiPartStep.UploadPart,input:{fileMeta:xt,uploadId:kt,partNumber:Dt,hash:Bt}}),{uploadUrl:Qt}=Ot.data?.uploadFileMultiPart??{};if(!Qt)throw new Error("uploadUrl invalid");const Wt=await axios.put(Qt,Ft,{headers:{"x-amz-checksum-sha256":Bt},signal:it?.abortSignal,responseType:"text",onUploadProgress(Kt){it?.abortSignal?.aborted||(Tt+=Kt.bytes,it?.onProgress?.((Tt-1)/dt))}});if(Wt.status>299)throw console.error("upload failed",Wt.data),new Error("Upload failed: "+Wt.status);const Xt=Wt.headers.etag;if(!Xt)throw new Error("ETag invalid");return{eTag:Xt.replaceAll('"',""),partNumber:Dt,hash:Bt}},$t=await index.mapLimit(Nt,5,async Dt=>await index.retry({times:5,interval(Bt){return 50*Math.pow(2,Bt)},errorFilter(Bt){return axios.isAxiosError(Bt)&&Bt instanceof CanceledError?!1:axios.isAxiosError(Bt)&&Bt.response?.status!==400}},async()=>await At(Dt)));return await executeUploadFileMultiPart({step:UploadMultiPartStep.Complete,input:{fileMeta:xt,parts:$t,uploadId:kt,hash:Qe}}),{uploadId:kt}}const fluentDocumentEdit20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M11.5 8H16v-.586a1.5 1.5 0 0 0-.057-.41L15.942 7a1.5 1.5 0 0 0-.381-.646l-3.915-3.915A1.5 1.5 0 0 0 10.586 2H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h2.221l-.013-.026A1.86 1.86 0 0 1 8.003 17H6a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h4v3.5A1.5 1.5 0 0 0 11.5 8m0-1a.5.5 0 0 1-.5-.5V3.207L14.793 7zm3.31 2.548a1.87 1.87 0 1 1 2.644 2.645l-4.83 4.829a2.2 2.2 0 0 1-1.02.578l-1.498.374a.89.89 0 0 1-1.079-1.078l.375-1.498a2.2 2.2 0 0 1 .578-1.02z"})}),fluentDocumentProhibited20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M4 4a2 2 0 0 1 2-2h4.586a1.5 1.5 0 0 1 1.06.44l3.915 3.914A1.5 1.5 0 0 1 16 7.414V16a2 2 0 0 1-2 2H9.743q.381-.462.657-1H14a1 1 0 0 0 1-1V8h-3.5A1.5 1.5 0 0 1 10 6.5V3H6a1 1 0 0 0-1 1v5.022a5.5 5.5 0 0 0-1 .185zm7-.793V6.5a.5.5 0 0 0 .5.5h3.293zM8.682 17.682a4.5 4.5 0 1 1-6.364-6.364a4.5 4.5 0 0 1 6.364 6.364m-5.278-.379a3.5 3.5 0 0 0 4.9-4.9zm-.707-.707l4.9-4.9a3.5 3.5 0 0 0-4.9 4.9"})}),fluentImageArrowCounterclockwise20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M5.5 10a4.5 4.5 0 1 0 0-9a4.5 4.5 0 0 0 0 9m-2-5h-.005A.5.5 0 0 1 3 4.372V3a.5.5 0 0 1 1 0v.195a2.75 2.75 0 1 1-.55 4.139a.5.5 0 0 1 .745-.667A1.75 1.75 0 1 0 4.597 4H5a.5.5 0 0 1 0 1zM3 10.4q.476.244 1 .393V14c0 .373.102.722.28 1.02l4.669-4.588a1.5 1.5 0 0 1 2.102 0l4.67 4.588A2 2 0 0 0 16 14V6a2 2 0 0 0-2-2h-3.207a5.5 5.5 0 0 0-.393-1H14a3 3 0 0 1 3 3v8a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3zm11-2.9a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m-1 0a.5.5 0 1 0-1 0a.5.5 0 0 0 1 0m-8.012 8.226A2 2 0 0 0 6 16h8c.37 0 .715-.1 1.012-.274l-4.662-4.58a.5.5 0 0 0-.7 0z"})}),icBaselineCheckCircle=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5l1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),icOutlineAddPhotoAlternate=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M18 20H4V6h9V4H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-9h-2v9zm-7.79-3.17l-1.96-2.36L5.5 18h11l-3.54-4.71zM20 4V1h-2v3h-3c.01.01 0 2 0 2h3v2.99c.01.01 2 0 2 0V6h3V4h-3z"})}),icRoundPlus=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M18 12.998h-5v5a1 1 0 0 1-2 0v-5H6a1 1 0 0 1 0-2h5v-5a1 1 0 0 1 2 0v5h5a1 1 0 0 1 0 2z"})}),NotLogin=()=>{const He=useLocation(),it=`/login?to=${He.pathname+He.search+He.hash}`;return jsxRuntimeExports.jsx(Navigate,{to:it,replace:!0})},icBaselineAddPhotoAlternate=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 7v2.99s-1.99.01-2 0V7h-3s.01-1.99 0-2h3V2h2v3h3v2h-3zm-3 4V8h-3V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8h-3zM5 19l3-4l2 3l3-4l4 5H5z"})}),icBaselinePlaylistAdd=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M14 10H3v2h11v-2zm0-4H3v2h11V6zm4 8v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zM3 16h7v-2H3v2z"})});function ClaimDialog(He){const[Qe,it]=reactExports.useState(""),{modelId:lt,onComplete:ut}=He,{t:dt}=useTranslation(["market"]),[xt,ft]=reactExports.useState([]),[vt,kt]=reactExports.useState(!1),{data:St,loading:Tt}=useUserInfo();useNavigate();const[Mt,Nt]=useLoadingCallback(async $t=>{try{const Dt=await client.report({refId:lt,refType:RefType.Model,reason:ReportReason.ClaimModel,extra:{mediaIds:xt.map(Ft=>Ft.id),statement:$t}});toast.success(dt("market:model.claim.notice.submit-success")),ut?.()}catch(Dt){toast.error(dt("market:model.claim.notice.submit-failed")+", "+Dt.message)}},[xt,lt]);if(!St)return Tt?jsxRuntimeExports.jsx(LoadingIcon,{}):jsxRuntimeExports.jsx(NotLogin,{});const At=($t,Dt)=>ft(!$t&&Dt?Ft=>[...Ft,Dt]:Ft=>{const Bt=Ft.findIndex(Qt=>Qt.id===$t),Ot=[...Ft];return Dt?Ot.splice(Bt,1,Dt):Ot.splice(Bt,1),Ot});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{className:"[&>h2]:flex [&>h2]:gap-2 [&>h2]:items-center",heading:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(icBaselinePlaylistAdd,{className:"size-6"}),dt("market:model.claim.claim-model")]})}),jsxRuntimeExports.jsxs(UIDialogContent,{className:"pt-2",children:[jsxRuntimeExports.jsxs("form",{onSubmit:$t=>{$t.preventDefault(),Nt(Qe)},className:"flex flex-col",action:"",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center",children:[jsxRuntimeExports.jsxs("div",{className:"inline-flex gap-2 shrink-0",children:[xt.map($t=>jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(UploadImage,{className:"!w-[100px] !h-[100px] !text-xs",value:$t,onChange:Dt=>At($t.id,Dt),onUpload:kt},$t.id),jsxRuntimeExports.jsx(IconButton,{onClick:()=>At($t.id),size:"small",className:"absolute right-0 top-0 translate-x-2 -translate-y-2 bg-white",children:jsxRuntimeExports.jsx(icBaselineClose,{className:"text-sm"})})]},$t.id)),xt.length<4&&jsxRuntimeExports.jsx(UploadImage,{className:"!w-[100px] !h-[100px] !text-xs",value:void 0,onChange:$t=>At(void 0,$t),onUpload:kt,placeholderElement:jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(icBaselineAddPhotoAlternate,{className:"size-6"})})})]}),xt.length<2&&jsxRuntimeExports.jsx("p",{className:"text-sm shrink-1",children:dt("market:model.claim.claim-description")})]}),jsxRuntimeExports.jsx(OutlinedInput,{className:"mt-4 w-full",multiline:!0,minRows:3,maxRows:6,placeholder:dt("market:model.claim.claim-placeholder"),value:Qe,onChange:$t=>it($t.target.value),inputProps:{maxLength:2e3},required:!0}),jsxRuntimeExports.jsx(UIButton$1,{size:"large",variant:"filled",type:"submit",busy:Mt,disabled:vt,className:"ml-auto my-4",children:jsxRuntimeExports.jsx("span",{children:dt("market:model.claim.submit-claim")})})]}),jsxRuntimeExports.jsx(Divider,{children:"or"}),jsxRuntimeExports.jsxs("div",{className:"flex font-semibold text-xl items-center gap-2 mb-2 mt-2",children:[jsxRuntimeExports.jsx(icBaselinePersonAddAlt,{}),jsxRuntimeExports.jsx("p",{children:dt("market:model.claim.invite-to-claim")})]}),jsxRuntimeExports.jsx(ItemShareLink,{className:"w-full",link:getModelShareLink(lt)})]})]})}const dialogClaim=He=>UIDialog.create({dismissable:!0,children:({close:Qe})=>jsxRuntimeExports.jsx(ClaimDialog,{modelId:He,onComplete:()=>{Qe()}})}),icBaselineEdit=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83l3.75 3.75l1.83-1.83z"})});function ModelEditRequestDialog({modelId:He,onComplete:Qe,previouslyFilledValues:it}){const{t:lt}=useTranslation(["market","action"]),{values:ut,handleChange:dt,setValues:xt}=useForm$1({title:"",mediaId:"",extra:{description:"",triggerWords:""}}),ft=reactExports.useRef(!1),[vt,kt]=reactExports.useState(!1),[St,Tt]=reactExports.useState(),{data:Mt,isValidating:Nt}=useGenerationModel(He),{data:At,loading:$t}=useUserInfo(),[Dt,Ft]=useLoadingCallback(async()=>{try{await client.report({refId:He,refType:RefType.Model,reason:ReportReason.RequestEditModel,extra:{requestEditContent:omitBy(ut,Bt=>Bt==="")}}),toast.success(lt("market:model.request-edit.notice.submit-success")),Qe?.()}catch(Bt){toast.error(lt("market:model.request-edit.notice.submit-failed")+", "+Bt.message)}},[ut,He]);return reactExports.useEffect(()=>{Mt&&!ft.current&&(xt({title:Mt.title,mediaId:Mt.mediaId,extra:{description:Mt.extra?.description,triggerWords:Mt.extra?.triggerWords}}),ft.current=!0)},[Mt]),Nt&&!Mt||$t&&!At?jsxRuntimeExports.jsx("div",{className:"py-12 w-full flex justify-center",children:jsxRuntimeExports.jsx(LoadingIcon,{})}):!At&&!$t?jsxRuntimeExports.jsx(NotLogin,{}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{className:"[&>h2]:flex [&>h2]:items-center [&>h2]:gap-2",heading:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(icBaselineEdit,{className:"size-6"})," ",lt("market:model.request-edit.request-edit")]})}),jsxRuntimeExports.jsxs(UIDialogContent,{children:[it&&jsxRuntimeExports.jsxs("div",{className:"text-neutral-800 dark:text-neutral-300 border border-solid border-slate-300 p-4 rounded-lg mb-4",children:[jsxRuntimeExports.jsx("h1",{className:"font-bold text-lg mb-2",children:lt("market:model.request-edit.previously-filled.title")}),jsxRuntimeExports.jsx("p",{children:lt("market:model.request-edit.previously-filled.description")}),jsxRuntimeExports.jsxs("div",{className:"mt-2 space-x-2",children:[jsxRuntimeExports.jsx(Button,{component:Link,to:`/model/${He}`,variant:"contained",onClick:()=>Qe?.(),children:lt("market:submit.file-exists.go")}),jsxRuntimeExports.jsx(Button,{variant:"contained",onClick:()=>{dialogClaim(He)},children:lt("market:model.claim.claim-this-model")})]}),jsxRuntimeExports.jsx(Divider,{className:"my-4"}),jsxRuntimeExports.jsx("ul",{className:"space-y-2 mt-2",children:[{key:"title",label:lt("market:submit.model-form.name"),value:it.title},{key:"extra.description",label:lt("market:model.description.title"),value:it.extra?.description},{key:"extra.triggerWords",label:lt("market:model.trigger-words"),value:it.extra?.triggerWords}].filter(Bt=>!!Bt.value).map(({key:Bt,label:Ot,value:Qt})=>jsxRuntimeExports.jsxs("li",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Button,{variant:"outlined",size:"small",onClick:()=>dt(Bt)(Qt),disabled:Dt,className:"whitespace-nowrap",children:lt("market:model.request-edit.previously-filled.use")})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("span",{className:"font-bold",children:[Ot,": "]}),jsxRuntimeExports.jsx("span",{children:Qt})]})]},Bt))})]}),jsxRuntimeExports.jsxs("form",{className:"flex flex-col",onSubmit:Bt=>{Bt.preventDefault(),Ft()},action:"",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start",children:[jsxRuntimeExports.jsx("div",{className:"flex md:w-1/3 justify-center w-full",children:jsxRuntimeExports.jsx(UploadImage,{value:St||Mt?.media,onChange:Bt=>{Tt(Bt),xt(Ot=>({...Ot,mediaId:Bt?.id}))},onUpload:kt})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4 grow w-full",children:[jsxRuntimeExports.jsx(TextField,{label:lt("market:submit.model-form.name"),value:ut.title,onChange:dt("title")}),jsxRuntimeExports.jsx(TextField,{label:lt("market:model.description.title"),value:ut.extra?.description,onChange:dt("extra.description"),multiline:!0,rows:3}),jsxRuntimeExports.jsx(TextField,{label:lt("market:model.trigger-words"),value:ut.extra?.triggerWords,onChange:dt("extra.triggerWords")})]})]}),jsxRuntimeExports.jsx(UIButton$1,{size:"large",variant:"filled",type:"submit",busy:Dt,disabled:vt,className:"mx-auto my-4 font-bold self-center",children:jsxRuntimeExports.jsx("span",{children:lt("market:model.request-edit.submit")})})]})]})]})}const dialogModelRequestEdit=(He,Qe)=>UIDialog.create({dismissable:!0,children:({close:it})=>jsxRuntimeExports.jsx(ModelEditRequestDialog,{modelId:He,previouslyFilledValues:Qe,onComplete:()=>{it()}}),className:"max-w-screen-mlg"}),[ModelUploadContext,ModelUploadContextProvider]=createCtx({step:0});ModelUploadContext.displayName="ModelUploadContext";const ExternalModelImporterContext=reactExports.createContext({});function ExternalModelImporterProvider(He){const Qe=useExternalModelHelpers();return jsxRuntimeExports.jsx(ExternalModelImporterContext.Provider,{value:Qe,children:He.children})}function gcd(He,Qe){let it=He,lt=Qe;for(;lt;)[it,lt]=[lt,it%lt];return it}function getRatioOfTwoNumbers(He,Qe,it){const lt=gcd(He,Qe),ut=`${He/lt}:${Qe/lt}`;return it?.replacements&&it.replacements?.[ut]!=null?it.replacements[ut]:ut}const samplingMethodChoices=["Euler a","Euler","LMS","Heun","DPM2 Karras","DPM2 a Karras","DDIM","DPM++ 2M Karras","DPM++ SDE Karras"],PRESET_SIZES_SDV1=[[512,1024],[768,512],[768,768],[768,1024],[1024,1024],[1280,960],[960,1280]].sort((He,Qe)=>He[0]-Qe[0]||He[1]-Qe[1]),PRESET_SIZES_SDXL=[[768,1280],[1024,1024],[896,1152],[1280,768]].sort((He,Qe)=>He[0]-Qe[0]||He[1]-Qe[1]),PRESET_SIZES_DITV1=PRESET_SIZES_SDXL,PRESET_SIZES_SDV1_FOR_MEMBER=[[1472,832],[1344,896],[1400,1400],[896,1344],[832,1472]],PRESET_SIZES_SDXL_FOR_MEMBER=PRESET_SIZES_SDV1_FOR_MEMBER,PRESET_SIZES_DITV1_FOR_MEMBER=[[1472,832],[1344,896],[1392,1392],[896,1344],[832,1472]],RATIO_LABEL_REPLACEMENTS={"23:13":"16:9","13:23":"9:16"},PRESET_SIZES=[...PRESET_SIZES_SDV1.map(He=>sizeMapFn(He,{modelType:GenerationModelType.SdV1Model})),...PRESET_SIZES_SDV1_FOR_MEMBER.map(He=>sizeMapFn(He,{modelType:GenerationModelType.SdV1Model,memberOnly:!0})),...PRESET_SIZES_SDXL.map(He=>sizeMapFn(He,{modelType:GenerationModelType.SdxlModel})),...PRESET_SIZES_SDXL_FOR_MEMBER.map(He=>sizeMapFn(He,{modelType:GenerationModelType.SdxlModel,memberOnly:!0})),...PRESET_SIZES_DITV1.map(He=>sizeMapFn(He,{modelType:GenerationModelType.Dit7Model})),...PRESET_SIZES_DITV1_FOR_MEMBER.map(He=>sizeMapFn(He,{modelType:GenerationModelType.Dit7Model,memberOnly:!0}))],SIDEBAR_SIZES_SD=[[512,768,{memberOnly:!1}],[512,512,{memberOnly:!1}],[896,1344,{memberOnly:!0}]],SIDEBAR_SIZES_SDXL=[[768,1280,{memberOnly:!1}],[1024,1024,{memberOnly:!1}],[832,1472,{memberOnly:!0}]],SIDEBAR_SIZES_DITV1=SIDEBAR_SIZES_SDXL,SIDEBAR_SIZES=[...SIDEBAR_SIZES_SD.map(He=>sizeMapFn(He,{modelType:GenerationModelType.SdV1Model})),...SIDEBAR_SIZES_SDXL.map(He=>sizeMapFn(He,{modelType:GenerationModelType.SdxlModel})),...SIDEBAR_SIZES_DITV1.map(He=>sizeMapFn(He,{modelType:GenerationModelType.Dit7Model}))];function sizeMapFn(He,Qe){const[it,lt,ut]=He;return{width:it,height:lt,extraProps:{memberOnly:Qe.memberOnly,modelType:Qe.modelType,label:getRatioOfTwoNumbers(it,lt,{replacements:RATIO_LABEL_REPLACEMENTS}),...ut}}}const defaultTaskFormValues={width:512,height:768,batchSize:4,negativePrompts:"nsfw, lowres, bad anatomy, bad hands, text, error, missing fingers, extra digit, fewer digits, cropped, worst quality, low quality, normal quality, jpeg artifacts, signature, watermark, username, blurry",samplingSteps:28,samplingMethod:"Euler a",cfgScale:11,strength:.55,enlargeModel:"R-ESRGAN 4x+ Anime6B"},DEFAULT_SAMPLING_METHOD_IF_EMPTY="DPM++ 2M Karras",TASK_PRIORITIES={default:1e3,turboMode:500,low:0},DEFAULT_CLIPSKIP_VAL_FOR_SDV1=2,DEFAULT_CLIPSKIP_VAL_FOR_NON_SDV1=2,DEFAULT_SAMPLING_STEPS=20,ModelFormSubmitContext=reactExports.createContext({loading:!1,submit:()=>{},values:{},handleChange:createHandleChange(),getValues:()=>{},setValues:()=>{}});ModelFormSubmitContext.displayName="ModelFormSubmitContext";const useModelSubmitForm=()=>reactExports.useContext(ModelFormSubmitContext),modelSamplingDiscreteSamplingTypes=["eps","v_prediction","lcm","x0"],defaultValue={extra:{permissions:{shareImagesOnline:!0,personalUses:!0,commercialUses:!1,shouldCreditAuthor:!1}}};function ModelSubmitFormProvider(He){const{t:Qe}=useTranslation(["market"]),it=useForm$1(He.initialValues??defaultValue),{values:lt,getValues:ut,setValues:dt,handleChange:xt}=it,{url:ft}=reactExports.useContext(ExternalModelImporterContext),[vt,kt]=useLoadingCallback(async()=>{const Tt=lt,Mt=getCreateModelInputs(Qe,Tt),Nt=await client.upsertGenerationModel({id:lt.modelId,input:Mt});return Nt.upsertGenerationModel&&mutateGenerationModel(Nt.upsertGenerationModel.id,Nt.upsertGenerationModel,!1),track("submit_model_success",{...getSubmitModelTrackAttrs({values:Tt}),url:ft}),Nt},[ft,lt]),St=reactExports.useMemo(()=>({loading:vt,submit:kt,...it}),[vt,kt,it]);return jsxRuntimeExports.jsx(ModelFormSubmitContext.Provider,{value:St,children:He.children})}const sliderStyles=ce$1({base:"orientation-horizontal:grid orientation-vertical:flex grid-cols-[1fr_auto] flex-col items-center gap-2"}),sliderOutputStyles=ce$1({base:"text-sm  font-medium orientation-vertical:hidden"}),trackStyles=ce$1({base:"absolute top-[50%] translate-y-[-50%] w-full rounded-full",variants:{variant:{"half-filled":"h-[3px] dark:bg-neutral-400/50 bg-neutral-500/50 "}}}),trackFilledStyles=ce$1({base:"absolute top-[50%] translate-y-[-50%] rounded-full",variants:{variant:{"half-filled":"h-[3px] bg-neutral-800 dark:bg-neutral-50 w-[--thumb-percent]"}}}),thumbStyles=ce$1({base:"group-orientation-horizontal:mt-4 group-orientation-vertical:ml-3 rounded-full",variants:{variant:{"half-filled":"size-4 border-[3px] border-neutral-800 dark:border-neutral-50 bg-neutral-800 dark:bg-neutral-50 group-orientation-horizontal:mt-4 cursor-pointer"}}});function UISlider({label:He,sliderOutputProps:Qe,sliderThumbProps:it,variant:lt,...ut}){return jsxRuntimeExports.jsxs($6f909507e6374d18$export$472062a354075cee,{...ut,className:$64fa3d84918910a7$export$c245e6201fed2f75(ut.className,(dt,xt)=>sliderStyles({...xt,className:dt})),children:[He&&jsxRuntimeExports.jsx($01b77f81d0f07f68$export$b04be29aa201d4f5,{...ut.labelProps,children:He}),jsxRuntimeExports.jsx($6f909507e6374d18$export$a590f758a961cb5b,{...Qe,className:$64fa3d84918910a7$export$c245e6201fed2f75(Qe?.className,(dt,xt)=>sliderOutputStyles({...xt,className:dt})),children:Qe?.children??(({state:dt})=>dt.values.map((xt,ft)=>dt.getThumbValueLabel(ft)).join(" – "))}),jsxRuntimeExports.jsx($6f909507e6374d18$export$105594979f116971,{className:"group col-span-2 orientation-horizontal:h-6 orientation-vertical:w-6 orientation-vertical:h-64 flex items-center",children:({state:dt,...xt})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:trackStyles({...xt,variant:lt})}),jsxRuntimeExports.jsx("div",{className:trackFilledStyles({...xt,variant:lt}),style:{"--thumb-percent":dt.getThumbPercent(0)*100+"%"}}),dt.values.map((ft,vt)=>jsxRuntimeExports.jsx($6f909507e6374d18$export$2c1b491743890dec,{index:vt,className:thumbStyles({...xt,variant:lt}),...it},vt))]})})]})}function ValueSliderWithInput({min:He,max:Qe,step:it,value:lt,onChange:ut,sliderClassName:dt,disabled:xt,className:ft,isInteger:vt}){const[kt,St]=reactExports.useState(lt);reactExports.useEffect(()=>{St(lt)},[lt]);function Tt(){let Mt=clamp$1(Number(kt),He,Qe);vt&&(Mt=Math.round(Mt)),ut?.(Mt)}return jsxRuntimeExports.jsxs("div",{className:twMerge("flex gap-8",ft),children:[jsxRuntimeExports.jsx(Slider,{disabled:xt,className:dt,value:lt,onChange:(Mt,Nt)=>{ut?.(Nt)},min:He,max:Qe,step:it,valueLabelDisplay:"auto"}),jsxRuntimeExports.jsx(Input,{disabled:xt,type:"number",className:"w-[60px]",value:kt,onChange:Mt=>{Mt.target.focus(),St(Number(Mt.target.value))},onBlur:Tt,inputProps:{min:He,max:Qe}})]})}function ValueInputWithRange({min:He,max:Qe,value:it,onChange:lt,disabled:ut}){const[dt,xt]=reactExports.useState(String(it));reactExports.useEffect(()=>{xt(String(it))},[it]);function ft(){const vt=clamp$1(Number(dt),He,Qe);lt?.(vt)}return jsxRuntimeExports.jsx(UIInput,{variant:"rounded-normal",inputMode:"numeric",onChange:vt=>xt(vt.target.value),onBlur:ft,value:dt,className:"w-full rounded-[10px]",disabled:ut})}const modelSamplingTypes=["ModelSamplingDiscrete","ModelSamplingSD3","ModelSamplingFlux"],defaultModelSampings={ModelSamplingDiscrete:{type:"ModelSamplingDiscrete",inputs:{sampling:"eps",zsnr:!1}},ModelSamplingSD3:{type:"ModelSamplingSD3",inputs:{shift:3}},ModelSamplingFlux:{type:"ModelSamplingFlux",inputs:{max_shift:1.15,base_shift:.5,width:1024,height:1024}}};function ModelSamplingTypeSelect({value:He,onChange:Qe,disabled:it}){const lt=reactExports.useCallback(ut=>{Qe?.(defaultModelSampings[ut.target.value])},[Qe]);return jsxRuntimeExports.jsx(FormControl,{fullWidth:!0,children:jsxRuntimeExports.jsx(Select,{disabled:it,size:"small",value:He?.type,onChange:lt,children:modelSamplingTypes.map(ut=>jsxRuntimeExports.jsx(MenuItem$1,{value:ut,children:ut},ut))})})}function ModelSamplingDiscreteControl({value:He,onChange:Qe,disabled:it}){const{t:lt}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"flex gap-2 items-center",children:jsxRuntimeExports.jsx("h2",{className:"text-[14px]",children:lt("generation:model-sampling-discrete.sampling.label")})}),jsxRuntimeExports.jsx(FormControl,{fullWidth:!0,children:jsxRuntimeExports.jsx(Select,{disabled:it,size:"small",value:He?.inputs.sampling,onChange:ut=>{He&&Qe?.({...He,inputs:{...He.inputs,sampling:ut.target.value}})},children:modelSamplingDiscreteSamplingTypes.map(ut=>jsxRuntimeExports.jsx(MenuItem$1,{value:ut,children:ut},ut))})}),jsxRuntimeExports.jsx(FormControl,{children:jsxRuntimeExports.jsx(FormControlLabel,{control:jsxRuntimeExports.jsx(Checkbox,{checked:He?.inputs.zsnr,onChange:(ut,dt)=>{He&&Qe?.({...He,inputs:{...He.inputs,zsnr:dt}})}}),disabled:it,label:lt("generation:model-sampling-discrete.zsnr.label"),labelPlacement:"start"})})]})}const MIN_SHIFT=0,MAX_SHIFT=100,SHIFT_STEP=.1;function ModelSamplingSD3Control({value:He,onChange:Qe,disabled:it}){const{t:lt}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"flex gap-2 items-center",children:jsxRuntimeExports.jsx("h2",{className:"text-[14px]",children:lt("generation:model-sampling-sd3.shift.label")})}),jsxRuntimeExports.jsx(ValueSliderWithInput,{className:"w-full",min:MIN_SHIFT,max:MAX_SHIFT,step:SHIFT_STEP,value:He?.inputs.shift,onChange:ut=>{He&&Qe?.({...He,inputs:{...He?.inputs,shift:ut}})},disabled:it})]})}const MIN_RESOLUTION=16,MAX_RESOLUTION=16384;function ModelSamplingFluxControl({value:He,onChange:Qe,disabled:it}){const{t:lt}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"flex gap-2 items-center",children:jsxRuntimeExports.jsx("h2",{className:"text-[14px]",children:lt("generation:model-sampling-flux.max-shift.label")})}),jsxRuntimeExports.jsx(ValueSliderWithInput,{className:"w-full",min:MIN_SHIFT,max:MAX_SHIFT,step:SHIFT_STEP,value:He?.inputs.max_shift,onChange:ut=>{He&&Qe?.({...He,inputs:{...He?.inputs,max_shift:ut}})},disabled:it}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 items-center",children:jsxRuntimeExports.jsx("h2",{className:"text-[14px]",children:lt("generation:model-sampling-flux.base-shift.label")})}),jsxRuntimeExports.jsx(ValueSliderWithInput,{className:"w-full",min:MIN_SHIFT,max:MAX_SHIFT,step:SHIFT_STEP,value:He?.inputs.base_shift,onChange:ut=>{He&&Qe?.({...He,inputs:{...He?.inputs,base_shift:ut}})},disabled:it}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 items-center",children:jsxRuntimeExports.jsx("h2",{className:"text-[14px]",children:lt("generation:model-sampling-flux.width.label")})}),jsxRuntimeExports.jsx(ValueInputWithRange,{min:MIN_RESOLUTION,max:MAX_RESOLUTION,value:He?.inputs.width,onChange:ut=>{He&&Qe?.({...He,inputs:{...He?.inputs,width:ut}})},disabled:it}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 items-center",children:jsxRuntimeExports.jsx("h2",{className:"text-[14px]",children:lt("generation:model-sampling-flux.height.label")})}),jsxRuntimeExports.jsx(ValueInputWithRange,{min:MIN_RESOLUTION,max:MAX_RESOLUTION,value:He?.inputs.height,onChange:ut=>{He&&Qe?.({...He,inputs:{...He?.inputs,height:ut}})},disabled:it})]})}function ModelSamplingControl({value:He,onChange:Qe,disabled:it}){const{t:lt}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2 items-start",children:[jsxRuntimeExports.jsx("div",{className:"flex gap-2 items-center",children:jsxRuntimeExports.jsx("h2",{className:"text-[14px]",children:lt("generation:model-sampling-type.label")})}),jsxRuntimeExports.jsx(ModelSamplingTypeSelect,{value:He,onChange:Qe,disabled:it}),He?.type==="ModelSamplingDiscrete"?jsxRuntimeExports.jsx(ModelSamplingDiscreteControl,{value:He,onChange:Qe,disabled:it}):He?.type==="ModelSamplingSD3"?jsxRuntimeExports.jsx(ModelSamplingSD3Control,{value:He,onChange:Qe,disabled:it}):He?.type==="ModelSamplingFlux"?jsxRuntimeExports.jsx(ModelSamplingFluxControl,{value:He,onChange:Qe,disabled:it}):null]})}const MIN_RESCALE_CFG=0,MAX_RESCALE_CFG=1,RESCALE_CFG_STEP=.01;function RescaleCFGSelect({value:He,onChange:Qe,disabled:it}){const{t:lt}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"flex gap-2 items-center mb-2",children:jsxRuntimeExports.jsx("h2",{className:"text-[14px]",children:lt("generation:rescale-cfg.label")})}),jsxRuntimeExports.jsx(RescaleCFGInner,{className:"flex gap-8 w-full",minRescaleCfgValue:MIN_RESCALE_CFG,maxRescaleCfgValue:MAX_RESCALE_CFG,step:RESCALE_CFG_STEP,value:He,onChange:Qe,disabled:it})]})}function RescaleCFGInner({value:He,handleChange:Qe,onChange:it,sliderClassName:lt,disabled:ut,minRescaleCfgValue:dt=MIN_RESCALE_CFG,maxRescaleCfgValue:xt=MAX_RESCALE_CFG,step:ft=RESCALE_CFG_STEP,className:vt}){return jsxRuntimeExports.jsx(ValueSliderWithInput,{className:vt,min:dt,step:ft,max:xt,value:He,onChange:kt=>Qe?Qe("inferenceConfig.rescaleCFG")(kt):it?.(kt),disabled:ut,sliderClassName:lt})}const MIN_CFG_SCALE=1.1,MAX_CFG_SCALE=15,CFG_SCALE_STEP=.1,SHIFT_VALUE_STEP=.1,MIN_SHIFT_VALUE=.8,MAX_SHIFT_VALUE=15,MIN_SAMPLING_STEPS=1,MAX_SAMPLING_STEPS=50,SAMPLING_STEPS_STEP=1;function SamplingStepSelectInner({value:He,handleChange:Qe,onChange:it,sliderClassName:lt,lightningMode:ut,disabled:dt,minSamplingSteps:xt=MIN_SAMPLING_STEPS,maxSamplingSteps:ft=MAX_SAMPLING_STEPS}){const{t:vt}=useTranslation(["generation"]),kt=reactExports.useCallback(St=>{Qe?Qe("samplingSteps")(St):it?.(St)},[Qe,it]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[ut&&jsxRuntimeExports.jsx(ControlSectionMessage,{className:"my-2",type:ControlSectionMessageType.Warning,children:vt("generation:sampling-steps.unavailable-in-lightning-mode")}),He==null?jsxRuntimeExports.jsx(CircularSpinner,{}):jsxRuntimeExports.jsx(ValueSliderWithInput,{isInteger:!0,value:He,sliderClassName:cx("max-w-[400px]",lt),disabled:dt,onChange:St=>kt(St),min:xt,max:ft,step:SAMPLING_STEPS_STEP})]})}function SamplingStepSelect({value:He,handleChange:Qe,onChange:it,sliderClassName:lt,lightningMode:ut,disabled:dt}){const{t:xt}=useTranslation(["generation"]),ft=jsxRuntimeExports.jsx(UITooltipHelpIcon,{variant:"normal",TooltipProps:{placement:"start"},children:jsxRuntimeExports.jsx("p",{className:"text-sm w-80 whitespace-pre-wrap",children:xt("generation:sampling-steps.help")})});return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center mb-2",children:[jsxRuntimeExports.jsx("h2",{className:"text-[14px]",children:xt("generation:sampling-steps.label")}),ft]}),jsxRuntimeExports.jsx(SamplingStepSelectInner,{value:He,handleChange:Qe,onChange:it,sliderClassName:lt,lightningMode:ut,disabled:dt})]})}function SamplingMethodsSelectInner({value:He=DEFAULT_SAMPLING_METHOD_IF_EMPTY,handleChange:Qe,onChange:it,selectClassName:lt,disabled:ut,modelType:dt,hideLabel:xt,allowedSamplingMethods:ft}){const{t:vt}=useTranslation(["generation"]),{data:kt,isValidating:St}=useDynamicConstants(),Tt=isSD3Model(dt),Mt=reactExports.useMemo(()=>Array.isArray(ft)&&ft.length>0?ft:kt?.samplingMethods?.filter(At=>Tt?SD3_COMPAT_SAMPLING_METHODS.includes(At):!0)??[],[ft,kt?.samplingMethods,Tt]);return jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,children:[!xt&&jsxRuntimeExports.jsx(InputLabel,{size:"small",children:vt("generation:sampling-method.label")}),St&&Mt.length<1?jsxRuntimeExports.jsx(CircularSpinner,{}):jsxRuntimeExports.jsxs(Select,{disabled:ut,size:"small",className:cx("max-w-[500px]",lt),value:He,label:xt?void 0:vt("generation:sampling-method.label"),onChange:Qe?Qe("samplingMethod"):it,children:[jsxRuntimeExports.jsx(MenuItem$1,{value:"",disabled:!0,children:jsxRuntimeExports.jsx("em",{className:"opacity-50",children:vt("generation:vae-model.select-placeholder")})}),Mt.map(Nt=>jsxRuntimeExports.jsx(MenuItem$1,{value:Nt,children:Nt},Nt))]})]})}function SamplingMethodsSelect({value:He=DEFAULT_SAMPLING_METHOD_IF_EMPTY,handleChange:Qe,onChange:it,selectClassName:lt,disabled:ut,modelType:dt}){const{t:xt}=useTranslation(["generation"]),ft=jsxRuntimeExports.jsx(UITooltipHelpIcon,{variant:"normal",TooltipProps:{placement:"start"},children:jsxRuntimeExports.jsx("p",{className:"text-sm w-80 whitespace-pre-wrap",children:xt("generation:sampling-method.help")})});return jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center",children:[jsxRuntimeExports.jsx(SamplingMethodsSelectInner,{value:He,handleChange:Qe,onChange:it,selectClassName:lt,disabled:ut,modelType:dt}),ft]})}function CfgScaleSelectInner({value:He,handleChange:Qe,onChange:it,sliderClassName:lt,lightningMode:ut,disabled:dt,minCfgScale:xt=MIN_CFG_SCALE,maxCfgScale:ft=MAX_CFG_SCALE}){const{t:vt}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[ut&&jsxRuntimeExports.jsx(ControlSectionMessage,{className:"my-2",type:ControlSectionMessageType.Warning,children:vt("generation:cfg-scale.unavailable-in-lightning-mode")}),He==null?jsxRuntimeExports.jsx(CircularSpinner,{}):jsxRuntimeExports.jsx(ValueSliderWithInput,{className:"w-full",sliderClassName:cx("max-w-[400px]",lt),disabled:dt,value:He,onChange:kt=>{Qe?Qe("cfgScale")(kt):it?.(kt)},min:xt,max:ft,step:CFG_SCALE_STEP})]})}function ShiftValueInner({value:He,handleChange:Qe,onChange:it,sliderClassName:lt,disabled:ut,minShiftValue:dt=MIN_SHIFT_VALUE,maxShiftValue:xt=MAX_SHIFT_VALUE,step:ft=SHIFT_VALUE_STEP,className:vt}){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(ValueSliderWithInput,{className:vt,min:dt,max:xt,step:ft,value:He,onChange:kt=>Qe?Qe("inferenceConfig.modelSampling.inputs.shift")(kt):it?.(kt),disabled:ut,sliderClassName:lt})})}function CfgScaleSelect({value:He,handleChange:Qe,onChange:it,sliderClassName:lt,lightningMode:ut,disabled:dt}){const{t:xt}=useTranslation(["generation"]),ft=jsxRuntimeExports.jsx(UITooltipHelpIcon,{variant:"normal",TooltipProps:{placement:"start"},children:jsxRuntimeExports.jsx("p",{className:"text-sm w-80 whitespace-pre-wrap",children:xt("generation:cfg-scale.help")})});return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center mb-2",children:[jsxRuntimeExports.jsx("h2",{className:"text-[14px]",children:xt("generation:cfg-scale.label")}),ft]}),jsxRuntimeExports.jsx(CfgScaleSelectInner,{value:He,handleChange:Qe,onChange:it,sliderClassName:lt,lightningMode:ut,disabled:dt})]})}const DEFAULT_CFG_SCALE=6,DEFAULT_MODEL_SAMPLING={type:"ModelSamplingDiscrete",inputs:{sampling:"eps",zsnr:!1}},DEFAULT_RESCALE_CFG=0;function ModelVersionForm(He){const{versionValues:Qe,handleChange:it,loadingEditingValues:lt,modelType:ut}=He;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-primary",children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.version-form.version-string"})}),jsxRuntimeExports.jsx(TextField,{fullWidth:!0,size:"small",value:Qe?.name||"",onChange:it("name"),required:!0})]}),$$3(ut).when(dt=>isSDModel(dt)||isDitV1Model(dt),()=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-primary",children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.version-form.negative-prompts"})}),jsxRuntimeExports.jsx(TextField,{fullWidth:!0,size:"small",value:Qe?.negativePrompts||"",onChange:it("negativePrompts"),multiline:!0,rows:3})]}),jsxRuntimeExports.jsx(ModelValuesWrapper,{handleChange:it,versionValues:Qe})]})).when(isLora,()=>jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-primary",children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.trigger-words"})}),jsxRuntimeExports.jsx(TextField,{fullWidth:!0,size:"small",value:Qe?.triggerWords||"",onChange:it("triggerWords"),slotProps:{htmlInput:{autoCapitalize:"none",autoCorrect:"off",spellCheck:!1}}})]})).otherwise(()=>null)]})}function ModelValuesWrapper(He){const{t:Qe}=useTranslation(["market"]),{versionValues:it,handleChange:lt}=He,[ut,dt]=reactExports.useState(()=>it?.samplingMethod!=null),[xt,ft]=reactExports.useState(()=>it?.samplingSteps!=null),[vt,kt]=reactExports.useState(()=>it?.cfgScale!=null),[St,Tt]=reactExports.useState(()=>it?.inferenceConfig?.modelSampling!=null),[Mt,Nt]=reactExports.useState(()=>it?.inferenceConfig?.rescaleCFG!=null);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx(FormControlLabel,{checked:ut,control:jsxRuntimeExports.jsx(Checkbox,{onChange:At=>{dt(At.target.checked),At.target.checked||lt("samplingMethod")(null)}}),label:Qe("market:submit.version-form.enable-sampling-method.label")}),jsxRuntimeExports.jsx(SamplingMethodsSelect,{value:it?.samplingMethod||"",onChange:lt("samplingMethod"),selectClassName:"!max-w-[unset]",disabled:!ut})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx(FormControlLabel,{checked:xt,control:jsxRuntimeExports.jsx(Checkbox,{onChange:At=>{At.target.checked&&!it?.samplingSteps&&lt("samplingSteps")(DEFAULT_SAMPLING_STEPS),ft(At.target.checked),At.target.checked||lt("samplingSteps")(null)}}),label:Qe("market:submit.version-form.enable-sampling-steps.label")}),jsxRuntimeExports.jsx(SamplingStepSelect,{value:it?.samplingSteps??0,onChange:lt("samplingSteps"),sliderClassName:"!max-w-[unset]",disabled:!xt})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx(FormControlLabel,{checked:vt,control:jsxRuntimeExports.jsx(Checkbox,{onChange:At=>{At.target.checked&&!it?.cfgScale&&lt("cfgScale")(DEFAULT_CFG_SCALE),kt(At.target.checked),At.target.checked||lt("cfgScale")(null)}}),label:Qe("market:submit.version-form.enable-cfg-scale.label")}),jsxRuntimeExports.jsx(CfgScaleSelect,{value:it?.cfgScale??0,onChange:lt("cfgScale"),sliderClassName:"!max-w-[unset]",disabled:!vt})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx(FormControlLabel,{checked:St,control:jsxRuntimeExports.jsx(Checkbox,{onChange:At=>{At.target.checked&&!it?.inferenceConfig?.modelSampling&&lt("inferenceConfig.modelSampling")(DEFAULT_MODEL_SAMPLING),Tt(At.target.checked),At.target.checked||lt("inferenceConfig.modelSampling")(null)}}),label:Qe("market:submit.version-form.enable-model-sampling.label")}),jsxRuntimeExports.jsx(ModelSamplingControl,{value:it?.inferenceConfig?.modelSampling??DEFAULT_MODEL_SAMPLING,onChange:lt("inferenceConfig.modelSampling"),disabled:!St})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx(FormControlLabel,{checked:Mt,control:jsxRuntimeExports.jsx(Checkbox,{onChange:At=>{At.target.checked&&!it?.inferenceConfig?.rescaleCFG&&lt("inferenceConfig.rescaleCFG")(DEFAULT_RESCALE_CFG),Nt(At.target.checked),At.target.checked||lt("inferenceConfig.rescaleCFG")(null)}}),label:Qe("market:submit.version-form.enable-rescale-cfg.label")}),jsxRuntimeExports.jsx(RescaleCFGSelect,{value:it?.inferenceConfig?.rescaleCFG,onChange:lt("inferenceConfig.rescaleCFG"),disabled:!Mt})]})]})}function CircularProgressWithLabel(He){return jsxRuntimeExports.jsxs("div",{className:"relative inline-flex",children:[jsxRuntimeExports.jsx(CircularProgress,{variant:"determinate",...He}),He.value!=null&&jsxRuntimeExports.jsx("div",{className:"inset-0 absolute flex items-center justify-center",children:jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:`${Math.round(He.value)}%`})})]})}const allowedFileExtensions=[".ckpt",".pt",".safetensors"];function ModelFileUploadBtn(He){const[Qe,it]=reactExports.useState(null),{t:lt}=useTranslation(["market","common","action","artwork"]),[ut,dt]=reactExports.useState(void 0),[xt,ft]=reactExports.useState("ready"),{data:vt}=useUserInfo(),kt=reactExports.useRef(),[St,Tt]=useLoadingCallback(async Bt=>{kt.current=new AbortController;try{He.setFileUploading?.(!0),ft("hashing");const Ot=await sha256(Bt,{abortSignal:kt.current.signal});if(!He.skipHash){const{generationModelVersion:Wt}=await client.getGenerationModelVersion({fileHash:Ot});if(Wt){if(await dialogModelRequestEdit(Wt.modelId,{title:He.values?.title,mediaId:He.values?.media?.id,extra:{description:He.values?.extra?.description,triggerWords:He.values?.firstVersionExtra?.triggerWords}}),!vt?.isAdmin){He.setFileId(void 0),ft("ready"),dt(void 0),it(null);return}if(vt?.isAdmin){ft("done"),dt(void 0),He.setFileId(Wt.fileUploadId),toast.info("Because you are an admin, duplicated model files are allowed");return}}}ft("uploading"),dt(0);const Qt=await uploadFileMultiPart(Bt,Ot,{onProgress:Wt=>{dt(Wt*100)},abortSignal:kt.current.signal});if(!Qt?.uploadId)throw new Error("upload failed");track("submit_file_success"),He.setFileId(Qt.uploadId),ft("done"),toast.success(lt("market:submit.file-uploaded"))}catch(Ot){He.setFileId(void 0),it(null),track("submit_file_failed",{error:Ot.message}),Ot.name==="AbortError"||Ot.name==="CanceledError"?toast.info("File upload cancelled"):toast.error("Failed to upload file: "+Ot.message),ft("ready")}finally{dt(void 0),He.setFileUploading?.(!1)}},[vt?.isAdmin]),Mt=reactExports.useCallback(Bt=>{const[Ot]=Bt;if(Ot){if(!allowedFileExtensions.some(Qt=>Ot.name.endsWith(Qt)))return toast.error(lt("market:submit.notice.invalid-file-extension"));if(isLora(He.values?.type)&&Ot.size>2**30)return toast.error(lt("market:submit.notice.lora-max-size-exceeded"));it({name:Ot.name,size:Ot.size}),Tt(Ot)}},[Tt,He.values?.type]),{getRootProps:Nt,getInputProps:At,isDragActive:$t,acceptedFiles:Dt}=useDropzone({onDrop:Mt,maxFiles:1}),Ft=()=>{kt.current?.abort(),ft("ready"),it(null),He.setFileId(void 0)};return jsxRuntimeExports.jsxs("div",{className:"w-60 relative mt-2",children:[jsxRuntimeExports.jsxs("button",{className:cx("border-2 border-dashed border-active text-primary font-medium py-8 rounded-xl flex flex-col items-center gap-1 w-full",(St||xt!=="ready")&&"pointer-events-none cursor-not-allowed",xt==="done"&&"bg-sky-100"),disabled:St||xt!=="ready",title:Qe?.name,...Nt({onClick:()=>{track("submit_file_click")}}),children:[jsxRuntimeExports.jsx("input",{...At({accept:allowedFileExtensions.join(", ")})}),xt!=="ready"&&xt!=="done"&&jsxRuntimeExports.jsx(CircularProgressWithLabel,{variant:xt==="uploading"?"determinate":void 0,value:ut,size:32,className:"text-blue-800"}),jsxRuntimeExports.jsx("span",{className:"font-semibold",children:lt(xt==="ready"?"market:submit.submit-file":xt==="hashing"?"market:submit.asset-form.hashing":xt==="uploading"?"market:submit.file-uploading":"market:submit.file-uploaded")}),Qe&&jsxRuntimeExports.jsxs("div",{className:"w-full",children:[jsxRuntimeExports.jsx("p",{className:"truncate font-mono text-xs w-full text-center",children:formatBytes(Qe.size)}),jsxRuntimeExports.jsx("p",{className:"truncate font-mono text-xs w-full text-center",children:Qe.name})]})]}),xt!=="ready"&&jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",color:"normal",size:"small",className:"rounded-full z-10 absolute right-0 top-0 translate-x-1/3 -translate-y-1/3",onPress:Ft,children:jsxRuntimeExports.jsx(icBaselineClose,{className:"size-3"})})]})}function ModelAssetForm(He){const{t:Qe}=useTranslation(["market"]),{values:it,handleChange:lt,isEditing:ut}=He,{modelId:dt,media:xt}=it,ft=reactExports.useRef(null),vt=!hasModelTypeDisabledAddVersion(it.type),{modelInfo:kt,status:St,error:Tt}=reactExports.useContext(ExternalModelImporterContext);return jsxRuntimeExports.jsxs("div",{className:"w-full flex flex-col gap-4",children:[!ut&&jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"text-primary font-semibold text-lg md:text-2xl flex items-center gap-1 mb-1",children:Qe("market:submit.model-cover.title")}),jsxRuntimeExports.jsx(UploadImage,{value:kt?.mediaList?.[0]||xt,onChange:Mt=>{Mt&&lt("media")(Mt)},dropzoneOptions:{accept:{"image/jpeg":[],"image/png":[],"image/webp":[]},noKeyboard:!0},preHandleImage:async Mt=>await dialogCropImage({file:Mt})??Mt,placeholderElement:jsxRuntimeExports.jsx(UploadImagePlacerholder,{}),className:"relative",fileHandleElement:({action:Mt})=>jsxRuntimeExports.jsx("div",{className:"absolute bottom-4 font-sans",children:jsxRuntimeExports.jsx(CropCurrentImageForUploadButton,{media:it.media,action:Mt})})})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-primary font-semibold text-lg md:text-2xl flex items-center gap-1 mb-1",children:Qe("market:submit.model-version.title")}),ut&&jsxRuntimeExports.jsx(AddModelVersionBtn,{disabled:!vt,className:"ml-auto",modelProps:{id:it.modelId,type:it.type,isPrivate:it.isPrivate},onSubmit:()=>{ft.current?.mutate()},onClose:He.onClose,modelId:it.modelId})]}),!ut&&$$3(St).with(ExternalModelStatus.Validating,ExternalModelStatus.Uploading,()=>jsxRuntimeExports.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 px-6 py-8 border-2 border-dashed border-active rounded-xl text-primary-light font-medium",children:[jsxRuntimeExports.jsx(CircularProgress,{color:"inherit",size:16}),Qe("market:importer.messages.fetching-in-progress")]})).with(ExternalModelStatus.Error,()=>jsxRuntimeExports.jsxs("div",{className:"mt-2 flex items-center gap-2 px-6 py-8 border-2 border-dashed border-red-600 rounded-xl",children:[jsxRuntimeExports.jsx(icBaselineError,{className:"size-4 text-red-600"}),Qe("market:importer.messages.fetching-failed",{error:Tt.toString()})]})).with(ExternalModelStatus.Success,()=>jsxRuntimeExports.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 px-6 py-8 border-2 border-dashed border-active rounded-xl text-primary-light font-medium",children:[jsxRuntimeExports.jsx(icBaselineCheckCircle,{className:"size-4 text-green-600"}),Qe("market:importer.messages.fetching-succeeded")]})).otherwise(()=>jsxRuntimeExports.jsx(ModelFileUploadBtn,{fileId:it.uploadId,skipHash:it.isPrivate,setFileId:Mt=>lt("uploadId")(Mt),values:it})),ut&&dt&&jsxRuntimeExports.jsx(ModelVersions,{pagingRef:ft,modelId:dt,modelType:it.type,onClose:He.onClose})]})]})}function AddModelVersionBtn(He){const Qe=useNavigate(),{t:it}=useTranslation(["market"]),[lt,ut]=reactExports.useState(!1),dt=()=>{ut(!1)},xt=reactExports.useCallback(()=>{track("add_version_click",{location:"edit-model",modelType:He.modelProps.type}),isUserMultiLora(He.modelProps.type)?(Qe(withQuery("/train-lora",{addToModelId:He.modelId})),He.onClose?.()):ut(!0)},[He.modelId,He.modelProps.type]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIButton$1,{disabled:He.disabled,className:cx(He.className),variant:"filled",onPress:xt,icon:jsxRuntimeExports.jsx(icRoundPlus,{}),children:it("market:submit.add-version")}),jsxRuntimeExports.jsx(UIDialog,{open:lt,onClose:dt,className:"w-[calc(100vw-3rem)] mlg:w-[1200px]",children:jsxRuntimeExports.jsx(ModelVersionUpsertDialogContent,{modelProps:He.modelProps,onClose:dt,mutate:He.onSubmit})})]})}function ModelVersions(He){const{t:Qe}=useTranslation(["market"]),{modelId:it}=He,[{before:lt,after:ut},dt]=reactExports.useState({}),{data:xt,isValidating:ft,mutate:vt}=useGenerationModelVersions({modelId:it,...getBaseCursorPagingArgs({before:lt,after:ut,pageSize:5})}),kt=getNodesFromConnection(xt).reverse(),St=reactExports.useMemo(()=>({mutate:vt,data:xt}),[vt,xt]);return reactExports.useImperativeHandle(He.pagingRef,()=>St,[St]),jsxRuntimeExports.jsx(TableContainer,{children:jsxRuntimeExports.jsxs(Table,{children:[jsxRuntimeExports.jsx(TableHead,{children:jsxRuntimeExports.jsxs(TableRow,{children:[jsxRuntimeExports.jsx(TableCell,{children:Qe("market:submit.model-version.version-name")}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:Qe("market:submit.model-type")}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:Qe("market:submit.model-version.status")}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:Qe("market:submit.model-version.update-time")}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:Qe("market:submit.model-version.actions")})]})}),jsxRuntimeExports.jsxs(TableBody,{children:[kt.length<1&&ft&&jsxRuntimeExports.jsx(TableRowSkeleton$2,{}),kt.map(Tt=>jsxRuntimeExports.jsxs(TableRow,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[jsxRuntimeExports.jsx(TableCell,{component:"th",scope:"row",children:jsxRuntimeExports.jsx("pre",{children:Tt.name??"Unknown"})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(VersionTypeChip,{version:Tt})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(ModelVersionStatusChip,{modelVersion:Tt,chipConfigOpts:{showAvailable:!0},type:"compact",className:"text-black inline-flex py-1 px-2 rounded-md"})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:new Date(Tt.createdAt).toLocaleString()}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(ModelVersionEditAction,{status:Tt.status,versionId:Tt.id,modelProps:{id:He.modelId,type:He.modelType},updateTable:vt,versionExtra:Tt.extra,onClose:He.onClose})})]},Tt.name))]}),jsxRuntimeExports.jsx(TableFooter,{children:jsxRuntimeExports.jsx(TableRow,{children:jsxRuntimeExports.jsx(TableCell,{colSpan:100,align:"right",sx:{borderBottom:0},children:jsxRuntimeExports.jsx(TablePaginationActionsWrapper,{pageInfo:xt?.pageInfo,onCursorChange:dt})})})})]})})}function VersionTypeChip(He){const{version:Qe}=He,it=getModelTypeFromVersion(Qe),lt=getModelLoraBaseModelChipConfig(it);return jsxRuntimeExports.jsx("span",{className:"inline-flex gap-1 items-center",children:jsxRuntimeExports.jsx("span",{className:cx(lt?.bgClassName,"text-black px-2 py-1 rounded-md text-xs"),children:lt?.label})})}function TableRowSkeleton$2(){return jsxRuntimeExports.jsxs(TableRow,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[jsxRuntimeExports.jsx(TableCell,{component:"th",scope:"row",children:jsxRuntimeExports.jsx(Skeleton,{})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(Skeleton,{})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(Skeleton,{})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(Skeleton,{})})]})}function ModelVersionEditAction(He){const{t:Qe}=useTranslation(["market"]),[it,lt]=reactExports.useState(!1),ut=useNavigate(),dt=()=>{lt(!1)},xt=async()=>{track("archive_model_version_click");try{if(!await UIDialog.confirm({heading:Qe("market:submit.archive-version.dialog.title"),content:Qe("market:submit.archive-version.dialog.description")}))return;track("archive_model_version_confirm",{modelId:He.modelProps?.id,versionId:He.versionId});const St=await client.upsertGenerationModelVersion({id:He.versionId,input:{status:"archived"}});He.updateTable?.(),toast.success(Qe("market:submit.notice.version-archived"))}catch(kt){toast.error(Qe("market:submit.notice.version-archive-failed")+": "+kt.message)}},ft=()=>{track("reuse_dataset_click",{location:"model-asset-form"}),ut(withQuery("/train-lora",{addToModelId:He.modelProps?.id,trainingTaskId:He.versionExtra?.taskId})),He.onClose?.()},vt=UIMenu.compact([{id:"edit",icon:jsxRuntimeExports.jsx(fluentDocumentEdit20Regular,{className:"size-5"}),children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.edit-version.label"}),onAction:()=>{track("edit_version_click",{location:"edit-model"}),lt(!0)}},{id:"archive",icon:jsxRuntimeExports.jsx(fluentDocumentProhibited20Regular,{className:"size-5"}),children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.archive-version.label"}),color:"warning",onAction:()=>{xt()}}]);return jsxRuntimeExports.jsx("div",{className:"flex gap-2 justify-end",children:He.status==="archived"?jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",disabled:!0,children:jsxRuntimeExports.jsx("span",{className:"italic",children:Qe("market:submit.version-status.archived")})}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[isUserMultiLora(He.modelProps?.type)&&He.versionExtra?.taskId&&jsxRuntimeExports.jsx(UIButton$1,{icon:jsxRuntimeExports.jsx(fluentImageArrowCounterclockwise20Regular,{className:"size-5"}),onPress:()=>ft(),children:jsxRuntimeExports.jsx("span",{className:"whitespace-nowrap",children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.reuse-dataset.label"})})}),jsxRuntimeExports.jsxs(UIMenuTrigger,{children:[jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",children:jsxRuntimeExports.jsx(fluentMoreVertical20Filled,{className:"size-5"})}),jsxRuntimeExports.jsx(UIMenu,{items:vt,placement:"bottom right",children:kt=>jsxRuntimeExports.jsx(UIMenuItem,{...kt})})]}),jsxRuntimeExports.jsx(UIDialog,{open:it,onClose:dt,className:"w-[calc(100vw-3rem)] mlg:w-[1200px]",children:jsxRuntimeExports.jsx(ModelVersionUpsertDialogWrapper,{versionId:He.versionId,onClose:dt,modelProps:He.modelProps,updateTable:He.updateTable})})]})})}function ModelVersionUpsertDialogWrapper(He){const{data:Qe,isValidating:it,mutate:lt}=useGenerationModelByVersionId(He.versionId);return jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(Preloader,{}),children:He.versionId&&!Qe?jsxRuntimeExports.jsx(Preloader,{}):jsxRuntimeExports.jsx(ModelVersionUpsertDialogContent,{onClose:He.onClose,modelProps:He.modelProps,versionData:Qe,mutate:()=>{He.updateTable?.(),lt()}})})}function ModelVersionUpsertDialogContent(He){const{versionData:Qe,mutate:it}=He,{t:lt}=useTranslation(["market"]),[ut,dt]=reactExports.useState(!1),[xt,ft]=reactExports.useState(!1),[vt,kt]=reactExports.useState(),[St,Tt]=reactExports.useState(()=>Qe?.mediaId),{data:Mt}=useGetMedia(St??skipToken),{values:Nt,handleChange:At,getValues:$t,setValues:Dt}=useForm$1(Qe?{name:Qe.name,...Qe.extra}:void 0),Ft=Qe?.model??He.modelProps??{},{id:Bt,type:Ot,isPrivate:Qt}=Ft,[Wt,Xt]=useLoadingCallback(async()=>{const Kt=await $t();try{const Jt=getCreateVersionInputs({versionVals:Kt,modelId:Bt,fileId:vt,mediaId:St}),hr=await client.upsertGenerationModelVersion({id:Qe?.id,input:Jt});it?.(),hr.upsertGenerationModelVersion?.modelId&&mutateGenerationModel(hr.upsertGenerationModelVersion?.modelId,hr.upsertGenerationModelVersion?.model,!0),track("submit_model_version_success",getSubmitModelVersionTrackAttrs({values:Kt,versionRes:hr.upsertGenerationModelVersion,modelId:Bt,versionId:Qe?.id})),toast.success(He.versionData?lt("market:submit.notice.version-edited"):lt("market:submit.notice.version-added")),He.onClose()}catch(Jt){toast.error(Jt.message)}},[He.versionData?.id,vt,St,Bt]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.action.edit-version"})}),jsxRuntimeExports.jsx(UIDialogContent,{className:"@container/form p-4",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 @[600px]/form:grid-cols-[2fr_1fr] grid-flow-dense gap-x-8 gap-4 text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"@[600px]/form:col-start-2 flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-primary",children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:cover"})}),jsxRuntimeExports.jsx(UploadImage,{value:Mt,onChange:Kt=>{Kt&&Tt(Kt.id)},onUpload:dt,placeholderElement:jsxRuntimeExports.jsx(UploadImagePlacerholder,{}),className:""})]}),Qe&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-primary",children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.preview-artwork.label",values:{count:2}})}),jsxRuntimeExports.jsx(PreviewArtworkList,{modelVersion:Qe,value:Nt.previewArtworkIds,onChange:Kt=>At("previewArtworkIds")(Kt),className:"flex-none w-[300px] md:w-[400px] max-w-full"})]})]}),jsxRuntimeExports.jsxs("div",{className:"col-start-1 flex flex-col gap-4",children:[jsxRuntimeExports.jsx(ModelVersionForm,{versionValues:Nt,handleChange:At,modelType:Ot,isEditing:!0}),!Qe?.id&&jsxRuntimeExports.jsx(ModelFileUploadBtn,{fileId:vt,setFileId:Kt=>kt(Kt),skipHash:Qt,setFileUploading:ft})]})]})}),jsxRuntimeExports.jsxs(UIDialogFooter,{className:cx("sticky bottom-0","translate-y-4"),children:[jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",onPress:He.onClose,children:lt("action:cancel")}),jsxRuntimeExports.jsx(UIButton$1,{busy:Wt,disabled:ut||xt,variant:"filled",onPress:async()=>{try{await Xt()}catch(Kt){toast.error(Kt.message)}},color:"normal",children:lt("market:submit.upload-submit")})]})]})}function UploadImagePlacerholder(){const{t:He}=useTranslation(["action"]);return jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-2",children:[jsxRuntimeExports.jsx(icOutlineAddPhotoAlternate,{className:"text-4xl"}),jsxRuntimeExports.jsx("div",{className:"text-center font-medium",dangerouslySetInnerHTML:{__html:He("action:drag-and-drop-hint",{br:"<br />"})}})]})}function PreviewArtworkList(He){const Qe=reactExports.useRef(null);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:cx("grid grid-cols-3 content-start gap-1 aspect-square",He.className),style:He.style,onClick:()=>Qe.current?.open(),children:[He.value?.map(it=>jsxRuntimeExports.jsx(PreviewArtworkItem,{artworkId:it},it)),(He.value?.length??0)<9&&jsxRuntimeExports.jsx("button",{className:"grid place-content-center w-full aspect-square text-neutral-500 border border-dashed border-zinc-300 dark:border-zinc-600 rounded-md",children:jsxRuntimeExports.jsx(fluentAdd24Filled,{className:"size-6"})})]}),jsxRuntimeExports.jsx(ArtworkPicker,{ref:Qe,modelVersionId:He.modelVersion.id,modelType:He.modelVersion.modelType,value:He.value,multiple:!0,max:9,onSubmit:it=>{He.onChange?.(it)}})]})}function PreviewArtworkItem(He){const{data:Qe}=useGetArtwork(He.artworkId);return jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:Qe?.mediaId,thumbnail:!0,className:"w-full aspect-square rounded-md"})}const fluentAdd20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10 2.5a.5.5 0 0 0-1 0V9H2.5a.5.5 0 0 0 0 1H9v6.5a.5.5 0 0 0 1 0V10h6.5a.5.5 0 0 0 0-1H10z"})}),CursorPagingButton=({pageInfo:He,isPosSeq:Qe,className:it,btnGroupClassName:lt,onChange:ut,onClickPrev:dt,onClickNext:xt})=>{const{t:ft}=useTranslation(["action"]),[vt]=useSearchParams(),kt=Qe?!He?.hasPreviousPage:!He?.hasNextPage,St=Qe?!He?.hasNextPage:!He?.hasPreviousPage,Tt=reactExports.useMemo(()=>{const Nt=new URLSearchParams(vt);return Qe?Nt.set("before",He?.startCursor??""):Nt.set("after",He?.endCursor??""),`?${Nt.toString()}`},[vt,Qe,He]),Mt=reactExports.useMemo(()=>{const Nt=new URLSearchParams(vt);return Qe?Nt.set("after",He?.endCursor??""):Nt.set("before",He?.startCursor??""),`?${Nt.toString()}`},[vt,Qe,He]);return jsxRuntimeExports.jsx("div",{className:cx("flex justify-center m-8",it),children:jsxRuntimeExports.jsxs(ButtonGroup,{className:cx(lt),children:[jsxRuntimeExports.jsx(Button,{variant:"outlined",size:"small",disabled:kt,href:Tt,onClick:Nt=>{Nt.preventDefault(),dt?.(),ut?.(Qe?{before:He?.startCursor,after:void 0}:{before:void 0,after:He?.endCursor})},className:"w-24",startIcon:jsxRuntimeExports.jsx(icBaselineChevronLeft,{className:"size-6"}),children:jsxRuntimeExports.jsx("span",{className:"capitalize",children:ft("action:previous")})}),jsxRuntimeExports.jsx(Button,{variant:"outlined",size:"small",disabled:St,href:Mt,onClick:Nt=>{Nt.preventDefault(),xt?.(),ut?.(Qe?{after:He?.endCursor,before:void 0}:{after:void 0,before:He?.startCursor})},className:"w-24",endIcon:jsxRuntimeExports.jsx(icBaselineChevronRight,{className:"size-6"}),children:jsxRuntimeExports.jsx("span",{className:"capitalize",children:ft("action:next")})})]})})},UserProfileContext=reactExports.createContext(void 0),useUserProfileContext=()=>reactExports.useContext(UserProfileContext),bookmarkSkeletons=Array.from({length:3},()=>Math.random()*5+6),CollectionList=reactExports.forwardRef(function He({userId:Qe,username:it,currentBookmarkId:lt},ut){const[{before:dt,after:xt},ft]=reactExports.useState({}),{collections:vt,pageInfo:kt,loading:St,reload:Tt}=useCollections({userId:Qe,before:dt,after:xt}),Mt=reactExports.useRef(null),Nt=reactExports.useRef(null),At=useNavigate(),$t=reactExports.useCallback(Ft=>{track("collection_click",{collectionId:Ft.id}),lt===Ft.id?At(`/@${it}/artworks`):At(`/@${it}/collection/${Ft.id}`)},[lt,it,At]);if(reactExports.useImperativeHandle(ut,()=>({reload:(Ft=!1)=>{Ft&&ft({}),Tt()}})),St&&vt.length===0)return jsxRuntimeExports.jsx("div",{className:cx("flex","gap-4"),children:bookmarkSkeletons.map(Ft=>jsxRuntimeExports.jsx("div",{className:cx("bg-skeleton animate-pulse rounded-md","w-36 h-36")},Ft))});const Dt=kt?.hasNextPage||kt?.hasPreviousPage;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"grid gap-4 grid-cols-2 msm:grid-cols-3 mmd:grid-cols-4 mlg:grid-cols-6",children:vt.map(Ft=>jsxRuntimeExports.jsx(MemoizedCollectionCard,{bookmark:Ft,href:`/@${it}/collection/${Ft.id}`,isSelected:Ft.id===lt,onClick:$t,onClickEdit:Bt=>Mt.current?.open(Bt),onClickDelete:Bt=>Nt.current?.open(Bt.id)},Ft.id))}),Dt&&jsxRuntimeExports.jsx(CursorPagingButton,{className:"my-0",pageInfo:kt,onChange:ft,isPosSeq:!1}),jsxRuntimeExports.jsx(CollectionEditDialog,{ref:Mt,i18nNamespace:"collection",onSubmit:()=>Tt()}),jsxRuntimeExports.jsx(CollectionRemoveDialog,{ref:Nt,onRemove:()=>Tt()})]})});function CollectionCard({bookmark:He,href:Qe,isSelected:it,onClick:lt,onClickEdit:ut,onClickDelete:dt}){const{t:xt}=useTranslation(["artwork","user"]),[ft]=useBlurNsfw(),[vt,kt]=reactExports.useState(),St=xt("user:collection.cover.placeholder-image"),Tt=isDefaultCollection(He.name),Mt=Tt?xt("user:collection.default.name"):He.name,At=shouldMediaBeBlurred(He.coverMedia)&&ft,{isMyProfile:$t}=useUserProfileContext();return jsxRuntimeExports.jsxs("article",{className:cx("aspect-square relative rounded-lg",it&&"outline outline-theme-primary outline-2 outline-offset-1"),children:[jsxRuntimeExports.jsx(Link,{to:Qe,className:"size-full grid grid-rows-2 grid-cols-1 place-items-stretch rounded-lg relative overflow-hidden",onClick:Dt=>{Dt.preventDefault(),lt(He)},children:jsxRuntimeExports.jsxs("figure",{className:"contents",children:[He.coverMedia?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(MediaPreview$1,{className:cx("row-span-full col-span-full bg-cover bg-top",At&&"blur-xl"),mediaId:He.coverMediaId,thumbnail:!0,alt:Mt}),jsxRuntimeExports.jsx(PreviewMask,{nsfwBlur:At,showExplicitIcon:At})]}):jsxRuntimeExports.jsx("img",{src:St,alt:"Image",className:"row-span-full col-span-full bg-cover bg-top"}),jsxRuntimeExports.jsx("figcaption",{className:"row-start-2 col-span-full relative p-2 flex flex-col justify-end items-center bg-gradient-to-t from-black/70 text-white text-shadow shadow-black text-balance",children:jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold line-clamp-1",children:Mt})})]})}),$t&&jsxRuntimeExports.jsxs("div",{className:"absolute top-1 right-1 bg-gray-200 rounded-md shadow ring-1 ring-black/10",children:[jsxRuntimeExports.jsx(IconButton,{size:"small",onClick:Dt=>kt(Dt.currentTarget),children:jsxRuntimeExports.jsx(icBaselineMoreVert,{className:"text-black"})}),jsxRuntimeExports.jsxs(Menu,{anchorEl:vt,open:!!vt,onClose:()=>kt(void 0),onClick:()=>{track("collection_add_cover_click")},children:[jsxRuntimeExports.jsx(MenuItem$1,{onClick:()=>{ut(He),kt(void 0),track("collection_edit_click")},children:jsxRuntimeExports.jsx("span",{className:"text-primary",children:xt("artwork:action.edit")})}),Tt?null:jsxRuntimeExports.jsx(MenuItem$1,{onClick:()=>{dt(He),kt(void 0),track("collection_delete_click")},children:jsxRuntimeExports.jsx("span",{className:"text-red-600",children:xt("artwork:action.delete")})})]})]})]})}const MemoizedCollectionCard=reactExports.memo(CollectionCard);function CreateCollectionButton({type:He,i18nNamespace:Qe,onSubmit:it}){const lt=reactExports.useRef(null),{t:ut}=useTranslation(["user"]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{variant:"contained",size:"small",startIcon:jsxRuntimeExports.jsx(fluentAdd20Regular,{className:"size-5"}),className:"h-8 rounded-md shadow-none",onClick:()=>{track("collection_create_click"),lt.current?.open()},children:ut(`user:${Qe}.create.title`)}),jsxRuntimeExports.jsx(CollectionEditDialog,{ref:lt,onSubmit:it,type:He,i18nNamespace:Qe})]})}function AddToCollectionButton(He){const{t:Qe}=useTranslation(["user"]),[it,lt]=reactExports.useState(),{collections:ut}=useCollections({userId:He.userId});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIButton$1,{busy:He.loading,variant:"filled",size:"large",onPress:dt=>lt(dt.target),disabled:(He.selectedItems??[]).length===0,children:Qe("user:collection.add.to")}),jsxRuntimeExports.jsx(Menu,{anchorEl:it,open:!!it,onClose:()=>lt(void 0),children:ut.map(dt=>jsxRuntimeExports.jsx(MenuItem$1,{onClick:()=>{lt(void 0),He.addItemsToCollection(dt)},children:isDefaultCollection(dt.name)?Qe("user:collection.default.name"):dt.name},dt.id))})]})}function defaultCollectionForm(){return{id:"",name:"",coverMedia:void 0,isPublic:!0}}const CollectionEditDialog=reactExports.forwardRef(function He(Qe,it){const lt=Qe.i18nNamespace,[ut,dt]=reactExports.useState(!1),[xt,ft]=useSetState(defaultCollectionForm()),vt=isDefaultCollection(xt.name);reactExports.useImperativeHandle(it,()=>({open:(Mt=defaultCollectionForm())=>{ft(Mt),dt(!0)},close:()=>dt(!1)}));const{t:kt}=useTranslation(["user","action"]),[St,Tt]=useLoadingCallback(async({name:Mt,coverMediaId:Nt,isPublic:At})=>{try{const $t=xt.id?await updateCollection(xt.id,{coverMediaId:Nt,isPublic:At,...vt?{}:{name:Mt}}):await createCollection({name:Mt,coverMediaId:Nt,isPublic:At,type:Qe.type});if(!$t)return;Qe.onSubmit?.($t),toast.success(xt.id?kt(`user:${lt}.notice.update.success`):kt(`user:${lt}.notice.add.success`)),dt(!1)}catch{toast.error(xt.id?kt(`user:${lt}.notice.update.failed`):kt(`user:${lt}.notice.add.failed`))}},[xt.id,vt,Qe,kt]);return jsxRuntimeExports.jsxs(Dialog,{open:ut,onClose:(Mt,Nt)=>{Nt!=="backdropClick"&&dt(!1)},PaperProps:{sx:{minWidth:400}},children:[jsxRuntimeExports.jsx(DialogTitle,{children:xt.id?kt(`user:${lt}.edit.title`):kt(`user:${lt}.create.title`)}),jsxRuntimeExports.jsxs(DialogContent,{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsx("label",{className:"text-sm font-medium opacity-70",children:kt(`user:${lt}.cover.title`)}),jsxRuntimeExports.jsx(UploadImage,{value:xt.coverMedia,onChange:Mt=>{Mt&&ft({coverMedia:Mt})},placeholderElement:jsxRuntimeExports.jsx(UploadImagePlacerholder,{})}),jsxRuntimeExports.jsx("label",{className:"text-sm font-medium opacity-70",children:kt(`user:${lt}.name`)}),jsxRuntimeExports.jsx(NormalInput,{id:"code-input",type:"text",value:vt?kt(`user:${lt}.default.name`):xt.name,onChange:Mt=>ft({name:Mt.target.value}),disabled:vt,autoComplete:"off",placeholder:kt(`user:${lt}.create.placeholder`),className:"w-full mt-0"}),jsxRuntimeExports.jsx(FormControlLabel,{control:jsxRuntimeExports.jsx(Checkbox,{checked:xt.isPublic,onChange:(Mt,Nt)=>{ft({isPublic:Nt})}}),label:kt("common:visibility.public")})]}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(UIButton$1,{onPress:()=>dt(!1),children:kt("action:cancel")}),jsxRuntimeExports.jsx(UIButton$1,{disabled:!xt.name,busy:St,onPress:()=>{Tt({name:xt.name,coverMediaId:xt.coverMedia?.id,isPublic:xt.isPublic}),track("collection_create",{type:xt.id?"edit":"create"})},variant:"filled",children:xt.id?kt("action:update"):kt("action:create")})]})]})}),CollectionRemoveDialog=reactExports.forwardRef(function He(Qe,it){const[lt,ut]=reactExports.useState(Qe.collectionId);Qe.collectionId&&lt!==Qe.collectionId&&ut(Qe.collectionId);const[dt,xt]=reactExports.useState(!1),{t:ft}=useTranslation(["user","action"]),[vt,kt]=useLoadingCallback(async()=>{if(lt)try{await removeCollection(lt),Qe.onRemove?.(),xt(!1),toast.success(ft("user:collection.notice.delete.success"))}catch{toast.error(ft("user:collection.notice.delete.failed"))}},[lt]);return reactExports.useImperativeHandle(it,()=>({open:St=>{St&&ut(St),xt(!0)},close:()=>xt(!1)})),jsxRuntimeExports.jsxs(Dialog,{open:dt,onClose:()=>xt(!1),children:[jsxRuntimeExports.jsx(DialogTitle,{children:ft("user:collection.remove.title")}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsx(DialogContentText,{children:ft("user:collection.remove.content")})}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",onPress:()=>xt(!1),children:ft("action:cancel")}),jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",busy:vt,onPress:kt,children:ft("action:confirm")})]})]})}),styles$5=ce$1({base:"placement-bottom:mt-2 placement-top:mb-2 placement-right:mr-2 placement-left:ml-2 group rounded-lg drop-shadow-lg bg-modal-background",variants:{isEntering:{true:"animate-in fade-in placement-bottom:slide-in-from-top-1 placement-top:slide-in-from-bottom-1 placement-left:slide-in-from-right-1 placement-right:slide-in-from-left-1 ease-out duration-200"},isExiting:{true:"animate-out fade-out placement-bottom:slide-out-to-top-1 placement-top:slide-out-to-bottom-1 placement-left:slide-out-to-right-1 placement-right:slide-out-to-left-1 ease-in duration-150"}}});function PopoverOverlayArrow(){return jsxRuntimeExports.jsx($44f671af83e7d9e0$export$746d02f47f4d381,{className:"group",children:jsxRuntimeExports.jsx("svg",{width:12,height:12,viewBox:"0 0 12 12",className:"block fill-modal-background group-placement-bottom:rotate-180 group-placement-left:-rotate-90 group-placement-right:rotate-90",children:jsxRuntimeExports.jsx("path",{d:"M0 0 L6 6 L12 0"})})})}function UIPopoverStateful({className:He,children:Qe,showArrow:it,PopoverProps:lt,onOpenChange:ut,placement:dt}){return jsxRuntimeExports.jsx($07b14b47974efb58$export$5b6b19405a83ff9d,{...lt,placement:dt,className:$64fa3d84918910a7$export$c245e6201fed2f75(He,(xt,ft)=>styles$5({...ft,className:xt})),onOpenChange:ut,children:$64fa3d84918910a7$export$c245e6201fed2f75(Qe,(xt,ft)=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[it&&jsxRuntimeExports.jsx(PopoverOverlayArrow,{}),xt]}))})}function CharacterCollectButton({artwork:He,character:Qe,collected:it,collectedIcon:lt,collectedClassName:ut,notCollected:dt,notCollectedIcon:xt,notCollectedClassName:ft,iconClassName:vt,onDialogDisplayStateChange:kt,variant:St,scene:Tt,...Mt}){const{data:Nt}=useUserInfo(),{t:At}=useTranslation("worlds"),[$t,Dt]=reactExports.useState(He.bookmarkedByMe),Ft=async()=>{if(!$t)return[];const Qt=await client.listBookmarksCharacters({userId:Nt?.id,artworkId:Qe.artworkId,first:30,type:CHARACTER_BOOKMARK_TYPE}),Xt=getNodesFromConnection(Qt.user?.bookmarks).filter(Kt=>Kt.item?.id!==void 0);for(const Kt of Xt)await removeCollectionItem(Kt.id,{artworkId:Qe.artworkId});return Dt(!1),Xt},Bt=async Qt=>{$t||(await addCollectionItem(Qt.id,{artworkId:Qe.artworkId}),Dt(!0))},Ot=jsxRuntimeExports.jsx(UIButton$1,{...Mt,className:cx(Mt.className,$t?ut:ft),icon:$t?lt:xt,startIconClassName:vt,variant:St,onPress:async()=>{if(!Nt)return track("wc_collection_click",{scene:Tt}),openSignModal();if($t){const Qt=await Ft();for(const Wt of Qt)track("wc_collection_remove",{collection:Wt.name,isPrivate:Wt.isPublic,chterId:Qe.id,scene:Tt});toast.success(At("worlds:character.removed-from-collection",{collectionName:Qt.map(Wt=>getCharacterCollectionName(At,Wt.name)).join(", ")}));return}else kt?.(!0)},children:$t?it:dt});return jsxRuntimeExports.jsxs($de32f1b87079253c$export$2e1e1122cf0cba88,{onOpenChange:kt,children:[Ot,jsxRuntimeExports.jsx(UIPopoverStateful,{className:"min-w-[268px] bg-modal-background rounded-2xl shadow-[0_0_20px_0_rgba(0,0,0,0.25)]",showArrow:!0,children:jsxRuntimeExports.jsx($de32f1b87079253c$export$3ddf2d174ce01153,{className:"outline-none",children:({close:Qt})=>jsxRuntimeExports.jsx(CharacterCollectPopover,{scene:Tt,onClose:()=>{Qt(),kt?.(!1)},onAddToCollection:async Wt=>{await Bt(Wt),track("wc_collection_add",{collection:Wt.name,isPrivate:!Wt.isPublic,chterId:Qe.id,scene:Tt}),toast.success(At("worlds:character.added-to-collection",{collectionName:getCharacterCollectionName(At,Wt.name)}))}})})})]})}function CharacterCollectPopover({onClose:He,onAddToCollection:Qe,scene:it}){const{t:lt}=useTranslation("worlds"),{data:ut}=useUserInfo(),{collections:dt,loading:xt,reload:ft}=useCollections({userId:ut?.id,type:CHARACTER_BOOKMARK_TYPE}),vt=reactExports.useRef(null);return jsxRuntimeExports.jsxs("div",{className:"flex flex-col justify-between shadow-md bg-background rounded-xl min-w-[322px] min-h-[322px]",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"p-4 flex justify-between items-center",children:[jsxRuntimeExports.jsx("p",{className:"text-base font-semibold",children:lt("worlds:collection.add-to-modal.collection")}),jsxRuntimeExports.jsx(UIButton$1,{className:"size-6",icon:jsxRuntimeExports.jsx(materialSymbolsClose,{className:"size-4 text-neutral-500"}),startIconClassName:"size-full",onPress:He})]}),jsxRuntimeExports.jsx("hr",{className:"text-dsgray-100"}),jsxRuntimeExports.jsx("div",{className:"p-4",children:xt?jsxRuntimeExports.jsx(Preloader,{}):dt.map((kt,St)=>jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center p-2 rounded-xl cursor-pointer hover:bg-background-secondary group",onClick:()=>{Qe(kt),He()},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"w-12 h-12 rounded-md bg-dsgray-50 flex items-center justify-center",children:[jsxRuntimeExports.jsx("img",{src:getThumbnailUrl(kt.coverMedia)}),jsxRuntimeExports.jsx(icBaselinePlus,{})]}),jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold",children:getCharacterCollectionName(lt,kt.name)})]}),jsxRuntimeExports.jsx(UIButton$1,{className:"border-solid border-[1px] px-[10px] py-[3px] rounded-md lg:hidden group-hover:block",children:lt("worlds:character.collect")})]},St))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("hr",{className:"text-dsgray-100"}),jsxRuntimeExports.jsxs("div",{className:"hover:bg-background-secondary flex items-center px-4 py-2 gap-2 cursor-pointer",onClick:()=>{track("wc_collection_create_click",{scene:it,isPrivate:!1}),vt.current?.open()},children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 rounded-md bg-dsgray-50 flex items-center justify-center",children:jsxRuntimeExports.jsx(icBaselinePlus,{})}),jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold",children:lt("worlds:collection.add-to-modal.create")})]}),jsxRuntimeExports.jsx(CollectionEditDialog,{ref:vt,onSubmit:kt=>{track("wc_collection_create_success",{collection:kt.name,isPrivate:!kt.isPublic,scene:it}),ft()},type:CHARACTER_BOOKMARK_TYPE,i18nNamespace:"character-collection"})]})]})}const CHARACTER_LORA_TAG_NAME="character";function CharacterDetail({artwork:He,character:Qe,onNavigate:it}){const{t:lt}=useTranslation("worlds"),ut=useIsMobile(),{beingAdmin:dt}=useMe(),xt=useNavigate(),ft=()=>{track("wc_chter_generate_click",{scene:"chter-detail",chterId:Qe.id}),it?.(),setCharacterMayApplyModel(),xt(withQuery("/pixai",{character:encodeCharacterForImport({characterId:Qe.id})}))},[vt,kt]=reactExports.useState(void 0),St=jsxRuntimeExports.jsx("div",{className:"mr-4",children:jsxRuntimeExports.jsx(UILink,{href:`/character/${Qe.id}`,target:"_blank",children:jsxRuntimeExports.jsx(icBaselineShare,{className:"size-6"})})}),Tt=jsxRuntimeExports.jsxs("div",{className:"flex items-center text-xs lg:text-base text-neutral-600 dark:text-neutral-300 flex-shrink-0",children:[!ut&&St,jsxRuntimeExports.jsx(materialSymbolsBrush,{className:"inline mr-0.5"}),jsxRuntimeExports.jsx("span",{children:formatNum(Qe.usageCount,{uppercase:!0})})]}),Mt=(Qe.modelVersions??[]).filter(Dt=>Dt.model?.tags?.map(Ft=>Ft.name).includes(CHARACTER_LORA_TAG_NAME)),Nt=useLocalizedField(Qe.locales,"name",Qe.name),At=useLocalizedField(Qe.locales,"description",Qe.description),$t=Qe.resources?.nodes?.[0]?.artworkId;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col pt-10 pb-5 gap-9 lg:gap-[60px]",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col lg:flex-row items-end",children:[jsxRuntimeExports.jsx("img",{className:cx("w-[237px] h-[316px] lg:w-[315px] lg:h-[421px] rounded-[20px] shadow border mx-auto lg:mx-32 object-cover flex-shrink-0",$t&&"cursor-pointer"),src:getPublicUrl(Qe.media),onClick:async()=>{if($t){const Ft=(await fetchGetArtwork({id:$t})).data?.artwork;kt(Ft)}}}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl lg:text-4xl font-semibold font-roboto mt-3 lg:mt-0 lg:leading-[48px]",children:[Nt,dt&&jsxRuntimeExports.jsx(CharacterAdminButton,{character:Qe})]}),ut&&St,!ut&&Tt]}),(Qe.worlds?.length??0)>0&&jsxRuntimeExports.jsxs(Link,{to:`/world/${Qe.worlds[0].id}`,className:"flex items-center gap-[6px] rounded-md lg:rounded-lg bg-neutral-200 hover:bg-neutral-300 mr-auto pl-3 pr-2 py-1 text-black font-semibold text-sm leading-[14px] lg:leading-normal cursor-pointer transition-all",onClick:it,children:[Qe.worlds[0].name,jsxRuntimeExports.jsx(materialSymbolsChevronRight,{})]}),(He.tags?.length||0)>0&&jsxRuntimeExports.jsx(WorldTagList,{tags:He.tags}),jsxRuntimeExports.jsx(UserLink,{className:"my-4",size:32,user:Qe.user,scene:"chter-detail"}),jsxRuntimeExports.jsx(ExpandableTextWithDialog,{title:lt("worlds:world.introduction"),text:At,lines:ut?2:5,expandPosition:ut?"inline":"bottom"}),ut&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("hr",{className:"mt-1"}),Tt]}),jsxRuntimeExports.jsxs("div",{className:"h-10 grid grid-cols-2 gap-5",children:[jsxRuntimeExports.jsxs(UIButton$1,{color:"theme",variant:"filled",className:"w-full h-10 text-base font-semibold rounded-xl",labelClassName:"flex w-full justify-center items-center gap-2",onPress:ft,children:[jsxRuntimeExports.jsx(materialSymbolsBrush,{}),jsxRuntimeExports.jsx("span",{children:lt("worlds:character.generate")})]}),jsxRuntimeExports.jsx(CharacterCollectButton,{artwork:He,character:Qe,scene:"chter-detail",className:"w-full h-10 text-base font-semibold flex-shrink-0 md:px-11 py-3 gap-2 text-center rounded-xl leading-none shadow-none",collected:lt("worlds:character.collected"),collectedIcon:jsxRuntimeExports.jsx(mdiBookmarkCheck,{}),collectedClassName:"flex items-center justify-center bg-background-secondary hover:bg-gray-300 text-neutral-600 dark:text-neutral-300",notCollected:lt("worlds:character.collect"),notCollectedIcon:jsxRuntimeExports.jsx(materialSymbolsBookmarkAdd,{}),notCollectedClassName:"flex items-center justify-center border-solid border-[1px] bg-white hover:bg-gray-100 text-black"})]})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(WorldCharacterDetailHeader,{heading:lt("worlds:heading.recommended-lora-model"),trailing:Mt.length}),jsxRuntimeExports.jsx("div",{className:cx("flex gap-3",ut?"overflow-x-scroll":"flex-wrap"),children:Mt.map((Dt,Ft)=>jsxRuntimeExports.jsx(CharacterModelCard,{model:Dt},Ft))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(WorldCharacterDetailHeader,{heading:lt("worlds:heading.discussion"),trailing:He.commentCount??0}),jsxRuntimeExports.jsx(WorldCharacterCommentArea,{artworkId:Qe.artworkId})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(WorldCharacterDetailHeader,{heading:lt("worlds:heading.artwork")}),jsxRuntimeExports.jsx(StatefulArtworkGrid,{characterId:Qe.id,order:OrderOption.trending,renderEmpty:()=>jsxRuntimeExports.jsx(Empty,{description:lt("worlds:artwork.no-artwork")}),showSpeedDial:!1,containerProps:{className:"!min-h-fit"}})]})]}),jsxRuntimeExports.jsx(ArtworkDetailDialog$1,{artwork:vt,open:!!vt,onClose:()=>kt(void 0)})]})}function CharacterDetailWithId({characterId:He,...Qe}){const{t:it}=useTranslation("worlds"),{data:lt,isValidating:ut}=useCharacter(He),{data:dt,isValidating:xt}=useArtworkWithWorldCharacter(lt?.artworkId);return!dt||!lt?ut||xt?jsxRuntimeExports.jsx(Preloader,{}):jsxRuntimeExports.jsx(Empty,{description:it("worlds:character.no-character")}):jsxRuntimeExports.jsx(CharacterDetail,{artwork:dt,character:lt,...Qe})}const dialogCharacterDetail=He=>{const Qe=dialog({children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(LoadingPage,{}),children:jsxRuntimeExports.jsx("div",{className:"mx-3 mmd:mx-10",children:jsxRuntimeExports.jsx(CharacterDetailWithId,{characterId:He,onNavigate:()=>Qe.current?.close()})})}),scroll:"body",fullWidth:!0,maxWidth:"lg",responsive:!0})};function ArtworkDetailContentCharacter$1(He){const{data:Qe,isValidating:it}=useCharacter(He.characterId);return jsxRuntimeExports.jsxs("button",{className:cx("flex items-center gap-2 p-1 -m-1 text-left rounded-xl","[&:not(&:has([data-capture-hover]:hover))]:hover:bg-black/10","dark:[&:not(&:has([data-capture-hover]:hover))]:hover:bg-white/10"),onClick:()=>{Qe&&dialogCharacterDetail(Qe.id)},children:[jsxRuntimeExports.jsx("div",{className:"flex-none grid size-16 overflow-hidden bg-zinc-300 dark:bg-zinc-600 rounded-lg ring-1 ring-black/10 dark:ring-white/10",children:jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:Qe?.mediaId,className:"row-start-1 col-start-1"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 content-center",children:[jsxRuntimeExports.jsx("div",{className:"px-1.5 py-0 flex items-center gap-2 text-white !w-fit !rounded bg-pink-500",children:jsxRuntimeExports.jsx("span",{className:"font-inter font-medium text-xs",children:"Character"})}),jsxRuntimeExports.jsx("span",{className:"flex-1 w-full truncate text-sm font-inter font-medium",children:Qe?.name})]})]})}const fluentChevronDownUp16Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M11.78 3.53L8.53 6.78a.75.75 0 0 1-1.06 0L4.22 3.53a.75.75 0 0 1 1.06-1.06L8 5.19l2.72-2.72a.75.75 0 1 1 1.06 1.06M8.53 9.22a.75.75 0 0 0-1.06 0l-3.25 3.25a.75.75 0 1 0 1.06 1.06L8 10.81l2.72 2.72a.75.75 0 1 0 1.06-1.06z"})}),fluentChevronUpDown16Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M4.22 6.53a.75.75 0 0 0 1.06 0L8 3.81l2.72 2.72a.75.75 0 1 0 1.06-1.06L8.53 2.22a.75.75 0 0 0-1.06 0L4.22 5.47a.75.75 0 0 0 0 1.06m0 2.94a.75.75 0 0 1 1.06 0L8 12.19l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0l-3.25-3.25a.75.75 0 0 1 0-1.06"})});function ExpandableContentBox(He){const{toggle:Qe,...it}=He,[lt,ut]=reactExports.useState(null),{ref:dt,entry:xt}=useIntersection({root:lt}),ft=Number(xt?.intersectionRatio)<1,[vt,kt]=reactExports.useState(!1),St=At=>{let $t;kt(Dt=>($t=typeof At=="function"?At(Dt):At,$t)),setTimeout(()=>{lt?.scrollIntoView({behavior:"smooth"})},0)},Tt=vt||ft,[Mt,Nt]=reactExports.useState(Math.random());return reactExports.useEffect(()=>{kt(!1),Nt(Math.random())},[He.children]),jsxRuntimeExports.jsxs("div",{...it,"data-expandable":Tt?"":null,"data-expanded":vt?"":null,className:cx("flex flex-col",He.className),children:[jsxRuntimeExports.jsx("div",{ref:ut,className:cx("flex-1 overflow-hidden",Tt&&!vt&&"[mask:linear-gradient(to_top,#0000,#3333_10px,#fff_20px)]"),children:jsxRuntimeExports.jsx("div",{ref:dt,children:He.children},Mt)}),Tt&&jsxRuntimeExports.jsx("div",{className:"flex-none",children:Qe?Qe({expanded:vt,setExpanded:St}):jsxRuntimeExports.jsx("button",{className:cx("flex items-center gap-0.5 h-7 px-2 text-sm rounded-full","hover:bg-white ring-1 ring-black/15","dark:hover:text-white dark:hover:bg-white/20 dark:ring-white/15"),onClick:()=>St(At=>!At),children:vt?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(fluentChevronDownUp16Filled,{className:"size-4 -ml-1"}),jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:show.less"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(fluentChevronUpDown16Filled,{className:"size-4 -ml-1"}),jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:show.more"})]})})})]})}const PROMPT_HELPER_STORAGE_KEY="generator::prompts-helper",PROMPT_HELPER_TSUBAKI_STORAGE_KEY="generator::prompts-helper-tsubaki",IN_HOUSE_DIT_MODEL_IDS=["1884107375027888751","1911477338694141481"];function isInHouseDitModel(He){return He?IN_HOUSE_DIT_MODEL_IDS.includes(He):!1}const helperModeAtom=atomWithStorage(PROMPT_HELPER_STORAGE_KEY,getHelperModeDefaultValue(PROMPT_HELPER_STORAGE_KEY)),tsubakiHelperModeAtom=atomWithStorage(PROMPT_HELPER_TSUBAKI_STORAGE_KEY,getHelperModeDefaultValue(PROMPT_HELPER_TSUBAKI_STORAGE_KEY)),selectedModelIdAtom=atom(void 0),promptHelperModeAtom=atomWithRefresh(He=>{const Qe=He(selectedModelIdAtom);return isInHouseDitModel(Qe)?getPreferenceFromLocalStorage(TSUBAKI_PROMPT_HELPER)===TSUBAKI_PROMPT_HELPER_VALUE.autoEnable?!0:He(tsubakiHelperModeAtom)??!0:He(helperModeAtom)??!0},(He,Qe,it)=>{const lt=He(selectedModelIdAtom);isInHouseDitModel(lt)?Qe(tsubakiHelperModeAtom,it):Qe(helperModeAtom,it)});function usePromptHelperMode(){return useAtom(promptHelperModeAtom,{store:defaultStore})}function useSyncCurrentSelectedModelId(){return useSetAtom(selectedModelIdAtom,{store:defaultStore})}const defaultStore=getDefaultStore();function getHelperModeDefaultValue(He){const Qe=window.localStorage.getItem(He);if(Qe)return attemptParseJSON(Qe)}const mdiTrashCan=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M9 3v1H4v2h1v13a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6h1V4h-5V3H9m0 5h2v9H9V8m4 0h2v9h-2V8Z"})}),materialSymbolsCheckCircle=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m10.6 16.6l7.05-7.05l-1.4-1.4l-5.65 5.65l-2.85-2.85l-1.4 1.4l4.25 4.25ZM12 22q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22Z"})}),materialSymbolsCircleOutline=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 22q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22Zm0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20Zm0-8Z"})}),DialogCanceledResult={value:!1};async function dialogWorldCharacterConfirm(He){return new Promise(Qe=>{const it=dialog({fullWidth:!0,maxWidth:"xs",onClose:()=>Qe(DialogCanceledResult),children:jsxRuntimeExports.jsx(WorldCharacterConfirmDialog,{...He,modalRef:()=>it,onData:Qe})})})}function WorldCharacterConfirmDialog({title:He,description:Qe,cancelLabel:it=jsxRuntimeExports.jsx(Text,{i18nKey:"action:cancel"}),confirmLabel:lt=jsxRuntimeExports.jsx(Text,{i18nKey:"action:confirm"}),suffixLabel:ut,modalRef:dt,onData:xt}){const[ft,vt]=reactExports.useState(!1);return jsxRuntimeExports.jsxs("div",{className:"p-3 pb-5 rounded-xl",children:[jsxRuntimeExports.jsx(IconButton,{className:"flex ml-auto text-right",onClick:()=>dt().current?.close(),size:"small",children:jsxRuntimeExports.jsx(icRoundClose,{className:"size-4"})}),jsxRuntimeExports.jsx("h3",{className:"text-center text-base font-semibold leading-tight mb-3",children:He}),jsxRuntimeExports.jsx("p",{className:"text-center text-sm font-medium leading-4 mb-9 text-[#959595]",children:Qe}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[jsxRuntimeExports.jsx(Button,{variant:"outlined",className:"text-base font-semibold",onClick:async()=>{await dt().current?.close(),xt(DialogCanceledResult)},children:it}),jsxRuntimeExports.jsx(Button,{className:"bg-purple-700 text-white text-base font-semibold",onClick:async()=>{await dt().current?.close(),xt({value:!0,suffixSelected:ft})},autoFocus:!0,children:lt})]}),ut&&jsxRuntimeExports.jsxs("div",{className:"flex gap-1 items-center justify-center mt-3 text-[#6d6d6d] text-xs font-semibold leading-3 select-none",onClick:()=>vt(kt=>!kt),children:[ft?jsxRuntimeExports.jsx(materialSymbolsCheckCircle,{}):jsxRuntimeExports.jsx(materialSymbolsCircleOutline,{}),ut]})]})}const icBaselineStore=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"})}),icRoundArrowBack=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42a.996.996 0 0 0-1.41 0l-6.59 6.59a.996.996 0 0 0 0 1.41l6.59 6.59a.996.996 0 1 0 1.41-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"})}),[GenerationSelectableDialogContext,GenerationSelectableDialogContextProvider]=createCtx({openSearch:!1});function GenerationSelectableDialogContent(He){const[Qe]=reactExports.useContext(GenerationSelectableDialogContext),it=reactExports.useCallback(xt=>{He.onTabChange?.(xt)},[]),lt=He.preview===void 0,ut=He.showModalSheet?He.openDetail:!0,dt=He.showModalSheet?!He.openDetail:!0;return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"mlg:grid flex flex-col grid-cols-[1fr_288px] grid-rows-[56px_1fr] h-full",style:{"--list-height":He.showModalSheet?"100%":"calc(min(100vh - 64px, 620px) - 56px - 52px)"},children:[jsxRuntimeExports.jsx("div",{className:cx("hidden mlg:flex items-center gap-x-2 mlg:gap-x-6","mlg:pl-4 mlg:pr-2 h-14","border-b border-background-light","col-span-2"),children:jsxRuntimeExports.jsx(DesktopTopbar,{...He})}),jsxRuntimeExports.jsxs($5e8ad37a45e1c704$export$b2539bed5023c21c,{selectedKey:He.tabVal,onSelectionChange:xt=>it(xt),orientation:"horizontal",className:cx("relative h-full flex-1 flex flex-col pt-0 px-0 pb-30 mlg:pb-0",lt&&"col-span-2"),children:[jsxRuntimeExports.jsxs("div",{className:cx("flex px-4 flex-col py-2 mlg:flex-row mlg:pt-1 gap-y-2"),children:[jsxRuntimeExports.jsxs("div",{className:cx("border-b border-background-light flex mlg:hidden items-center gap-2 h-14"),children:[jsxRuntimeExports.jsx(TabListInDialog,{tabs:He.tabs,className:cx("flex mr-auto",(He.openDetail||Qe.openSearch||!He.showModalSheet)&&"hidden")}),jsxRuntimeExports.jsx(MobileTopbar,{...He})]}),jsxRuntimeExports.jsx(TabListInDialog,{tabs:He.tabs,className:"hidden mlg:flex mr-auto"}),dt&&He.tabsSuffix]}),He.tabs.map(xt=>jsxRuntimeExports.jsx($5e8ad37a45e1c704$export$3d96ec278d3efce4,{id:xt.id,className:cx("overflow-y-auto h-full pl-4",He.openDetail&&"max-mlg:hidden"),children:xt.content},xt.id))]}),!He.openDetail&&He.detailActionArea,ut&&He.preview]})})}function DesktopTopbar(He){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx($5cb03073d3f54797$export$a8a3e93435678ff9,{slot:"title",className:"pl-2 text-lg font-semibold",children:He.title}),He.searchInput,jsxRuntimeExports.jsxs("div",{className:"flex ml-auto gap-x-2",children:[He.action,jsxRuntimeExports.jsx(IconButton,{color:"primary",onClick:He.onClose,children:jsxRuntimeExports.jsx(icBaselineClose,{className:"size-6"})})]})]})}function MobileTopbar(He){const[Qe,it]=reactExports.useContext(GenerationSelectableDialogContext);return He.openDetail?jsxRuntimeExports.jsx(UIButton$1,{className:"w-full justify-start h-14",size:"large",variant:"ghost",icon:jsxRuntimeExports.jsx(icRoundArrowBack,{}),onPress:()=>{He.onOpenDetailChange?.(!1)},children:jsxRuntimeExports.jsx("span",{className:"pl-1 inline-block w-full text-start",children:He.tabs.find(lt=>lt.id===He.tabVal)?.label})}):Qe.openSearch?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[He.searchInput,jsxRuntimeExports.jsx(IconButton,{className:"text-primary-light",onClick:()=>{it(lt=>({...lt,openSearch:!1}))},children:jsxRuntimeExports.jsx(icBaselineClose,{className:"size-6"})})]}):jsxRuntimeExports.jsx(IconButton,{className:"ml-auto text-primary-light",onClick:()=>{it(lt=>({...lt,openSearch:!0}))},children:jsxRuntimeExports.jsx(icBaselineSearch,{className:"size-6"})})}function TabListInDialog(He){const{tabs:Qe,...it}=He;return jsxRuntimeExports.jsx(UITabList,{variant:"underlined",...it,children:Qe.map(lt=>jsxRuntimeExports.jsx(UITab,{variant:"underlined",id:lt.id,className:"mlg:px-8 px-4",children:lt.label},lt.id))})}const icBaselineCancel=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10s10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17L12 13.41L8.41 17L7 15.59L10.59 12L7 8.41L8.41 7L12 10.59L15.59 7L17 8.41L13.41 12L17 15.59z"})}),StyledOutlinedInput=styled(OutlinedInput)(({theme:He})=>({'[type="search"]::-webkit-search-decoration':{appearance:"none"},'[type="search"]::-webkit-search-cancel-button':{appearance:"none"}}));function ModelSearchBar(He){return jsxRuntimeExports.jsx("div",{className:He.className,children:jsxRuntimeExports.jsx(StyledOutlinedInput,{fullWidth:!0,size:"small",endAdornment:He.inputProps.value?jsxRuntimeExports.jsx(InputAdornment,{position:"end",children:jsxRuntimeExports.jsx(IconButton,{edge:"end",onClick:Qe=>{He.onClear?.()},children:jsxRuntimeExports.jsx(icBaselineCancel,{className:"text-sm"})})}):null,type:"search",...He.inputProps})})}const GenerationSelectableDialogSearchWrapper=reactExports.forwardRef(function He(Qe,it){const{tabVal:lt,placeholder:ut,searchKeyword:dt,onInputChange:xt,onClear:ft,...vt}=Qe,[kt,St]=reactExports.useState(dt),Tt=reactExports.useCallback(Nt=>{xt(Nt)},[xt]),[,Mt]=useDebounce(()=>{Tt(kt)},1500,[lt,kt]);return reactExports.useImperativeHandle(it,()=>({cancelDebounce:Mt}),[Mt]),reactExports.useEffect(()=>{Mt(),Tt(kt)},[lt]),jsxRuntimeExports.jsx(ModelSearchBar,{...vt,className:cx("flex-auto",Qe.className),onClear:()=>{ft(),St(""),Mt()},inputProps:{value:kt,onChange:Nt=>St(Nt.target.value),placeholder:ut}})});function getPaginationArgs(He){const{pageSize:Qe=30,dataOrder:it="desc"}={},lt=(dt,xt=Qe)=>!dt||dt.hasPreviousPage?{before:dt?.startCursor,last:xt}:void 0,ut=(dt,xt=Qe)=>!dt||dt.hasNextPage?{after:dt?.endCursor,first:xt}:void 0;return it==="asc"?{prevArgs:lt,nextArgs:ut}:{prevArgs:ut,nextArgs:lt}}function usePaginationArgs(He){const Qe="desc",it=reactExports.useRef(),{prevArgs:lt,nextArgs:ut}=reactExports.useMemo(()=>getPaginationArgs(),[He?.pageSize,He?.dataOrder]),[dt,xt]=reactExports.useState(ut());return{pageArgs:dt,prevPage:()=>xt(lt(it.current)),nextPage:()=>xt(ut(it.current)),setPageInfo:ft=>{it.current=ft},hasPrevPage:reactExports.useCallback(()=>!!it.current?.hasNextPage,[Qe]),hasNextPage:reactExports.useCallback(()=>!!it.current?.hasPreviousPage,[Qe])}}function usePaginatedData(He){const{fetcher:Qe,getArgs:it,getItems:lt,customState:ut}=He,dt=reactExports.useRef(it);dt.current=it;const xt=reactExports.useRef(lt);xt.current=lt;const[ft,vt]=reactExports.useState([]),[kt,St]=reactExports.useState(void 0),Tt=ut?.items??ft,Mt=ut?.setItems??vt,Nt=reactExports.useRef(null),[At,$t]=reactExports.useState(!0),[{loading:Dt},Ft]=useAsyncFn(async()=>{if(Dt)return;const Ot=dt.current(Nt.current);if(!Ot)return!1;const Qt=await Qe(Ot);Nt.current=Qt,Mt(Xt=>uniqBy([...Xt,...xt.current(Qt)],"id"));const Wt=!!He.getHasMore(Qt);return $t(Wt),He.getTotalCount&&kt!==He.getTotalCount(Qt)&&St(He.getTotalCount(Qt)),Wt},[Qe]),Bt=reactExports.useCallback(()=>{Nt.current=null,$t(!0),Mt([])},[Mt]);return{items:Tt,setItems:Mt,hasMore:At,loading:Dt,loadMore:Ft,reset:Bt,totalCount:kt}}const CharacterListContainerInDialog=styled("div")(()=>({display:"grid",width:"calc(100% - 16px)",gridTemplateColumns:"repeat(auto-fill,minmax(136px,1fr))","@media (max-width: 600px)":{gridTemplateColumns:"repeat(auto-fill,minmax(77px,1fr))"},gap:"0.75rem",marginTop:"1rem"})),createCharacterFormStateAtom=()=>atom({currentListType:"discover",characterId:null,artworkId:null,autoChangeModel:!1,keyword:"",openDetail:!1}),CharacterFormContext=reactExports.createContext({});var CharacterTabType=(He=>(He.Discover="discover",He.Collection="collection",He))(CharacterTabType||{});const materialSymbolsBookmarkAdded=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17.825 9L15 6.175l1.4-1.425l1.425 1.425l3.525-3.55l1.425 1.425L17.825 9ZM5 21V5q0-.825.588-1.413T7 3h7q-.5.75-.75 1.438T13 6q0 1.8 1.137 3.175T17 10.9q.575.075 1 .075t1-.075V21l-7-3l-7 3Z"})});function formatNumber(He){return new Intl.NumberFormat("en-US").format(He)}function WorldCharacterCard({artwork:He,character:Qe,showUsageCount:it,className:lt,showActions:ut=!0,enableNavigation:dt=!0,size:xt,selected:ft,scene:vt}){const kt=useNavigate(),{t:St}=useTranslation("worlds"),Tt=async()=>{vt&&track("wc_chter_generate_click",{scene:vt,chterId:Qe.id}),setCharacterMayApplyModel(),kt(withQuery("/pixai",{character:encodeCharacterForImport({characterId:Qe.id})}))},[Mt,Nt]=reactExports.useState(!1),At=reactExports.useCallback(()=>{dt&&(track("wc_chter_click",{scene:vt}),dialogCharacterDetail(Qe.id))},[dt]),$t=useLocalizedField(Qe.locales,"name",Qe.name);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:cx("relative overflow-hidden group flex-shrink-0",$$3(xt).with("small",()=>"w-24 h-32 rounded-md").with("medium",()=>"w-[154px] h-[205px] rounded-xl").with("large",()=>"w-[209px] h-[278px] rounded-xl").exhaustive(),"ring-2 ring-offset-1 ring-offset-background-light",ft?"ring-purple-700 dark:ring-purple-600":"ring-transparent",lt),children:[jsxRuntimeExports.jsx("img",{className:"absolute w-full h-full object-cover",src:getThumbnailUrl(Qe.media),onClick:At}),jsxRuntimeExports.jsx("div",{className:cx("absolute w-full h-full opacity-40 group-hover:bg-black transition-colors cursor-pointer",ut&&Mt&&"bg-black"),onClick:At}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 h-16 w-full bg-gradient-to-t from-black/40 to-black/0"}),jsxRuntimeExports.jsxs("div",{className:cx("absolute bottom-0 w-full p-3 pr-6 flex flex-col justify-end gap-2",xt==="small"&&!it&&"pl-1.5 pb-0.5 !pr-0"),children:[ut&&jsxRuntimeExports.jsxs("div",{className:cx("invisible group-hover:visible flex gap-2",Mt&&"!visible"),children:[jsxRuntimeExports.jsx(UITooltipTriggerWrapper,{placement:"top",className:"justify-self-start",delay:250,trigger:jsxRuntimeExports.jsx($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{className:"text-white size-8 bg-purple-600 hover:bg-purple-700 rounded-full",onPress:Tt,children:jsxRuntimeExports.jsx(materialSymbolsBrush,{className:"mx-auto size-4"})}),children:jsxRuntimeExports.jsx("p",{className:"p-2",children:St("worlds:character.generate")})}),jsxRuntimeExports.jsx(UITooltipTriggerWrapper,{placement:"top",className:"justify-self-start",delay:250,trigger:jsxRuntimeExports.jsx(CharacterCollectButton,{artwork:He,character:Qe,className:"size-8 text-black bg-white hover:bg-gray-200 rounded-full",iconClassName:"px-2",variant:"ghost",collectedIcon:jsxRuntimeExports.jsx(materialSymbolsBookmarkAdded,{className:"size-4 mx-auto"}),notCollectedIcon:jsxRuntimeExports.jsx(materialSymbolsBookmarkAdd,{className:"size-4 mx-auto"}),onDialogDisplayStateChange:Nt,scene:vt}),children:jsxRuntimeExports.jsx("p",{className:"p-2",children:St("worlds:character.collect")})})]}),jsxRuntimeExports.jsxs("div",{className:"text-white [text-shadow:_0_0_2px_rgba(0_0_0_/_50%)] cursor-pointer",onClick:At,children:[jsxRuntimeExports.jsx("h4",{className:"font-semibold leading-none mb-1",children:$t}),it&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-0.5",children:[jsxRuntimeExports.jsx(materialSymbolsBrush,{className:"w-3 h-3"}),jsxRuntimeExports.jsx("div",{className:"text-[10px] font-semibold leading-[10px]",children:formatNumber(Qe.usageCount)})]})]})]})]})})}function SmallWorldCharacterCard({character:He,showUsageCount:Qe,className:it,enableNavigation:lt=!0,size:ut,selected:dt,scene:xt}){const ft=reactExports.useCallback(()=>{lt&&(track("wc_chter_click",{scene:xt}),dialogCharacterDetail(He.id))},[lt]),vt=useLocalizedField(He.locales,"name",He.name);return jsxRuntimeExports.jsxs("div",{className:cx("flex-shrink-0",$$3(ut).with("small",()=>"w-[83px] h-[149px]").with("medium",()=>"w-24 h-[168px]").with("large",()=>"w-[117px] h-[198px]").exhaustive(),it),onClick:ft,children:[jsxRuntimeExports.jsxs("div",{className:cx("relative flex-shrink overflow-hidden",$$3(ut).with("small",()=>"h-[110px] rounded-lg").with("medium",()=>"h-[128px] rounded-md").with("large",()=>"h-[155px] rounded-lg").exhaustive(),"ring-2 ring-offset-1 ring-offset-background-light",dt?"ring-purple-700 dark:ring-purple-600":"ring-transparent"),children:[jsxRuntimeExports.jsx("img",{className:"w-full h-full object-cover",src:getThumbnailUrl(He.media)}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 w-full h-9 bg-gradient-to-t from-black/60 to-black/0"}),Qe&&jsxRuntimeExports.jsxs("div",{className:"absolute left-1 bottom-1 flex items-center gap-0.5 text-white",children:[jsxRuntimeExports.jsx(materialSymbolsBrush,{className:"w-3 h-3"}),jsxRuntimeExports.jsx("div",{className:"text-xs font-semibold leading-3",children:formatNumber(He.usageCount)})]})]}),jsxRuntimeExports.jsx("h4",{className:"font-semibold leading-none mt-1 line-clamp-2",children:vt})]})}function AdaptiveWorldCharacterCard({size:He,mobileSize:Qe,breakpoint:it,...lt}){return useBreakpoint(it??"mmd")?jsxRuntimeExports.jsx(SmallWorldCharacterCard,{...lt,size:Qe}):jsxRuntimeExports.jsx(WorldCharacterCard,{...lt,size:He,showUsageCount:!0})}function DiscoverCharacterGrid(){const He=reactExports.useContext(CharacterFormContext),[{keyword:Qe,characterId:it},lt]=useImmerAtom(He),{items:ut,hasMore:dt,loading:xt,loadMore:ft,totalCount:vt,reset:kt}=usePaginatedData({fetcher:client.listWorldCharacters,getArgs:Nt=>({first:16,after:Nt?.artworks.pageInfo?.endCursor,type:ArtworkType.Character,keyword:Qe,feed:"trending"}),getItems:Nt=>getNodesFromConnection(Nt.artworks).reverse(),getHasMore:Nt=>Nt.artworks?.pageInfo.hasNextPage??!1,getTotalCount:Nt=>Nt.artworks?.totalCount??void 0}),St=reactExports.useRef(!0);reactExports.useEffect(()=>{if(St.current){St.current=!1;return}kt(),ft()},[Qe]),reactExports.useEffect(()=>{ft()},[]);const Tt=reactExports.useCallback(()=>{dt&&ft()},[Qe,dt]),Mt=reactExports.useCallback(()=>xt?jsxRuntimeExports.jsx(Preloader,{className:"!my-1"}):Qe.length===0?jsxRuntimeExports.jsx(EmptyCharacterSearchResultsInDialog,{className:"pb-20"}):null,[xt,Qe]);return ut.length===0?xt?jsxRuntimeExports.jsx("div",{className:"w-full min-h-[360px] h-[var(--list-height)]",children:jsxRuntimeExports.jsx(LoadingPage,{fullHeight:!0})}):jsxRuntimeExports.jsx(EmptyCharacterSearchResultsInDialog,{className:"h-[var(--list-height)]",showDescription:!0}):jsxRuntimeExports.jsx(RadioGroup,{className:"flex-1",value:it,style:{height:"var(--list-height)"},children:jsxRuntimeExports.jsx(Yr,{className:"w-full min-h-[140px]",totalCount:vt,data:ut,endReached:Tt,itemContent:(Nt,At)=>{const{title:$t,character:Dt}=At,Ft=Dt.id;return jsxRuntimeExports.jsx(CharacterControlLabel,{control:jsxRuntimeExports.jsx(Radio,{className:"sr-only",onChange:()=>{lt(Bt=>{Bt.currentListType=CharacterTabType.Discover,Bt.artworkId=At.id,Bt.characterId=Ft})}}),selected:it===Ft,artwork:At,characterId:Dt.id,character:Dt,title:$t,onClick:()=>{it===Ft&&lt(Bt=>{Bt.currentListType=CharacterTabType.Discover})}},Ft)},overscan:200,components:{Footer:Mt,List:CharacterListContainerInDialog}})})}function CharacterControlLabel(He){const{control:Qe,selected:it,disabled:lt,artwork:ut,character:dt,characterId:xt,title:ft,onClick:vt}=He;return jsxRuntimeExports.jsx(FormControlLabel,{className:"group/label relative m-0 block isolate",disableTypography:!0,value:xt,disabled:lt,title:ft,control:Qe,onClick:vt,label:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"w-full relative m-[3px]",children:jsxRuntimeExports.jsx(AdaptiveWorldCharacterCard,{className:"mx-auto",artwork:ut,character:dt,showActions:!1,enableNavigation:!1,showUsageCount:!0,breakpoint:"msm",size:"medium",mobileSize:"small",selected:it})})})})}function EmptyCharacterSearchResultsInDialog(He){const{t:Qe}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs("div",{className:cx("flex flex-col items-center justify-center gap-4 mx-auto",He.className),children:[He.showDescription&&jsxRuntimeExports.jsx("h1",{children:Qe("generation:character.list.empty-placeholder")}),jsxRuntimeExports.jsx(Button,{component:Link,to:"/worlds",target:"_blank",className:"bg-theme-primary font-bold",variant:"contained",onClick:it=>{He.onGotoClick&&(it.preventDefault(),He.onGotoClick())},children:Qe("generation:character.list.go-to-worlds")})]})}function BookmarkCharacterGrid(){const{t:He}=useTranslation("user"),{data:Qe}=useUserInfo(),{collections:it,loading:lt}=useCollections({userId:Qe?.id,type:CHARACTER_BOOKMARK_TYPE}),[ut,dt]=reactExports.useState();return reactExports.useEffect(()=>{!lt&&it.length>0&&dt(it[0].id)},[lt]),lt?jsxRuntimeExports.jsx(Preloader,{className:"!my-1"}):jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("div",{className:"flex gap-2",children:it.map((xt,ft)=>jsxRuntimeExports.jsx(ButtonBase,{className:cx("px-4 py-[6px] rounded-xl text-xs font-medium",ut===xt.id?"bg-background-light":"text-black text-opacity-40"),onClick:()=>dt(xt.id),children:getCharacterCollectionName(He,xt.name)},ft))}),jsxRuntimeExports.jsx(BookmarkCharacterGridItem,{bookmarkId:ut})]})}function BookmarkCharacterGridItem({bookmarkId:He}){const{t:Qe}=useTranslation(["generation"]),it=reactExports.useContext(CharacterFormContext),[{characterId:lt,keyword:ut},dt]=useImmerAtom(it),{items:xt,hasMore:ft,loading:vt,loadMore:kt,totalCount:St,reset:Tt}=usePaginatedData({fetcher:client.listBookmarkCharacterItems,getArgs:At=>({bookmarkId:He,first:16,after:At?.bookmark?.items?.pageInfo?.endCursor,types:[RefType.Artwork],artworkTypes:[ArtworkType.Character]}),getItems:At=>getNodesFromConnection(At.bookmark?.items).filter($t=>ut.length===0||$t.artwork?.title.toLowerCase().includes(ut.toLowerCase())).reverse(),getHasMore:At=>At.bookmark?.items?.pageInfo.hasNextPage??!1,getTotalCount:At=>At.bookmark?.items?.totalCount??void 0});reactExports.useEffect(()=>{Tt(),kt()},[ut,He]);const Mt=reactExports.useCallback(()=>{ft&&kt()},[ft,ut]),Nt=reactExports.useCallback(()=>vt?jsxRuntimeExports.jsx(Preloader,{className:"!my-1"}):null,[vt]);if(xt.length===0)switch(!0){case vt:return jsxRuntimeExports.jsx("div",{className:"w-full min-h-[360px] h-[var(--list-height)]",children:jsxRuntimeExports.jsx(LoadingPage,{fullHeight:!0})});case ut.length>0:return jsxRuntimeExports.jsx(Empty,{description:"Nothing Found"});default:return jsxRuntimeExports.jsx(Empty,{description:Qe("user:favorite-list.placeholder")})}return jsxRuntimeExports.jsx(RadioGroup,{value:lt,className:"relative flex-nowrap",style:{height:"var(--list-height)"},children:jsxRuntimeExports.jsx(Yr,{className:"-mt-2 mlg:mt-0 mlg:mb-14 w-full min-h-[221px]",totalCount:St,data:xt,endReached:Mt,itemContent:(At,$t)=>{const{title:Dt,character:Ft}=$t.artwork,Bt=Ft.id;return jsxRuntimeExports.jsx(CharacterControlLabel,{artwork:$t.artwork,character:Ft,control:jsxRuntimeExports.jsx(Radio,{className:"sr-only",onChange:()=>{dt(Ot=>{Ot.currentListType=CharacterTabType.Collection,Ot.artworkId=$t.artwork.id,Ot.characterId=Bt})}}),selected:lt===Bt,characterId:Bt,title:Dt,onClick:()=>{lt===Bt&&dt(Ot=>{Ot.currentListType=CharacterTabType.Collection})}},Bt)},overscan:200,components:{Footer:Nt,List:CharacterListContainerInDialog}})})}function CharacterSelectPreview({onConfirm:He,...Qe}){const{t:it}=useTranslation(["generation"]),lt=reactExports.useContext(CharacterFormContext),[{artworkId:ut,autoChangeModel:dt},xt]=useImmerAtom(lt),[ft,vt]=useLocalStorage({key:"character::model-default-override",defaultValue:!1}),{data:kt,isValidating:St}=useArtworkWithWorldCharacter(ut??void 0);return reactExports.useEffect(()=>{xt(Tt=>{Tt.autoChangeModel=ft})},[]),reactExports.useEffect(()=>{vt(dt)},[dt]),kt?jsxRuntimeExports.jsx(CharacterSelectPreviewInner,{...Qe,artwork:kt,onConfirm:He}):jsxRuntimeExports.jsxs("div",{...Qe,className:cx("flex flex-col",Qe.className),children:[St?jsxRuntimeExports.jsx(Preloader,{className:"flex-grow"}):jsxRuntimeExports.jsx("div",{className:"text-center text-neutral-400 my-auto",children:it("generation:character.preview.no-selection")}),jsxRuntimeExports.jsxs("div",{className:"relative w-full flex flex-col gap-2 p-3 mlg:border-t mlg:border-background-light",children:[jsxRuntimeExports.jsx(UISwitch,{size:"small",isSelected:ft,onChange:Tt=>{xt(Mt=>{Mt.autoChangeModel=Tt})},disabled:!0,children:jsxRuntimeExports.jsx("span",{className:"text-xs font-medium",children:it("generation:character.preview.auto-change-model")})}),jsxRuntimeExports.jsx(UIButton$1,{disabled:!0,variant:"filled",children:it("generation:character.preview.confirm")})]})]})}function CharacterSelectPreviewInner({artwork:He,onClose:Qe,onConfirm:it,...lt}){const{t:ut}=useTranslation(["worlds","market","generation"]),dt=useIsMobile(),xt=He.character,ft=xt.id,vt=reactExports.useContext(CharacterFormContext),[{autoChangeModel:kt},St]=useImmerAtom(vt);function Tt($t){St(Dt=>{Dt.autoChangeModel=$t})}const Mt=getThumbnailUrl(He?.media),Nt=()=>(it({character:xt,autoChangeModel:kt}),Qe()),At=xt.modelVersions??[];return jsxRuntimeExports.jsxs("div",{...lt,className:cx("flex flex-col",lt.className),children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col p-4 gap-3 overflow-auto",children:[jsxRuntimeExports.jsx("img",{loading:"lazy",decoding:"async",className:"aspect-1 max-w-[265px] mx-auto rounded-xl object-cover",src:Mt}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start",children:[jsxRuntimeExports.jsxs(Link,{to:`/character/${ft}`,target:"_blank",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl break-all font-semibold font-roboto",children:xt?.name}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1 text-sm font-semibold",children:[jsxRuntimeExports.jsx(materialSymbolsBrush,{}),formatNum(xt?.usageCount)]})]}),jsxRuntimeExports.jsx(CharacterCollectButton,{artwork:He,character:xt,scene:"panel",collectedIcon:jsxRuntimeExports.jsx(mdiBookmarkCheck,{}),collected:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:ut("worlds:character.collected")}),notCollectedIcon:jsxRuntimeExports.jsx(materialSymbolsBookmarkAdd,{}),notCollected:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:ut("worlds:character.collect")})},xt.id)]}),At.length>0&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col mt-6 gap-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl break-all font-semibold font-roboto",children:ut("generation:character.lora-or-model")}),At.map(($t,Dt)=>jsxRuntimeExports.jsx(CharacterModelPreviewCard,{model:$t},Dt))]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2 p-3 mlg:border-t mlg:border-background-light",children:[!dt&&jsxRuntimeExports.jsx(UISwitch,{size:"small",isSelected:kt,onChange:Tt,children:jsxRuntimeExports.jsx("span",{className:"text-xs font-medium",children:ut("generation:character.preview.auto-change-model")})}),jsxRuntimeExports.jsx(UIButton$1,{busy:"auto",variant:"filled",onPress:Nt,children:ut(dt?"generation:character.preview.use-this-character":"generation:character.preview.confirm")})]})]})}function CharacterSelectDialog(He){const Qe=reactExports.useMemo(createCharacterFormStateAtom,[He.open]);return jsxRuntimeExports.jsx(ResponsiveDialog,{open:He.open,onClose:He.onClose,dialogProps:{maxWidth:!1,PaperProps:{style:{maxWidth:"1000px",maxHeight:"min(calc(100vh - 64px), 800px)"}}},breakpoint:"mlg",disableScrollLock:!1,children:jsxRuntimeExports.jsx(CharacterFormContext.Provider,{value:Qe,children:jsxRuntimeExports.jsx(GenerationSelectableDialogContextProvider,{children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(Preloader,{}),children:jsxRuntimeExports.jsx(CharacterSelectDialogContent,{onClose:He.onClose,onCharacterSelected:He.onCharacterSelected})})})})})}const CharacterSelectDialogContent=He=>{const{t:Qe}=useTranslation("generation"),it=useBreakpoint("mlg"),lt=reactExports.useContext(CharacterFormContext),[{currentListType:ut,keyword:dt,openDetail:xt},ft]=useImmerAtom(lt),vt=reactExports.useMemo(()=>[{id:CharacterTabType.Discover,label:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:character.type.discover"}),content:jsxRuntimeExports.jsx(TabContentWrapper,{children:jsxRuntimeExports.jsx(DiscoverCharacterGrid,{})})},{id:CharacterTabType.Collection,label:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:character.type.collection"}),content:jsxRuntimeExports.jsx(TabContentWrapper,{children:jsxRuntimeExports.jsx(BookmarkCharacterGrid,{})})}],[]),kt=Mt=>{ft(Nt=>{Nt.currentListType=Mt})},St=Mt=>{ft(Nt=>{track("panel_chter_search",{fromPath:"character",location:ut}),Nt.keyword=Mt})},Tt=reactExports.useCallback(Mt=>{track("add_chter_success",{scene:"market",chterId:Mt.character.id,hasAutoChangeModel:Mt.autoChangeModel,location:ut}),He.onCharacterSelected(Mt)},[He.onCharacterSelected,ut]);return jsxRuntimeExports.jsx(GenerationSelectableDialogContent,{showModalSheet:it,onClose:He.onClose,title:Qe("generation:character.label"),tabVal:ut,searchInput:jsxRuntimeExports.jsx(GenerationSelectableDialogSearchWrapper,{tabVal:ut,searchKeyword:dt,onInputChange:St,onClear:()=>{ft(Mt=>{Mt.keyword=""})},placeholder:Qe("generation:character.list.search-placeholder")}),tabs:vt,preview:jsxRuntimeExports.jsx(CharacterSelectPreview,{className:cx("w-full h-[var(--list-height)] mlg:h-[calc(var(--list-height)+54px)]","mlg:w-72 mlg:border-l mlg:border-background-light",it&&!xt&&"hidden"),onClose:He.onClose,onConfirm:Tt}),onOpenDetailChange:Mt=>{ft(Nt=>{Nt.openDetail=Mt})},openDetail:xt,onTabChange:kt,action:jsxRuntimeExports.jsx(Button,{color:"primary",href:"/worlds",target:"_blank",size:"large",startIcon:jsxRuntimeExports.jsx(icBaselineStore,{}),onClick:()=>{track("browse_market_click",{location:"more_characters"})},children:Qe("generation:character.list.market")})})};function TabContentWrapper({children:He}){const{t:Qe}=useTranslation("generation"),it=useBreakpoint("mlg"),lt=reactExports.useContext(CharacterFormContext),[{autoChangeModel:ut,characterId:dt},xt]=useImmerAtom(lt);return jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full h-full",children:[He,it&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0 p-3",children:[jsxRuntimeExports.jsx(UISwitch,{size:"small",isSelected:ut,onChange:ft=>xt(vt=>{vt.autoChangeModel=ft}),children:jsxRuntimeExports.jsx("span",{className:"text-xs font-medium",children:Qe("generation:character.preview.auto-change-model")})}),jsxRuntimeExports.jsx(Button,{disabled:dt===null,fullWidth:!0,variant:"contained",onClick:()=>{xt(ft=>{ft.openDetail=!0})},children:Qe("generation:character.preview.next-step")})]})]})}const useSelectedCharacter=()=>{const{values:He,setValues:Qe}=useTaskSubmitFormContext(),it=He.characterId??null,lt=reactExports.useCallback(ut=>{Qe(dt=>({...dt,characterId:ut}))},[Qe]);return[it,lt]};function CharacterSelect(){const{t:He}=useTranslation(["worlds","generation"]),[Qe,it]=useSelectedCharacter(),{values:lt,setValues:ut}=useTaskSubmitFormContext(),[dt,xt]=reactExports.useState(!1),ft=reactExports.useRef(null),[vt,kt]=useLocalStorage({key:"character::model-default-override",defaultValue:!1}),St=reactExports.useRef(null),[Tt,Mt]=reactExports.useContext(LastImportedItemContext),Nt=()=>{Tt===null?(Mt(""),setTimeout(()=>{Mt(void 0)},0)):Tt===""?(Mt(void 0),setTimeout(()=>{Mt("")},0)):Mt("")},At=reactExports.useCallback((Ft,Bt)=>{const Ot=structuredClone(lt),Qt=Ft?.parameters.prompts;setPreviousCharacterParameters(Ot),ut(Wt=>{let Xt=Wt.prompts??"";return Qt&&(Xt&&(Xt+=", "),Xt+=Qt,St.current=Qt),{...Wt,...Ft?.parameters,prompts:Xt,characterId:Bt??Wt.characterId}}),Nt()},[lt]),$t=()=>{const Ft=getPreviousCharacterParameters();if(Ft){const Bt=St.current,Ot=lt.prompts;let Qt;Bt&&Ot&&(Qt=Ot.replaceAll(Bt,"")),ut(Wt=>({...Ft,prompts:Qt??Wt.prompts,characterId:void 0})),clearPreviousCharacterParameters(),St.current=null}else Object.keys(lt).length>0&&ut(Bt=>({...Bt,modelId:void 0,lora:void 0}));Nt()};reactExports.useEffect(()=>{Qe?Qe&&ft.current!==Qe&&getCharacterMayApplyModel()&&(setCharacterModelApplyAccepted(),client.getCharacter({id:Qe}).then(async({character:Ft})=>{const Bt=Ft?.presets?.nodes??[];if(Bt.length>0){if(!vt){const{value:Ot,suffixSelected:Qt}=await dialogWorldCharacterConfirm({title:He("worlds:dialog.apply-model.title"),description:He("worlds:dialog.apply-model.content"),cancelLabel:He("worlds:dialog.apply-model.cancel"),confirmLabel:He("worlds:dialog.apply-model.confirm"),suffixLabel:He("worlds:dialog.apply-model.remember")});if(track("chter_model_change",{value:Ot,hasRemember:Qt}),!Ot)return;Qt&&kt(!0)}At(Bt[0])}})):$t()},[Qe,ft]),reactExports.useEffect(()=>()=>{clearPreviousCharacterParameters()},[]);const Dt=jsxRuntimeExports.jsx(UITooltipHelpIcon,{children:jsxRuntimeExports.jsx("p",{className:"p-4 text-sm w-80 whitespace-pre-wrap",children:He("generation:character.help")})});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center",children:[jsxRuntimeExports.jsx("p",{className:"font-semibold text-sm",children:He("generation:character.label")}),Dt]}),Qe?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CharacterSelectCard,{characterId:Qe,onClick:()=>xt(!0)}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1 items-center justify-center cursor-pointer text-sm font-semibold font-roboto underline text-[#6d6d6d] mx-auto",onClick:()=>{track("rm_chter_click",{chterId:Qe}),it(void 0)},children:[jsxRuntimeExports.jsx(mdiTrashCan,{}),He("generation:character.remove")]})]}):jsxRuntimeExports.jsx(SelectCard,{className:"dark:text-white",title:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[He("generation:character.add.title")," ",jsxRuntimeExports.jsx(mdiPlus,{})]}),subtitle:He("generation:character.add.description"),onClick:()=>{track("add_chter_click"),xt(!0)}}),jsxRuntimeExports.jsx(CharacterSelectDialog,{open:dt,onClose:()=>xt(!1),onCharacterSelected:async Ft=>{if(Qe&&(track("rm_chter_click",{chterId:Qe}),$t()),ft.current=Ft.character.id,Ft.autoChangeModel&&Ft.character.presets?.nodes?.length&&Ft.character.presets.nodes.length>0){const Bt=Ft.character.presets.nodes[0];At(Bt,Ft.character.id)}else it(Ft.character.id)}})]})}function CharacterSelectCard({characterId:He,onClick:Qe}){const{data:it,isValidating:lt}=useCharacter(He);return it?jsxRuntimeExports.jsx(SelectCard,{image:getThumbnailUrl(it?.media),title:it?.name,subtitle:it?.worlds?.[0].name,onClick:Qe}):lt?jsxRuntimeExports.jsx(CircularSpinner,{}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})}function SelectCard({image:He,title:Qe,subtitle:it,className:lt,onClick:ut,...dt}){return jsxRuntimeExports.jsxs("div",{...dt,className:cx("flex mt-2 rounded-xl p-[10px] gap-3 items-center bg-background-light",ut&&"cursor-pointer",lt),onClick:ut,children:[jsxRuntimeExports.jsx("div",{className:"border border-px rounded-xl overflow-hidden size-16",children:He&&jsxRuntimeExports.jsx("img",{className:"w-full h-full object-cover",src:He})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-1 font-inter",children:[jsxRuntimeExports.jsx("div",{className:"text-[15px] font-semibold flex items-center gap-1",children:Qe}),jsxRuntimeExports.jsx("div",{className:"text-xs font-medium",children:it})]})]})}const useUIDensity=()=>{const He=useBreakpoint("mlg","up"),Qe=useBreakpoint("xlg"),it=He&&Qe;return reactExports.useEffect(()=>{it?document.body.classList.add("dense"):document.body.classList.remove("dense")},[it]),{desktop:He,dense:it,denseMode:it?"dense":void 0}},icRoundCancel=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10s10-4.47 10-10S17.53 2 12 2zm4.3 14.3a.996.996 0 0 1-1.41 0L12 13.41L9.11 16.3a.996.996 0 1 1-1.41-1.41L10.59 12L7.7 9.11A.996.996 0 1 1 9.11 7.7L12 10.59l2.89-2.89a.996.996 0 1 1 1.41 1.41L13.41 12l2.89 2.89c.38.38.38 1.02 0 1.41z"})});function MenuItemWithToggle(He){const{t:Qe}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs("div",{className:cx("grid items-center grid-cols-[16px_1fr_auto] gap-1 w-full py-3",He.checked?"text-neutral-400 dark:text-neutral-500":"",He.disabled&&"cursor-not-allowed text-neutral-400 dark:text-neutral-500"),children:[jsxRuntimeExports.jsx(He.startIcon,{className:"size-4"}),jsxRuntimeExports.jsx(UITooltipTriggerWrapper,{placement:"bottom start",className:"justify-self-start max-w-md",delay:250,trigger:jsxRuntimeExports.jsx($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{className:"justify-self-start font-medium text-sm ",children:He.label}),children:jsxRuntimeExports.jsx("div",{className:"p-4",children:He.helpText})}),jsxRuntimeExports.jsx("button",{disabled:He.disabled,className:cx("px-3 h-[22px] flex items-center justify-center gap-1 rounded-md bg-neutral-50 dark:bg-neutral-600","ring-1 ring-neutral-300 dark:ring-neutral-500 ",He.disabled&&"cursor-not-allowed","w-[78px]","relative"),onClick:()=>He.onCheckedChange?.(!He.checked),children:He.checked?jsxRuntimeExports.jsx("span",{className:"truncate leading-none text-sm",children:Qe("generation:booster.action.remove.label")}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[He.shouldShowMembershipBadge?jsxRuntimeExports.jsx(MembershipIconCircled,{className:"size-4"}):jsxRuntimeExports.jsx(icRoundPlus,{className:"size-4 shrink-0"}),jsxRuntimeExports.jsx("span",{className:"truncate leading-none text-sm",children:Qe("generation:booster.action.add.label")})]})})]})}function BoosterLabel(He){const Qe=jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(He.startIcon,{className:"[@media(any-hover:hover)]:group-hover:hidden"}),He.enableClose&&jsxRuntimeExports.jsx("button",{onClick:He.onClose,className:"hidden [@media(any-hover:hover)]:group-hover:block",children:jsxRuntimeExports.jsx(icRoundCancel,{className:"text-neutral-600 dark:text-neutral-400"})})]}),it=He.endIcons?jsxRuntimeExports.jsx(He.endIcons,{className:cx("text-neutral-600 dark:text-neutral-400",He.disabled?"text-neutral-200 dark:text-neutral-700":"hover:text-feat-brand-100")}):null;return jsxRuntimeExports.jsxs("div",{className:cx("flex items-center gap-1",He.className),style:He.style,children:[jsxRuntimeExports.jsxs("div",{className:cx("group","py-[3px] grid grid-flow-col gap-1 items-center rounded-full transition duration-75 ease-out","pl-2 pr-3 dense:pl-2 dense:pr-2","bg-neutral-50 dark:bg-neutral-700","ring-1 ring-neutral-300 dark:ring-neutral-500 hover:ring-feat-brand-100","outline-none select-none","text-sm font-medium",He.disabled&&"cursor-not-allowed text-neutral-200 dark:text-neutral-800 line-through hover:ring-neutral-300 hover:dark:ring-neutral-700",He.endIcons?"grid-cols-[1rem_1fr_auto] dense:grid-cols-[1rem_auto]":"grid-cols-[1rem_1fr]"),children:[jsxRuntimeExports.jsx("div",{className:"flex items-center",children:Qe}),jsxRuntimeExports.jsx("div",{className:cx("content",He.contentClassName),children:He.children}),it&&jsxRuntimeExports.jsx("div",{className:"flex items-center dense:col-span-2",children:it})]}),He.enableClose&&jsxRuntimeExports.jsx("button",{onClick:He.onClose,className:"block [@media(any-hover:hover)]:hidden",children:jsxRuntimeExports.jsx(icRoundCancel,{className:"size-4 text-neutral-600 dark:text-neutral-400"})})]})}const AddBoosterButton=reactExports.forwardRef(function He(Qe,it){const{className:lt,shouldHighLight:ut,...dt}=Qe,{t:xt}=useTranslation(["generation"]),{denseMode:ft}=useUIDensity();return jsxRuntimeExports.jsxs($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{className:cx("relative","py-[3px] flex items-center pl-[14px] gap-1 pr-2 rounded-full transition duration-75 ease-out","bg-neutral-50 dark:bg-neutral-700","ring-1","outline-none","text-sm font-medium",ut?"ring-feat-brand-100/40":"ring-neutral-300 dark:ring-neutral-500",lt),...dt,ref:it,style:ut?{"--size":48,"--duration":4,"--anchor":90,"--border-width":2,"--color-from":"#9535EA","--color-via":"#EA79F1","--color-to":"#FB7188","--delay":"-9s"}:void 0,children:[jsxRuntimeExports.jsx("div",{className:cx("pointer-events-none absolute inset-[-1px] rounded-[inherit] [border:calc(var(--border-width)*1px)_solid_transparent]","![mask-clip:padding-box,border-box] ![mask-composite:intersect] [mask:linear-gradient(transparent,transparent),linear-gradient(white,white)]","after:absolute after:aspect-[3/1] after:w-[calc(var(--size)*1px)] after:animate-border-beam after:[animation-delay:var(--delay)] after:[background:linear-gradient(to_left,var(--color-from),var(--color-via),var(--color-to),transparent)] after:[offset-anchor:calc(var(--anchor)*1%)_50%] after:[offset-path:rect(0_auto_auto_0_round_calc(var(--size)*1px))]")}),xt("generation:booster.add-booster.label",{context:ft}),jsxRuntimeExports.jsx(icRoundPlus,{className:"size-4"})]})}),[BoosterControlItemOrderContext,BoosterControlItemOrderContextProvider]=createCtx({order:[]});BoosterControlItemOrderContext.displayName="BoosterControlItemOrderContext";function useUpdateBoosterControlOrderContext(He){const[,Qe]=reactExports.useContext(BoosterControlItemOrderContext);return reactExports.useCallback(lt=>{Qe(ut=>{const{order:dt}=ut,xt=dt.filter(ft=>ft===He);return{...ut,order:lt?[...xt,He]:xt}})},[He])}const icRoundTagFaces=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM8.5 8c.83 0 1.5.67 1.5 1.5S9.33 11 8.5 11S7 10.33 7 9.5S7.67 8 8.5 8zm8.25 6.75c-.95 1.64-2.72 2.75-4.75 2.75s-3.8-1.11-4.75-2.75c-.19-.33.06-.75.44-.75h8.62c.39 0 .63.42.44.75zM15.5 11c-.83 0-1.5-.67-1.5-1.5S14.67 8 15.5 8s1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"})});function useFaceFixState(){const{setValues:He,values:Qe}=useTaskSubmitFormContext(),{enableADetailer:it,modelId:lt}=Qe,ut=useModelVersion(lt),dt=!hasModelDisabledFaceFix(ut?.extra),xt=!!it,ft=reactExports.useCallback(vt=>{track("facefix_select",{checked:vt}),He(vt?kt=>({...kt,enableADetailer:!0}):produce(kt=>{delete kt.enableADetailer}))},[]);return[{enabled:xt,canFaceFix:dt},ft]}function FaceFixBoosterControl(He){const{t:Qe}=useTranslation(["generation"]),[it,lt]=useFaceFixState();return it.enabled?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(BoosterLabel,{enableClose:!0,contentClassName:"dense:hidden",startIcon:icRoundTagFaces,onClose:()=>{lt(!1)},...He,children:Qe("generation:booster.face-fix.label")})}):null}function FaceFixMenuItemToggle(He){const{t:Qe}=useTranslation(["generation"]),[{enabled:it,canFaceFix:lt},ut]=useFaceFixState();return jsxRuntimeExports.jsx(MenuItemWithToggle,{startIcon:icRoundTagFaces,label:Qe("generation:booster.face-fix.label"),checked:it,helpText:Qe("generation:booster.face-fix.help"),onCheckedChange:dt=>{He.afterCheckedChange?.(dt),ut(dt)},disabled:!lt})}const SvgHires=He=>reactExports.createElement("svg",{width:17,height:16,viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...He},reactExports.createElement("rect",{x:3.08398,y:13.7139,width:11.4286,height:2.28571,rx:1.14286,fill:"currentColor"}),reactExports.createElement("path",{d:"M11.7043 6.82898C11.2858 10.8345 8.62282 12.5408 6.80398 13.2452C6.55378 13.3421 6.22776 12.7455 6.36096 12.5126C7.29641 10.8768 7.38391 8.17006 7.36319 6.82898H4.22656L9.33496 0L14.5123 6.82898H11.7043Z",fill:"currentColor"})),iconParkOutlineSettingConfig=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 48 48",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:4,d:"M41.5 10h-6m-8-4v8m0-4h-22m8 14h-8m16-4v8m22-4h-22m20 14h-6m-8-4v8m0-4h-22"})});function SliderInputParamItem({title:He,value:Qe,inputProps:it,safeRange:lt,handleChange:ut,className:dt,disabled:xt}){return jsxRuntimeExports.jsxs("div",{className:dt,children:[jsxRuntimeExports.jsx("p",{className:"text-base text-primary-light",children:He}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4 pt-2",children:[jsxRuntimeExports.jsx(Slider,{disabled:xt,className:cx("max-w-[400px]",lt&&!xt&&(Qe<lt.min||Qe>lt.max)?"text-red-500":""),value:Qe,onChange:(ft,vt)=>{ut(vt)},min:it?.min,max:it?.max,step:it?.step,valueLabelDisplay:"auto"}),jsxRuntimeExports.jsx(Input,{disabled:xt,type:"number",className:cx("w-[60px]",lt&&!xt&&(Qe<lt.min||Qe>lt.max)?"text-red-500":""),value:Qe,onChange:ft=>{const vt=+ft.target.value;ut(clamp$1(vt,it?.min??0,it?.max))},inputProps:it})]})]})}const FLOOR=8,DEFAULT_SCALE_TO=1344,MAX_UPSCALE_TO=2048,MAX_ENLARGE_TO=2688;function getFlooredValue(He,Qe){return Math.floor(He*Qe/FLOOR)*FLOOR}function getMaxUpscaleRatio({width:He,height:Qe}){if(He==null||Qe==null)return;const it=MAX_UPSCALE_TO;return Math.floor(Math.min(it/He,it/Qe)*10)/10}function getDefaultUpscaleRatio({width:He,height:Qe}){if(He==null||Qe==null)return;const it=DEFAULT_SCALE_TO,lt=Math.floor(Math.min(it/He,it/Qe)*10)/10,ut=getMaxUpscaleRatio({width:He,height:Qe});if(!ut)return;const dt=Math.min(lt,ut);return dt<1.1?1.1:dt}function getMaxEnlargableRatio({width:He,height:Qe}){if(He==null||Qe==null)return;const it=MAX_ENLARGE_TO;return Math.floor(Math.min(it/He,it/Qe)*10)/10}function getDefaultEnlargeRatio({width:He,height:Qe}){if(He==null||Qe==null)return;const it=DEFAULT_SCALE_TO,lt=Math.floor(Math.min(it/He,it/Qe)*10)/10,ut=getMaxEnlargableRatio({width:He,height:Qe});if(!ut)return;const dt=Math.min(lt,ut);return dt<1.1?1.1:dt}const parseInitialValuesForNote=({media:He,noteContent:Qe,defaultValues:it=defaultTaskFormValues,taskModelList:lt=[],samplingMethods:ut=samplingMethodChoices,extraInitialValues:dt={}})=>({...it,...He?{strength:.7,baseImage:UnFile.fromMedia(He),...getCompressedDimensions(He),size:void 0}:{},...pickBy(Qe,(xt,ft)=>{if(ft==="samplingMethod"&&!ut.includes(xt)||ft==="model"&&!lt.map(vt=>vt.model).includes(xt))return!1;if(xt!=null)return!0}),...dt}),getTaskAndMediaIds=He=>{if(He){if(isI2vProTask(He)||isT2I2VTask(He))return[{taskId:He.id,mediaId:He.mediaId||void 0,bookmarked:!!He.favoritedAt}];if(He.parameters.batchSize>1){if(!He.outputs.batch)return Array.from({length:He.parameters.batchSize}).map(()=>({taskId:He.id,mediaId:void 0}));const Qe=(He?.outputs.batch??[]).map(it=>({mediaId:it.mediaId,taskId:He.id,deleted:!!it.deletedAt,bookmarked:!!it.favoritedAt}));return He.parameters.batchSize===3&&He.parameters.mediaId?[{taskId:He.id,mediaId:He.parameters.mediaId},...Qe]:Qe}return isWorkflowTask(He)?[{taskId:He.id,taskType:"workflow",mediaId:He.outputs.batch?.[0]?.mediaId||He.outputs.mediaId}]:[{taskId:He.id,mediaId:He.mediaId||void 0,bookmarked:!!He.favoritedAt}]}},getNewGeneratedItems=(He,Qe)=>He.length===1?[{taskId:Qe.id,mediaId:Qe.mediaId}]:He.length===4?getTaskAndMediaIds(Qe)??[]:[],getTaskDimensionsForImport=(He,Qe)=>He?Qe?{width:Qe.width,height:Qe.height}:!He.parameters?.width||!He.parameters?.height?{width:He.media?.width,height:He.media?.height}:{width:He.parameters?.width,height:He.parameters?.height}:{width:void 0,height:void 0},isMediaFaved=(He,Qe)=>Qe?(He?.outputs.batch??[]).some(it=>it.mediaId===Qe&&!!it.favoritedAt):!1,getMediaIdx=(He,Qe)=>{if(!Qe||!Array.isArray(He?.outputs.batch))return;const it=(He?.outputs?.batch??[]).findIndex(lt=>lt.mediaId===Qe);if(!(it<0))return it},updatePromptsWithTriggerWords=({prompts:He,wordsToAppend:Qe,wordsToDelete:it})=>{let lt=He??"";return it.length>0&&it.forEach(ut=>{lt=lt.replaceAll(ut,"")}),Qe.length>0&&(lt=[lt,Qe.join(",")].filter(ut=>!!ut).join(",")),lt.replaceAll(/,+/g,",")},DEFAULT_SD_SCALE=2,DEFAULT_SDXL_SCALE=1.5,DEFAULT_STRENGTH=.6;function getDefaultHiresParams(He){return{upscale:He?DEFAULT_SD_SCALE:DEFAULT_SDXL_SCALE,upscaleDenoisingSteps:DEFAULT_SAMPLING_STEPS,upscaleDenoisingStrength:DEFAULT_STRENGTH}}function useHiresParametersState(){const{setValues:He,values:Qe}=useTaskSubmitFormContext(),{upscale:it,modelId:lt,width:ut,height:dt}=Qe,xt=useModelVersion(lt),ft=isSDV1Model(xt?.modelType),vt=xt?.extra?.defaults??{},kt=xt?.extra?.restrictions??{},St=pick$1(kt,["upscale","upscaleSampler","upscaleDenoisingSteps","upscaleDenoisingStrength"]),Tt=getDefaultHiresParams(ft),Mt=!hasModelDisabledUpscale(xt?.extra),Nt=(it??1)>1,At=reactExports.useCallback(Bt=>{track("hires_enabled_selected",{checked:Bt}),He(Bt?Ot=>({...Ot,batchSize:1,upscale:Tt.upscale,upscaleDenoisingSteps:vt.upscaleDenoisingSteps??Ot.samplingSteps??Tt.upscaleDenoisingSteps,upscaleDenoisingStrength:vt.upscaleDenoisingStrength??Tt.upscaleDenoisingStrength,upscaleSampler:vt.upscaleSampler??""}):produce(Ot=>{delete Ot.upscale,delete Ot.upscaleDenoisingSteps,delete Ot.upscaleDenoisingStrength,delete Ot.upscaleSampler}))},[Tt.upscale,Tt.upscaleDenoisingSteps,Tt.upscaleDenoisingStrength,vt.upscaleDenoisingSteps,vt.upscaleDenoisingStrength,vt.upscaleSampler]),$t=reactExports.useMemo(()=>({scale:Qe.upscale>1?Qe.upscale:Tt.upscale,step:Qe.upscaleDenoisingSteps,strength:Qe.upscaleDenoisingStrength,upscaleSampler:Qe.upscaleSampler??""}),[Qe.upscale,Qe.upscaleDenoisingSteps,Qe.upscaleDenoisingStrength,Qe.upscaleSampler,Tt.upscale]),Dt=reactExports.useCallback(Bt=>{He(Ot=>({...Ot,upscale:Bt.scale,upscaleDenoisingSteps:Bt.step,upscaleDenoisingStrength:Bt.strength,upscaleSampler:Bt.upscaleSampler}))},[]),Ft=reactExports.useMemo(()=>({width:ut,height:dt}),[ut,dt]);return[{enabled:Nt,canHires:Mt},At,{formDefaults:$t,setHiresValues:Dt,hiresValues:Ft,formValueRestrictionConfig:St}]}const MIN_UPSCALE_STEPS=1,MAX_UPSCALE_STEPS=50,UPSCALE_STEPS_STEP=1,MIN_UPSCALE_STRENGTH=.01,MAX_UPSCALE_STRENGTH=.99,UPSCALE_STRENGTH_STEP=.01,DEFAULT_MIN_UPSCALE_RATIO=1,DEFAULT_MAX_UPSCALE_RATIO=2,DEFAULT_UPSCALE_RATIO_STEP=.1,MIN_UPSCALE_STRENGTH_SAFERANGE=.4,MAX_UPSCALE_STRENGTH_SAFERANGE=.6;function HiResBoosterControl(He){const{t:Qe}=useTranslation(["generation"]),[it,lt,{formDefaults:ut,formValueRestrictionConfig:dt,setHiresValues:xt,hiresValues:ft}]=useHiresParametersState(),vt=reactExports.useRef(null);return it.enabled?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(BoosterLabel,{enableClose:!0,contentClassName:"dense:hidden",startIcon:SvgHires,onClose:()=>{lt(!1)},endIcons:kt=>jsxRuntimeExports.jsx("button",{onClick:()=>{vt.current?.open()},disabled:kt.disabled,children:jsxRuntimeExports.jsx(iconParkOutlineSettingConfig,{className:kt.className})}),...He,children:Qe("generation:booster.hires.label")}),jsxRuntimeExports.jsx(HiresUpscaleDialog,{ref:vt,width:ft.width,height:ft.height,formDefaults:ut,onConfirm:kt=>{xt(kt)},formValueRestrictionConfig:dt})]}):null}function HiresMenuItemToggle(He){const{t:Qe}=useTranslation(["generation"]),[{enabled:it,canHires:lt},ut]=useHiresParametersState();return jsxRuntimeExports.jsx(MenuItemWithToggle,{startIcon:SvgHires,label:Qe("generation:booster.hires.label"),checked:it,helpText:Qe("generation:booster.hires.help"),onCheckedChange:dt=>{He.afterCheckedChange?.(dt),ut(dt)},disabled:!lt})}const HiresUpscaleDialog=reactExports.forwardRef(function He({width:Qe,height:it,onConfirm:lt,formDefaults:ut,formValueRestrictionConfig:dt},xt){const{t:ft}=useTranslation(["generation","action"]),vt=dt?.upscale?.min??DEFAULT_MIN_UPSCALE_RATIO,kt=reactExports.useMemo(()=>{const Qt=getMaxUpscaleRatio({width:Qe,height:it}),Wt=dt?.upscale?.max;return Qt&&Wt?Math.min(Qt,Wt):Qt??Wt??DEFAULT_MAX_UPSCALE_RATIO},[Qe,it,dt?.upscale?.max]),St=kt&&kt>1&&Qe&&it,Tt=dt?.upscaleDenoisingStrength?.disabled?{min:MIN_UPSCALE_STRENGTH,max:MAX_UPSCALE_STRENGTH}:{min:MIN_UPSCALE_STRENGTH_SAFERANGE,max:MAX_UPSCALE_STRENGTH_SAFERANGE},[{scale:Mt,step:Nt,strength:At,upscaleSampler:$t},Dt]=reactExports.useState(ut),[Ft,Bt]=reactExports.useState(!1),Ot=()=>{track("add_composition_success"),lt({scale:Mt,step:Nt,strength:At,upscaleSampler:$t}),Bt(!1)};return reactExports.useImperativeHandle(xt,()=>({open:()=>Bt(!0),close:()=>Bt(!1),reset:Qt=>Dt(Qt)}),[]),jsxRuntimeExports.jsxs(UIDialog,{open:Ft,onClose:()=>Bt(!1),className:"md:min-w-96",children:[jsxRuntimeExports.jsx(UIDialogHeader,{className:"font-bold",heading:ft("generation:hires.dialog.title")}),St?jsxRuntimeExports.jsxs(UIDialogContent,{children:[jsxRuntimeExports.jsx("p",{className:"text-base text-primary-light",children:ft("generation:hires.resolution.label")}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4 pt-2 items-center",children:[jsxRuntimeExports.jsx(Slider,{className:"max-w-[400px]",value:Mt,onChange:(Qt,Wt)=>{Dt(Xt=>({...Xt,scale:Wt}))},min:vt,max:kt,step:DEFAULT_UPSCALE_RATIO_STEP,valueLabelDisplay:"auto"}),jsxRuntimeExports.jsx("p",{children:Mt.toFixed(1)})]}),jsxRuntimeExports.jsxs("p",{children:[Qe,"×",it," → ",getFlooredValue(Qe,Mt),"×",getFlooredValue(it,Mt)]}),jsxRuntimeExports.jsxs("div",{className:"pt-8",children:[jsxRuntimeExports.jsx(SliderInputParamItem,{title:ft("generation:hires.strength.label"),value:At,inputProps:{min:dt?.upscaleDenoisingStrength?.min??MIN_UPSCALE_STRENGTH,max:dt?.upscaleDenoisingStrength?.max??MAX_UPSCALE_STRENGTH,step:UPSCALE_STRENGTH_STEP},safeRange:Tt,handleChange:Qt=>{Dt(Wt=>({...Wt,strength:Qt}))},disabled:dt?.upscaleDenoisingStrength?.disabled}),!dt?.upscaleDenoisingStrength?.disabled&&jsxRuntimeExports.jsx("p",{className:cx("text-sm text-gray-400",At<Tt.min||At>Tt.max?"text-red-500":""),children:ft("generation:hires.strength.description")})]}),jsxRuntimeExports.jsx("div",{className:"pt-8",children:jsxRuntimeExports.jsx(SliderInputParamItem,{title:ft("generation:hires.steps.label"),value:Nt,inputProps:{min:dt?.upscaleDenoisingSteps?.min??MIN_UPSCALE_STEPS,max:dt?.upscaleDenoisingSteps?.max??MAX_UPSCALE_STEPS,step:UPSCALE_STEPS_STEP},handleChange:Qt=>{Dt(Wt=>({...Wt,step:Qt}))},disabled:dt?.upscaleDenoisingSteps?.disabled})}),jsxRuntimeExports.jsx("div",{className:"pt-8",children:jsxRuntimeExports.jsx(SamplerSelect,{value:$t,onChange:Qt=>{const Wt=Qt.target.value;Dt(Xt=>({...Xt,upscaleSampler:Wt}))},allowedSamplers:dt?.upscaleSampler?.allowed,disallowedSamplers:dt?.upscaleSampler?.disallowed,selectClassName:"mt-1",disabled:dt?.upscaleSampler?.disabled})})]}):jsxRuntimeExports.jsx(UIDialogContent,{children:jsxRuntimeExports.jsx("p",{children:ft("generation:upscale.limit-reached")})}),jsxRuntimeExports.jsxs(UIDialogFooter,{className:"pb-4",children:[jsxRuntimeExports.jsx(UIButton$1,{onPress:()=>Bt(!1),children:ft("action:cancel")}),St&&jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",className:"font-bold",onPress:Ot,children:ft("action:confirm")})]})]})});function SamplerSelect({value:He="",onChange:Qe,selectClassName:it,disabled:lt,allowedSamplers:ut,disallowedSamplers:dt}){const{t:xt}=useTranslation(["generation"]),{data:ft,isValidating:vt}=useDynamicConstants(),{samplingMethods:kt}=ft??{},St=(ut??kt??[]).filter(Tt=>!dt?.includes(Tt));return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("p",{className:"text-base text-primary-light",children:xt("generation:hires.sampler-select.label")}),jsxRuntimeExports.jsx(FormControl,{className:"flex gap-2 items-center",children:vt&&St.length<1?jsxRuntimeExports.jsx(CircularSpinner,{}):jsxRuntimeExports.jsxs(Select,{fullWidth:!0,disabled:lt,className:cx("max-w-[500px]",it),value:He,displayEmpty:!0,onChange:Qe,children:[jsxRuntimeExports.jsx(MenuItem$1,{value:"",children:xt("generation:hires.sampler-select.empty-placeholder")}),St.map(Tt=>jsxRuntimeExports.jsx(MenuItem$1,{value:Tt,children:Tt},Tt))]})})]})}const listboxItemStyles=ce$1({base:"group relative grid grid-cols-[1fr_auto] items-center gap-8 cursor-default select-none py-1.5 px-2.5 rounded-md will-change-transform text-sm forced-color-adjust-none",variants:{isSelected:{false:"text-neutral-700 dark:text-neutral-200 hover:bg-violet-200 dark:hover:bg-violet-500 -outline-offset-2",true:"bg-violet-700 text-white forced-colors:bg-[Highlight] forced-colors:text-[HighlightText] [&:has(+[data-selected])]:rounded-b-none [&+[data-selected]]:rounded-t-none -outline-offset-4 outline-white dark:outline-white forced-colors:outline-[HighlightText]"},isDisabled:{true:"text-slate-300 dark:text-zinc-600 forced-colors:text-[GrayText]"}}});function UIListBoxItem(He){const{startIcon:Qe,endIcon:it,className:lt,...ut}=He;return jsxRuntimeExports.jsx($eed445e0843c11d0$export$a11e76429ed99b4,{...ut,className:$64fa3d84918910a7$export$c245e6201fed2f75(lt,(dt,xt)=>listboxItemStyles({...xt,className:dt})),children:$64fa3d84918910a7$export$c245e6201fed2f75(He.children,dt=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Qe,dt,it]}))})}const materialSymbolsDeleteForever=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m9.4 16.5l2.6-2.6l2.6 2.6l1.4-1.4l-2.6-2.6L16 9.9l-1.4-1.4l-2.6 2.6l-2.6-2.6L8 9.9l2.6 2.6L8 15.1l1.4 1.4ZM7 21q-.825 0-1.413-.588T5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.588 1.413T17 21H7Z"})}),mdiTag=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M5.5 7A1.5 1.5 0 0 1 4 5.5A1.5 1.5 0 0 1 5.5 4A1.5 1.5 0 0 1 7 5.5A1.5 1.5 0 0 1 5.5 7m15.91 4.58l-9-9C12.05 2.22 11.55 2 11 2H4c-1.11 0-2 .89-2 2v7c0 .55.22 1.05.59 1.41l8.99 9c.37.36.87.59 1.42.59c.55 0 1.05-.23 1.41-.59l7-7c.37-.36.59-.86.59-1.41c0-.56-.23-1.06-.59-1.42Z"})}),useGetMySetting=modifyQueryHook(createQueryHook(GetMySettingDocument),{transform:He=>({id:He}),reduce:He=>He?.setting}),useListMySettings=modifyQueryHook(createQueryHook(ListMySettingsDocument),{reduce:He=>He?.me?.settings}),fetchListMySettings=createFetchQueryHelper(ListMySettingsDocument),useGetMySettingLimit=modifyQueryHook(createQueryHook(GetMySettingLimitDocument),{transform:He=>({type:He}),reduce:He=>He?.me?.settingLimit}),[useUpsertMySetting,executeUpsertMySetting]=createMutationHelper(UpsertMySettingDocument),[useDeleteMySetting,executeDeleteMySetting]=createMutationHelper(DeleteMySettingDocument),COMMON_MODEL_ID="COMMON",initState={tags:{}},qualityTagStorageAtom=atomWithStorage(USED_MODEL_QUALITY_TAGS_STORAGE_KEY,initState),openAddQualityTagDialogAtom=atom(!1),openQualityTagDialogAtom=atom(!1);function useQualityTagToggleState(){const He=useUpdateBoosterControlOrderContext("QualityTag"),{t:Qe}=useTranslation(["generation"]),{beingMember:it,me:lt}=useMe(),ut=!!lt?.id,{data:dt,loading:xt,refetch:ft}=useListMySettings(it?{type:UserSettingType.QualityTag,last:1}:skipToken),[vt,kt]=useAtom(openAddQualityTagDialogAtom),[St,Tt]=useAtom(openQualityTagDialogAtom),{setValues:Mt,values:Nt}=useTaskSubmitFormContext(),{modelId:At}=Nt,$t=useModelVersion(At),Dt=$t?.modelId,[Ft,Bt]=useImmerAtom(qualityTagStorageAtom),Ot=reactExports.useMemo(()=>Dt?Ft?.tags?.[Dt]:void 0,[Dt,Ft]),Qt=getModelQualityTags($t?.extra)??getModelQualityTags($t?.model?.extra),Wt=reactExports.useMemo(()=>Qt?.[0],[Qt]),Xt=reactExports.useMemo(()=>Ot??Wt,[Ot,Wt]),Kt=reactExports.useMemo(()=>!!Nt.qualityTag?.prefix||!!Nt.qualityTag?.suffix,[Nt.qualityTag]),Jt=reactExports.useMemo(()=>Nt.qualityTag,[Nt.qualityTag]),hr=reactExports.useCallback(Cr=>{track("quality_tag_enabled_selected",{checked:Cr}),Mt(Rr=>({...Rr,qualityTag:Cr&&!Rr.qualityTag?Xt:void 0})),He(Cr)},[Xt]),xr=reactExports.useCallback(Cr=>{Dt&&(Bt(Rr=>{Rr.tags[Dt]=Cr}),Mt(Rr=>({...Rr,qualityTag:Cr})))},[Dt,Bt]),gr=reactExports.useMemo(()=>getNodesFromConnection(dt)?.[0]?.data?.[COMMON_MODEL_ID]??[],[dt]),br=Qt&&Qt.length>0,vr=gr.length>0,yr=reactExports.useCallback(Cr=>{if(!Cr)return hr(Cr);if(br)return Tt(!0);if(!ut)return openSignModal();if(!it)return openProceedMembershipModal({membershipModalProps:{trackingLocation:"add-booster-add-quality-tag"},confirmationDialogProps:{heading:Qe("generation:booster.quality-tag.membership-confirm-dialog.title"),content:Qe("generation:booster.quality-tag.membership-confirm-dialog.description")}});vr?Tt(!0):kt(!0)},[br,it,vr,hr,ut]);return[{enabled:Kt,modelHasPresetTags:br,userCanAddCustomTags:it,openAddDialog:vt,openDialog:St},{toggleQualityTag:hr,setOpenAddDialog:kt,setOpenDialog:Tt,onAddRemoveClick:yr,mutateSettings:ft,setQualityTagValue:xr},{presetQualityTags:Qt,customQualityTags:gr,qualityTagValue:Jt,modelId:Dt}]}async function updateCustomQualityTag(He){const Qe=COMMON_MODEL_ID,{payload:it,type:lt}=He;lt==="add"&&parse(QualityTagSchema,it);const dt=(await fetchListMySettings({type:UserSettingType.QualityTag,last:1})).data,xt=getNodesFromConnection(dt.me?.settings)?.[0],ft=xt?.id,vt=xt?.data,kt=vt?.[Qe]??[];if(lt==="add"&&kt.some(Nt=>Nt.prefix===it.prefix&&Nt.suffix===it.suffix))throw new Error("Tag already added");const Tt=produce(kt,Nt=>{lt==="add"&&Nt.push(it),lt==="remove"&&Nt.splice(it.index,1)}),Mt={...vt,[Qe]:Tt};return executeUpsertMySetting({id:ft,type:UserSettingType.QualityTag,data:Mt})}const MAX_ALLOWED_CUSTOM_TAG=3;function QualityTagBoosterControl(He){const{t:Qe}=useTranslation(["generation"]),[it,lt,{presetQualityTags:ut=[],qualityTagValue:dt,customQualityTags:xt,modelId:ft}]=useQualityTagToggleState();return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[it.enabled&&jsxRuntimeExports.jsx(BoosterLabel,{enableClose:!0,contentClassName:"dense:hidden",startIcon:mdiTag,onClose:()=>{lt.toggleQualityTag(!1)},endIcons:vt=>jsxRuntimeExports.jsx("button",{onClick:()=>{lt.setOpenDialog(!0)},disabled:vt.disabled,children:jsxRuntimeExports.jsx(iconParkOutlineSettingConfig,{className:vt.className})}),...He,children:Qe("generation:quality-tag.label")}),jsxRuntimeExports.jsx(QualityTagDialog,{qualityTag:dt,presetQualityTags:ut,customQualityTags:xt,setQualityTagValue:lt.setQualityTagValue,mutateSettings:lt.mutateSettings,toggleQualityTag:lt.toggleQualityTag,onCustomize:()=>{it.userCanAddCustomTags?lt.setOpenAddDialog(!0):openMembershipMoreCreditsModal({trackingLocation:"quality-tag-dialog-customize"})},open:it.openDialog,onClose:()=>lt.setOpenDialog(!1),modelId:ft,userCanAddCustomTags:it.userCanAddCustomTags}),jsxRuntimeExports.jsx(AddQualityTagFormDialog,{open:it.openAddDialog,onClose:()=>lt.setOpenAddDialog(!1),modelId:ft,openQualityTagDialog:()=>lt.setOpenDialog(!0),mutateSettings:lt.mutateSettings,customQualityTags:xt})]})}function QualityTagMenuItemToggle(He){const{t:Qe}=useTranslation(["generation"]),[{enabled:it,userCanAddCustomTags:lt,modelHasPresetTags:ut},dt]=useQualityTagToggleState();return jsxRuntimeExports.jsx(MenuItemWithToggle,{startIcon:mdiTag,label:Qe("generation:booster.quality-tag.label"),checked:it,helpText:Qe("generation:booster.quality-tag.help"),onCheckedChange:xt=>{dt.onAddRemoveClick(xt),He.closeMenu?.(),He.afterCheckedChange?.()},shouldShowMembershipBadge:!ut&&!lt})}function QualityTagDialog(He){const{open:Qe,onClose:it,...lt}=He;return jsxRuntimeExports.jsx(UIDialog,{open:Qe,onClose:it,dismissable:!0,className:"w-screen max-w-screen-sm",children:jsxRuntimeExports.jsx(QualityTagDialogContent,{onClose:it,...lt})})}function QualityTagDialogContent(He){const{t:Qe}=useTranslation(["generation"]),{setQualityTagValue:it,toggleQualityTag:lt,onCustomize:ut,onClose:dt,presetQualityTags:xt,customQualityTags:ft,qualityTag:vt}=He,[kt,St]=reactExports.useState(vt??{}),Tt=formatQualityTag(kt),Mt=reactExports.useCallback(()=>{it(kt),dt()},[dt,kt]),Nt=reactExports.useCallback($t=>{formatQualityTag($t)===Tt&&St({}),formatQualityTag($t)===formatQualityTag(vt??{})&&(lt(!1),it({})),He.mutateSettings?.()},[vt,Tt]),At=ft.length>=MAX_ALLOWED_CUSTOM_TAG;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:Qe("generation:quality-tag.label")}),jsxRuntimeExports.jsxs(UIDialogContent,{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col pb-6 gap-1",children:[jsxRuntimeExports.jsx("label",{children:Qe("generation:quality-tag.use-for-current-model")}),jsxRuntimeExports.jsx("p",{className:"p-2 bg-background-light rounded-md",children:kt.prefix||kt.suffix?Tt:Qe("generation:booster.quality-tag.select-dialog.not-set")})]}),jsxRuntimeExports.jsx(ModelQualityTagSelect,{value:Tt,customQualityTags:ft,presetQualityTags:xt,onChange:$t=>{const Ft=[...ft,...xt].find(Bt=>{if(formatQualityTag(Bt)===$t)return Bt});St(Ft??{})},onCustomTagDeleted:Nt}),At&&jsxRuntimeExports.jsx(ControlSectionMessage,{type:ControlSectionMessageType.Warning,className:"mt-4 text-sm",children:Qe("generation:booster.quality-tag.add-dialog.no-more-than-3-message")})]}),jsxRuntimeExports.jsxs(UIDialogFooter,{children:[jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",endIcon:jsxRuntimeExports.jsx(MembershipIconCircled,{className:"size-4"}),disabled:At,onPress:()=>ut(),children:Qe("generation:booster.quality-tag.select-dialog.customize.label")}),jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",className:"ml-auto",onPress:dt,children:Qe("action:cancel")}),jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",className:"font-medium",onPress:Mt,children:Qe("action:confirm")})]})]})}function ModelQualityTagSelect({value:He="",presetQualityTags:Qe=[],customQualityTags:it=[],onChange:lt,onCustomTagDeleted:ut}){const{t:dt}=useTranslation(["generation"]),xt=it.length<1,ft=Qe.length<1;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h2",{className:"text-base text-primary-light mb-2",children:dt("generation:quality-tag.select")}),xt&&ft?jsxRuntimeExports.jsx(Empty,{description:"No preset tags"}):jsxRuntimeExports.jsxs($eed445e0843c11d0$export$41f133550aa26f48,{"aria-label":"Model Preset Tag",selectionMode:"single",className:"border-2 p-1 rounded-xl flex flex-col gap-1",selectedKeys:[He],onSelectionChange:vt=>lt?.([...vt][0]),children:[!xt&&jsxRuntimeExports.jsxs($7135fc7d473fd974$export$6e2c8f0811a474ce,{children:[jsxRuntimeExports.jsx($72a5793c14baf454$export$8b251419efc915eb,{className:"px-1 font-semibold text-sm pb-0.5",children:dt("generation:booster.quality-tag.select-dialog.header.custom")}),it.map((vt,kt)=>jsxRuntimeExports.jsx(ListItem$2,{id:formatQualityTag(vt),qualityTag:vt,isPreset:!1,onCustomTagDeleted:ut,index:kt},`${formatQualityTag(vt)}-${kt}`))]}),!ft&&jsxRuntimeExports.jsxs($7135fc7d473fd974$export$6e2c8f0811a474ce,{children:[jsxRuntimeExports.jsx($72a5793c14baf454$export$8b251419efc915eb,{className:"px-1 font-semibold text-sm pb-0.5",children:dt("generation:booster.quality-tag.select-dialog.header.preset")}),Qe.map((vt,kt)=>jsxRuntimeExports.jsx(ListItem$2,{id:formatQualityTag(vt),qualityTag:vt,isPreset:!0},`${formatQualityTag(vt)}-${kt}`))]})]})]})}function ListItem$2(He){const{t:Qe}=useTranslation(["generation"]),it=formatQualityTag(He.qualityTag),lt=!He.isPreset&&He.index!=null,[ut,dt]=useAsyncFn(async()=>{try{if(He.index==null||!await UIDialog.confirm({content:Qe("generation:booster.quality-tag.select-dialog.delete-confirm.title")}))return;await updateCustomQualityTag({payload:{index:He.index},type:"remove"}),He.onCustomTagDeleted?.(He.qualityTag),toast.success(Qe("generation:booster.quality-tag.select-dialog.notice.tag-delete-success"))}catch(ft){toast.error(`${Qe("generation:booster.quality-tag.select-dialog.notice.tag-delete-failed")}: ${ft.message}`)}},[He.qualityTag,He.index]),xt=lt?jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",onPress:dt,busy:ut.loading,busyLabel:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),children:jsxRuntimeExports.jsx(materialSymbolsDeleteForever,{className:"text-red-400 size-4"})}):void 0;return jsxRuntimeExports.jsx(UIListBoxItem,{id:He.id,textValue:He.id,endIcon:xt,children:jsxRuntimeExports.jsx("span",{className:"truncate",title:it,children:it})})}function AddQualityTagFormDialog(He){const Qe=()=>{He.mutateSettings?.(),He.openQualityTagDialog?.(),He.onClose()};return jsxRuntimeExports.jsx(UIDialog,{open:He.open,onClose:()=>He.onClose(),dismissable:!0,className:"w-screen max-w-screen-sm",children:jsxRuntimeExports.jsx(AddQualityTagForm,{onConfirm:Qe,onCancel:()=>He.onClose(),modelId:He.modelId,customQualityTags:He.customQualityTags})})}function AddQualityTagForm(He){const{t:Qe}=useTranslation(["action"]),[it,lt]=reactExports.useState(!1),[ut,dt]=useAsyncFn(async ft=>{ft.preventDefault();const vt=Object.fromEntries(new FormData(ft.currentTarget));try{await updateCustomQualityTag({payload:vt,type:"add"}),track("customize_quality_tag_success"),toast.success(Qe("generation:booster.quality-tag.add-dialog.notice.tag-add-success")),He.onConfirm()}catch(kt){toast.error(`${Qe("generation:booster.quality-tag.add-dialog.notice.tag-add-failed")}: ${kt.message}`)}},[]),xt=(He.customQualityTags??[])?.length<3;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:Qe("generation:booster.quality-tag.add-dialog.title")}),jsxRuntimeExports.jsxs($d3e0e05bdfcf66bd$export$a7fed597f4b8afd8,{className:"contents",onSubmit:dt,children:[jsxRuntimeExports.jsxs(UIDialogContent,{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsxs($bcdf0525bf22703d$export$2c73285ae9390cec,{name:"prefix",className:"flex flex-col",children:[jsxRuntimeExports.jsx($01b77f81d0f07f68$export$b04be29aa201d4f5,{className:"font-medium",children:Qe("generation:booster.quality-tag.add-dialog.prefix.label")}),jsxRuntimeExports.jsx(UIInput,{variant:"rounded-normal",maxLength:250})]}),jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",className:"flex items-center justify-center w-full rounded-lg focus:outline-none my-2",onPress:()=>{lt(ft=>!ft)},children:jsxRuntimeExports.jsx(icBaselineExpandMore,{className:"size-6"})}),jsxRuntimeExports.jsxs("section",{className:cx(!it&&"hidden"),children:[jsxRuntimeExports.jsxs($bcdf0525bf22703d$export$2c73285ae9390cec,{className:"flex flex-col",children:[jsxRuntimeExports.jsx($01b77f81d0f07f68$export$b04be29aa201d4f5,{className:"font-medium",children:Qe("generation:booster.quality-tag.add-dialog.prompts.label")}),jsxRuntimeExports.jsx(UIInput,{value:PROMPT_IN_QUALITY_TAG,disabled:!0,variant:"rounded-normal"})]}),jsxRuntimeExports.jsxs($bcdf0525bf22703d$export$2c73285ae9390cec,{name:"suffix",className:"flex flex-col",children:[jsxRuntimeExports.jsx($01b77f81d0f07f68$export$b04be29aa201d4f5,{className:"font-medium",children:Qe("generation:booster.quality-tag.add-dialog.suffix.label")}),jsxRuntimeExports.jsx(UIInput,{variant:"rounded-normal",maxLength:250})]})]})]}),!xt&&jsxRuntimeExports.jsx(ControlSectionMessage,{type:ControlSectionMessageType.Warning,className:"mt-4",children:Qe("generation:booster.quality-tag.add-dialog.no-more-than-3-message")})]}),jsxRuntimeExports.jsxs(UIDialogFooter,{children:[jsxRuntimeExports.jsx(UIButton$1,{busy:ut.loading,className:"ml-auto",onPress:He.onCancel,children:Qe("action:cancel")}),jsxRuntimeExports.jsx(UIButton$1,{busy:ut.loading,type:"submit",className:"font-semibold",variant:"filled",disabled:!xt,children:Qe("action:confirm")})]})]})]})}function useStyleMixBoosterState(){const{values:He,setValues:Qe}=useTaskSubmitFormContext(),{styleMix:it,modelId:lt}=He,ut=useModelVersion(lt),dt=canModelUseStyleMix(ut?.extra),xt=!!it?.enabled,ft=reactExports.useCallback(St=>{track("stylemix_toggle",{checked:St}),Qe(Tt=>({...Tt,styleMix:{...Tt.styleMix,enabled:St,...St&&typeof Tt.styleMix?.seed!="number"?{seed:getRandomStyleMixRaw()}:{}}}))},[]),vt=reactExports.useCallback(()=>{Qe(St=>({...St,styleMix:{...St.styleMix,seed:getRandomStyleMixRaw()}}))},[]),kt=reactExports.useCallback(St=>{Qe(Tt=>({...Tt,styleMix:{...Tt.styleMix,seed:Number(St.seed),weight:St.weight}}))},[]);return[{enabled:xt,seed:it?.seed,weight:it?.weight},ft,{shuffleStyleMix:vt,updateStyleMix:kt,canStyleMix:dt}]}const SEED_PREFIX="Pix";function getStyleMixSeed(He){const Qe=He?.seed??getRandomStyleMixRaw();return He?.withPrefix?`${SEED_PREFIX}${Qe.toString().padStart(5,"0")}`:He?.padStart?Qe.toString().padStart(5,"0"):Qe.toString()}function padRandomStyleMixSeed(He){return He.toString().padStart(5,"0")}const phShuffleBold=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M240.49 175.51a12 12 0 0 1 0 17l-24 24a12 12 0 0 1-17-17L203 196h-2.09a76.17 76.17 0 0 1-61.85-31.83l-41.68-58.39A52.1 52.1 0 0 0 55.06 84H32a12 12 0 0 1 0-24h23.06a76.17 76.17 0 0 1 61.85 31.83l41.71 58.39A52.1 52.1 0 0 0 200.94 172H203l-3.52-3.51a12 12 0 0 1 17-17Zm-95.62-72.62a12 12 0 0 0 16.93-1.13A52 52 0 0 1 200.94 84H203l-3.52 3.51a12 12 0 0 0 17 17l24-24a12 12 0 0 0 0-17l-24-24a12 12 0 0 0-17 17L203 60h-2.09a76 76 0 0 0-57.2 26a12 12 0 0 0 1.16 16.89Zm-33.74 50.22a12 12 0 0 0-16.93 1.13A52 52 0 0 1 55.06 172H32a12 12 0 0 0 0 24h23.06a76 76 0 0 0 57.2-26a12 12 0 0 0-1.13-16.89Z"})});function StyleMixBoosterControl(He){const{t:Qe}=useTranslation(["generation"]),[it,lt,{updateStyleMix:ut,canStyleMix:dt,shuffleStyleMix:xt}]=useStyleMixBoosterState(),ft=reactExports.useRef(null);if(!it.enabled)return null;const vt=({className:St,disabled:Tt})=>jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center",children:[jsxRuntimeExports.jsx("button",{disabled:Tt,onClick:()=>{track("stylemix_shuffle_click"),xt()},children:jsxRuntimeExports.jsx(phShuffleBold,{className:cx(St,"size-4")})}),jsxRuntimeExports.jsx("button",{disabled:Tt,onClick:()=>{track("stylemix_settings_click"),ft.current?.open()},children:jsxRuntimeExports.jsx(iconParkOutlineSettingConfig,{className:cx(St,"size-4")})})]}),kt=typeof it.seed=="number";return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(BoosterLabel,{enableClose:!0,startIcon:StyleMixIcon,onClose:()=>{lt(!1)},endIcons:vt,...He,disabled:!dt,children:jsxRuntimeExports.jsxs("div",{className:"relative select-none",children:[jsxRuntimeExports.jsx("span",{className:"opacity-0",children:getStyleMixSeed({withPrefix:!0,seed:0})}),jsxRuntimeExports.jsxs(AnimatePresence,{children:[!kt&&jsxRuntimeExports.jsx(motion.span,{className:cx("absolute left-0 overflow-hidden"),initial:{width:0,opacity:0},animate:{width:"100%",opacity:1},exit:{width:0,opacity:0},transition:{type:"ease-linear",duration:.5},children:Qe("generation:booster.style-mix.label")},it.seed),kt&&jsxRuntimeExports.jsx(motion.span,{className:"absolute overflow-hidden flex top-0",initial:{width:0,opacity:0},animate:{width:"100%",opacity:1},exit:{width:0,opacity:0},transition:{type:"ease-linear",duration:.5},children:getStyleMixSeed({seed:it.seed,withPrefix:!0})},it.seed)]})]})}),jsxRuntimeExports.jsx(StyleMixDialog,{ref:ft,onConfirm:St=>{ut(St)},initState:{seed:typeof it.seed=="number"?padRandomStyleMixSeed(it.seed):void 0,weight:it.weight??DEFAULT_STYLE_MIX_WEIGHT}},`${it.seed}-${it.weight}`)]})}function StyleMixBoosterMenuItemToggle(He){const{t:Qe}=useTranslation(["generation"]),[{enabled:it},lt,{canStyleMix:ut}]=useStyleMixBoosterState();return jsxRuntimeExports.jsx(MenuItemWithToggle,{startIcon:StyleMixIcon,label:Qe("generation:booster.style-mix.label"),checked:it,helpText:jsxRuntimeExports.jsx(MarkdownRenderer,{className:"prose dark:prose-invert mx-auto text-sm",children:Qe("generation:booster.style-mix.help")}),onCheckedChange:dt=>{He.afterCheckedChange?.(dt),lt(dt)},disabled:!ut})}const StyleMixDialog=reactExports.forwardRef(function He({onConfirm:Qe,initState:it},lt){const{t:ut}=useTranslation(["generation","action"]),[dt,xt]=reactExports.useState({seed:getStyleMixSeed({padStart:!0}),weight:DEFAULT_STYLE_MIX_WEIGHT,...it}),[ft,vt]=reactExports.useState(!1);reactExports.useImperativeHandle(lt,()=>({open:()=>vt(!0),close:()=>vt(!1),reset:Mt=>xt({seed:getStyleMixSeed({padStart:!0,seed:Mt.seed}),weight:it.weight??DEFAULT_STYLE_MIX_WEIGHT})}),[]);const kt=reactExports.useCallback(()=>{track("stylemix_settings_shuffle_click"),xt(Mt=>({...Mt,seed:getStyleMixSeed({padStart:!0})}))},[]),St=/^\d{1,5}$/,Tt=reactExports.useCallback(Mt=>{Mt.preventDefault(),St.test(dt.seed)?(track("stylemix_settings_confirm"),vt(!1),Qe(dt)):toast.error(ut("generation:style-mix.notice.invalid-seed"))},[dt]);return jsxRuntimeExports.jsxs(UIDialog,{open:ft,onClose:()=>vt(!1),dismissable:!0,className:"w-screen max-w-screen-xs",children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:ut("generation:style-mix.dialog.title")}),jsxRuntimeExports.jsxs($d3e0e05bdfcf66bd$export$a7fed597f4b8afd8,{onSubmit:Tt,autoCapitalize:"off",autoComplete:"off",className:"contents",children:[jsxRuntimeExports.jsx(UIDialogContent,{children:jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsxs($bcdf0525bf22703d$export$2c73285ae9390cec,{isRequired:!0,name:"seed",type:"text",className:"grid grid-cols-[1fr_auto] gap-y-[10px] gap-x-1",validationBehavior:"native",children:[jsxRuntimeExports.jsx($01b77f81d0f07f68$export$b04be29aa201d4f5,{className:"col-span-2 font-semibold",children:ut("generation:style-mix.style-seed")}),jsxRuntimeExports.jsx(UIInput,{variant:"rounded-normal",className:"text-md font-medium",value:dt.seed,onChange:Mt=>xt(Nt=>({...Nt,seed:Mt.target.value})),required:!0,maxLength:5,inputMode:"numeric",placeholder:ut("generation:style-mix.dialog.style-seed.placeholder")}),jsxRuntimeExports.jsx($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{className:"p-3",onPress:kt,children:jsxRuntimeExports.jsx(phShuffleBold,{className:"size-5"})})]}),jsxRuntimeExports.jsx(StyleMixWeightSlider,{value:dt.weight,onChange:Mt=>xt(Nt=>({...Nt,weight:Mt})),className:"mt-8 pr-2 w-full"})]})}),jsxRuntimeExports.jsx(UIDialogFooter,{children:jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",type:"submit",disabled:dt.seed.length<1,className:"w-full",children:ut("action:confirm")})})]})]})});function StyleMixWeightSlider({value:He=DEFAULT_STYLE_MIX_WEIGHT,disabled:Qe,className:it,onChange:lt}){const{t:ut}=useTranslation(["generation"]);return jsxRuntimeExports.jsx(UISlider,{onChange:dt=>{lt?.(dt)},className:it,value:He,maxValue:1,minValue:0,step:.1,isDisabled:Qe,label:jsxRuntimeExports.jsx("span",{className:"font-semibold",children:ut("generation:style-mix.weight")}),sliderOutputProps:{className:"font-medium text-sm"},variant:"half-filled"})}function StyleMixIcon(He){return jsxRuntimeExports.jsx("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",...He,children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5055 4.76012L14.5188 4.82012C14.5188 4.83345 14.5222 4.85845 14.5255 4.88345C14.5288 4.90845 14.5322 4.93345 14.5322 4.94678V4.99345C14.5322 5.01345 14.5322 5.07345 14.5255 5.09345L14.5188 5.17345C14.5122 5.18678 14.4988 5.24678 14.4988 5.25345C14.4903 5.29794 14.4746 5.34074 14.4522 5.38012C14.4522 5.38678 14.4188 5.46678 14.4122 5.46678C14.3855 5.52012 14.3722 5.54012 14.3522 5.56678C14.3488 5.57012 14.3405 5.58178 14.3322 5.59345C14.3238 5.60511 14.3155 5.61678 14.3122 5.62012C14.3088 5.62678 14.2988 5.63845 14.2888 5.65012C14.2788 5.66178 14.2688 5.67345 14.2655 5.68012L14.1655 5.76678C14.1588 5.77345 14.1388 5.78678 14.1188 5.80012C14.1055 5.81345 14.0855 5.82678 14.0722 5.83345C14.0722 5.83345 14.0588 5.84012 14.0522 5.84678C14.0175 5.86908 13.9791 5.88489 13.9388 5.89345C13.9388 5.89719 13.9346 5.89883 13.9298 5.90074C13.926 5.90222 13.9218 5.90386 13.9188 5.90678L13.7855 5.94678C13.7722 5.94678 13.7188 5.95345 13.7055 5.96012C13.6965 5.96012 13.6817 5.9606 13.664 5.96118C13.6163 5.96275 13.548 5.96498 13.5188 5.96012C13.5188 5.96012 13.4855 5.96012 13.4588 5.95345C13.4488 5.95012 13.4305 5.94678 13.4122 5.94345C13.3938 5.94012 13.3755 5.93678 13.3655 5.93345C13.3544 5.92901 13.3433 5.9253 13.3322 5.9216C13.3167 5.91645 13.3013 5.9113 13.2858 5.90416C14.0998 7.07246 14.533 8.42808 14.533 9.84608C14.533 11.8128 13.6997 13.6594 12.1797 15.0527C12.1547 15.0749 12.1279 15.0949 12.0997 15.1127C12.093 15.1194 12.033 15.1594 12.033 15.1594L11.9464 15.2061C11.9397 15.2128 11.873 15.2394 11.873 15.2394C11.8697 15.2394 11.8647 15.2411 11.8597 15.2427C11.8547 15.2444 11.8497 15.2461 11.8464 15.2461C11.813 15.2594 11.773 15.2728 11.7464 15.2794L11.6864 15.2928C11.673 15.2928 11.648 15.2961 11.623 15.2994C11.598 15.3028 11.573 15.3061 11.5597 15.3061H11.513C11.493 15.3061 11.433 15.3061 11.413 15.2994L11.333 15.2928C11.3197 15.2861 11.2597 15.2727 11.253 15.2727C11.2085 15.2642 11.1658 15.2485 11.1264 15.2261C11.1197 15.2261 11.0397 15.1928 11.0397 15.1861C10.9864 15.1594 10.9664 15.1461 10.9397 15.1261C10.9364 15.1228 10.9247 15.1144 10.913 15.1061C10.9014 15.0978 10.8897 15.0894 10.8864 15.0861C10.8797 15.0828 10.868 15.0727 10.8564 15.0627C10.8447 15.0527 10.833 15.0427 10.8264 15.0394L10.7397 14.9394C10.733 14.9328 10.7197 14.9128 10.7064 14.8927C10.693 14.8794 10.6797 14.8594 10.673 14.8461C10.673 14.8461 10.6664 14.8328 10.6597 14.8261C10.6374 14.7914 10.6216 14.753 10.613 14.7128C10.6093 14.7128 10.6077 14.7085 10.6058 14.7037C10.6043 14.6999 10.6026 14.6957 10.5997 14.6927L10.5597 14.5594C10.5597 14.5461 10.553 14.4927 10.5464 14.4794C10.5464 14.4704 10.5459 14.4556 10.5453 14.4379C10.5437 14.3902 10.5415 14.3219 10.5464 14.2928C10.5464 14.2928 10.5464 14.2594 10.553 14.2327C10.5564 14.2227 10.5597 14.2044 10.563 14.1861C10.5664 14.1678 10.5697 14.1494 10.573 14.1394C10.5775 14.1283 10.5812 14.1172 10.5849 14.1061C10.5901 14.0904 10.5954 14.0747 10.6027 14.059C9.43589 14.8725 8.07864 15.3068 6.65885 15.3068C4.69218 15.3068 2.84551 14.4735 1.45218 12.9535C1.43648 12.9296 1.41862 12.9073 1.39885 12.8868C1.39551 12.8801 1.38718 12.8685 1.37885 12.8568C1.37051 12.8451 1.36218 12.8335 1.35885 12.8268C1.11885 12.4535 1.15218 11.9468 1.45218 11.6135C1.59885 11.4601 1.77885 11.3601 1.97885 11.3268C2.05885 11.3135 2.12551 11.3135 2.18551 11.3201C2.19151 11.3201 2.20289 11.3215 2.21542 11.3229C2.23077 11.3248 2.24784 11.3268 2.25885 11.3268C2.26484 11.3268 2.27218 11.3281 2.28026 11.3296C2.29016 11.3314 2.30117 11.3335 2.31218 11.3335C2.32549 11.3335 2.38533 11.3534 2.44524 11.3734C1.63323 10.2073 1.19971 8.85124 1.19971 7.43275C1.19971 5.46608 2.03304 3.61942 3.55304 2.22608C3.57685 2.21038 3.59916 2.19253 3.61971 2.17275C3.62637 2.16942 3.63804 2.16108 3.64971 2.15275C3.66137 2.14442 3.67304 2.13608 3.67971 2.13275C4.05304 1.89275 4.55971 1.92608 4.89304 2.22608C5.04637 2.37275 5.14637 2.55275 5.17971 2.75275C5.19304 2.83275 5.19304 2.89942 5.18637 2.95942C5.18637 2.96541 5.18503 2.97679 5.18354 2.98932C5.18173 3.00467 5.17971 3.02174 5.17971 3.03275C5.17971 3.03874 5.17836 3.04608 5.17688 3.05417C5.17506 3.06406 5.17304 3.07507 5.17304 3.08608C5.17304 3.09935 5.15324 3.15881 5.13335 3.2185C6.30094 2.40591 7.65542 1.97345 9.07218 1.97345C11.0388 1.97345 12.8855 2.80678 14.2788 4.32678C14.3009 4.35181 14.321 4.37856 14.3388 4.40678C14.3455 4.41345 14.3855 4.47345 14.3855 4.47345L14.4322 4.56012C14.4388 4.56678 14.4655 4.63345 14.4655 4.63345C14.4655 4.63678 14.4672 4.64178 14.4688 4.64678C14.4705 4.65178 14.4722 4.65678 14.4722 4.66012C14.4855 4.69345 14.4988 4.73345 14.5055 4.76012ZM9.90593 10.6786C8.76308 11.6551 6.98514 11.6597 5.84246 10.6922C4.85107 9.56397 4.83999 7.77598 5.80923 6.62081C6.94193 5.6208 8.74392 5.61236 9.90029 6.59547C10.8854 7.74297 10.8872 9.53477 9.90593 10.6786Z",fill:"currentColor"})})}const T2i2vToggleScene={booster:"booster",generate:"generation-button"};function useT2i2vState(){const{t:He}=useTranslation(["membership"]),{setValues:Qe,values:it}=useTaskSubmitFormContext(),{beingMember:lt,me:ut}=useMe(),dt=!!ut?.id,xt=!!it.t2i2v?.enabled,ft=reactExports.useCallback((kt,St)=>{track("t2i2v_select",{checked:kt,scene:St}),Qe(kt?Tt=>({...Tt,t2i2v:{enabled:!0,i2vPro:{duration:"5"},channel:"normal"},priority:TASK_PRIORITIES.default}):produce(Tt=>{delete Tt.t2i2v}))},[]),vt=reactExports.useCallback((kt,St)=>kt?dt?lt?ft(kt,St):openMembershipFeatureDialog({dialogBody:He("membership:membership-only-feature-dialog.content.t2i2v"),trackingLocation:"add-booster-add-t2i2v"}):openSignModal():ft(kt,St),[lt,ft,dt]);return[{enabled:xt,userCanUseT2i2v:lt},{toggleT2i2v:ft,onAddRemoveClick:vt}]}function T2i2vBoosterControl(He){const{t:Qe}=useTranslation(["generation"]),[it,{toggleT2i2v:lt}]=useT2i2vState();return it.enabled?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(BoosterLabel,{enableClose:!0,contentClassName:"dense:hidden",startIcon:riVideoAiLine,onClose:()=>{lt(!1,T2i2vToggleScene.booster)},...He,children:Qe("generation:booster.t2i2v.label")})}):null}function T2i2vMenuItemToggle(He){const{t:Qe}=useTranslation(["generation"]),[{enabled:it,userCanUseT2i2v:lt},ut]=useT2i2vState();return jsxRuntimeExports.jsx(MenuItemWithToggle,{startIcon:riVideoAiLine,label:Qe("generation:booster.t2i2v.label"),checked:it,helpText:Qe("generation:booster.t2i2v.help"),onCheckedChange:dt=>{ut.onAddRemoveClick(dt,T2i2vToggleScene.booster),He.closeMenu?.(),He.afterCheckedChange?.()},shouldShowMembershipBadge:!lt})}const HAVE_SHOWN_ADD_BOOSTER_STORAGE_KEY="generator::add-booster-help-shown";function useHasEnabledBooster(){const[He]=useFaceFixState(),[Qe]=useHiresParametersState(),[it]=useQualityTagToggleState(),[lt]=useStyleMixBoosterState(),[ut]=useT2i2vState();return reactExports.useMemo(()=>He.enabled||Qe.enabled||it.enabled||lt.enabled||ut.enabled,[He.enabled,Qe.enabled,it.enabled,lt.enabled,ut.enabled])}function AddBoosterControl(He){const Qe=useHasEnabledBooster(),[it,lt]=useLocalStorage({key:HAVE_SHOWN_ADD_BOOSTER_STORAGE_KEY,defaultValue:!1}),ut=reactExports.useRef(null),[,dt]=reactExports.useContext(BoosterControlItemOrderContext),{t:xt}=useTranslation(["generation"]),[ft,vt]=reactExports.useState(!1),kt=reactExports.useCallback((Nt,At)=>{vt(!1),At!=null&&dt($t=>{const{order:Dt}=$t,Ft=Dt.filter(Bt=>Bt===Nt);return{...$t,order:At?[...Ft,Nt]:Ft}})},[]);reactExports.useEffect(()=>{it||vt(!0)},[it]);const St=jsxRuntimeExports.jsx(AddBoosterButton,{ref:ut,className:He.className,onPress:()=>{track("booster_click")},shouldHighLight:!Qe}),Tt=reactExports.useCallback(Nt=>[jsxRuntimeExports.jsx(FaceFixMenuItemToggle,{afterCheckedChange:At=>kt("FaceFix",At)},"face-fix"),jsxRuntimeExports.jsx(HiresMenuItemToggle,{afterCheckedChange:At=>kt("HiRes",At)},"hires"),jsxRuntimeExports.jsx(QualityTagMenuItemToggle,{afterCheckedChange:At=>kt("QualityTag",At),closeMenu:Nt.closeMenu},"quality-tag"),jsxRuntimeExports.jsx(StyleMixBoosterMenuItemToggle,{afterCheckedChange:At=>kt("StyleMix",At)},"style-mix"),jsxRuntimeExports.jsx(T2i2vMenuItemToggle,{afterCheckedChange:At=>kt("T2i2v",At),closeMenu:Nt.closeMenu},"t2i2v")],[kt]),Mt=jsxRuntimeExports.jsx(UIPopoverStateful,{isOpen:ft,PopoverProps:{triggerRef:ut,crossOffset:76},onOpenChange:Nt=>{vt(Nt),lt(!0)},placement:"bottom",showArrow:!0,className:"w-[280px]",children:jsxRuntimeExports.jsx("p",{className:"p-4",children:xt("generation:booster.add-booster.help")})});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[!it&&Mt,jsxRuntimeExports.jsxs($de32f1b87079253c$export$2e1e1122cf0cba88,{children:[St,jsxRuntimeExports.jsxs($07b14b47974efb58$export$5b6b19405a83ff9d,{placement:"bottom start",className:"min-w-[268px] bg-modal-background rounded-2xl shadow-[0_0_20px_0_rgba(0,0,0,0.25)]",offset:16,children:[jsxRuntimeExports.jsx($44f671af83e7d9e0$export$746d02f47f4d381,{className:"group",children:jsxRuntimeExports.jsx("svg",{viewBox:"0 0 12 12",className:"block fill-modal-background group-placement-bottom:rotate-180 group-placement-left:-rotate-90 group-placement-right:rotate-90 w-4 h-4",children:jsxRuntimeExports.jsx("path",{d:"M0 0L6 6L12 0"})})}),jsxRuntimeExports.jsx($de32f1b87079253c$export$3ddf2d174ce01153,{className:"outline-none",children:({close:Nt})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs($5cb03073d3f54797$export$a8a3e93435678ff9,{className:"flex p-4 items-center border-b dark:border-zinc-600 border-zinc-200 [&>button]:ml-auto [&>button]:cursor-pointer [&>button>svg]:size-4 [&>button>svg]:text-zinc-500 [&>button>svg]:dark:text-zinc-400",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:xt("generation:booster.add-booster.title")}),jsxRuntimeExports.jsx("button",{onClick:Nt,children:jsxRuntimeExports.jsx(icBaselineClose,{})})]}),jsxRuntimeExports.jsx("ul",{className:"px-4 py-1",children:Tt({closeMenu:Nt}).map((At,$t)=>jsxRuntimeExports.jsx("li",{children:At},$t))})]})})]})]})]})}function BoosterBarForPromptsFooter(){return jsxRuntimeExports.jsx("section",{className:"flex flex-wrap gap-2 items-center",children:jsxRuntimeExports.jsxs(BoosterControlItemOrderContextProvider,{children:[jsxRuntimeExports.jsx(AddBoosterControl,{className:"order-1"}),jsxRuntimeExports.jsx(BoosterControlItems,{})]})})}const Boosters=[{name:"HiRes",control:HiResBoosterControl},{name:"FaceFix",control:FaceFixBoosterControl},{name:"QualityTag",control:QualityTagBoosterControl},{name:"StyleMix",control:StyleMixBoosterControl},{name:"T2i2v",control:T2i2vBoosterControl}];function BoosterControlItems(){const[{order:He}]=reactExports.useContext(BoosterControlItemOrderContext);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:Boosters.map(Qe=>jsxRuntimeExports.jsx(Qe.control,{style:{order:He.indexOf(Qe.name)>=0?He.indexOf(Qe.name)+2:1}},Qe.name))})}function EmailVerifyBanner({className:He}){const{t:Qe}=useTranslation(["generation","user","action"]),{data:it}=useUserInfo(),[lt,ut]=useLocalStorage({key:"generation::show-email-verify-banner",defaultValue:!0,getInitialValueInEffect:!1});return userHasNotVerifiedEmail(it)&&lt?jsxRuntimeExports.jsxs(ControlSectionMessage,{type:ControlSectionMessageType.Warning,className:cx("mx-4 mb-2 px-4 py-2 flex items-center justify-between",He),children:[jsxRuntimeExports.jsx("span",{className:"text-sm",children:Qe("generation:tips.verify-email")}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Link,{to:"/profile/edit/accounts",className:"px-3 py-1 rounded-md bg-amber-500 text-white hover:bg-amber-600",children:Qe("user:profile.verify-now")}),jsxRuntimeExports.jsx("button",{className:"p-1 rounded-md hover:bg-amber-200 dark:hover:bg-amber-800 transition-colors",onClick:()=>ut(!1),"aria-label":Qe("action:close"),children:jsxRuntimeExports.jsx(icBaselineClose,{className:"size-4"})})]})]}):null}const icBaselinePhotoSizeSelectActual=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M21 3H3C2 3 1 4 1 5v14c0 1.1.9 2 2 2h18c1 0 2-1 2-2V5c0-1-1-2-2-2zM5 17l3.5-4.5l2.5 3.01L14.5 11l4.5 6H5z"})}),materialSymbolsCheckCircleOutline=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m10.6 16.6l7.05-7.05l-1.4-1.4l-5.65 5.65l-2.85-2.85l-1.4 1.4l4.25 4.25ZM12 22q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22Zm0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20Zm0-8Z"})});function MembershipBanner(He){const{i18n:Qe}=useTranslation(),{data:it}=useCampaignAds({lang:Qe.language,category:"profileMembershipBanner"}),lt=it?.[0];return jsxRuntimeExports.jsx(Link,{to:lt?.targetUrl??"/membership/plans",className:cx("px-4 py-4 flex flex-col items-start bg-cover aspect-[3]",He.className),style:{backgroundImage:`
          url(${lt?.media})`,height:150,...He.style},onClick:()=>{const ut=He.scene;track("enter_member_click",{location:ut,tracking_id:lt?.trackingId}),startEventGroup("member_source",ut,{persistent:!0}),He.onClick?.()}})}const UserQuotaLogType={daily:"daily",task_cost:"task_cost",referral_reward:"referral_reward",register_gift:"register_gift",app_gift:"app_gift",xmas_gift_2023:"xmas_gift_2023",membership:"membership",extra_package:"extra_package",task_refund:"task_refund",op:"op",event_gift:"event_gift",event_cost:"event_cost",user_lora_task_cost:"user_lora_task_cost",user_lora_task_refund:"user_lora_task_refund",user_lora_rebate:"user_lora_rebate",user_share:"user_share",quest_reward:"quest_reward",credit_coupon:"credit_coupon"};function TableRowSkeleton$1(){return jsxRuntimeExports.jsxs(TableRow,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[jsxRuntimeExports.jsx(TableCell,{component:"th",scope:"row",children:jsxRuntimeExports.jsx(Skeleton,{})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(Skeleton,{})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(Skeleton,{})})]})}const QuotaLogList=({userId:He})=>{const{t:Qe}=useTranslation(["user","artwork"]),[it,lt]=reactExports.useState(),[{before:ut,after:dt},xt]=reactExports.useState({}),{data:ft,loading:vt}=useListUserQuotaLogs({reason:it,userId:He,...getBaseCursorPagingArgs({before:ut,after:dt,pageSize:20})}),kt=reactExports.useMemo(()=>getNodesFromConnection(ft).reverse(),[ft]);return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs(FormControl,{size:"small",children:[jsxRuntimeExports.jsx(InputLabel,{children:"Type"}),jsxRuntimeExports.jsxs(Select,{label:"type",className:"w-[200px]",value:it,onChange:St=>lt(St.target.value),children:[jsxRuntimeExports.jsx(MenuItem$1,{value:"",children:jsxRuntimeExports.jsx("em",{children:"None"})}),Object.values(UserQuotaLogType).map(St=>jsxRuntimeExports.jsx(MenuItem$1,{value:St,children:Qe(`user:quota-log-type.${St}`,{defaultValue:"Unknown"})},St))]})]})}),jsxRuntimeExports.jsx(TableContainer,{children:jsxRuntimeExports.jsxs(Table,{size:"small",children:[jsxRuntimeExports.jsx(TableHead,{children:jsxRuntimeExports.jsxs(TableRow,{children:[jsxRuntimeExports.jsx(TableCell,{children:Qe("user:quota-log.head.credit-change")}),jsxRuntimeExports.jsx(TableCell,{children:Qe("user:quota-log.head.credit-type")}),jsxRuntimeExports.jsx(TableCell,{children:Qe("user:quota-log.head.reason")}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:Qe("user:quota-log.head.date")}),jsxRuntimeExports.jsx(TableCell,{})]})}),jsxRuntimeExports.jsxs(TableBody,{children:[kt.length<1&&vt&&jsxRuntimeExports.jsx(TableRowSkeleton$1,{}),kt.map(St=>jsxRuntimeExports.jsxs(TableRow,{children:[jsxRuntimeExports.jsx(TableCell,{component:"th",scope:"row",children:jsxRuntimeExports.jsxs("pre",{children:[St.amount>0?"+":"",St.amount.toLocaleString()]})}),jsxRuntimeExports.jsx(TableCell,{children:Qe(`user:quota-log-type.${St.type}`,{defaultValue:"Unknown"})}),jsxRuntimeExports.jsx(TableCell,{children:jsxRuntimeExports.jsx(QuotaLogExtra,{log:St})}),jsxRuntimeExports.jsxs(TableCell,{align:"right",children:[defaultDayjs(St.createdAt).format("lll"),jsxRuntimeExports.jsxs("span",{className:"text-xs ml-1",children:["(",defaultDayjs(St.createdAt).fromNow(),")"]})]}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:St.extra?.reason&&jsxRuntimeExports.jsx("p",{children:St.extra?.reason})})]},St.createdAt))]}),jsxRuntimeExports.jsx(TableFooter,{children:jsxRuntimeExports.jsx(TableRow,{children:jsxRuntimeExports.jsx(TableCell,{colSpan:100,align:"right",sx:{borderBottom:0},children:jsxRuntimeExports.jsx(TablePaginationActionsWrapper,{pageInfo:ft?.pageInfo,onCursorChange:xt})})})})]})})]})},QuotaLogExtra=({log:He})=>$$3(He.type).with(UserQuotaLogType.user_lora_rebate,()=>{const Qe=He.extra.loraId;return Qe?jsxRuntimeExports.jsx(QuotaLogExtraLoraInfo,{loraId:Qe}):null}).otherwise(()=>null),QuotaLogExtraLoraInfo=({loraId:He})=>{const{data:Qe}=useGenerationModelByVersionId(He),it=reactExports.useMemo(()=>{if(!Qe)return"";const lt=Qe?.model?.title;if(lt&&lt.trim().length!==0)return lt;const ut=Qe?.name;return ut&&ut.trim().length!==0?ut:Qe?.id},[Qe]);return Qe?jsxRuntimeExports.jsx(Link,{to:`/model/${Qe.modelId}`,children:it}):null},showMembershipAutoRenewDialog=()=>UIDialog.create({dismissable:!1,children:({close:He})=>jsxRuntimeExports.jsx(MembershipAutoRenewDialog,{onClose:He})}),MembershipAutoRenewDialog=({onClose:He})=>{const{t:Qe}=useTranslation(["membership"]),{data:it}=useMyMembership(),lt=reactExports.useMemo(()=>it?.subscription?getSubscriptionState(it.subscription):void 0,[it]),ut=usePaymentMethodAutoRenewable(),dt=reactExports.useMemo(()=>{if(lt?.state!=="active")return{text:Qe("membership:membership.auto-renewal.manage.dialog.content_no_subscription"),image:"sad",action:"new-membership"};const St=lt.current,Tt=St.paymentProvider,Mt=St.autoRenewable;return $$3(Mt).with("enabled",()=>({text:Qe("membership:membership.auto-renewal.manage.dialog.content_enabled"),image:"happy",action:"disable"})).with("unspecified",()=>ut(Tt)?{text:Qe("membership:membership.auto-renewal.manage.dialog.content_supported"),image:"sad",action:"enable"}:{text:Qe("membership:membership.auto-renewal.manage.dialog.content_unsupported"),image:"sad",action:"none"}).with("mobile-app-store",()=>({text:Qe("membership:membership.auto-renewal.manage.dialog.content",{context:Tt.toString()}),image:"sad",action:"none"})).exhaustive()},[ut,lt,Qe]),xt=useNavigate(),{unsubscribe:ft,resume:vt}=useMembershipActions(),kt=async()=>{switch(dt.action){case"none":return;case"new-membership":{xt("/membership/plans"),He?.();return}case"enable":{await vt(),He?.();return}case"disable":{await ft(),He?.();return}}};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:Qe("membership:membership.auto-renewal.manage.dialog.title")}),jsxRuntimeExports.jsx(UIDialogContent,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4 mx-auto",children:[jsxRuntimeExports.jsx("img",{src:Qe("membership:membership.auto-renewal.manage.dialog.image",{context:dt.image}),alt:"",className:"object-scale-down object-center w-full"}),jsxRuntimeExports.jsx("p",{className:"text-indent text-base",children:dt.text}),dt.action!=="none"&&jsxRuntimeExports.jsx(UIButton$1,{variant:dt.action==="disable"?"outlined":"filled",color:"theme",size:"large",className:"w-full",onPress:kt,children:Qe("membership:membership.auto-renewal.manage.dialog.action",{context:dt.action})})]})}),jsxRuntimeExports.jsx(UIDialogFooter,{children:jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",onPress:He,children:Qe("common:close")})})]})},fluentMoreVertical24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 8a2 2 0 1 1 0-4a2 2 0 0 1 0 4m0 6a2 2 0 1 1 0-4a2 2 0 0 1 0 4m-2 4a2 2 0 1 0 4 0a2 2 0 0 0-4 0"})}),mingcuteCouponLine=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsxs("g",{fill:"none",children:[jsxRuntimeExports.jsx("path",{d:"M24 0v24H0V0h24ZM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018Zm.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01l-.184-.092Z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 4a3 3 0 0 1 2.995 2.824L22 7v1.817a1.55 1.55 0 0 1-.776 1.33l-.107.058a2 2 0 0 0-.14 3.515l.14.075c.433.214.82.656.876 1.24l.007.148V17a3 3 0 0 1-2.824 2.995L19 20H5a3 3 0 0 1-2.995-2.824L2 17v-1.817c0-.606.352-1.078.776-1.33l.107-.058a2 2 0 0 0 .14-3.515l-.14-.075c-.433-.214-.82-.656-.876-1.24L2 8.818V7a3 3 0 0 1 2.824-2.995L5 4h14Zm0 2H5a1 1 0 0 0-.993.883L4 7v1.535a3.999 3.999 0 0 1 .185 6.816L4 15.465V17a1 1 0 0 0 .883.993L5 18h14a1 1 0 0 0 .993-.883L20 17v-1.535a3.999 3.999 0 0 1-.185-6.816L20 8.535V7a1 1 0 0 0-.883-.993L19 6Zm-9 3a1 1 0 0 1 .993.883L11 10v4a1 1 0 0 1-1.993.117L9 14v-4a1 1 0 0 1 1-1Z"})]})}),QuotaHelpIcon=({className:He})=>{const{t:Qe}=useTranslation(["generation"]);return jsxRuntimeExports.jsx(UITooltipHelpIcon,{variant:"normal",iconClassName:He,children:jsxRuntimeExports.jsx(MarkdownRenderer,{className:"flex flex-col prose dark:prose-invert",children:Qe("generation:generation.quota-help.content")})})};function UserCreditView(He){return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-12 relative",children:[jsxRuntimeExports.jsx(MembershipSection,{}),jsxRuntimeExports.jsx(CreditLogSection,{userId:He.userId})]})}const sectionStyles=ce$1({slots:{root:"flex flex-col gap-4",heading:"text-xl font-semibold"}}),dataListStyles=ce$1({slots:{list:"grid grid-cols-[auto_1fr] content-start gap-x-8 gap-y-2",item:"contents",title:"text-neutral-600 dark:text-neutral-400",value:"max-msm:justify-self-end"}});function MembershipSection(){const{t:He}=useTranslation(["membership"]),{user:Qe,isMyProfile:it}=reactExports.useContext(UserProfileContext),{data:lt}=useGetUserMembership(Qe.id),ut=reactExports.useMemo(()=>lt?.subscription&&getSubscriptionState(lt.subscription),[lt]),dt=$$3(lt).with({subscription:{provider:N$4.union(N$4.string.startsWith("apple"),N$4.string.startsWith("google"))}},()=>"membership:membership.auto-renewal.messages.check-status-on-store").otherwise(()=>!lt?.subscription?.cancelAtPeriodEnd),xt=sectionStyles(),ft=dataListStyles();return jsxRuntimeExports.jsxs("section",{className:xt.root(),children:[jsxRuntimeExports.jsxs("header",{className:"flex items-end gap-4",children:[jsxRuntimeExports.jsx("h4",{className:xt.heading(),onClick:()=>{},children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership.label"})}),jsxRuntimeExports.jsxs(UIMenuTrigger,{children:[jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",icon:jsxRuntimeExports.jsx(fluentMoreVertical24Filled,{className:"size-6"}),className:"ml-auto"}),jsxRuntimeExports.jsx(UIMenu,{placement:"bottom end",children:jsxRuntimeExports.jsx(UIMenuItem,{color:"normal",disabled:!it,onAction:()=>{track("plan_cancel_click",{scene:"profile"}),showMembershipAutoRenewDialog()},children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership.auto-renewal.manage.menu-item"})})})]})]}),jsxRuntimeExports.jsx("div",{children:lt?.membership?jsxRuntimeExports.jsxs("dl",{className:ft.list(),children:[jsxRuntimeExports.jsxs("div",{className:ft.item(),children:[jsxRuntimeExports.jsx("dt",{className:ft.title(),children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership.current-tier.label"})}),jsxRuntimeExports.jsx("dd",{className:ft.value({className:"flex items-center gap-1"}),children:jsxRuntimeExports.jsx(MembershipTierLabel,{tier:lt?.membership?.tier})})]}),ut&&ut.state==="active"&&jsxRuntimeExports.jsxs("div",{className:ft.item(),children:[jsxRuntimeExports.jsx("dt",{className:ft.title(),children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership.expiry-date.label"})}),jsxRuntimeExports.jsxs("dd",{className:ft.value({className:"flex flex-col max-msm:items-end"}),children:[jsxRuntimeExports.jsx("span",{children:He("user:membership.expire-at",{time:defaultDayjs(ut.current.endAt).format("ll"),days:defaultDayjs(ut.current.endAt).diff(defaultDayjs(),"day")})}),ut.next&&jsxRuntimeExports.jsx("p",{className:"text-sm max-msm:text-right text-balance text-neutral-600 dark:text-neutral-400",children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership.auto-renewal.messages.following-tier-change",values:{tier:1,time:He("membership:plan.action.subscribe.interval.month")},components:{tier:jsxRuntimeExports.jsx(MembershipTierLabel,{}),time:jsxRuntimeExports.jsx("span",{className:"lowercase"})}})})]})]}),jsxRuntimeExports.jsxs("div",{className:ft.item(),children:[jsxRuntimeExports.jsx("dt",{className:ft.title(),children:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership.auto-renewal.label"})}),jsxRuntimeExports.jsx("dd",{className:ft.value({className:"inline-flex items-center gap-2"}),children:dt?typeof dt=="string"?jsxRuntimeExports.jsx("p",{className:"max-msm:text-right text-balance",children:jsxRuntimeExports.jsx(Text,{i18nKey:dt})}):jsxRuntimeExports.jsx(Text,{i18nKey:"common:on"}):jsxRuntimeExports.jsx(Text,{i18nKey:"common:off"})})]})]}):jsxRuntimeExports.jsx(MembershipBanner,{scene:"credits",className:"outline outline-1 -outline-offset-1 outline-black/10 rounded-2xl shadow-md"})})]})}function MembershipTierLabel(He){return He.tier?jsxRuntimeExports.jsxs("span",{className:twJoin("whitespace-nowrap",He.className),style:He.style,children:[jsxRuntimeExports.jsx(MembershipIconCircled,{className:"size-[1.2em] inline-grid align-text-top mr-0.5"}),jsxRuntimeExports.jsx("span",{className:"",children:jsxRuntimeExports.jsx(Text,{i18nKey:getMembershipTierConfig(Number(He.tier)).label})})]}):null}function CreditLogSection(He){const{isMyProfile:Qe}=reactExports.useContext(UserProfileContext),it=useNavigate(),lt=sectionStyles();return jsxRuntimeExports.jsxs("section",{className:lt.root(),children:[jsxRuntimeExports.jsxs("header",{className:"flex items-end gap-4",children:[jsxRuntimeExports.jsx("h4",{className:lt.heading(),children:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:generation.credit-change-history",context:"preview"})}),jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",size:"small",disabled:!Qe,icon:jsxRuntimeExports.jsx(mingcuteCouponLine,{}),className:"ml-auto",onPress:()=>{track("redeem_code_link_click"),it("/redeem")},children:jsxRuntimeExports.jsx(Text,{i18nKey:"user:code-redemption.redeem-code.label"})})]}),jsxRuntimeExports.jsx(QuotaLogList,{userId:He.userId})]})}function isPriorityRecognized(He){return typeof He!="number"?!1:Object.values(TASK_PRIORITIES).includes(He)}const PriorityChannelSelectCheckbox=({value:He,onChange:Qe=()=>{},disabled:it=!1,className:lt,forceHighPriorityForNonMember:ut})=>{const{beingMember:dt}=useMe(),{t:xt}=useTranslation(["artwork"]),{denseMode:ft}=useUIDensity();reactExports.useEffect(()=>{!dt&&ut?Qe(TASK_PRIORITIES.default):!dt&&He===TASK_PRIORITIES.turboMode?Qe(TASK_PRIORITIES.low):isPriorityRecognized(He)||Qe(TASK_PRIORITIES.default)},[He,dt,ut]);const vt=ut&&!dt;return jsxRuntimeExports.jsx(FormControl,{className:lt,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx(FormControlLabel,{className:"mmd:mr-1",onChange:(kt,St)=>{St?(Qe(TASK_PRIORITIES.default),track("priority_channel_select",{priority:TASK_PRIORITIES.default})):(Qe(dt?TASK_PRIORITIES.turboMode:TASK_PRIORITIES.low),track("priority_channel_select",{priority:TASK_PRIORITIES.low}))},disabled:it||vt,control:jsxRuntimeExports.jsx(Checkbox,{className:"p-1",checked:He===TASK_PRIORITIES.default}),label:jsxRuntimeExports.jsx("p",{className:"flex items-center text-sm",children:xt("artwork:generation:priority-channel:high",{context:ft})})}),jsxRuntimeExports.jsx(QuotaHelpIcon,{className:"mr-3"})]})})},t2i2vItems={disabled:{id:"generation",icon:jsxRuntimeExports.jsx(icBaselinePhotoSizeSelectActual,{className:"size-6"})},enabled:{id:"t2i2v",icon:jsxRuntimeExports.jsx(riVideoAiLine,{className:"size-6"})}},GenerateButton=reactExports.forwardRef(function He(Qe,it){const{style:lt,className:ut}=Qe,{t:dt}=useTranslation(["artwork","common"]),{loading:xt,values:ft,handleChange:vt,validation:kt,submit:St}=useTaskSubmitFormContext(),[,Tt]=reactExports.useContext(GeneratedItemsContext),[,Mt]=reactExports.useContext(HoveredItemContext),[{enabled:Nt}]=useT2i2vState(),At=useModelVersion(ft.modelId),$t=Qe.showPriorityCheckbox&&!Nt,Dt=reactExports.useMemo(()=>getCreateTaskParameters({...ft,prompts:void 0},{modelVersion:At}),[ft,At?.id]),{data:Ft,isValidating:Bt}=usePricingTask(Dt),{me:Ot,beingMember:Qt,beingAdmin:Wt,membershipTier:Xt}=useMe(),{data:Kt}=useDailyClaimAvailable({context:{refetchOnFocus:!1}}),Jt=Kt?.dailyClaimAvailable,[hr,xr]=useQs(),gr=hasModelDisabledLowPrio(At?.extra),br=isChatModel(At?.modelType),vr=isModelEarlyAccess(At?.model?.extra),yr=isAlphaTestModel(At?.model?.extra),{value:Cr}=useIsModelAlphaTester(),Rr=vr&&At?.model?.isPrivate&&!Qt&&!(Cr&&yr),Ir=yr&&!vr&&At?.model?.isPrivate&&!Cr,{data:Tr,mutate:$r}=useMyFreeGenerationEvents(),[Zr,Sr]=reactExports.useState(void 0),Dr=(Zr?.remaining??0)>0,wr=useCanUsePrivateChannel(),qr=reactExports.useCallback((es,Xr)=>St({},(en,rn)=>{$r();const sn=getTaskAndMediaIds(en.createGenerationTask);sn&&(Tt(sn),Mt(sn[0].mediaId)),window.scrollTo({top:0,behavior:"smooth"}),rn?.isFirstTime&&openMembershipMoreCreditsModal({defaultMode:"packs"})},{throwError:Xr?.throwError}),[]),Nr=reactExports.useCallback(async(es,Xr)=>{try{Xr&&await openRegisterOnboardingDialog(),await qr(es,{throwError:!0})}catch(en){const rn=getErrorCode(en);if(typeof rn!="string")return toast.error("Error submitting task");if(rn==="INSUFFICIENT_BALANCE"){let sn=!1;if(Jt?openQuestDialog({closeAfterClaim:!0,afterClaim:async()=>{try{await qr(es,{throwError:!0})}catch(os){os==="INSUFFICIENT_BALANCE"&&(sn=!0)}}}):sn=!0,!sn)return;openMembershipMoreCreditsModal({afterPurchaseSuccess:()=>{qr(es)},extraParamsForSubscribeRedirection:{submitTask:1,initialValues:encodeInitialValuesForImport(ft)},trackingLocation:"insufficient-credit-task-gen"})}else matchTaskSubmitFormError(dt,en,{taskParameters:ft})}},[qr,Jt,ft]),Jr=reactExports.useCallback(async es=>{try{await qr(es,{throwError:!0})}catch(Xr){getErrorCode(Xr)==="INSUFFICIENT_BALANCE"?openMembershipMoreCreditsModal({afterPurchaseSuccess:()=>{qr(es)},extraParamsForSubscribeRedirection:{submitTask:1,initialValues:encodeInitialValuesForImport(ft)},trackingLocation:"insufficient-credit-task-gen"}):matchTaskSubmitFormError(dt,Xr,{taskParameters:ft})}},[qr,ft]),Qr=reactExports.useCallback(es=>{if(!wr&&ft.t2i2v?.channel==="private")return openMembershipFeatureDialog({dialogTitle:dt("generation:image-to-video.private-membership-dialog.title"),dialogBody:dt("generation:image-to-video.private-membership-dialog.description"),trackingLocation:"t2i2v-pro-private-channel"});if(Rr)return openProceedMembershipModal({membershipModalProps:{trackingLocation:"generation-use-early-access"},confirmationDialogProps:{heading:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.early-access.membership-dialog.heading"}),content:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.early-access.membership-dialog.content"})}});Ot?.id?Jr(es):openSignModal({oauthRedirectUrl:withQuery(`${joinURL(window.location.origin,"generator")}`,{submitTask:1,initialValues:encodeInitialValuesForImport(ft)}),onSuccess:Xr=>{Nr(es,!Xr)},skipAfterAuthDialogs:!0},{fromPath:"gen-submit"})},[Ot?.id,Jr,Nr,ft]);reactExports.useImperativeHandle(it,()=>({onClickSubmit:Qr}),[Qr]);const Ur=once$1(async es=>{await sleep(2e3),Nr(void 0,es)});reactExports.useEffect(()=>{Qe.handleSubmitFromQs&&Ot?.id&&(Number(hr.submitTask)&&Ur(hr.isNew==="true"),xr(es=>({...es,submitTask:null,isNew:null})))},[hr.submitTask,Qe.handleSubmitFromQs,Ot?.id]),reactExports.useEffect(()=>{if(ft.t2i2v?.enabled){Sr(void 0);return}if(Array.isArray(Tr)&&At){const es=Tr.find(Xr=>Xr.countRemains>0&&(Xr.userType==="member"&&Qt||Xr.userType==="admin"&&Wt||Xr.userType==="member-t1"&&Xt===1||Xr.userType==="member-t2"&&Xt===2||Xr.userType==="member-t3"&&Xt===3||Xr.userType==="role")&&Xr.modelVersions?.includes(At.id));if(es){Sr({type:es.type,remaining:es.countRemains,total:es.countTotal});return}}Sr(void 0)},[Tr,At,ft.t2i2v?.enabled,Qt,Wt]);const nn=useBreakpoint("mlg"),{denseMode:Cn}=useUIDensity();return jsxRuntimeExports.jsxs("div",{className:cx(ut,"relative"),style:lt,id:Qe.id,children:[$t&&jsxRuntimeExports.jsx("div",{className:"px-2 flex flex-col gap-2 mlg:hidden bg-[rgb(var(--bg-color))]",children:jsxRuntimeExports.jsx(PriorityChannelSelectCheckbox,{value:ft.priority,onChange:vt("priority")})}),Array.isArray(kt.lora)&&jsxRuntimeExports.jsx(ControlSectionMessage,{type:ControlSectionMessageType.Warning,className:"mlg:absolute mlg:left-1/2 mlg:-translate-x-1/2 mlg:mt-2 mlg:top-full w-full text-left",children:dt("generation:lora.incompatible-lora-used-hint")}),jsxRuntimeExports.jsxs("div",{className:cx("[--height:50px] mlg:[--height:auto] dense:[--height:32px] h-[--height] flex items-center pt-2"),children:[!nn&&$t&&jsxRuntimeExports.jsx(PriorityChannelSelectCheckbox,{value:ft.priority,onChange:vt("priority"),className:"flex-none",forceHighPriorityForNonMember:gr}),jsxRuntimeExports.jsxs(UIButton$1,{variant:"filled",color:"theme",busy:xt,busyLabel:jsxRuntimeExports.jsx("span",{className:"pr-2",children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:submit.generating.label"})}),disabled:xt||Bt||!kt.ok||br||Ir,className:cx("w-full mlg:w-auto h-[--height] transition font-semibold dense:text-sm","pl-1","rounded-xl mlg:rounded-lg dense:rounded-md",(xt||Bt)&&"opacity-80",!kt.ok&&"!bg-zinc-200 dark:!bg-zinc-600 !text-neutral-600 dark:!text-neutral-400"),labelClassName:"w-full flex items-center justify-center gap-2 mlg:py-2 dense:py-0.5 pr-1",onPress:Qr,icon:t2i2vItems[Nt?"enabled":"disabled"].icon,endIcon:jsxRuntimeExports.jsx(GenerateModeSelector,{}),endIconClassName:"border-l-2 border-dsgray-300/20 pr-0.5",children:[Dr?dt("generation:submit.free-generation.label",{context:Cn}):dt("generation:submit.lets-go.label",{context:Cn}),Ot&&!Dr&&jsxRuntimeExports.jsx(CreditMeter,{iconClassName:"!size-3",children:jsxRuntimeExports.jsx("span",{className:"flex items-center gap-1",children:jsxRuntimeExports.jsx(QuotaCost,{value:Ft?.actualPrice??0,originalValue:Nt?Ft?.originalPrice:void 0,loading:Bt,className:"!text-inherit font-normal",iconClassName:"hidden",valueClassName:"text-xs"})})}),Ot&&Dr&&jsxRuntimeExports.jsxs(CreditMeter,{children:[jsxRuntimeExports.jsx("span",{className:"font-bold",children:Zr?.remaining}),"/",jsxRuntimeExports.jsx("span",{className:"text-xs",children:dt("generation:submit.free-generation.remaining-times",{remaining:Zr?.total})})]}),jsxRuntimeExports.jsx("span",{className:"hidden mlg:flex dark:bg-neutral-700/50 bg-neutral-200/50 shadow-md items-center px-1 rounded-md text-white text-xs",children:isMac()?"⌘+⏎":"Ctrl+⏎"})]})]})]})});function GenerateModeSelector(){const{me:He}=useMe(),[{enabled:Qe},it]=useT2i2vState(),lt=useBreakpoint("mlg"),ut=jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",className:"aspect-square outline-0",labelClassName:"mx-auto",color:"normal",onPress:lt?()=>{UIDialog.create({dismissable:!0,children:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:"Choose Generation Mode"}),jsxRuntimeExports.jsx(UIDialogContent,{children:dt})]})})}:void 0,children:jsxRuntimeExports.jsx(fluentChevronDown20Filled,{})}),dt=jsxRuntimeExports.jsx($de32f1b87079253c$export$3ddf2d174ce01153,{className:"outline-none",children:({close:xt})=>jsxRuntimeExports.jsx($eed445e0843c11d0$export$41f133550aa26f48,{className:"flex flex-col rounded-xl divide-y divide-zinc-300 dark:divide-zinc-600",selectionMode:"single",selectionBehavior:"replace",items:Object.values(t2i2vItems),onSelectionChange:ft=>{if(!He){openSignModal(void 0,{fromPath:"t2i2v"});return}if(ft!=="all"){const kt=Array.from(ft.values())[0]==="t2i2v";it.onAddRemoveClick(kt,T2i2vToggleScene.generate)}xt()},children:ft=>jsxRuntimeExports.jsx($eed445e0843c11d0$export$a11e76429ed99b4,{className:"p-1 cursor-pointer selected:outline-0 group/list-item",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start p-2 group-hover/list-item:bg-dsgray-100 dark:group-hover/list-item:bg-dsgray-600 rounded-lg",children:[jsxRuntimeExports.jsx("span",{className:"flex-none -translate-y-1 mr-2",children:ft.icon}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"-mt-1",children:jsxRuntimeExports.jsx(Text,{i18nKey:`generation:generate.button-selections.${ft.id}.label`})}),jsxRuntimeExports.jsx("p",{className:"text-xs opacity-80",children:jsxRuntimeExports.jsx(Text,{i18nKey:`generation:generate.button-selections.${ft.id}.description`})})]}),jsxRuntimeExports.jsxs("span",{className:"flex-none ml-4",children:[ft.id==="generation"&&(Qe?null:jsxRuntimeExports.jsx(materialSymbolsCheckCircleOutline,{})),ft.id==="t2i2v"&&(Qe?jsxRuntimeExports.jsx(materialSymbolsCheckCircleOutline,{}):jsxRuntimeExports.jsx(MembershipIconCircled,{}))]})]})})})});return lt?ut:jsxRuntimeExports.jsxs($3674c52c6b3c5bce$export$27d2ad3c5815583e,{children:[ut,jsxRuntimeExports.jsx(UIPopoverStateful,{className:"placement-bottom:mt-0 overflow-hidden",placement:"bottom end",showArrow:!0,children:dt})]})}const MotionMuiButton=motion(Button);motion(Switch);motion(TextField);function imageCaptioning(He){return captioningClient.post("/blip2_and_wd",{media_id:He.mediaId,param_dict:{}})}function CaptioningDialog({open:He,onClose:Qe,children:it}){const{t:lt}=useTranslation(["artwork"]),ut=useBreakpoint("mlg");return jsxRuntimeExports.jsxs(UIDialog,{dismissable:!0,open:He,onClose:Qe,type:ut?"drawer":"dialog",className:"w-screen max-w-screen-lg",children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:lt("artwork:captioning.title"),children:({heading:dt})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[dt,jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:lt("artwork:captioning.subtitle")})]})}),it]})}const _useCaptioning=createSWR(He=>imageCaptioning({mediaId:He}).then(Qe=>Qe.data),{revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateIfStale:!1}),useCaptioning=He=>{const{data:Qe,isValidating:it}=_useCaptioning(He);return reactExports.useMemo(()=>({data:Qe?.output?.map(ut=>({id:genId(),prompt:ut})),isValidating:it}),[Qe,it])};function ImageCaptioningForm({type:He,media:Qe,mediaId:it,onRemoveMedia:lt,onConfirmPrompt:ut}){const{t:dt}=useTranslation(["artwork","action"]),[xt,ft]=reactExports.useState(),[vt,kt]=reactExports.useState("simple-select"),[St,Tt]=reactExports.useState(),{data:Mt,isValidating:Nt}=useCaptioning(it),{data:At,loading:$t}=useGetMedia(Qe?skipToken:it),Dt=Qe??At;reactExports.useEffect(()=>{Mt?.[0]&&kt("simple-select")},[Mt]),reactExports.useEffect(()=>{track("captioning_begin",{mediaId:it})},[it]),reactExports.useEffect(()=>{Mt&&track("captioning_received_response",{mediaId:it})},[it,Mt]);const Ft=reactExports.useMemo(()=>vt==="simple-select"?{children:dt("action:confirm"),disabled:!xt,onClick:()=>{if(xt){ut?.(xt);const Bt=Mt?.filter(Ot=>Ot.id!==xt.id)?.map(Ot=>Ot.prompt)??[];track("captioning_confirmed_selection",{mediaId:it,formType:He,source:"simple-select",preferredPrompts:[xt.prompt],dislikedPrompts:Bt})}}}:vt==="unsatisfied-select"?{children:dt("action:next"),disabled:!xt,onClick:()=>{Tt(xt?.prompt),kt("input"),track("captioning_entered_edit",{mediaId:it})}}:{children:dt("action:confirm"),onClick:()=>{if(xt&&St){ut?.({...xt,prompt:St});const Bt=Mt?.filter(Ot=>Ot.id!==xt.id)?.map(Ot=>Ot.prompt)??[];track("captioning_confirmed_selection",{mediaId:it,formType:He,source:"unsatisfied-edit",preferredPrompts:[St],dislikedPrompts:Bt})}}},[vt,xt,St,ut,dt,it]);return!Dt&&!$t?jsxRuntimeExports.jsx(Preloader,{}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIDialogContent,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row gap-4 overflow-y-auto min-w-0 min-h-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex overflow-hidden rounded-lg md:w-1/3 flex-shrink-0 border border-solid border-black/10 dark:border-white/10 relative",children:[jsxRuntimeExports.jsx("img",{src:getPublicUrl(Dt),className:"w-full h-auto object-contain"}),lt&&jsxRuntimeExports.jsx(IconButton,{className:"absolute right-0 top-0",onClick:lt,children:jsxRuntimeExports.jsx(icBaselineClose,{})})]}),jsxRuntimeExports.jsx(motion.div,{className:"flex flex-col gap-2 justify-stretch flex-grow",children:Nt?jsxRuntimeExports.jsx(ImageCaptioningPreloader,{}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[vt==="unsatisfied-select"&&jsxRuntimeExports.jsxs(motion.div,{className:"flex flex-col items-start mb-2",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[jsxRuntimeExports.jsx("div",{className:"text-base font-bold",children:dt("artwork:captioning.select-and-edit.title")}),jsxRuntimeExports.jsx("div",{className:"text-sm opacity-80",children:dt("artwork:captioning.select-and-edit.subtitle")})]}),["simple-select","unsatisfied-select"].includes(vt)&&Mt?.map(Bt=>jsxRuntimeExports.jsx(ImageCaptioningPromptSelectButton,{layout:!0,layoutId:"captioning-prompt-select-button::"+Bt.id,active:xt?.id===Bt.id,onSelectPrompt:()=>ft({id:Bt.id,originalPrompt:Bt.prompt,prompt:Bt.prompt}),prompt:Bt.prompt},Bt.id)),vt==="input"&&jsxRuntimeExports.jsx(motion.div,{layout:!0,layoutId:"captioning-prompt-select-button::"+xt?.id,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"rounded-lg flex flex-col items-center",children:jsxRuntimeExports.jsx(TextField,{multiline:!0,minRows:3,maxRows:5,fullWidth:!0,value:St,label:dt("artwork:captioning.edit-prompt"),variant:"outlined",autoFocus:!0,onChange:Bt=>Tt(Bt.target.value)})}),vt==="simple-select"&&jsxRuntimeExports.jsx(Button,{variant:"outlined",size:"large",onClick:()=>kt("unsatisfied-select"),children:dt("artwork:captioning.no-good-prompt")})]})})]})}),jsxRuntimeExports.jsx(UIDialogFooter,{children:jsxRuntimeExports.jsx(Button,{variant:"contained",className:"max-mlg:w-full",...Ft})})]})}const preloaderVariants={hidden:{opacity:0},visible:{opacity:1}};function ImageCaptioningPreloader(){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:Array.from({length:4}).map((He,Qe)=>jsxRuntimeExports.jsx(motion.div,{className:"bg-skeleton h-24 rounded-lg p-4",initial:"hidden",animate:"visible",variants:preloaderVariants,transition:{repeat:1/0,repeatType:"reverse",delay:Qe*.1,duration:1.2},children:jsxRuntimeExports.jsx("div",{className:"flex flex-col gap-2 items-start justify-center overflow-hidden",children:Array.from({length:3}).map((it,lt)=>jsxRuntimeExports.jsx(motion.div,{className:cx("bg-slate-700/20 h-4",lt===2?"w-3/4":"w-full"),initial:{x:-48,opacity:0},animate:{x:0,opacity:1},transition:{repeat:1/0,repeatType:"reverse",delay:Qe*.25,duration:1.5}},lt))})},Qe))})}const ImageCaptioningPromptSelectButton=motion(({prompt:He,active:Qe,onSelectPrompt:it})=>{const lt=reactExports.useCallback(()=>{it()},[it]),ut=reactExports.useMemo(()=>{const dt=He.split(",");return dt.length<2?{diff:He,same:""}:{diff:dt[0],same:dt.slice(1).join(",").trim()}},[He]);return jsxRuntimeExports.jsx(AnimatePresence,{children:jsxRuntimeExports.jsx(MotionMuiButton,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},variant:"contained",className:cx("border border-solid p-4 text-base text-left",Qe?"bg-purple-600 border-purple-700 text-white":"bg-white border-gray-300 text-primary dark:bg-black dark:border-gray-700"),onClick:lt,children:jsxRuntimeExports.jsxs("div",{className:"block w-full",children:[jsxRuntimeExports.jsx("span",{className:cx("rounded-lg px-1 py-0.5",Qe?"bg-purple-800":"bg-purple-100 dark:bg-purple-900"),children:ut.diff}),jsxRuntimeExports.jsx("span",{className:"px-1 py-0.5",children:ut.same})]})})})});function ImageCaptioningButton(He){const{data:Qe}=useUserInfo(),{t:it}=useTranslation(["generation"]),[lt,ut]=reactExports.useState(!1),{setValues:dt}=useTaskSubmitFormContext(),[xt,ft]=reactExports.useState(),vt=kt=>{dt(St=>({...St,prompts:kt?.prompt})),ut(!1)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UITooltipTriggerWrapper,{delay:250,placement:"bottom end",trigger:jsxRuntimeExports.jsx($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{className:cx("px-2 min-w-0 outline-none",He.className),onPress:()=>{if(track("base_image_captioning_click"),!Qe)return openSignModal();ut(!0)},children:jsxRuntimeExports.jsx(ImageToPromptIconSvg,{className:"size-6"})}),children:jsxRuntimeExports.jsx("p",{className:"p-4",children:it("generation:image-to-prompt.label")})}),jsxRuntimeExports.jsx(CaptioningDialog,{open:lt,onClose:()=>ut(!1),children:xt?jsxRuntimeExports.jsx(ImageCaptioningForm,{type:"upload",media:xt,mediaId:xt.id,onRemoveMedia:()=>ft(void 0),onConfirmPrompt:vt}):jsxRuntimeExports.jsx("div",{className:"w-full p-6 pt-4 flex justify-center",children:jsxRuntimeExports.jsx(UploadImage,{onChange:kt=>ft(kt),value:xt})})})]})}function ImageToPromptIconSvg(He){return jsxRuntimeExports.jsxs("svg",{width:"25",height:"25",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",...He,children:[jsxRuntimeExports.jsx("rect",{x:"0.982518",y:"5.13584",width:"11.4884",height:"11.4884",rx:"1.8277",stroke:"currentColor",strokeWidth:"1.5666"}),jsxRuntimeExports.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.31189 9.52168C9.95565 9.52168 10.4775 8.99981 10.4775 8.35605C10.4775 7.7123 9.95565 7.19043 9.31189 7.19043C8.66814 7.19043 8.14627 7.7123 8.14627 8.35605C8.14627 8.99981 8.66814 9.52168 9.31189 9.52168ZM6.16954 11.8371C6.45866 12.3743 7.22941 12.374 7.51807 11.8365C7.76889 11.3694 8.40705 11.2925 8.76161 11.6867L11.9206 15.1982C12.5252 15.8703 12.0482 16.9411 11.1441 16.9411H4.77681L4.77679 16.9411L4.77678 16.941H1.65721C0.863057 16.941 0.359466 16.0898 0.741857 15.3938L3.52583 10.3263C3.92447 9.60074 4.96857 9.60528 5.36088 10.3343L6.16954 11.8371Z",fill:"currentColor"}),jsxRuntimeExports.jsxs("mask",{id:"path-3-outside-1_5820_7111",maskUnits:"userSpaceOnUse",x:"8.12109",y:"8.61914",width:"17",height:"17",fill:"black",children:[jsxRuntimeExports.jsx("rect",{x:"8.12109",y:"8.61914",width:"17",height:"17"}),jsxRuntimeExports.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.2099 10.6191C11.0563 10.6191 10.1211 11.5543 10.1211 12.7079V21.0631C10.1211 22.2167 11.0563 23.1519 12.2099 23.1519H20.5651C21.7187 23.1519 22.6539 22.2167 22.6539 21.0631V12.7079C22.6539 11.5543 21.7187 10.6191 20.5651 10.6191H12.2099ZM14.3709 19.9902V20.4665H18.5494V19.9902C17.7599 19.9902 17.3651 19.6726 17.3651 19.0376V13.9119C17.3651 13.7153 17.5253 13.617 17.8456 13.617C18.3669 13.617 18.7319 13.7645 18.9405 14.0593C19.1565 14.3541 19.2831 14.8002 19.3203 15.3974L19.9683 15.3407V12.8573C19.7747 12.8875 19.5587 12.9102 19.3203 12.9253C19.082 12.9404 18.8809 12.948 18.717 12.948H14.3039C14.1698 12.948 13.9873 12.9404 13.7564 12.9253C13.5255 12.9102 13.3132 12.8875 13.1196 12.8573L12.8067 15.3748L13.4994 15.4768C13.5665 15.1593 13.641 14.8834 13.7229 14.649C13.8123 14.4071 13.9166 14.2067 14.0357 14.048C14.1623 13.8892 14.3076 13.772 14.4715 13.6964C14.6428 13.6133 14.8439 13.5717 15.0748 13.5717C15.3802 13.5717 15.5328 13.6851 15.5328 13.9119V19.0376C15.5328 19.6726 15.1455 19.9902 14.3709 19.9902Z"})]}),jsxRuntimeExports.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.2099 10.6191C11.0563 10.6191 10.1211 11.5543 10.1211 12.7079V21.0631C10.1211 22.2167 11.0563 23.1519 12.2099 23.1519H20.5651C21.7187 23.1519 22.6539 22.2167 22.6539 21.0631V12.7079C22.6539 11.5543 21.7187 10.6191 20.5651 10.6191H12.2099ZM14.3709 19.9902V20.4665H18.5494V19.9902C17.7599 19.9902 17.3651 19.6726 17.3651 19.0376V13.9119C17.3651 13.7153 17.5253 13.617 17.8456 13.617C18.3669 13.617 18.7319 13.7645 18.9405 14.0593C19.1565 14.3541 19.2831 14.8002 19.3203 15.3974L19.9683 15.3407V12.8573C19.7747 12.8875 19.5587 12.9102 19.3203 12.9253C19.082 12.9404 18.8809 12.948 18.717 12.948H14.3039C14.1698 12.948 13.9873 12.9404 13.7564 12.9253C13.5255 12.9102 13.3132 12.8875 13.1196 12.8573L12.8067 15.3748L13.4994 15.4768C13.5665 15.1593 13.641 14.8834 13.7229 14.649C13.8123 14.4071 13.9166 14.2067 14.0357 14.048C14.1623 13.8892 14.3076 13.772 14.4715 13.6964C14.6428 13.6133 14.8439 13.5717 15.0748 13.5717C15.3802 13.5717 15.5328 13.6851 15.5328 13.9119V19.0376C15.5328 19.6726 15.1455 19.9902 14.3709 19.9902Z",className:"fill-black dark:fill-[#CCC]"}),jsxRuntimeExports.jsx("path",{d:"M14.3709 20.4665H12.8043V22.0331H14.3709V20.4665ZM14.3709 19.9902V18.4236H12.8043V19.9902H14.3709ZM18.5494 20.4665V22.0331H20.116V20.4665H18.5494ZM18.5494 19.9902H20.116V18.4236H18.5494V19.9902ZM18.9405 14.0593L17.6615 14.964L17.669 14.9746L17.6767 14.9851L18.9405 14.0593ZM19.3203 15.3974L17.7568 15.4949L17.8567 17.0981L19.4569 16.9581L19.3203 15.3974ZM19.9683 15.3407L20.1049 16.9014L21.5349 16.7762V15.3407H19.9683ZM19.9683 12.8573H21.5349V11.027L19.7266 11.3094L19.9683 12.8573ZM19.3203 12.9253L19.4195 14.4888L19.4195 14.4888L19.3203 12.9253ZM13.7564 12.9253L13.654 14.4885L13.654 14.4886L13.7564 12.9253ZM13.1196 12.8573L13.3613 11.3094L11.7643 11.06L11.5649 12.6641L13.1196 12.8573ZM12.8067 15.3748L11.2521 15.1816L11.0633 16.7014L12.5784 16.9246L12.8067 15.3748ZM13.4994 15.4768L13.2711 17.0267L14.728 17.2413L15.0323 15.8004L13.4994 15.4768ZM13.7229 14.649L12.2534 14.1061L12.2486 14.119L12.2441 14.132L13.7229 14.649ZM14.0357 14.048L12.811 13.0711L12.7966 13.0891L12.7828 13.1075L14.0357 14.048ZM14.4715 13.6964L15.1277 15.1189L15.1417 15.1125L15.1556 15.1057L14.4715 13.6964ZM11.6877 12.7079C11.6877 12.4195 11.9215 12.1857 12.2099 12.1857V9.05254C10.1911 9.05254 8.55449 10.6891 8.55449 12.7079H11.6877ZM11.6877 21.0631V12.7079H8.55449V21.0631H11.6877ZM12.2099 21.5853C11.9215 21.5853 11.6877 21.3515 11.6877 21.0631H8.55449C8.55449 23.082 10.1911 24.7185 12.2099 24.7185V21.5853ZM20.5651 21.5853H12.2099V24.7185H20.5651V21.5853ZM21.0873 21.0631C21.0873 21.3515 20.8535 21.5853 20.5651 21.5853V24.7185C22.5839 24.7185 24.2205 23.0819 24.2205 21.0631H21.0873ZM21.0873 12.7079V21.0631H24.2205V12.7079H21.0873ZM20.5651 12.1857C20.8535 12.1857 21.0873 12.4195 21.0873 12.7079H24.2205C24.2205 10.6891 22.5839 9.05254 20.5651 9.05254V12.1857ZM12.2099 12.1857H20.5651V9.05254H12.2099V12.1857ZM15.9375 20.4665V19.9902H12.8043V20.4665H15.9375ZM18.5494 18.8999H14.3709V22.0331H18.5494V18.8999ZM16.9828 19.9902V20.4665H20.116V19.9902H16.9828ZM15.7985 19.0376C15.7985 19.698 16.0206 20.4429 16.6793 20.9727C17.2729 21.4502 17.9858 21.5568 18.5494 21.5568V18.4236C18.3235 18.4236 18.4443 18.3714 18.6431 18.5313C18.7529 18.6196 18.837 18.7354 18.8864 18.8546C18.9318 18.9642 18.9317 19.0368 18.9317 19.0376H15.7985ZM15.7985 13.9119V19.0376H18.9317V13.9119H15.7985ZM17.8456 12.0504C17.5761 12.0504 17.1105 12.0826 16.6658 12.3556C16.0961 12.7052 15.7985 13.2995 15.7985 13.9119H18.9317C18.9317 14.0789 18.8963 14.3014 18.7718 14.5306C18.6456 14.763 18.47 14.9245 18.3047 15.026C18.1498 15.121 18.0165 15.1565 17.9494 15.1703C17.9131 15.1777 17.8858 15.1809 17.8698 15.1823C17.8615 15.183 17.8553 15.1833 17.8514 15.1835C17.8495 15.1836 17.848 15.1836 17.847 15.1836C17.8465 15.1836 17.8462 15.1836 17.8459 15.1836C17.8457 15.1836 17.8456 15.1836 17.8456 15.1836V12.0504ZM20.2195 13.1546C19.6017 12.2813 18.6355 12.0504 17.8456 12.0504V15.1836C17.9669 15.1836 17.9773 15.2019 17.9236 15.1802C17.8939 15.1682 17.8488 15.1455 17.7981 15.1064C17.7465 15.0667 17.6997 15.018 17.6615 14.964L20.2195 13.1546ZM20.8839 15.2999C20.8387 14.5755 20.6772 13.7791 20.2042 13.1335L17.6767 14.9851C17.6496 14.9481 17.6649 14.9529 17.6904 15.0428C17.7158 15.1322 17.7432 15.2777 17.7568 15.4949L20.8839 15.2999ZM19.8318 13.7801L19.1838 13.8368L19.4569 16.9581L20.1049 16.9014L19.8318 13.7801ZM18.4017 12.8573V15.3407H21.5349V12.8573H18.4017ZM19.4195 14.4888C19.6957 14.4712 19.9603 14.4441 20.21 14.4051L19.7266 11.3094C19.5891 11.3309 19.4217 11.3491 19.2212 11.3618L19.4195 14.4888ZM18.717 14.5146C18.9251 14.5146 19.1616 14.5051 19.4195 14.4888L19.2212 11.3618C19.0024 11.3757 18.8366 11.3814 18.717 11.3814V14.5146ZM14.3039 14.5146H18.717V11.3814H14.3039V14.5146ZM13.654 14.4886C13.8984 14.5046 14.1199 14.5146 14.3039 14.5146V11.3814C14.2197 11.3814 14.0762 11.3763 13.8588 11.362L13.654 14.4886ZM12.8779 14.4051C13.1251 14.4437 13.3846 14.4709 13.654 14.4885L13.8588 11.362C13.6665 11.3495 13.5014 11.3313 13.3613 11.3094L12.8779 14.4051ZM14.3614 15.5679L14.6742 13.0504L11.5649 12.6641L11.2521 15.1816L14.3614 15.5679ZM13.7278 13.927L13.0351 13.8249L12.5784 16.9246L13.2711 17.0267L13.7278 13.927ZM12.2441 14.132C12.1345 14.4454 12.0436 14.7888 11.9666 15.1532L15.0323 15.8004C15.0894 15.5298 15.1474 15.3213 15.2017 15.166L12.2441 14.132ZM12.7828 13.1075C12.5501 13.4176 12.3805 13.7619 12.2534 14.1061L15.1924 15.1919C15.244 15.0522 15.283 14.9959 15.2886 14.9884L12.7828 13.1075ZM13.8152 12.2739C13.4033 12.464 13.0705 12.7457 12.811 13.0711L15.2605 15.0248C15.2587 15.027 15.2471 15.0411 15.2233 15.0603C15.199 15.0799 15.1668 15.1009 15.1277 15.1189L13.8152 12.2739ZM15.0748 12.0051C14.6565 12.0051 14.2124 12.0808 13.7873 12.2871L15.1556 15.1057C15.0732 15.1458 15.0313 15.1383 15.0748 15.1383V12.0051ZM17.0994 13.9119C17.0994 13.4104 16.9058 12.8101 16.3524 12.3991C15.8863 12.0529 15.3757 12.0051 15.0748 12.0051V15.1383C15.0593 15.1383 14.9945 15.1374 14.8987 15.1136C14.8015 15.0896 14.6476 15.0357 14.4843 14.9144C14.3119 14.7864 14.1678 14.6114 14.075 14.4045C13.9861 14.2066 13.9662 14.0295 13.9662 13.9119H17.0994ZM17.0994 19.0376V13.9119H13.9662V19.0376H17.0994ZM14.3709 21.5568C14.9324 21.5568 15.6446 21.448 16.2356 20.9635C16.8861 20.4303 17.0994 19.6878 17.0994 19.0376H13.9662C13.9662 19.0376 13.9662 19.0336 13.9669 19.026C13.9675 19.0184 13.9687 19.0069 13.9713 18.9919C13.9766 18.9619 13.9873 18.9176 14.009 18.8643C14.0563 18.7479 14.1383 18.6314 14.2492 18.5405C14.4528 18.3736 14.584 18.4236 14.3709 18.4236V21.5568Z",fill:"currentColor",mask:"url(#path-3-outside-1_5820_7111)"}),jsxRuntimeExports.jsx("path",{d:"M15.8051 7.90967L22.7321 7.90946L20.0974 4.75835",stroke:"currentColor",strokeWidth:"1.5666",strokeLinecap:"round",strokeLinejoin:"round"})]})}const buttonTabStyles=ce$1({slots:{root:"group relative inline-grid grid-cols-[auto_1fr_auto] items-center h-[--ui-size] rounded-md focus:outline outline-1 outline-offset-0 transition duration-75 w-fit",label:"row-start-1 col-start-2",startIcon:"row-start-1 col-start-1 size-[--ui-size]",endIcon:"row-start-1 col-start-3 size-[--ui-size]",selectedIndicator:"absolute -bottom-px left-4 right-4 border-b group-focus:border-none"},variants:{size:{small:{},normal:{},large:{}},hasLabel:{false:{label:"hidden"}},hasStartIcon:{false:{startIcon:"hidden"}},hasEndIcon:{false:{endIcon:"hidden"}},isSelected:{false:{root:"outline-black/50 dark:outline-white/50 hover:bg-black/10 dark:hover:bg-white/10",selectedIndicator:"border-black/50 dark:border-white/50"},true:{root:"outline-purple-600 dark:outline-purple-500 hover:bg-purple-600/10 dark:hover:bg-purple-500/10 text-purple-500 dark:text-purple-600 font-semibold",selectedIndicator:"border-purple-600 dark:border-purple-500"}}},compoundVariants:[{size:["small","normal"],className:{root:"text-sm"}},{size:"large",className:{root:"text-base"}},{size:"small",className:{root:"[--ui-size:theme(spacing.7)]"}},{size:"normal",className:{root:"[--ui-size:theme(spacing.8)]"}},{size:"large",className:{root:"[--ui-size:theme(spacing.10)]"}},{hasStartIcon:!0,className:{startIcon:"grid place-content-center"}},{hasEndIcon:!0,className:{endIcon:"grid place-content-center"}},{hasStartIcon:!1,size:"small",className:{root:"pl-2"}},{hasLabel:!0,hasEndIcon:!1,size:"small",className:{root:"pr-2"}},{hasStartIcon:!1,size:"normal",className:{root:"pl-2.5"}},{hasLabel:!0,hasEndIcon:!1,size:"normal",className:{root:"pr-2.5"}},{hasStartIcon:!1,size:"large",className:{root:"pl-3"}},{hasLabel:!0,hasEndIcon:!1,size:"large",className:{root:"pr-3"}}],compoundSlots:[{slots:["startIcon","endIcon"],className:"h-full aspect-square"}],defaultVariants:{size:"normal",hasLabel:!1,hasStartIcon:!1,hasEndIcon:!1,isSelected:!1}}),UIButtonTab=reactExports.forwardRef(function He(Qe,it){const{isSelected:lt,icon:ut,endIcon:dt,className:xt,startIconClassName:ft,labelClassName:vt,endIconClassName:kt,size:St,children:Tt,...Mt}=Qe,Nt=buttonTabStyles({size:St,hasLabel:!!Tt,hasStartIcon:!!ut,hasEndIcon:!!dt,isSelected:lt});return jsxRuntimeExports.jsxs($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{...Mt,ref:it,className:Nt.root({className:xt}),children:[jsxRuntimeExports.jsx("span",{className:Nt.startIcon({className:ft}),children:ut}),jsxRuntimeExports.jsx("span",{className:Nt.label({className:vt}),children:Tt}),jsxRuntimeExports.jsx("span",{className:Nt.endIcon({className:kt}),children:dt}),jsxRuntimeExports.jsx("span",{className:Nt.selectedIndicator()})]})});UIButtonTab.displayName="UIButtonTab";const fluentArrowTrendingSparkle24Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M4.854 8.146a2.84 2.84 0 0 1 .685 1.114l.448 1.377a.544.544 0 0 0 1.026 0l.448-1.377a2.84 2.84 0 0 1 1.798-1.796l1.378-.448a.544.544 0 0 0 0-1.025l-.028-.007l-1.378-.448A2.84 2.84 0 0 1 7.433 3.74l-.447-1.377a.544.544 0 0 0-1.027 0L5.511 3.74l-.011.034a2.84 2.84 0 0 1-1.759 1.762l-1.378.448a.544.544 0 0 0 0 1.025l1.378.448c.42.14.8.376 1.113.689M20 7a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0v-2.586l-5.793 5.793a1 1 0 0 1-1.414 0L10 14.414l-5.293 5.293a1 1 0 0 1-1.414-1.414l6-6a1 1 0 0 1 1.414 0l1.793 1.793L17.586 9H15a1 1 0 1 1 0-2zm.017 10.965l.766.248l.015.004a.303.303 0 0 1 .147.46a.3.3 0 0 1-.147.11l-.765.248a1.58 1.58 0 0 0-1 .999l-.248.764a.302.302 0 0 1-.57 0l-.249-.764a1.58 1.58 0 0 0-.999-1.002l-.765-.249a.303.303 0 0 1-.147-.46a.3.3 0 0 1 .147-.11l.765-.248a1.58 1.58 0 0 0 .984-.998l.249-.765a.302.302 0 0 1 .57 0l.249.764a1.58 1.58 0 0 0 .999.999"})}),icBaselineBrush=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7 14c-1.66 0-3 1.34-3 3c0 1.31-1.16 2-2 2c.92 1.22 2.49 2 4 2c2.21 0 4-1.79 4-4c0-1.66-1.34-3-3-3zm13.71-9.37l-1.34-1.34a.996.996 0 0 0-1.41 0L9 12.25L11.75 15l8.96-8.96a.996.996 0 0 0 0-1.41z"})});function GeneratorTabs(He){const{t:Qe}=useTranslation(["generation"]),{state:it,dispatch:lt}=reactExports.useContext(GeneratorContext),ut=useNavigate(),dt=useParams(),xt=useBreakpoint("mlg");reactExports.useEffect(()=>{const vt=generatorModeFromParamsTab(dt.tab);it.mode!==vt&&lt({type:"set-mode-value",value:vt})},[dt.tab]);const ft=reactExports.useMemo(()=>[[GeneratorMode.Generate,Qe("generation:generate.tab.generate.label"),icBaselineBrush,"/pixai"],[GeneratorMode.Fill,Qe("generation:generate.tab.edit.label"),icBaselineEdit,"/generator/image/editor"],[GeneratorMode.EnhanceImage,Qe("generation:generate.tab.enhance-image.label"),fluentArrowTrendingSparkle24Filled,"/generator/image/enhancement",{new:"2025-04-30T23:59:59Z"}],[GeneratorMode.ImageToVideo,Qe("generation:generate.tab.image-to-video.label"),riVideoAiLine,"/generator/image/animation"]],[Qe]);return jsxRuntimeExports.jsx("div",{className:cx("flex",He.className),children:ft.filter(([vt])=>xt&&!He.alwaysShowFillTab?vt!==GeneratorMode.Fill:!0).map(([vt,kt,St,Tt,Mt])=>jsxRuntimeExports.jsxs(UIButtonTab,{icon:jsxRuntimeExports.jsx(St,{}),isSelected:it.mode===vt,className:"shrink-0",onPress:()=>{track("gen_page_panel_tab_click",{mode:vt}),ut(Tt)},children:[kt,a$3({new:N$4.union(!0,N$4.when(Nt=>Nt&&(typeof Nt=="string"||Nt instanceof Date)&&defaultDayjs().isSameOrBefore(Nt,"second")))},Mt)&&jsxRuntimeExports.jsx(NewLabel,{className:"ml-1"})]},vt))})}const PROMPT_HELPER_ENABLED_HINT_LAST_SHOWN_STORAGE_KEY="generator::prompt-helper-enabled-hint-shown";function hasPromptHelperEnabledHintShownToday(){const He=localStorage.getItem(PROMPT_HELPER_ENABLED_HINT_LAST_SHOWN_STORAGE_KEY),Qe=attemptParseJSON(He);return Qe&&defaultDayjs(Qe).isAfter(defaultDayjs().startOf("day"))}function resetPromptHelperLastShownTime(){localStorage.setItem(PROMPT_HELPER_ENABLED_HINT_LAST_SHOWN_STORAGE_KEY,JSON.stringify(new Date().getTime()))}function removeTriggerWordsFromPrompts(He){const{prompts:Qe,triggerWords:it}=He??{};if(!Qe||!it)return Qe;const lt=it.replace(/^,+|,+$/g,"");return Qe.replaceAll(lt,"").trim().replace(/,+$/,"")}const PromptsCompletionContext=reactExports.createContext({enable:void 0,setEnable:()=>{},loadingProgress:motionValue(0),loadingComplete:!1,setLoadingComplete:()=>{},setDataRef:{current:void 0},textareaRef:{current:null},completionRef:{current:null}});function PromptsCompletionHelpContent(){const{t:He}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs("div",{className:"p-4 text-sm max-w-[24rem]",children:[He("generation:completion.help.description"),jsxRuntimeExports.jsx("h3",{className:"mt-2 font-semibold",children:He("generation:completion.help.keyboard-shortcuts-title")}),jsxRuntimeExports.jsxs("ul",{className:"ml-4 list-disc",children:[jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"↑/↓"}),":"," ",He("generation:completion.help.keyboard-shortcuts-up-down")]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Tab"}),":"," ",He("generation:completion.help.keyboard-shortcuts-tab")]})]})]})}function PromptsCompletionButton(He){const{t:Qe}=useTranslation(["generation"]),{enable:it,setEnable:lt,loadingProgress:ut,loadingComplete:dt}=reactExports.useContext(PromptsCompletionContext),{labelPlacement:xt,...ft}=He,vt=reactExports.useCallback(St=>{track("auto_complete_check",{checked:St}),ut.set(0),lt(St)},[ut,lt]),kt=jsxRuntimeExports.jsx(UITooltipTriggerWrapper,{delay:250,placement:"bottom end",trigger:jsxRuntimeExports.jsx($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{className:"font-medium text-xs",onPress:St=>{St.target.parentElement?.click()},children:Qe("generation:completion.label")}),children:jsxRuntimeExports.jsx(PromptsCompletionHelpContent,{})});return jsxRuntimeExports.jsx("div",{...ft,className:cx("flex items-center gap-1 select-none",He.className),children:it&&!dt?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[kt,jsxRuntimeExports.jsxs("div",{className:"relative w-[22px] h-[10px] rounded-full overflow-hidden ml-auto",children:[jsxRuntimeExports.jsx("div",{className:"w-full h-full opacity-30 bg-theme-primary"}),jsxRuntimeExports.jsx(motion.div,{className:"absolute -left-full right-0 top-0 bottom-0 bg-theme-primary scale-x-[--scaleX]",style:{"--scaleX":ut}})]})]}):jsxRuntimeExports.jsx(UISwitch,{labelPlacement:xt??"start",className:"ml-auto items-center gap-1",size:"xsmall",isSelected:!!it,onChange:vt,children:kt})})}var SharedWorkerSupported="SharedWorker"in globalThis,SharedWorkerPolyfill=class{ActualWorker;constructor(He,Qe){SharedWorkerSupported?this.ActualWorker=new SharedWorker(He,Qe):this.ActualWorker=new Worker(He,Qe)}get onmessage(){return SharedWorkerSupported?this.ActualWorker?.port.onmessage:this.ActualWorker.onmessage}set onmessage(He){SharedWorkerSupported?this.ActualWorker.port.onmessage=He:this.ActualWorker.onmessage=He}get onmessageerror(){return SharedWorkerSupported?this.ActualWorker?.port.onmessageerror:this.ActualWorker.onmessageerror}set onmessageerror(He){SharedWorkerSupported?this.ActualWorker.port.onmessageerror=He:this.ActualWorker.onmessageerror=He}start(){if(SharedWorkerSupported)return this.ActualWorker?.port.start()}postMessage(He,Qe){return SharedWorkerSupported?this.ActualWorker?.port.postMessage(He,Qe):this.ActualWorker.postMessage(He,Qe)}terminate(){return SharedWorkerSupported?this.ActualWorker?.port.close():this.ActualWorker.terminate()}close(){return this.terminate()}get port(){return SharedWorkerSupported?this.ActualWorker.port:this.ActualWorker}get onerror(){return this.ActualWorker.onerror}set onerror(He){this.ActualWorker.onerror=He}addEventListener(He,Qe,it){return SharedWorkerSupported&&He!=="error"?this.ActualWorker?.port.addEventListener(He,Qe,it):this.ActualWorker.addEventListener(He,Qe,it)}removeEventListener(He,Qe,it){return SharedWorkerSupported&&He!=="error"?this.ActualWorker?.port.removeEventListener(He,Qe,it):this.ActualWorker.removeEventListener(He,Qe,it)}dispatchEvent(He){return this.ActualWorker.dispatchEvent(He)}},src_default=SharedWorkerPolyfill;const listWorldCharactersDummy=async()=>({artworks:{nodes:[],pageInfo:{hasPreviousPage:!1,hasNextPage:!1},totalCount:0}});function useAllCharacters(){const He=!!useWorldCharacterExperiment(),{items:Qe,hasMore:it,loading:lt,loadMore:ut}=usePaginatedData({fetcher:He?client.listWorldCharacters:listWorldCharactersDummy,getArgs:dt=>({first:36,after:dt?.artworks.pageInfo?.endCursor,type:ArtworkType.Character}),getItems:dt=>getNodesFromConnection(dt.artworks).reverse(),getHasMore:dt=>dt.artworks?.pageInfo.hasNextPage??!1,getTotalCount:dt=>dt.artworks?.totalCount??void 0});return reactExports.useEffect(()=>{it&&ut()},[Qe,it]),{items:Qe,loading:lt}}getDefaultStore();try{window.caches&&caches.delete("tag-complete")}catch{}const POST_COUNT_COLOR_CODES=["bg-gray-400","bg-gray-500","bg-gray-600","bg-gray-700","bg-gray-800","bg-gray-900","bg-yellow-500","bg-yellow-600","bg-yellow-700","bg-yellow-800","bg-yellow-900","bg-orange-500","bg-orange-600","bg-orange-700","bg-orange-800","bg-orange-900"],POST_COUNT_COLOR_CODE_TABLE_MIN_POST_COUNT=1,POST_COUNT_COLOR_CODE_TABLE_MAX_POST_COUNT=1e6,POST_COUNT_COLOR_CODE_TABLE=(()=>{const He=[],Qe=Math.log10(POST_COUNT_COLOR_CODE_TABLE_MIN_POST_COUNT),lt=(Math.log10(POST_COUNT_COLOR_CODE_TABLE_MAX_POST_COUNT)-Qe)/POST_COUNT_COLOR_CODES.length;for(let ut=0;ut<POST_COUNT_COLOR_CODES.length;ut++)He.push([Math.pow(10,Qe+lt*ut),Math.pow(10,Qe+lt*(ut+1)),POST_COUNT_COLOR_CODES[ut]]);return He})(),getColorCode=He=>{for(const[Qe,it,lt]of POST_COUNT_COLOR_CODE_TABLE)if(He>=Qe&&He<it)return lt;return POST_COUNT_COLOR_CODES[POST_COUNT_COLOR_CODES.length-1]};function PromptsCompletionProvider(He){const[Qe,it]=useTagComplete(),lt=useMotionValue(0),[ut,dt]=reactExports.useState(!1),xt=reactExports.useRef(),ft=reactExports.useRef(null),vt=reactExports.useRef(null);return jsxRuntimeExports.jsx(PromptsCompletionContext.Provider,{value:{enable:He.enable??Qe,setEnable:He.setEnable??it,loadingProgress:lt,loadingComplete:ut,setLoadingComplete:dt,setDataRef:xt,textareaRef:ft,completionRef:vt},children:He.children})}function PromptsCompletionDisplay(){const{enable:He}=reactExports.useContext(PromptsCompletionContext);return jsxRuntimeExports.jsx(reactExports.Suspense,{children:He&&jsxRuntimeExports.jsx(PromptsCompletionDisplayImpl,{})})}function PromptsCompletionDisplayImpl(){const{setDataRef:He,loadingProgress:Qe,setLoadingComplete:it,textareaRef:lt,completionRef:ut}=reactExports.useContext(PromptsCompletionContext),{t:dt}=useTranslation(["worlds"]),[xt,ft]=reactExports.useState(void 0);He.current=Tr=>{JSON.stringify(Tr)!==JSON.stringify(xt)&&ft(Tr)};const vt=reactExports.useRef(null),kt=reactExports.useRef(null),St=reactExports.useRef(null),Tt=reactExports.useRef(null),[Mt,Nt]=reactExports.useState(null),[At,$t]=reactExports.useState(0),[Dt,Ft]=useSelectedCharacter(),[Bt,Ot]=useLocalStorage({key:"character::default-override",defaultValue:!1}),{items:Qt,loading:Wt}=useAllCharacters(),{data:Xt}=useSWR$1("worker:tagComplete",getWorkerUrl,{suspense:!0}),{data:{tagCompleteAssets:Kt}={}}=useDynamicConstants({suspense:!0}),[Jt,hr]=reactExports.useState(null);reactExports.useEffect(()=>{const Tr=new src_default(Xt,{type:"module"}),$r=()=>{Tt.current&&(St.current=Tt.current,Tr.postMessage({type:"completion",payload:Tt.current.req}),Tt.current=null)};return Tr.onmessage=Zr=>{const Sr=Zr.data;switch(Sr.type){case"progress":{Qe.set(Sr.progress),it(Sr.progress>=1);break}case"completion":{Nt({...St.current,completions:Sr.completions,time:Sr.time}),$t(0),St.current=null,$r();break}}},Tr.onerror=Zr=>{hr(null),Nt(null),St.current=null,Tt.current=null,toast.error(Zr.message)},Tr.postMessage({type:"init",payload:{assets:Kt}}),$r(),hr(Tr),()=>{hr(null),Tr.close(),Tt.current||(Tt.current=St.current),St.current=null,Nt(null)}},[Qe,it,Xt]),reactExports.useEffect(()=>{!Wt&&Qt&&Jt&&Jt.postMessage({type:"updateCharacters",payload:{characters:Qt.map(Tr=>({character:Tr.title,world:Tr.character.worlds?.map($r=>$r.name)?.[0]??"",characterId:Tr.character.id,media:getThumbnailUrl(Tr.media)}))}})},[Qt,Wt,Jt]);const xr=reactExports.useCallback(Tr=>{!Jt||St.current?Tt.current=Tr:(St.current=Tr,Jt.postMessage({type:"completion",payload:Tr.req}))},[Jt]);reactExports.useEffect(()=>{if(!xt){Nt(null);return}const Tr=xt.prompts.slice(0,xt.selectionStart),[,$r="",Zr=""]=Tr.match(/(^|[\s\S]*[,()[\]]\s*)([^,()[\]]*)$/)??[],Sr=xt.prompts.slice(xt.selectionEnd).replace(/^\s*,\s*/,"");xr({data:xt,query:Zr,prefix:$r,suffix:Sr,req:{query:Zr,prefix:$r}})},[xt,xr]);const gr=reactExports.useCallback(()=>(Mt?.completions.length??0)>0,[Mt]),br=reactExports.useCallback(async(Tr=At)=>{if(!Mt||!Mt.completions[Tr]||!lt.current)return;const $r=(Dr,wr)=>{lt.current.focus(),lt.current.setSelectionRange(Dr,wr)},Zr=Mt?.completions[Tr];if(Zr.characterId){const Dr=Zr.characterId;if($r(Mt.prefix.length,Mt.data.prompts.length-Mt.suffix.length),document.execCommand("insertText",!1,""),Nt(null),Dt===Dr)return;if(Dt&&!Bt){const{value:wr,suffixSelected:qr}=await dialogWorldCharacterConfirm({title:dt("worlds:dialog.replace-character.title"),description:dt("worlds:dialog.replace-character.content"),cancelLabel:dt("worlds:dialog.replace-character.cancel"),confirmLabel:dt("worlds:dialog.replace-character.confirm"),suffixLabel:dt("worlds:dialog.replace-character.remember")});if(!wr)return;qr&&Ot(!0)}setCharacterMayApplyModel(),track("add_chter_success",{scene:"prompt",chterId:Dt,hasAutoChangeModel:!1}),Ft(Dr);return}const Sr=Zr.label+", ";$r(Mt.prefix.length,Mt.data.prompts.length-Mt.suffix.length),document.execCommand("insertText",!1,Sr),$r(Mt.prefix.length+Sr.length,Mt.prefix.length+Sr.length),Nt(null)},[At,Mt,lt]),vr=reactExports.useCallback(Tr=>{Mt&&$t((At+Tr+Mt.completions.length)%Mt.completions.length)},[Mt,At]),yr=reactExports.useCallback(Tr=>{kt.current?.contains(Tr.relatedTarget)||Nt(null)},[]);reactExports.useImperativeHandle(ut,()=>({isOpen:gr,confirm:br,shift:vr,onInputBlur:yr}),[br,vr,yr]);const Cr=reactExports.useMemo(()=>jsxRuntimeExports.jsx("div",{className:"px-1 py-0.5 rounded-md tracking-wide border border-solid border-gray-400 text-gray-400 scale-75 leading-none",children:"TAB"}),[]),{overlayProps:Rr,updatePosition:Ir}=$2a41e45df1593e64$export$d39e1813b3bdd0e1({targetRef:vt,overlayRef:kt,placement:"bottom left"});return reactExports.useLayoutEffect(Ir,[Mt]),jsxRuntimeExports.jsxs(WorkbenchLayoutPortal,{children:[jsxRuntimeExports.jsx("div",{ref:vt,className:"z-20 fixed -translate-y-full",style:{left:Mt?.data.x||-1e3,top:Mt?.data.y||-1e3},children:jsxRuntimeExports.jsx("wbr",{})}),Mt?.completions.length?jsxRuntimeExports.jsxs("div",{ref:kt,...Rr,className:cx(Rr.className,"flex flex-col bg-background border border-solid border-gray-100 dark:border-gray-600 min-w-[10rem] max-w-[20vw] rounded-md overflow-hidden py-0.5"),children:[Mt?.completions.map((Tr,$r)=>jsxRuntimeExports.jsxs("button",{className:cx("px-1 py-px w-full text-start flex items-center justify-between gap-1",$r===At?"bg-background-light":"text-primary-light"),onClick:()=>br($r),children:[jsxRuntimeExports.jsxs("span",{className:"flex gap-1 max-w-[20vw] truncate items-center",children:[Tr.media&&jsxRuntimeExports.jsx("img",{className:"min-w-4 size-4 rounded-full object-cover",src:Tr.media}),Tr.label]}),Tr.post_count?jsxRuntimeExports.jsx("div",{className:cx("shrink-0 rounded-full px-1 py-0.5 text-[11px] leading-none text-white bg-gray-400",getColorCode(Tr.post_count)),children:formatNum(Tr.post_count)}):null,jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx("div",{className:"shrink-0",children:$r===At&&Cr})]},$r)),Mt?.time?jsxRuntimeExports.jsxs("div",{className:"absolute bottom-0 right-0 text-xs text-gray-600 dark:text-gray-400 -translate-x-1/1",children:[Mt.time.toFixed(1),"ms"]}):null]}):null]})}async function getWorkerUrl(){class He{constructor(ut,dt){this.url=ut,this.options=dt}}const{url:Qe}=new He(new URL("https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/tagComplete.worker-2xMhtpBJ.js",import.meta.url),{type:"module"}),it=await(await fetch(Qe)).text();return`data:application/javascript,${encodeURIComponent(it)}`}const properties=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],isFirefox=window.mozInnerScreenX!=null;function getCaretCoordinates(He,Qe,it){const lt=document.createElement("div");lt.id="input-textarea-caret-position-mirror-div";const ut=lt.style,dt=window.getComputedStyle(He),xt=He.nodeName==="INPUT";ut.whiteSpace="pre-wrap",xt||(ut.wordWrap="break-word"),ut.position="absolute",ut.visibility="hidden",properties.forEach(function(kt){ut[kt]=dt[kt]}),isFirefox?He.scrollHeight>parseInt(dt.height)&&(ut.overflowY="scroll"):ut.overflow="hidden",lt.textContent=He.value.substring(0,Qe),xt&&(lt.textContent=lt.textContent.replace(/\s/g," "));const ft=document.createElement("span");ft.textContent=He.value.substring(Qe)||".",lt.appendChild(ft),document.body.appendChild(lt);const vt={top:ft.offsetTop+parseInt(dt.borderTopWidth),left:ft.offsetLeft+parseInt(dt.borderLeftWidth),height:parseInt(dt.lineHeight)};return document.body.removeChild(lt),vt}function setRef(He,Qe){typeof He=="function"?He(Qe):He&&(He.current=Qe)}function useForkRef(...He){return reactExports.useMemo(()=>He.every(Qe=>Qe==null)?null:Qe=>{He.forEach(it=>{setRef(it,Qe)})},He)}const PromptsCompletionTextarea=reactExports.forwardRef(function He(Qe,it){const{enable:lt,setDataRef:ut,textareaRef:dt,completionRef:xt}=reactExports.useContext(PromptsCompletionContext),ft=useForkRef(it,dt),vt=reactExports.useCallback(Tt=>{if(!lt||!dt.current||"key"in Tt&&Tt.key==="Escape")return;const{value:Mt,selectionStart:Nt,selectionEnd:At}=dt.current,$t=getCaretCoordinates(dt.current,Nt),Dt=dt.current.getBoundingClientRect(),Ft={prompts:Mt,selectionStart:Nt,selectionEnd:At,x:$t.left+Dt.x,y:$t.top+$t.height+Dt.y};ut.current?.(Ft)},[ut,lt,dt]),kt=reactExports.useCallback(Tt=>{xt.current?.onInputBlur(Tt)},[xt]),St=reactExports.useCallback(Tt=>{xt.current?.isOpen()&&((Tt.key==="Tab"||Tt.key==="Enter")&&(Tt.preventDefault(),xt.current.confirm()),(Tt.key==="ArrowUp"||Tt.key==="ArrowDown")&&(Tt.preventDefault(),xt.current.shift(Tt.key==="ArrowUp"?-1:1))),Tt.key==="Escape"&&ut.current?.(void 0)},[ut,xt]);return jsxRuntimeExports.jsx("textarea",{...Qe,ref:ft,onKeyDown:(...Tt)=>{St(...Tt),Qe.onKeyDown?.(...Tt)},onInput:(...Tt)=>{vt(...Tt),Qe.onInput?.(...Tt)},onKeyUp:(...Tt)=>{vt(...Tt),Qe.onKeyUp?.(...Tt)},onMouseUp:(...Tt)=>{vt(...Tt),Qe.onMouseUp?.(...Tt)},onFocus:(...Tt)=>{vt(...Tt),Qe.onFocus?.(...Tt)},onBlur:(...Tt)=>{kt(...Tt),Qe.onBlur?.(...Tt)}})});function PromptsInputArea(He){return jsxRuntimeExports.jsx(PromptsEditor,{...He,showPriorityCheckbox:!0,footerSlot:jsxRuntimeExports.jsx(BoosterBarForPromptsFooter,{})})}function useTextareaHeightAdaptive(He){const Qe=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{const it=Qe.current;it&&(it.style.height="auto",it.style.height=it.scrollHeight+"px")},[He]),Qe}function useTrackEnableAutoComplete(He){reactExports.useEffect(()=>{trackerSetUserProperties({auto_complete_checked:He??"null"})},[He])}function PromptsEditor(He){const{style:Qe,className:it,showPriorityCheckbox:lt,footerSlot:ut}=He,[dt]=usePromptHelperMode(),{values:{prompts:xt},handleChange:ft}=useTaskSubmitFormContext(),vt=reactExports.useRef({onClickSubmit:()=>{}}),kt=useBreakpoint("mlg"),{t:St}=useTranslation(["generation"]),Tt=useTextareaHeightAdaptive(xt),[Mt,Nt]=useTagComplete();useTrackEnableAutoComplete(Mt);const At=$t=>{$t.which===13&&(isMac()?$t.metaKey:$t.ctrlKey)&&($t.preventDefault(),vt.current.onClickSubmit?.())};return jsxRuntimeExports.jsx(PromptsCompletionProvider,{enable:Mt&&!kt,setEnable:Nt,children:jsxRuntimeExports.jsxs("div",{className:cx("relative flex flex-col @container",it),style:Qe,children:[jsxRuntimeExports.jsx(GeneratorTabs,{className:"@4xl:hidden flex flex-wrap mx-3"}),jsxRuntimeExports.jsxs("div",{className:"px-4 py-1 flex gap-4 items-center",children:[jsxRuntimeExports.jsx(GeneratorTabs,{className:"@4xl:flex hidden flex-auto"}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),jsxRuntimeExports.jsx(PromptsRewriteControl,{className:"py-[6px] mlg:py-2"}),!kt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(PromptsCompletionButton,{className:"py-1"}),jsxRuntimeExports.jsx(PromptsCompletionDisplay,{})]}),dt!==!0&&jsxRuntimeExports.jsx(ImageCaptioningButton,{})]}),jsxRuntimeExports.jsx(EmailVerifyBanner,{className:"max-mlg:hidden"}),jsxRuntimeExports.jsx("section",{className:cx("z-10 px-4 py-3 pb-2 bg-neutral-100 dark:bg-neutral-700 rounded-xl mx-4 flex flex-col"),children:jsxRuntimeExports.jsx(PromptsCompletionTextarea,{ref:Tt,className:"w-full min-h-[3em] max-h-[9em] dense:max-h-[5em] bg-transparent outline-none resize-none",placeholder:St(dt?"generation:prompts.prompt-helper-placeholder":"generation:prompts.prompts-placeholder"),value:xt||"",onChange:ft("prompts"),onKeyDown:At})}),jsxRuntimeExports.jsxs("div",{className:cx("flex items-center z-10","px-4 py-2 dense:px-3 dense:py-1"),onClick:$t=>{$t.target===$t.currentTarget&&Tt.current?.focus()},children:[ut,jsxRuntimeExports.jsx("span",{className:"ml-auto"}),jsxRuntimeExports.jsx(CharacterBadge,{}),jsxRuntimeExports.jsx(GenerateButton,{showPriorityCheckbox:lt,handleSubmitFromQs:!0,className:"flex-none max-mlg:w-full max-mlg:hidden space-y-2",ref:vt})]})]})})}const openPromptsHelperEnabledHintDialog=He=>{if(!hasPromptHelperEnabledHintShownToday())return resetPromptHelperLastShownTime(),UIDialog.alert({dismissable:!0,heading:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:prompt-helper.force-enable-dialog.heading"}),content:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:prompt-helper.force-enable-dialog.content",context:He})})};function PromptsRewriteControl(He){const[Qe]=reactExports.useContext(InitialValueLoadedContext),[it]=reactExports.useContext(LastImportedItemContext),{handleChange:lt}=useTaskSubmitFormContext(),ut=reactExports.useMemo(()=>lt("enablePromptsRewrite"),[lt]),[dt]=usePromptHelperMode();return reactExports.useEffect(()=>{Qe&&ut(dt)},[dt,ut,Qe,it]),jsxRuntimeExports.jsx("div",{className:cx("ml-auto",He.className),children:jsxRuntimeExports.jsxs($4e3b923658d69c60$export$8c610744efcf8a1d,{delay:0,children:[jsxRuntimeExports.jsx(PromptsRewriteSwitch,{}),jsxRuntimeExports.jsx(UITooltip,{children:jsxRuntimeExports.jsx("p",{className:"p-4 text-sm max-w-[24rem]",children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:prompt-helper.help.description"})})})]})})}function CharacterBadge(){const[He,Qe]=useSelectedCharacter(),{data:it}=useCharacter(He??void 0);return!He||!it?null:jsxRuntimeExports.jsxs("div",{className:"h-6 py-1 px-2 rounded-xl text-sm font-medium mr-3 group border border-gray-200 dark:border-gray-600 hover:border-purple-700 hover:dark:border-purple-600 flex gap-1 items-center bg-background transition-all duration-150",children:[jsxRuntimeExports.jsxs("span",{className:"h-4 w-4 rounded-full overflow-hidden",children:[jsxRuntimeExports.jsx("span",{className:"inline-block group-hover:hidden w-full h-full",children:jsxRuntimeExports.jsx("img",{src:getThumbnailUrl(it?.media)})}),jsxRuntimeExports.jsx("span",{className:"bg-gray-400 hidden group-hover:inline-block text-white w-full h-full cursor-pointer",onClick:()=>{track("rm_chter_click",{chterId:He}),Qe(void 0)},children:jsxRuntimeExports.jsx(icBaselineClose,{className:"h-3 w-3 ml-[2px] mt-[2px]"})})]}),it?.name]})}function useCurrentSelectModelId(){const{values:He}=useTaskSubmitFormContext(),Qe=useSyncCurrentSelectedModelId(),it=He.modelId,lt=useModelVersion(it);return reactExports.useEffect(()=>{Qe(lt?.modelId)},[lt?.modelId]),lt?.modelId}function getAllowPromptHelperSwitchForTsubakiValue(){return(getPreferenceFromLocalStorage(TSUBAKI_PROMPT_HELPER)??TSUBAKI_PROMPT_HELPER_VALUE.autoEnable)===TSUBAKI_PROMPT_HELPER_VALUE.followUser}function PromptsRewriteSwitch(){const[He,Qe]=usePromptHelperMode(),it=()=>Qe(),lt=useCurrentSelectModelId(),[ut,dt]=reactExports.useState(getAllowPromptHelperSwitchForTsubakiValue);useTsubakiPromptHelperPref();const xt=reactExports.useCallback(()=>{dt(getAllowPromptHelperSwitchForTsubakiValue()),it()},[ut]);useWindowEvent("storage",xt);const ft=reactExports.useMemo(()=>isInHouseDitModel(lt)&&!ut,[lt,ut]);function vt(Mt){track("magic_switch",{checked:Mt}),Qe(Mt)}const kt=reactExports.useRef(null),{focusableProps:St}=$f645667febf57a63$export$4c014de7c8940b4c({},kt),Tt=reactExports.useCallback(async()=>{!ft||!await UIDialog.confirm({heading:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:prompt-helper.tsubaki-alert.title"}),content:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:prompt-helper.tsubaki-alert.content",components:[jsxRuntimeExports.jsx("br",{})]})})||window.open("/profile/edit/safety","_blank")},[ft]);return jsxRuntimeExports.jsx($8e59e948500a8fe1$export$b5d5cf8927ab7262,{ref:kt,isSelected:!!He,isDisabled:ft,onChange:vt,className:Mt=>switchRootStyles({...Mt,labelPlacement:"start",className:"items-center"}),children:Mt=>jsxRuntimeExports.jsxs("div",{...St,onClick:Tt,className:"contents",children:[jsxRuntimeExports.jsx("div",{className:switchTrackStyles({...Mt,size:"xsmall"}),children:jsxRuntimeExports.jsx("div",{className:switchHandleStyles({...Mt,size:"xsmall"})})}),jsxRuntimeExports.jsx("span",{className:"font-medium text-xs",children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:prompt-helper.label"})})]})})}function mergePromptHelperParamsToParameter(He,Qe){const it={...He};return He?.promptHelper?it.promptHelper={...He.promptHelper,userWantToEnable:Qe.userWantToEnable,enable:Qe.enable}:it.promptHelper={withStage:Qe.enable,userWantToEnable:Qe.userWantToEnable,enable:Qe.enable},it}async function checkAndMergePromptHelperParams(He,Qe){try{const{detectNeedToEnablePromptHelper:it}=await client.detectNeedToEnablePromptHelper({parameters:mergePromptHelperParamsToParameter(He,{userWantToEnable:Qe})});if(!it)return mergePromptHelperParamsToParameter(He,{userWantToEnable:Qe,enable:!0});const{needToEnable:lt,enableReasonCode:ut}=it;return lt&&$$3(ut).with("contains-non-english","prompts-too-short",()=>{openPromptsHelperEnabledHintDialog(ut)}),mergePromptHelperParamsToParameter(He,{userWantToEnable:Qe,enable:lt})}catch(it){return console.error(it),mergePromptHelperParamsToParameter(He,{userWantToEnable:Qe,enable:!0})}}const i2iFieldsToCheck=["strength","mediaId"],optionalI2iFieldsToCheck=["enlargeModel"],commonFieldsToCheck=["prompts","negativePrompts","samplingSteps","samplingMethod","cfgScale","modelId","width","height","enableTile"],optionalNumericFields=["upscale","batchSize","enlarge","upscaleDenoisingSteps","upscaleDenoisingStrength"];function areSeedsIdentical(He,Qe){return!He||!Qe?!1:He.toString()===Qe.toString()}function areOptionalNumParamsIdentical(He,Qe){const it=lt=>lt??1;return optionalNumericFields.map(lt=>{const ut=it(He?.[lt]),dt=it(Qe?.[lt]);return ut===dt}).every(Boolean)}function areOptionalI2iFieldsIdentical(He,Qe){const it=lt=>lt??"";return optionalI2iFieldsToCheck.map(lt=>{const ut=it(He?.[lt]),dt=it(Qe?.[lt]);return ut===dt}).every(Boolean)}function areTaskParamsIdentical(He,Qe){const it=He?.parameters;return!it||!Qe?!1:areSeedsIdentical(it.seed,Qe.seed)?!(it.mediaId!=null&&(!i2iFieldsToCheck.every(ft=>{if(ft in it&&ft in Qe)return it[ft]===Qe[ft]})||!areOptionalI2iFieldsIdentical(it,Qe))||!commonFieldsToCheck.every(dt=>{if(dt in it&&dt in Qe)return it[dt]===Qe[dt]})||!areOptionalNumParamsIdentical(it,Qe)):!1}const resolveGetter=He=>typeof He=="function"?He():He,useThrottledCallbackWithReturnValue=(...He)=>{const[Qe,it]=He,lt=reactExports.useCallback((xt,...ft)=>{xt(Qe(...ft))},[Qe]),ut=useThrottledCallback(lt,it);return reactExports.useCallback((...xt)=>{let ft;return ut(vt=>{ft=vt},...xt),ft},[ut])};function checkAgeRestriction(){return new Promise((He,Qe)=>{const it=dialog({children:jsxRuntimeExports.jsx(AdultRestrictionWarnDialogContent,{onClose:()=>{it.current?.close()},onRestrictionLifted:()=>{it.current?.close(),He(!0)},onRestrictionKept:()=>{it.current?.close(),He(!1)}}),onClose:()=>He(null),fullWidth:!1,responsive:!1,dialogProps:{maxWidth:"lg"}})})}function AdultRestrictionWarnDialogContent(He){const{t:Qe}=useTranslation(["generation","action"]),[,it,lt]=useAgeVerificationStatus();return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:Qe("generation:submit.age-verification-dialog.title")}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsx(DialogContentText,{className:"sm:min-w-80",children:Qe("generation:submit.age-verification-dialog.description")})}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",onPress:async()=>{track("age_restriction_cancel_click"),He.onClose?.()},children:Qe("action:cancel")}),jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",onPress:async()=>{track("under_18_click"),await it(AgeVerificationStatus.Minor),He.onRestrictionKept?.()},busy:lt,children:Qe("generation:submit.age-verification-dialog.under-18-label")}),jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",onPress:async()=>{track("over_18_click"),await it(AgeVerificationStatus.Over18),He.onRestrictionLifted?.()},busy:lt,children:Qe("generation:submit.age-verification-dialog.over-18-label")})]})]})}const VALIDATING=Symbol("Validating");function validateTaskParams(He,Qe){const it={};function lt(ft,vt){typeof vt=="symbol"?it[ft]=vt:typeof it[ft]!="symbol"&&(it[ft]??=[],it[ft].push(vt))}function ut(){return{...it,ok:Object.keys(it).length===0}}if(He.modelId&&!Qe.modelType)return lt("modelId",VALIDATING),ut();const dt=isSDV1Model(Qe.modelType),xt=Object.keys(He.lora??{});return!Qe.modelType||xt.some(ft=>!Qe.loraTypes?.[ft])?lt("lora",VALIDATING):xt.length>0&&(hasModelDisabledLora(Qe.versionExtra)?lt("lora","The chosen model does not support Lora"):Object.values(Qe.loraTypes).every(ft=>isLoraCompatWithModel(Qe.modelType,ft))||lt("lora","Some chosen loras are not compatible with the model")),!dt&&He.latentCouple&&lt("latentCouple","Non-SDv1 model does not support composition"),!dt&&He.enableTile&&lt("enableTile","Non-SDv1 model does not support ultimate upscale"),(He.controlNets??[]).length>0&&(hasModelDisabledCnet(Qe.versionExtra)||!isCnetsCompatWithModelType(He.controlNets,Qe.modelType))&&lt("controlNets","The chosen model does not support ControlNet"),He.ipAdapter?.enabled&&(He.ipAdapter?.imagesAreValid?(He.controlNets??[]).length>0&&!isCnetsCompatWithIPAdapter(He.controlNets)?lt("controlNets","The chosen ControlNet does not support Character"):isModelCompatibleWithIPAdapter(Qe.modelType)||lt("ipAdapter","The chosen model does not support Character"):lt("ipAdapter","Not all images are valid")),ut()}function useValidateTaskParams(He){const Qe=useModelVersion(He.modelId),it=reactExports.useMemo(()=>Object.keys(He.lora??{}),[He.lora]),lt=useModelVersion(it);return reactExports.useMemo(()=>validateTaskParams(He,{modelType:Qe?.modelType,loraTypes:mapValues$1(lt,ut=>getLoraTypeFromModelVersion(ut)),versionExtra:Qe?.extra}),[He,Qe,lt])}function SensitiveFeedbackDialogContent(He){const[Qe,it]=reactExports.useState(),{beingMember:lt}=useMe(),{t:ut}=useTranslation(["generation","action"]),dt=kebabCase(He.moderationAction),xt=reactExports.useCallback(ft=>{ft.preventDefault(),track("nsfw_prompts_feedback",{...He.trackingParams,isMember:lt,promptsModerationAction:He.moderationAction,...$$3(Qe).with("non-explicit",()=>({explicit:!1,underage:!0})).with("non-underage",()=>({explicit:!0,underage:!1})).with("neither",()=>({explicit:!1,underage:!1})).otherwise(()=>({}))},{destinations:["getway"]}),He.onClose()},[lt,Qe,He.moderationAction,He.trackingParams]);return jsxRuntimeExports.jsxs("form",{onSubmit:xt,children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-semibold",children:ut(`generation:submit.notice.prompts-filter.${dt}.title`)}),jsxRuntimeExports.jsx("p",{className:"text-sm mt-2",children:ut(`generation:submit.notice.prompts-filter.${dt}.description`)}),jsxRuntimeExports.jsxs("details",{className:"pl-2 pt-4 text-sm",children:[jsxRuntimeExports.jsx("summary",{children:ut("generation:submit.notice.prompts-filter.options.summary")}),jsxRuntimeExports.jsxs(RadioGroup,{name:"explicit-radio-group",value:Qe,onChange:ft=>it(ft.target.value),className:"gap-2 mt-1 pl-1",children:[jsxRuntimeExports.jsx(FormControlLabel,{disableTypography:!0,value:"non-explicit",control:jsxRuntimeExports.jsx(Radio,{size:"small",className:"text-neutral-600"}),label:jsxRuntimeExports.jsx("span",{className:"text-sm",children:ut("generation:submit.notice.prompts-filter.options.non-explicit")})}),jsxRuntimeExports.jsx(FormControlLabel,{disableTypography:!0,value:"non-underage",control:jsxRuntimeExports.jsx(Radio,{size:"small",className:"text-neutral-600"}),label:jsxRuntimeExports.jsx("span",{className:"text-sm",children:ut("generation:submit.notice.prompts-filter.options.non-underage")})}),jsxRuntimeExports.jsx(FormControlLabel,{disableTypography:!0,value:"neither",control:jsxRuntimeExports.jsx(Radio,{size:"small",className:"text-neutral-600"}),label:jsxRuntimeExports.jsx("span",{className:"text-sm",children:ut("generation:submit.notice.prompts-filter.options.neither")})})]})]}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{className:"text-black",onClick:He.onClose,children:ut("action:cancel")}),jsxRuntimeExports.jsx(Button,{className:"bg-black text-white disabled:bg-neutral-400",disabled:Qe==null,variant:"contained",type:"submit",children:ut("action:confirm")})]})]})}function openSensitiveFeedbackToast(He,Qe){const it=toast(jsxRuntimeExports.jsx(SensitiveFeedbackDialogContent,{moderationAction:He,trackingParams:Qe,onClose:()=>{toast.dismiss(it)}}),{autoClose:!1,closeOnClick:!1,className:"!cursor-default"})}const TaskSubmitFormContext=reactExports.createContext({loading:!1,submit:()=>{},values:{},handleChange:createHandleChange(),getValues:()=>{},setValues:()=>{},initialValues:{},setInitialValues:()=>{},reset:()=>{},validation:{ok:!0}});TaskSubmitFormContext.displayName="TaskSubmitFormContext";const useTaskSubmitFormContext=()=>reactExports.useContext(TaskSubmitFormContext),BaseTaskSubmitForm=({onSuccess:He=()=>{},children:Qe})=>{const{t:it}=useTranslation(["generation"]),lt=useForm$1({}),{values:ut,getValues:dt,setValues:xt}=lt,[ft,vt]=reactExports.useState(genId());reactExports.useEffect(()=>{vt(genId())},[ut.baseImageTaskId]),reactExports.useEffect(()=>{(!ut.prompts||ut.prompts.trim().length<=1)&&vt(genId())},[ut]);const{data:kt}=useUserInfo(),{refetch:St}=useMyQuota(),[Tt,Mt]=usePromptHelperMode(),[Nt]=useDisableAutoPromptHelperPref(),[At,$t]=useLoadingCallback(async(Xt,Kt=()=>{},Jt)=>{const hr=await dt();if(!hr){console.log("empty values");return}console.log(hr);const xr=await resolveGetter(Xt),gr={...hr,...xr,extra:{...hr?.extra,...xr?.extra}};if(!isValuesCnetGenerativeFill(gr)&&!gr.prompts)return toast.warn(it("generation:submit.notice.prompts-cannot-be-empty"));if(isValuesControlNet(gr)&&isValuesLatentCouple(gr))return UIDialog.alert({heading:it("generation:submit.notice.latent-with-cn-warn.title"),content:it("generation:submit.notice.latent-with-cn-warn.description"),dismissable:!1});try{const[br,vr]=gr.baseImage||gr.inpaintMaskImage?await toast.promise(Promise.all(["baseImage","inpaintMaskImage"].map($r=>gr[$r]?.toMedia({onCompressed(Zr){xt(Sr=>({...Sr,[$r]:Zr}))}}))),{pending:`${it("generation:submit.notice.uploading-image")}`}):[],yr=getModelVersion(gr.modelId);let Cr;gr.enablePromptsRewrite&&(Cr=gr.prompts);let Rr=getCreateTaskParameters(gr,{baseImageMedia:br,maskImageMedia:vr,naturalPrompts:Cr,modelVersion:yr});Rr=await checkAndMergePromptHelperParams(Rr,Tt),Rr?.promptHelper?.enable&&(gr.enablePromptsRewrite=!0,Mt(!0));let Ir=!1;try{const $r=await fetchListMyTasks({last:1,parameterFields:taskParameterFieldsForTaskList}),Zr=getNodesFromConnection($r.data?.me?.tasks)[0];if(Ir=Zr!=null,areTaskParamsIdentical(Zr,Rr))return toast.error(it("generation:submit.notice.identical-params"))}catch{}let Tr;if(Jt?.hideSubmissionToast?Tr=(await executeCreateGenerationTask({parameters:Rr})).data??null:Tr=(await toast.promise(executeCreateGenerationTask({parameters:Rr}),{pending:`${it("generation:submit.notice.task-submitting")}`,success:`${it("generation:submit.notice.task-submitted")}`})).data??null,Tr==null)throw new Error("Task creation failed");track("generate_task_submit",getCreateTaskTrackAttrs({taskId:Tr?.createGenerationTask?.id,activityId:ft,...gr})),handlePromptsFilterResultInTaskResponse(Tr),Kt(Tr,{isFirstTime:!Ir}),He(),St()}catch(br){if(Jt?.throwError)throw br;matchTaskSubmitFormError(it,br,{submit:$t,taskParameters:gr})}finally{updateEventGroup("generate_task_id",UpdateEventGroupAction.Increment)}},[kt,ft,Nt,Tt]),[Dt,Ft]=reactExports.useState({}),Bt=reactExports.useCallback(()=>{xt(Dt)},[Dt,xt]),Ot=useValidateTaskParams(ut),Qt=useThrottledCallbackWithReturnValue($t,2e3),Wt=reactExports.useMemo(()=>({loading:At,submit:Qt,...lt,initialValues:Dt,setInitialValues:Ft,reset:Bt,validation:Ot}),[At,Qt,lt,Dt,Bt,Ot]);return jsxRuntimeExports.jsx(TaskSubmitFormContext.Provider,{value:Wt,children:Qe})};function matchTaskSubmitFormError(He,Qe,it){const lt=getErrorCode(Qe);return $$3(lt).with("INSUFFICIENT_BALANCE",()=>{openMembershipMoreCreditsModal({trackingLocation:"insufficient-credit-task-gen",scene:"insufficient-credit-task-gen",reason:He("generation:submit.user-insufficient-credit-dialog.description")})}).with("WAITING_NUM_EXCEEDED",async()=>{await dialogConfirm({title:He("generation:submit.waiting-num-exceeded-dialog.title"),description:He("generation:submit.waiting-num-exceeded-dialog.desc"),confirmLabel:"OK",noCancel:!0})}).with("NSFW_PROMPTS_DETECTED",()=>{const ut=extractPromptsModerationActionFromNsfwError(Qe),dt=Math.random()>.75;$$3([ut,dt]).with([N$4.union(PromptsModerationActions.REJECT_FEEDBACK,PromptsModerationActions.WARN_FEEDBACK),!0],([xt])=>openSensitiveFeedbackToast(xt,{modelId:it?.taskParameters?.modelId,prompts:it?.taskParameters?.prompts})).with([PromptsModerationActions.REJECT_SET_NSFW_GUIDANCE,N$4.any],()=>{toast.warn(He("generation:submit.notice.set-nsfw-guidance"))}).otherwise(()=>{toast.warn(He("generation:submit.notice.nsfw-prompts-detected"))})}).with("NSFW_PROMPTS_DETECTED_ADULT_NOT_SET",async()=>{if(track("age_restriction_dialog_show"),await checkAgeRestriction())return it?.submit?.()}).otherwise(()=>{toast.error(`${He("common:error.fail-to-submit")} ${Qe?.message}`)})}function handlePromptsFilterResultInTaskResponse(He){if(!He.createGenerationTask)return;const{moderationAction:{promptsModerationAction:Qe}={}}=He.createGenerationTask;typeof Qe=="string"&&Qe!==PromptsModerationActions.PASS&&openSensitiveFeedbackToast(Qe,{taskId:He.createGenerationTask.id,modelId:He.createGenerationTask.parameters.modelId,prompts:He.createGenerationTask.parameters.prompts})}function GeneratedTaskCaptioningDialog(){const[He,Qe]=reactExports.useContext(SelectedTaskContext),{setValues:it}=useTaskSubmitFormContext(),{data:lt}=useTaskById(He.taskId??skipToken),ut=()=>{Qe({openCaptioningDialog:!1})},[dt,xt]=reactExports.useMemo(()=>He.mediaIdx!==void 0?[lt?.outputs?.batch?.[He.mediaIdx]?.mediaId]:[lt?.mediaId,lt?.media],[lt,He]);return He?.openCaptioningDialog&&(!lt||!dt)?jsxRuntimeExports.jsx(Preloader,{}):jsxRuntimeExports.jsx(CaptioningDialog,{open:!!He?.openCaptioningDialog,onClose:()=>{ut()},children:!!He?.openCaptioningDialog&&jsxRuntimeExports.jsx(ImageCaptioningForm,{type:"base-image",media:xt,mediaId:dt,onConfirmPrompt:ft=>{it(vt=>({...vt,prompts:ft?.prompt})),ut()}})})}const icBaselineCallSplit=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m14 4l2.29 2.29l-2.88 2.88l1.42 1.42l2.88-2.88L20 10V4zm-4 0H4v6l2.29-2.29l4.71 4.7V20h2v-8.41l-5.29-5.3z"})}),icBaselineDeleteOutline=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4z"})}),icBaselineDownload=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7l7-7z"})}),EmbeddedRoutes={chatEditing:()=>({web:"/generator/chat-editing",embedded:"/chat-editing"}),chatEditingWorkspaceCreator:He=>He?{web:`/generator/chat-editing/creator?mediaId=${He}`,embedded:`/chat-editing/creator?mediaId=${He}`}:{web:"/generator/chat-editing/creator",embedded:"/chat-editing/creator"},chatEditingWorkspace:He=>({web:`/generator/chat-editing/workspace/${He}`,embedded:`/chat-editing/workspace/${He}`})};var ConversationType=(He=>(He.StartPoint="start-point",He.Chat="chat",He.Enhance="enhance",He.Upscale="upscale",He))(ConversationType||{});const conversationalStateStore=createStore$1(),conversationUIStatusAtom=atom({panel:"free-edit",selectedItemId:"0",isBusy:!1,isDisabled:!1,isLoading:!0}),conversationWorkspaceAtom=atom({workspace:void 0,history:[],reactions:[]}),presetToolSelectionAtom=atom({group:"image-enhancement",id:"handfix",extra:{}}),useConversationalEditUIState=()=>useImmerAtom(conversationUIStatusAtom,{store:conversationalStateStore}),useConversationalEditWorkspaceState=()=>useImmerAtom(conversationWorkspaceAtom,{store:conversationalStateStore}),usePresetToolSelectionState=()=>useImmerAtom(presetToolSelectionAtom,{store:conversationalStateStore}),parseEnhancementDefaultArgs=He=>{const Qe={};if(He.args)for(const[it,lt]of Object.entries(He.args))lt.value&&(Qe[it]=lt.value);return Qe},extractEnhancementPlugin=(He,Qe)=>{const it=He?.workflowName??"";if(it)return Qe.find(ut=>it.startsWith(ut.workflowName))},createConversationHistory=He=>{if(He.parameters?.chat)return{id:He.id,prompt:He.parameters?.prompts??He.parameters?.chat?.prompt??"",status:He.status?He.status:TaskStatus.running,type:ConversationType.Chat,referenceImageId:He.parameters?.mediaId,outputImageId:He.outputs?.mediaId,creditCost:He.paidCredit,rawTask:He};if(He.parameters?.model==="pixai-panelplugin")return{id:He.id,prompt:"",status:He.status?He.status:TaskStatus.running,type:ConversationType.Enhance,referenceImageId:He.parameters?.inputs?.image?.media_id,outputImageId:He.outputs?.mediaId,creditCost:He.paidCredit,rawTask:He};if(He.parameters?.enlarge||He.parameters?.upscale)return{id:He.id,prompt:"",status:He.status?He.status:TaskStatus.running,type:ConversationType.Upscale,referenceImageId:He.parameters?.mediaId,outputImageId:He.outputs?.mediaId,creditCost:He.paidCredit,rawTask:He}};let cachedHistoryFingerprint="",cachedTasksByOutputImage={},cachedTasksByReferenceImage={};const calculateTaskChain=(He,Qe)=>{if(He.id==="0")return Qe.map(vt=>vt.id);if(Qe.length===0)return[];if(Qe.length===1)return[Qe[0].id];const it=Qe[Qe.length-1].id,lt=Qe[Qe.length-1].outputImageId,ut=`${Qe[0].id}-${it}-${lt}`;cachedHistoryFingerprint!==ut&&(cachedTasksByOutputImage={},cachedTasksByReferenceImage={},Qe.forEach(vt=>{vt.outputImageId&&(cachedTasksByOutputImage[vt.outputImageId]=vt),vt.referenceImageId&&(cachedTasksByReferenceImage[vt.referenceImageId]||(cachedTasksByReferenceImage[vt.referenceImageId]=[]),cachedTasksByReferenceImage[vt.referenceImageId].push(vt))}),cachedHistoryFingerprint=ut);const dt=[He];let xt=He;for(;xt.referenceImageId&&cachedTasksByOutputImage[xt.referenceImageId];)xt=cachedTasksByOutputImage[xt.referenceImageId],dt.unshift(xt);let ft=He;for(;ft.outputImageId&&cachedTasksByReferenceImage[ft.outputImageId]?.length;)ft=cachedTasksByReferenceImage[ft.outputImageId][0],dt.push(ft);return dt.map(vt=>vt.id)},createWorkspace=async(He,Qe)=>(track("chat_workspace_create_click"),(await client.createChatWorkspace({title:Qe?.trim().length===0?void 0:Qe,initialImage:He})).createChatWorkspace?.id),StartChatEditingButton=({variant:He="filled",color:Qe="theme",className:it="gap-0.5",...lt})=>jsxRuntimeExports.jsx(ChatWorkspaceCreatorButton,{location:"start-button",variant:He,color:Qe,className:it,icon:jsxRuntimeExports.jsx(fluentChat24Filled,{className:"size-4"}),...lt,children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:chat-editing.workspace.creator.buttons.create"})}),StartChatEditingButtonLarger=({variant:He="filled",color:Qe="theme",className:it="gap-0.5",...lt})=>jsxRuntimeExports.jsx(ChatWorkspaceCreatorButton,{location:"start-button",variant:He,color:Qe,className:it,icon:jsxRuntimeExports.jsx(fluentChat24Filled,{className:"size-5"}),...lt,children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:chat-editing.workspace.creator.buttons.create-larger"})}),ChatWorkspaceCreatorButton=({initialImageId:He,children:Qe,location:it,...lt})=>jsxRuntimeExports.jsx(ChatWorkspaceCreatorActionWrapper,{initialImageId:He,location:it,redirectToCreator:!0,component:({handleClick:ut,isLoading:dt,isHandlingClick:xt})=>jsxRuntimeExports.jsx(UIButton$1,{busy:xt,onPress:ut,disabled:dt,...lt,children:Qe})}),ChatWorkspaceCreatorTool=({initialImageId:He,children:Qe,location:it,tooltipProps:lt,...ut})=>jsxRuntimeExports.jsx(ChatWorkspaceCreatorActionWrapper,{initialImageId:He,location:it,redirectToCreator:!1,redirectNewPage:!0,component:({handleClick:dt,isLoading:xt,isHandlingClick:ft})=>jsxRuntimeExports.jsx(Tooltip,{...lt,children:jsxRuntimeExports.jsx(Button,{disabled:xt,loading:ft,onClick:dt,...ut,children:Qe})})}),ChatWorkspaceCreatorActionWrapper=({initialImageId:He,location:Qe,redirectToCreator:it,redirectNewPage:lt,component:ut})=>{const{data:dt,loading:xt}=useGetMedia(He??skipToken),{data:ft,loading:vt}=useMyMembership(),{data:kt,loading:St}=useUserInfo(),Tt=reactExports.useMemo(()=>userHasMembership(ft),[ft]),Mt=reactExports.useMemo(()=>xt||vt||St,[xt,vt,St]),Nt=useEmbeddedNavigate(),[At,$t]=useLoadingCallback(async()=>{if(track("chat_editing_click",{location:Qe}),!kt){openSignModal();return}if(!Tt){openMembershipRequiredDialog("chat-editing");return}if(it){Nt(EmbeddedRoutes.chatEditingWorkspaceCreator(dt?.id),{newPage:lt});return}if(track("new_workspace_click"),dt?.id){const Dt=await createWorkspace(dt.id,void 0);Dt?Nt(EmbeddedRoutes.chatEditingWorkspace(Dt),{newPage:lt}):console.error("Failed to create chat workspace")}},[Tt,kt,Qe,it,dt]);return ut({handleClick:$t,isLoading:Mt,isHandlingClick:At})};async function deleteTask(He,Qe){const it=await resolveTask(He);if(!it)return toast.error(reactExports.createElement(Text,{i18nKey:"artwork:delete-task.notice.resolve-task-failed"})),!1;const lt=taskHasFavImages(it);if(Qe?.skipConfirm||await dialogConfirm(defaults$2(Qe?.dialogProps,{title:reactExports.createElement(Text,{i18nKey:"artwork:delete-task.confirm-dialog.title"}),description:reactExports.createElement(reactExports.Fragment,null,[reactExports.createElement("p",null,reactExports.createElement(Text,{i18nKey:"artwork:delete-task.confirm-dialog.description.content"})),lt?reactExports.createElement("p",{className:"text-red-600 dark:text-red-500"},reactExports.createElement(Text,{i18nKey:"artwork:delete-task.confirm-dialog.description.fav-del-reminder"})):null])})).then(()=>!0,()=>!1)){try{return await executeDeleteGenerationTask({taskId:it.id}),toast.success(reactExports.createElement(Text,{i18nKey:"artwork:delete-task.notice.success"})),!0}catch(dt){toast.error(reactExports.createElement("p",null,[reactExports.createElement(Text,{i18nKey:"artwork:delete-task.notice.fail"}),` (${String(dt)})`]))}return!1}}async function deleteTaskMedia(He,Qe,it){const lt=await resolveTask(He);if(!lt)return toast.error(reactExports.createElement(Text,{i18nKey:"artwork:delete-task.notice.resolve-task-failed"})),!1;const ut=a$3(N$4.union({outputs:{batch:N$4.intersection(N$4.array(N$4.union({mediaId:Qe},{deletedAt:N$4.nonNullable})),N$4.when(ft=>ft.some(vt=>vt.mediaId===Qe)))}},{outputs:N$4.optional({batch:N$4.optional(N$4.nullish)}),media:{id:Qe}}),lt),dt=typeof it=="function"?it(ut):it;if(ut)return deleteTask(lt,dt||void 0);if(dt?.skipConfirm||await dialogConfirm(defaults$2(dt?.dialogProps,{title:reactExports.createElement(Text,{i18nKey:"artwork:delete-media.confirm-dialog.title"}),description:reactExports.createElement(Text,{i18nKey:"artwork:delete-media.confirm-dialog.description.content"})})).then(()=>!0,()=>!1))try{return await executeUpdateGenerationTask({id:lt.id,input:{deleteBatchMedia:{mediaId:Qe}}}),toast.success(reactExports.createElement(Text,{i18nKey:"artwork:delete-media.notice.success"})),!0}catch(ft){return toast.error(reactExports.createElement("p",null,[reactExports.createElement(Text,{i18nKey:"artwork:delete-media.notice.fail"},[` (${String(ft)})`])])),!1}}async function resolveTask(He){return typeof He=="string"?(await fetchGetTaskById({id:He})).data.task:He}const CancelTaskButton=({task:He,className:Qe})=>{const{t:it}=useTranslation(["artwork"]);return jsxRuntimeExports.jsx(UIButton$1,{className:Qe,variant:"filled",onPress:async()=>{if(He)try{await dialogConfirm({title:"Cancel this generation?",description:"Used credits won't be refunded.",cancelLabel:"No",confirmLabel:"Yes"}),await executeCancelGenerationTask({taskId:He.id}),toast.info("Task cancelled")}catch(lt){if(lt===UserCancelled)return;toast.error(lt?.message)}},children:it("artwork:cancel-generation")})},DeleteTaskButton=reactExports.forwardRef(function He({task:Qe,onBeforeClick:it,onSuccess:lt=()=>{},children:ut,...dt},xt){const[{loading:ft},vt]=useAsyncFn(async()=>{await deleteTask(Qe)&&lt()},[Qe]);return jsxRuntimeExports.jsx(UIButton$1,{onPress:()=>{it?.(),vt()},busy:ft,ref:xt,...dt,children:ut})}),DeleteTaskMediaBtn=reactExports.forwardRef(function He({task:Qe,onMediaDelete:it,onTaskDelete:lt,onCancel:ut,mediaId:dt,children:xt,...ft},vt){const{t:kt}=useTranslation(["artwork"]),[{loading:St},Tt]=useAsyncFn(async()=>{let Mt=!dt;const Nt=Mt?await deleteTask(Qe):await deleteTaskMedia(Qe,dt,At=>{Mt=At});Nt?Mt?lt?.():it?.(dt):Nt==null&&ut?.()},[Qe,dt]);return jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",onPress:Tt,busy:St,ref:vt,...ft,children:xt||kt("artwork:delete-media.label")})}),RerunTaskButton=({task:He,onSuccess:Qe=()=>{}})=>{const{t:it}=useTranslation(["artwork"]),[{loading:lt},ut]=useAsyncFn(async()=>{try{await dialogConfirm({title:"Confirm to rerun this task?",description:"Usually the failure is due to the bad parameters. If you think there is no problem you can try to rerun the failed task. This will not consume extra credits.",cancelLabel:"No",confirmLabel:"Yes"}),await executeRerunGenerationTask({taskId:He.id}),Qe(),toast.success(it("artwork:task.rerun.success"))}catch(dt){if(dt===UserCancelled)return;toast.error(dt?.message)}},[He]);return jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",onPress:ut,busy:lt,children:it("artwork:rerun-task")})},titleImageFile="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/pixai-title-DdASxKEE.png",useGetUserProfiles=modifyQueryHook(createQueryHook(GetUserProfilesDocument),{transform:He=>({userId:He}),reduce:He=>He?.user}),[useSetProfiles,executeSetProfiles]=createMutationHelper(SetProfilesDocument),[useToggleDecoration,executeToggleDecoration]=createMutationHelper(ToggleDecorationDocument),uiElements=({userId:He,authorId:Qe,artworkId:it,mediaId:lt,scene:ut,fileOptions:dt})=>[{name:"download-button",ariaLabel:"Download",order:8,isButton:!0,tagName:"button",appendTo:"bar",html:{isCustomSVG:!0,inner:'<path d="M20.5 14.3 17.1 18V10h-2.2v7.9l-3.4-3.6L10 16l6 6.1 6-6.1ZM23 23H9v2h14Z" id="pswp__icn-download"/>',outlineID:"pswp__icn-download"},onClick:(xt,ft,vt)=>{const kt=dt?.videoUrlRef?.current??vt.currSlide?.data.src,St=!!dt?.videoUrlRef?.current||dt?.skipConversionRef?.current;kt&&downloadFile(kt,dt.fileName,{skipConversion:St}),track("image_dl",{artworkId:it,authorId:Qe,isMyMedia:He?He===Qe:void 0,scene:ut,mediaId:lt})}}],WATERMARK_HEIGHT=0;function watermarkedImageDimensions({originalWidth:He,originalHeight:Qe}){const it=window.devicePixelRatio,lt=He/512,ut=He*it,dt=(Qe+WATERMARK_HEIGHT*lt)*it;return{width:ut,height:dt}}const getTitleImageDimensions=({originalWidth:He,originalHeight:Qe})=>He>Qe?{width:70.5,height:21}:{width:94,height:28};async function watermarkImage(He){const Qe=He.width,it=He.height,lt=offscreenCanvasAvailable?new OffscreenCanvas(Qe,it):document.createElement("canvas"),ut=new Image;let dt="";const xt=new Image;let ft="";try{dt=await fetchToBlobUrl(He.src),await loadImage(dt,ut)}catch{}try{ft=await fetchToBlobUrl(titleImageFile),await loadImage(ft,xt)}catch{}function vt(kt){kt.drawImage(ut,0,0,Qe,it);const St=getTitleImageDimensions({originalWidth:He.width,originalHeight:He.height});kt.save(),kt.imageSmoothingQuality="high",kt.drawImage(xt,lt.width-St.width-16,lt.height-St.height-16,St.width,St.height),kt.restore()}if(isOffscreenCanvas(lt)){const kt=lt.getContext("2d",{alpha:!0});if(!kt)return null;vt(kt)}else{const kt=lt.getContext("2d",{alpha:!0});if(!kt)return null;vt(kt)}return URL.revokeObjectURL(dt),URL.revokeObjectURL(ft),new Promise(kt=>{canvasToBlob(lt).then(St=>{kt(St?URL.createObjectURL(St):null)})})}const SingleImageViewer=He=>{const{me:Qe}=useMe(),[it,lt]=reactExports.useState(null),ut=reactExports.useRef(),dt=reactExports.useRef(He.skipDownloadConversion),{data:{profiles:xt}={}}=useGetUserProfiles(He.enableWatermark?He.author?.id??skipToken:skipToken);reactExports.useEffect(()=>{if(He.enableWatermark&&!(!He.originalUrl||!He.height||!He.width))return xt&&watermarkImage({src:He.originalUrl,height:He.height,width:He.width}).then(Nt=>{Nt&&lt(Nt)}),()=>{it&&URL.revokeObjectURL(it)}},[He.originalUrl,He.width,He.height,He.enableWatermark,!!xt]);const ft=He.enableWatermark&&it,vt=ft?it:He.originalUrl,kt={width:He.width,height:He.height},St=!He.width||!He.height?{width:He.width,height:He.height}:watermarkedImageDimensions({originalHeight:He.height,originalWidth:He.width}),Tt=ft?St:kt,Mt=He.enableWatermark&&!it;return reactExports.useEffect(()=>{He.videoMediaId&&(ut.current=getMediaUrl(He.videoMediaId,"orig"))},[He.videoMediaId]),reactExports.useEffect(()=>{dt.current=He.skipDownloadConversion},[He.skipDownloadConversion]),jsxRuntimeExports.jsx(Gallery,{id:He.id??He.artworkId,uiElements:uiElements({userId:Qe?.id,authorId:He.author?.id,artworkId:He.artworkId,mediaId:He.mediaId,scene:He.scene,fileOptions:{fileName:He.fileName,skipConversionRef:dt,videoUrlRef:ut}}),options:{initialZoomLevel:"fit",secondaryZoomLevel:2,maxZoomLevel:"fill",...He.pswpOptions},children:jsxRuntimeExports.jsx(Item,{original:vt,thumbnail:He.thumbnailUrl,...Tt,cropped:He.cropped,children:({ref:Nt,open:At})=>{const $t=jsxRuntimeExports.jsx("img",{crossOrigin:"anonymous",width:He.width,height:He.height,ref:Nt,onClick:Dt=>{if(!Mt)return At(Dt)},src:vt,className:cx("object-contain",Mt&&"cursor-wait",He.imgClassName),id:He.enableWatermark&&it?"watermarked-img-id":void 0,alt:He.alt});return He.showFallbackThumbnail?jsxRuntimeExports.jsxs("div",{className:"w-full h-full isolate",children:[$t,jsxRuntimeExports.jsx("div",{className:"-z-10 left-0 top-0 w-full h-full absolute",children:jsxRuntimeExports.jsx("img",{className:cx("object-contain",He.imgClassName),src:He.thumbnailUrl})})]}):$t}})})},offscreenCanvasAvailable=typeof window.OffscreenCanvas=="function";function SingleMediaViewer(He){const{preferVideo:Qe,videoMediaId:it,...lt}=He;return!it||!Qe?jsxRuntimeExports.jsx(SingleImageViewer,{...lt}):jsxRuntimeExports.jsx(VideoMediaWrapper,{...lt,videoMediaId:it})}function VideoMediaWrapper(He){const[Qe,it]=reactExports.useState(!1),[lt,ut]=reactExports.useState(!1),dt=getMediaUrl(He.videoMediaId,"orig"),xt=reactExports.useRef(null),ft=reactExports.useCallback(()=>{ut(!0)},[]);return dt?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(VideoMedia,{ref:xt,src:dt,poster:He.thumbnailUrl,autoPlay:!0,className:cx("object-top object-contain",He.imgClassName),onClick:()=>{it(!0),xt.current?.pause()},onLoadedData:ft}),!lt&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-white/40 dark:bg-neutral-900/60 z-20",children:jsxRuntimeExports.jsx(mdiLoading,{className:"size-12 absolute inset-0 m-auto animate-spin"})}),Qe&&jsxRuntimeExports.jsx(FullWindowVideo,{videoUrl:dt,fileName:`pixai-${He.videoMediaId}.mp4`,onClose:()=>{xt.current?.play(),it(!1)}})]}):jsxRuntimeExports.jsx(CircularSpinner,{})}function FullWindowVideo(He){function Qe(){downloadFile(He.videoUrl,He.fileName,{skipConversion:!0})}return reactDomExports.createPortal(jsxRuntimeExports.jsxs("div",{className:"left-0 top-0 fixed w-full h-full z-[100000] grid place-content-center bg-black/80",tabIndex:-1,role:"dialog",onClick:()=>He.onClose?.(),children:[jsxRuntimeExports.jsx(VideoMedia,{src:He.videoUrl,className:"max-w-full max-h-screen object-contain",autoPlay:!0,controls:!0}),jsxRuntimeExports.jsxs("div",{className:"p-3 absolute top-0 right-0 flex items-center gap-4 text-white",children:[jsxRuntimeExports.jsx("button",{onClick:it=>{it.stopPropagation(),Qe()},children:jsxRuntimeExports.jsx("svg",{"aria-hidden":"true",viewBox:"0 0 32 32",width:"32",height:"32",children:jsxRuntimeExports.jsx("path",{d:"M20.5 14.3 17.1 18V10h-2.2v7.9l-3.4-3.6L10 16l6 6.1 6-6.1ZM23 23H9v2h14Z",fill:"currentColor"})})}),jsxRuntimeExports.jsx("button",{onClick:()=>He.onClose?.(),children:jsxRuntimeExports.jsx("svg",{"aria-hidden":"true",viewBox:"0 0 32 32",width:"32",height:"32",children:jsxRuntimeExports.jsx("path",{d:"M24 10l-2-2-6 6-6-6-2 2 6 6-6 6 2 2 6-6 6 6 2-2-6-6z",fill:"currentColor"})})})]})]}),document.body)}const materialSymbolsMatchWord=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M1 19.025v-5h2v3h18v-3h2v5H1ZM9.55 15v-.85h-.075q-.325.5-.875.788t-1.25.287q-1.225 0-1.925-.637t-.7-1.738q0-1.05.813-1.712t2.087-.663q.575 0 1.063.088t.837.287v-.35q0-.675-.463-1.075t-1.262-.4q-.525 0-.987.225t-.788.65L4.95 9.1q.475-.675 1.2-1.025t1.675-.35q1.55 0 2.375.738t.825 2.137V15H9.55ZM7.9 11.65q-.8 0-1.225.313t-.425.887q0 .5.375.813t.975.312q.8 0 1.363-.562t.562-1.363q-.35-.2-.8-.3t-.825-.1ZM12.525 15V4.975h1.55V7.8L14 8.8h.075q.075-.125.6-.638t1.65-.512q1.6 0 2.525 1.15t.925 2.65q0 1.5-.912 2.638t-2.538 1.137q-1.025 0-1.563-.45t-.687-.7H14V15h-1.475ZM16.1 9.05q-1 0-1.55.738T14 11.425q0 .925.55 1.65t1.55.725q1 0 1.563-.725t.562-1.65q0-.925-.563-1.65T16.1 9.05Z"})}),mdiChat=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 3c5.5 0 10 3.58 10 8s-4.5 8-10 8c-1.24 0-2.43-.18-3.53-.5C5.55 21 2 21 2 21c2.33-2.33 2.7-3.9 2.75-4.5C3.05 15.07 2 13.13 2 11c0-4.42 4.5-8 10-8Z"})}),mdiEarth=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17.9 17.39c-.26-.8-1.01-1.39-1.9-1.39h-1v-3a1 1 0 0 0-1-1H8v-2h2a1 1 0 0 0 1-1V7h2a2 2 0 0 0 2-2v-.41a7.984 7.984 0 0 1 2.9 12.8M11 19.93c-3.95-.49-7-3.85-7-7.93c0-.62.08-1.22.21-1.79L9 15v1a2 2 0 0 0 2 2m1-16A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"})}),mdiImageMove=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M15 3h4V0l5 5l-5 5V7h-4V3m6 8.94V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.06c-.06.33-.06.67-.06 1a8 8 0 0 0 8 8c.33 0 .67 0 1-.06M19 18l-4.5-6l-3.5 4.5l-2.5-3L5 18h14Z"})}),mdiImageSizeSelectLarge=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M21 15h2v2h-2v-2m0-4h2v2h-2v-2m2 8h-2v2c1 0 2-1 2-2M13 3h2v2h-2V3m8 4h2v2h-2V7m0-4v2h2c0-1-1-2-2-2M1 7h2v2H1V7m16-4h2v2h-2V3m0 16h2v2h-2v-2M3 3C2 3 1 4 1 5h2V3m6 0h2v2H9V3M5 3h2v2H5V3m-4 8v8a2 2 0 0 0 2 2h12V11H1m2 8l2.5-3.21l1.79 2.15l2.5-3.22L13 19H3Z"})}),getTaskType=He=>{const{batchSize:Qe=1,upscale:it=1,enlarge:lt=1}=He.parameters;return Qe===3?"variation":lt>1?"upscale":it>1?"enhance":"generation"},PublishTaskButton=({task:He,scene:Qe,formProps:it={},...lt})=>{const{t:ut}=useTranslation(["artwork"]),[dt,xt]=reactExports.useState(!1),{onSuccess:ft,...vt}=it,kt=()=>{xt(!1),ft?.()};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",onPress:()=>{track("publish_btn_click",{scene:"tasks"}),xt(!0)},...lt,children:ut("artwork:publish")}),jsxRuntimeExports.jsx(UIDialogResponsive,{open:dt,onClose:()=>xt(!1),dismissable:!0,className:"mlg:w-[600px] max-w-full",children:He&&jsxRuntimeExports.jsx(PublishTaskForm,{task:He,scene:Qe,onSuccess:kt,...vt})})]})},PublishTaskForm=({task:He,scene:Qe,section:it,onSuccess:lt,afterPublish:ut,mediaIdx:dt,initialValues:xt,formProps:{fields:ft,...vt}={}})=>{const{t:kt}=useTranslation(["artwork"]),St=useTrackPageView(),Tt=reactExports.useRef(new Date().getTime());reactExports.useEffect(()=>{St({scene:"publish"})},[]);const Mt=useForm({initialValues:mapTaskToArtworkInfoFormValue(He,xt)}),[Nt,At]=useLoadingCallback(async $t=>{try{const Dt={description:$t.description,extra:$t.extra,hidePrompts:$t.hidePrompts,isPrivate:$t.isPrivate,mediaIndex:dt,tags:normalizeTags($t.tags),title:$t.title},Ft=await executeCreateArtworkFromTaskV2({taskId:He.id,input:Dt});track("publish_success",{isPrivate:$t.isPrivate,scene:Qe,taskType:getTaskType(He),section:it}),trackUserPreference({type:"publish",taskParams:He.parameters,taskId:He.id,publishParams:{...Dt,extra:{...Dt.extra,description:Dt.description},hasFav:!!He.favoritedAt||isMediaFaved(He,Ft.data?.createArtworkFromTaskV2?.mediaId)},action:"confirm",otherParams:{scene:Qe,mediaIdx:dt,mediaId:Ft.data?.createArtworkFromTaskV2?.mediaId,duration:new Date().getTime()-Tt.current}}),toast.success(kt("artwork:notice.publish-successfully")),refetchGetTaskById(He.id),lt?.(),Ft.data?.createArtworkFromTaskV2&&ut?.(Ft.data.createArtworkFromTaskV2)}catch(Dt){toast.error(`Failed to publish. ${Dt?.message}`)}},[ut]);return jsxRuntimeExports.jsxs(UIForm,{form:Mt,onSubmit:At,children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:kt("artwork:generation.publish-settings")}),jsxRuntimeExports.jsx(UIDialogContent,{className:"flex flex-col gap-4",children:jsxRuntimeExports.jsx(ArtworkInfoForm,{form:Mt,fields:mergeArtworkInfoFormFields(ft,{prompts:!1,description:!0}),mediaId:He.mediaId,...vt})}),jsxRuntimeExports.jsx(UIDialogFooter,{className:cx("sticky bottom-0 bg-white dark:bg-zinc-800 justify-end mmd:translate-y-4"),children:jsxRuntimeExports.jsx(UIButton$1,{size:"large",type:"submit",busy:Nt,variant:"filled",children:kt("artwork:publish")})})]})},icBaselineCircle=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10s10-4.47 10-10S17.53 2 12 2z"})}),styles$4={"default-placeholder":"_default-placeholder_1q4vp_1","default-gradient":"_default-gradient_1q4vp_1","dark-purple-placeholder":"_dark-purple-placeholder_1q4vp_23","dark-purple-gradient":"_dark-purple-gradient_1q4vp_1","animated-text-letter":"_animated-text-letter_1q4vp_79","animated-text":"_animated-text_1q4vp_79"},AnimatedText=({text:He})=>{const Qe=reactExports.useMemo(()=>He.split(""),[He]);return jsxRuntimeExports.jsx("div",{className:"tracking-[0.1rem] uppercase font-light",children:Qe.map((it,lt)=>jsxRuntimeExports.jsx("span",{className:cx(styles$4["animated-text-letter"]),style:{animationDelay:`${lt*30}ms`},children:it},lt))})},TaskPlaceholderImage=({id:He="",status:Qe,className:it,waitingDescription:lt,withDescription:ut=!0,icon:dt,children:xt,style:ft,defaultClassName:vt,placeholderVariant:kt="default",contentStyleProps:St,...Tt})=>{const Mt=vt??styles$4[`${kt}-placeholder`],Nt=reactExports.useMemo(()=>Qe==="failed"||Qe=="cancelled"?{icon:jsxRuntimeExports.jsx(icBaselineClose,{className:"size-6"}),description:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"capitalize",children:Qe}),jsxRuntimeExports.jsx("div",{className:"text-xs font-mono justify-self-end",children:He})]}),stop:!0}:Qe==="waiting"?{icon:jsxRuntimeExports.jsx(CircularProgress,{size:28,variant:"indeterminate",className:"text-white"}),description:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"capitalize",children:[Qe,"..."]}),lt&&jsxRuntimeExports.jsx("p",{className:"px-4",children:lt})]})}:Qe==="running"?{icon:jsxRuntimeExports.jsx(Preloader,{dark:!0,inline:!0,duration:1500}),description:jsxRuntimeExports.jsx(AnimatedText,{text:"Generating"})}:{icon:jsxRuntimeExports.jsx(icBaselineCircle,{className:"size-6"}),description:jsxRuntimeExports.jsxs("div",{className:"capitalize",children:[`${Qe==="completed"?"":"Unknown:"}`," ",Qe]}),stop:!0},[He,Qe,lt]);return jsxRuntimeExports.jsx("div",{className:cx(it,Mt),style:{animationDelay:`-${hash(He)%15}s`,animationPlayState:Nt.stop?"paused":"initial",...ft},...Tt,children:jsxRuntimeExports.jsxs("div",{className:cx("w-full h-full flex flex-col gap-4 justify-center items-center relative",St?.className),style:St?.style,children:[dt??Nt.icon,ut&&Nt.description,xt]})})},styles$3={"image-placeholder":"_image-placeholder_wtapb_1","image-wrapper":"_image-wrapper_wtapb_7","generated-task-top-operation-btn":"_generated-task-top-operation-btn_wtapb_11"};function createAnimateDiffTaskParams({taskParameters:He,mediaId:Qe,itemIdx:it,animateTaskExtraArgs:lt}){const ut=!!He?.parameters.animateDiff?.enabled;if(!He?.outputs)return{};const dt=Qe??(ut?He.parameters.mediaId:He.outputs.batch?He.outputs.batch[it]?.mediaId:He.outputs.mediaId);return{...pick$1(He.parameters,["prompts","width","height"]),modelId:He.parameters.modelId,mediaId:dt,seed:ut?He.outputs.detailParameters.seed:void 0,extra:lt}}function useAnimateDiffTaskContext({taskParameters:He,mediaId:Qe,itemIdx:it,animateTaskExtraArgs:lt,scene:ut}){const{refetch:dt}=useMyQuota(),xt=reactExports.useMemo(()=>createAnimateDiffTaskParams({taskParameters:He,mediaId:Qe,itemIdx:it,animateTaskExtraArgs:lt}),[He,Qe,it,lt]),{data:ft,isValidating:vt}=usePricingTask(xt),[,kt]=reactExports.useContext(GeneratedItemsContext),[,St]=reactExports.useContext(HoveredItemContext),[Tt,Mt]=useLoadingCallback(async Nt=>{const $t=(await executeCreateGenerationTask({parameters:xt})).data?.createGenerationTask;$t&&track("animate_task_submit",{taskId:$t.id,modelId:xt.modelId,reroll:Nt,smooth:xt.animateDiff.smooth,duration:xt.animateDiff.long?"long":"short",denoise:xt.animateDiff?.v2?.denoise,motionScale:xt.animateDiff?.v2?.motionScale,scene:ut});const Dt=getTaskAndMediaIds($t);return Dt&&(kt(Dt),St(Dt[0].mediaId)),dt(),$t},[xt]);return{price:ft,computingPrice:vt,createTask:Mt,creatingTask:Tt,parameters:xt}}function AnimateButtonForTaskDisplayArea(He){const it=useIsMobile()?"medium":"small",lt=useNavigate(),ut=useAnimateDiffTaskContext(He);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Tooltip,{title:typeof He.disabled=="string"?He.disabled:He.tooltip,placement:"top",enterDelay:0,children:jsxRuntimeExports.jsx("span",{className:He.className,style:He.style,children:jsxRuntimeExports.jsx(Button,{size:it,disabled:!!He.disabled,className:cx(styles$3["generated-task-top-operation-btn"]),onClick:()=>{track("animate_click"),lt(withQuery("/generator/image/animation",{mediaId:ut.parameters?.mediaId}))},children:jsxRuntimeExports.jsx(fluentSparkle20Filled,{className:"size-5"})})})})})}function EnlargerModelSelect(He){const{t:Qe}=useTranslation(["generation"]),{data:{enlargeModels:it=[]}={},isValidating:lt}=useDynamicConstants();return jsxRuntimeExports.jsxs(FormControl,{className:He.className,children:[jsxRuntimeExports.jsx(InputLabel,{className:"font-semibold text-sm",id:"upscaler-select",children:Qe("generation:upscale.enlarge-model")}),jsxRuntimeExports.jsx(Select,{labelId:"upscaler-select",label:Qe("generation:upscale.enlarge-model"),value:He.value||"",onChange:ut=>He.onChange(ut.target.value),disabled:He.disabled,children:lt?jsxRuntimeExports.jsx(MenuItem$1,{disabled:!0,value:"",children:"Loading"}):it.map(ut=>jsxRuntimeExports.jsx(MenuItem$1,{value:ut,children:ut},ut))})]})}function GeneratedTaskVariationForm(He){const{t:Qe}=useTranslation(["generation"]),{data:it}=useTaskById(He.taskId),{data:lt}=useGetArtwork(it?.artworkId??skipToken),{submit:ut}=useTaskSubmitFormContext(),[,dt]=reactExports.useContext(GeneratedItemsContext),[xt,ft]=reactExports.useState(1e3),vt=He.baseMedia??it?.media,{width:kt,height:St}=it?.parameters??{},Tt=getArtworkParameters(lt,it),Mt={mediaId:vt?.id??"STUB",strength:.8,priority:xt,width:kt,height:St,controlNets:[]},Nt=reactExports.useMemo(()=>({...Tt,...Mt,batchSize:3}),[Tt,Mt.priority,Mt.height,Mt.width]),At=reactExports.useRef(new Date().getTime()),$t=reactExports.useMemo(()=>({type:"variation",taskId:it?.id,taskParams:{...Tt,...Mt},otherParams:{duration:new Date().getTime()-At.current,scene:"gen",mediaId:vt?.id,mediaIdx:He.mediaIdx}}),[it?.id,Tt,Mt]);reactExports.useImperativeHandle(He.onCancelCallbackRef,()=>({onCancel:()=>trackUserPreference({...$t,action:"cancel"})}),[$t]);const{data:Dt,isValidating:Ft}=usePricingTask(Nt),[Bt,Ot]=useLoadingCallback(async()=>{if(!it||!He.baseMedia)return;const Qt=He.baseMedia?.id??it.mediaId;try{if(it.status!=="completed")throw new Error("Task or artwork not available");trackUserPreference({...$t,action:"confirm"}),await ut({...Mt,prompts:Tt.prompts??it.parameters.prompts,baseImage:vt?UnFile.fromMedia(vt):void 0,batchSize:3},Wt=>{const Xt=Wt.createGenerationTask;if(Xt){dt([{taskId:it.id,mediaId:Qt},...getTaskAndMediaIds(Xt)??[]]),trackUserPreference({type:"variation",taskParams:Xt.parameters,taskId:it.id,currentTaskId:Xt.id,action:"success",otherParams:{scene:"gen",mediaId:vt?.id,mediaIdx:He.mediaIdx}});return}})}catch(Wt){console.log(Wt),toast.error("Cannot perform variation")}finally{He.onClose()}},[it,Mt,vt]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DialogTitle,{className:"font-semibold",children:Qe("generation:variation.confirm-dialog.title")}),jsxRuntimeExports.jsx(DialogActions,{children:jsxRuntimeExports.jsx(UIButton$1,{className:"w-full",color:"normal",variant:"filled",busy:Bt,onPress:Ot,children:jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-2 font-semibold",children:[Qe("generation:submit.lets-go.label"),jsxRuntimeExports.jsx(QuotaCost,{value:Dt?.actualPrice,iconSize:12,loading:Ft,className:"inline-flex !gap-1 !text-inherit"})]})})}),jsxRuntimeExports.jsx("div",{className:"w-full px-4 flex flex-col gap-4 items-center mb-2",children:jsxRuntimeExports.jsx(PriorityChannelSelectCheckbox,{value:xt,onChange:ft})})]})}const DEFAULT_I2I_UPSCALE_STRENGTH=.5;function GeneratedTaskUpscaleForm(He){const{t:Qe}=useTranslation(["common","generation"]),[it,lt]=reactExports.useState(1),[ut,dt]=reactExports.useState(1),[xt,ft]=reactExports.useState("upscale"),{values:vt,submit:kt}=useTaskSubmitFormContext(),St=useModelVersion(vt.modelId),Tt=isSDV1Model(St?.modelType),[Mt,Nt]=reactExports.useState(()=>vt.strength??DEFAULT_I2I_UPSCALE_STRENGTH),[At,$t]=reactExports.useState(()=>vt.samplingSteps??defaultTaskFormValues.samplingSteps),[Dt,Ft]=reactExports.useState(!1),{data:Bt,isValidating:Ot}=useDynamicDefaultParameters(),Qt=reactExports.useRef(!1),Wt=reactExports.useRef(!1),[Xt,Kt]=reactExports.useState(!1),{data:Jt}=useTaskById(He.taskId),[hr,xr]=reactExports.useState(vt.enlargeModel),{data:gr}=useGetArtwork(Jt?.artworkId??skipToken),[br,vr]=reactExports.useState(1e3),[,yr]=reactExports.useContext(GeneratedItemsContext),Cr=He.baseMedia??Jt?.media,{width:Rr,height:Ir}=He.baseMedia??Jt?.media??{},Tr=getMaxUpscaleRatio({width:Rr,height:Ir}),$r=getMaxEnlargableRatio({width:Rr,height:Ir}),Zr=getArtworkParameters(gr,Jt),Sr={mediaId:Cr?.id,priority:br,width:Rr,height:Ir,...xt==="upscale"?{enlarge:void 0,upscale:it,strength:Mt,samplingSteps:At,enableTile:Dt}:{enlarge:ut,enlargeModel:hr,upscale:void 0,enableADetailer:void 0},controlNets:void 0},Dr=reactExports.useMemo(()=>({...Zr,...Sr,batchSize:void 0}),[Jt,Sr.priority,Sr.upscale,Sr.enlarge,Sr.enlargeModel,Sr.strength,Sr.samplingSteps,Sr.width,Sr.height,Sr.enableTile]),wr=reactExports.useRef(new Date().getTime()),qr=reactExports.useMemo(()=>({type:xt,taskId:Jt?.id,taskParams:{...Zr,...Sr},otherParams:{duration:new Date().getTime()-wr.current,scene:"gen",mediaId:Cr?.id,mediaIdx:He.mediaIdx}}),[Jt?.id,Zr,Sr,xt]);reactExports.useImperativeHandle(He.onCancelCallbackRef,()=>({onCancel:()=>trackUserPreference({...qr,action:"cancel"})}),[qr]);const{data:Nr,isValidating:Jr}=usePricingTask(Dr),[Qr,Ur]=useLoadingCallback(async()=>{if(!(!Jt||!He.baseMedia))try{if(Jt?.status!=="completed")throw new Error("Task or artwork not available");trackUserPreference({...qr,action:"confirm"}),kt({...Zr,...Sr,prompts:Zr.prompts??Jt.parameters.prompts,baseImage:Cr?UnFile.fromMedia(Cr):void 0,batchSize:void 0},rn=>{const sn=rn.createGenerationTask;if(sn){yr(getTaskAndMediaIds(rn.createGenerationTask)??[]),trackUserPreference({type:xt,taskParams:sn.parameters,taskId:Jt.id,currentTaskId:sn.id,action:"success",otherParams:{scene:"gen",mediaId:Cr?.id,mediaIdx:He.mediaIdx}});return}}),He.onClose()}catch(rn){console.log(rn),toast.error("Cannot perform upscale")}},[Jt,Sr,Cr]),nn=hasModelDisabledUpscale(St?.extra),Cn=!!Tr&&Tr>=1.1&&!!Rr&&!!Ir&&!nn,es=!!$r&&$r>=1.1&&!!Rr&&!!Ir,Xr=Cn||es,en=xt==="upscale"&&!Cn||xt==="enlarge"&&!es||xt==="upscale"&&!Tt&&Dt;return reactExports.useEffect(()=>{if((Cn||es)&&!Qt.current){const rn=getDefaultUpscaleRatio({width:Rr,height:Ir});rn&&lt(rn);const sn=getDefaultEnlargeRatio({width:Rr,height:Ir});sn&&dt(sn),Qt.current=!0}},[Rr,Ir]),reactExports.useEffect(()=>{if(!Wt.current&&Bt){const rn=Bt.base.enlargeModel;rn&&xr(rn),Wt.current=!0}},[Bt]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DialogTitle,{className:"font-semibold",children:Qe("generation:upscale.dialog.title")}),!Xr&&jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsx(DialogContentText,{children:Qe("generation:upscale.limit-reached")})}),Xr&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"w-full px-4 flex flex-col gap-4 items-center",children:[jsxRuntimeExports.jsx(UIButton$1,{className:"w-full",color:"normal",variant:"filled",busy:Qr,onPress:Ur,disabled:en,children:jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-2 font-semibold",children:[Qe("generation:submit.lets-go.label"),jsxRuntimeExports.jsx(QuotaCost,{value:Nr?.actualPrice,iconSize:12,loading:Jr,className:"inline-flex !gap-1 !text-inherit"})]})}),jsxRuntimeExports.jsx(PriorityChannelSelectCheckbox,{value:br,onChange:vr})]}),jsxRuntimeExports.jsxs(FormControl,{className:"px-6",children:[jsxRuntimeExports.jsx(FormLabel,{id:"upscale-method-group",children:Qe("generation:upscale.method-choose")}),jsxRuntimeExports.jsxs(RadioGroup,{row:!0,name:"upscale-method-group",value:xt,onChange:rn=>{const sn=rn.target.value;track("upscale_select",{value:sn==="upscale"?"enhance":sn==="enlarge"?"upscale":void 0}),ft(sn)},children:[jsxRuntimeExports.jsx(FormControlLabel,{value:"enlarge",control:jsxRuntimeExports.jsx(Radio,{}),label:jsxRuntimeExports.jsxs("div",{className:"inline-flex gap-2",children:[Qe("generation:upscale.method.enlarge"),jsxRuntimeExports.jsx(HelpIcon,{children:jsxRuntimeExports.jsx("p",{className:"p-4 text-sm whitespace-pre-wrap",children:Qe("generation:upscale.enlarge-help")})})]}),disabled:!es}),jsxRuntimeExports.jsx(FormControlLabel,{value:"upscale",control:jsxRuntimeExports.jsx(Radio,{}),label:jsxRuntimeExports.jsxs("div",{className:"inline-flex gap-2",children:[Qe("generation:upscale.method.upscale"),jsxRuntimeExports.jsx(HelpIcon,{children:jsxRuntimeExports.jsx("p",{className:"p-4 text-sm whitespace-pre-wrap",children:Qe("generation:upscale.upscale-help")})})]}),disabled:!Cn})]})]})]}),Xt?Xr&&jsxRuntimeExports.jsx(DialogContent,{className:"pt-2",children:xt==="upscale"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("p",{className:"text-base text-primary-light",children:Qe("generation:upscale.upscale-ratio")}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4 pt-2 justify-center w-full",children:[jsxRuntimeExports.jsx(Slider,{className:"max-w-[400px]",value:it,onChange:(rn,sn)=>{lt(sn)},min:1,max:Tr,step:.1,valueLabelDisplay:"auto"}),jsxRuntimeExports.jsx("p",{children:it.toFixed(1)})]}),jsxRuntimeExports.jsxs("p",{children:[Rr,"×",Ir," → ",getFlooredValue(Rr,it),"×",getFlooredValue(Ir,it)]}),jsxRuntimeExports.jsx(ImageUpscaleSliders,{steps:At,strength:Mt,handleChange:{steps:$t,strength:Nt}}),!Tt&&jsxRuntimeExports.jsx(ControlSectionMessage,{type:ControlSectionMessageType.Warning,className:"mt-2",children:Qe("generation:upscale.enable-tile.incompatible-model-used-hint")}),jsxRuntimeExports.jsx(FormControlLabel,{checked:Dt,control:jsxRuntimeExports.jsx(Checkbox,{onChange:rn=>{Ft(rn.target.checked)}}),label:jsxRuntimeExports.jsxs("div",{className:"inline-flex gap-2 items-center",children:[jsxRuntimeExports.jsx("p",{children:Qe("generation:upscale.enable-tile.label")}),jsxRuntimeExports.jsx(HelpIcon,{children:jsxRuntimeExports.jsx("p",{className:"p-4 text-sm whitespace-pre-wrap",children:Qe("generation:upscale.enable-tile.help")})})]})})]}):jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsx(EnlargerModelSelect,{className:"mt-4",value:hr,onChange:rn=>{xr(rn)},disabled:Ot}),jsxRuntimeExports.jsx("p",{className:"text-base text-primary-light mt-4",children:Qe("generation:upscale.enlarge-ratio")}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4 pt-2 items-center",children:[jsxRuntimeExports.jsx(Slider,{className:"max-w-[400px]",value:ut,onChange:(rn,sn)=>{dt(sn)},min:1,max:$r,step:.1,valueLabelDisplay:"auto"}),jsxRuntimeExports.jsx("p",{children:ut.toFixed(1)})]}),jsxRuntimeExports.jsxs("p",{children:[Rr,"×",Ir," → ",getFlooredValue(Rr,ut),"×",getFlooredValue(Ir,ut)]})]})}):jsxRuntimeExports.jsx(Button,{className:"w-full",onClick:()=>{track("expand_btn_click"),Kt(!0)},disabled:!Xr,children:jsxRuntimeExports.jsx(icBaselineKeyboardArrowDown,{})})]})}const STRENGTH_SAFERANGE={min:.4,max:.6};function ImageUpscaleSliders(He){const{strength:Qe,steps:it,handleChange:lt}=He,{t:ut}=useTranslation(["generation"]),dt=He.strengthSafeRange??STRENGTH_SAFERANGE;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"flex gap-2 items-start mt-4 w-full",children:jsxRuntimeExports.jsx(SliderInputParamItem,{className:"grow",title:ut("generation:hires.strength.label"),value:Qe,inputProps:{min:.01,max:.99,step:.01},safeRange:dt,handleChange:xt=>{lt.strength(xt)}})}),jsxRuntimeExports.jsx("p",{className:cx("text-sm text-icon",Qe<dt.min||Qe>dt.max?"text-red-500":""),children:ut("generation:hires.strength.description_interpolation",{min:dt.min,max:dt.max})}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 items-start mt-4 w-full",children:jsxRuntimeExports.jsx(SliderInputParamItem,{className:"grow",title:ut("generation:hires.steps.label"),value:it,inputProps:{min:1,max:50,step:1},handleChange:xt=>{lt.steps(xt)}})})]})}const reasons=["doesnt-follow-prompt","unwanted-elements","incorrect-anatomy","blurry-or-artifacts","unattractive-style"];function ImageQualitySurveyForm(He){const{t:Qe}=useTranslation(["artwork","action"]),[it,lt]=reactExports.useState(""),[ut,dt]=reactExports.useState(()=>Object.fromEntries(reasons.map(vt=>[vt,!1]))),xt=vt=>{dt(kt=>({...kt,[vt.target.name]:vt.target.checked}))},ft=()=>{track("image_issue_submit",{content:it,...ut}),He.onConfirm?.()};return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(DialogTitle,{className:"font-bold",children:Qe("artwork:generation.image-survey.title")}),jsxRuntimeExports.jsxs(DialogContent,{children:[jsxRuntimeExports.jsx(FormGroup,{children:reasons.map(vt=>jsxRuntimeExports.jsx(FormControlLabel,{control:jsxRuntimeExports.jsx(Checkbox,{name:vt,onChange:xt}),checked:ut[vt],label:Qe(`artwork:generation.image-survey.reasons.${vt}`)},vt))}),jsxRuntimeExports.jsx(OutlinedInput,{className:"mt-4",fullWidth:!0,value:it,onChange:vt=>{lt(vt.target.value)},inputProps:{maxLength:500},multiline:!0,placeholder:Qe("artwork:generation.image-survey.reasons.other")})]}),jsxRuntimeExports.jsx("div",{className:"py-2 pb-6 w-full flex items-center justify-center",children:jsxRuntimeExports.jsx(UIButton$1,{onPress:ft,variant:"filled",className:"capitalize",children:Qe("action:submit")})})]})}const dialogSurvey=async()=>new Promise(async(He,Qe)=>{const it=await dialog({onClose:()=>{Qe(UserCancelled)},children:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(ImageQualitySurveyForm,{onConfirm:()=>{it.current?.close(),He()}})})})}),icBaselineStar=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2L9.19 8.63L2 9.24l5.46 4.73L5.82 21z"})}),icBaselineStarBorder=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m22 9.24l-7.19-.62L12 2L9.19 8.63L2 9.24l5.46 4.73L5.82 21L12 17.27L18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27l1-4.28l-3.32-2.88l4.38-.38L12 6.1l1.71 4.04l4.38.38l-3.32 2.88l1 4.28L12 15.4z"})});function TaskBookmarkBtn(He){const{updateTaskFavoriteDelete:Qe}=useSetTaskInMyTasks(),[,it]=reactExports.useContext(GeneratedItemsContext),lt=He.bookmarked,{t:ut}=useTranslation(["artwork"]),[dt,xt]=useLoadingCallback(async()=>{try{await client.updateBookmarkItem({input:{taskId:He.taskId,mediaId:He.mediaId,remove:lt}}),toast.success(ut(lt?"artwork:bookmark.notice.remove-success":"artwork:bookmark.notice.success")),it(ft=>{const vt=[...ft],kt=vt.findIndex(St=>St.mediaId===He.mediaId);return kt<0?ft:(vt.splice(kt,1,{...vt[kt],bookmarked:!lt}),vt)}),Qe(He.taskId,{type:"favorite",mediaId:He.mediaId,target:!lt}),He.afterAction?.(!lt)}catch(ft){toast.error(ft.message)}},[lt,He.taskId,He.mediaId]);return jsxRuntimeExports.jsx(Tooltip,{title:jsxRuntimeExports.jsx("span",{className:"capitalize",children:ut(lt?"artwork:bookmark.remove.label":"artwork:bookmark.add.label")}),children:jsxRuntimeExports.jsx(UIButton$1,{busy:dt,onPress:xt,variant:"ghost",className:"rounded-full p-2 bg-white hover:bg-white dark:hover:bg-white ml-auto shadow-lg",labelClassName:"text-amber-400 dark:text-amber-400",children:lt?jsxRuntimeExports.jsx(icBaselineStar,{className:"size-5"}):jsxRuntimeExports.jsx(icBaselineStarBorder,{className:"size-5"})})})}const pswpUiElementsForTaskDisplay=()=>[{name:"download-button",ariaLabel:"Download",order:8,isButton:!0,tagName:"button",appendTo:"bar",html:{isCustomSVG:!0,inner:'<path d="M20.5 14.3 17.1 18V10h-2.2v7.9l-3.4-3.6L10 16l6 6.1 6-6.1ZM23 23H9v2h14Z" id="pswp__icn-download"/>',outlineID:"pswp__icn-download"},onClick:(He,Qe,it)=>{const lt=it.currSlide?.data.pid??"",ut=lt.split("#")[0]||void 0,dt=lt.split("#")[1]||void 0,xt=it.currSlide?.data?.task,ft=it.currSlide?.data?.videoMediaId;it.currSlide?.data.src&&downloadFile(getMediaUrl(ft,"orig")??it.currSlide.data.src,`${getImageDownloadFilename({task:xt,mediaIdx:dt})}.${getImageDownloadFileExt({task:xt})}`,{skipConversion:isAnimateDiffTask(xt)}),xt?.parameters!=null&&trackUserPreference({type:"download",action:"confirm",taskId:xt.id,taskParams:xt.parameters,otherParams:{scene:"gen",mediaId:ut}})}}];function GeneratedItem(He){const[,Qe]=reactExports.useContext(GeneratedItemsContext),{t:it}=useTranslation(["artwork"]),[lt,ut]=reactExports.useContext(HoveredItemContext),[dt,xt]=reactExports.useState(!1),[ft,vt]=reactExports.useState(!1),[kt,St]=reactExports.useState(!1),{data:Tt}=useTaskById(He.taskId),{data:Mt}=useGetMedia(He.mediaId??skipToken),Nt=Mt;getPublicUrl(Nt),reactExports.useEffect(()=>{Nt&&He.onMediaLoad?.(Nt)},[Nt,He]),reactExports.useEffect(()=>{Tt?.status==="completed"&&He.mediaId==null&&Qe(Jt=>{const hr=[...Jt];return getNewGeneratedItems(hr,Tt)})},[Tt?.id,Tt?.status,He.mediaId,He.idx]);const At=reactExports.useCallback(()=>{He.itemsCount!==1&&(xt(!0),ut(He.mediaId))},[He.itemsCount,He.mediaId]),$t=Jt=>()=>{He.itemsCount!==1&&(Jt==="toolbar"?vt(!0):St(!0))},Dt=Jt=>()=>{He.itemsCount!==1&&(Jt==="toolbar"?vt(!1):Jt==="action"?St(!1):xt(!1))};useDebounce(()=>{!dt&&!ft&&!kt&&lt===He.mediaId&&ut(void 0)},100,[dt,ft,kt,He.mediaId]);const Ft=reactExports.useCallback(()=>{Qt(!1)},[]);(Tt?.parameters?.upscale??0)>1;const{data:Bt}=useUserInfo(),[Ot,Qt]=reactExports.useState(!0),Wt=useIsMobile();if(He.deleted)return jsxRuntimeExports.jsx("div",{className:cx(styles$3["image-wrapper"]),style:{aspectRatio:`${getAspectRatio(Nt)}`},children:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center text-base font-medium text-center p-2 bg-gray-700 text-white rounded-md size-full",children:it("artwork:generation.image-deleted")})});if(Nt)return jsxRuntimeExports.jsxs("div",{className:styles$3["image-wrapper"],style:{aspectRatio:`${getAspectRatio(Nt)}`},children:[jsxRuntimeExports.jsx(GeneratedImageWrapper,{media:Nt,task:Tt,idx:He.idx,itemsCount:He.itemsCount,onMouseEnter:At,onMouseLeave:Dt("image"),onImgLoad:Ft}),jsxRuntimeExports.jsx(AnimatePresence,{children:!Ot&&(lt===He.mediaId||He.itemsCount===1||Wt)&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GeneratedItemTopActions,{taskId:He.taskId,baseMedia:Mt,itemIdx:He.idx,bookmarked:He.bookmarked,onMouseEnter:$t("toolbar"),onMouseLeave:Dt("toolbar")}),Bt&&jsxRuntimeExports.jsx(GeneratedItemBottomActions,{taskId:He.taskId,baseMedia:Mt,itemIdx:He.idx,bookmarked:He.bookmarked,onMouseEnter:$t("action"),onMouseLeave:Dt("action")})]})})]});if(!Tt)return jsxRuntimeExports.jsx(Preloader,{inline:!0,className:"absolute inset-0 m-auto"});const Xt=Tt?.parameters.width??Tt?.media?.width??512,Kt=Tt?.parameters.height??Tt?.media?.height??512;return jsxRuntimeExports.jsxs(TaskPlaceholderImage,{className:cx(styles$3["image-placeholder"],"w-full h-full overflow-hidden rounded-md"),style:Xt&&Kt?{aspectRatio:getAspectRatio({width:Xt,height:Kt}),maxWidth:He.itemsCount===2&&Xt,maxHeight:He.itemsCount===2&&Kt}:void 0,id:Tt?.id,status:Tt.status,placeholderVariant:Tt.parameters.priority===TASK_PRIORITIES.default?"dark-purple":"default",children:[Tt.status===TaskStatus.failed&&(Tt.outputs?.reason??Tt.outputs?.task_staus_msg),jsxRuntimeExports.jsx(PriorityModeIndicator,{priority:Tt.parameters.priority}),Bt?.isAdmin&&jsxRuntimeExports.jsx(Tooltip,{title:"admin only",children:jsxRuntimeExports.jsx(Button,{variant:"contained",color:"warning",onClick:()=>{dialogInspection(Tt)},children:"Inspect"})})]})}function GeneratedImageWrapper(He){const[Qe,it]=reactExports.useState(null),[lt,ut]=reactExports.useState(!1),[dt,xt]=reactExports.useState(!1),{media:ft,task:vt}=He,kt=getPublicUrl(ft),St=getThumbnailUrl(ft),Tt=getStillThumbnailUrl(ft),Mt=(vt?.parameters?.upscale??0)>1,Nt=reactExports.useCallback(()=>trackUserPreference({type:"click",taskId:vt?.id,taskParams:vt?.parameters,otherParams:{scene:"gen",mediaId:ft.id,mediaIdx:He.idx}}),[vt?.parameters,ft.id,He.idx]),{height:At,width:$t}=ft;reactExports.useEffect(()=>{if(He.enableWatermark&&!(!kt||!At||!$t))return watermarkImage({src:kt,height:At,width:$t}).then(gr=>{gr&&it(gr)}),()=>{Qe&&URL.revokeObjectURL(Qe)}},[kt,$t,At,He.enableWatermark]);const Dt=He.enableWatermark?Qe:kt,Ft=He.enableWatermark&&!Qe,Bt=getVideoMediaIdFromTask(vt),Ot=getMediaUrl(Bt,"orig"),Qt=reactExports.useRef(null),[Wt,Xt]=reactExports.useState(!1),Kt=reactExports.useCallback(()=>{Xt(!0),Qt.current?.pause()},[]),Jt=reactExports.useCallback((gr,br)=>{Ft||(track("task_image_click",{scene:He.itemsCount}),Nt(),br(gr))},[Ft,He.itemsCount]),hr=reactExports.useCallback(()=>(ut(!0),He.onImgLoad()),[He.onImgLoad]),xr=reactExports.useCallback(()=>{xt(!0)},[]);return jsxRuntimeExports.jsx(Item,{original:Dt??kt,thumbnail:St,width:ft.width,height:ft.height,id:`${ft.id}#${He.idx}`,task:vt,videoMediaId:Bt,children:({ref:gr,open:br})=>jsxRuntimeExports.jsxs("div",{ref:gr,className:"h-full relative",style:{minWidth:80,minHeight:80},children:[!lt&&jsxRuntimeExports.jsx(mdiLoading,{className:"w-6 h-6 absolute inset-0 m-auto animate-spin"}),jsxRuntimeExports.jsx("img",{crossOrigin:"anonymous",className:cx("relative z-10 h-full object-center object-contain rounded-md",Ft&&"cursor-wait"),src:Bt?Tt:kt,onClick:vr=>Jt(vr,br),onMouseEnter:He.onMouseEnter,onMouseLeave:He.onMouseLeave,width:Mt?vt?.parameters.width:void 0,height:Mt?vt?.parameters.height:void 0,onLoad:hr}),Bt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(VideoMedia,{ref:Qt,mediaId:Bt,autoPlay:!0,className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10 h-full rounded-md object-center object-contain",onLoadedData:xr,onMouseEnter:He.onMouseEnter,onMouseLeave:He.onMouseLeave,onClick:Kt}),!dt&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-white/40 dark:bg-neutral-900/60 z-20",children:jsxRuntimeExports.jsx(mdiLoading,{className:"w-6 h-6 absolute inset-0 m-auto animate-spin"})}),Wt&&jsxRuntimeExports.jsx(FullWindowVideo,{videoUrl:Ot||"",fileName:`pixai-${Bt}.mp4`,onClose:()=>{Xt(!1),Qt.current?.play()}})]})]})})}function GeneratedItemBottomActions(He){const[,Qe]=reactExports.useContext(SelectedTaskContext),{data:it}=useTaskById(He.taskId),lt=isVideoTask(it),{t:ut}=useTranslation(["generation"]),dt=it?.parameters.batchSize===3&&He.baseMedia?.id===it.parameters.mediaId,xt=getMediaIdx(it,He.baseMedia?.id),ft=St=>{const Tt={type:"fav",action:St?"confirm":"cancel",taskId:it?.id,taskParams:it?.parameters,otherParams:{scene:"gen",mediaIdx:xt,mediaId:He.baseMedia?.id}};trackUserPreference(Tt)},vt=!(it?.status!=="completed"||it.artworks?.map(St=>St.mediaId).includes(He.baseMedia?.id)||it?.parameters.batchSize===3&&He.baseMedia?.id===it.parameters.mediaId||lt),kt=!lt&&!isWorkflowTask(it)&&!isChatTask(it);return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-x-0 bottom-2 w-full flex items-center gap-2 px-2 z-20",onMouseEnter:He.onMouseEnter,onMouseLeave:He.onMouseLeave,children:[kt&&jsxRuntimeExports.jsx(Tooltip,{title:ut("generation:image-operation.scale"),children:jsxRuntimeExports.jsx(IconButton,{className:"rounded-full w-10 h-10 p-2 mr-auto text-black bg-white shadow hover:shadow-md shadow-black/40",disabled:!it?.id,onClick:St=>{St.stopPropagation(),track("base_image_upscale_click",{path:He.baseMedia?"batch":"single"}),Qe({taskId:it?.id,baseMedia:He.baseMedia,openUpscaleDialog:!0}),trackUserPreference({type:"upscale",action:"click",taskId:it?.id,taskParams:it?.parameters,otherParams:{scene:"gen",mediaId:He.baseMedia?.id,mediaIdx:xt}})},children:jsxRuntimeExports.jsx(mdiImageSizeSelectLarge,{height:20,width:20})})}),vt&&jsxRuntimeExports.jsx(Button,{variant:"contained",className:"px-3",onClick:St=>{St.stopPropagation(),track("publish_btn_click",{path:He.baseMedia?"batch":"single",scene:"panel"}),Qe({taskId:it.id,mediaIdx:xt,baseMedia:He.baseMedia,openPublishDialog:!0})},children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(mdiEarth,{className:"size-5"}),ut("artwork:publish")]})}),it?.status==="completed"&&He.baseMedia&&!dt&&jsxRuntimeExports.jsx(TaskBookmarkBtn,{taskId:it.id,mediaId:He.baseMedia.id,bookmarked:He.bookmarked,afterAction:ft})]})}function GeneratedItemTopActions(He){const{t:Qe}=useTranslation(["artwork","common","generation"]),{dispatch:it}=reactExports.useContext(GeneratorContext),lt=reactExports.useContext(FillEditorContext),{updateTaskFavoriteDelete:ut}=useSetTaskInMyTasks(),[,dt]=reactExports.useContext(SelectedTaskContext),[,xt]=reactExports.useContext(GeneratedItemsContext),{data:ft,refetch:vt}=useTaskById(He.taskId),kt=isVideoTask(ft),St=getVideoMediaIdFromTask(ft),{data:Tt}=useUserInfo(),[,Mt]=reactExports.useContext(ImageEditorContext),{values:Nt,setValues:At}=useTaskSubmitFormContext(),$t=(xr,gr=xr.media)=>{At(br=>({...br,baseImage:gr?UnFile.fromMedia(gr):void 0,...getTaskDimensionsForImport(xr,gr),ipAdapter:void 0,inpaintMaskImage:void 0,previewImage:void 0})),Mt(br=>({...br,dirty:!0}))},Dt=(Nt.controlNets??[]).length>0,Ft=ft?.parameters.batchSize===3&&He.baseMedia?.id===ft.parameters.mediaId,Bt=getMediaIdx(ft,He.baseMedia?.id),Ot=()=>{At(xr=>({...xr,controlNets:[]}))},Qt=()=>{At(xr=>({...xr,upscale:void 0,upscaleDenoisingSteps:void 0,upscaleDenoisingStrength:void 0}))},Wt=xr=>{trackUserPreference({type:"delete",action:xr?.onCancel?"cancel":"confirm",taskId:ft?.id,taskParams:ft?.parameters,otherParams:{scene:"gen",mediaIdx:Bt,mediaId:He.baseMedia?.id}})},Xt=useIsMobile(),Kt=1,Jt="left",hr=Xt?"medium":"small";return jsxRuntimeExports.jsxs(motion.div,{initial:{x:36*Kt,opacity:0},animate:{x:0,opacity:1},transition:{type:"spring",bounce:0,duration:.4},exit:{x:36*Kt,opacity:0},className:cx("absolute top-0 p-1 h-full flex flex-col border bg-neutral-100 dark:bg-neutral-700 border-stone-800/20 overflow-y-auto","pr-6 rounded-l-lg",Xt?"-left-12":"-left-11"),onMouseEnter:He.onMouseEnter,onMouseLeave:He.onMouseLeave,children:[He.baseMedia&&!kt&&jsxRuntimeExports.jsx(AnimateButtonForTaskDisplayArea,{scene:"panel",taskParameters:ft,itemIdx:He.itemIdx,mediaId:He.baseMedia.id,tooltip:Qe("generation:animated-image.animate-button.label")}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),Tt?.isAdmin&&jsxRuntimeExports.jsx(Tooltip,{title:"Inspect (admin only)",placement:Jt,children:jsxRuntimeExports.jsx(Button,{size:hr,className:cx(styles$3["generated-task-top-operation-btn"],"opacity-20"),onClick:()=>{dialogInspection(ft)},children:jsxRuntimeExports.jsx(icBaselineSearch,{className:"size-5"})})}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),!kt&&jsxRuntimeExports.jsx(Tooltip,{title:Qe("generation:image-operation.captioning"),placement:Jt,children:jsxRuntimeExports.jsx(Button,{className:cx(styles$3["generated-task-top-operation-btn"]),disabled:!ft?.id,onClick:xr=>{xr.stopPropagation(),track("base_image_captioning_click"),dt({taskId:ft?.id,baseMedia:He.baseMedia,mediaIdx:Bt,openCaptioningDialog:!0})},children:jsxRuntimeExports.jsx(materialSymbolsMatchWord,{})})}),ft?.status==="completed"&&!Ft&&!He.bookmarked&&jsxRuntimeExports.jsx(Tooltip,{title:jsxRuntimeExports.jsx("span",{className:"capitalize",children:Qe("generation:delete-media.label")}),placement:Jt,children:jsxRuntimeExports.jsx(DeleteTaskMediaBtn,{size:hr==="medium"?"normal":hr,task:ft,mediaId:He.baseMedia?.id,variant:"ghost",onTaskDelete:async()=>{Wt(),vt(),dt({}),xt(gr=>[...gr].filter(vr=>vr.taskId!==ft.id)),ut(ft.id,{type:"delete",target:!0}),Math.random()<.25&&await dialogSurvey()},onMediaDelete:async xr=>{Wt(),xt(br=>{const vr=[...br],yr=vr.findIndex(Cr=>Cr.mediaId===xr);return yr<0?br:(vr.splice(yr,1,{...vr[yr],deleted:!0}),vr)}),ut(ft.id,{type:"delete",mediaId:xr,target:!0}),vt(),dt({}),Math.random()<.25&&await dialogSurvey()},onCancel:()=>Wt({onCancel:!0}),className:cx(styles$3["generated-task-top-operation-btn"]),children:jsxRuntimeExports.jsx(icBaselineDeleteOutline,{className:"size-5 mx-auto"})})}),!kt&&jsxRuntimeExports.jsx(Tooltip,{title:Qe("generation:image-operation.variation"),placement:Jt,children:jsxRuntimeExports.jsx(Button,{size:hr,className:cx(styles$3["generated-task-top-operation-btn"]),disabled:!ft?.id,onClick:xr=>{xr.stopPropagation(),track("base_image_variations_click"),dt({taskId:ft?.id,baseMedia:He.baseMedia,openVariationDialog:!0}),trackUserPreference({type:"variation",action:"click",taskId:ft?.id,taskParams:ft?.parameters,otherParams:{scene:"gen",mediaId:He.baseMedia?.id,mediaIdx:Bt}})},children:jsxRuntimeExports.jsx(icBaselineCallSplit,{className:"size-5"})})}),!kt&&jsxRuntimeExports.jsx(Tooltip,{title:Qe("generation:image-operation.edit"),placement:Jt,children:jsxRuntimeExports.jsx(Button,{size:hr,className:cx(styles$3["generated-task-top-operation-btn"]),onClick:xr=>{xr.stopPropagation(),track("base_image_edit_click",{label:"left"}),He.baseMedia&&(lt.current.setBaseImageFromMedia(He.baseMedia,{task:ft,cate:"task"}),it({type:"set-mode",value:GeneratorMode.Fill}),Qt(),Dt&&Ot())},children:jsxRuntimeExports.jsx(icBaselineEdit,{className:"size-5"})})}),!kt&&jsxRuntimeExports.jsx(Tooltip,{title:Qe("generation:image-operation.use-base-image"),placement:Jt,children:jsxRuntimeExports.jsx(Button,{size:hr,className:styles$3["generated-task-top-operation-btn"],disabled:!ft?.id,onClick:xr=>{xr.stopPropagation(),track("use_as_base_click",{scene:"gen"}),ft&&(Mt(gr=>({...gr,isInpaintOn:!1})),$t(ft,He.baseMedia),Qt(),Dt&&Ot(),toast.info(Qe("generation:image-operation.notice.added-as-base-image")))},children:jsxRuntimeExports.jsx(mdiImageMove,{className:"size-5"})})}),!kt&&ft?.status==="completed"&&jsxRuntimeExports.jsx(ChatWorkspaceCreatorTool,{location:"panel-image-sidebar",tooltipProps:{title:Qe("generation:image-operation.start-chat-editing"),placement:Jt},size:hr,className:styles$3["generated-task-top-operation-btn"],disabled:!ft?.id,initialImageId:He.baseMedia?.id,children:jsxRuntimeExports.jsx(mdiChat,{className:"size-5"})}),ft?.status==="completed"&&jsxRuntimeExports.jsx(Tooltip,{title:Qe("generation:image-operation.download-image"),placement:Jt,children:jsxRuntimeExports.jsx(Button,{size:hr,className:styles$3["generated-task-top-operation-btn"],disabled:!ft?.id,onClick:xr=>{if(xr.stopPropagation(),!ft)return;const gr=He.baseMedia??ft.media;track("image_dl",{scene:"generator-image",authorId:ft?.userId,isMyMedia:Tt?Tt.id===ft?.userId:void 0,artworkId:ft.artworks?.find(vr=>vr.mediaId===He.baseMedia?.id)?.id,mediaId:kt?St:gr?.id}),trackUserPreference({type:"download",action:"confirm",taskId:ft.id,taskParams:ft.parameters,otherParams:{scene:"gen",mediaId:He.baseMedia?.id,mediaIdx:Bt}});const br=getMediaUrl(kt?St:gr?.id,"orig");br?downloadFile(br,`${getImageDownloadFilename({task:ft,mediaIdx:Bt})}.${getImageDownloadFileExt({task:ft})}`,{skipConversion:kt}):toast.error("Cannot download image")},children:jsxRuntimeExports.jsx(icBaselineDownload,{className:"size-5"})})})]})}function GeneratedTaskUpscaleDialog(){const[He,Qe]=reactExports.useContext(SelectedTaskContext),it=reactExports.useRef(null),lt=()=>{Qe({openUpscaleDialog:!1})};return jsxRuntimeExports.jsx(Dialog,{open:!!He?.openUpscaleDialog,onClose:(ut,dt)=>{it.current?.onCancel(),lt()},PaperProps:{sx:{minWidth:400}},children:He?.taskId?jsxRuntimeExports.jsx(GeneratedTaskUpscaleForm,{mediaIdx:He.mediaIdx,taskId:He.taskId,baseMedia:He.baseMedia,onClose:lt,onCancelCallbackRef:it}):null})}function GeneratedTaskVariationDialog(){const[He,Qe]=reactExports.useContext(SelectedTaskContext),it=reactExports.useRef(null),lt=()=>{Qe({openVariationDialog:!1})};return jsxRuntimeExports.jsx(Dialog,{open:!!He?.openVariationDialog,onClose:(ut,dt)=>{it.current?.onCancel(),lt()},PaperProps:{sx:{minWidth:400}},children:He?.taskId?jsxRuntimeExports.jsx(GeneratedTaskVariationForm,{mediaIdx:He.mediaIdx,taskId:He.taskId,baseMedia:He.baseMedia,onClose:lt,onCancelCallbackRef:it}):null})}function GeneratedTaskPublishDialog(){const[He,Qe]=reactExports.useContext(SelectedTaskContext),{data:it}=useTaskById(He.taskId??skipToken),lt=reactExports.useCallback(ut=>{openShareArtworkDialog(ut,{trackingArgs:{scene:"generator-image"}})},[]);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(UIDialog,{open:He.openPublishDialog??!1,onClose:()=>Qe({openPublishDialog:!1}),dismissable:!0,className:"mlg:w-[600px]",children:it?jsxRuntimeExports.jsx(PublishTaskForm,{scene:"generation",mediaIdx:He.mediaIdx,task:it,afterPublish:lt,onSuccess:()=>{Qe({openPublishDialog:!1})}}):jsxRuntimeExports.jsx(Preloader,{})})})}function PriorityModeIndicator(He){const{t:Qe}=useTranslation(["generation"]);return He.priority!==TASK_PRIORITIES.default&&He.priority!==TASK_PRIORITIES.turboMode?null:jsxRuntimeExports.jsx("div",{className:"-translate-y-3 bg-black/20 rounded-[4px] px-[3px]",children:jsxRuntimeExports.jsx("p",{className:"bg-clip-text bg-gradient-purple-pink text-transparent font-medium text-[10px]",children:He.priority===TASK_PRIORITIES.turboMode?Qe("generation:generate.turbo-mode.on-label"):Qe("generation:generate.high-priority.on-label")})})}const icRoundAccessTime=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8s8 3.58 8 8s-3.58 8-8 8zm-.22-13h-.06c-.4 0-.72.32-.72.72v4.72c0 .35.18.68.49.86l4.15 2.49c.34.2.78.1.98-.24a.71.71 0 0 0-.25-.99l-3.87-2.3V7.72c0-.4-.32-.72-.72-.72z"})});function ItemList(He){const{items:Qe,itemContent:it=Bt=>jsxRuntimeExports.jsx("div",{children:String(Bt)}),groups:lt=[void 0],groupSorter:ut=()=>{},groupHeaderContent:dt=Bt=>Bt,columns:xt=3,footerContent:ft,classes:vt={},styles:kt={},atBottomStateChange:St,isScrollingStateChange:Tt}=He,Mt=reactExports.useMemo(()=>{const Bt=new Map(lt.map(Ot=>[Ot,[]]));for(const Ot of He.items)Bt.get(ut(Ot))?.push(Ot);return Bt},[Qe,lt,ut]),Nt=reactExports.useMemo(()=>lt.map(Bt=>chunk(Mt.get(Bt),xt)).flat(),[Mt]),At=lt.map(Bt=>Math.ceil((Mt.get(Bt)?.length??0)/xt)),$t=reactExports.useMemo(()=>reactExports.forwardRef(function(Ot,Qt){const Wt=Ot["data-testid"]==="virtuoso-top-item-list";return jsxRuntimeExports.jsx("div",{ref:Qt,...Ot,className:Wt?void 0:vt.list,style:{...Ot.style,...Wt?void 0:kt.list}})}),[vt.list,kt.list]),Dt=reactExports.useMemo(()=>reactExports.forwardRef(function(Ot,Qt){return jsxRuntimeExports.jsx("div",{ref:Qt,...Ot,className:vt.groupHeader,style:kt.groupHeader})}),[vt.groupHeader,kt.groupHeader]),Ft=reactExports.useMemo(()=>function(){return ft?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:ft}):null},[ft]);return jsxRuntimeExports.jsx(jr,{groupCounts:At,groupContent:Bt=>dt(lt[Bt],Bt),itemContent:Bt=>jsxRuntimeExports.jsx("div",{className:vt.row,style:{display:"grid",gridTemplateColumns:`repeat(${xt}, 1fr)`,...kt.row},children:Nt[Bt]?.map((Ot,Qt)=>jsxRuntimeExports.jsx("div",{className:"contents",children:it(Ot)},`${Bt}-${Qt}`))}),className:He.className,style:He.style,atBottomStateChange:St,atBottomThreshold:300,isScrolling:Tt,components:{List:$t,Group:Dt,Footer:Ft}})}function WorkflowIcon(He){return jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",width:"32",height:"32",fill:"none",...He,children:jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("rect",{x:"1",y:"1",width:"30",height:"30",rx:"7",stroke:"currentColor",strokeWidth:"2"}),jsxRuntimeExports.jsx("path",{d:"M12.2549 10.2888C11.9525 11.0513 11.3919 11.6834 10.6711 12.0748C9.95021 12.4662 9.11479 12.5921 8.3106 12.4304C7.50642 12.2688 6.78452 11.8299 6.27087 11.1904C5.75723 10.5508 5.48446 9.75121 5.50015 8.93109C5.51585 8.11097 5.81901 7.3224 6.35675 6.70297C6.89448 6.08355 7.63265 5.6726 8.44243 5.54184C9.25221 5.41109 10.0822 5.56882 10.7876 5.98752C11.4929 6.40622 12.0289 7.0593 12.3019 7.83281H19.6979C19.9731 7.05408 20.5147 6.39772 21.2271 5.97974C21.9394 5.56176 22.7766 5.40908 23.5906 5.54868C24.4046 5.68828 25.1431 6.11118 25.6755 6.74262C26.2079 7.37407 26.4998 8.17339 26.4998 8.99931C26.4998 9.82522 26.2079 10.6245 25.6755 11.256C25.1431 11.8874 24.4046 12.3103 23.5906 12.4499C22.7766 12.5895 21.9394 12.4369 21.2271 12.0189C20.5147 11.6009 19.9731 10.9445 19.6979 10.1658H15.9999C16.7591 11.1746 17.1688 12.4033 17.1669 13.6658V18.3328C17.1665 19.1007 17.4187 19.8474 17.8846 20.4578C18.3505 21.0682 19.0041 21.5085 19.7449 21.7108C20.0484 20.9445 20.6125 20.3099 21.3379 19.9187C22.0632 19.5274 22.9034 19.4046 23.7104 19.5719C24.5175 19.7391 25.2396 20.1857 25.7497 20.8331C26.2598 21.4804 26.5252 22.287 26.4991 23.1107C26.4731 23.9345 26.1572 24.7227 25.6072 25.3364C25.0572 25.9502 24.3082 26.3503 23.4923 26.4662C22.6763 26.5821 21.8456 26.4064 21.1464 25.9701C20.4472 25.5337 19.9243 24.8647 19.6699 24.0808C18.3158 23.8459 17.088 23.1405 16.2031 22.089C15.3182 21.0374 14.8329 19.7072 14.8329 18.3328V13.6658C14.833 12.8981 14.5807 12.1516 14.1149 11.5414C13.6491 10.9312 12.9955 10.491 12.2549 10.2888Z",fill:"currentColor"})]})})}const fluentSparkle16Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M5.465 9.83a.92.92 0 0 0 1.07-.001a1 1 0 0 0 .341-.459l.347-1.067a1.7 1.7 0 0 1 1.078-1.079l1.086-.353a.923.923 0 0 0-.037-1.75l-1.069-.346a1.7 1.7 0 0 1-1.08-1.078l-.353-1.084a.92.92 0 0 0-.869-.61a.92.92 0 0 0-.875.624l-.356 1.09A1.71 1.71 0 0 1 3.7 4.775l-1.084.351a.923.923 0 0 0 .013 1.745l1.067.347a1.71 1.71 0 0 1 1.081 1.083l.352 1.08c.063.18.181.337.337.448m5.07 4.021a.8.8 0 0 0 .464.148a.81.81 0 0 0 .759-.55l.248-.762c.053-.158.143-.303.26-.421s.262-.207.42-.259l.772-.252a.8.8 0 0 0-.023-1.521l-.764-.249a1.08 1.08 0 0 1-.68-.678l-.252-.774a.8.8 0 0 0-1.518.011l-.247.762a1.07 1.07 0 0 1-.664.679l-.776.253a.8.8 0 0 0-.388 1.221c.099.14.239.245.4.3l.763.247a1.08 1.08 0 0 1 .68.683l.253.774a.8.8 0 0 0 .292.388"})}),icBaselineImageNotSupported=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m21.9 21.9l-8.49-8.49l-9.82-9.82L2.1 2.1L.69 3.51L3 5.83V19c0 1.1.9 2 2 2h13.17l2.31 2.31l1.42-1.41zM5 18l3.5-4.5l2.5 3.01L12.17 15l3 3H5zm16 .17L5.83 3H19c1.1 0 2 .9 2 2v13.17z"})}),icOutlineChat=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M4 4h16v12H5.17L4 17.17V4m0-2c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2H4zm2 10h8v2H6v-2zm0-3h12v2H6V9zm0-3h12v2H6V6z"})}),icRoundKeyboardDoubleArrowLeft=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M18.29 17.29a.996.996 0 0 0 0-1.41L14.42 12l3.88-3.88a.996.996 0 1 0-1.41-1.41L12.3 11.3a.996.996 0 0 0 0 1.41l4.59 4.59c.38.38 1.01.38 1.4-.01z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M11.7 17.29a.996.996 0 0 0 0-1.41L7.83 12l3.88-3.88a.996.996 0 1 0-1.41-1.41L5.71 11.3a.996.996 0 0 0 0 1.41l4.59 4.59c.38.38 1.01.38 1.4-.01z"})]}),icRoundKeyboardDoubleArrowRight=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M5.7 6.71a.996.996 0 0 0 0 1.41L9.58 12L5.7 15.88a.996.996 0 1 0 1.41 1.41l4.59-4.59a.996.996 0 0 0 0-1.41L7.12 6.71c-.39-.39-1.03-.39-1.42 0z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12.29 6.71a.996.996 0 0 0 0 1.41L16.17 12l-3.88 3.88a.996.996 0 1 0 1.41 1.41l4.59-4.59a.996.996 0 0 0 0-1.41L13.7 6.7c-.38-.38-1.02-.38-1.41.01z"})]}),icRoundMinus=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M18 12.998H6a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2z"})}),fluentArrowAutofitHeight24Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M13.22 6.781a.75.75 0 0 1-.073-.976l.073-.085l2.367-2.37a.77.77 0 0 1 .664-.35c.252 0 .475.109.611.276l.053.075l2.367 2.37l.073.084a.75.75 0 0 1 .007.882l-.08.094l-.084.073a.75.75 0 0 1-.883.007l-.094-.08L17 5.56v3.784l-.007.089c-.05.32-.363.567-.743.567s-.694-.247-.743-.567l-.007-.09V5.56l-1.22 1.221l-.084.073a.75.75 0 0 1-.976-.073m.003 10.438a.75.75 0 0 1 .976-.073l.084.073l1.22 1.221v-3.784c0-.362.336-.656.75-.656c.38 0 .693.247.743.567l.007.09v3.783l1.221-1.221a.75.75 0 0 1 .977-.073l.084.073a.75.75 0 0 1 .073.976l-.073.084l-2.367 2.37a.77.77 0 0 1-.664.351a.77.77 0 0 1-.664-.35l-2.367-2.37a.75.75 0 0 1 0-1.061M6.25 3.992A2.25 2.25 0 0 0 4 6.242v11.5a2.25 2.25 0 0 0 2.25 2.25h4a.75.75 0 0 0 0-1.5h-4a.75.75 0 0 1-.75-.75v-11.5a.75.75 0 0 1 .75-.75h4a.75.75 0 0 0 0-1.5z"})}),fluentArrowAutofitHeightIn24Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m16.78 9.78l2.5-2.5a.75.75 0 0 0-1.06-1.06L17 7.44V3.75a.75.75 0 0 0-1.5 0v3.69l-1.22-1.22a.75.75 0 1 0-1.06 1.06l2.5 2.5a.75.75 0 0 0 1.06 0M4 6.25A2.25 2.25 0 0 1 6.25 4h4a.75.75 0 0 1 0 1.5h-4a.75.75 0 0 0-.75.75v11.5c0 .414.336.75.75.75h4a.75.75 0 0 1 0 1.5h-4A2.25 2.25 0 0 1 4 17.75zm15.28 10.47l-2.5-2.5a.75.75 0 0 0-1.06 0l-2.5 2.5a.75.75 0 1 0 1.06 1.06l1.22-1.22v3.69a.75.75 0 0 0 1.5 0v-3.69l1.22 1.22a.75.75 0 1 0 1.06-1.06"})}),FitToggle=({localStorageKey:He,className:Qe,iconClassName:it})=>{const[lt,ut]=useLocalStorage({key:He,defaultValue:"contain"}),dt=()=>{ut(lt==="contain"?"cover":"contain")};return jsxRuntimeExports.jsx("button",{className:cx("inline-grid place-content-center p-2 active:bg-black/10 dark:active:bg-white/10 rounded transition",Qe),onClick:dt,title:lt==="contain"?"Switch to cover (fill)":"Switch to contain (fit)",children:lt==="contain"?jsxRuntimeExports.jsx(fluentArrowAutofitHeightIn24Regular,{className:cx("size-5",it)}):jsxRuntimeExports.jsx(fluentArrowAutofitHeight24Regular,{className:cx("size-5",it)})})},useFit=He=>{const[Qe]=useLocalStorage({key:He,defaultValue:"contain"});return Qe};function getDefaultShiftValueParams(He){if(hasModelEnabledShiftValue(He))return{modelSampling:{inputs:{shift:He?.defaults?.shift}}}}function getDefaultRescaleCfgParams(He){if(hasModelEnabledRescaleCfg(He)){const Qe=He?.defaults?.rescaleCfg?.enabledValue;return{rescaleCFG:He?.defaults?.rescaleCfg?.enable?Qe:void 0}}}function getModelDefaultSize(He){if(typeof He?.width=="number"&&typeof He?.height=="number")return{width:He.width,height:He.height}}function getModelDefaultStyleMixSeed(He){if(typeof He?.styleMixSeed=="number")return He.styleMixSeed}const fieldsToChangeForModelVersionExtra=["negativePrompts","samplingSteps","samplingMethod","cfgScale"],fieldsToChangeForModelVersionExtraDefaults=["batchSize","upscaleDenoisingStrength","upscaleDenoisingSteps","upscaleSampler"];function getDefaultParamsFromModelVersionExtra(He,Qe){const{versionExtra:it={},modelId:lt,modelType:ut}=He,{defaults:dt={}}=it??{},xt=Object.fromEntries([...fieldsToChangeForModelVersionExtra.flatMap(Ft=>{const Bt=Ft in it?it?.[Ft]:void 0;return Bt!=null?[[Ft,Bt]]:[]}),...fieldsToChangeForModelVersionExtraDefaults.flatMap(Ft=>{const Bt=Ft in dt?dt[Ft]:void 0;return Bt!=null?[[Ft,Bt]]:[]})]),ft=getModelDefaultSize(it),vt=canModelUseStyleMix(it),kt=getModelDefaultStyleMixSeed(it),St=vt?{weight:DEFAULT_STYLE_MIX_WEIGHT,seed:kt??getRandomStyleMixRaw(),enabled:!0}:{enabled:!1},Mt=canModelUsePresetQualityTags(it)?{...getModelQualityTags(it)?.[0],...retrieveQualityTagFromLocalStorage(lt)}:void 0,At=Qe?.enableLightningMode&&hasModelEnabledLightning(it)?LIGHTNING_MODE_DEFAULT_PARAMS:{lightning:!1},$t=hasModelDisabledUpscale(it)?{upscale:void 0,upscaleDenoisingSteps:void 0,upscaleSampler:void 0}:{},Dt=hasModelEnabledInferenceConfig(it)?{...getDefaultRescaleCfgParams(it),...getDefaultShiftValueParams(it)}:void 0;return{...xt,...ft,styleMix:St,qualityTag:Mt,inferenceConfig:Dt,...At,...$t}}function getParamsForModelChange(He,Qe){const{versionId:it,modelId:lt,versionExtra:ut,modelType:dt,currentModelType:xt}=He,{hiresEnabled:ft,...vt}=Qe,kt=dt!=null&&xt!=null&&dt!==xt,St=kt,Tt=kt&&ft,Mt=getDefaultParamsFromModelVersionExtra({versionExtra:ut,modelId:lt},vt);return{values:{modelId:it,...St?getDefaultSizeByModelType(dt):{},...Mt,clipSkip:isSDV1Model(dt)?DEFAULT_CLIPSKIP_VAL_FOR_SDV1:DEFAULT_CLIPSKIP_VAL_FOR_NON_SDV1,...kt?{vaeModelId:void 0}:{},...hasModelDisabledFaceFix(ut)?{enableADetailer:!1}:{},...Tt?emptyHiResParams:{}},hasResetHires:Tt,hasResetSize:St}}function parseInitialTaskFormState(He){const{baseImageMedia:Qe,task:it,artwork:lt,allowedSamplingMethods:ut,modelVersion:dt,loraVersion:xt,presetModelList:ft,options:vt,extraInitialValues:kt}=He,{isUseAsReference:St}=vt??{},Tt=lt||it?getArtworkParameters(lt,it):{};let Mt;if(Qe&&!St)try{Mt=UnFile.fromMedia(Qe)}catch{}const Nt=typeof it?.id=="string"&&!dt,At=dt?dt.model:getDefaultModelForLora(ft,getLoraTypeFromModelVersion(xt)),$t=dt??At?.latestAvailableVersion,Dt=$t?.extra,Ft=Nt?void 0:getDefaultParamsFromModelVersionExtra({versionExtra:Dt,modelId:At?.id,modelType:At?.type},{enableLightningMode:!0}),{width:Bt,height:Ot}=St?getNearestPresetSize(it?.parameters??Qe):it?getTaskDimensionsForImport(it,Qe):getCompressedDimensions(Qe);return{...defaultTaskFormValues,baseImage:Mt,...Mt?{strength:it?.parameters?.strength??defaultTaskFormValues.strength}:{},...pickBy(Tt,(Qt,Wt)=>{if(Wt==="samplingMethod"&&!(ut??[]).includes(Qt)||Wt==="seed")return!1;if(Qt!=null)return!0}),width:Bt,height:Ot,inpaintMaskImage:void 0,previewImage:void 0,seed:"",...St?{upscale:void 0,upscaleDenoisingSteps:void 0,upscaleDenoisingStrength:void 0,enlarge:void 0}:{},...!Nt&&$t?{modelId:$t.id,...Ft}:{},t2i2v:{enabled:!!it?.parameters?.t2i2v,i2vPro:it?.parameters?.t2i2v,channel:it?.parameters?.channel},...kt}}function SelectImageFromBatchDialogContent(He){const{data:Qe}=useGetMedia(He.mediaIds[0]??skipToken);return jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 grid-rows-2 gap-4 p-4 max-w-full items-center justify-items-center",style:{width:`calc((100dvh - 64px) * ${getAspectRatio(Qe)})`},children:He.mediaIds.map(it=>jsxRuntimeExports.jsx(MediaComp,{mediaId:it,onConfirm:He.onConfirm},it))})}function MediaComp(He){const{data:Qe,loading:it}=useGetMedia(He.mediaId),lt=getThumbnailUrl(Qe);return!Qe&&it?jsxRuntimeExports.jsx(Preloader,{}):Qe&&lt?jsxRuntimeExports.jsx("button",{className:"size-full hover:shadow-xl hover:-translate-y-1 transition-all",onClick:()=>{He.onConfirm(Qe)},children:jsxRuntimeExports.jsx("img",{className:"rounded-2xl size-full object-cover",src:lt})}):null}const dialogSelectImageFromBatch=He=>new Promise((Qe,it)=>{const lt=dialog({PaperProps:{className:"w-auto rounded-[2rem]"},children:jsxRuntimeExports.jsx(SelectImageFromBatchDialogContent,{mediaIds:He,onCancel:()=>{lt.current?.close(),it(UserCancelled)},onConfirm:ut=>{lt.current?.close(),Qe(ut)}}),onClose:()=>{it(UserCancelled)},fullWidth:!0,maxWidth:"md",scroll:"paper"})}),DURATION_1_HOUR=defaultDayjs.duration(1,"hour").as("ms"),DURATION_6_HOURS=defaultDayjs.duration(6,"hours").as("ms"),GROUPS={"1h":"generation:task-list.groups.in-1-hour","6h":"generation:task-list.groups.in-6-hours",today:"generation:task-list.groups.today",yesterday:"generation:task-list.groups.yesterday"};function groupByTime(He,Qe){const it=Date.now();return $$3(defaultDayjs(He)).when(lt=>lt.isAfter(it-DURATION_1_HOUR),()=>Qe?defaultDayjs.duration(1,"hour").humanize():"1h").when(lt=>lt.isAfter(it-DURATION_6_HOURS),()=>Qe?defaultDayjs.duration(6,"hours").humanize():"6h").when(lt=>lt.isAfter(defaultDayjs().startOf("day").valueOf()-1),()=>"today").when(lt=>lt.isAfter(defaultDayjs().subtract(1,"day").startOf("day").valueOf()-1),()=>"yesterday").otherwise(()=>defaultDayjs(He).format(Qe?"MMM D":"LL"))}const GRID_SIZE_MIN=1,GRID_SIZE_MAX=6,gridSizeAtom=atom(3),searchKeywordAtom=atom("");function TaskAndFavTabs({allowedTypes:He,scene:Qe,afterClick:it,className:lt,style:ut,onSelectItem:dt,enableClickToImportTask:xt,enableBatchMediaSelect:ft}){const{data:vt}=useUserInfo(),kt=vt,[St,Tt]=reactExports.useState("tasks");reactExports.useEffect(()=>{vt||Tt("tasks")},[vt]);const{t:Mt}=useTranslation(["common","generation"]),Nt={tab:"p-2 -m-2 [&:not([data-selected])]:text-[rgb(var(--fg-color)/.4)] cursor-pointer",content:"flex-1 flex flex-col overflow-hidden"},At=useBreakpoint("mlg"),[$t,Dt]=useLocalStorage({key:"generator-task-panel-open",defaultValue:!1}),Ft=$t||At,Bt=reactExports.useMemo(()=>Ft?"mmd:w-80":"mmd:w-28",[Ft]),[Ot,Qt]=reactExports.useState(!1),[,Wt]=useAtom(searchKeywordAtom);reactExports.useEffect(()=>{(!Ft||!Ot)&&Wt("")},[Ft,Ot]);const Xt=hr=>{Wt(hr),track("task_search_commit",{scene:"generator"})},[Kt,Jt]=useAtom(gridSizeAtom);return jsxRuntimeExports.jsxs($5e8ad37a45e1c704$export$b2539bed5023c21c,{selectedKey:St,onSelectionChange:hr=>{track("i2i_left_tab_click",{label:hr}),Tt(hr)},className:cx("flex flex-col overflow-hidden",lt),style:{"--grid-size":Kt,...ut},children:[jsxRuntimeExports.jsxs($28f4fd908f0de97f$export$74a362b31437ec83,{className:"flex-none flex p-2",isExpanded:Ft,onExpandedChange:hr=>{Dt(hr),Tt("tasks")},children:[jsxRuntimeExports.jsx($28f4fd908f0de97f$export$feabaa331e1d464c,{children:jsxRuntimeExports.jsxs($5e8ad37a45e1c704$export$e51a686c67fdaa2d,{className:"flex-none flex gap-4 p-2",children:[jsxRuntimeExports.jsx($5e8ad37a45e1c704$export$3e41faf802a29e71,{id:"tasks",className:Nt.tab,children:Mt("generation:tasks.label")}),kt&&jsxRuntimeExports.jsx($5e8ad37a45e1c704$export$3e41faf802a29e71,{id:"favorites",className:Nt.tab,children:jsxRuntimeExports.jsx(Text,{i18nKey:"user:profile-sub-tab.favorites.label"})})]})}),!Ft&&jsxRuntimeExports.jsx("div",{className:"p-2",children:Mt("generation:tasks.label")}),jsxRuntimeExports.jsx("span",{className:"mx-auto"}),Ft&&jsxRuntimeExports.jsxs("span",{className:"inline-flex overflow-hidden rounded-lg",children:[St==="tasks"?jsxRuntimeExports.jsx("button",{className:"inline-grid place-content-center p-2 active:bg-black/10 dark:active:bg-white/10 rounded transition",onClick:()=>{Qt(hr=>!hr),track("task_search_toggle",{open:!Ot,scene:"generator"})},children:jsxRuntimeExports.jsx(icBaselineSearch,{})}):null,jsxRuntimeExports.jsx(FitToggle,{localStorageKey:"generator-task-panel-fit"}),jsxRuntimeExports.jsx("button",{disabled:Kt===GRID_SIZE_MAX,className:"inline-grid place-content-center p-2 pr-1 active:bg-black/10 dark:active:bg-white/10 rounded disabled:opacity-40 transition",onClick:()=>{Jt(hr=>Math.min(GRID_SIZE_MAX,hr+1))},children:jsxRuntimeExports.jsx(icRoundMinus,{className:"size-5"})}),jsxRuntimeExports.jsx("button",{disabled:Kt===GRID_SIZE_MIN,className:"inline-grid place-content-center p-2 pl-1 active:bg-black/10 dark:active:bg-white/10 rounded disabled:opacity-40 transition",onClick:()=>{Jt(hr=>Math.max(GRID_SIZE_MIN,hr-1))},children:jsxRuntimeExports.jsx(icRoundPlus,{className:"size-5"})})]}),jsxRuntimeExports.jsx($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{slot:"trigger",className:"-mr-1 p-2 active:bg-black/10 dark:active:bg-white/10 rounded-lg transition",children:!At&&(Ft?jsxRuntimeExports.jsx(icRoundKeyboardDoubleArrowLeft,{className:"size-5"}):jsxRuntimeExports.jsx(icRoundKeyboardDoubleArrowRight,{className:"size-5"}))})]}),vt&&jsxRuntimeExports.jsx($5e8ad37a45e1c704$export$3d96ec278d3efce4,{id:"tasks",className:cx(Nt.content,"!overflow-auto",Bt),children:jsxRuntimeExports.jsxs(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(Preloader,{}),children:[Ft&&Ot?jsxRuntimeExports.jsx("div",{className:"my-px mx-2",children:jsxRuntimeExports.jsx(OutlinedInput,{fullWidth:!0,size:"small",placeholder:Mt("common:search"),onKeyDown:hr=>{hr.key==="Enter"&&Xt(hr.currentTarget.value)},onBlur:hr=>{Xt(hr.currentTarget.value)}})}):null,jsxRuntimeExports.jsx(TaskList,{allowedTypes:He,scene:Qe,className:"flex-1",collapsed:!Ft,afterClick:it,onSelectItem:dt,enableClickToImportTask:xt,enableBatchMediaSelect:ft})]})}),kt&&jsxRuntimeExports.jsx($5e8ad37a45e1c704$export$3d96ec278d3efce4,{id:"favorites",className:cx(Nt.content,Bt),children:jsxRuntimeExports.jsx(FavTaskMediaList,{scene:Qe,className:"flex-1",onSelectItem:dt,enableClickToImportTask:xt})})]})}function TaskList(He){const Qe=useWsConnectionStatus(),{data:{samplingMethods:it}={}}=useDynamicConstants(),{data:lt}=useUserInfo(),ut=useAtomValue(searchKeywordAtom),[dt,xt]=useAtom(myTasksAtom),{hasMore:ft,loadMore:vt,loading:kt,reset:St}=ut&&lt?.id?usePaginatedData({fetcher:fetchListUserTasks,getArgs:Qt=>({userId:lt.id,keyword:ut,before:Qt?.data?.tasks?.pageInfo.startCursor,last:30,parameterFields:taskParameterFieldsForTaskList}),getItems:Qt=>compact(Qt.data.tasks?.edges?.map(Wt=>Wt?.node)),getHasMore:Qt=>Qt.data.tasks?.pageInfo.hasPreviousPage??!1,customState:{items:dt,setItems:xt}}):usePaginatedData({fetcher:fetchListMyTasks,getArgs:Qt=>({before:Qt?.data?.me?.tasks?.pageInfo.startCursor,last:30,parameterFields:taskParameterFieldsForTaskList}),getItems:Qt=>compact(Qt?.data.me?.tasks?.edges?.map(Wt=>Wt?.node)),getHasMore:Qt=>Qt?.data.me?.tasks?.pageInfo.hasPreviousPage??!1,customState:{items:dt,setItems:xt}});reactExports.useEffect(()=>{St()},[ut]);const Tt=reactExports.useMemo(()=>dt.filter(Qt=>{if(!He.allowedTypes)return!0;const Wt=$$3(Qt).returnType().with({parameters:{animateDiff:{enabled:!0}}},()=>"animated").with(N$4.when(isI2vProTask),()=>"i2vPro").with(N$4.when(isT2I2VTask),()=>"t2i2v").otherwise(()=>"image");return He.allowedTypes.includes(Wt)}).map(Qt=>isWorkflowTask(Qt)&&Qt.outputs.batch?.length?compact(Qt.outputs.batch.map(Wt=>Wt.deletedAt?void 0:{...Qt,media:void 0,outputs:{...Qt.outputs,batch:void 0,...Wt}})):Qt).flat().sort((Qt,Wt)=>Wt.createdAt<Qt.createdAt?-1:1),[dt,He.allowedTypes]),[Mt,Nt]=reactExports.useState(!1),[At,$t]=reactExports.useState(!1),Dt=reactExports.useRef(),Ft=reactExports.useCallback(Qt=>{Qt?$t(!0):(window.clearTimeout(Dt.current),Dt.current=window.setTimeout(()=>{$t(!1)},100))},[$t]);useDebounce(()=>{Mt&&ft&&!kt&&vt()},100,[vt,ft,Mt,kt]),reactExports.useEffect(()=>{if(!ut)if(Qe){const Qt=$taskUpdated.subscribe(Wt=>{xt(Xt=>uniqBy([Wt,...Xt],"id"))});return()=>{Qt.unsubscribe()}}else{const Qt=window.setInterval(async()=>{const Wt=await fetchListMyTasks({last:30,parameterFields:taskParameterFieldsForTaskList}),Xt=compact(Wt.data?.me?.tasks?.edges?.map(Kt=>Kt?.node));xt(Kt=>uniqBy([...Xt,...Kt],"id"))},5e3);return()=>window.clearInterval(Qt)}},[xt,ut,Qe]);const{t:Bt}=useTranslation(["generation"]),Ot=useAtomValue(gridSizeAtom);return jsxRuntimeExports.jsx(ItemList,{items:Tt,itemContent:Qt=>jsxRuntimeExports.jsx(TaskInListItem,{task:Qt,columns:He.collapsed?1:Ot,onSelectItem:He.onSelectItem&&(Wt=>{track("image_click",{from:"task",scene:He.scene},{destinations:["getway"]}),He.onSelectItem?.(Wt)}),enableClickToImportTask:He.enableClickToImportTask,enableBatchMediaSelect:He.enableBatchMediaSelect,allowedSamplingMethods:it}),columns:He.collapsed?1:Ot,groups:uniq(Tt.map(Qt=>groupByTime(Qt.createdAt,He.collapsed))),groupSorter:Qt=>groupByTime(Qt.createdAt,He.collapsed),groupHeaderContent:Qt=>Bt(GROUPS[Qt])||Qt,footerContent:jsxRuntimeExports.jsx(ListFooter,{loading:kt,hasMore:ft}),className:He.className,style:He.style,classes:{groupHeader:cx("px-2 py-1 text-sm text-[color:rgb(var(--fg-color)/.8)]","bg-background/80 backdrop-blur",He.collapsed&&"whitespace-nowrap"),row:"px-2 py-1 gap-2"},atBottomStateChange:Nt,isScrollingStateChange:Ft})}function useImportTask(He){const{task:Qe,allowedSamplingMethods:it}=He,lt=(Qe?.outputs.batch??[""]).length,ut=getBaseMediaIdFromTask(Qe),{data:dt,loading:xt}=useGetMedia(ut??skipToken),ft=useModelVersion(Qe?.parameters.modelId),{state:vt}=reactExports.useContext(GeneratorContext),[,kt]=reactExports.useContext(GeneratedItemsContext),St=reactExports.useContext(FillEditorContext),[,Tt]=reactExports.useContext(ImageEditorContext),{setValues:Mt}=useTaskSubmitFormContext(),[,Nt]=reactExports.useContext(LastImportedItemContext),At=vt.mode===GeneratorMode.Fill;return useAsyncFn(async()=>{if(!Qe)return;if(xt)return toast.info("Still Loading…");if(At){if(Qe.status!=="completed")return;let Dt=Qe.media;if(!Dt&&Qe.outputs?.mediaId&&(Dt=await fetchGetMedia({id:Qe.outputs.mediaId}).then(Ft=>Ft.data.media)),!Dt)return;try{lt>1&&(Dt=await dialogSelectImageFromBatch((Qe.outputs.batch??[]).map(Ft=>Ft.mediaId)))}catch(Ft){Ft!==UserCancelled&&toast.error(Ft.message);return}St.current.setBaseImageFromMedia(Dt,{task:Qe,cate:"task"}),kt(getTaskAndMediaIds(Qe)??[]);return}const $t=parseInitialTaskFormState({task:Qe,baseImageMedia:dt,allowedSamplingMethods:it});kt(getTaskAndMediaIds(Qe)??[]),Mt($t),Tt(Dt=>({...Dt,dirty:!0})),Nt(Qe.id)},[Qe,At,dt,xt,ft?.id,it])}function TaskInListItem({task:He,className:Qe,style:it,columns:lt,allowedSamplingMethods:ut,enableClickToImportTask:dt,onSelectItem:xt,enableBatchMediaSelect:ft}){const vt=useFit("generator-task-panel-fit"),kt=He.parameters.batchSize??!1,St=(He.outputs.batch??[""]).length,Tt=kt?He.outputs.batch?.find(Kt=>Kt.deletedAt==null)?.mediaId:isWorkflowTask(He)?He.outputs.mediaId:void 0,{data:Mt}=useGetMedia(Tt??skipToken),Nt=Mt??He.media,At=isAnimateDiffTask(He),[$t,Dt]=reactExports.useState(!0),Ft=Kt=>{At&&Dt(Kt)},[Bt]=reactExports.useContext(GeneratedItemsContext),[Ot]=reactExports.useContext(LastImportedItemContext),[Qt,Wt]=useImportTask({task:He,allowedSamplingMethods:ut}),Xt=reactExports.useMemo(()=>Bt.length?(()=>{const Kt=Bt[0];return Kt.taskType==="workflow"?Kt.taskId===He.id&&Kt.mediaId===Tt:Kt.taskId===He.id})():Ot===He.id,[Bt,Ot,Tt,He.id]);return jsxRuntimeExports.jsx("button",{disabled:Qt.loading,className:cx("w-full aspect-square rounded overflow-hidden relative",!Nt&&"flex items-center justify-center text-gray-400",Xt&&"ring-2 ring-offset-1 ring-theme-primary ring-offset-background-light",Qe),style:it,onMouseEnter:()=>Ft(!1),onMouseLeave:()=>Ft(!0),onClick:async()=>{if(dt&&Wt(),St===1||!ft)xt?.({task:He,media:Nt});else{const Kt=await dialogSelectImageFromBatch(He.outputs.batch.map(Jt=>Jt.mediaId)).catch(noop$6);Kt&&xt?.({task:He,media:Kt})}},children:Nt?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(MediaPreview$1,{className:cx("w-full h-full",!xt&&!dt&&"cursor-default"),mediaId:Nt.id,preferStill:$t,fit:vt,thumbnail:!0}),lt<=5&&jsxRuntimeExports.jsx(TaskItemIndicatorIcon,{task:He}),lt<=4&&jsxRuntimeExports.jsx(TaskItemPublishIcon,{task:He})]}):jsxRuntimeExports.jsx(TaskPlaceholderImage,{id:He.id,status:He.status,className:"w-full h-full",withDescription:!1,icon:He.status==="failed"?jsxRuntimeExports.jsx(icBaselineImageNotSupported,{className:"size-6"}):void 0})})}function FavTaskMediaList(He){const{data:{samplingMethods:Qe}={}}=useDynamicConstants(),{items:it,hasMore:lt,loading:ut,loadMore:dt}=usePaginatedData({fetcher:client.listMyBookmarkItems,getItems:At=>getNodesFromConnection(At?.me?.defaultBookmark?.items),getArgs:At=>({types:[RefType.Task],orderBy:"-createdAt",first:30,after:At?.me?.defaultBookmark?.items?.pageInfo.endCursor}),getHasMore:At=>At.me?.defaultBookmark?.items?.pageInfo.hasNextPage}),[xt,ft]=reactExports.useState(!1),vt=reactExports.useRef(!1),kt=reactExports.useMemo(()=>debounce(()=>{vt.current=!1},200),[]);reactExports.useEffect(()=>{xt&&!ut&&lt&&dt()},[xt,ut,lt,dt]);const[St]=reactExports.useContext(GeneratedItemsContext),[Tt,Mt]=reactExports.useState();reactExports.useEffect(()=>{St.find(At=>At.taskId===Tt?.task?.id)||Mt(void 0)},[St]);const Nt=useAtomValue(gridSizeAtom);return jsxRuntimeExports.jsx(ItemList,{items:it,groups:uniq(it.map(At=>groupByTime(At.createdAt))),groupSorter:At=>groupByTime(At.createdAt),groupHeaderContent:At=>jsxRuntimeExports.jsx(Text,{i18nKey:GROUPS[At],defaults:At}),columns:Nt,className:He.className,style:He.style,classes:{groupHeader:cx("px-2 py-1 text-sm text-[color:rgb(var(--fg-color)/.8)]","bg-background/80 backdrop-blur"),row:"px-2 py-1 gap-2"},itemContent:At=>jsxRuntimeExports.jsx(FavTaskMediaListItem,{setLastClickedItem:Mt,scene:He.scene,lastClickedItem:Tt,item:At,allowedSamplingMethods:Qe,enableClickToImportTask:He.enableClickToImportTask,onSelectItem:He.onSelectItem}),footerContent:jsxRuntimeExports.jsx(ListFooter,{loading:ut,hasMore:lt}),atBottomStateChange:ft,isScrollingStateChange:At=>{At&&(vt.current=!0,kt())}})}function FavTaskMediaListItem(He){const{item:Qe,lastClickedItem:it,setLastClickedItem:lt}=He,ut=Qe.media??Qe.task?.media,[dt,xt]=useImportTask({task:Qe.task,allowedSamplingMethods:He.allowedSamplingMethods});return jsxRuntimeExports.jsx(ListItem$1,{disabled:dt.loading,media:ut,selected:Qe.id===it?.id,onClick:()=>{track("image_click",{from:"favorite",scene:He.scene},{destinations:["getway"]}),lt(Qe),He.enableClickToImportTask&&xt(),He.onSelectItem?.({task:Qe.task,media:ut})},children:Qe.task&&jsxRuntimeExports.jsx(TaskItemIndicatorIcon,{task:Qe.task,types:["animated","workflow","i2vPro","t2i2v"]})})}function ListItem$1(He){const{data:Qe=He.media,loading:it}=useGetMedia(He.media?skipToken:He.mediaId??skipToken),lt=useFit("generator-task-panel-fit"),[ut,dt]=reactExports.useState(!1);return jsxRuntimeExports.jsxs("button",{type:"button",disabled:He.disabled??it,className:cx("relative w-full aspect-square overflow-hidden rounded ring-1 ring-black/5 dark:ring-white/5 shadow",!Qe&&"flex items-center justify-center text-neutral-400",He.selected&&"outline outline-2 outline-offset-1 outline-theme-primary",He.className),style:He.style,onMouseEnter:()=>dt(!0),onMouseLeave:()=>dt(!1),onClick:()=>He.onClick?.(),children:[Qe?jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:Qe.id,preferStill:!ut,fit:lt,thumbnail:!0,className:cx("size-full",!He.onClick&&"cursor-default")}):He.placeholder,He.children]})}function ListFooter(He){const{t:Qe}=useTranslation(["common"]);return jsxRuntimeExports.jsx("div",{className:"box-content mx-2 py-4 flex justify-center items-center",children:He.hasMore?He.loading?jsxRuntimeExports.jsx(Preloader,{inline:!0,style:{transform:"scale(0.7619)"}}):null:jsxRuntimeExports.jsx("span",{className:"opacity-50",children:Qe("common:list-reached-the-end")})})}function TaskItemIndicatorIcon(He){const Qe=$$3(He.task).with({parameters:{animateDiff:{enabled:!0}}},()=>!He.types||He.types.includes("animated"),()=>jsxRuntimeExports.jsx(fluentSparkle16Filled,{className:"size-3.5"})).with({parameters:N$4.when(it=>(it.upscale>1||it.enlarge>1)&&it.mediaId)},()=>!He.types||He.types.includes("upscale"),()=>jsxRuntimeExports.jsx(mdiImageSizeSelectLarge,{className:"size-3.5"})).with({parameters:{batchSize:N$4.select(4)}},it=>!He.types||He.types.includes("batch"),it=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{className:"pl-0.5 text-xs",children:it}),jsxRuntimeExports.jsx(icBaselinePhotoSizeSelectActual,{className:"size-3.5"})]})).with({parameters:{batchSize:3}},()=>!He.types||He.types.includes("variation"),()=>jsxRuntimeExports.jsx(icBaselineCallSplit,{className:"size-3.5"})).with(N$4.when(isWorkflowTask),()=>!He.types||He.types.includes("workflow"),()=>jsxRuntimeExports.jsx(WorkflowIcon,{className:"size-3.5"})).with(N$4.when(isI2vProTask),()=>!He.types||He.types.includes("i2vPro"),()=>jsxRuntimeExports.jsx(riVideoAiLine,{className:"size-3.5"})).with(N$4.when(isT2I2VTask),()=>!He.types||He.types.includes("t2i2v"),()=>jsxRuntimeExports.jsx(riVideoAiLine,{className:"size-3.5"})).with(N$4.when(isChatTask),()=>!He.types||He.types.includes("chat"),()=>jsxRuntimeExports.jsx(icOutlineChat,{className:"size-3.5"})).otherwise(()=>null);return Qe?jsxRuntimeExports.jsx("div",{className:"absolute bottom-1 right-1 flex items-center gap-0.5 w-fit text-sm text-white rounded p-0.5 leading-4 bg-black/60 font-medium",children:Qe}):null}function TaskItemPublishIcon(He){const Qe=getTaskPublishedCount(He.task)??0;return Qe>0?jsxRuntimeExports.jsxs("div",{className:"absolute bottom-1 left-1 flex items-center gap-0.5 w-fit text-sm text-white rounded p-0.5 leading-4 bg-black/60 font-medium",children:[jsxRuntimeExports.jsx(mdiEarth,{className:"size-3.5"}),jsxRuntimeExports.jsx("span",{className:"pr-0.5 text-xs",children:Qe})]}):null}const ButtonPanelDrawerProps={PaperProps:{className:"max-h-[calc(100%-160px)] overflow-y-visible"},slotProps:{backdrop:{className:"bg-black/80"}}};function TaskHistoryButtonPanel({onSelectItem:He,enableBatchMediaSelect:Qe,enableClickToImportTask:it,trigger:lt,DrawerProps:ut}){const[dt,xt]=reactExports.useState(!1),ft=useBreakpoint("mlg"),vt=reactExports.useCallback(()=>xt(!1),[]),kt=reactExports.useCallback(()=>xt(!0),[]),St=reactExports.useCallback(Tt=>He?He({onClose:vt,item:Tt}):vt(),[He]);return ft?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[lt({onOpen:kt}),jsxRuntimeExports.jsx(Drawer,{anchor:"bottom",open:dt,onClose:vt,...ButtonPanelDrawerProps,...ut,children:jsxRuntimeExports.jsx(DrawerWrapper,{onClose:vt,children:jsxRuntimeExports.jsx(TaskAndFavTabs,{onSelectItem:St,enableClickToImportTask:it,enableBatchMediaSelect:Qe,className:"supports-[height:100dvh]:h-[(calc(100dvh-160px)] h-[calc(var(--visible-height)-160px)]"})})})]}):null}function DrawerWrapper(He){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{className:"absolute right-0 -translate-y-10 mr-3 ml-auto",onClick:He.onClose,children:jsxRuntimeExports.jsx(fluentDismiss24Filled,{className:"size-6 text-neutral-400 dark:text-neutral-500"})}),He.children]})}function JoinMembershipBanner(He){const{t:Qe}=useTranslation(["growth"]),it=useDiscountBannerConditions()==="common",{beingMember:lt}=useMe(),ut=useExperimentParam("exp2509-high-priority-banner-text-ab"),{values:dt}=useTaskSubmitFormContext(),xt=dt?.priority===TASK_PRIORITIES.default,ft=Qe(it?"growth:join-membership.banner.common-discount-content":"growth:join-membership.banner.content");return lt?null:jsxRuntimeExports.jsx("aside",{className:cx("bg-gradient-purple-pink rounded-xl p-[2px] gap-1",He.className),children:jsxRuntimeExports.jsxs("div",{className:cx("bg-background rounded-[10.5px] flex items-center","gap-3 px-3 py-[11px] dense:gap-1 dense:px-2 dense:py-2"),children:[jsxRuntimeExports.jsx("p",{className:"text-sm",children:xt?ft:Qe("growth:join-membership.banner.content",{context:ut})}),jsxRuntimeExports.jsx("button",{className:cx("bg-gradient-purple-pink text-white ml-auto rounded-lg shrink-0 hover:no-underline","px-5 py-2 dense:px-2 dense:py-1"),onClick:()=>{openMembershipMoreCreditsModal({defaultMode:"plans",trackingLocation:"panel-bottom-bar"})},children:Qe("growth:join-membership.banner.label")})]})})}const GeneratorStage=reactExports.memo(function He(Qe){const[it]=reactExports.useContext(GeneratedItemsContext),{data:lt}=useTaskById(it[0]?.taskId??skipToken),{width:ut=512,height:dt=512}=lt?.parameters??lt?.outputs.detailParameters??{};return jsxRuntimeExports.jsxs("div",{className:cx("relative bg-background flex flex-col mmd:flex-col-reverse bg-[length:20px_20px] bg-repeat bg-dot-pattern",Qe.className),style:Qe.style,children:[jsxRuntimeExports.jsxs("div",{className:cx("flex-1 flex flex-col mlg:p-2",it.length>0&&"p-2"),children:[jsxRuntimeExports.jsxs("div",{className:cx("flex-1 flex relative flex-col mlg:flex-row"),children:[it.length===0?jsxRuntimeExports.jsx("div",{className:"flex-1"}):lt?jsxRuntimeExports.jsx(StageGrid,{itemWidth:ut,itemHeight:dt,items:it},lt.id):jsxRuntimeExports.jsx(Preloader,{inline:!0,className:"m-auto"}),jsxRuntimeExports.jsx("div",{className:"items-end mlg:absolute mlg:-right-2 mlg:bottom-0",children:Qe.action})]}),Qe.toolbar&&jsxRuntimeExports.jsx("div",{className:"flex-none",children:Qe.toolbar}),jsxRuntimeExports.jsx(JoinMembershipBanner,{className:"hidden mlg:block w-full"})]}),jsxRuntimeExports.jsx(GeneratedTaskPublishDialog,{}),jsxRuntimeExports.jsx(GeneratedTaskUpscaleDialog,{}),jsxRuntimeExports.jsx(GeneratedTaskVariationDialog,{}),jsxRuntimeExports.jsx(GeneratedTaskCaptioningDialog,{}),jsxRuntimeExports.jsx(GeneratorStageOverlay,{})]})});function StageGrid(He){const[Qe,it]=reactExports.useState(He.items.length),[lt,ut]=reactExports.useState(1),dt=useBreakpoint("mlg","up"),[xt,ft]=reactExports.useState(He.itemWidth),[vt,kt]=reactExports.useState(He.itemHeight);function St($t){($t.width??0)*($t.height??0)>0&&(ft($t.width),kt($t.height))}const[Tt,Mt]=reactExports.useState(null),[Nt,At]=reactExports.useState(()=>[0,0]);return reactExports.useEffect(()=>{const $t=new ResizeObserver(()=>{if(!Tt)return;const{width:Dt,height:Ft}=Tt.getBoundingClientRect();At([Dt,Ft])});return Tt&&$t.observe(Tt),()=>$t.disconnect()},[Tt]),reactExports.useEffect(()=>{const{rows:$t,cols:Dt}=calcGrid(Nt,[xt??0,vt??0],He.items.length,16);it($t),ut(Dt)},[Nt,vt,xt,He.items.length]),jsxRuntimeExports.jsx(Gallery,{options:{initialZoomLevel:"fit",secondaryZoomLevel:2,maxZoomLevel:"fill"},uiElements:pswpUiElementsForTaskDisplay(),children:jsxRuntimeExports.jsx("div",{ref:Mt,className:cx("flex-1 px-8 mmd:px-0","pb-2","grid gap-4 dense:gap-2 grid-cols-1 mlg:grid-cols-[repeat(var(--grid-cols),1fr)] max-mlg:auto-rows-auto mlg:grid-rows-[repeat(var(--grid-rows),1fr)]","isolate"),style:{"--grid-rows":Qe,"--grid-cols":lt},children:He.items.map(($t,Dt)=>a$3({taskId:N$4.string,mediaId:N$4.optional(N$4.string),deleted:N$4.optional(N$4.boolean),bookmarked:N$4.optional(N$4.boolean)},$t)&&jsxRuntimeExports.jsx(ContentFittableBox,{ratio:(xt||He.itemWidth)/(vt||He.itemHeight),maxWidth:xt||He.itemWidth,maxHeight:vt||He.itemHeight,alignment:dt&&lt===2?["bottom-right","bottom-left","top-right","top-left"][Dt]:"center",static:!dt,className:"hover:z-20",children:jsxRuntimeExports.jsx("div",{className:"h-full ring-1 ring-black/10 rounded-md shadow-md hover:shadow-lg !shadow-black/20 transition",children:jsxRuntimeExports.jsx(GeneratedItem,{...$t,itemsCount:He.items.length,idx:Dt,onMediaLoad:St})})},`${$t.taskId}-${Dt}`))})})}function ContentFittableBox(He){const Qe=He.alignment?.split("-")??["center"];Qe.length<2&&Qe.push("center");const it=Qe.map(lt=>({top:"mt-0",bottom:"mb-0",left:"ml-0",right:"mr-0"})[lt]).join(" ");return jsxRuntimeExports.jsx("div",{className:cx("relative",He.className),style:{...He.style},children:jsxRuntimeExports.jsx("div",{className:cx(!He.static&&"absolute inset-0","m-auto",it),style:{aspectRatio:He.ratio,maxWidth:`min(100%, ${He.maxWidth?He.maxWidth+"px":"100%"})`,maxHeight:`min(100%, ${He.maxHeight?He.maxHeight+"px":"100%"})`},children:He.children})})}function GeneratorStageOverlay(){const He=document.getElementById("workbench-generate-button-intersector"),[Qe,it]=reactExports.useState(!1),lt=new IntersectionObserver(([dt])=>{it(dt.intersectionRatio>=1)},{threshold:1});reactExports.useEffect(()=>{if(He)return lt.observe(He),()=>{lt.unobserve(He)}},[!!He]);const ut=document.getElementById(WORKBENCH_OVERLAY_ID);return jsxRuntimeExports.jsx(WorkbenchLayoutPortal,{children:jsxRuntimeExports.jsx("div",{style:{"--offset-height":Qe?"192px":"60px"},className:"absolute mlg:hidden transition right-3 transform translate-y-[calc(100dvh-var(--offset-height))] flex flex-col gap-3",children:jsxRuntimeExports.jsx(TaskHistoryButtonPanel,{trigger:({onOpen:dt})=>jsxRuntimeExports.jsx("button",{className:"w-fit p-3 rounded-full bg-black/60",onClick:()=>{dt(),track("panel_history_click")},children:jsxRuntimeExports.jsx(icRoundAccessTime,{className:"text-white size-6"})}),DrawerProps:{container:ut},enableClickToImportTask:!0})})})}function calcGrid(He,Qe,it,lt){const[ut,dt]=He,xt=Qe[0]/Qe[1];let ft=1/0;const vt={};for(let kt=1;kt<=it;kt++){const St=Math.ceil(it/kt);if(kt*St-it>=St)continue;const Tt=(ut-lt*(St+1))/St,Mt=(dt-lt*(kt+1))/kt,Nt=Tt/Mt,At=Math.abs(Nt-xt);At<ft&&(ft=At,Object.assign(vt,{rows:kt,cols:St}))}return vt}function useLike(He,Qe,it){const[lt,ut]=reactExports.useState(He),[dt,xt]=reactExports.useState(!it);He!==lt&&(ut(He),xt(!it));const{data:ft,refetch:vt}=useGetArtwork(Qe===RefType.Artwork?He??skipToken:skipToken,{fetchPolicy:dt?"cache-and-network":"cache-first"}),{data:kt,mutate:St}=useGenerationModel(Qe===RefType.Model?He:void 0),Tt=(Qe===RefType.Artwork?ft?.liked:kt?.liked)??it?.liked,Mt=(Qe===RefType.Artwork?ft?.likedCount:kt?.likedCount)??it?.likedCount,Nt=Qe===RefType.Artwork?vt:St,[At,$t]=reactExports.useState(!1),Dt=Tt!=null&&At?!Tt:Tt,Ft=Mt!=null&&At?Mt+(Dt?1:-1):Mt;async function Bt(Ot=!Tt){if(!(!He||!Qe)){switch(xt(!0),$t(!0),Qe){case RefType.Artwork:await executeMarkArtwork({artworkId:He,type:MarkType.Like,target:Ot});break;case RefType.Model:await client.markGenerationModel({modelId:He,type:GenerationModelMarkType.Like,target:Ot});break}await Nt(),$t(!1)}}return[{liked:Dt,count:Ft,optimistic:At},Bt]}const fluentBookmark20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M4 4.5A2.5 2.5 0 0 1 6.5 2h7A2.5 2.5 0 0 1 16 4.5v13a.5.5 0 0 1-.794.404L10 14.118l-5.206 3.786A.5.5 0 0 1 4 17.5z"})}),fluentBookmarkAdd20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 5.5a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0m-4-2a.5.5 0 0 0-1 0V5h-1.5a.5.5 0 0 0 0 1H14v1.5a.5.5 0 0 0 1 0V6h1.5a.5.5 0 0 0 0-1H15zm-.5 7.5a5.5 5.5 0 0 0 1.5-.207V17.5a.5.5 0 0 1-.794.404L10 14.118l-5.206 3.786A.5.5 0 0 1 4 17.5v-13A2.5 2.5 0 0 1 6.5 2h3.757a5.5 5.5 0 0 0 4.243 9"})}),fluentChevronLeft20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12.269 15.794a.75.75 0 0 1-1.06-.026l-5.002-5.25a.75.75 0 0 1 0-1.035l5.001-5.25a.75.75 0 1 1 1.086 1.034l-4.508 4.734l4.508 4.733a.75.75 0 0 1-.025 1.06"})}),fluentChevronRight20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7.733 4.207a.75.75 0 0 1 1.06.026l5.001 5.25a.75.75 0 0 1 0 1.035l-5 5.25a.75.75 0 1 1-1.087-1.034L12.216 10l-4.51-4.734a.75.75 0 0 1 .027-1.06"})}),fluentFlag20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M5 13h11.5a.5.5 0 0 0 .416-.777L14.101 8l2.815-4.223A.5.5 0 0 0 16.5 3h-12a.5.5 0 0 0-.5.5v14a.5.5 0 0 0 1 0zm0-1V4h10.566l-2.482 3.723a.5.5 0 0 0 0 .554L15.566 12z"})}),fluentImageArrowForward20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M5.5 10a4.5 4.5 0 1 1 0-9a4.5 4.5 0 0 1 0 9m.896-6.396l.897.896H5.75A2.75 2.75 0 0 0 3 7.25v.25a.5.5 0 0 0 1 0v-.25c0-.966.784-1.75 1.75-1.75h1.543l-.897.896a.5.5 0 1 0 .708.708L8.856 5.35a.5.5 0 0 0-.002-.705l-1.75-1.75a.5.5 0 1 0-.708.708M3 10.4q.476.244 1 .393V14c0 .373.102.722.28 1.02l4.669-4.588a1.5 1.5 0 0 1 2.102 0l4.67 4.588A2 2 0 0 0 16 14V6a2 2 0 0 0-2-2h-3.207a5.5 5.5 0 0 0-.393-1H14a3 3 0 0 1 3 3v8a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3zm11-2.9a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m-1 0a.5.5 0 1 0-1 0a.5.5 0 0 0 1 0m-8.012 8.226A2 2 0 0 0 6 16h8c.37 0 .715-.1 1.012-.274l-4.662-4.58a.5.5 0 0 0-.7 0z"})}),icBaselineFileDownload=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 9h-4V3H9v6H5l7 7l7-7zM5 18v2h14v-2H5z"})}),icBaselineRateReview=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 14v-2.47l6.88-6.88c.2-.2.51-.2.71 0l1.77 1.77c.2.2.2.51 0 .71L8.47 14H6zm12 0h-7.5l2-2H18v2z"})}),ModelDetailContext=reactExports.createContext(void 0),fluentWarning20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M8.681 2.785c.568-1.047 2.071-1.047 2.638 0l6.5 12.002A1.5 1.5 0 0 1 16.502 17H3.498a1.5 1.5 0 0 1-1.319-2.215zM10.5 7.5a.5.5 0 0 0-1 0v4a.5.5 0 0 0 1 0zm.25 6.25a.75.75 0 1 0-1.5 0a.75.75 0 0 0 1.5 0"})});function RequiredMark(){return jsxRuntimeExports.jsx("span",{className:"text-red-500 ml-1",title:"Required",children:"*"})}const getSelectionLabel=(He,Qe)=>$$3(Qe).with(GenerationModelType.Lora,GenerationModelType.UnknownLora,GenerationModelType.MultiLora,()=>He("market:model.type.lora")).with(GenerationModelType.SdV1Model,GenerationModelType.UnknownModel,()=>He("market:model.type.sdv1model")).with(GenerationModelType.SdxlLora,()=>He("market:model.type.sdxllora")).with(GenerationModelType.SdxlModel,()=>He("market:model.type.sdxlmodel")).otherwise(()=>He("market:model.type.unknown")),allowedModelTypes=[GenerationModelType.UnknownLora,GenerationModelType.UnknownModel],headingStyle=ce$1({base:"col-span-full mt-8 first:mt-0 text-base font-semibold text-black dark:text-white"});function ModelInfoForm(He){const{values:Qe,handleChange:it,isEditing:lt}=He,[ut,dt]=reactExports.useState(!1),[xt,ft]=reactExports.useState(()=>Qe.media),{t:vt}=useTranslation(["market","common","action","artwork"]),{title:kt,extra:St,tags:Tt,isDownloadable:Mt,isPrivate:Nt,type:At,agreeCoverImage:$t,agreeNonMinor:Dt}=Qe,Ft=reactExports.useRef(Qe);reactExports.useEffect(()=>{Ft.current=Qe},[Qe.modelId]);const Bt=Ft.current??Qe,Ot=reactExports.useRef(null);reactExports.useEffect(()=>{if(He.highlightId){const Wt=Ot.current?.querySelector(`[data-highlight-id="${He.highlightId}"]`);Wt&&(Wt.dataset.highlighted="")}},[He.highlightId]);const Qt=useLoraCategories();return jsxRuntimeExports.jsx("div",{ref:Ot,className:cx("@container/form","text-sm",He.className),children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 @[600px]/form:grid-cols-[2fr_1fr] grid-flow-dense gap-4",children:[lt&&jsxRuntimeExports.jsxs("div",{className:"@[800px]/form:col-start-2 flex flex-col gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-primary",children:vt("market:submit.model-cover.title")}),jsxRuntimeExports.jsx(UploadImage,{value:xt,onChange:Wt=>{Wt&&(ft(Wt),it("media")(Wt))},onUpload:dt,placeholderElement:jsxRuntimeExports.jsx(UploadImagePlacerholder,{}),dropzoneOptions:{accept:{"image/jpeg":[],"image/png":[],"image/webp":[]},noKeyboard:!0},preHandleImage:async Wt=>await dialogCropImage({file:Wt})??Wt,className:"relative",fileHandleElement:({action:Wt})=>jsxRuntimeExports.jsx("div",{className:"absolute bottom-4 font-sans",children:jsxRuntimeExports.jsx(CropCurrentImageForUploadButton,{media:Qe.media,action:Wt})})})]}),jsxRuntimeExports.jsxs("div",{className:"col-start-1 flex flex-col gap-4 mt-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-primary",children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.model-form.name"})}),jsxRuntimeExports.jsx(TextField,{size:"small",value:kt,onChange:it("title"),required:!0})]}),!isUserLora(Qe.type)&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-primary",children:[jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.model-type"}),jsxRuntimeExports.jsx(RequiredMark,{})]}),jsxRuntimeExports.jsx(FormControl,{required:!0,children:jsxRuntimeExports.jsx(Select,{size:"small",value:Qe.type??"",onChange:Wt=>{it("type")(Wt),isLora(Wt)||it("category")(null)},disabled:lt,children:(lt?[Qe.type]:allowedModelTypes).map(Wt=>jsxRuntimeExports.jsx(MenuItem$1,{value:Wt,children:getSelectionLabel(vt,Wt)},Wt))})})]}),isLora(Qe.type)&&jsxRuntimeExports.jsxs("div",{"data-highlight-id":"category-field",className:cx("flex flex-col gap-2","p-2 -m-2 rounded-xl data-[highlighted]:bg-amber-100 dark:data-[highlighted]:bg-amber-500/15"),children:[jsxRuntimeExports.jsx("span",{className:"text-primary",children:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:recipes.category"})}),jsxRuntimeExports.jsx(FormControl,{required:!0,children:jsxRuntimeExports.jsx(Select,{size:"small",value:Qe.category??null,onChange:Wt=>{it("category")(Wt.target.value)},children:Qt.map(Wt=>Wt.value?jsxRuntimeExports.jsx(MenuItem$1,{value:Wt.value,children:jsxRuntimeExports.jsx(Text,{i18nKey:Wt.label,defaults:Wt.label})},Wt.value):null)})})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-primary",children:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:tags"})}),jsxRuntimeExports.jsx(TagSelect,{value:Tt||[],onChange:it("tags"),textFieldProps:{size:"small"}})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-primary",children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.model-form.description"})}),jsxRuntimeExports.jsx(TextField,{size:"small",value:St?.description||"",onChange:it("extra.description"),multiline:!0,rows:3})]})]}),!He.hidePrivateOption&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h2",{className:headingStyle(),children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:visibility.label"})}),jsxRuntimeExports.jsx("div",{className:"col-start-1",children:jsxRuntimeExports.jsx(PrivateModelToggle,{modelType:At,handleChange:it,isPrivate:Nt,isEditing:lt,originalFormValues:Bt})})]}),jsxRuntimeExports.jsxs($28f4fd908f0de97f$export$74a362b31437ec83,{className:"col-span-full flex flex-col mt-8 first:mt-0",children:[jsxRuntimeExports.jsx($5cb03073d3f54797$export$a8a3e93435678ff9,{className:headingStyle(),children:jsxRuntimeExports.jsxs($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{slot:"trigger",className:"group inline-flex items-center gap-1 outline-none",children:[jsxRuntimeExports.jsx("span",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.permissions"})}),jsxRuntimeExports.jsx(icBaselineKeyboardArrowRight,{className:"size-5 transition-transform group-aria-expanded:rotate-90"})]})}),jsxRuntimeExports.jsxs($28f4fd908f0de97f$export$feabaa331e1d464c,{className:"flex flex-col",children:[jsxRuntimeExports.jsx(FormControl,{children:jsxRuntimeExports.jsx(FormControlLabel,{control:jsxRuntimeExports.jsx(Checkbox,{checked:Mt,onChange:(Wt,Xt)=>it("isDownloadable")(Xt)}),label:vt("market:submit.allow-download")})}),modelPermissions.map(Wt=>jsxRuntimeExports.jsx(FormControl,{children:jsxRuntimeExports.jsx(FormControlLabel,{checked:St?.permissions?.[Wt]??!1,onChange:(Xt,Kt)=>{it(`extra.permissions.${Wt}`)(Kt)},control:jsxRuntimeExports.jsx(Checkbox,{}),label:vt(`market:model.permissions.${kebabCase(Wt)}`)})},Wt))]})]}),!lt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h2",{className:headingStyle(),children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.agreements.title"})}),jsxRuntimeExports.jsxs("div",{className:"col-span-full flex flex-col gap-2",children:[jsxRuntimeExports.jsx(FormControl,{children:jsxRuntimeExports.jsx(FormControlLabel,{className:"items-start",control:jsxRuntimeExports.jsx(Checkbox,{checked:Dt,onChange:(Wt,Xt)=>it("agreeNonMinor")(Xt)}),label:vt("market:submit.agreements.agree-non-minor")})}),jsxRuntimeExports.jsx(FormControl,{children:jsxRuntimeExports.jsx(FormControlLabel,{className:"items-start",control:jsxRuntimeExports.jsx(Checkbox,{checked:$t,onChange:(Wt,Xt)=>it("agreeCoverImage")(Xt)}),label:vt("market:submit.agreements.agree-cover-image")})})]})]}),He.appendComp]})})}function PrivateModelToggle(He){const{t:Qe}=useTranslation(["market"]),{modelType:it,isPrivate:lt,isEditing:ut,originalFormValues:dt,handleChange:xt}=He,{data:ft}=useMyMembership(),{membership:vt,id:kt}=ft||{},St=userHasMembership(ft),{data:Tt}=useGenerationModelTotalCount(St&&it?{authorId:kt,type:isLora(it)?GenerationModelType.AnyNonUserLora:GenerationModelType.AnyModel,isPrivate:!0}:void 0),Mt=(vt?.privilege.privateModel??1)-(Tt??0),Nt=!it||Mt<1||ut&&!dt?.isPrivate,At={number:Mt},$t=it?St?jsxRuntimeExports.jsx("p",{children:isLora(it)?Qe("market:submit.private.how-many-lora-slots-left",At):Qe("market:submit.private.how-many-model-slots-left",At)}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("span",{children:Qe("market:submit.private.join-to-upload-more")}),jsxRuntimeExports.jsx(UILink,{href:"/membership/plans",className:"ml-3 px-1 py-0.5 text-theme-primary rounded-sm",onPress:()=>{const Dt="market-submit";track("enter_member_click",{location:Dt}),startEventGroup("member_source",Dt,{persistent:!0})},children:Qe("market:submit.private.join-member")})]}):null;return jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsx(FormControl,{children:jsxRuntimeExports.jsx(FormControlLabel,{control:jsxRuntimeExports.jsx(Checkbox,{checked:lt,onChange:(Dt,Ft)=>xt("isPrivate")(Ft)}),disabled:Nt,label:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{children:Qe("market:submit.model-form.private-model")}),jsxRuntimeExports.jsx("span",{className:"ml-2 px-1.5 text-xs leading-5 uppercase tracking-wide text-white text-shadow-xs shadow-black/50 bg-gradient-purple-pink /bg-gradient-to-br /from-fuchsia-500 /to-purple-600 rounded-full",children:"Membership"})]})})}),jsxRuntimeExports.jsx("div",{className:"pl-8",children:$t})]})}function getTrainingTaskLabelAndStyle(He,Qe){return $$3(Qe).with({status:TrainingTaskStatus.running,extra:{progress:N$4.select("progress",N$4.number),estimatedTotalTime:N$4.select("estimatedTotalTime",N$4.number)}},({progress:it,estimatedTotalTime:lt})=>({label:`${it}% / ${He("market:train-lora.model.estimated-time")}: ${defaultDayjs.duration(lt,"ms").humanize()}`,className:"bg-yellow-500"})).with({status:TrainingTaskStatus.waiting},{status:TrainingTaskStatus.running},()=>({label:He("market:train-lora.model.waiting"),className:"bg-pink-400"})).with({status:TrainingTaskStatus.running},()=>({label:He("market:train-lora.model.running"),className:"bg-yellow-500"})).with({status:TrainingTaskStatus.failed},()=>({label:He("market:train-lora.model.running"),className:"bg-yellow-500"})).with({status:TrainingTaskStatus.completed},()=>({label:He("market:train-lora.model.completed"),className:"bg-green-500"})).otherwise(()=>null)}function getTrainingTasksFromModel(He){return(isUserMultiLora(He?.type)?He.loraTrainingTasks:[He?.trainingTask])?.filter(it=>!!it)??[]}function getIncompleteTrainingTasksFromModel(He){return getTrainingTasksFromModel(He).filter(Qe=>Qe.status!==TrainingTaskStatus.completed)}function TrainingTaskStatusChip(He){const{t:Qe}=useTranslation(["market"]),it=getTrainingTaskLabelAndStyle(Qe,He.trainingTask);return it?jsxRuntimeExports.jsx("span",{className:twMerge("rounded-xl select-none font-medium text-black",it.className,He.className),children:it.label}):null}function ModelTrainingTasks(He){const{t:Qe}=useTranslation(["market"]),{modelId:it}=He,{data:lt,isValidating:ut,mutate:dt}=useGenerationModel(it),xt=lt?.loraTrainingTasks?.filter(ft=>ft.status!=="completed")??[];return xt.length<1?jsxRuntimeExports.jsx(Empty,{description:Qe("market:edit-model-form.training-tasks.no-incomplete-placeholder")}):jsxRuntimeExports.jsx(TableContainer,{children:jsxRuntimeExports.jsxs(Table,{children:[jsxRuntimeExports.jsx(TableHead,{children:jsxRuntimeExports.jsxs(TableRow,{children:[jsxRuntimeExports.jsx(TableCell,{children:Qe("market:submit.model-version.version-name")}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:Qe("market:submit.model-version.status")}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:Qe("market:edit-model-form.training-tasks.media-count")}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:Qe("market:submit.model-version.update-time")}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:Qe("market:submit.model-version.actions")})]})}),jsxRuntimeExports.jsxs(TableBody,{children:[xt.length<1&&ut&&jsxRuntimeExports.jsx(TableRowSkeleton,{}),xt.map(ft=>jsxRuntimeExports.jsxs(TableRow,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[jsxRuntimeExports.jsx(TableCell,{component:"th",scope:"row",children:jsxRuntimeExports.jsx("pre",{children:ft.parameters.title??"Unknown"})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(TrainingTaskStatusChip,{className:"px-1.5 py-0.5 text-xs",trainingTask:ft,modelType:He.modelType})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:Array.isArray(ft.parameters.mediaIds)?ft.parameters.mediaIds.length:"N/A"}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:new Date(ft.updatedAt).toLocaleString()}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(ModelTrainingTaskEditAction,{status:ft.status,taskId:ft.id,modelProps:{id:He.modelId,type:He.modelType},taskExtra:ft.extra,onClose:He.onClose,updateTable:dt})})]},ft.id))]})]})})}function TableRowSkeleton(){return jsxRuntimeExports.jsxs(TableRow,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[jsxRuntimeExports.jsx(TableCell,{component:"th",scope:"row",children:jsxRuntimeExports.jsx(Skeleton,{})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(Skeleton,{})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(Skeleton,{})}),jsxRuntimeExports.jsx(TableCell,{align:"right",children:jsxRuntimeExports.jsx(Skeleton,{})})]})}function ModelTrainingTaskEditAction(He){const{t:Qe}=useTranslation(["market"]),it=useNavigate(),lt=async()=>{track("archive_model_version_click");try{if(!await UIDialog.confirm({heading:Qe("market:submit.archive-training-task.dialog.title"),content:Qe("market:submit.archive-training-task.dialog.description")}))return;track("archive_training_task_confirm",{modelId:He.modelProps?.id,trainingTaskId:He.taskId});const ft=await client.archiveTrainingTask({id:He.taskId});He.updateTable?.(),toast.success(Qe("market:submit.notice.training-task-archived"))}catch(xt){toast.error(Qe("market:submit.notice.training-task-archive-failed")+": "+xt.message)}},ut=()=>{it(withQuery("/train-lora",{addToModelId:He.modelProps?.id,trainingTaskId:He.taskId})),He.onClose?.()},dt=UIMenu.compact([He.status===TrainingTaskStatus.failed&&{id:"archive",icon:jsxRuntimeExports.jsx(fluentDocumentProhibited20Regular,{className:"size-5"}),children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.archive-version.label"}),color:"warning",onAction:()=>{lt()}},{id:"retrain",icon:jsxRuntimeExports.jsx(fluentImageArrowCounterclockwise20Regular,{className:"size-5"}),children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.reuse-dataset.label"}),onAction:()=>{ut()}}]);return jsxRuntimeExports.jsx("div",{className:"flex gap-2 justify-end",children:He.status==="archived"?jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",disabled:!0,children:jsxRuntimeExports.jsx("span",{className:"italic",children:Qe("market:submit.version-status.archived")})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs(UIMenuTrigger,{children:[jsxRuntimeExports.jsx(UIButton$1,{disabled:dt.length<1,variant:"outlined",children:jsxRuntimeExports.jsx(fluentMoreVertical20Filled,{className:"size-5"})}),jsxRuntimeExports.jsx(UIMenu,{items:dt,placement:"bottom right",children:xt=>jsxRuntimeExports.jsx(UIMenuItem,{...xt})})]})})})}function ModelEditContent(He){const[Qe,it]=reactExports.useState("info"),lt=$t=>{track("edit_model_tab_click",{tab:$t}),it($t)},{t:ut}=useTranslation(["action","market","artwork"]),{values:dt,handleChange:xt,submit:ft,loading:vt}=useModelSubmitForm(),kt=!!dt.modelId,St=isUserLora(dt.type),Tt=!hasModelTypeDisabledAddVersion(dt.type),Mt=isUserMultiLora(dt.type),[Nt,At]=reactExports.useState(!1);return jsxRuntimeExports.jsx("div",{className:"p-4 mmd:p-8 overflow-y-auto",children:jsxRuntimeExports.jsxs($5e8ad37a45e1c704$export$b2539bed5023c21c,{selectedKey:Qe,onSelectionChange:lt,orientation:"horizontal",children:[jsxRuntimeExports.jsx(Box,{sx:{borderBottom:1,borderColor:"divider"},children:jsxRuntimeExports.jsxs(UITabList,{variant:"underlined",children:[jsxRuntimeExports.jsx(UITab,{id:"info",variant:"underlined",className:"px-4",children:ut("market:submit.info-tab.label")}),Tt&&jsxRuntimeExports.jsx(UITab,{id:"version",variant:"underlined",className:"px-4",children:ut("market:submit.version-tab.label")}),Mt&&jsxRuntimeExports.jsx(UITab,{id:"training-tasks",variant:"underlined",className:"px-4",children:ut("market:edit-model-form.training-tasks.tab.label")})]})}),jsxRuntimeExports.jsxs($5e8ad37a45e1c704$export$3d96ec278d3efce4,{id:"info",children:[jsxRuntimeExports.jsx("div",{className:"overflow-y-auto max-h-[calc(100vh-64px-128px-32px-50px-44px)] p-4",children:jsxRuntimeExports.jsx(ModelInfoForm,{className:"pt-2 h-full",isEditing:kt,values:dt,handleChange:xt,appendComp:He.appendCompForInfo,highlightId:He.highlightId},dt.modelId)}),isLoraCategoryNotSet(dt)&&jsxRuntimeExports.jsx("div",{className:"mt-2 flex justify-end",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-2 px-3 py-2 text-sm bg-amber-100 dark:bg-yellow-500/20 rounded outline outline-1 -outline-offset-1 outline-black/10 dark:outline-white/10",children:[jsxRuntimeExports.jsx(fluentWarning20Filled,{className:"size-5 text-amber-500"}),jsxRuntimeExports.jsx("p",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.messages.category-not-set"})})]})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center mt-2",children:[jsxRuntimeExports.jsx("span",{className:"m-auto"}),St&&dt.isPrivate&&jsxRuntimeExports.jsx(FormControlLabel,{control:jsxRuntimeExports.jsx(Checkbox,{checked:Nt,onChange:$t=>At($t.target.checked)}),label:ut("artwork:generation.auto-publish")}),jsxRuntimeExports.jsx(UIButton$1,{busy:vt,disabled:isLoraCategoryNotSet(dt),onPress:async()=>{if(!(Nt&&!await dialogConfirm({title:ut("market:model.auto-publish-lora.dialog.title"),description:ut("market:model.auto-publish-lora.dialog.content")}).then(()=>!0,Dt=>Dt===UserCancelled?!1:Promise.reject(Dt))))try{await ft(),Nt&&dt.modelId&&await publishModel(dt.modelId),toast.success(ut("market:submit.notice.model-info-updated")),He.mutate?.(),He.onClose?.()}catch($t){toast.error($t.message)}},variant:"filled",children:jsxRuntimeExports.jsx("span",{children:ut(Nt?"action:save-and-publish":"action:save")})})]})]}),Tt&&jsxRuntimeExports.jsx($5e8ad37a45e1c704$export$3d96ec278d3efce4,{id:"version",className:"overflow-y-auto max-h-[calc(100vh-64px-128px-32px-50px)] py-4",children:jsxRuntimeExports.jsx(ModelAssetForm,{isEditing:kt,values:dt,handleChange:xt,onClose:He.onClose})}),Mt&&dt.modelId&&jsxRuntimeExports.jsx($5e8ad37a45e1c704$export$3d96ec278d3efce4,{id:"training-tasks",className:"overflow-y-auto max-h-[calc(100vh-64px-128px-32px-50px)] py-4",children:jsxRuntimeExports.jsx(ModelTrainingTasks,{modelId:dt.modelId,modelType:dt.type,onClose:He.onClose})})]})})}const ModelEditDialogContent=({onClose:He,model:Qe,...it})=>{const{t:lt}=useTranslation(["market"]),{mediaId:ut,extra:dt,...xt}=Qe;return jsxRuntimeExports.jsxs(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(LoadingPage,{}),children:[jsxRuntimeExports.jsxs("section",{className:"px-8 pt-6 text-2xl flex justify-between items-center",children:[jsxRuntimeExports.jsx("h2",{className:"font-bold",children:lt("market:edit-model-form.dialog-title")}),jsxRuntimeExports.jsx(IconButton,{edge:"end",onClick:He,children:jsxRuntimeExports.jsx(icBaselineClose,{className:"size-6"})})]}),jsxRuntimeExports.jsx(ModelSubmitFormProvider,{initialValues:{...xt,extra:parseModelExtras(dt),modelId:Qe.id,tags:Qe.tags?.map(({name:ft})=>ft),media:Qe.media,editFilename:Qe.latestAvailableVersion?.fileUploadRecord?.filename},children:jsxRuntimeExports.jsx(ModelEditContent,{onClose:He,...it})})]})},dialogEditModel=He=>UIDialog.create({children:({close:Qe})=>jsxRuntimeExports.jsx(ModelEditDialogContent,{onClose:()=>Qe(),...He}),className:"w-[calc(100vw-64px)] max-w-screen-mlg"}),dialogEditModelVersion=(He,Qe,it)=>UIDialog.create({children:({close:lt})=>jsxRuntimeExports.jsx(ModelVersionUpsertDialogContent,{modelProps:{...He},versionData:Qe,onClose:()=>lt(),mutate:it?.mutate}),className:"w-[calc(100vw-64px)] max-w-screen-mlg"}),dialogAddModelVersions=(He,Qe)=>UIDialog.create({children:({close:it})=>jsxRuntimeExports.jsx(ModelVersionUpsertDialogContent,{modelProps:{...He},mutate:Qe?.mutate,onClose:()=>it()}),className:"w-[calc(100vw-64px)] max-w-screen-mlg"}),fixedShareTags=["pixai"],getShareButtonPropsForModel=(He,Qe)=>{const it=He.tags?.map(({name:lt})=>lt).slice(0,5)??[];return{link:getModelShareLink(He.id),image:getPublicUrl(He.media),text:Qe("market:model.social-share-text",{authorName:`${He.author?.username||getUserDisplayName(He.author)||"anonymous"}`}),tags:[...fixedShareTags,...it]}};function dialogModelShareCard(He,Qe){return UIDialog.create({dismissable:!0,children:jsxRuntimeExports.jsxs("div",{className:"p-5 pb-6 flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-xl leading-none pb-1 font-sans",children:"Share"}),He.author?.username&&jsxRuntimeExports.jsxs("div",{className:"text-xs",children:["Model by @",He.author?.username]})]}),!!navigator.share&&jsxRuntimeExports.jsx(SystemShareButton,{...getShareButtonPropsForModel(He,Qe)})]}),jsxRuntimeExports.jsx(SocialShare,{...getShareButtonPropsForModel(He,Qe)})]})})}const styles$2={"header-layout":"_header-layout_in5sa_1","content-layout":"_content-layout_in5sa_18"},getArtworkMetaTitle=(He,Qe)=>{if(!Qe)return"Artwork Detail";const it=Qe.title||"AI Artwork",lt=getUserDisplayName(Qe.author)||"Anonymous";return He("common:meta.title.artwork",{title:it,authorName:lt})},getArtworkRelevantMetaTitle=(He,Qe)=>{const it=Qe?.title||"AI Artwork";return He("common:meta.title.artwork-relevant",{title:it})},getArtworkRelevantMetaDescription=(He,Qe)=>{const it=Qe?.title||"AI Artwork",lt=(Qe?.prompts||"").slice(0,100);return He("common:meta.description.artwork-relevant",{title:it,prompts:lt})},getModelMetaTitle=(He,Qe)=>{const it=Qe?.title||"Model";return isLora(Qe?.type)?He("common:meta.title.lora",{title:it}):He("common:meta.title.sdv1model",{title:it})};function removeUrlsFromText(He){if(!He)return;const Qe=/\b((?:https?|ftp):\/\/[^\s/$.?#].[^\s]*)/g;return He.replace(Qe,"")}const getArtworkMetaDescription=(He,Qe)=>{if(!Qe)return He("common:meta.description.home");const it=(Qe.tags??[]).map(xt=>xt.name).join(", "),lt=Qe.prompts,ut=Qe.title||"AI Artwork",dt=getUserDisplayName(Qe.author)||"Anonymous";return He("common:meta.description.artwork",{title:ut,authorName:dt,prompts:lt,tags:it})},getModelMetaDescription=(He,Qe)=>{const it=Qe?.title||"Model",lt=(Qe?.tags??[]).map(dt=>dt.name).join(", "),ut=removeUrlsFromText(Qe?.extra?.description);return isLora(Qe?.type)?He("common:meta.description.lora",{title:it,tags:lt,description:ut}):He("common:meta.description.sdv1model",{title:it,tags:lt,description:ut})},getModelCoverAlt=(He,Qe)=>{const it=Qe?.title||"Model";return isLora(Qe?.type)?He("market:model.image-alt.lora",{title:it}):He("market:model.image-alt.sdv1model",{title:it})},useArtworkListTagQueryTitle=({q:He,tag:Qe,tagInfo:it})=>{const{t:lt}=useTranslation(["common"]);return He?lt("common:meta.title.tag-artwork-list",{tag:He}):Qe?lt("common:meta.title.tag-artwork-list",{tag:`#${it.name}`}):""},useArtworkListTagQueryDescription=({q:He,tag:Qe,tagInfo:it})=>{const{t:lt}=useTranslation(["common"]);return He?lt("common:meta.description.tag-artwork-list",{tag:He}):Qe?lt("common:meta.description.tag-artwork-list",{tag:`#${it.name}`}):lt("common:meta.description.home")},getUserTitle=(He,Qe)=>{const it=getUserDisplayName(Qe)||"Anonymous User";return He("common:meta.title.user.home",{username:it})},getUserMetaDescription=(He,Qe,it)=>{const lt=getUserDisplayName(Qe)||"Anonymous User";return $$3(it).with(ProfilePageTab.artworks,()=>He("common:meta.description.user.artworks",{username:lt})).with(ProfilePageTab.likes,()=>He("common:meta.description.user.likes",{username:lt})).otherwise(()=>He("common:meta.description.user.home",{username:lt}))},getTagPageMetaTitle=(He,Qe,it,lt)=>Qe==="model"?it?lt?He("common:meta.title.model-query.keyword-and-tag",{keywords:lt,tag:it}):He("common:meta.title.model-query.tag-only",{tag:it}):He("common:meta.title.model-query.keyword-only",{keywords:lt}):it?lt?He("common:meta.title.artwork-query.keyword-and-tag",{keywords:lt,tag:it}):He("common:meta.title.artwork-query.tag-only",{tag:it}):He("common:meta.title.artwork-query.keyword-only",{keywords:lt}),getTagPageMetaDescription=(He,Qe,it,lt,ut)=>Qe==="model"?it?lt?He("common:meta.description.model-query.keyword-and-tag",{keywords:lt,tag:it,totalCount:ut}):He("common:meta.description.model-query.tag-only",{tag:it,totalCount:ut}):He("common:meta.description.model-query.keyword-only",{keywords:lt,totalCount:ut}):it?lt?He("common:meta.description.artwork-query.keyword-and-tag",{keywords:lt,tag:it,totalCount:ut}):He("common:meta.description.artwork-query.tag-only",{tag:it,totalCount:ut}):He("common:meta.description.artwork-query.keyword-only",{keywords:lt,totalCount:ut});async function publishLora(He,Qe){if(await UIDialog.confirm({heading:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.action.publish-lora.confirm-dialog.title"}),content:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.action.publish-lora.confirm-dialog.content"})}))try{return await publishModel(He),!0}catch(lt){toast.error(String(lt))}}function PublishOrEditUserLoraButton(He){const{model:Qe,className:it,mutate:lt}=He,{t:ut}=useTranslation(["market","action"]);if(!isUserLora(Qe.type))return null;const xt=!isLoraCategoryNotSet(Qe),ft=Qe.isPrivate&&xt;return jsxRuntimeExports.jsx(Button,{variant:"contained",className:it,onClick:async vt=>{vt.preventDefault(),vt.stopPropagation(),ft?await publishLora(Qe.id)&&lt?.():dialogEditModel({model:Qe,mutate:lt,highlightId:xt?void 0:"category-field"})},children:ut(ft?"action:publish":"action:edit")})}function ModelDetailImage(He){const{t:Qe}=useTranslation(["market"]),{model:it,version:lt,mutate:ut}=He,dt=lt?.media??it.media,xt=isModelCoverWarned(it),ft=isModelCoverAppealable(it);return jsxRuntimeExports.jsxs(ContentFittableBox,{ratio:getAspectRatio(dt),className:cx("size-full",He.className),style:He.style,children:[xt?jsxRuntimeExports.jsxs("div",{className:"grid place-content-center place-items-center size-full",children:[jsxRuntimeExports.jsx(MediaContentRemoved,{overlayType:xt?"model-cover-warned":void 0,type:"standalone"}),ft&&jsxRuntimeExports.jsx(AppealButtonInDetail,{className:"mt-4",refType:RefType.Model,refId:it.id})]}):jsxRuntimeExports.jsx(SingleImageViewer,{scene:"model-detail",imgClassName:"rounded-md",id:dt?.id,mediaId:dt?.id,fileName:`pixai-model-cover_${it.id}.${getImageDownloadFileExt({media:dt})}`,originalUrl:getPublicUrl(dt),thumbnailUrl:getThumbnailUrl(dt),width:dt?.width,height:dt?.height,author:it.author,alt:getModelCoverAlt(Qe,it)}),jsxRuntimeExports.jsx(ModelOverlayForUserLora,{model:it,mutate:ut}),jsxRuntimeExports.jsx(CardCornerDebugInfo,{extra:it.extra,artworkSafetyScore:it.artworkSafetyScore,children:vt=>jsxRuntimeExports.jsx("div",{className:"absolute top-1.5 right-1.5 bg-black/50 rounded px-2 py-1.5",children:vt})})]})}function ModelOverlayForUserLora(He){const{model:Qe,mutate:it}=He,{trainingTask:lt}=Qe;return!lt||!Qe.isPrivate?null:lt.status===TrainingTaskStatus.completed?jsxRuntimeExports.jsx("div",{className:"absolute text-white w-full h-full top-0 left-0 bg-black/20 backdrop-blur-sm items-center justify-center flex flex-col",children:jsxRuntimeExports.jsx(PublishOrEditUserLoraButton,{model:He.model,className:"text-black bg-white font-medium text-xl px-4",mutate:it})}):null}const idDebouncingMap=new Map;async function submitItemReview(He,{rating:Qe}){return idDebouncingMap.has(He)||idDebouncingMap.set(He,client.submitReview({input:{modelId:He,rating:Qe}}).finally(()=>{idDebouncingMap.delete(He)})),(await idDebouncingMap.get(He)).review}function parseRatingDetail(He){return Object.fromEntries(He.map(({rating:Qe,count:it})=>[Qe,it]))}const fluentThumbDislike20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12.483 18.296c-.799.837-2.092.387-2.431-.59c-.28-.807-.644-1.772-.998-2.483c-1.06-2.126-1.678-3.336-3.384-4.85a2.8 2.8 0 0 0-.841-.49c-1.13-.446-2.19-1.615-1.913-3.004l.353-1.765a2.5 2.5 0 0 1 1.794-1.922l5.6-1.527a4.5 4.5 0 0 1 5.61 3.536l.685 3.762a3 3 0 0 1-2.952 3.537h-.883l.01.052c.08.408.176.97.24 1.583c.065.61.1 1.284.049 1.912c-.05.617-.184 1.25-.504 1.73a4 4 0 0 1-.435.519"})}),fluentThumbLike20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12.483 1.704c-.799-.837-2.092-.387-2.431.59c-.28.806-.644 1.772-.998 2.483c-1.06 2.126-1.678 3.335-3.384 4.849a2.8 2.8 0 0 1-.841.49c-1.13.446-2.19 1.616-1.913 3.005l.353 1.765a2.5 2.5 0 0 0 1.794 1.922l5.6 1.527a4.5 4.5 0 0 0 5.61-3.537l.685-3.761A3 3 0 0 0 14.006 7.5h-.883l.01-.052c.08-.409.176-.97.24-1.583c.065-.61.1-1.285.049-1.913c-.05-.616-.184-1.249-.504-1.73a4 4 0 0 0-.435-.518"})});function Rating(He){const{t:Qe}=useTranslation(["common"]);return jsxRuntimeExports.jsx("span",{className:cx("inline-flex flex-col",He.className),style:He.style,children:Qe("common:review.rating-score.label",{context:He.value??0})},He.value)}function RatingInput(He){const{mutate:Qe}=useReviewSummary(He.itemId),[it,lt]=reactExports.useState(!1),[ut,dt]=reactExports.useState();!it&&ut!==He.value&&dt(He.value);async function xt(vt){const kt=He.value===vt;track("model_review_click",{value:vt,modelId:He.itemId,isCancel:kt}),lt(!0),dt(kt?void 0:vt);const St=await submitItemReview(He.itemId,{rating:kt?ReviewRating.Cancel:vt});await He.onSubmit?.(St),lt(!1),await Qe()}const ft={button:"flex justify-center items-center gap-1 px-2 py-0.5 text-base disabled:opacity-50 transition"};return jsxRuntimeExports.jsxs("span",{className:cx("overflow-hidden inline-grid grid-cols-2 bg-white/50 dark:bg-black/40 ring-1 ring-black/20 dark:ring-black/50 divide-x divide-black/20 dark:divide-black/50 rounded-md",He.className),style:He.style,children:[jsxRuntimeExports.jsxs("button",{type:"button",disabled:it,className:cx(ft.button,ut===ReviewRating.Like?"text-white bg-green-600":"text-green-600"),onClick:()=>xt(ReviewRating.Like),children:[jsxRuntimeExports.jsx(fluentThumbLike20Filled,{className:"my-0.5 size-5"}),Number(He.positiveCount)>0&&formatNum(He.positiveCount)]}),jsxRuntimeExports.jsxs("button",{type:"button",disabled:it,className:cx(ft.button,ut===ReviewRating.Dislike?"text-white bg-red-600":"text-red-600"),onClick:()=>xt(ReviewRating.Dislike),children:[jsxRuntimeExports.jsx(fluentThumbDislike20Filled,{className:"my-0.5 size-5"}),Number(He.negativeCount)>0&&formatNum(He.negativeCount)]})]})}const fluentChevronRight20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7.646 4.147a.5.5 0 0 1 .707-.001l5.484 5.465a.55.55 0 0 1 0 .779l-5.484 5.465a.5.5 0 0 1-.706-.708L12.812 10L7.647 4.854a.5.5 0 0 1-.001-.707"})}),fluentGlobe20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10 18a8 8 0 1 0 0-16a8 8 0 0 0 0 16m0-15c.657 0 1.407.59 2.022 1.908c.217.466.406 1.002.559 1.592H7.419c.153-.59.342-1.126.56-1.592C8.592 3.59 9.342 3 10 3M7.072 4.485A10.5 10.5 0 0 0 6.389 6.5H3.936a7.02 7.02 0 0 1 3.778-3.118c-.241.33-.456.704-.642 1.103M6.192 7.5A16 16 0 0 0 6 10c0 .87.067 1.712.193 2.5H3.46A7 7 0 0 1 3 10c0-.88.163-1.724.46-2.5zm.197 6c.176.743.407 1.422.683 2.015c.186.399.401.773.642 1.103A7.02 7.02 0 0 1 3.936 13.5zm1.03 0h5.162a9.3 9.3 0 0 1-.56 1.592C11.408 16.41 10.658 17 10 17s-1.407-.59-2.022-1.908A9.3 9.3 0 0 1 7.42 13.5m5.375-1H7.206A15 15 0 0 1 7 10c0-.883.073-1.725.206-2.5h5.588c.133.775.206 1.617.206 2.5s-.073 1.725-.206 2.5m.817 1h2.453a7.02 7.02 0 0 1-3.778 3.118c.241-.33.456-.704.642-1.103c.276-.593.507-1.272.683-2.015m2.93-1h-2.734c.126-.788.193-1.63.193-2.5s-.067-1.712-.193-2.5h2.733c.297.776.46 1.62.46 2.5s-.163 1.724-.46 2.5m-4.255-9.118A7.02 7.02 0 0 1 16.064 6.5H13.61a10.5 10.5 0 0 0-.683-2.015a6.6 6.6 0 0 0-.642-1.103"})}),fluentGlobeOff20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M4 4.708L2.147 2.854a.5.5 0 1 1 .708-.708l15 15a.5.5 0 0 1-.708.708l-1.854-1.855A8 8 0 0 1 4 4.707M14.585 15.29l-1.145-1.145a10 10 0 0 1-.511 1.369a6.6 6.6 0 0 1-.642 1.103a7 7 0 0 0 2.298-1.327m-2.792-2.79L7.15 7.857A15 15 0 0 0 7 10c0 .883.073 1.725.206 2.5zm-6-6L4.709 5.416A7 7 0 0 0 3.936 6.5zM6 10c0-.87.067-1.712.193-2.5H3.46A7 7 0 0 0 3 10c0 .88.163 1.724.46 2.5h2.733A16 16 0 0 1 6 10m1.072 5.515a10.5 10.5 0 0 1-.683-2.015H3.936a7.02 7.02 0 0 0 3.778 3.118a6.6 6.6 0 0 1-.642-1.103m4.95-.423a9.3 9.3 0 0 0 .559-1.592H7.419c.153.59.342 1.126.56 1.592C8.592 16.41 9.342 17 10 17s1.407-.59 2.022-1.908M7.072 4.485a9 9 0 0 0-.143.323l.773.772q.129-.356.276-.672C8.593 3.59 9.343 3 10 3s1.407.59 2.022 1.908c.217.466.406 1.002.559 1.592H8.62l1 1h3.173c.133.775.206 1.617.206 2.5q0 .435-.023.855l.927.927a16.3 16.3 0 0 0-.097-4.282h2.733c.297.776.46 1.62.46 2.5s-.163 1.724-.46 2.5H14.62l1.997 1.996A8 8 0 0 0 5.504 3.382l.721.722c.462-.297.962-.54 1.49-.722a6.6 6.6 0 0 0-.643 1.103M16.064 6.5H13.61a10.5 10.5 0 0 0-.683-2.015a6.6 6.6 0 0 0-.642-1.103A7.02 7.02 0 0 1 16.064 6.5"})}),fluentImage20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M14 7.5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m-1 0a.5.5 0 1 0-1 0a.5.5 0 0 0 1 0M3 6a3 3 0 0 1 3-3h8a3 3 0 0 1 3 3v8a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3zm3-2a2 2 0 0 0-2 2v8c0 .373.102.722.28 1.02l4.669-4.588a1.5 1.5 0 0 1 2.102 0l4.67 4.588A2 2 0 0 0 16 14V6a2 2 0 0 0-2-2zm0 12h8c.37 0 .715-.1 1.012-.274l-4.662-4.58a.5.5 0 0 0-.7 0l-4.662 4.58A2 2 0 0 0 6 16"})}),fluentImageOff20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M2.854 2.146a.5.5 0 1 0-.708.708l1.409 1.408A2.98 2.98 0 0 0 3 6v8a3 3 0 0 0 3 3h8a2.98 2.98 0 0 0 1.738-.555l1.408 1.409a.5.5 0 0 0 .708-.708zm6.56 7.975a1.5 1.5 0 0 0-.465.311l-4.67 4.588A2 2 0 0 1 4 14V6c0-.37.101-.718.277-1.016zM6 16c-.37 0-.715-.1-1.012-.274l4.662-4.58a.5.5 0 0 1 .7 0l4.662 4.58A2 2 0 0 1 14 16zM16 6v7.879l.898.898Q17 14.404 17 14V6a3 3 0 0 0-3-3H6q-.405 0-.777.102L6.12 4H14a2 2 0 0 1 2 2m-2 1.5a1.5 1.5 0 1 0-3 0a1.5 1.5 0 0 0 3 0m-1 0a.5.5 0 1 1-1 0a.5.5 0 0 1 1 0"})}),fluentMoney20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7 9a2 2 0 1 1 4 0a2 2 0 0 1-4 0m2-1a1 1 0 1 0 0 2a1 1 0 0 0 0-2M3.5 4A1.5 1.5 0 0 0 2 5.5v7A1.5 1.5 0 0 0 3.5 14h11a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 14.5 4zM3 5.5a.5.5 0 0 1 .5-.5H5v1a1 1 0 0 1-1 1H3zM3 8h1a2 2 0 0 0 2-2V5h6v1a2 2 0 0 0 2 2h1v2h-1a2 2 0 0 0-2 2v1H6v-1a2 2 0 0 0-2-2H3zm10-3h1.5a.5.5 0 0 1 .5.5V7h-1a1 1 0 0 1-1-1zm2 6v1.5a.5.5 0 0 1-.5.5H13v-1a1 1 0 0 1 1-1zM5 13H3.5a.5.5 0 0 1-.5-.5V11h1a1 1 0 0 1 1 1zm12-.5a2.5 2.5 0 0 1-2.5 2.5H4.085A1.5 1.5 0 0 0 5.5 16h9a3.5 3.5 0 0 0 3.5-3.5v-5a1.5 1.5 0 0 0-1-1.415z"})}),fluentMoneyOff20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M2.854 2.146a.5.5 0 1 0-.708.708l1.16 1.159A1.5 1.5 0 0 0 2 5.5v7A1.5 1.5 0 0 0 3.5 14h9.793l1 1H4.085A1.5 1.5 0 0 0 5.5 16h9q.37 0 .719-.074l1.927 1.928a.5.5 0 0 0 .708-.708zM12 12.707V13H6v-1a2 2 0 0 0-2-2H3V8h1a2 2 0 0 0 1.905-1.388l1.372 1.372a2 2 0 0 0 2.74 2.74zM4.293 5L5 5.707V6a1 1 0 0 1-1 1H3V5.5a.5.5 0 0 1 .5-.5zm3.74 3.741L9.26 9.966a1 1 0 0 1-1.225-1.225M3.5 13a.5.5 0 0 1-.5-.5V11h1a1 1 0 0 1 1 1v1zM14 10c-.523 0-.998.2-1.354.528l.708.709A1 1 0 0 1 14 11h1v1.5a.5.5 0 0 1-.093.29l.71.71c.238-.265.383-.616.383-1v-7A1.5 1.5 0 0 0 14.5 4H6.117l1 1H12v1a2 2 0 0 0 2 2h1v2zm.5-5a.5.5 0 0 1 .5.5V7h-1a1 1 0 0 1-1-1V5zm1.826 9.208l.707.708c.6-.629.967-1.48.967-2.416v-5a1.5 1.5 0 0 0-1-1.415V12.5c0 .66-.256 1.261-.674 1.708"})}),fluentPersonStarburst20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7.996 6.996a2 2 0 1 1 4 0a2 2 0 0 1-4 0m-.5 3h5a1.5 1.5 0 0 1 1.5 1.5c0 1.116-.46 2.01-1.212 2.614c-.742.596-1.735.886-2.788.886s-2.047-.29-2.788-.886c-.753-.604-1.212-1.498-1.212-2.614a1.5 1.5 0 0 1 1.5-1.5m3.94-7.07c-.56-1.235-2.313-1.235-2.871 0a.575.575 0 0 1-.86.23c-1.1-.79-2.619.087-2.485 1.435a.575.575 0 0 1-.629.63c-1.348-.135-2.225 1.384-1.435 2.485c.212.295.1.71-.23.859c-1.235.558-1.235 2.312 0 2.87c.33.15.442.564.23.86c-.79 1.1.087 2.619 1.435 2.485a.575.575 0 0 1 .63.629c-.135 1.348 1.384 2.225 2.485 1.435c.295-.212.71-.1.859.23c.558 1.235 2.312 1.235 2.87 0a.575.575 0 0 1 .86-.23c1.1.79 2.619-.087 2.485-1.435a.575.575 0 0 1 .629-.63c1.348.135 2.225-1.384 1.435-2.485a.575.575 0 0 1 .23-.859c1.235-.558 1.235-2.312 0-2.87a.575.575 0 0 1-.23-.86c.79-1.1-.087-2.619-1.435-2.485a.575.575 0 0 1-.63-.629c.135-1.348-1.384-2.225-2.485-1.435a.575.575 0 0 1-.859-.23m-1.96.412a.575.575 0 0 1 1.048 0a1.575 1.575 0 0 0 2.353.63a.575.575 0 0 1 .908.525a1.575 1.575 0 0 0 1.723 1.722a.575.575 0 0 1 .523.908a1.575 1.575 0 0 0 .63 2.353a.574.574 0 0 1 0 1.048a1.575 1.575 0 0 0-.63 2.353a.575.575 0 0 1-.523.908a1.575 1.575 0 0 0-1.723 1.723a.575.575 0 0 1-.908.523a1.575 1.575 0 0 0-2.353.63a.575.575 0 0 1-1.048 0a1.575 1.575 0 0 0-2.353-.63a.575.575 0 0 1-.908-.523a1.575 1.575 0 0 0-1.722-1.723a.575.575 0 0 1-.524-.908a1.575 1.575 0 0 0-.63-2.353a.575.575 0 0 1 0-1.048a1.575 1.575 0 0 0 .63-2.353a.575.575 0 0 1 .524-.908a1.575 1.575 0 0 0 1.722-1.722a.575.575 0 0 1 .908-.524c.807.58 1.944.275 2.353-.63"})}),fluentThumbLike16Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 16 16",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M9.58 1.052c-.75-.209-1.336.35-1.545.871c-.24.6-.453 1.021-.706 1.524a45 45 0 0 0-.533 1.09c-.475 1.01-.948 1.656-1.293 2.045a4 4 0 0 1-.405.402a2 2 0 0 1-.101.081l-.016.012L3.109 8.18a2 2 0 0 0-.856 2.426l.52 1.384a2 2 0 0 0 1.273 1.205l5.356 1.682a2.5 2.5 0 0 0 3.148-1.68l1.364-4.647a2 2 0 0 0-1.92-2.563H10.61c.066-.227.133-.479.195-.74c.131-.562.243-1.203.232-1.738c-.009-.497-.06-1.019-.264-1.462c-.219-.475-.602-.832-1.192-.996M4.978 7.08l-.002.001Z"})}),icOutlineBrush=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7 16c.55 0 1 .45 1 1c0 1.1-.9 2-2 2c-.17 0-.33-.02-.5-.05c.31-.55.5-1.21.5-1.95c0-.55.45-1 1-1M18.67 3c-.26 0-.51.1-.71.29L9 12.25L11.75 15l8.96-8.96a.996.996 0 0 0 0-1.41l-1.34-1.34c-.2-.2-.45-.29-.7-.29zM7 14c-1.66 0-3 1.34-3 3c0 1.31-1.16 2-2 2c.92 1.22 2.49 2 4 2c2.21 0 4-1.79 4-4c0-1.66-1.34-3-3-3z"})}),styles$1={"info-table":"_info-table_w6w4r_1"},loraParamsFields=["triggerWords"],sdv1ModelParamsFields=["samplingSteps","samplingMethod","cfgScale","negativePrompts"];function versionHasParams(He,Qe){if(!He||!Qe)return!1;const it=Object.entries(He.extra??{});return isLora(Qe)?it.some(([lt,ut])=>loraParamsFields.includes(lt)&&ut):it.some(([lt,ut])=>sdv1ModelParamsFields.includes(lt)&&ut)}function ModelParamsInfo$1(He){const{t:Qe}=useTranslation(["market","generation","action"]),{version:it,modelType:lt,contentClassName:ut,trainBaseModelId:dt}=He;return versionHasParams(it,lt)?(()=>{if(!it)return null;if(isLora(lt))return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ModelParameterItem,{title:Qe("market:model.trigger-words"),value:it.extra.triggerWords}),isUserLora(lt)&&dt?jsxRuntimeExports.jsx(reactExports.Suspense,{children:jsxRuntimeExports.jsx(ModelBaseModelParameterItem,{trainBaseModelId:dt})}):null]});const{samplingSteps:vt,samplingMethod:kt,negativePrompts:St,cfgScale:Tt}=it.extra;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ModelParameterItem,{title:Qe("generation:sampling-steps.label"),value:vt}),jsxRuntimeExports.jsx(ModelParameterItem,{title:Qe("generation:sampling-method.label"),value:kt}),jsxRuntimeExports.jsx(ModelParameterItem,{title:Qe("generation:cfg-scale.label"),value:Tt}),jsxRuntimeExports.jsx(ModelParameterItem,{title:Qe("generation:negative-prompts.label"),value:St,className:"col-span-3"})]})})():null}function ModelBaseModelParameterItem(He){const{data:Qe}=useGenerationModel(He.trainBaseModelId);return jsxRuntimeExports.jsx(ModelParameterItem,{title:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.trained-based-on-model"}),value:Qe?.title})}function ModelParameterItem(He){const{title:Qe,value:it,className:lt}=He;return it?jsxRuntimeExports.jsxs("div",{className:lt,children:[jsxRuntimeExports.jsx("dt",{children:Qe}),jsxRuntimeExports.jsx("dd",{children:jsxRuntimeExports.jsx("p",{className:"break-words min-w-0",children:it})})]}):null}const fieldsToCheck=["samplingMethod","samplingSteps","cfgScale","negativePrompts"];function getVersionExtraParams(He){const{extra:Qe}=He;return Object.fromEntries(Object.entries(Qe).filter(([it,lt])=>fieldsToCheck.includes(it)&&lt!=null))}function ModelInfoSection(He){const{model:Qe,version:it=Qe?.latestAvailableVersion,loadingVersion:lt}=reactExports.useContext(ModelDetailContext);return Qe?jsxRuntimeExports.jsxs("div",{className:cx("flex-1 flex-shrink min-w-0 flex flex-col gap-3"),children:[jsxRuntimeExports.jsx(ModelContentActions,{model:Qe,version:it}),jsxRuntimeExports.jsx(AuthorInfo,{model:Qe}),jsxRuntimeExports.jsxs("dl",{className:cx(styles$1["info-table"],lt&&"opacity-50"),children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("dt",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.uploaded-at.label"})}),jsxRuntimeExports.jsx("dd",{children:it&&defaultDayjs(it.createdAt).format("lll")})]}),!Qe.isPrivate&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("dt",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.lora-used-times"})}),jsxRuntimeExports.jsx("dd",{children:formatNum(Qe.refCount)??0})]}),isUserLora(Qe.type)&&Qe.rebateAmount!=null&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("dt",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:train-lora.model-rebate.earned"})}),jsxRuntimeExports.jsxs("dd",{className:"flex items-center gap-1 text-theme-primary",children:[jsxRuntimeExports.jsx(gameIconsCrystalBars,{className:"size-[1em]"}),Qe.rebateAmount.toLocaleString()]})]}),Qe.reviewSummary&&jsxRuntimeExports.jsx(RatingPartial,{})]}),jsxRuntimeExports.jsx(ModelParamsInfo$1,{contentClassName:"pl-2",version:it,modelType:Qe.type,trainBaseModelId:He.trainBaseModelId}),jsxRuntimeExports.jsx(PermissionInfo,{})]})]}):null}function ModelContentActions(He){const{t:Qe}=useTranslation(["market","user","common","action","artwork"]),{onClose:it}=reactExports.useContext(ModelDetailContext),{data:lt}=useUserInfo(),ut=userHasMembership(lt),dt=useNavigate(),{model:xt,version:ft}=He,vt=isMultiUnionLora(xt.type),{data:kt}=useGenerationModelVersions(vt?{modelId:xt.id,last:1}:void 0),St=ft??(isMultiUnionLora(xt.type)?getNodesFromConnection(kt)?.[0]:xt.latestAvailableVersion),Tt=St?.id,{models:Mt}=useAvaliableI2vModels(),Nt=reactExports.useMemo(()=>{for(const Bt of Mt)if(Bt.loras?.find(Ot=>Ot.id===Tt))return!0;return!1},[Mt,xt]);let At,$t,Dt;if(isModelEarlyAccess(xt.extra)&&!ut)At=Qe("market:model.use-this-model"),$t="theme",Dt=()=>{const Bt="model-detail-use-early-access";if(!lt?.id){const Ot=joinURL(window.location.origin,`/model/${xt.id}`);return openSignModal({oauthRedirectUrl:Ot},{fromPath:Bt})}openProceedMembershipModal({membershipModalProps:{trackingLocation:Bt},confirmationDialogProps:{heading:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.early-access.membership-dialog.heading"}),content:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.early-access.membership-dialog.content"})}})};else if(isLora(xt.type)||isSDModel(xt.type)||isChatModel(xt.type)||isDitV1Model(xt.type)){let Bt,Ot,Qt;if(isLora(xt.type)){if(Bt="use_lora_click",Ot="use-lora",At=Qe("market:model.use-this-lora"),Nt){if(Qt="/generator/image/animation",Tt){const Wt=encodeInitialValuesForImport({lora:{[Tt]:1}});Qt=withQuery(Qt,{initialValues:Wt})}}else if(Qt="/pixai",Tt){const Wt=encodeInitialValuesForImport({lora:{[Tt]:.7},prompts:St.extra.triggerWords});Qt=withQuery(Qt,{initialValues:Wt})}}else if(isChatModel(xt.type))Bt="use_chat_click",Ot="use_chat",At=Qe("market:model.use-this-model"),Qt="/generator/chat-editing/creator";else if(Bt="use_model_click",Ot="use_model",At=Qe("market:model.use-this-model"),Qt="/pixai",Tt){const Wt=encodeInitialValuesForImport({modelId:Tt,...getVersionExtraParams(St)});Qt=withQuery(Qt,{initialValues:Wt})}Dt=async()=>{if(track(Bt,{type:xt.type}),!lt){openSignModal(void 0,{fromPath:Ot});return}try{await client.markGenerationModel({modelId:xt.id,target:!0,type:GenerationModelMarkType.Bookmark}),toast.info(Qe("market:model.notice.bookmark-success")),startEventGroup("generate_source"),dt(Qt),it?.()}catch(Wt){toast.error("Failed to bookmark model",Wt.message)}}}else At=Qe("market:model.model-unavailable");const Ft=!St?.id||St?.status!==GenerationModelVersionStatus.available;return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:St?.status==="invalid"?jsxRuntimeExports.jsx("div",{className:"w-full flex items-center justify-center font-bold bg-orange-700 text-white p-2 rounded-xl",children:Qe("market:model.conversion-failed")}):jsxRuntimeExports.jsxs("div",{className:"flex gap-x-4 gap-y-2 flex-wrap",children:[jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",className:"flex-1 text-sm whitespace-nowrap",size:"large",color:$t,icon:jsxRuntimeExports.jsx(icOutlineBrush,{className:"size-6"}),endIcon:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),onPress:Dt,disabled:Ft,children:At}),Ft&&jsxRuntimeExports.jsx("p",{className:"text-sm italic text-opacity-80",children:Qe("market:model.use-another-version")})]})})}function AuthorInfo(He){const{model:Qe,className:it}=He,{t:lt}=useTranslation(["market"]),{data:ut}=useUserInfo(),{data:dt=Qe.author,refetch:xt}=useGetUserInfoById(Qe.authorId);if(!Qe.extra)return null;const ft=isUserLora(Qe.type),{claimed:vt}=Qe.extra,kt=ut&&dt?.id===ut.id,St=(()=>{if(vt||ft)return dt;if(!vt&&kt)return ut})(),Tt="border border-solid border-black/15 dark:border-white/15 rounded-lg";if(!St)return null;const Mt=!ft&&kt?lt("market:model.model-by-self"):getUserDisplayName(St);return jsxRuntimeExports.jsxs("div",{className:cx(Tt,it),children:[dt?.coverMedia&&jsxRuntimeExports.jsx("div",{className:"aspect-[1311/232] bg-center bg-cover rounded-t-lg",style:{backgroundImage:`url(${getThumbnailUrl(dt.coverMedia)})`}}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 p-1.5 pl-2",children:[jsxRuntimeExports.jsx("span",{className:"text-sm whitespace-nowrap",children:lt(ft||vt?"market:model.trained-by":"market:model.post-by")}),jsxRuntimeExports.jsx(UserLink,{user:St,name:Mt,linkClassName:"min-w-0"}),!ut||!dt||kt?null:jsxRuntimeExports.jsx(UIButton$1,{variant:dt.followedByMe?"outlined":"filled",busy:"auto",className:"ml-auto whitespace-nowrap",onPress:async()=>{const Nt=dt.id,At=!dt.followedByMe;track("follow_btn_click",{userId:Nt,target:At,scene:"model"}),await client.setFollowState({userId:Nt,target:At}),xt()},children:dt.followedByMe?jsxRuntimeExports.jsx(Text,{i18nKey:"user:following"}):jsxRuntimeExports.jsx(Text,{i18nKey:"user:follow"})})]}),ft&&!kt&&jsxRuntimeExports.jsx("div",{className:"grid p-0.5 border-t border-black/15 dark:border-white/15",children:jsxRuntimeExports.jsx(UILink,{href:"/train-lora",variant:"filled",color:"theme",icon:jsxRuntimeExports.jsx(fluentAdd24Filled,{className:"size-6"}),endIcon:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),className:"text-center rounded-md",onPress:()=>{track("lora_train_click",{location:"trained-lora"})},children:jsxRuntimeExports.jsx(Text,{i18nKey:"growth:train-lora.credit-banner.title"})})})]})}function RatingPartial(){const{model:He,mutateModel:Qe}=reactExports.useContext(ModelDetailContext),{data:it}=useReviewSummary(He?.id),lt=it??He?.reviewSummary,ut=lt?.ratingDetail&&parseRatingDetail(lt.ratingDetail)[ReviewRating.Like],{data:dt}=useUserInfo();return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("dt",{children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:review.label"})}),jsxRuntimeExports.jsxs("dd",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center",children:[jsxRuntimeExports.jsx(Rating,{value:lt?.score}),Number(ut)>0&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["  (",jsxRuntimeExports.jsx(ReviewCountPrefix,{children:formatNum(ut)}),")"]})]}),dt&&He&&jsxRuntimeExports.jsx("span",{className:"ml-auto -my-1 flex",children:jsxRuntimeExports.jsx(RatingInput,{itemId:He.id,value:He.myReview?.rating,className:"",onSubmit:async()=>{await Qe?.()}})})]})]})})}function ReviewCountPrefix({children:He}){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(fluentThumbLike16Filled,{className:"mr-0.5 size-4 text-green-600"}),He]})}function PermissionInfo(){const{t:He}=useTranslation(["market"]),{model:Qe}=reactExports.useContext(ModelDetailContext),[it,lt]=reactExports.useState(!1),ut=reactExports.useRef(null);if(!Qe)return null;const dt=modelPermissions.map(xt=>({permission:xt,allowed:!!Qe.extra?.permissions?.[xt]||!!Qe.extra?.permissions?.[kebabCase(xt)]}));return jsxRuntimeExports.jsxs("div",{className:"cursor-pointer",onClick:()=>{ut.current&&(ut.current.open=!ut.current.open)},children:[jsxRuntimeExports.jsxs("dt",{children:[jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.permissions.title"}),jsxRuntimeExports.jsx(fluentChevronRight20Regular,{className:cx("ml-auto size-5",it&&"rotate-90")})]}),jsxRuntimeExports.jsx("dd",{children:jsxRuntimeExports.jsxs("details",{ref:ut,className:"group",onToggle:xt=>lt(xt.currentTarget.open),children:[jsxRuntimeExports.jsx("summary",{className:"flex gap-1 [.group[open]_&]:hidden",onClick:xt=>xt.stopPropagation(),children:dt.map(xt=>reactExports.createElement(PermissionIcon,{...xt,key:xt.permission,className:"flex-none"}))}),jsxRuntimeExports.jsx("ul",{className:"space-y-0.5",children:dt.map(xt=>jsxRuntimeExports.jsxs("li",{className:"flex gap-1 items-start",children:[jsxRuntimeExports.jsx(PermissionIcon,{...xt,className:"flex-none"}),jsxRuntimeExports.jsx("span",{className:cx(!xt.allowed&&"opacity-50"),children:jsxRuntimeExports.jsx(Text,{i18nKey:`market:model.permissions.${kebabCase(xt.permission)}`,defaults:He("market:model.permissions.unknown")})})]},xt.permission))})]})})]})}const permissionIconStyle=ce$1({base:"size-5",variants:{allowed:{true:"text-green-600",false:"text-zinc-400"}}});function PermissionIcon(He){const Qe=permissionIconStyle({allowed:He.allowed,className:He.className});return $$3(He).with({permission:"shareImagesOnline",allowed:!0},()=>jsxRuntimeExports.jsx(fluentGlobe20Regular,{className:Qe})).with({permission:"shareImagesOnline",allowed:!1},()=>jsxRuntimeExports.jsx(fluentGlobeOff20Regular,{className:Qe})).with({permission:"personalUses",allowed:!0},()=>jsxRuntimeExports.jsx(fluentImage20Regular,{className:Qe})).with({permission:"personalUses",allowed:!1},()=>jsxRuntimeExports.jsx(fluentImageOff20Regular,{className:Qe})).with({permission:"commercialUses",allowed:!0},()=>jsxRuntimeExports.jsx(fluentMoney20Regular,{className:Qe})).with({permission:"commercialUses",allowed:!1},()=>jsxRuntimeExports.jsx(fluentMoneyOff20Regular,{className:Qe})).with({permission:"shouldCreditAuthor"},()=>jsxRuntimeExports.jsx(fluentPersonStarburst20Regular,{className:Qe})).with({allowed:!0},()=>jsxRuntimeExports.jsx(icBaselineCheck,{className:Qe})).with({allowed:!1},()=>jsxRuntimeExports.jsx(icBaselineClose,{className:Qe})).exhaustive()}const columnClassNames=["col-start-1","col-start-2","col-start-3","col-start-4"],lgColumnClassNames=["lg:col-start-1","lg:col-start-2","lg:col-start-3","lg:col-start-4"];function ArtworkFeedAdUnit(He){const Qe=He.ad,it=useIsLg(),{data:lt}=useUserInfo(),ut=new URL(Qe.targetUrl??"#",location.origin),dt=ut.origin===location.origin,xt=dt&&ut.pathname==="/membership/plans",ft={category:"main_feed",scene:"home",position:it?He.lgPosition:He.position,tracking_id:Qe.trackingId},vt=useCampaignViewTracker(ft);return jsxRuntimeExports.jsxs("div",{ref:vt,className:cx("row-start-1",He.position?columnClassNames[He.position]:void 0,(He.position??0)>=2?"max-lg:hidden":void 0,He.lgPosition?lgColumnClassNames[He.lgPosition]:void 0,"w-full h-full group relative isolate p-0.5","@container"),children:[jsxRuntimeExports.jsx("div",{className:"z-[-1] absolute inset-0 rounded-lg bg-gradient-member mmd:-inset-0.5 mmd:rounded-[0.625rem] transition ease-out duration-300 group-hover:shadow-xl"}),jsxRuntimeExports.jsxs(Link,{className:"block bg-background-secondary w-full h-full rounded-md overflow-hidden hover:no-underline",to:Qe.targetUrl??"#",target:dt?void 0:"_blank",onClick:kt=>{if(!lt&&!Qe.isClickableForNonLoginUser){openSignModal(void 0,{fromPath:"campaign"}),kt.preventDefault();return}if(xt){const St="homepage-in-feed-ad-unit";track("enter_member_click",{location:St}),startEventGroup("member_source",St,{persistent:!0})}trackCampaignClick(ft),dt&&setTimeout(()=>{window.scrollTo(0,0)},100)},children:[jsxRuntimeExports.jsxs("div",{className:"relative w-full aspect-square bg-active overflow-hidden",children:[jsxRuntimeExports.jsx(AdMedia,{className:"w-full aspect-square",mediaType:Qe.type,mediaSpec:Qe.media}),Qe.isAd?jsxRuntimeExports.jsx(AdLabel,{className:"absolute md:hidden bottom-2 right-2"}):null]}),jsxRuntimeExports.jsxs("div",{className:"relative flex items-center gap-1.5 w-full h-14 pl-2 pb-0.5",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-stretch gap-0.5 min-w-0 px-1 py-1.5",children:[jsxRuntimeExports.jsx("div",{className:"text-left min-h-[1rem] text-sm font-semibold truncate",children:jsxRuntimeExports.jsx("span",{title:Qe.title,children:Qe.title})}),jsxRuntimeExports.jsx("div",{className:"text-left w-auto min-h-[1rem] text-xs text-primary-light truncate",children:Qe.description})]}),jsxRuntimeExports.jsx("div",{className:"flex-1"}),Qe.isAd?jsxRuntimeExports.jsx(AdLabel,{className:"flex-shrink-0 mr-4 max-md:hidden"}):null]})]})]})}const calculateFeedAdPosition=(He,Qe)=>He.length===2?He.map((it,lt)=>({ad:it,position:lt,lgPosition:[0,3][lt]})).filter(({ad:it})=>Qe(it)):He.filter(it=>Qe(it)).slice(0,4).map((it,lt)=>({ad:it,position:lt,lgPosition:lt}));function ArtworkFeedCampaignAdUnits(){const{data:{subscription:He}={}}=useMyMembership(),{i18n:Qe}=useTranslation(),{data:it=[]}=useCampaignAds({lang:Qe.language,category:"feed"}),lt=calculateFeedAdPosition(it,ut=>checkAdUnitConditionWithMembership(ut,He));return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:lt.slice(0,4).map(({ad:ut,position:dt,lgPosition:xt})=>jsxRuntimeExports.jsx(ArtworkFeedAdUnit,{ad:ut,position:dt,lgPosition:xt},ut.trackingId))})}function insertCampaignAdUnitInGrid(He){return[jsxRuntimeExports.jsx(ArtworkFeedCampaignAdUnits,{},"feed ads"),...He]}const mdiBrush=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m20.71 4.63l-1.34-1.34c-.37-.39-1.02-.39-1.41 0L9 12.25L11.75 15l8.96-8.96c.39-.39.39-1.04 0-1.41M7 14a3 3 0 0 0-3 3c0 1.31-1.16 2-2 2c.92 1.22 2.5 2 4 2a4 4 0 0 0 4-4a3 3 0 0 0-3-3Z"})});function SimpleGenerationFormContent(){const{t:He}=useTranslation(["artwork","generation","workflow"]),Qe=useNavigate(),{loading:it,submit:lt}=useTaskSubmitFormContext(),{data:ut}=useUserInfo(),{data:dt,isLoading:xt}=useDynamicConstants({revalidateOnFocus:!1}),vt=dt?.simpleGenerationModelIds?.[0],{data:kt,isLoading:St}=useGenerationModelByVersionId(vt,{revalidateOnFocus:!1}),Tt=kt?.model?.type,Mt=SIDEBAR_SIZES.find(Kt=>Kt.extraProps?.modelType===Tt),[Nt,At]=useLocalStorage({key:"sgfiv",defaultValue:""}),$t=reactExports.useRef(null),Dt=Kt=>jsxRuntimeExports.jsx(UIButton$1,{ref:$t,color:"theme",variant:"filled",className:cx("w-auto h-12 px-7 mlg:px-[30px] text-white disabled:bg-opacity-40 rounded-xl transition text-base font-semibold","bg-theme-primary hover:bg-violet-500 dark:bg-violet-600",Kt.className),onFocus:Jt=>Jt.stopPropagation(),onPress:()=>{track("start_creating_click");const Jt={modelId:vt,...Mt,...pick$1(defaultTaskFormValues,["batchSize","negativePrompts","samplingSteps","samplingMethod","cfgScale"]),...getDefaultParamsFromModelVersionExtra({versionExtra:kt?.extra,modelId:kt?.model?.id,modelType:kt?.model?.type},{enableLightningMode:!0}),isHomepage:!0,prompts:Nt};if(startEventGroup("generate_source"),Nt==="")return Qe(ut?"/generator":withQuery("/generator",{showSignUpModal:1,signupModalRedirect:joinURL(window.location.origin,"generator")}));if(!ut)return Qe(withQuery("/generator",{showSignUpModal:1,initialValues:encodeInitialValuesForImport(Jt),submitTask:1,signupModalRedirect:withQuery(`${joinURL(window.location.origin,"generator")}`,{initialValues:encodeInitialValuesForImport(Jt),submitTask:1})}));try{lt(async()=>Jt,hr=>{Qe(`/generator/image?${formatQs({task:encodeTaskForImport(hr.createGenerationTask),showOnStage:"1"})}`)},{hideSubmissionToast:!0})}catch{endEventGroup("generate_source")}},disabled:Nt!==""&&(xt||St),busy:it,children:jsxRuntimeExports.jsx("span",{className:"relative",children:He("common:home.start-creating.label")})}),Ft=useObserveSimpleGenIntersection(),[Bt,Ot]=reactExports.useState(Nt.length>0),Qt=useBreakpoint("mlg"),[Wt,Xt]=useTagComplete();return jsxRuntimeExports.jsxs(PromptsCompletionProvider,{enable:Wt&&!Qt,setEnable:Xt,children:[!Qt&&Bt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{id:WORKBENCH_OVERLAY_ID,className:"fixed top-0 left-0 z-40 w-full h-0"}),jsxRuntimeExports.jsx(PromptsCompletionDisplay,{})]}),jsxRuntimeExports.jsxs("div",{ref:Ft,className:cx("mx-auto w-full max-w-3xl flex justify-center gap-2 rounded-xl mlg:rounded-2xl p-2 items-start bg-neutral-50 dark:bg-neutral-900 shadow-md","transition-all duration-300",Bt?"h-40":"h-16"),onFocus:()=>Ot(!0),onBlur:Kt=>{$t.current&&Kt.relatedTarget===$t.current||Nt===""&&Ot(!1)},children:[jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center px-3 h-12",children:jsxRuntimeExports.jsx(mdiBrush,{className:"text-primary opacity-50 size-6"})}),jsxRuntimeExports.jsx(PromptsCompletionTextarea,{id:"simple-generation-form",rows:Bt?4:1,value:Nt,placeholder:He("artwork:generation.placeholder"),onChange:Kt=>{const Jt=Kt.target.value;At(Jt)},className:"mx-auto py-3 flex-1 relative bg-transparent transition-all outline-none resize-none placeholder:truncate"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col mt-auto flex-shrink-0",children:[!Qt&&jsxRuntimeExports.jsx(PromptsCompletionButton,{labelPlacement:"end",className:cx("relative mx-auto transition-all duration-300",Bt?"-top-2 opacity-100 max-h-4":"top-0 opacity-0 max-h-0",!Bt&&"pointer-events-none")}),jsxRuntimeExports.jsx(Dt,{className:"mt-auto"})]})]})]})}function SimpleGenerationForm(){return jsxRuntimeExports.jsx(BaseTaskSubmitForm,{children:jsxRuntimeExports.jsx(SimpleGenerationFormContent,{})})}const SITE_NAME="PixAI",ENV_STR=`${SITE_NAME}`,ORIGIN=globalThis.window?.location.origin||"https://pixai.art",CANONICAL_ORIGIN="https://pixai.art";function MetaTitle(He){const{content:Qe,options:it}=He,lt=reactExports.useMemo(()=>{const ut=`${ENV_STR}${it?.suffix?` - ${it?.suffix}`:""}`;return Qe?Qe+" | "+ut:ut},[Qe,it?.suffix]);return jsxRuntimeExports.jsxs(Helmet,{children:[jsxRuntimeExports.jsx("title",{children:lt}),jsxRuntimeExports.jsx("meta",{property:"og:title",content:lt}),jsxRuntimeExports.jsx("meta",{name:"twitter:title",content:lt})]})}function MetaDescription(He){const{content:Qe}=He;return jsxRuntimeExports.jsxs(Helmet,{children:[jsxRuntimeExports.jsx("meta",{name:"description",content:Qe}),jsxRuntimeExports.jsx("meta",{property:"og:description",content:Qe}),jsxRuntimeExports.jsx("meta",{name:"twitter:description",content:Qe})]})}function MetaOgUrl(He){const Qe=joinURL(ORIGIN,He.pathname??"");return jsxRuntimeExports.jsxs(Helmet,{children:[jsxRuntimeExports.jsx("meta",{property:"og:url",content:Qe}),jsxRuntimeExports.jsx("meta",{name:"twitter:url",content:Qe})]})}function MetaThumbnail(He){const Qe=getSmartThumbnailUrl(He.media);return Qe?jsxRuntimeExports.jsx(Helmet,{children:jsxRuntimeExports.jsx("meta",{property:"og:image",content:Qe})}):null}const MetaCanonicalURL=reactExports.memo(He=>(reactExports.useEffect(()=>{if(He.href){const Qe=document.querySelectorAll('link[rel="canonical"]'),it=resolveURL(CANONICAL_ORIGIN,withoutHost(He.href));if(Qe.length===0){const lt=document.createElement("link");lt.setAttribute("rel","canonical"),lt.setAttribute("href",it),document.head.appendChild(lt)}else Qe.length>1&&console.warn("Multiple canonical links found"),Qe.forEach(lt=>{lt.setAttribute("href",it)})}},[He]),null));function DefaultHelmetTags(){return jsxRuntimeExports.jsxs(Helmet,{children:[jsxRuntimeExports.jsx("meta",{name:"description",content:"PixAI is a community where you can share and browse artworks generated by AI with text. You can also generate your own artworks here."}),jsxRuntimeExports.jsx("meta",{property:"og:url",content:ORIGIN}),jsxRuntimeExports.jsx("meta",{property:"og:image",content:"https://imagedelivery.net/5ejkUOtsMH5sf63fw6q33Q/0d8c0aee-c2eb-436a-a70d-262b4a9a0700/thumbnail"}),jsxRuntimeExports.jsx("meta",{name:"twitter:title",content:"PixAI - Anime AI Art Generator for Free"}),jsxRuntimeExports.jsx("meta",{name:"twitter:description",content:"PixAI is a community where you can share and browse artworks generated by AI with text. You can also generate your own artworks here."}),jsxRuntimeExports.jsx("meta",{property:"og:title",content:"PixAI - Anime AI Art Generator for Free"}),jsxRuntimeExports.jsx("meta",{property:"og:description",content:"PixAI is a community where you can share and browse artworks generated by AI with text. You can also generate your own artworks here."})]})}function MetaTags(He){const{title:Qe,titleOptions:it,description:lt,thumbnailMedia:ut,ogUrlPathname:dt,canonicalURL:xt}=He;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Qe&&jsxRuntimeExports.jsx(MetaTitle,{content:Qe,options:it}),lt&&jsxRuntimeExports.jsx(MetaDescription,{content:lt}),ut&&jsxRuntimeExports.jsx(MetaThumbnail,{media:ut}),dt&&jsxRuntimeExports.jsx(MetaOgUrl,{pathname:dt}),xt&&jsxRuntimeExports.jsx(MetaCanonicalURL,{href:xt})]})}function DefaultMetaTitle(){const{t:He}=useTranslation(["common"]);return jsxRuntimeExports.jsx(MetaTitle,{options:{suffix:He("common:meta.title.home-suffix")}})}function getCanonicalURL(He){const Qe=new URL(He),it=new URLSearchParams(Qe.search),lt=Array.from(it.keys());for(const ut of lt)ut!=="q"&&ut!=="keyword"&&it.delete(ut);return Qe.search=it.toString(),Qe.href}function DefaultMetaCanonicalURL(){const He=getCanonicalURL(window.location.href);return jsxRuntimeExports.jsx(MetaCanonicalURL,{href:He})}const TagDescription=({tagInfo:He,className:Qe,style:it})=>{const{t:lt}=useTranslation(["common"]);return jsxRuntimeExports.jsxs("div",{className:Qe,style:it,children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-4 items-center flex-wrap",children:[He.selectedContestTag&&jsxRuntimeExports.jsxs("div",{className:"font-bold leading-5",children:["#",He.name]}),He.selectedContestTag?He.selectedContestTag.isInProgress?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Chip,{size:"small",color:"error",label:lt("common:in-progress")}),jsxRuntimeExports.jsx(Link,{to:`/generator?challenge=${He.selectedContestTag?.cid}`,onClick:()=>{track("contest_join_click"),startEventGroup("generate_source")},children:lt("common:click-here-to-join-contest")})]}):He.selectedContestTag.isEnded?jsxRuntimeExports.jsx(Chip,{size:"small",color:"default",label:lt("common:ended")}):null:null]}),He.description?jsxRuntimeExports.jsx(MarkdownRenderer,{className:"prose dark:prose-invert w-full max-w-full [&_img]:m-auto",onClick:()=>{track("animate_learn_click")},children:He.description}):null]})},icBaselineArrowBackIos=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M11.67 3.87L9.9 2.1L0 12l9.9 9.9l1.77-1.77L3.54 12z"})}),icBaselineArrowForwardIos=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M6.23 20.23L8 22l10-10L8 2L6.23 3.77L14.46 12z"})}),HorizontalScrollable=reactExports.forwardRef(({children:He,className:Qe,style:it,showScrollButton:lt=!0},ut)=>{const dt=reactExports.useRef(null),xt=reactExports.useRef(null);reactExports.useImperativeHandle(ut,()=>xt),reactExports.useLayoutEffect(()=>{const Nt=xt.current;if(!Nt)return;const At=60,$t=()=>{const{scrollLeft:Dt,scrollWidth:Ft,clientWidth:Bt}=Nt,Ot=Dt,Qt=Ft-Bt-Dt,Wt=Ot>At?0:1-Ot/At,Xt=Qt>At?0:1-Qt/At,Kt=`linear-gradient(to right, rgba(255, 255, 255, ${Wt}) 0%, rgba(255, 255, 255, 1) ${At}px, rgba(255, 255, 255, 1) calc(100% - ${At}px), rgba(255, 255, 255, ${Xt}) 100%)`;dt.current&&(dt.current.style.mask=Kt,dt.current.style.webkitMask=Kt)};return Nt.addEventListener("scroll",$t,{passive:!0}),$t(),()=>{Nt.removeEventListener("scroll",$t)}},[]);const{ref:ft,entry:vt}=useIntersection({root:dt.current}),kt=!vt?.isIntersecting,{ref:St,entry:Tt}=useIntersection({root:dt.current}),Mt=!!Tt?.isIntersecting;return jsxRuntimeExports.jsxs("div",{ref:dt,className:"relative",children:[jsxRuntimeExports.jsxs("div",{ref:xt,className:cx("overflow-x-auto overflow-y-visible relative hide-scrollbar flex *:flex-none"),children:[jsxRuntimeExports.jsx("div",{ref:ft,className:"size-px -mr-px pointer-events-none"}),jsxRuntimeExports.jsx("div",{className:Qe,style:it,children:He}),jsxRuntimeExports.jsx("div",{ref:St,className:"size-px -ml-px pointer-events-none"})]}),lt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:cx(kt?"w-[100px]":"w-0","transition-all absolute top-0 bottom-0 left-0 overflow-hidden flex items-center justify-start"),style:{opacity:kt?1:0},children:jsxRuntimeExports.jsx("button",{className:"flex items-center h-full py-2 px-4 transition rounded-none bg-gradient-to-r hover:from-zinc-900/20 active:from-zinc-900/60 to-transparent",onClick:()=>{xt.current?.scrollBy({left:-100,behavior:"smooth"})},children:jsxRuntimeExports.jsx(icBaselineArrowBackIos,{className:"size-6"})})}),jsxRuntimeExports.jsx("div",{className:cx(Mt?"w-0":"w-[100px]","transition-all absolute top-0 bottom-0 right-0 overflow-hidden flex items-center justify-end"),style:{opacity:Mt?0:1},children:jsxRuntimeExports.jsx("button",{className:"flex items-center h-full py-2 px-4 transition rounded-none bg-gradient-to-l hover:from-zinc-900/20 active:from-zinc-900/60 to-transparent",onClick:()=>{xt.current?.scrollBy({left:100,behavior:"smooth"})},children:jsxRuntimeExports.jsx(icBaselineArrowForwardIos,{className:"size-6"})})})]})]})});HorizontalScrollable.displayName="HorizontalScrollable";const TagGalleryItem=He=>{const{name:Qe,active:it,onClick:lt=()=>{},icon:ut,mediaId:dt,displayName:xt=Qe,scene:ft,to:vt}=He,kt=getImageThumbnailUrl(dt);return jsxRuntimeExports.jsxs(ButtonBase,{className:cx("px-1.5 py-1 pr-2 flex flex-row gap-1 items-center rounded-lg transition hover:shadow active:shadow-md hover:no-underline",it?"bg-purple-600 shadow-sm":"bg-neutral-200/50 hover:bg-neutral-300/80 active:bg-[rgba(0,0,0,0.18)]"),onClick:()=>{lt(),track("tag_click",{tag:Qe,isCancel:it,scene:ft});const St=document.querySelector("#tag-gallery");St&&St.scrollIntoView({behavior:"smooth"})},title:xt,...vt?{component:Link,to:vt}:{},children:[ut?jsxRuntimeExports.jsx("div",{className:cx(it?"text-white":"text-primary"),children:ut}):jsxRuntimeExports.jsx("div",{className:"w-max",children:kt&&jsxRuntimeExports.jsx("img",{src:kt,alt:xt,width:24,height:24,className:"object-cover w-[24px] h-[24px] rounded-full",loading:"lazy"})}),jsxRuntimeExports.jsx("p",{className:cx("text-sm group-hover:bg-hover capitalize whitespace-nowrap w-min",it?"text-white font-semibold":"text-primary"),children:xt})]})},useTagCategories=()=>{const{data:He}=useDynamicConstants(),Qe=useContestConfig(),it=reactExports.useMemo(()=>{let lt=He?.tag?.categories?.slice()||[];return Qe&&(lt=lt.concat(Qe)),lt},[He,Qe.length]);return reactExports.useEffect(()=>{for(const lt of it)if(lt.locales)for(const[ut,dt]of Object.entries(lt.locales))i18n.addResourceBundle(ut,"common",{[`tag.${lt.name}`]:cloneDeep$1(dt)},!0,!0);i18n.emit("languageChanged")},[it]),it},TagGallery=reactExports.memo(He=>{const{className:Qe,listTagVariables:it,scene:lt,prependTagAlikeItems:ut=[],contestItemsStayFirst:dt=!1}=He,{t:xt}=useTranslation("common"),ft=useTagCategories(),vt=useContestConfig(),[kt,St]=useQs(),{tag:Tt,challenge:Mt,cate:Nt=ft[0]?.name}=kt,At=He.currentTag||Tt,{data:$t,loading:Dt}=useListTags(Nt?{...it,first:50,orderBy:"-weight"}:skipToken),Ft=reactExports.useMemo(()=>getNodesFromConnection($t),[$t]),Bt=reactExports.useMemo(()=>Ft.map(Kt=>Kt.name).includes(At),[At,Ft]),{data:Ot}=useGetTag(!Bt&&He.displayUnknownTag&&At?At:skipToken),Qt=[];for(const Kt of vt){const{id:Jt,name:hr,cid:xr,mediaId:gr,isInProgress:br}=Kt;if(!br)continue;const vr=At==="challenge"&&+Mt===xr,Cr={displayName:xt(`common:contest.tag.${hr}.name`,{defaultValue:hr}),active:vr,name:hr,mediaId:gr};He.navigateToContest&&(Cr.to=He.navigateToContest({id:Jt,cid:xr,active:vr})),Qt.push(jsxRuntimeExports.jsx(TagGalleryItem,{...Cr},hr))}const Wt=ut.map(Kt=>jsxRuntimeExports.jsx(TagGalleryItem,{name:Kt.name,displayName:Kt.displayName,onClick:Kt.onClick,active:Kt.selected,icon:Kt.icon},Kt.name));let Xt;if(dt?Xt=[...Qt,...Wt]:Xt=[...Wt,...Qt],Ft.length>0){if(!Bt&&He.displayUnknownTag){const Kt=Ot||{id:At,name:At,mediaId:void 0},Jt=Kt.name===At,hr={name:Kt.name,active:Jt,scene:lt,mediaId:Kt.mediaId};He.navigateToTag?hr.to=He.navigateToTag(Kt.name):hr.onClick=()=>{St({tag:Jt?null:Kt.name,challenge:null})},Xt.push(jsxRuntimeExports.jsx(TagGalleryItem,{...hr},Kt.id))}for(const Kt of Ft){const Jt=Kt.name===At,hr={name:Kt.name,active:Jt,scene:lt,mediaId:Kt.mediaId};He.navigateToTag?hr.to=He.navigateToTag(Kt.name):hr.onClick=()=>{St({tag:Jt?null:Kt.name,challenge:null})},Xt.push(jsxRuntimeExports.jsx(TagGalleryItem,{...hr},Kt.id))}}else if(Dt)for(let Kt=0;Kt<10;Kt++)Xt.push(jsxRuntimeExports.jsxs("div",{className:"min-w-[80px] flex gap-1 items-center rounded-lg px-1.5 py-1",children:[jsxRuntimeExports.jsx("div",{className:"w-[24px] h-[24px] rounded-full bg-skeleton animate-pulse"}),jsxRuntimeExports.jsx("div",{className:"rounded w-[40px] animate-pulse h-4 bg-skeleton"})]},Kt));return jsxRuntimeExports.jsx("div",{className:cx("w-full flex flex-col",Qe),id:"tag-gallery",children:jsxRuntimeExports.jsx(HorizontalScrollable,{className:"flex min-w-full gap-1 py-1.5",children:Xt})})});TagGallery.displayName="memo(TagGallery)";const useTagInfo=He=>{const{t:Qe}=useTranslation(["common"]),it=useContestConfig(),{data:lt}=useGetTag(He??skipToken),[ut]=useQs(),dt=+ut?.challenge;return reactExports.useMemo(()=>{if(He==="challenge"){const xt=it?.find(ft=>ft.cid===dt);return xt?{name:Qe("common:contest.contest-name",{name:Qe(`common:contest.tag.${xt.name}.name`,{defaultValue:xt.name})}),description:Qe(`common:contest.tag.${xt.name}.description`,{defaultValue:null}),selectedContestTag:xt}:{name:He}}return lt?{name:lt.name,description:lt.extra?.description}:{name:He}},[it,He,dt,lt,Qe])},BannerCn="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/banner-cn-DeTFXau6.webp",BannerEn="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/banner-en-BoURJsF3.webp",BannerJp="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/banner-jp-vCaC6w1e.webp",BannerKr="https://cdn.pixai.art/artifacts/app-0ec442be81a4ee21bfcf5745e8ef10bc76836958/assets/banner-kr-zsp6wkmE.webp";function AugustEventEntryBanner({className:He,style:Qe}){const{i18n:it}=useTranslation(),lt=$$3(it.resolvedLanguage).with("zh",()=>BannerCn).with("kr",()=>BannerKr).with("ja",()=>BannerJp).otherwise(()=>BannerEn);return jsxRuntimeExports.jsx(Link,{to:"/event/august-2025",className:twMerge("block no-underline text-black bg-repeat rounded-xl",He),style:{...Qe},children:jsxRuntimeExports.jsx("img",{className:" w-[330px]",src:lt})})}const solarCupStarLinear=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsxs("g",{fill:"none",stroke:"currentColor",strokeWidth:1.5,children:[jsxRuntimeExports.jsx("path",{d:"M12 16c-5.76 0-6.78-5.74-6.96-10.294c-.051-1.266-.076-1.9.4-2.485c.475-.586 1.044-.682 2.183-.874A26.374 26.374 0 0 1 12 2c1.784 0 3.253.157 4.377.347c1.139.192 1.708.288 2.184.874c.476.586.45 1.219.4 2.485c-.18 4.553-1.2 10.294-6.96 10.294Z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",d:"M12 16v3"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.5 22h-7l.34-1.696a1 1 0 0 1 .98-.804h4.36a1 1 0 0 1 .98.804L15.5 22Z"}),jsxRuntimeExports.jsx("path",{d:"m19 5l.949.316c.99.33 1.485.495 1.768.888c.283.393.283.915.283 1.958v.073c0 .86 0 1.291-.207 1.643c-.207.352-.584.561-1.336.98L17.5 12.5M5 5l-.949.316c-.99.33-1.485.495-1.768.888C2 6.597 2 7.12 2 8.162v.073c0 .86 0 1.291.207 1.643c.207.352.584.561 1.336.98L6.5 12.5m4.646-6.477C11.526 5.34 11.716 5 12 5c.284 0 .474.34.854 1.023l.098.176c.108.194.162.29.246.354c.085.064.19.088.4.135l.19.044c.738.167 1.107.25 1.195.532c.088.283-.164.577-.667 1.165l-.13.152c-.143.167-.215.25-.247.354c-.032.104-.021.215 0 .438l.02.203c.076.785.114 1.178-.115 1.352c-.23.174-.576.015-1.267-.303l-.178-.082c-.197-.09-.295-.135-.399-.135c-.104 0-.202.045-.399.135l-.178.082c-.691.319-1.037.477-1.267.303c-.23-.174-.191-.567-.115-1.352l.02-.203c.021-.223.032-.334 0-.438c-.032-.103-.104-.187-.247-.354l-.13-.152c-.503-.588-.755-.882-.667-1.165c.088-.282.457-.365 1.195-.532l.19-.044c.21-.047.315-.07.4-.135c.084-.064.138-.16.246-.354l.098-.176Z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",d:"M18 22H6"})]})}),ArtworkListPageContext=reactExports.createContext({}),useArtworkListPageContext=()=>reactExports.useContext(ArtworkListPageContext),ArtworkListPage=()=>{const{t:He}=useTranslation(["common","artwork","manga"]),[Qe,it]=useOrderState(defaultChoicesForHome),[{tag:lt,aid:ut,type:dt},xt]=useQs(),ft=Bt=>xt(Ot=>({...Ot,type:Bt})),vt=useTagInfo(lt),kt=useArtworkListTagQueryTitle({tag:lt,tagInfo:vt}),St=useArtworkListTagQueryDescription({tag:lt,tagInfo:vt}),Tt=useRefreshCount(),Mt=reactExports.useMemo(()=>JSON.stringify({tag:lt,order:Qe,type:dt,refreshTime:Tt}),[lt,Qe,dt,Tt]),Nt=[{label:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5",children:[He("common:order-option.recommend"),jsxRuntimeExports.jsx("span",{className:"text-xs text-white bg-cyan-500 rounded-md px-1.5 py-0.5 font-normal",children:"Beta"})]}),value:OrderOption.recommended},{label:He("common:order-option.random"),value:OrderOption.trending},{label:He("common:order-option.daily-ranking"),value:OrderOption.dailyRanking},{label:He("common:order-option.following-news"),value:OrderOption.followingNews},{label:He("common:order-option.most-liked"),value:OrderOption.mostLiked},{label:He("common:order-option.newest"),value:OrderOption.newest}],At=reactExports.useMemo(()=>({selectedContestTag:vt.selectedContestTag}),[vt]),$t=reactExports.useMemo(()=>({icon:jsxRuntimeExports.jsx(riVideoAiLine,{}),displayName:He("common:ranking.animated.label"),name:ArtworkTypeFilterValue.Animated,onClick:()=>{track("order_click",{value:ArtworkTypeFilterValue.Animated,scene:"home"}),dt!==ArtworkTypeFilterValue.Animated&&Qe===OrderOption.recommended&&it(OrderOption.dailyRanking),ft(dt===ArtworkTypeFilterValue.Animated?ArtworkTypeFilterValue.All:ArtworkTypeFilterValue.Animated)},selected:dt===ArtworkTypeFilterValue.Animated}),[dt,Qe]),{ongoing:Dt}=useGrowthEvent(GrowthEventName.AugustEvent2025);if(ut!=null)return jsxRuntimeExports.jsx(Navigate,{to:`/artwork/${ut}/relevant`});const Ft=jsxRuntimeExports.jsxs("div",{children:[Dt&&jsxRuntimeExports.jsx(AugustEventEntryBanner,{className:"mt-8 mx-auto w-fit"}),jsxRuntimeExports.jsx("div",{className:"py-4 msm:py-8",children:jsxRuntimeExports.jsx(SimpleGenerationForm,{})}),jsxRuntimeExports.jsxs("div",{className:"mb-4 flex flex-wrap gap-2",children:[jsxRuntimeExports.jsx(OrderSelect,{choices:Nt,alwaysCollapse:!0,value:Qe,onChange:Bt=>(track("order_click",{value:Bt,scene:"home"}),trackImageForRec("reco_browser_path_switch",{fromFeed:Qe,toFeed:Bt},{regenFeedUuid:!0}),Bt===OrderOption.recommended&&ft(ArtworkTypeFilterValue.All),it(Bt))}),jsxRuntimeExports.jsxs(Button,{component:Link,to:"/contest",className:"grow-0 shrink leading-tight font-semibold gap-1 bg-[#eee] dark:bg-background-light dark:text-primary px-4 py-2",children:[jsxRuntimeExports.jsx(solarCupStarLinear,{className:"mr-1 my-0.5 size-5"}),jsxRuntimeExports.jsx("span",{className:"text-[0.8125rem]",children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:tab.contest"})})]}),jsxRuntimeExports.jsx(TagGallery,{scene:"home",navigateToTag:Bt=>createTagPageUrl("artwork",Bt),navigateToContest:({id:Bt})=>`/contest/${Bt}`,className:"mmd:flex-1 max-mmd:w-full mmd:pl-2 overflow-hidden",prependTagAlikeItems:[$t]}),lt&&jsxRuntimeExports.jsx(TagDescription,{tagInfo:vt,className:"flex-none w-full"})]}),jsxRuntimeExports.jsx(StatefulArtworkGrid,{tag:lt,order:translateOrderOptionForArtworkListQuery(Qe),...getArtworkQueryArgsByTypeFilter(dt),trackingArgs:{scene:"home",feed:Qe},enableTracking:!0,showDislike:!0,modifyArtworkElements:insertCampaignAdUnitInGrid},Mt)]});return jsxRuntimeExports.jsxs(ArtworkListPageContext.Provider,{value:At,children:[jsxRuntimeExports.jsx(MetaTags,{title:kt,titleOptions:{suffix:He("common:meta.title.home-suffix")},description:St,ogUrlPathname:formatQs({tag:lt})?`/?${formatQs({tag:lt})}`:""}),Ft]})},icBaselineAssistant=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h4l3 3l3-3h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-5.12 10.88L12 17l-1.88-4.12L6 11l4.12-1.88L12 5l1.88 4.12L18 11l-4.12 1.88z"})}),icBaselineAutoAwesome=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m19 9l1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25L19 9zm-7.5.5L9 4L6.5 9.5L1 12l5.5 2.5L9 20l2.5-5.5L17 12l-5.5-2.5zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25L19 15z"})}),icBaselineFavorite=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),icBaselineFavoriteBorder=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3C4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5C22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1l-.1-.1C7.14 14.24 4 11.39 4 8.5C4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5c0 2.89-3.14 5.74-7.9 10.05z"})}),icBaselineLocalFireDepartment=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m12 12.9l-2.13 2.09c-.56.56-.87 1.29-.87 2.07C9 18.68 10.35 20 12 20s3-1.32 3-2.94c0-.78-.31-1.52-.87-2.07L12 12.9z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m16 6l-.44.55C14.38 8.02 12 7.19 12 5.3V2S4 6 4 13c0 2.92 1.56 5.47 3.89 6.86c-.56-.79-.89-1.76-.89-2.8c0-1.32.52-2.56 1.47-3.5L12 10.1l3.53 3.47c.95.93 1.47 2.17 1.47 3.5c0 1.02-.31 1.96-.85 2.75c1.89-1.15 3.29-3.06 3.71-5.3c.66-3.55-1.07-6.9-3.86-8.52z"})]}),icBaselinePeople=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05c1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})}),icBaselinePeopleOutline=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M16.5 13c-1.2 0-3.07.34-4.5 1c-1.43-.67-3.3-1-4.5-1C5.33 13 1 14.08 1 16.25V19h22v-2.75c0-2.17-4.33-3.25-6.5-3.25zm-4 4.5h-10v-1.25c0-.54 2.56-1.75 5-1.75s5 1.21 5 1.75v1.25zm9 0H14v-1.25c0-.46-.2-.86-.52-1.22c.88-.3 1.96-.53 3.02-.53c2.44 0 5 1.21 5 1.75v1.25zM7.5 12c1.93 0 3.5-1.57 3.5-3.5S9.43 5 7.5 5S4 6.57 4 8.5S5.57 12 7.5 12zm0-5.5c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2zm9 5.5c1.93 0 3.5-1.57 3.5-3.5S18.43 5 16.5 5S13 6.57 13 8.5s1.57 3.5 3.5 3.5zm0-5.5c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2z"})}),icBaselineSmartToy=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M20 9V7c0-1.1-.9-2-2-2h-3c0-1.66-1.34-3-3-3S9 3.34 9 5H6c-1.1 0-2 .9-2 2v2c-1.66 0-3 1.34-3 3s1.34 3 3 3v4c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-4c1.66 0 3-1.34 3-3s-1.34-3-3-3zM7.5 11.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5S9.83 13 9 13s-1.5-.67-1.5-1.5zM16 17H8v-2h8v2zm-1-4c-.83 0-1.5-.67-1.5-1.5S14.17 10 15 10s1.5.67 1.5 1.5S15.83 13 15 13z"})}),icBaselineTrendingUp=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m16 6l2.29 2.29l-4.88 4.88l-4-4L2 16.59L3.41 18l6-6l4 4l6.3-6.29L22 12V6z"})}),icBaselineWhatshot=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73c-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67zM11.71 19c-1.78 0-3.22-1.4-3.22-3.14c0-1.62 1.05-2.76 2.81-3.12c1.77-.36 3.6-1.21 4.62-2.58c.39 1.29.59 2.65.59 4.04c0 2.65-2.15 4.8-4.8 4.8z"})}),mdiSortAscending=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 17h3l-4 4l-4-4h3V3h2M2 17h10v2H2M6 5v2H2V5m0 6h7v2H2v-2Z"})}),mdiSortDescending=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 7h3l-4-4l-4 4h3v14h2M2 17h10v2H2M6 5v2H2V5m0 6h7v2H2v-2Z"})}),StyledToggleButtonGroup=styled(ToggleButtonGroup)(({theme:He})=>({flexWrap:"wrap","& .MuiToggleButtonGroup-grouped":{border:0,padding:"8px 16px","&.Mui-disabled":{border:0},"&:not(:first-of-type)":{borderRadius:"9999px"},"&:first-of-type":{borderRadius:"9999px"}}})),StyledSelect=styled(Select)(({theme:He})=>({backgroundColor:"#eee",borderRadius:"9999px","& .MuiSelect-select":{display:"flex",alignItems:"center",padding:"0.5rem 1rem",gap:"4px",fontWeight:600},"& .Mui-selected":{fontWeight:700},"& .MuiOutlinedInput-notchedOutline":{border:0}})),defaultChoicesForHome=[OrderOption.recommended,OrderOption.random,OrderOption.dailyRanking,OrderOption.followingNews,OrderOption.mostLiked,OrderOption.newest],defaultChoices=[OrderOption.random,OrderOption.dailyRanking,OrderOption.followingNews,OrderOption.mostLiked,OrderOption.newest],orderIconMap={[OrderOption.dailyRanking]:({active:He,className:Qe,...it})=>jsxRuntimeExports.jsx(icBaselineWhatshot,{className:cx(Qe,{"text-orange-600":He}),...it}),[OrderOption.followingNews]:({active:He,className:Qe,...it})=>He?jsxRuntimeExports.jsx(icBaselinePeople,{className:cx("text-blue-600",Qe),...it}):jsxRuntimeExports.jsx(icBaselinePeopleOutline,{className:Qe,...it}),[OrderOption.mostLiked]:({active:He,className:Qe,...it})=>He?jsxRuntimeExports.jsx(icBaselineFavorite,{className:cx("text-red-500",Qe),...it}):jsxRuntimeExports.jsx(icBaselineFavoriteBorder,{className:Qe,...it}),[OrderOption.random]:({active:He,className:Qe,...it})=>jsxRuntimeExports.jsx(icBaselineTrendingUp,{className:cx(Qe,{"text-purple-500":He}),...it}),[OrderOption.newest]:({active:He,className:Qe,...it})=>jsxRuntimeExports.jsx(mdiSortAscending,{className:cx(Qe,{"text-emerald-500":He}),...it}),[OrderOption.oldest]:({active:He,className:Qe,...it})=>jsxRuntimeExports.jsx(mdiSortDescending,{className:cx(Qe,{"text-emerald-500":He}),...it}),[OrderOption.mostUsed]:({active:He,className:Qe,...it})=>jsxRuntimeExports.jsx(icBaselineLocalFireDepartment,{className:cx(Qe,{"text-orange-300":He}),...it}),[GenerationModelType.Lora]:({active:He,className:Qe,...it})=>jsxRuntimeExports.jsx(icBaselineAutoAwesome,{className:cx(Qe,{"text-purple-600":He}),...it}),[GenerationModelType.SdV1Model]:({active:He,className:Qe,...it})=>jsxRuntimeExports.jsx(icBaselineSmartToy,{className:cx(Qe,{"text-purple-600":He}),...it}),[OrderOption.trending]:({active:He,className:Qe,...it})=>jsxRuntimeExports.jsx(icBaselineTrendingUp,{className:cx(Qe,{"text-purple-500":He}),...it}),[OrderOption.recommended]:({active:He,className:Qe,...it})=>jsxRuntimeExports.jsx(icBaselineAssistant,{className:cx(Qe,{"text-purple-500":He}),...it})},useOrderState=(He=defaultChoices)=>{const Qe=He[0],[{sort:it=Qe},lt]=useQs();return[it,dt=>lt({sort:dt})]},OrderSelect=({choices:He,value:Qe,onChange:it=()=>{},alwaysCollapse:lt=!1,className:ut,disabled:dt})=>{const[{tag:xt}]=useQs(),ft=useLocation(),{selectedContestTag:vt}=useArtworkListPageContext(),kt=reactExports.useMemo(()=>{const Tt=He.filter(({value:Mt})=>{const Nt=xt==="all"||!xt;return!(ft.pathname==="/"&&Nt&&Mt===OrderOption.oldest||vt&&([OrderOption.followingNews].includes(Mt)||vt.isEnded&&![OrderOption.mostLiked,OrderOption.mostUsed,OrderOption.newest,OrderOption.oldest].includes(Mt)))});return(!Qe||Qe&&!Tt.find(Mt=>Mt.value===Qe)&&Qe!==Tt[0].value)&&it(Tt[0].value),Tt},[xt,ft,vt,Qe,it,He]),St=(Tt,Mt)=>{it(Mt)};return lt?jsxRuntimeExports.jsx("div",{className:cx("flex-none flex items-center gap-1 md:gap-2 overflow-x-auto",ut),children:jsxRuntimeExports.jsx(StyledSelect,{disabled:dt,size:"small",className:cx("bg-background-light rounded-lg hover:opacity-100",Qe===OrderOption.followingNews?"opacity-70 ":""),value:Qe,onChange:Tt=>{St(void 0,Tt.target.value)},children:kt.map(Tt=>{const Mt=Qe===Tt.value,Nt=orderIconMap[Tt.value];return jsxRuntimeExports.jsxs(MenuItem$1,{value:Tt.value,className:"px-4 flex items-center gap-1.5 min-h-[36px]",children:[Nt&&Nt({active:Mt,className:"size-6"}),jsxRuntimeExports.jsx("div",{className:"normal-case leading-tight text-[0.8125rem] text-primary",children:Tt.label})]},Tt.value)})})}):jsxRuntimeExports.jsx(StyledToggleButtonGroup,{disabled:dt,size:"small",value:Qe,exclusive:!0,onChange:St,className:ut,children:kt.map(Tt=>{const Mt=Qe===Tt.value,Nt=orderIconMap[Tt.value];return jsxRuntimeExports.jsxs(ToggleButton,{value:Tt.value,className:"rounded-full flex items-center gap-1",children:[Nt&&Nt({active:Mt,className:"size-6"}),jsxRuntimeExports.jsx("span",{className:"normal-case",children:Tt.label})]},Tt.value)})})},orderOptions=[{label:jsxRuntimeExports.jsx(Text,{i18nKey:"common:order-option.random"}),value:OrderOption.random},{label:jsxRuntimeExports.jsx(Text,{i18nKey:"common:order-option.most-liked"}),value:OrderOption.mostLiked},{label:jsxRuntimeExports.jsx(Text,{i18nKey:"common:order-option.newest"}),value:OrderOption.newest}];function RelatedArtworkSection(He){const{model:Qe,version:it}=reactExports.useContext(ModelDetailContext),[lt,ut]=reactExports.useState(OrderOption.mostLiked),dt=(xt,ft)=>xt?isLora(xt.type)?{loraId:xt.id,loraVersionId:ft?.id}:isSDModel(xt.type)||isDitV1Model(xt.type)?{modelId:xt.id,modelVersionId:ft?.id}:{}:{};return jsxRuntimeExports.jsx(ModelDetailSection,{...He,heading:jsxRuntimeExports.jsx(Text,{i18nKey:Qe?"market:model.artwork-by-title-name":"market:model.artwork-by-model",values:{title:it?it.name:Qe?.title}}),slots:{heading:jsxRuntimeExports.jsx(OrderSelect,{choices:orderOptions,value:lt,alwaysCollapse:!0,className:"ml-auto max-msm:mt-2",onChange:xt=>(track("order_click",{value:xt,scene:"model-content"}),ut(xt))})},children:jsxRuntimeExports.jsx(StatefulArtworkGrid,{order:lt,extraArgs:{...dt(Qe,it)},trackingArgs:{feed:lt,scene:"model-detail"},artworkCardProps:{modelTitle:Qe?.title}},Qe?.id)})}function ModelTrainingTasksList(He){const{model:Qe,showCompletedTasks:it}=He,{data:lt}=useUserInfo(),ut=Qe.authorId===lt?.id,xt=getTrainingTasksFromModel(Qe).filter(ft=>it?!0:ft.status!==TrainingTaskStatus.completed);return xt.length<1||!ut?null:jsxRuntimeExports.jsx("div",{className:cx("flex gap-2 py-1 -my-1 overflow-x-auto","px-[3px] -mx-[3px]",He.className),style:He.style,children:xt.map(ft=>jsxRuntimeExports.jsxs("div",{className:"flex-none flex items-center gap-1 leading-5 border p-1 rounded-md text-sm",children:[jsxRuntimeExports.jsx("span",{children:ft.parameters.title}),jsxRuntimeExports.jsx(TrainingTaskStatusChip,{trainingTask:ft,modelType:ft.baseModel?.modelType,className:"px-1.5 py-0.5 text-xs"})]},ft.id))})}const RE_MODEL_PATHNAME=/^(?:\/(?<lang>\w+))?\/model\/(?<id>\d+)(?:-(?<slug>[^/]+)?)?(?:\/(?<versionId>\d+))?$/i;function parseModelUrl(He){const{pathname:Qe}=new URL(He,"https://example.com"),it=RE_MODEL_PATHNAME.exec(Qe);if(it?.groups)return{modelId:it.groups.id,modelSlug:it.groups.slug,versionId:it.groups.versionId}}function LoadingSkeletons(He){const{amount:Qe=3}=He;return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:range$1(Qe).map(it=>jsxRuntimeExports.jsx("div",{"data-skeleton":"","data-skeleton-index":it,"data-skeleton-first":it===0?"":null,"data-skeleton-last":it===Qe-1?"":null,className:He.className,style:{opacity:.5-.5/Qe*it,...He.style},children:typeof He.children=="function"?He.children(it):He.children},it))})}const SKELETON_SIZES=range$1(3).map(()=>random(60,80));function ModelVersionList(He){const Qe=useNavigate(),{data:it}=useUserInfo(),{t:lt}=useTranslation(["market"]),ut=He.model.authorId===it?.id,{items:dt,hasMore:xt,loading:ft,loadMore:vt,reset:kt}=usePaginatedData({fetcher:client.listGenerationModelVersions,getArgs:Mt=>({modelId:He.model.id,first:20,after:Mt?.generationModelVersions?.pageInfo.endCursor}),getItems:Mt=>getNodesFromConnection(Mt.generationModelVersions),getHasMore:Mt=>Mt.generationModelVersions?.pageInfo.hasNextPage??!1}),St=reactExports.useCallback(()=>{kt(),vt()},[]);reactExports.useEffect(()=>{vt()},[]);const Tt=reactExports.useCallback(()=>{track("add_version_click",{location:"model-detail",modelType:He.model.type}),isUserMultiLora(He.model.type)?Qe(withQuery("/train-lora",{addToModelId:He.model.id})):dialogAddModelVersions(He.model,{mutate:St})},[He.model]);return dt.length<1&&!ut?null:jsxRuntimeExports.jsxs("div",{className:cx("flex gap-2 py-1 -my-1 overflow-x-auto","px-[3px] -mx-[3px]",He.className),style:He.style,children:[jsxRuntimeExports.jsx(ModelVersionStatusChip,{modelVersion:He.model.latestAvailableVersion,chipConfigOpts:{showAvailable:!0},className:"text-sm text-black rounded-lg whitespace-pre"}),ut&&jsxRuntimeExports.jsx(UIButton$1,{icon:jsxRuntimeExports.jsx(icRoundPlus,{className:"size-5"}),disabled:hasModelTypeDisabledAddVersion(He.model.type),className:"flex-none",onPress:Tt,children:lt("market:submit.add-version")}),dt.map(Mt=>jsxRuntimeExports.jsx(ListItem,{version:Mt,modelType:He.model.type,current:Mt.id===He.currentVersion?.id,className:"flex-none"},Mt.id)),xt&&(dt.length===0?jsxRuntimeExports.jsx(LoadingSkeletons,{amount:SKELETON_SIZES.length,children:Mt=>jsxRuntimeExports.jsx("span",{className:"block h-8 bg-black/20 dark:bg-white/20 rounded-md animate-pulse",style:{width:SKELETON_SIZES[Mt]}})}):jsxRuntimeExports.jsx(UIButton$1,{icon:jsxRuntimeExports.jsx(icBaselineChevronRight,{className:"size-6"}),busy:ft,onPress:()=>void vt()}))]})}const itemStyle=ce$1({base:"flex items-center h-8 px-2 py-1 bg-black/5 dark:bg-white/5",variants:{current:{true:"outline outline-2 outline-offset-1 outline-purple-600",false:"hover:bg-black/10 dark:hover:bg-white/10"}}});function ListItem(He){const{version:Qe,modelType:it}=He,{t:lt}=useTranslation(["market"]),ut=getModelVersionStatusChipConfig(lt,Qe),dt=getModelLoraBaseModelChipConfig(getModelTypeFromVersion(Qe)),xt=()=>{const ft=parseModelUrl(location.pathname);return ft?.versionId?`/model/${ft.modelId}-${ft.modelSlug}`:`/model/${Qe.modelId}/${Qe.id}`};return jsxRuntimeExports.jsx(Button,{component:Link,to:xt(),"data-current":He.current?"":null,className:itemStyle({current:He.current,className:["group",He.className]}),style:He.style,children:jsxRuntimeExports.jsxs("span",{className:"leading-5 font-semibold",children:[Qe.name,ut&&jsxRuntimeExports.jsx("span",{className:cx("ml-1 px-1.5 text-xs text-black/60 rounded-full",ut.bgClassName),children:ut.label}),isLora(it)&&dt&&jsxRuntimeExports.jsx("span",{className:cx("ml-1 px-1.5 text-xs text-black/60 rounded-full",dt.bgClassName),children:dt.label})]})})}function ModelDetail(He){const{isSinglePage:Qe,onClose:it}=He,lt=useTrackPageView();reactExports.useEffect(()=>{Qe||lt({scene:"model-detail",modal:!0})},[]);const{data:ut=He.model,isValidating:dt,mutate:xt}=useGenerationModel(He.model.id),{data:ft=He.version,isValidating:vt,mutate:kt}=useGenerationModelDetailByVersionId(He.version?.id),St=reactExports.useMemo(()=>({model:ut,loadingModel:dt,mutateModel:xt,version:ft,loadingVersion:vt,mutateVersion:kt,isSinglePage:Qe,onClose:it}),[ut,dt,xt,ft,vt,kt,Qe,it]);return ut?jsxRuntimeExports.jsx(ModelDetailContext.Provider,{value:St,children:jsxRuntimeExports.jsxs("div",{className:cx("flex flex-col gap-4 text-sm",Qe?"py-4 msm:py-6 mlg:py-8":"p-4",He.className),children:[jsxRuntimeExports.jsx(HeaderSection,{}),Qe&&jsxRuntimeExports.jsx(ModelVersionList,{model:ut,currentVersion:ft}),isUserLora(ut.type)&&jsxRuntimeExports.jsx(ModelTrainingTasksList,{model:ut}),jsxRuntimeExports.jsxs("div",{className:cx(styles$2["content-layout"]),children:[jsxRuntimeExports.jsx(CoverSection,{style:{gridArea:"cover"}}),jsxRuntimeExports.jsx(InfoSection,{style:{gridArea:"info"}}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",style:{gridArea:"description"},children:[jsxRuntimeExports.jsx(DescriptionSection,{}),jsxRuntimeExports.jsx(CommentSection,{})]})]}),Qe&&jsxRuntimeExports.jsx(RelatedArtworkSection,{className:"mt-4 pt-7 px-1 -mx-1 border-t border-zinc-300 dark:border-zinc-600"})]})}):null}function HeaderSection(He){const{model:Qe,version:it,isSinglePage:lt}=reactExports.useContext(ModelDetailContext),ut=useBreakpoint("mmd");return Qe?jsxRuntimeExports.jsxs("header",{...He,className:cx(styles$2["header-layout"],He.className),children:[jsxRuntimeExports.jsxs("div",{className:"flex",style:{gridArea:"badge"},children:[jsxRuntimeExports.jsx(ModelTypeChip,{model:Qe,className:"!py-0.5"}),jsxRuntimeExports.jsx(ModelLoraBaseTypeChips,{className:"ml-1 gap-1",model:Qe}),jsxRuntimeExports.jsx(ModelEarlyAccessChip,{model:Qe,className:"ml-1.5"}),isLora(Qe.type)&&Qe.category&&jsxRuntimeExports.jsx(UILink,{href:`/market?type=ANY_LORA&category=${Qe.category}`,className:cx("inline-flex items-center px-2 py-0.5  rounded-full outline outline-1 -outline-offset-1","ml-0.5 msm:ml-1 max-msm:text-xs","bg-zinc-100 dark:bg-zinc-700 outline-black/5 dark:outline-white/5"),children:jsxRuntimeExports.jsx(Text,{i18nKey:`market:lora-categories.${Qe.category}.label`})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 *:flex-none",style:{gridArea:"action"},children:[jsxRuntimeExports.jsx(LikeButton,{}),jsxRuntimeExports.jsx(BookmarkButton,{}),jsxRuntimeExports.jsx(MenuButton,{}),!lt&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(UILink,{href:createModelUrl(Qe,it),target:"_blank",variant:"outlined",size:ut?"small":"large",icon:jsxRuntimeExports.jsx(fluentOpen20Filled,{className:"size-5"}),className:"rounded-md"})})]}),jsxRuntimeExports.jsx("h1",{className:"text-xl mmd:text-2xl font-semibold",style:{gridArea:"title"},children:Qe.title}),!lt&&jsxRuntimeExports.jsx(ModelVersionStatusChip,{modelVersion:it??Qe.latestAvailableVersion,chipConfigOpts:{showAvailable:!0},className:"text-black justify-self-start col-span-3"}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap items-center gap-1",style:{gridArea:"tag"},children:Qe.tags&&Qe.tags.length>0&&jsxRuntimeExports.jsx(TagList,{type:"model",tags:Qe.tags,className:"!contents"})})]}):null}function LikeButton(){const He=useBreakpoint("mmd"),{model:Qe}=reactExports.useContext(ModelDetailContext),[{liked:it,count:lt,optimistic:ut},dt]=useLike(Qe?.id,RefType.Model,{liked:Qe?.liked,likedCount:Qe?.likedCount});return jsxRuntimeExports.jsx(UIButton$1,{size:He?"small":"large",icon:jsxRuntimeExports.jsx(LikeHeart,{liked:!!it,className:"size-5"}),className:cx(ut&&"opacity-50"),onPress:async()=>{await ensureLogIn({fromPath:"like"}).then(()=>!0,()=>!1)&&await dt()},children:formatNum(lt)})}function BookmarkButton(He){const Qe=useBreakpoint("mmd"),{model:it,mutateModel:lt}=reactExports.useContext(ModelDetailContext),ut=it?.id,dt=it?.bookmarked;async function xt(){try{if(!ut||!await ensureLogIn({fromPath:"bookmark"}).then(()=>!0,()=>!1))return;const vt=!dt;track(vt?"bookmark_click":"delete_bookmark_click",{scene:"model-content",modelId:ut}),await client.markGenerationModel({modelId:ut,target:vt,type:GenerationModelMarkType.Bookmark}),lt?.(kt=>kt&&(kt.bookmarked=vt,kt))}catch(ft){toast.error(`Failed to bookmark (${String(ft)})`)}}return jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",size:Qe?"small":"large",busy:"auto",icon:dt?jsxRuntimeExports.jsx(fluentBookmark20Filled,{className:"size-5"}):jsxRuntimeExports.jsx(fluentBookmarkAdd20Filled,{className:"size-5"}),className:cx(dt&&"text-purple-600 dark:text-purple-500",He.className),style:He.style,onPress:xt})}const TRAINING_STATUSES=[TrainingTaskStatus.waiting,TrainingTaskStatus.running];function MenuButton(){const{t:He}=useTranslation(["market"]),Qe=useBreakpoint("mmd"),{model:it,mutateModel:lt,version:ut,mutateVersion:dt}=reactExports.useContext(ModelDetailContext),{me:xt,beingAdmin:ft}=useMe(),vt=xt!=null&&it?.authorId===xt.id,kt=TRAINING_STATUSES.includes(it?.trainingTask?.status??""),St=ut??it?.latestAvailableVersion,Tt=useNavigate(),Mt=getBaseModelTypeFromLoraVersion(St),Nt=it?.isDownloadable&&!isDitV1Model(Mt),At=St?.downloadUrl;if(!it)return null;function $t(){return ensureLogIn({fromPath:"more-btn"}).then(()=>!0,()=>!1)}const Dt=compact([{id:"share",icon:jsxRuntimeExports.jsx(icBaselineShare,{className:"size-5"}),onAction:()=>{track("share_btn_click",{scene:"model"}),dialogModelShareCard(it,He)},children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:share.label"})},{id:"download",icon:jsxRuntimeExports.jsx(icBaselineFileDownload,{className:"size-5"}),disabled:!Nt,onAction:()=>{if(track("download_model_click",{type:it.type}),xt){if(!isValidUrl(At))return toast.error(He("market:model.notice.download-url-invalid"));window.open(At,"_blank")}else{openSignModal({onSuccess:()=>{ut?dt():lt()}},{fromPath:"download-model"});return}},children:Nt?jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.download"}):jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.not-downloadable"})},UIMenuSeparatorSymbol,xt&&!vt&&{id:"request-edit",icon:jsxRuntimeExports.jsx(icBaselineRateReview,{className:"size-5"}),onAction:()=>dialogModelRequestEdit(it.id),children:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:action.request-edit"})},UIMenuSeparatorSymbol,vt&&St&&St.extra?.taskId&&{id:"reuse-dataset",icon:jsxRuntimeExports.jsx(fluentImageArrowCounterclockwise20Regular,{className:"size-5"}),onAction:async()=>{track("reuse_dataset_click",{location:"more-btn"}),Tt(withQuery("/train-lora",{addToModelId:it.id,trainingTaskId:St.extra.taskId}))},children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.reuse-dataset.label"})},UIMenuSeparatorSymbol,(vt||ft)&&[{id:"edit-model",icon:jsxRuntimeExports.jsx(fluentTextboxSettings20Regular,{className:"size-5"}),color:ft&&!vt?"admin":void 0,onAction:async()=>{track("edit_model_click"),dialogEditModel({model:it,mutate:lt})},children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.action.edit-model"})},St&&{id:"edit-version",color:ft&&!vt?"admin":void 0,onAction:async()=>{track("edit_version_click",{location:"more-btn"}),dialogEditModelVersion(it,ut??it.latestAvailableVersion,{mutate:dt})},children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.action.edit-version",context:ut?void 0:"latest"})}],(vt&&!kt||ft)&&{id:"delete-model",color:"danger",onAction:async()=>{track("delete_click"),await deleteModel(it)},children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.action.delete-model"})},UIMenuSeparatorSymbol,!vt&&!isUserLora(it.type)&&{id:"claim",icon:jsxRuntimeExports.jsx(icBaselinePlaylistAdd,{className:"size-5"}),onAction:async()=>{await $t()&&(track("claim_click"),dialogClaim(it.id))},children:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.claim.claim-model"})},xt&&!vt&&{id:"report",icon:jsxRuntimeExports.jsx(fluentFlag20Regular,{className:"size-5"}),onAction:async()=>{track("report_click"),dialogReport(RefType.Model,it.id)},children:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:action.report"})},ft&&[UIMenuSeparatorSymbol,{id:"inspect",icon:jsxRuntimeExports.jsx(fluentDatabaseSearch20Regular,{className:"size-5"}),color:"admin",onAction:()=>{dialogInspectionForRAC({model:it})},children:"Inspect"},{id:"moderation",color:"admin",onAction:async()=>{dialogModerationEdit({refIds:[it.id],refType:RefType.Model,values:{...pick$1(it.flag,["isRealistic","isSensitive","isMinors","isSexyPic","isSexyText"])},mutate:()=>{lt(),dt()}})},children:"Adjust Model Moderation"}]].flat()).reduce((Ft,Bt,Ot,Qt)=>(Bt===UIMenuSeparatorSymbol&&(Ot===0||Ot===Qt.length-1||Ft.at(-1)===UIMenuSeparatorSymbol)||Ft.push(Bt),Ft),[]);return Dt.length?jsxRuntimeExports.jsxs(UIMenuTrigger,{children:[jsxRuntimeExports.jsx(UIButton$1,{size:Qe?"small":"large",icon:jsxRuntimeExports.jsx(icBaselineMoreVert,{className:"size-5"})}),jsxRuntimeExports.jsx(UIMenu,{placement:"bottom end",items:Dt,children:Ft=>jsxRuntimeExports.jsx(UIMenuItem,{...Ft})})]}):null}function CoverSection(He){const{model:Qe,mutateModel:it,version:lt,loadingVersion:ut,mutateVersion:dt,isSinglePage:xt}=reactExports.useContext(ModelDetailContext),ft=compact((lt??Qe?.latestAvailableVersion)?.previewArtworks),vt=1+(ft?.length??0),St=useBreakpoint("mmd")?1:2,Tt=Math.ceil(vt/St)-1,Mt=reactExports.useRef(null),[Nt,At]=i(()=>new Set),$t=Math.floor(Math.min(...Nt)/St);function Dt(Qt){const Wt=Mt.current?.children[Qt];Wt&&Mt.current.scrollTo({left:Wt.offsetLeft})}const[Ft,Bt]=reactExports.useState();if(!Qe)return null;const Ot={pageButton:"absolute inset-y-0 my-auto grid place-content-center size-10 text-black bg-white/80 hover:bg-white backdrop-blur rounded-full ring-1 ring-black/20"};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("section",{className:cx("relative flex flex-col bg-zinc-100 dark:bg-zinc-700 py-1 -mx-1 rounded-[10px]",He.className),style:He.style,children:[jsxRuntimeExports.jsx("div",{ref:Mt,className:"flex w-full overflow-hidden scroll-smooth",style:{height:"calc(100vh - var(--app-header-height) - 100px - 200px)",maxHeight:600},children:chunk([jsxRuntimeExports.jsxs("div",{className:"relative size-full",children:[jsxRuntimeExports.jsx(ModelDetailImage,{model:Qe,version:lt,isSinglePage:xt,mutate:()=>lt?dt():it(),className:cx(ut&&"opacity-50")}),jsxRuntimeExports.jsx(Preloader,{inline:!0,className:cx("absolute inset-0 m-auto",!ut&&"invisible")})]},"cover"),...ft?.map(Qt=>jsxRuntimeExports.jsx(PreviewArtwork,{artwork:Qt,onClick:Bt},Qt.id))??[]].map((Qt,Wt)=>jsxRuntimeExports.jsx(CoverItem,{scroller:Mt.current,onEnter:()=>At(Xt=>{Xt.add(Wt)}),onExit:()=>At(Xt=>{Xt.delete(Wt)}),children:Qt},Wt)),St).map((Qt,Wt)=>jsxRuntimeExports.jsx("div",{className:"flex-none grid gap-2 size-full px-1 snap-start snap-always",style:{gridTemplateColumns:`repeat(${vt>1?St:1}, 1fr)`},children:Qt},Wt))}),jsxRuntimeExports.jsx("button",{className:cx(Ot.pageButton,"-left-2",$t===0&&"invisible"),onClick:()=>Dt($t-1),children:jsxRuntimeExports.jsx(fluentChevronLeft20Filled,{className:"size-5"})}),jsxRuntimeExports.jsx("button",{className:cx(Ot.pageButton,"-right-2",$t===Tt&&"invisible"),onClick:()=>Dt($t+1),children:jsxRuntimeExports.jsx(fluentChevronRight20Filled,{className:"size-5"})}),jsxRuntimeExports.jsx("div",{className:cx("mt-1 flex justify-center gap-1",vt<=St&&"!hidden"),children:Array.from({length:vt}).map((Qt,Wt)=>jsxRuntimeExports.jsx("div",{className:cx("size-3 rounded",Nt.has(Wt)?"bg-black dark:bg-white":"bg-black/30 dark:bg-white/50"),onClick:()=>Dt(Math.floor(Wt/St))},Wt))})]}),jsxRuntimeExports.jsx(ArtworkDetailDialog$1,{open:Ft!=null,artwork:Ft,onClose:()=>Bt(void 0)})]})}function CoverItem(He){const{ref:Qe,entry:it}=useIntersection({root:He.scroller,threshold:.5});return reactExports.useEffect(()=>{it?.isIntersecting?He.onEnter?.():He.onExit?.()},[it?.isIntersecting,He]),jsxRuntimeExports.jsx("div",{ref:Qe,children:He.children})}function PreviewArtwork(He){const{data:Qe=typeof He.artwork=="string"?void 0:He.artwork}=useGetArtwork(typeof He.artwork=="string"?He.artwork:skipToken),[{liked:it=!1,count:lt,optimistic:ut},dt]=useLike(Qe?.id,RefType.Artwork,Qe),{me:xt}=useMe(),ft=useNavigate(),vt=async()=>{if(trackArtwork("use_as_refer_btn_click",Qe),!xt){openSignModal(void 0,{fromPath:"refer"});return}if(Qe)try{if(!await UIDialog.confirm({heading:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:use-as-reference-confirm.title"}),content:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:use-as-reference-confirm.desc"})}))return;const St=await fetchGetArtworkWithTaskDetail({id:Qe.id}).then(Tt=>Tt.data?.artwork?.taskParameters);trackArtwork("use_as_refer",Qe),executeMarkArtwork({artworkId:Qe.id,type:MarkType.Inspire,target:!0}),startEventGroup("generate_source"),ft(`/generator/image?${formatQs({importType:"use_as_reference",artwork:encodeArtworkForImport(Qe),task:encodeTaskForImport(St)})}`)}catch(kt){if(kt===UserCancelled)return}};return jsxRuntimeExports.jsxs(ContentFittableBox,{ratio:getAspectRatio(Qe?.media),className:"size-full",children:[jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:Qe?.mediaId,thumbnail:!0,className:"rounded-md",onClick:()=>Qe&&He.onClick(Qe)}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-0 right-0 flex gap-1 p-1",children:[jsxRuntimeExports.jsx(UIButton$1,{size:"small",disabled:ut,icon:jsxRuntimeExports.jsx(LikeHeart,{liked:it,className:"size-5"}),className:"!bg-white/80 dark:!bg-black/80 backdrop-blur",onPress:()=>dt(),children:formatNum(lt)}),jsxRuntimeExports.jsxs(UIMenuTrigger,{children:[jsxRuntimeExports.jsx(UIButton$1,{size:"small",icon:jsxRuntimeExports.jsx(icBaselineMoreVert,{className:"size-5"}),className:"!bg-white/80 dark:!bg-black/80 backdrop-blur"}),jsxRuntimeExports.jsx(UIMenu,{placement:"top end",children:jsxRuntimeExports.jsx(UIMenuItem,{icon:jsxRuntimeExports.jsx(fluentImageArrowForward20Regular,{className:"size-5"}),onAction:vt,children:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:use-as-reference.label"})})})]})]}),jsxRuntimeExports.jsx(CardCornerDebugInfo,{extra:Qe?.extra,children:kt=>jsxRuntimeExports.jsx("div",{className:"absolute top-1.5 right-1.5 bg-black/80 rounded px-2 py-1.5",children:kt})})]})}function InfoSection(He){const{model:Qe,version:it,isSinglePage:lt}=reactExports.useContext(ModelDetailContext);if(!Qe)return null;const ut=isUserMultiLora(Qe.type)&&it?it?.loraBaseModelId:Qe.baseModelVersion?.modelId;return jsxRuntimeExports.jsx("section",{...He,children:jsxRuntimeExports.jsx(ModelInfoSection,{model:Qe,isSinglePage:lt,version:it,trainBaseModelId:ut})})}function DescriptionSection(He){const{model:Qe}=reactExports.useContext(ModelDetailContext);return Qe?.extra?.description?jsxRuntimeExports.jsx(ModelDetailSection,{...He,heading:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.description.title"}),children:jsxRuntimeExports.jsx(DescriptionRenderer,{children:Qe.extra.description})}):null}const DescriptionRenderer=reactExports.memo(function He(Qe){return jsxRuntimeExports.jsx(ExpandableContentBox,{className:"grid grid-rows-1 grid-cols-1 max-h-[320px] data-[expanded]:max-h-fit",children:jsxRuntimeExports.jsx(MarkdownRenderer,{className:"prose prose-sm prose-neutral dark:prose-invert max-w-full prose-h1:text-xl",renderer:mdUser,children:Qe.children})})});function CommentSection(He){const{model:Qe}=reactExports.useContext(ModelDetailContext),{me:it}=useMe();if(!Qe)return null;const lt=it?.id===Qe.authorId;return jsxRuntimeExports.jsx(ModelDetailSection,{...He,heading:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:comment"}),children:jsxRuntimeExports.jsxs(CommentProvider,{topicId:Qe.id,refType:RefType.Model,initLoadSize:3,canDeleteMessage:()=>lt,children:[jsxRuntimeExports.jsx(CommentComposer,{className:"mb-4"}),jsxRuntimeExports.jsx(CommentList,{})]})})}function ModelDetailSection(He){const{heading:Qe,slots:it,...lt}=He;return jsxRuntimeExports.jsxs("section",{...lt,children:[jsxRuntimeExports.jsxs("div",{className:"mb-2 flex items-center",children:[Qe&&jsxRuntimeExports.jsx("h2",{className:"text-base mmd:text-xl",children:Qe}),it?.heading&&jsxRuntimeExports.jsx("div",{className:"ml-auto",children:it.heading})]}),He.children]})}const dialogModelDetail=(He,Qe)=>UIDialog.create({dismissable:!0,children:({close:it})=>jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(LoadingPage,{}),children:He?jsxRuntimeExports.jsx(ModelDetail,{model:He,onClose:it}):null}),className:"max-w-screen-mlg"}),ModelLikeButton=({modelId:He,model:Qe,initialValue:it=Qe?.liked??!1,initialCount:lt=Qe?.likedCount??0,countStyle:ut,countClassName:dt,numOnTop:xt,hideValueOnZero:ft,scene:vt="market"})=>He?jsxRuntimeExports.jsx(BaseLikeButton,{id:He,initialCount:lt,initialValue:it,onBtnClick:kt=>{kt&&track("like_click",{scene:vt,type:Qe?.type})},handler:async(kt,St)=>{await client.markGenerationModel({modelId:kt,type:GenerationModelMarkType.Like,target:St})},render:({value:kt,count:St,onClick:Tt})=>jsxRuntimeExports.jsx(ButtonBase,{component:"div",role:"button",className:"cursor-pointer outline transition -m-2 p-2 rounded-md",onClick:Tt,children:jsxRuntimeExports.jsxs("div",{className:cx("flex gap-1 items-center",{"flex-col-reverse":xt}),children:[jsxRuntimeExports.jsx(LikeHeart,{liked:kt,className:"size-5"}),ft&&!St?null:jsxRuntimeExports.jsx("span",{className:cx(dt,"text-sm tabular-nums"),style:{...ut},children:formatNum(St||0)})]})})}):null,majesticonsLock=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsxs("g",{fill:"none",children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 12a3 3 0 0 1 3-3h12a3 3 0 0 1 3 3v7a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-7zm10 2a1 1 0 1 0-2 0v3a1 1 0 1 0 2 0v-3z",clipRule:"evenodd"}),jsxRuntimeExports.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10V7a4 4 0 0 1 4-4v0a4 4 0 0 1 4 4v3"})]})});function ArtworkDetailContentModels$1(He){const{modelId:Qe,loras:it=[void 0,void 0]}=He,{data:{model:lt}={},isValidating:ut}=useGenerationModelByVersionIdForArtwork(Qe),{t:dt}=useTranslation(["artwork"]),xt=(lt||ut)&&jsxRuntimeExports.jsx(ModelItemDisplay$1,{model:lt}),ft=it.length?it.map((vt,kt)=>jsxRuntimeExports.jsx(ModelItemDisplay$1,{model:vt},vt?.id||kt)):null;return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[xt,ft,!xt&&!ft&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ModelItemDisplay$1,{className:"row-start-1 col-start-1 invisible"}),jsxRuntimeExports.jsx("div",{className:"row-start-1 col-span-full grid place-content-center text-sm bg-background-light text-primary-light rounded-xl",children:dt("artwork:messages.no-model-info")})]})]})}function ModelItemDisplay$1(He){const{model:Qe}=He,it=isModelCoverWarned(Qe),lt=isModelEarlyAccess(Qe?.extra),ut=isAlphaTestModel(Qe?.extra),dt=Qe?.isPrivate&&!lt&&!ut;return jsxRuntimeExports.jsxs("a",{title:Qe?.title,href:Qe&&!dt?createModelUrl(Qe):void 0,className:cx("flex items-center gap-2 p-1 -m-1 text-left rounded-xl","[&:not(&:has([data-capture-hover]:hover))]:hover:bg-black/10","dark:[&:not(&:has([data-capture-hover]:hover))]:hover:bg-white/10",dt&&"pointer-events-none",He.className),style:He.style,onClick:xt=>(track("lora_click",{path:"image"}),xt.preventDefault(),dialogModelDetail(Qe)),children:[jsxRuntimeExports.jsx("div",{className:"flex-none grid size-16 overflow-hidden bg-zinc-300 dark:bg-zinc-600 rounded-lg ring-1 ring-black/10 dark:ring-white/10",children:it?jsxRuntimeExports.jsx(MediaContentRemovedIcon,{className:"row-start-1 col-start-1 place-self-center text-2xl"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(MediaPreview$1,{thumbnail:!0,mediaId:Qe?.mediaId,className:"row-start-1 col-start-1"}),dt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"row-start-1 col-start-1 relative bg-black/70"}),jsxRuntimeExports.jsx(icRoundLock,{className:"row-start-1 col-start-1 place-self-center relative text-xl text-white"})]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-1 items-center",children:[lt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(majesticonsLock,{className:"size-4"}),jsxRuntimeExports.jsx(MembershipIconCircled,{})]}),Qe&&jsxRuntimeExports.jsx(ModelTypeChip,{model:Qe,type:"compact"}),Qe&&Qe.isPrivate&&jsxRuntimeExports.jsx(AlphaTestModelChip,{model:Qe,type:"compact"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[Qe?jsxRuntimeExports.jsx("span",{className:"flex-1 w-full truncate text-sm font-medium",children:Qe.title}):jsxRuntimeExports.jsx(Skeleton,{variant:"text",className:"self-center w-[4em]"}),jsxRuntimeExports.jsx("span",{"data-capture-hover":"",className:"flex-none pl-0.5 pr-1 hover:bg-black/10 dark:hover:bg-white/10 rounded",children:Qe?jsxRuntimeExports.jsx(ModelLikeButton,{modelId:Qe.id,model:Qe,countClassName:"text-sm",scene:"artwork-detail"}):jsxRuntimeExports.jsx(Skeleton,{variant:"rounded",className:"mx-auto w-[3em] h-6"})})]})]})]})}const icBaselineExplicit=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4 6h-4v2h4v2h-4v2h4v2H9V7h6v2z"})});function NsfwBlurForImage(He){return jsxRuntimeExports.jsx("div",{className:cx("absolute w-full h-full bg-black/40 top-0 left-0 backdrop-blur-md flex items-center justify-center",He.className),children:jsxRuntimeExports.jsx(icBaselineExplicit,{className:cx("opacity-50",He.iconProps?.className)})})}const icBaselineArrowDropDown=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m7 10l5 5l5-5z"})}),ALL_MODEL=new Set([GenerationModelType.SdV1Model,GenerationModelType.SdxlModel,GenerationModelType.Sd3MediumModel,GenerationModelType.Dit7BModel]),ALL_LORA=new Set([GenerationModelType.Lora,GenerationModelType.SdxlLora,GenerationModelType.UserLora,GenerationModelType.UserSdxlLora,GenerationModelType.Dit7BLora]),ALL_SDV1=new Set([GenerationModelType.SdV1Model,GenerationModelType.Lora,GenerationModelType.UserLora]),ALL_SDXL=new Set([GenerationModelType.SdxlModel,GenerationModelType.SdxlLora,GenerationModelType.UserSdxlLora]),ALL_DIT7B=new Set([GenerationModelType.Dit7BLora,GenerationModelType.Dit7BModel]),ALL_SD3=new Set([GenerationModelType.Sd3MediumModel]),ALL_ANY_LORA=new Set([GenerationModelType.AnyNonUserLora,GenerationModelType.AnyUserLora,GenerationModelType.AnyLora]);function intersectOf(He,Qe){return He.intersection(Qe).size>0}function normalizeValueToSet(He){return Array.isArray(He)?new Set(He):new Set(He?[He]:[])}function ModelTypeToModelFilters(He,Qe){const it=normalizeValueToSet(He),lt=normalizeValueToSet(Qe);return{type:$$3(it).when(ut=>ut.size<1,()=>"").when(ut=>ut.isSubsetOf(ALL_MODEL)||ut.has(GenerationModelType.AnyModel),()=>"model").when(ut=>ut.isSubsetOf(ALL_LORA)||ut.isSubsetOf(ALL_ANY_LORA)||ut.has(GenerationModelType.AnyLora),()=>"lora").otherwise(()=>""),modelTypes:mapGenerationModelTypesToTypeAlias(it),baseModelTypes:mapGenerationModelTypesToTypeAlias(lt),source:$$3(it).when(ut=>ut.has(GenerationModelType.AnyUserLora),()=>"pixai").when(ut=>ut.has(GenerationModelType.AnyNonUserLora),()=>"external").otherwise(()=>"")}}function normalizeEmptySelection(He){return Array.isArray(He)&&(He.length===0||He.length===1&&He[0]==="")?"":He}function ModelFiltersToModelType(He){const Qe=N$4.optional(""),it=N$4.optional(""),lt=new Set([GenerationModelType.SdV1Model,GenerationModelType.SdxlModel,GenerationModelType.Sd3MediumModel,GenerationModelType.Dit7BModel]),ut={...He,modelTypes:normalizeEmptySelection(He.modelTypes),baseModelTypes:normalizeEmptySelection(He.baseModelTypes)},dt=$$3(ut).returnType().with({type:Qe},()=>"").with({type:"model",modelTypes:it},()=>[GenerationModelType.AnyModel]).with({type:"model"},({modelTypes:ft})=>mapTypeAliasToGenerationModelTypes({modelTypes:ft})).with({type:"lora",source:Qe},()=>[GenerationModelType.AnyLora]).with({type:"lora",source:"pixai"},()=>[GenerationModelType.AnyUserLora]).with({type:"lora",source:"external"},()=>[GenerationModelType.AnyNonUserLora]).otherwise(()=>[]),xt=$$3(He.baseModelTypes).with(N$4.array(N$4.string),()=>{let ft=new Set([...lt]);const vt=new Set([GenerationModelType.SdV1Model,GenerationModelType.Lora,GenerationModelType.UserLora]),kt=new Set([GenerationModelType.SdxlModel,GenerationModelType.SdxlLora,GenerationModelType.UserSdxlLora]),St=new Set([GenerationModelType.Dit7BLora,GenerationModelType.Dit7BModel]),Tt=new Set([GenerationModelType.Sd3MediumModel]);return He.baseModelTypes&&(He.baseModelTypes.includes("sdv1")||(ft=ft.difference(vt)),He.baseModelTypes.includes("sdxl")||(ft=ft.difference(kt)),He.baseModelTypes.includes("dit7")||(ft=ft.difference(St)),He.baseModelTypes.includes("sd3")||(ft=ft.difference(Tt))),ft.size<1?"":Array.from(ft)}).otherwise(()=>"");return{type:dt,loraBaseModelTypes:xt}}const modelFilterNormalizerHandler={set(He,Qe,it,lt){switch(Reflect.set(He,Qe,it,lt),Qe){case"type":it!=="lora"&&(He.baseModelId&&(lt.baseModelId=""),He.source&&(lt.source=""),He.category&&(lt.category=""),He.baseModelTypes&&(lt.baseModelTypes=[""]),it!=="model"&&(lt.modelTypes=[""]));break;case"modelTypes":Array.isArray(it)&&it.includes("sdv1")&&it.includes("sdxl")&&it.includes("dit7")&&(lt.modelTypes=[""]);break;case"baseModelTypes":Array.isArray(it)&&(it[0]!==""&&(He.type!=="lora"&&(lt.type="lora"),He.baseModelId&&/^\d+$/.test(He.baseModelId)&&(lt.baseModelId="")),it.includes("sdv1")&&it.includes("sdxl")&&it.includes("dit7")&&(lt.baseModelTypes=[""]));break;case"baseModelId":it&&(He.type!=="lora"&&(lt.type="lora"),He.source!=="pixai"&&(lt.source="pixai"));break;case"source":it&&He.type!=="lora"&&(lt.type="lora"),(!it||it!=="pixai")&&He.baseModelId&&(lt.baseModelId="");break;case"category":it&&He.type!=="lora"&&(lt.type="lora");break}return!0}};function mapTypeAliasToGenerationModelTypes(He){if(!He.modelTypes)return[];let Qe;return typeof He.modelTypes=="string"?Qe=[He.modelTypes]:Qe=He.modelTypes,Qe.map(it=>$$3(it).with("sdv1",()=>GenerationModelType.SdV1Model).with("sdxl",()=>GenerationModelType.SdxlModel).with("dit7",()=>GenerationModelType.Dit7BModel).otherwise(()=>"")).filter(Boolean)}function mapGenerationModelTypesToTypeAlias(He){let Qe=new Set;return intersectOf(He,ALL_SDV1)&&Qe.add("sdv1"),intersectOf(He,ALL_SDXL)&&Qe.add("sdxl"),intersectOf(He,ALL_DIT7B)&&Qe.add("dit7"),intersectOf(He,ALL_SD3)&&Qe.add("sd3"),Qe.size<1&&(Qe=new Set([""])),Array.from(Qe)}function ModelFilter(He){function Qe(it,lt){He.onChange?.(produce(He.value??{},ut=>{const dt=new Proxy(ut,modelFilterNormalizerHandler);lt!=null?dt[it]=lt:delete dt[it]}))}return jsxRuntimeExports.jsx(ModelFilterContext.Provider,{value:{...He,updateValue:Qe},children:jsxRuntimeExports.jsx(ModelFilterActual,{...He})})}const ModelFilterContext=reactExports.createContext({});function ModelFilterActual(He){const{updateValue:Qe}=reactExports.useContext(ModelFilterContext),it=reactExports.useMemo(()=>Object.entries(He.value??{}).filter(([vt,kt])=>typeof He.disabled!="boolean"&&He.disabled?.[vt]||Array.isArray(kt)&&(kt.length===0||kt.length===1&&!kt[0])?!1:!!kt).length,[He.value,He.disabled]),[lt,ut]=reactExports.useState(!1),dt=reactExports.useRef(null),xt=He.value?.type==="model",ft=He.value?.type==="lora";return jsxRuntimeExports.jsxs($de32f1b87079253c$export$2e1e1122cf0cba88,{isOpen:lt,onOpenChange:ut,children:[jsxRuntimeExports.jsxs(Button,{ref:dt,className:cx("px-3 bg-background-light",He.className),style:He.style,onClick:()=>ut(!0),children:[jsxRuntimeExports.jsxs("span",{className:"capitalize",children:[jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:recipes.categories.filters",defaults:"Filters"}),it>0&&jsxRuntimeExports.jsx("span",{className:"ml-1 px-1.5 py-px text-xs text-white dark:text-black bg-black dark:bg-white rounded-full",children:it})]}),jsxRuntimeExports.jsx(icBaselineArrowDropDown,{className:twJoin("-mr-2 size-6 text-black/50 dark:text-white",lt&&"rotate-180")})]}),jsxRuntimeExports.jsx($07b14b47974efb58$export$5b6b19405a83ff9d,{triggerRef:dt,placement:"bottom start",offset:4,className:twJoin("flex flex-col","entering:animate-in entering:fade-in entering:slide-in-from-top-1","exiting:animate-out exiting:fade-out exiting:slide-out-to-top-1"),children:jsxRuntimeExports.jsxs($de32f1b87079253c$export$3ddf2d174ce01153,{className:"flex-1 overflow-auto bg-white dark:bg-zinc-800 rounded-lg ring-1 ring-black/15 dark:ring-white/10 shadow-lg shadow-black/40 dark:shadow-black/60 divide-y divide-black/10 dark:divide-white/10",style:{maxWidth:320},children:[jsxRuntimeExports.jsx(ModelFilterSection,{value:He.value?.type??"",onChange:vt=>Qe("type",vt),label:jsxRuntimeExports.jsx(Text,{i18nKey:"market:search.model-filters.options.model-usage.label"}),options:MODEL_USAGE_OPTIONS,disabled:resolveDisabled(He.disabled,"type")}),jsxRuntimeExports.jsx(ModelFilterSection,{selectionMode:"multiple",value:He.value?.modelTypes??[],onChange:vt=>Qe("modelTypes",vt),label:jsxRuntimeExports.jsx(Text,{i18nKey:"market:submit.model-type"}),options:BASE_MODEL_TYPE_OPTIONS,disabled:!xt||resolveDisabled(He.disabled,"modelTypes")}),jsxRuntimeExports.jsx(ModelFilterSection,{selectionMode:"multiple",value:He.value?.baseModelTypes??[],onChange:vt=>Qe("baseModelTypes",vt),label:jsxRuntimeExports.jsx(Text,{i18nKey:"market:search.model-filters.options.base-model.label"}),options:BASE_MODEL_TYPE_OPTIONS,disabled:!ft||resolveDisabled(He.disabled,"baseModelTypes")}),jsxRuntimeExports.jsx(BaseModelSection,{value:He.value?.baseModelId??"",onChange:vt=>Qe("baseModelId",vt),disabled:!ft||resolveDisabled(He.disabled,"baseModelId")}),jsxRuntimeExports.jsx(ModelFilterSection,{value:He.value?.source??"",onChange:vt=>Qe("source",vt),label:jsxRuntimeExports.jsx(Text,{i18nKey:"common:source.label"}),options:MODEL_SOURCE_OPTIONS,disabled:!ft||resolveDisabled(He.disabled,"source")}),jsxRuntimeExports.jsx(LoraCategorySection,{}),jsxRuntimeExports.jsx(ModelFilterSection,{value:He.value?.time??"",onChange:vt=>Qe("time",vt),label:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.posted-at"}),options:TIME_RANGE_OPTIONS,disabled:resolveDisabled(He.disabled,"time")})]})})]})}function BaseModelSection(He){const Qe=useBaseModelIdsForMarkFilter();return jsxRuntimeExports.jsx(ModelFilterSection,{selectionMode:"single",value:He.value,onChange:He.onChange,label:jsxRuntimeExports.jsx(Text,{i18nKey:"market:search.model-filters.options.lora-base-model.label"}),options:[ALL_OPTION,...Qe],disabled:He.disabled})}function LoraCategorySection(){const{value:He,updateValue:Qe,disabled:it}=reactExports.useContext(ModelFilterContext),lt=useLoraCategories(),ut=He?.type==="lora";return jsxRuntimeExports.jsx(ModelFilterSection,{value:He?.category??"",onChange:dt=>Qe("category",dt),label:jsxRuntimeExports.jsx(Text,{i18nKey:"common:category.label_lora"}),options:[{value:"",label:"common:visibility.all"},...lt],disabled:!ut||resolveDisabled(it,"category")})}function resolveDisabled(He,Qe){return typeof He=="boolean"||He==null?He:He[Qe]}const tagClassName=()=>twJoin("min-w-12 px-2 py-1 text-center rounded-md ring-1 ring-inset cursor-default","ring-black/15","group-selected:text-white group-selected:bg-black","dark:ring-white/15","dark:group-selected:text-black dark:group-selected:bg-white","group-disabled:opacity-60");function normalizeValueForSelectionSet(He){return Array.isArray(He)?He.length===0?new Set([""]):new Set(He):new Set([He||""])}function ModelFilterSection(He){const Qe=He.selectionMode==="multiple",{hideDisabled:it}=reactExports.useContext(ModelFilterContext),lt=normalizeValueForSelectionSet(He.value);return!He.options?.length||it&&He.disabled===!0?null:jsxRuntimeExports.jsxs($eaf9e70818b436db$export$67ea30858aaf75e3,{selectionMode:He.selectionMode??"single",disallowEmptySelection:!0,selectedKeys:lt,onSelectionChange:ut=>{if(ut==="all")return;Qe&&(ut.difference(lt).has("")&&(ut=new Set("")),lt.has("")&&lt.isSubsetOf(ut)&&ut.delete(""));const dt=Qe?[...ut]:[...ut][0];He.onChange?.(dt)},disabledKeys:He.disabled===!0?He.options?.map(ut=>ut.value):He.disabled||void 0,className:"p-3 text-sm",children:[jsxRuntimeExports.jsx($01b77f81d0f07f68$export$b04be29aa201d4f5,{className:"-my-1",children:He.label}),jsxRuntimeExports.jsx($eaf9e70818b436db$export$f9fef0f55402315b,{items:He.options,className:"mt-2 flex flex-wrap gap-2",children:ut=>jsxRuntimeExports.jsx($eaf9e70818b436db$export$3288d34c523a1192,{id:ut.value,className:"group",textValue:ut.label,children:({isDisabled:dt})=>it&&dt?null:jsxRuntimeExports.jsx("div",{className:tagClassName(),children:jsxRuntimeExports.jsx(Text,{i18nKey:ut.label,defaults:ut.label})})})})]})}const icBaselineAutoGraph=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M14.06 9.94L12 9l2.06-.94L15 6l.94 2.06L18 9l-2.06.94L15 12l-.94-2.06zM4 14l.94-2.06L7 11l-2.06-.94L4 8l-.94 2.06L1 11l2.06.94L4 14zm4.5-5l1.09-2.41L12 5.5L9.59 4.41L8.5 2L7.41 4.41L5 5.5l2.41 1.09L8.5 9zm-4 11.5l6-6.01l4 4L23 8.93l-1.41-1.41l-7.09 7.97l-4-4L3 19l1.5 1.5z"})});function ModelRefCountInDialog(He){return jsxRuntimeExports.jsxs("p",{className:"absolute bottom-0 left-0 px-1 mlg:px-2 py-0.5 mlg:py-1 text-xs rounded-tr-lg rounded-bl-[0.69rem] text-white/70 bg-black/70",children:[jsxRuntimeExports.jsx(icBaselineAutoGraph,{className:"mr-1 inline-block"}),formatNum(He.refCount)]})}function EmptyModelSearchResultsInDialog(He){const{t:Qe}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs("div",{className:cx("flex flex-col items-center justify-center gap-4 mx-auto",He.className),children:[He.showDescription&&jsxRuntimeExports.jsx("h1",{children:Qe("generation:lora.list.empty-placeholder")}),jsxRuntimeExports.jsx(Button,{component:Link,to:"/market",target:"_blank",className:"bg-theme-primary font-bold",variant:"contained",onClick:it=>{track("go_to_market_click",{fromPath:He.scene}),He.onGotoClick&&(it.preventDefault(),He.onGotoClick())},children:He.actionType==="go"?Qe("generation:lora.list.go-to-market"):Qe("generation:lora.list.search-in-market")})]})}function EmptyModelListInSidebar(He){const{t:Qe}=useTranslation(["generation"]);return jsxRuntimeExports.jsx("div",{className:cx("flex flex-col items-center justify-center gap-4 mx-auto",He.className),children:jsxRuntimeExports.jsx("p",{children:Qe(`generation:model.list.sidebar-empty-placeholder.${He.mode}`)})})}const ModelListContainerInDialog=styled("div")(()=>({display:"grid",width:"calc(100% - 16px)",gridTemplateColumns:"repeat(auto-fill,minmax(120px,1fr))","@media (max-width: 600px)":{gridTemplateColumns:"repeat(auto-fill,minmax(80px,1fr))"},gap:"0.75rem",marginTop:"1rem"})),icOutlineEdit=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m14.06 9.02l.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83l3.75 3.75l1.83-1.83a.996.996 0 0 0 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"})}),getValueFromDispatch=He=>new Promise(Qe=>{He(it=>(Qe(it),it))}),useEditItems=({size:He,actionButtonName:Qe,primaryButtonName:it,primaryButtonAfterClick:lt,deleteItem:ut,afterDelete:dt,dialogTitle:xt,dialogContent:ft,onActionButtonClick:vt,beforeDelete:kt})=>{const{t:St}=useTranslation(["artwork","action"]),[Tt,Mt]=reactExports.useState(!1),[Nt,At]=reactExports.useState([]),[$t,Dt]=reactExports.useState(!1),Ft=ut,Bt=hr=>{Mt(hr)},Ot=hr=>{const xr=Nt.includes(hr)?Nt.filter(gr=>gr!==hr):[...Nt,hr];At(xr)},Qt=()=>{At([])},Wt=()=>{At([]),Mt(!1)},[Xt,Kt]=useLoadingCallback(async()=>{if(Ft)try{const hr=await getValueFromDispatch(At);kt?.(hr);for(const xr of hr)await Ft(xr);dt?.(),Qt(),toast.success("Delete successfully."),Dt(!1)}catch{toast.error("Delete failed.")}},[Ft]),Jt=jsxRuntimeExports.jsxs("div",{className:"flex gap-4 min-w-fit",children:[!Tt&&jsxRuntimeExports.jsx(Button,{variant:"outlined",size:He,startIcon:jsxRuntimeExports.jsx(icOutlineEdit,{className:"size-5"}),className:"capitalize",onClick:()=>{vt?.(),Bt(!0)},children:Qe}),Tt&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:[jsxRuntimeExports.jsx(Button,{variant:"outlined",size:He,onClick:Wt,children:St("action:cancel")}),jsxRuntimeExports.jsxs("span",{className:cx(He!=="small"&&"text-lg"),children:[Nt.length," ","selected"]}),Ft&&jsxRuntimeExports.jsx(Button,{color:"error",variant:"outlined",size:He,disabled:Nt.length===0,onClick:()=>{Dt(!0),lt?.()},children:St(it!==void 0?it:"artwork:action.delete")})]}),jsxRuntimeExports.jsxs(Dialog,{open:$t,onClose:()=>{Xt||Dt(!1)},PaperProps:{sx:{minWidth:400}},children:[xt&&jsxRuntimeExports.jsx(DialogTitle,{children:xt}),ft&&jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsx(DialogContentText,{children:ft})}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",onPress:()=>Dt(!1),children:St("action:cancel")}),jsxRuntimeExports.jsx(UIButton$1,{busy:Xt,onPress:Kt,variant:"filled",children:St("action:confirm")})]})]})]});return{editing:Tt,selectedItems:Nt,editItemsAction:Jt,toggleEditing:Bt,toggleSelected:Ot,clearSelected:Qt,cancelSelected:Wt,deleteItemAction:Ft,setSelectedItems:At}},icBaselinePushPin=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M16 9V4h1c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1l1-1v-7H19v-2c-1.66 0-3-1.34-3-3z"})});function getMarketListOrderChoices(He){return[{value:OrderOption.trending,label:He("common:order-option.trending")},{value:OrderOption.mostLiked,label:He("common:order-option.most-liked")},{value:OrderOption.mostUsed,label:He("common:order-option.most-used")},{value:OrderOption.newest,label:He("common:order-option.newest")}]}function getBookmarkListOrderChoices(He){return[{label:He("common:order-option.oldest"),value:OrderOption.oldest},{label:He("common:order-option.newest"),value:OrderOption.newest}]}const[ModelFormContext,ModelFormContextProvider]=createCtx({type:null,versionId:null,modelId:null,searchKeyword:"",openDetail:!1,marketOrder:OrderOption.trending,bookmarkListOrder:OrderOption.newest,tab:"preset",marketFilters:{type:"model"}}),icBaselineBookmarkAdded=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m19 21l-7-3l-7 3V5c0-1.1.9-2 2-2h7a5.002 5.002 0 0 0 5 7.9V21zM17.83 9L15 6.17l1.41-1.41l1.41 1.41l3.54-3.54l1.41 1.41L17.83 9z"})}),icOutlineBookmarkAdd=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17 11v6.97l-5-2.14l-5 2.14V5h6V3H7c-1.1 0-2 .9-2 2v16l7-3l7 3V11h-2zm4-4h-2v2h-2V7h-2V5h2V3h2v2h2v2z"})}),icOutlineReportProblem=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"})});function ModelDescription({description:He}){const{t:Qe}=useTranslation(["market"]),it=reactExports.useRef(null),[lt,ut]=reactExports.useState(!1),[dt,xt]=reactExports.useState(!1);return reactExports.useEffect(()=>{it.current&&xt(it.current.scrollHeight>it.current.clientHeight)},[]),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h4",{className:"pb-1 font-medium",children:Qe("market:model.description.title")}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{ref:it,className:cx(lt?"table table-fixed break-words w-full":"line-clamp-4 break-all","text-sm whitespace-pre-line"),children:jsxRuntimeExports.jsx(MarkdownRenderer,{renderer:mdUser,children:He})}),dt&&jsxRuntimeExports.jsxs("button",{className:"flex items-center",onClick:()=>ut(ft=>!ft),children:[lt?jsxRuntimeExports.jsx(icBaselineKeyboardArrowUp,{}):jsxRuntimeExports.jsx(icBaselineKeyboardArrowDown,{}),jsxRuntimeExports.jsx("div",{className:"text-sm opacity-75",children:Qe(lt?"artwork:show.less":"artwork:show.more")})]})]})]})}function ModelParamsInfo({version:He}){const{t:Qe}=useTranslation(["market","generation"]);if(!He?.extra)return null;const it=[[Qe("generation:sampling-steps.label"),He.extra.samplingSteps],[Qe("generation:sampling-method.label"),He.extra.samplingMethod],[Qe("generation:cfg-scale.label"),He.extra.cfgScale],[Qe("generation:negative-prompts.label"),He.extra.negativePrompts]].filter(([,lt])=>lt!=null);return it.length===0?null:jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h4",{className:"pb-1 font-medium",children:Qe("market:model.parameters.title")}),jsxRuntimeExports.jsx("ul",{className:"flex flex-col gap-2 text-sm",children:it.map(([lt,ut],dt)=>jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("h5",{children:lt}),jsxRuntimeExports.jsx("span",{className:"text-primary-light",children:ut})]},dt))})]})}function ModelPermsInfo({model:He}){const{t:Qe}=useTranslation(["market"]),it=He.extra?.permissions??{},lt=[[Qe("market:model.permissions.share-images-online"),it.shareImagesOnline??it["share-images-online"]??!1],[Qe("market:model.permissions.personal-uses"),it.personalUses??it["personal-uses"]??!1],[Qe("market:model.permissions.commercial-uses"),it.commercialUses??it["commercial-uses"]??!1],[Qe("market:model.permissions.should-credit-author"),it.shouldCreditAuthor??it["should-credit-author"]??!1]];return jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h4",{className:"pb-1 font-medium",children:Qe("market:model.permissions.title")}),jsxRuntimeExports.jsx("ul",{className:"flex flex-col gap-.5",children:lt.map(([ut,dt],xt)=>jsxRuntimeExports.jsxs("li",{className:"flex gap-1 items-center text-sm",children:[dt?jsxRuntimeExports.jsx(icBaselineCheck,{className:"text-green-600 size-6 shrink-0"}):jsxRuntimeExports.jsx(icBaselineClose,{className:"text-rose-600 size-6 shrink-0"}),jsxRuntimeExports.jsx("span",{children:ut})]},xt))})]})}function ModelBookmarkButton({model:He,mutate:Qe}){const{t:it}=useTranslation(["market","generation"]),lt=He.bookmarked,[ut,dt]=useLoadingCallback(async()=>{try{const xt=!lt;track(xt?"bookmark_click":"delete_bookmark_click",{scene:"model-select-preview",modelId:He.id}),await client.markGenerationModel({modelId:He.id,target:xt,type:GenerationModelMarkType.Bookmark}),Qe?.(),toast.info(it(xt?"market:model.notice.bookmark-success":"market:model.notice.unbookmark-success"))}catch(xt){if(xt===UserCancelled)return;toast.error(`Failed to bookmark. ${xt?.message}`)}},[lt,He.id]);return jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",size:"small",className:"rounded-full",color:"normal",colorScheme:"dark",busy:ut,endIcon:lt?jsxRuntimeExports.jsx(icBaselineBookmarkAdded,{className:"text-theme-primary size-4"}):jsxRuntimeExports.jsx(icOutlineBookmarkAdd,{className:"size-4"}),onPress:dt,children:it(lt?"generation:model.preview.bookmarked":"market:model.action.bookmark")})}function ModelPinButton({model:He,mutate:Qe}){const{t:it}=useTranslation(["market"]),lt=He.bookmarked,[ut,dt]=useLoadingCallback(async()=>{track("model-select-preview-pin-to-top",{modelId:He.id});try{await client.markGenerationModel({modelId:He.id,target:!1,type:GenerationModelMarkType.Bookmark}),await client.markGenerationModel({modelId:He.id,target:!0,type:GenerationModelMarkType.Bookmark}),toast.info(it("generation:model.preview.notice.pin-to-top-success")),Qe?.()}catch(xt){if(xt===UserCancelled)return;toast.error(`Failed to pin. ${xt?.message}`)}},[He.id]);return lt?jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",size:"small",color:"normal",colorScheme:"dark",className:"rounded-full",busy:ut,endIcon:jsxRuntimeExports.jsx(icBaselinePushPin,{className:"text-theme-primary size-4"}),onPress:dt,children:it("generation:model.preview.action.pin-to-top")}):null}function ModelVersionMedia({version:He}){return He?.media?jsxRuntimeExports.jsx("img",{loading:"lazy",decoding:"async",className:"inline-block align-bottom mr-2 w-[1.4em] h-[1.4em] rounded object-cover",src:getThumbnailUrl(He.media)}):null}function ModelVersionSelect({versionId:He,versions:Qe,onChange:it}){const{t:lt}=useTranslation(["market"]);return jsxRuntimeExports.jsxs(FormControl,{className:"mt-2",fullWidth:!0,size:"small",children:[jsxRuntimeExports.jsx(InputLabel,{id:"model-select-version-select-label",children:lt("market:submit.version-form.version-string")}),jsxRuntimeExports.jsx(Select,{MenuProps:{disablePortal:!0},labelId:"model-select-version-select-label",label:lt("market:submit.version-form.version-string"),value:He,renderValue:ut=>{const dt=Qe.find(xt=>xt.id===ut);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ModelVersionMedia,{version:dt}),dt?.name]})},onChange:it,children:Qe.map(ut=>jsxRuntimeExports.jsx(MenuItem$1,{value:ut.id,children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(ModelVersionMedia,{version:ut}),ut.name,jsxRuntimeExports.jsx("div",{className:"mt-1 text-xs",children:defaultDayjs(ut.updatedAt).format("lll")})]})},ut.id))})]})}function ModelSelectPreviewInner({modelId:He,onClose:Qe,onConfirm:it,showPinToTop:lt,mutateAfterPin:ut,...dt}){const{t:xt}=useTranslation(["market","generation"]),[ft,vt]=reactExports.useContext(ModelFormContext),{data:kt,isValidating:St,mutate:Tt}=useGenerationModel(He),Mt=getThumbnailUrl(kt?.media),{data:Nt,isValidating:At}=useGenerationModelVersions({modelId:He,first:20}),$t=getNodesFromConnection(Nt),Dt=ft.versionId,Ft=reactExports.useCallback(Qt=>{vt(Wt=>({...Wt,versionId:Qt.target.value}))},[vt]),Bt=reactExports.useMemo(()=>$t?.find(Qt=>Qt.id===Dt),[$t,Dt]),Ot=()=>(!ft.type||!Dt||St||At||(track("model_selected",{location:ft.type}),it({id:Dt,...Bt,model:kt})),Qe());return!kt||!Nt?jsxRuntimeExports.jsx("div",{...dt,children:jsxRuntimeExports.jsx(Preloader,{})}):jsxRuntimeExports.jsxs("div",{...dt,className:cx("flex flex-col",dt.className),children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col p-4 gap-3 overflow-auto",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("img",{loading:"lazy",decoding:"async",className:"w-full aspect-square rounded-[0.96rem] object-cover",src:Mt}),jsxRuntimeExports.jsxs("div",{className:"absolute top-1 right-1 flex flex-col gap-1 items-end",children:[jsxRuntimeExports.jsx(ModelBookmarkButton,{model:kt,mutate:Tt}),lt&&jsxRuntimeExports.jsx(ModelPinButton,{model:kt,mutate:ut})]})]}),jsxRuntimeExports.jsx(Link,{to:`/model/${kt.id}`,target:"_blank",children:jsxRuntimeExports.jsx("h3",{className:"text-xl break-all font-semibold",children:kt?.title})}),kt.extra?.description?.trim()&&jsxRuntimeExports.jsx(ModelDescription,{description:kt.extra.description},kt.extra.description),jsxRuntimeExports.jsx(ModelParamsInfo,{version:Bt}),jsxRuntimeExports.jsx(ModelPermsInfo,{model:kt})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3 p-4",children:[$t.length&&Dt?$t.length>1?jsxRuntimeExports.jsx(ModelVersionSelect,{versionId:Dt,versions:$t,onChange:Ft}):null:jsxRuntimeExports.jsx(Alert,{severity:"warning",className:"px-3 py-0",icon:jsxRuntimeExports.jsx(icOutlineReportProblem,{}),children:xt("generation:model.preview.no-version")}),jsxRuntimeExports.jsx(UIButton$1,{busy:St||At,disabled:!Bt,variant:"filled",onPress:Ot,children:xt("market:model.use-this-model")})]})]})}function ModelSelectPreview(He){const{t:Qe}=useTranslation(["generation"]),[it]=reactExports.useContext(ModelFormContext),lt=it.modelId;return lt?jsxRuntimeExports.jsx(ModelSelectPreviewInner,{...He,modelId:lt}):jsxRuntimeExports.jsx("div",{...He,className:cx("grid place-items-center text-neutral-400",He.className),children:Qe("generation:model.preview.no-selection")})}function ModelSelectDialog(He){const Qe=useBreakpoint("mlg");return jsxRuntimeExports.jsx(UIDialogResponsive,{open:He.open,onClose:He.onClose,className:Qe?"h-[calc(100vh-64px)]":"max-w-[1000px] max-h-[min(calc(100vh-64px),800px)] w-[calc(100vw-64px)]",isMobile:Qe,dismissable:!0,children:jsxRuntimeExports.jsx(ModelFormContextProvider,{defaultValue:He.initState,children:jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(Preloader,{}),children:jsxRuntimeExports.jsx(ModelDialogContent,{onClose:He.onClose,onVersionSelected:He.onVersionSelected})})})})}function ModelDialogContent(He){const{beingMember:Qe}=useMe(),it=reactExports.useRef(null),lt=useBreakpoint("mlg"),[ut,dt]=reactExports.useContext(ModelFormContext),{t:xt}=useTranslation(["generation","action","market"]),ft=ut.tab,vt=reactExports.useCallback(Tt=>{dt(Mt=>({...Mt,tab:Tt}))},[]),kt=reactExports.useCallback(Tt=>{track("model_switch_click",{value:Tt}),vt(Tt)},[ft]),St=reactExports.useMemo(()=>[{id:"preset",label:xt("generation:model.type.preset"),content:jsxRuntimeExports.jsx(PresetModelGrid,{type:"preset",setTabVal:vt})},{id:"market",label:xt("generation:model.type.market"),content:jsxRuntimeExports.jsx(MarketModelGrid,{})},{id:"bookmark",label:xt("generation:model.type.bookmark"),content:jsxRuntimeExports.jsx(BookmarkModelGrid,{setTabVal:vt,ref:it})}],[]);return jsxRuntimeExports.jsx(GenerationSelectableDialogContextProvider,{children:jsxRuntimeExports.jsx(GenerationSelectableDialogContent,{onClose:He.onClose,title:xt("generation:model.list.title"),showModalSheet:lt,tabVal:ft,tabs:St,onTabChange:kt,tabsSuffix:jsxRuntimeExports.jsx(TabFilters,{}),onOpenDetailChange:Tt=>dt(Mt=>({...Mt,openDetail:Tt})),openDetail:ut.openDetail,preview:jsxRuntimeExports.jsx(ModelSelectPreview,{className:cx("w-full h-[calc(var(--list-height)-68px)] mlg:h-[calc(var(--list-height)+56px)]","mlg:w-72 mlg:border-l mlg:border-background-light",lt&&!ut.openDetail&&"hidden"),onClose:He.onClose,onConfirm:He.onVersionSelected,showPinToTop:Qe&&ft==="bookmark",mutateAfterPin:it.current??void 0},ut.modelId),searchInput:jsxRuntimeExports.jsx(ModelSearchWrapper,{tabVal:ft}),action:jsxRuntimeExports.jsx(Button,{color:"primary",href:"/market",target:"_blank",size:"large",startIcon:jsxRuntimeExports.jsx(icBaselineStore,{}),onClick:()=>{track("browse_mkt_click",{location:"more-model"})},children:xt("generation:model.list.market")})})})}function TabFilters(){const{t:He}=useTranslation(["common"]),Qe=getMarketListOrderChoices(He),it=getBookmarkListOrderChoices(He),[lt,ut]=reactExports.useContext(ModelFormContext),dt=lt.tab,xt=useBaseModelIdsForMarkFilter().map(({value:vt})=>vt),ft=reactExports.useMemo(()=>$f39a9eba43920ace$export$86427a43e3e48ebb(()=>jsxRuntimeExports.jsx(ModelFilter,{value:{...lt.marketFilters},onChange:vt=>{ut(produce(kt=>{kt.marketFilters=vt}))},disabled:{type:!0,baseModelId:xt,source:!0,category:!0},hideDisabled:!0,className:"h-10"})),[xt,lt.marketFilters]);return jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[dt!=="preset"&&jsxRuntimeExports.jsx(OrderSelect,{choices:dt==="market"?Qe:it,onChange:vt=>{track("order_click",{value:vt,scene:"market"}),ut(dt==="market"?kt=>({...kt,marketOrder:vt}):kt=>({...kt,bookmarkListOrder:vt}))},value:dt==="market"?lt.marketOrder:lt.bookmarkListOrder,alwaysCollapse:!0}),dt==="market"&&jsxRuntimeExports.jsx(ft,{})]})}function ModelSearchWrapper({tabVal:He,...Qe}){const{t:it}=useTranslation(["generation"]),[{searchKeyword:lt},ut]=reactExports.useContext(ModelFormContext),dt=xt=>{xt=xt.trim(),xt&&track("panel_model_search",{fromPath:"model",location:He,value:xt}),ut(ft=>({...ft,searchKeyword:xt}))};return jsxRuntimeExports.jsx(GenerationSelectableDialogSearchWrapper,{...Qe,tabVal:He,onInputChange:dt,className:cx("flex-auto",Qe.className),onClear:()=>{ut(xt=>({...xt,searchKeyword:""}))},searchKeyword:lt,placeholder:it("generation:model.list.search-placeholder")})}const BookmarkModelGrid=reactExports.forwardRef(function He(Qe,it){const{t:lt}=useTranslation(["generation"]),[ut,dt]=reactExports.useContext(ModelFormContext),{searchKeyword:xt,bookmarkListOrder:ft}=ut,{beingMember:vt,me:kt}=useMe(),St=isBookmarkOrderOptionPosSeq(ft),Tt=30,Mt=reactExports.useCallback((br,vr)=>{if(!kt?.id)return;const yr=St?vr?.pageInfo.endCursor:vr?.pageInfo.startCursor,Cr=getBaseCursorPagingArgs({before:St?void 0:yr,after:St?yr:void 0,pageSize:Tt,isPosSeq:St});return{modelType:GenerationModelType.AnyModel,keyword:xt||void 0,...Cr}},[xt,Tt,kt?.id,St]),{data:Nt,isValidating:At,isLoading:$t,setSize:Dt,size:Ft}=useMyBookmarkedGenerationModelsInfinite(Mt),Bt=reactExports.useMemo(()=>Nt?uniqBy(Nt.flatMap(vr=>{const yr=getNodesFromConnection(vr);return St?yr:yr.reverse()}),"id"):[],[Nt,St]),Ot=reactExports.useMemo(()=>Nt?.at(-1)?.pageInfo,[Nt]),Qt=reactExports.useMemo(()=>Nt?.at(-1)?.totalCount,[Nt]),Wt=reactExports.useMemo(()=>St?Ot?.hasNextPage:Ot?.hasPreviousPage,[Ot,St]),Xt=reactExports.useCallback(()=>{!At&&Wt&&Dt(br=>br+1)},[Wt,At]),Kt=reactExports.useCallback(()=>{Xt()},[Xt]),Jt=reactExports.useMemo(()=>$t||Ft>0&&Nt&&Nt[Ft-1]==null,[Ft,$t]);reactExports.useImperativeHandle(it,()=>()=>Xt(),[Xt]);const hr=reactExports.useCallback(()=>Jt?jsxRuntimeExports.jsx(Preloader,{className:"!my-1"}):ut.searchKeyword.length>0?jsxRuntimeExports.jsx(EmptyModelSearchResultsInDialog,{scene:"model",className:"pb-20",actionType:"search",onGotoClick:()=>Qe.setTabVal("market")}):null,[Jt,ut.searchKeyword]),xr=useEditItems({size:"small",actionButtonName:lt("generation:model.manage-bookmarks.label"),deleteItem:async br=>{await client.markGenerationModel({modelId:br,target:!1,type:GenerationModelMarkType.Bookmark}),mutateGenerationModel(br)},beforeDelete:br=>{track("delete_bookmark_click",{type:"model",number:br.length})},afterDelete:Kt,dialogTitle:lt("generation:model.manage-bookmarks.confirm-title"),dialogContent:lt("generation:model.manage-bookmarks.confirm-content"),onActionButtonClick:()=>{track("manage_bookmark_click",{type:"model"})}});if(Bt.length===0)return $t?jsxRuntimeExports.jsx("div",{className:"w-full min-h-[360px] h-[var(--list-height)]",children:jsxRuntimeExports.jsx(LoadingPage,{fullHeight:!0})}):jsxRuntimeExports.jsx(EmptyModelSearchResultsInDialog,{actionType:"search",scene:"model",className:"h-[var(--list-height)]",onGotoClick:()=>Qe.setTabVal("market")});const gr=vt&&ut.bookmarkListOrder===OrderOption.newest;return jsxRuntimeExports.jsxs(RadioGroup,{value:ut.modelId,className:"relative flex-nowrap",style:{height:"var(--list-height)"},children:[jsxRuntimeExports.jsx("div",{className:cx("z-20 sticky top-0 left-0 right-0 px-1 py-3","mlg:absolute mlg:top-auto mlg:bottom-0"),children:xr.editItemsAction}),jsxRuntimeExports.jsx(Yr,{className:"-mt-2 mlg:mt-0 mlg:mb-14 w-full min-h-[140px]",totalCount:Qt,data:Bt,endReached:Xt,itemContent:(br,vr)=>{const{title:yr,type:Cr,media:Rr,id:Ir,refCount:Tr,isPrivate:$r,latestAvailableVersion:Zr}=vr,Sr=gr&&br<=5;return jsxRuntimeExports.jsx(ModelControlLabel,{control:xr.editing?jsxRuntimeExports.jsx(Checkbox,{className:cx("z-10 absolute top-2 right-2 p-0 rounded text-primary","bg-background translate-x-1/2 -translate-y-1/2"),checked:xr.selectedItems.includes(Ir),onChange:()=>{xr.toggleSelected(Ir)},sx:{borderRadius:"3px"}}):jsxRuntimeExports.jsx(Radio,{className:"sr-only",onChange:()=>{dt(Dr=>({...Dr,type:"bookmark",versionId:Zr?.id||null,modelId:Ir,name:yr,openDetail:!0}))}}),selected:!xr.editing&&ut.modelId===Ir,modelId:Ir,modelType:Cr,title:yr,media:Rr,badge:jsxRuntimeExports.jsx(ModelBadge,{model:vr}),showRefCount:!$r,refCount:Tr,onClick:()=>{xr.editing||ut.modelId!==Ir||dt(Dr=>({...Dr,type:"bookmark",openDetail:!0}))},extraComp:jsxRuntimeExports.jsx(ModelPinnedIcon,{className:"absolute right-0 top-0 translate-y-[3px] -translate-x-[3px]",pinned:Sr})},Ir)},overscan:200,components:{Footer:hr,List:ModelListContainerInDialog}})]})});function PresetModelGrid(He){const[Qe,it]=reactExports.useContext(ModelFormContext),[lt]=reactExports.useContext(ModelFormContext),{modelList:ut,isLoading:dt}=usePresetModels(),xt=reactExports.useMemo(()=>ut.filter(ft=>(ft.title??"").toLowerCase().includes(Qe.searchKeyword.toLowerCase())),[ut,Qe.searchKeyword]);return xt.length===0?dt?jsxRuntimeExports.jsx("div",{className:"w-full min-h-[360px] h-[var(--list-height)]",children:jsxRuntimeExports.jsx(LoadingPage,{fullHeight:!0})}):jsxRuntimeExports.jsx(EmptyModelSearchResultsInDialog,{actionType:"search",scene:"model",className:"h-[var(--list-height)]",onGotoClick:()=>He.setTabVal("market")}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs(RadioGroup,{value:lt.modelId,style:{height:"var(--list-height)"},children:[jsxRuntimeExports.jsx(ModelListContainerInDialog,{children:xt.map(ft=>{const{title:vt,type:kt,tags:St,media:Tt,id:Mt,refCount:Nt,latestAvailableVersion:At}=ft;return jsxRuntimeExports.jsx(ModelControlLabel,{control:jsxRuntimeExports.jsx(Radio,{className:"sr-only",onChange:()=>{it($t=>({...$t,type:"preset",versionId:At?.id||null,modelId:Mt,name:vt,openDetail:!0}))}}),selected:Qe.modelId===Mt,modelId:Mt,modelType:kt,modelTags:St,title:vt,media:Tt,badge:jsxRuntimeExports.jsx(ModelBadge,{model:ft}),showRefCount:!0,refCount:Nt,onClick:()=>{Qe.modelId===Mt&&it($t=>({...$t,type:"preset",openDetail:!0}))}},Mt)})}),Qe.searchKeyword.length>0&&jsxRuntimeExports.jsx(EmptyModelSearchResultsInDialog,{actionType:"search",scene:"model",onGotoClick:()=>He.setTabVal("market")})]})})}function MarketModelGrid(){const[{marketOrder:He}]=reactExports.useContext(ModelFormContext),[Qe,it]=reactExports.useContext(ModelFormContext),[lt]=useBlurNsfw(),ut=36,{posSeq:dt,feed:xt}=getPosSeqAndFeedForModelListQuery({order:He,keyword:Qe.searchKeyword}),ft=reactExports.useCallback((Qt,Wt)=>{const Xt=dt?Wt?.pageInfo.endCursor:Wt?.pageInfo.startCursor,Kt=getBaseCursorPagingArgs({before:dt?void 0:Xt,after:dt?Xt:void 0,pageSize:ut,isPosSeq:dt}),Jt=Qe.marketFilters,hr=Jt&&ModelFiltersToModelType(Jt);return{...Array.isArray(hr?.type)?{types:hr.type}:{type:GenerationModelType.AnyModel},timeRange:Jt?.time?createTimeRange(Jt.time):void 0,feed:xt,orderBy:translateOrderOptionToQueryOrderBy(He),keyword:Qe.searchKeyword||void 0,...Kt}},[xt,dt,He,Qe.marketFilters,Qe.searchKeyword]),{data:vt,isValidating:kt,isLoading:St,setSize:Tt,size:Mt}=useGenerationModelsInfinite(ft,{revalidateFirstPage:!1}),Nt=reactExports.useMemo(()=>vt?uniqBy(vt.flatMap(Wt=>{const Xt=getNodesFromConnection(Wt);return dt?Xt:Xt.reverse()}),"id"):[],[vt,dt]),At=reactExports.useMemo(()=>vt?.at(-1)?.pageInfo,[vt]),$t=reactExports.useMemo(()=>vt?.at(-1)?.totalCount,[vt]),Dt=reactExports.useMemo(()=>dt?At?.hasNextPage:At?.hasPreviousPage,[At,dt]),Ft=reactExports.useMemo(()=>St||Mt>0&&vt&&vt[Mt-1]==null,[Mt,St]),Bt=reactExports.useCallback(()=>{!kt&&Dt&&Tt(Qt=>Qt+1)},[Dt,kt]),Ot=reactExports.useCallback(()=>Ft?jsxRuntimeExports.jsx(Preloader,{className:"!my-1"}):Qe.searchKeyword.length>0?jsxRuntimeExports.jsx(EmptyModelSearchResultsInDialog,{actionType:"go",scene:"model",className:"pb-20"}):null,[Ft,Qe.searchKeyword]);return Nt.length===0?St?jsxRuntimeExports.jsx("div",{className:"w-full min-h-[360px] h-[var(--list-height)]",children:jsxRuntimeExports.jsx(LoadingPage,{fullHeight:!0})}):jsxRuntimeExports.jsx(EmptyModelSearchResultsInDialog,{actionType:"go",scene:"model",className:"h-[var(--list-height)]",showDescription:!0}):jsxRuntimeExports.jsx(RadioGroup,{value:Qe.modelId,style:{height:"var(--list-height)"},children:jsxRuntimeExports.jsx(Yr,{className:"w-full min-h-[140px]",totalCount:$t,data:Nt,endReached:Bt,itemContent:(Qt,Wt)=>{const{title:Xt,type:Kt,tags:Jt,media:hr,id:xr,refCount:gr,latestAvailableVersion:br}=Wt;return jsxRuntimeExports.jsx(ModelControlLabel,{control:jsxRuntimeExports.jsx(Radio,{className:"sr-only",onChange:()=>{it(vr=>({...vr,type:"market",versionId:br?.id||null,modelId:xr,name:Xt,openDetail:!0}))}}),selected:Qe.modelId===xr,modelId:xr,modelType:Kt,modelTags:Jt,title:Xt,media:hr,badge:jsxRuntimeExports.jsx(ModelBadge,{model:Wt}),blurCover:shouldModelBeBlurred(Wt)&&lt,showRefCount:!0,refCount:gr,onClick:()=>{Qe.modelId===xr&&it(vr=>({...vr,type:"market",openDetail:!0}))}},xr)},overscan:200,components:{Footer:Ot,List:ModelListContainerInDialog}})})}function ModelControlLabel(He){const{control:Qe,selected:it,disabled:lt,modelId:ut,modelType:dt,modelTags:xt,title:ft,media:vt,badge:kt,preview:St=getThumbnailUrl(vt),titleClassName:Tt,blurCover:Mt,showRefCount:Nt,refCount:At,onClick:$t,extraComp:Dt}=He,Ft=reactExports.useCallback(Bt=>{Bt.button!==0||Bt.ctrlKey||Bt.metaKey||Bt.shiftKey||(Bt.preventDefault(),Bt.currentTarget.parentElement?.click())},[]);return ut?jsxRuntimeExports.jsx(FormControlLabel,{className:"group/label relative m-0 block isolate h-fit",disableTypography:!0,value:ut,disabled:lt,title:ft,control:Qe,onClick:$t,label:jsxRuntimeExports.jsxs("a",{className:"flex flex-col items-center",tabIndex:-1,href:`/model/${ut}`,target:"_blank",onClick:Ft,children:[jsxRuntimeExports.jsxs("div",{className:cx("w-full aspect-square relative rounded-xl m-[3px] overflow-hidden","ring-2 ring-offset-1 ring-offset-background-light",it?"ring-purple-400 dark:ring-purple-600":"ring-transparent","group-[&:has(:focus-visible)]/label:ring-purple-600","dark:group-[&:has(:focus-visible)]/label:ring-purple-400"),children:[jsxRuntimeExports.jsx("img",{src:St,alt:"",loading:"lazy",decoding:"async",className:"size-full object-top object-cover"}),Mt&&jsxRuntimeExports.jsx(NsfwBlurForImage,{className:"rounded-xl"}),jsxRuntimeExports.jsx(ModelPreviewCornerTypeTag,{modelType:dt,modelTags:xt}),kt,Nt&&At!=null&&jsxRuntimeExports.jsx(ModelRefCountInDialog,{refCount:At}),Dt]}),jsxRuntimeExports.jsx("p",{className:cx("pt-1 h-10 text-center text-xs leading-5 font-semibold","line-clamp-2 break-all hyphens-auto",Tt),children:ft})]})}):jsxRuntimeExports.jsx("div",{className:"aspect-square p-3 grid place-content-center text-center text-primary-light border border-background-light rounded-xl",children:"Model Deleted"})}function ModelPreviewCornerTypeTag(He){const{t:Qe}=useTranslation(["market"]),{modelType:it,modelTags:lt}=He,ut=it?getModelTypeChipConfig(Qe,{type:it,tags:lt}):void 0;if(!ut)return null;const dt=ut.label.length>10;return jsxRuntimeExports.jsx("span",{className:cx(ut?.bgClassName,"text-black text-xs leading-4","absolute top-0 left-0 translate-x-[3px] translate-y-[3px] px-2 shadow rounded-lg",dt&&"px-1 tracking-tighter"),children:ut?.label})}function ModelPinnedIcon(He){if(!He.pinned)return null;const Qe=jsxRuntimeExports.jsx(icBaselinePushPin,{className:"size-3 text-white rotate-45 -translate-x-px translate-y-px"});return jsxRuntimeExports.jsx("span",{className:cx("rounded-full p-0.5 bg-purple-400",He.className),children:Qe})}function ModelBadge(He){return isModelEarlyAccess(He.model.extra)?jsxRuntimeExports.jsx("div",{className:"bg-gradient-purple-pink absolute w-full h-4 bottom-[20%] translate-y-[20%] -right-[25%] -rotate-45 flex items-center justify-center text-xs font-semibold text-gray-50 shadow-md",children:"Beta"}):null}const icBaselineDeleteForever=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12l1.41 1.41L13.41 14l2.12 2.12l-1.41 1.41L12 15.41l-2.12 2.12l-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"})}),icBaselineFileUpload=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M9 16h6v-6h4l-7-7l-7 7h4zm-4 2h14v2H5z"})}),icBaselineMenuBook=He=>jsxRuntimeExports.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:[jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M21 5c-1.11-.35-2.33-.5-3.5-.5c-1.95 0-4.05.4-5.5 1.5c-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5c.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5c1.35-.85 3.8-1.5 5.5-1.5c1.65 0 3.35.3 4.75 1.05c.1.05.15.05.25.05c.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1zm0 13.5c-1.1-.35-2.3-.5-3.5-.5c-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5c1.2 0 2.4.15 3.5.5v11.5z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17.5 10.5c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99zM13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99c.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24c-1.7 0-3.24.3-4.5.83zm4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99c.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24z"})]}),UISpinnerLoading=He=>He.loading?jsxRuntimeExports.jsx(fluentSpinnerIos16Filled,{className:cx("animate-spin",He.className)}):He.children,emojioneV1LightningMood=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 64 64",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"#fbb11c",d:"M43.4.159L12.06 28.492l24.31 7.538L18.12 64l35.26-33.426l-18.978-8.464z"})}),mingcuteTransferLine=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsxs("g",{fill:"none",children:[jsxRuntimeExports.jsx("path",{d:"M24 0v24H0V0h24ZM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018Zm.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01l-.184-.092Z"}),jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M20 14a1 1 0 0 1 .117 1.993L20 16H6.414l2.293 2.293a1 1 0 0 1-1.32 1.497l-.094-.083l-3.83-3.83c-.665-.664-.239-1.783.663-1.871L4.241 14H20Zm-4.707-9.707a1 1 0 0 1 1.32-.083l.094.083l3.83 3.83c.665.664.239 1.783-.663 1.871l-.115.006H4a1 1 0 0 1-.117-1.993L4 8h13.586l-2.293-2.293a1 1 0 0 1 0-1.414Z"})]})}),MODEL_SELECT_MODE_STORAGE_KEY="generator::model-select-list-mode";function useModelSelectModeStorage(){return useLocalStorage({key:MODEL_SELECT_MODE_STORAGE_KEY,defaultValue:"preset"})}function ModelSelect(He){const[Qe]=useModelSelectModeStorage();return jsxRuntimeExports.jsxs(ModelFormContextProvider,{children:[jsxRuntimeExports.jsx(CurrentModel,{...He}),jsxRuntimeExports.jsx(ModelQuickSelectInSidebar,{mode:Qe})]})}function ModelModeToggle(He){const{t:Qe}=useTranslation(["generation"]),{mode:it,setMode:lt,className:ut}=He,{beingMember:dt}=useMe(),xt=dt?jsxRuntimeExports.jsx(mingcuteTransferLine,{className:"text-feat-brand-100"}):jsxRuntimeExports.jsx(MembershipIconCircled,{className:"size-4"}),ft=reactExports.useCallback(()=>{dt?lt(vt=>vt==="preset"?"bookmark":"preset"):openMembershipMoreCreditsModal({defaultMode:"plans",trackingLocation:"genpage-sidebar-bookmark"})},[dt]);return reactExports.useEffect(()=>{!dt&&it==="bookmark"&&lt("preset")},[dt,it]),jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",icon:xt,onPress:ft,className:cx(ut,"px-1 py-[2px] font-semibold text-xs gap-1 focus:outline-1 focus:outline-purple-400"),children:jsxRuntimeExports.jsx("span",{className:cx(it==="preset"&&dt&&"text-theme-primary"),children:Qe(it==="preset"?"generation:model.select.mode.bookmark":"generation:model.select.mode.preset")})})}function CurrentModel({modelId:He}){const{data:Qe,isLoading:it}=useGenerationModelByVersionId(He||void 0),lt=hasModelEnabledLightning(Qe?.extra);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:He&&jsxRuntimeExports.jsx(CurrentModelContent,{modelVersionId:He,modelVersion:Qe,loading:it,modelSupportsLightning:lt})})}function ModelModeSelect(He){const{modelVersion:Qe,modelSupportsLightning:it}=He;function lt(){const St=getDefaultParamsFromModelVersionExtra({versionExtra:Qe?.extra,modelId:Qe?.model?.id,modelType:Qe?.model?.type},{enableLightningMode:!1});return{...pick$1(St,["cfgScale","samplingSteps"]),lightning:!1}}const{t:ut}=useTranslation(["generation"]),{values:dt,setValues:xt}=useTaskSubmitFormContext(),{beingMember:ft}=useMe(),vt=dt.lightning?"lightning":"quality",kt=reactExports.useCallback(St=>{const Tt=$$3(St).with("quality",()=>lt()).with("lightning",()=>LIGHTNING_MODE_DEFAULT_PARAMS).exhaustive();xt(Mt=>({...Mt,...Tt}))},[Qe,lt]);return it?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(UISelect,{className:"min-w-16",items:[{key:"lightning",name:ut("generation:model.lightning.mode.lightning"),startIcon:jsxRuntimeExports.jsx(emojioneV1LightningMood,{className:"size-4"})},{key:"quality",name:ut("generation:model.lightning.mode.quality"),startIcon:jsxRuntimeExports.jsx(MembershipIconCircled,{className:"size-4"})}],selectedKey:vt,onSelectionChange:St=>{if(St==="quality"&&!ft){openMembershipFeatureDialog({dialogBody:jsxRuntimeExports.jsx(Text,{i18nKey:"membership:membership-only-feature-dialog.content.lightning-mode-quality"}),trackingLocation:"genpage-sidebar-model"});return}kt(St)},children:St=>jsxRuntimeExports.jsx(UISelectItem,{id:St.key,startIcon:St.startIcon,children:St.name})}),jsxRuntimeExports.jsx(UITooltipHelpIcon,{TooltipProps:{placement:"start"},children:jsxRuntimeExports.jsx("p",{className:"p-4 text-sm min-w-[270px] whitespace-pre-wrap",children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:model.lightning.help.description",components:{br:jsxRuntimeExports.jsx("br",{}),b:jsxRuntimeExports.jsx("b",{})}})})})]}):null}function hasModelEnabledCapabilityTags(He){return!!He.modelVersionExtra?.capabilities}function ModelCapabilityTags(He){const{modelVersionExtra:Qe}=He,it=Qe.capabilities;function lt(ut){return jsxRuntimeExports.jsx("div",{className:"inline bg-purple-300 rounded-xl px-2 mt-1 text-xs leading-4 truncate dark:bg-purple-600 dark:text-neutral-300",children:jsxRuntimeExports.jsx(Text,{i18nKey:`market:model.capability.${ut.capability}`})})}return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:it.map(ut=>jsxRuntimeExports.jsx(lt,{capability:ut},ut))})}function CurrentModelContent(He){const{modelVersion:Qe,loading:it,modelVersionId:lt,modelSupportsLightning:ut}=He,{t:dt}=useTranslation(["generation"]),xt=getThumbnailUrl(Qe?.media),ft=ce$1({base:"shrink-0 border border-px rounded-xl mb-1",variants:{size:{withTag:"w-12 h-12",default:"w-16 h-16"}}});return jsxRuntimeExports.jsxs("div",{className:"px-4 py-2 bg-background-light rounded-xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-row items-center justify-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:ft({size:hasModelEnabledCapabilityTags({modelVersionExtra:Qe?.extra})?"withTag":"default"}),children:xt&&!it&&jsxRuntimeExports.jsx("img",{src:xt,alt:"",loading:"eager",decoding:"sync",className:"rounded-xl w-full h-full object-cover"})}),jsxRuntimeExports.jsx("p",{className:"font-semibold text-sm break-all hyphens-auto max-w-[150px] relative",children:Qe?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Link,{to:`/model/${Qe.modelId}`,target:"_blank",children:Qe.model?.title}),jsxRuntimeExports.jsx(Link,{to:`/model/${Qe.modelId}/${Qe.id}`,target:"_blank",className:"block font-semibold font-mono text-xs text-primary-light truncate",children:Qe.name}),jsxRuntimeExports.jsx(ModelModeSelect,{modelVersion:Qe,modelSupportsLightning:ut})]}):jsxRuntimeExports.jsx(UISpinnerLoading,{className:"size-10",loading:it,children:jsxRuntimeExports.jsx("span",{className:"w-full italic",children:dt("generation:model.unavailable",{modelName:lt})})})})]}),hasModelEnabledCapabilityTags({modelVersionExtra:Qe?.extra})?jsxRuntimeExports.jsx("div",{className:"flex gap-1 flex-wrap border-dashed border-t-neutral-300",children:jsxRuntimeExports.jsx(ModelCapabilityTags,{modelVersionExtra:Qe.extra})}):null]})}function ModelQuickSelectInSidebar(He){const{beingMember:Qe,me:it}=useMe(),[lt,ut]=reactExports.useContext(ModelFormContext),{values:dt,setValues:xt}=useTaskSubmitFormContext(),{modelId:ft}=dt,[vt,kt]=reactExports.useState(!1),{t:St}=useTranslation(["artwork","action","generation"]),{data:Tt,isLoading:Mt}=useMyBookmarkedGenerationModels(He.mode==="bookmark"?{modelType:GenerationModelType.AnyModel,first:6}:void 0),{data:Nt}=useGenerationModelByVersionId(ft??void 0),At=isXLModel(Nt?.modelType),{modelList:$t,isLoading:Dt}=usePresetModels(),Ft=getNodesFromConnection(Tt),Bt=He.mode==="preset"?$t:Ft,Ot=He.mode==="preset"?Dt:Mt;reactExports.useEffect(()=>{Nt&&ft&&ft!==lt.versionId&&ut(Jt=>({...Jt,searchKeyword:"",searchKeywordForInput:"",versionId:ft,type:"preset",modelId:Nt.modelId,openDetail:!1}))},[ft,lt.versionId,Nt]);const Qt=reactExports.useCallback(Jt=>{const hr=isModelEarlyAccess(Jt),xr=getModelEarlyAccessRoles(Jt).length>0,gr=Qe||!hr||xr,br="gen-page-model-select-early-access";return it?.id?(gr||openProceedMembershipModal({membershipModalProps:{trackingLocation:br},confirmationDialogProps:{heading:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.early-access.membership-dialog.heading"}),content:jsxRuntimeExports.jsx(Text,{i18nKey:"market:model.early-access.membership-dialog.content"})}}),gr):openSignModal(void 0,{fromPath:br})},[Qe,it?.id]),Wt=isHiResEnabled(dt.upscale),Xt=reactExports.useCallback(Jt=>{const{id:hr,title:xr,type:gr,latestAvailableVersion:br,extra:vr}=Jt,yr=br?.id;if(!yr)return;track("outer_model_click",{modelId:hr,location:He.mode}),ut($r=>({...$r,type:"preset",versionId:br?.id||null,modelId:hr,name:xr,openDetail:!1}));const Cr=br?.extra,Rr=vr;if(!Qt(Rr))return;const{values:Ir,hasResetHires:Tr}=getParamsForModelChange({versionId:yr,modelId:hr,versionExtra:Cr,modelType:gr,modelExtra:Rr,currentModelType:Nt?.modelType},{hiresEnabled:Wt,enableLightningMode:!0});xt($r=>({...$r,...Ir})),Tr&&toast.info(St("generation:hires.notice.settings-reset-by-model-change"))},[He.mode,Wt,Nt?.modelType,Qt]),Kt=reactExports.useCallback(Jt=>{if(!Qt(Jt.model?.extra))return;const{values:hr,hasResetHires:xr}=getParamsForModelChange({modelId:Jt.modelId,versionId:Jt.id,versionExtra:Jt.extra,modelType:Jt.modelType,modelExtra:Jt.model?.extra,currentModelType:Nt?.modelType},{hiresEnabled:Wt,enableLightningMode:!0});xt(gr=>({...gr,...hr})),xr&&toast.info(St("generation:hires.notice.settings-reset-by-model-change"))},[At,Wt,Nt?.modelType,Qt]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(FormControl,{className:"gap-2",children:Bt.length<1?Ot?jsxRuntimeExports.jsx(CircularSpinner,{}):jsxRuntimeExports.jsx(EmptyModelListInSidebar,{className:"h-[var(--list-height)] py-4 px-1 text-center text-neutral-400 dark:text-neutral-400 text-sm",mode:He.mode}):jsxRuntimeExports.jsxs(RadioGroup,{value:ft?lt.modelId:"uploaded",className:"grid grid-cols-3 gap-3 mt-2 w-full items-start justify-items-stretch",children:[Bt.slice(0,6).map(Jt=>jsxRuntimeExports.jsx(ModelControlLabel,{control:jsxRuntimeExports.jsx(Radio,{className:"sr-only",onChange:()=>{Xt(Jt)}}),selected:ft===Jt.latestAvailableVersion?.id,modelId:Jt.id,modelType:Jt.type,modelTags:Jt.tags,title:Jt.title,media:Jt.media,badge:jsxRuntimeExports.jsx(ModelBadge,{model:Jt})},Jt.id)),jsxRuntimeExports.jsx(Radio,{className:"hidden",value:"uploaded"})]})}),jsxRuntimeExports.jsx(UIButton$1,{color:"grayish-sidebar",variant:"filled",className:"capitalize",onPress:()=>{track("show_more_model_click",{location:He.mode}),kt(!0)},children:St("generation:model.select.show-more-model")}),jsxRuntimeExports.jsx(ModelSelectDialog,{open:vt,onClose:()=>kt(!1),initState:lt,onVersionSelected:Jt=>{Kt(Jt)}})]})}const SIZE_MIN=256,SDV1_RANGE_FOR_MEMBER=[512,1400],SDXL_RANGE_FOR_MEMBER=[768,1400],SDV1_RANGE=[512,1280],SDXL_RANGE=[768,1280],DITV1_RANGE=SDXL_RANGE,DITV1_RANGE_FOR_MEMBER=[768,1392];function sizeInRange(He,Qe){const{width:it,height:lt}=He;return it>=Qe[0]&&it<=Qe[1]&&lt>=Qe[0]&&lt<=Qe[1]}function validateSize(He){const{width:Qe=SIZE_MIN,height:it=SIZE_MIN,modelType:lt,isMember:ut}=He,{range:dt,presets:xt,memberRange:ft,memberPresets:vt}=$$3(lt).with(GenerationModelType.SdxlModel,()=>({range:SDXL_RANGE,memberRange:SDXL_RANGE_FOR_MEMBER,presets:[...PRESET_SIZES_SDXL],memberPresets:[...PRESET_SIZES_SDXL,...PRESET_SIZES_SDXL_FOR_MEMBER]})).when(isDitV1Model,()=>({range:DITV1_RANGE,memberRange:DITV1_RANGE_FOR_MEMBER,presets:[...PRESET_SIZES_DITV1],memberPresets:[...PRESET_SIZES_DITV1,...PRESET_SIZES_DITV1_FOR_MEMBER]})).otherwise(()=>({range:SDV1_RANGE,memberRange:SDV1_RANGE_FOR_MEMBER,presets:[...PRESET_SIZES_SDV1],memberPresets:[...PRESET_SIZES_SDV1,...PRESET_SIZES_SDV1_FOR_MEMBER]}));if(He.additionalSizePresets)for(const $t of He.additionalSizePresets)$t.extraProps?.memberOnly||xt.push([$t.width,$t.height]),vt.push([$t.width,$t.height]);const kt=xt.some($t=>$t[0]===Qe&&$t[1]===it),St=vt.some($t=>$t[0]===Qe&&$t[1]===it),Tt=sizeInRange({width:Qe,height:it},dt),Mt=sizeInRange({width:Qe,height:it},ft),Nt=kt||Tt,At=St||Mt;return{allowed:ut?At:Nt,memberOnly:At&&!Nt}}const SD_MODEL_DIVISOR=8,DIT_MODEL_DIVISOR=16;function getModelSizeDivisor(He){const{modelType:Qe,versionExtra:it}=He,lt=it?.restrictions?.width?.step,ut=it?.restrictions?.height?.step,dt=isDitV1Model(Qe)?DIT_MODEL_DIVISOR:SD_MODEL_DIVISOR;return{width:lt||dt,height:ut||dt}}function useImageControlSizeContext(){const{values:{modelId:He}}=useTaskSubmitFormContext(),Qe=useModelVersion(He)?.modelType,it=parseModelTypeForSizeSelection(Qe),lt=reactExports.useCallback(ut=>ut.extraProps?.modelType===it,[it]);return reactExports.useMemo(()=>({availablePresetSizes:PRESET_SIZES.filter(lt),availableSidebarSizes:SIDEBAR_SIZES.filter(lt),presetSizes:Array.from(new Set([...PRESET_SIZES,...SIDEBAR_SIZES])).filter(lt)}),[lt])}function useCurrentModelAvailablePresetSizes(){const{values:He}=useTaskSubmitFormContext(),Qe=useModelVersion(He.modelId),{availablePresetSizes:it}=useImageControlSizeContext();return[...Qe?.extra?.presetSizes??[],...it]}function ImageSizeControl(){const{t:He}=useTranslation(["artwork"]);return jsxRuntimeExports.jsx(GeneratorControlSection,{title:He("generation:size.label"),children:jsxRuntimeExports.jsx(TaskSizeSelect,{})})}function TaskSizeSelect(){const{values:{width:He,height:Qe,modelId:it},setValues:lt}=useTaskSubmitFormContext(),{beingMember:ut}=useMe(),{availableSidebarSizes:dt,presetSizes:xt}=useImageControlSizeContext(),ft=useModelVersion(it),vt=ft?.modelType,kt=ft?.extra?.presetSizes,St=reactExports.useCallback(()=>{if(!vt)return;const{allowed:Tt}=validateSize({width:He,height:Qe,modelType:vt,isMember:ut,additionalSizePresets:kt});if(!Tt)lt(Mt=>({...Mt,width:dt[0].width,height:dt[0].height}));else{const Mt=getDefaultSizeByModelType(vt);lt(Nt=>({...Nt,width:He||Mt.width,height:Qe||Mt.height}))}},[dt,xt,He,Qe,ut,vt,kt]);return reactExports.useEffect(()=>{St()},[He,Qe,vt]),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:jsxRuntimeExports.jsx(ImageSizeSidebarButtonGroup,{})})}function SizeInput(He){const{value:Qe,onChange:it,label:lt,className:ut,showMembershipBorder:dt,divisor:xt,...ft}=He,[vt,kt]=reactExports.useState(String(Qe));reactExports.useEffect(()=>void kt(String(Qe)),[Qe]);function St(){const Tt=Number(vt);let Mt=isNaN(Tt)?512:Tt;xt&&(Mt=Math.floor(Mt/xt)*xt),it(Mt),kt(String(Mt))}return jsxRuntimeExports.jsxs($bcdf0525bf22703d$export$2c73285ae9390cec,{value:vt,type:"text",className:ut,...ft,children:[jsxRuntimeExports.jsx($01b77f81d0f07f68$export$b04be29aa201d4f5,{children:lt}),jsxRuntimeExports.jsx("div",{className:cx("w-full py-px px-px rounded-[11px]",dt&&"bg-gradient-purple-pink"),children:jsxRuntimeExports.jsx(UIInput,{variant:"rounded-normal",inputMode:"numeric",onChange:Tt=>kt(Tt.target.value),onBlur:St,value:vt,step:xt,className:cx("w-full rounded-[10px]",dt&&"border-transparent")})})]})}function ImageSizePresetsInModal(He){const Qe=useCurrentModelAvailablePresetSizes(),{t:it}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx($01b77f81d0f07f68$export$b04be29aa201d4f5,{className:"block mb-2",children:it("generation:size.preset-menu.label")}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-[10px] min-h-8 py-1 px-1 overflow-y-auto",children:Qe.map(lt=>jsxRuntimeExports.jsx(ImageSizeSelectBtn,{className:"flex items-center gap-1 py-[10px] px-2 relative rounded-[10px] w-full",width:lt.width,height:lt.height,memberOnly:lt.extraProps?.memberOnly,label:lt.extraProps?.label,selected:He.width===lt.width&&He.height===lt.height,onPress:()=>He.onChange({width:lt.width,height:lt.height})},`${lt.width}-${lt.height}`))})]})}function ImageSizeSidebarButtonGroup(){const{t:He}=useTranslation(["generation"]),{beingMember:Qe}=useMe(),{setValues:it,values:lt}=useTaskSubmitFormContext(),{availableSidebarSizes:ut}=useImageControlSizeContext();function dt(vt){it(kt=>({...kt,width:vt.width,height:vt.height})),xt()}const xt=reactExports.useCallback(()=>{isHiResEnabled(lt.upscale)&&(it(vt=>({...vt,...emptyHiResParams})),toast.info(He("generation:hires.notice.settings-reset-by-size-change")))},[lt.upscale]),ft=reactExports.useMemo(()=>ut.some(vt=>vt.width===lt.width&&vt.height===lt.height),[ut,lt.width,lt.height]);return jsxRuntimeExports.jsxs("div",{className:"w-full gap-2 grid grid-cols-4 mlg:flex",children:[ut.map(vt=>jsxRuntimeExports.jsx(ImageSizeSelectBtn,{className:"flex flex-col gap-1 rounded-lg items-center mlg:w-[66px]",label:vt.extraProps?.label,memberOnly:vt.extraProps?.memberOnly,width:vt.width,height:vt.height,onPress:()=>{vt.extraProps?.memberOnly&&!Qe?openMembershipMoreCreditsModal({defaultMode:"plans",trackingLocation:"dimension-size"}):dt({width:vt.width,height:vt.height})},selected:vt.width===lt.width&&vt.height===lt.height},`${vt.width}-${vt.height}`)),jsxRuntimeExports.jsx(ImageSizeSelectModal,{custom:!0,width:lt.width,height:lt.height,onConfirm:vt=>{dt(vt)},moreSelected:!ft},`${lt.width}-${lt.height}`)]})}function ImageSizeSelectBtn(He){const{width:Qe=0,height:it=0}=He,lt=He.iconType==="more"&&!He.selected?"…":`${Qe}×${it}`,ut=Math.max(Qe,it);return jsxRuntimeExports.jsxs($d2b4bc8c273e7be6$export$353f5b6fc5456de1,{className:cx("py-4 bg-neutral-100 dark:bg-neutral-700 ring-1 relative cursor-pointer hover:shadow-md active:shadow-md",He.selected?"ring-neutral-700 dark:ring-neutral-300":"ring-neutral-50 dark:ring-neutral-900",He.className),style:He.style,onPress:He.onPress,children:[jsxRuntimeExports.jsx("div",{className:"flex-none w-5 h-5 flex justify-center items-center relative",children:He.iconType==="more"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"border-dashed border-[2px] border-zinc-500 dark:border-zinc-300 rounded-sm",style:{width:"100%",height:"66%"}}),jsxRuntimeExports.jsx("div",{className:"absolute border-[2px] border-zinc-500 dark:border-zinc-300 ring-[1.5px] dark:ring-neutral-700 ring-neutral-100 rounded-sm bg-neutral-100 dark:bg-neutral-700",style:{width:"66%",height:"100%"}})]}):jsxRuntimeExports.jsx("div",{className:"border-2 dark:border-zinc-300 border-zinc-500 rounded-sm",style:{width:Qe/ut*100+"%",height:it/ut*100+"%"}})}),jsxRuntimeExports.jsx($01b77f81d0f07f68$export$b04be29aa201d4f5,{className:"font-semibold",children:He.label}),jsxRuntimeExports.jsx("span",{className:"text-[11px] leading-3 text-neutral-500 dark:text-neutral-400",children:lt}),He.memberOnly&&jsxRuntimeExports.jsx(MembershipIconCircled,{className:"absolute top-0 right-0 -translate-x-0.5 translate-y-0.5 size-4"})]})}function ImageSizeSelectModal(He){const{custom:Qe,onConfirm:it}=He,{beingMember:lt}=useMe(),{t:ut}=useTranslation(["generation","action"]),[dt,xt]=reactExports.useState(He.width??512),[ft,vt]=reactExports.useState(He.height??512),{values:{modelId:kt}}=useTaskSubmitFormContext(),St=useModelVersion(kt),Tt=St?.extra?.presetSizes,Mt=St?.modelType??GenerationModelType.SdxlModel,{allowed:Nt,memberOnly:At}=validateSize({width:dt,height:ft,modelType:Mt,isMember:lt,additionalSizePresets:Tt}),$t=getModelSizeDivisor({modelType:Mt,versionExtra:St?.extra}),Dt=reactExports.useCallback(Qt=>{const Wt=()=>{it?.({width:dt,height:ft}),Qt()};At&&!lt?(openMembershipMoreCreditsModal({afterPurchaseSuccess:Wt,defaultMode:"plans",trackingLocation:"dimension-size"}),Qt()):Wt()},[lt,At,dt,ft]),[Ft,Bt]=reactExports.useState(!1),Ot=reactExports.useCallback(()=>{xt(He.width??512),vt(He.height??512),Bt(!1)},[He.width,He.height]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ImageSizeSelectBtn,{className:"flex flex-col gap-1 rounded-lg items-center mlg:w-[66px]",label:"More",width:He.width,height:He.height,iconType:"more",selected:He.moreSelected,onPress:()=>Bt(!0)}),jsxRuntimeExports.jsxs(UIDialog,{open:Ft,onClose:Ot,dismissable:!0,className:"mlg:w-80",children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:ut("generation:size.dialog.title"),children:({heading:Qt})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Qt,jsxRuntimeExports.jsx("p",{className:"mt-2 text-neutral-500",children:ut("generation:size.dialog.subtitle")})]})}),jsxRuntimeExports.jsxs(UIDialogContent,{className:"flex flex-col gap-2",children:[!Nt&&!At&&jsxRuntimeExports.jsx(ControlSectionMessage,{type:ControlSectionMessageType.Warning,children:isSDV1Model(Mt)?ut("generation:size.custom-size.size-invalid-sdv1"):ut("generation:size.custom-size.size-invalid-sdxl")}),jsxRuntimeExports.jsxs("section",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SizeInput,{value:dt,onChange:Qt=>xt(Qt),isDisabled:!Qe,className:"flex-1 min-w-0",label:ut("generation:size.width"),showMembershipBorder:At,divisor:$t.width,name:"width"}),jsxRuntimeExports.jsx("span",{className:"translate-y-2",children:"×"}),jsxRuntimeExports.jsx(SizeInput,{value:ft,onChange:Qt=>vt(Qt),isDisabled:!Qe,className:"flex-1 min-w-0",label:ut("generation:size.height"),showMembershipBorder:At,divisor:$t.height,name:"height"})]}),jsxRuntimeExports.jsx("section",{className:"min-h-0 flex-1 flex flex-col",children:jsxRuntimeExports.jsx(ImageSizePresetsInModal,{onChange:Qt=>{xt(Qt.width),vt(Qt.height)},width:dt,height:ft})})]}),jsxRuntimeExports.jsx(UIDialogFooter,{children:({close:Qt})=>jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",onPress:()=>Dt(Qt),className:cx("w-full transition duration-500",At&&"bg-gradient-purple-pink text-white border-white dark:border-modal-background hover:shadow-md active:shadow-md"),disabled:!Nt&&!At,children:ut("action:confirm")})})]})]})}const TaskNotes=function(He){return jsxRuntimeExports.jsx(OpenListDialogContextProvider,{children:jsxRuntimeExports.jsx(TaskNotesContent,{...He})})},TaskNotesContent=function({iconOnly:He=!1,className:Qe,style:it,iconProps:lt={}}){const{t:ut}=useTranslation(["artwork"]),[{open:dt},xt]=reactExports.useContext(ListDialogContext);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("button",{className:Qe,style:it,onClick:()=>{track("notes_click"),xt({open:!0})},children:[jsxRuntimeExports.jsx(icBaselineMenuBook,{...lt}),jsxRuntimeExports.jsx("span",{className:cx({hidden:He}),children:ut("artwork:note.notes")})]}),jsxRuntimeExports.jsx(TaskNotesListDialog,{open:dt,onClose:()=>xt({open:!1})})]})};function TaskNotesListDialog(He){const{data:Qe,loading:it,refetch:lt}=useListMySettings({type:UserSettingType.Note,last:10}),{data:ut}=useGetMySettingLimit(UserSettingType.Note),{t:dt}=useTranslation(["artwork"]),xt=reactExports.useMemo(()=>getNodesFromConnection(Qe).reverse(),[Qe]),ft=Qe?.totalCount??0,kt=(ut??0)<=ft,St=xt.length<1?it?jsxRuntimeExports.jsx(Preloader,{}):jsxRuntimeExports.jsxs("div",{className:"w-full flex flex-col gap-2 items-center justify-center py-12",children:[jsxRuntimeExports.jsx(Empty,{}),jsxRuntimeExports.jsx("p",{children:dt("artwork:note.saved-notes.no-notes")})]}):jsxRuntimeExports.jsx("div",{className:"w-full px-4 flex flex-col gap-1 min-w-[400px] overflow-y-auto",children:xt.map(Tt=>jsxRuntimeExports.jsx(NoteContentPreview,{note:Tt},Tt.id))});return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs(UpsertNoteDialogContextProvider,{children:[jsxRuntimeExports.jsxs(UIDialog,{open:He.open,onClose:He.onClose,className:"max-w-[100vw-64px] min-w-[352px]",dismissable:!0,children:[jsxRuntimeExports.jsx(UIDialogHeader,{className:"relative",heading:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("p",{className:"font-semibold text-xl",children:dt("artwork:note.saved-notes.title")}),jsxRuntimeExports.jsx("p",{className:"text-xs",children:dt("artwork:note.saved-notes.description")}),jsxRuntimeExports.jsx(IconButton,{"aria-label":"close",onClick:He.onClose,sx:{position:"absolute",right:8,top:8},children:jsxRuntimeExports.jsx(icBaselineClose,{})})]})}),St,jsxRuntimeExports.jsx("div",{className:"w-full flex p-4 gap-4 justify-between",children:jsxRuntimeExports.jsx(ActionButtons,{limitReached:kt})})]}),jsxRuntimeExports.jsx(UpsertNoteDialogWrapper,{refreshList:lt})]})})}function ActionButtons(He){const{t:Qe}=useTranslation(["artwork"]),[,it]=reactExports.useContext(UpsertNoteDialogContext);return He.limitReached?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Tooltip,{title:Qe("artwork:note.notice.max-limit-reached"),placement:"top",children:jsxRuntimeExports.jsx(Button,{className:"font-bold cursor-not-allowed opacity-20",variant:"outlined",disableRipple:!0,children:Qe("artwork:note.add-new-note")})}),jsxRuntimeExports.jsx(Tooltip,{title:Qe("artwork:note.notice.max-limit-reached"),placement:"top",children:jsxRuntimeExports.jsx(Button,{className:"font-bold cursor-not-allowed opacity-20",variant:"contained",disableRipple:!0,children:Qe("artwork:note.save-current-params")})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{className:"font-bold",variant:"outlined",onClick:()=>{track("add_note_click"),it({open:!0,openFrom:"new"})},children:Qe("artwork:note.add-new-note")}),jsxRuntimeExports.jsx(Button,{className:"font-bold",variant:"contained",onClick:()=>{track("save_current_click"),it({open:!0,loadFromTaskForm:!0,openFrom:"generate"})},children:Qe("artwork:note.save-current-params")})]})}function NoteContentPreview(He){const{t:Qe}=useTranslation(["artwork","user","common","action"]),it=He.note.data.title||"(Empty Title)",lt=He.note.data.prompts||"(Empty Prompts)",[,ut]=reactExports.useContext(UpsertNoteDialogContext),[,dt]=reactExports.useContext(ListDialogContext),{data:xt}=useDynamicDefaultParameters(),{setValues:ft}=useTaskSubmitFormContext(),{data:{samplingMethods:vt}={}}=useDynamicConstants(),kt=async()=>{try{await dialogConfirm({title:Qe("artwork:note.apply-note.title"),description:Qe("artwork:note.apply-note.desc"),cancelLabel:Qe("action:cancel"),confirmLabel:Qe("action:confirm")});const{baseImageMediaId:St}=He.note.data,Tt=St?(await fetchGetMedia({id:St})).data.media:void 0;ft({...xt,...parseInitialValuesForNote({media:Tt,noteContent:He.note.data,samplingMethods:vt,extraInitialValues:{seed:He.note.data.seed??""}})}),track("prompt_notes_selected"),dt({open:!1})}catch(St){if(St===UserCancelled)return}};return jsxRuntimeExports.jsxs("div",{role:"button",className:"flex flex-col items-start rounded-xl hover:bg-neutral-200 px-4 py-2 transition-all group",onClick:kt,children:[jsxRuntimeExports.jsx("h5",{className:"font-semibold",children:it}),jsxRuntimeExports.jsxs("div",{className:"inline-flex w-full items-center",children:[jsxRuntimeExports.jsx("p",{className:"text-neutral-400 font-light line-clamp-2 max-w-[400px]",children:lt}),jsxRuntimeExports.jsx(IconButton,{className:"shrink-0 w-12 h-12 ml-auto",onClick:St=>{St.stopPropagation(),track("edit_note_click"),ut({open:!0,noteId:He.note.id,openFrom:"edit"})},children:jsxRuntimeExports.jsx(icBaselineEdit,{className:"size-5"})})]})]})}const convertTaskValuesToNote=({width:He,height:Qe,baseImage:it,prompts:lt,negativePrompts:ut,modelId:dt,samplingMethod:xt,samplingSteps:ft,cfgScale:vt,seed:kt})=>({width:He,height:Qe,baseImage:it,prompts:lt,negativePrompts:ut,modelId:dt,samplingMethod:xt,samplingSteps:ft,cfgScale:vt,seed:kt});function UpsertNoteDialogWrapper(He){const[{noteId:Qe,open:it,loadFromTaskForm:lt},ut]=reactExports.useContext(UpsertNoteDialogContext),{values:dt}=useTaskSubmitFormContext(),xt=reactExports.useRef(!1),{data:ft,loading:vt}=useGetMySetting(Qe&&!lt?Qe:skipToken);reactExports.useEffect(()=>{if(!xt.current)return!vt&&ft&&(xt.current=!0),()=>{xt.current=!1}},[vt,ft,xt]);const kt=lt?convertTaskValuesToNote(dt):ft?.data;return jsxRuntimeExports.jsx(UpsertNoteDialog,{open:it,noteId:Qe,onClose:()=>ut({open:!1}),refreshList:He.refreshList,prefilledData:kt,isLoading:!xt.current&&vt})}function UpsertNoteDialog(He){const[Qe]=reactExports.useContext(UpsertNoteDialogContext),{t:it}=useTranslation(["artwork"]),{open:lt,noteId:ut,isLoading:dt,prefilledData:xt}=He,ft=()=>{He.refreshList?.(),He.onClose()},vt=He.openFrom??Qe.openFrom;return jsxRuntimeExports.jsxs(UIDialog,{open:lt,onClose:ft,className:"max-w-[600px] max-h-[calc(100%-64px)]",dismissable:!0,children:[jsxRuntimeExports.jsx(UIDialogHeader,{className:"m-0 p-4 relative",heading:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("p",{className:"font-semibold text-xl",children:it(ut?"artwork:note.edit-note":"artwork:note.new-note")}),jsxRuntimeExports.jsx(IconButton,{"aria-label":"close",onClick:ft,className:"absolute right-1 top-1 msm:right-3 msm:top-3",children:jsxRuntimeExports.jsx(icBaselineClose,{})})]})}),jsxRuntimeExports.jsx(UIDialogContent,{className:"min-w-[400px]",children:dt?jsxRuntimeExports.jsx(Preloader,{}):jsxRuntimeExports.jsxs(EditFormStateContextProvider,{defaultValue:xt,children:[jsxRuntimeExports.jsx(NewNoteForm,{}),jsxRuntimeExports.jsx(DialogActions,{className:"justify-between",children:jsxRuntimeExports.jsx(NoteActions,{noteId:ut,onSuccess:ft,openFrom:vt})})]})})]})}function NoteActions(He){const{t:Qe}=useTranslation(["action","generation"]),[it,lt]=reactExports.useContext(EditFormStateContext),[ut,dt]=useLoadingCallback(async()=>{try{const kt=it.baseImage&&await toast.promise(it.baseImage.toMedia({onCompressed(Tt){lt(Mt=>({...Mt,baseImage:Tt}))}}),{pending:`${Qe("generation:submit.notice.uploading-image")}`}),St=await executeUpsertMySetting({id:He.noteId,type:UserSettingType.Note,data:{...it,baseImage:void 0,size:void 0,baseImageMediaId:kt?.id}});track("save_note_click",{page:He.openFrom}),toast.success(He.noteId?"Successfully updated":"Successfully created"),He.onSuccess?.()}catch(kt){const St=$$3(getErrorData(kt)?.code).with(40300035,()=>Qe("artwork:note.notice.max-limit-reached")).otherwise(()=>kt.message);toast.error(Qe("artwork:note.notice.failed-to-save")+Qe("common:punctuations.colon")+" "+St)}},[it]),[xt,ft]=useLoadingCallback(async()=>{if(He.noteId)try{const kt=await executeDeleteMySetting({id:He.noteId});toast.success("Successfully deleted"),track("delete_note_click"),He.onSuccess?.()}catch(kt){toast.error(kt.message)}},[it]),vt=ut||xt;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[He.noteId&&jsxRuntimeExports.jsx(UIButton$1,{color:"danger",busy:vt,disabled:vt,onPress:ft,icon:jsxRuntimeExports.jsx(icBaselineDeleteForever,{className:"size-5"}),children:Qe("action:delete.label")}),jsxRuntimeExports.jsx(UIButton$1,{busy:vt,disabled:vt,onPress:dt,variant:"filled",className:"ml-auto",children:Qe("action:save")})]})}function NewNoteForm(){const{t:He}=useTranslation(["artwork","generation"]),[Qe,it]=reactExports.useContext(EditFormStateContext),lt=(ut,dt)=>{it(xt=>({...xt,[dt]:ut.target.value}))};return jsxRuntimeExports.jsxs("form",{noValidate:!0,autoComplete:"off",onSubmit:ut=>{ut.preventDefault()},className:"py-4 flex flex-col gap-4",children:[jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,children:[jsxRuntimeExports.jsx(InputLabel,{htmlFor:"title-input",children:He("artwork:title")}),jsxRuntimeExports.jsx(OutlinedInput,{value:Qe.title,onChange:ut=>lt(ut,"title"),id:"title-input",label:He("artwork:title")})]}),jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,children:[jsxRuntimeExports.jsx(InputLabel,{htmlFor:"prompts-input",children:He("artwork:prompts.prompts")}),jsxRuntimeExports.jsx(OutlinedInput,{placeholder:"Enter prompts",id:"prompts-input",value:Qe.prompts,onChange:ut=>lt(ut,"prompts"),label:He("artwork:prompts.prompts")})]}),jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,children:[jsxRuntimeExports.jsx(InputLabel,{htmlFor:"negative-prompts-input",children:He("generation:negative-prompts.label")}),jsxRuntimeExports.jsx(OutlinedInput,{placeholder:"Enter negative prompts",id:"negative-prompts-input",value:Qe.negativePrompts,onChange:ut=>lt(ut,"negativePrompts"),label:He("generation:negative-prompts.label")})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-y-4 gap-x-8 items-center",children:[jsxRuntimeExports.jsx(ModelSelectMenu,{}),jsxRuntimeExports.jsx(SizeSelectMenu,{}),jsxRuntimeExports.jsx(AdvancedParamsFormItems,{})]}),jsxRuntimeExports.jsx("div",{className:"w-[50%]",children:jsxRuntimeExports.jsx(BaseMediaSelectBtn,{})})]})}function ModelSelectMenu(){const[He,Qe]=reactExports.useState(!1),{t:it}=useTranslation(["artwork","generation"]),[lt,ut]=reactExports.useContext(EditFormStateContext),{modelId:dt}=lt,{data:xt,isValidating:ft}=useGenerationModelByVersionId(dt||void 0),vt={type:null,versionId:xt?.id||null,modelId:xt?.modelId||null,searchKeyword:"",searchKeywordForInput:"",openDetail:!1,tab:"preset"};return jsxRuntimeExports.jsxs("div",{className:"max-w-[500px]",children:[jsxRuntimeExports.jsx("label",{className:"text-stone-500 text-sm mb-1",children:it("artwork:note.base-model.label")}),jsxRuntimeExports.jsx("button",{onClick:kt=>{kt.target instanceof HTMLAnchorElement||Qe(!0)},className:"w-full text-start",children:dt?jsxRuntimeExports.jsx(CurrentModelContent,{modelVersion:xt,modelVersionId:dt,loading:ft}):jsxRuntimeExports.jsx("div",{className:"px-4 py-4 bg-background-light rounded-xl",children:jsxRuntimeExports.jsx("span",{className:"text-sm italic",children:it("generation:model.select.model.placeholder")})})}),jsxRuntimeExports.jsx(ModelSelectDialog,{onClose:()=>Qe(!1),open:He,initState:vt,onVersionSelected:kt=>{ut(St=>({...St,modelId:kt.id}))}})]})}function SizeSelectMenu(){const{t:He}=useTranslation(["artwork"]),[{width:Qe,height:it},lt]=reactExports.useContext(EditFormStateContext),ut=dt=>{lt(xt=>({...xt,width:dt.width,height:dt.height}))};return jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SizeInput,{value:Qe,onChange:dt=>lt(xt=>({...xt,width:dt})),className:"flex-1",label:He("generation:size.width")}),jsxRuntimeExports.jsx("span",{children:"×"}),jsxRuntimeExports.jsx(SizeInput,{value:it,onChange:dt=>lt(xt=>({...xt,height:dt})),className:"flex-1",label:He("generation:size.height")}),jsxRuntimeExports.jsx(Select,{value:"",displayEmpty:!0,renderValue:()=>He("generation:size.preset-menu.label"),size:"small",className:cx("text-center flex-none"),children:PRESET_SIZES.map(dt=>{const xt=Math.max(dt.width,dt.height);return jsxRuntimeExports.jsxs(MenuItem$1,{className:"gap-2",onClick:()=>ut(dt),children:[jsxRuntimeExports.jsx("div",{className:"flex-none w-5 h-5 flex justify-center items-center",children:jsxRuntimeExports.jsx("div",{className:"bg-zinc-300 dark:bg-zinc-500 rounded-sm",style:{width:dt.width/xt*100+"%",height:dt.height/xt*100+"%"}})}),dt.width,"×",dt.height]},`${dt.width}-${dt.height}`)})})]})}function AdvancedParamsFormItems(){const{t:He}=useTranslation(["generation","common"]),[Qe,it]=reactExports.useContext(EditFormStateContext),{data:{samplingMethods:lt=[]}={},isValidating:ut}=useDynamicConstants();return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(FormControl,{children:[jsxRuntimeExports.jsx("label",{htmlFor:"sampling-steps-select",className:"text-sm text-stone-500",children:He("generation:sampling-steps.label")}),jsxRuntimeExports.jsxs("div",{className:"inline-flex gap-4",children:[jsxRuntimeExports.jsx(Slider,{id:"sampling-steps-select",value:Qe.samplingSteps??1,onChange:(dt,xt)=>{typeof xt=="number"&&it(ft=>({...ft,samplingSteps:xt}))},min:1,max:50,step:1,valueLabelDisplay:"auto"}),jsxRuntimeExports.jsx(Input,{type:"number",className:"w-[60px]",value:Qe.samplingSteps??1,onChange:dt=>{const xt=Number(dt.target.value);it(ft=>({...ft,samplingSteps:clamp$1(xt,1,50)}))},inputProps:{min:1,max:50}})]})]}),jsxRuntimeExports.jsxs(FormControl,{children:[jsxRuntimeExports.jsx(InputLabel,{id:"sampling-method-select",children:He("generation:sampling-method.label")}),jsxRuntimeExports.jsxs(Select,{className:"w-[200px]",labelId:"sampling-method-select",value:Qe.samplingMethod??"",onChange:dt=>{it(xt=>({...xt,samplingMethod:dt.target.value}))},label:He("generation:sampling-method.label"),children:[jsxRuntimeExports.jsx(MenuItem$1,{value:"",children:jsxRuntimeExports.jsx("em",{children:He("common:none")})}),lt.map(dt=>jsxRuntimeExports.jsx(MenuItem$1,{value:dt,children:dt},dt))]})]}),jsxRuntimeExports.jsxs(FormControl,{children:[jsxRuntimeExports.jsx("label",{htmlFor:"cfg-scale-input",className:"text-sm text-stone-500",children:He("generation:cfg-scale.label")}),jsxRuntimeExports.jsxs("div",{className:"inline-flex gap-4",children:[jsxRuntimeExports.jsx(Slider,{id:"cfg-scale-input",value:Qe.cfgScale??1,onChange:(dt,xt)=>{typeof xt=="number"&&it(ft=>({...ft,cfgScale:xt}))},min:1.1,max:50,step:.1,valueLabelDisplay:"auto"}),jsxRuntimeExports.jsx(Input,{type:"number",className:"w-[60px]",value:Qe.cfgScale??1,onChange:dt=>{const xt=Number(dt.target.value);it(ft=>({...ft,cfgScale:clamp$1(xt,1,50)}))},inputProps:{min:1,max:50,step:.5}})]})]}),jsxRuntimeExports.jsxs(FormControl,{children:[jsxRuntimeExports.jsx(InputLabel,{htmlFor:"seed-input",children:He("generation:seed.label")}),jsxRuntimeExports.jsx(OutlinedInput,{id:"seed-input",type:"number",className:"max-w-[500px]",label:He("generation:seed.label"),placeholder:He("generation:seed.placeholder"),value:Qe.seed,onChange:dt=>{it(xt=>({...xt,seed:dt.target.value}))}})]})]})}function BaseMediaSelectBtn(){const{t:He}=useTranslation(["generation"]),[Qe,it]=reactExports.useState(),[{baseImage:lt},ut]=reactExports.useContext(EditFormStateContext),dt=useObjectUrl(lt);reactExports.useEffect(()=>{lt?.getDimensions().then(it).catch(ft=>console.warn(ft))},[lt]);const xt=()=>{ut(ft=>({...ft,baseImage:void 0}))};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h2",{className:"text-sm text-stone-500",children:He("generation:base-image.label")}),jsxRuntimeExports.jsx("div",{className:"w-[200px] h-[200px] rounded-xl border border-neutral-300",children:dt?jsxRuntimeExports.jsxs("div",{className:"flex relative w-full h-full",style:{aspectRatio:getAspectRatio(Qe)},children:[jsxRuntimeExports.jsx(SingleImageViewer,{originalUrl:dt,fileName:lt.name,imgClassName:"flex object-contain w-full h-full rounded-xl !object-center",width:Qe?.width,height:Qe?.height}),jsxRuntimeExports.jsx(IconButton,{onClick:xt,className:"rounded-full bg-white shadow-sm absolute top-0 right-0 translate-x-3 -translate-y-3",children:jsxRuntimeExports.jsx(icBaselineClose,{className:"size-[14px]"})})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{component:"label",className:cx("font-semibold flex gap-1 border w-full h-full"),htmlFor:"note-image-upload",children:jsxRuntimeExports.jsx(icBaselineFileUpload,{className:"size-6"})}),jsxRuntimeExports.jsx("input",{id:"note-image-upload",type:"file",accept:"image/*",hidden:!0,onClick:ft=>{ft.currentTarget.value=""},onChange:ft=>{const[vt]=ft.target.files||[];vt&&ut(kt=>({...kt,baseImage:UnFile.fromFile(vt)}))}})]})})]})}const[EditFormStateContext,EditFormStateContextProvider]=createCtx({width:512,height:512});EditFormStateContext.displayName="EditFormStateContext";const[UpsertNoteDialogContext,UpsertNoteDialogContextProvider]=createCtx({open:!1});UpsertNoteDialogContext.displayName="UpsertNoteDialogContext";const[ListDialogContext,OpenListDialogContextProvider]=createCtx({open:!1}),INPAINT_MODELS={"komiyama/inpaint-y10:rev0":"Hikari","komiyama/inpaint-wf:rev0":"Waterfront"},flowbiteFileCopyAltSolid=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsxs("g",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",children:[jsxRuntimeExports.jsx("path",{d:"M7 9v6a4 4 0 0 0 4 4h4a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1z"}),jsxRuntimeExports.jsx("path",{d:"M13 3.054V7H9.2a2 2 0 0 1 .281-.432l2.46-2.87A2 2 0 0 1 13 3.054M15 3v4a2 2 0 0 1-2 2H9v6a2 2 0 0 0 2 2h7a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"})]})});function StyleSeedContentDisplay(He){const Qe=getStyleMixSeed({padStart:!0,seed:He.seed}),it=getStyleMixSeed({withPrefix:!0,seed:He.seed});return jsxRuntimeExports.jsxs("p",{className:"flex gap-1 items-center bg-neutral-100 dark:bg-neutral-800 rounded-md px-3 py-[3px] w-fit text-sm",children:[it,jsxRuntimeExports.jsx("button",{onClick:()=>{copy(Qe)},children:jsxRuntimeExports.jsx(flowbiteFileCopyAltSolid,{className:"text-neutral-600 dark:text-neutral-400"})})]})}function StyleSeedLabel(){const{t:He}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs("p",{className:"flex items-center gap-1",children:[He("generation:style-mix.style-seed"),jsxRuntimeExports.jsx("span",{className:"font-medium bg-[#E5D3F5] text-black text-xs scale-90 origin-left rounded-full px-2 py-px",children:"PixAI"})]})}function I2vTaskFrameEntry(He){return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-1 w-28 justify-between",children:[jsxRuntimeExports.jsx("p",{className:"break-words",children:He.label}),jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:He.mediaId,thumbnail:!0,className:"rounded"})]})}function I2vTaskFrames(He){const{t:Qe}=useTranslation(["generation"]);return jsxRuntimeExports.jsxs("div",{className:cx("flex gap-2",He.className),children:[He.mediaId?jsxRuntimeExports.jsx(I2vTaskFrameEntry,{mediaId:He.mediaId,label:Qe("generation:image-to-video.parameters.start-frame.label")}):null,He.tailMediaId?jsxRuntimeExports.jsx(I2vTaskFrameEntry,{mediaId:He.tailMediaId,label:Qe("generation:image-to-video.parameters.end-frame.label")}):null]})}pagedQueryHook(modifyQueryHook(createQueryHook(ListWorkflowArtworksForMeDocument),{transform:He=>He.authorId?He:skipToken,reduce:He=>He?.artworks}));const useInfinityListWorkflows=infiniteQueryHook(createQueryHook(ListWorkflowsDocument)),useGetWorkflow=modifyQueryHook(createQueryHook(GetWorkflowDocument),{transform:He=>typeof He=="string"?{id:He}:He,reduce:He=>He?.workflow}),fetchGetWorkflow=createFetchQueryHelper(GetWorkflowDocument),[useUpsertWorkflow,executeUpsertWorkflow]=createMutationHelper(UpsertWorkflowDocument,{update:(He,Qe)=>{const it=Qe.data?.upsertWorkflow;it&&He.updateQuery({query:GetWorkflowDocument,variables:{id:it.id}},()=>({workflow:it}))}}),[useDeleteWorkflow,executeDeleteWorkflow]=createMutationHelper(DeleteWorkflowDocument,{update:(He,Qe,{variables:it})=>{He.evict({id:He.identify({__typename:"Workflow",id:it?.id})})}});modifyQueryHook(createQueryHook(GetWorkflowForMarketDocument),{transform:He=>({id:He}),reduce:He=>He?.artwork});const useGetWorkflowForMarketByWorkflowId=modifyQueryHook(createQueryHook(GetWorkflowForMarketByWorkflowIdDocument),{transform:He=>({workflowId:He}),reduce:He=>He?.workflow?.artwork});modifyQueryHook(createQueryHook(GetWorkflowForRunnerDocument),{transform:He=>({workflowId:He}),reduce:He=>He?.workflow});const useListWorkflowVersions=modifyQueryHook(createQueryHook(ListWorkflowVersionsDocument),{reduce:He=>He?.workflow?.versions}),useInfiniteListWorkflowVersions=infiniteQueryHook(useListWorkflowVersions),usePagedListWorkflowVersions=pagedQueryHook(useListWorkflowVersions),[useUpsertWorkflowVersion,executeUpsertWorkflowVersion]=createMutationHelper(UpsertWorkflowVersionDocument);function createWorkflowUrl(He,Qe){const lt=`/workflow/${$$3(He).with(N$4.string,ut=>ut).with({id:N$4.select(N$4.string)},ut=>ut).exhaustive()}`;return Qe?joinURL(window.location.origin,lt):lt}function createWorkflowEditorUrl(He,Qe,it){const lt=(typeof Qe=="boolean"?void 0:Qe)??{},ut=typeof Qe=="boolean"?Qe:it,dt=joinURL("/generator/workflow",He??"");return withQuery((ut?window.origin:"")+dt,lt)}const fluentEyeHide20Filled=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsxs("g",{fill:"none",children:[jsxRuntimeExports.jsx("path",{d:"M2.854 2.146a.5.5 0 1 0-.708.708l3.5 3.498a8.097 8.097 0 0 0-3.366 5.046a.5.5 0 1 0 .979.204a7.09 7.09 0 0 1 3.108-4.528L7.95 8.656a3.5 3.5 0 1 0 4.884 4.884l4.313 4.314a.5.5 0 0 0 .708-.708l-15-15z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M10.124 8.003l3.363 3.363a3.5 3.5 0 0 0-3.363-3.363z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M7.531 5.41l.803.803A6.632 6.632 0 0 1 10 6c3.206 0 6.057 2.327 6.74 5.602a.5.5 0 1 0 .98-.204C16.943 7.673 13.693 5 10 5c-.855 0-1.687.143-2.469.41z",fill:"currentColor"})]})}),icOutlineSave=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3s3-1.34 3-3s-1.34-3-3-3zM6 6h9v4H6z"})}),materialSymbolsContentCopyOutline=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M9 18q-.825 0-1.413-.588T7 16V4q0-.825.588-1.413T9 2h9q.825 0 1.413.588T20 4v12q0 .825-.588 1.413T18 18H9Zm0-2h9V4H9v12Zm-4 6q-.825 0-1.413-.588T3 20V6h2v14h11v2H5Zm4-6V4v12Z"})}),lorem="Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",ArtworkPrompts$1=({prompts:He,segmentedPrompts:Qe})=>{const{t:it}=useTranslation(["common"]),lt=normalizeString(He||"");return He?jsxRuntimeExports.jsx("h2",{className:"text-sm font-normal leading-6 opacity-80 break-all",children:Qe?Qe?.map((ut,dt)=>jsxRuntimeExports.jsxs("span",{children:[ut.prefix,ut.content&&(ut.tagName?jsxRuntimeExports.jsx(Link,{to:createTagPageUrl("artwork",ut.tagName),children:ut.content}):ut.content),ut.suffix]},dt)):lt}):jsxRuntimeExports.jsxs("div",{className:"italic opacity-75",children:["(",it("common:not-set"),")"]})},ArtworkPromptsWithHidden$1=({prompts:He,segmentedPrompts:Qe,shouldHide:it})=>{const{t:lt}=useTranslation(["artwork"]);return jsxRuntimeExports.jsx("div",{className:cx("text-sm relative font-medium rounded-lg h-auto max-h-[9rem] py-2 px-3 border border-solid border-gray-100 overflow-auto leading-5 mt-4"),children:it?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"blur line-clamp-2 select-none",children:lorem}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center font-medium select-none",children:lt("artwork:hidden-by-author")})]}):jsxRuntimeExports.jsx(ArtworkPrompts$1,{prompts:He,segmentedPrompts:Qe})})},icBaselineZoomOutMap=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"m15 3l2.3 2.3l-2.89 2.87l1.42 1.42L18.7 6.7L21 9V3h-6zM3 9l2.3-2.3l2.87 2.89l1.42-1.42L6.7 5.3L9 3H3v6zm6 12l-2.3-2.3l2.89-2.87l-1.42-1.42L5.3 17.3L3 15v6h6zm12-6l-2.3 2.3l-2.87-2.89l-1.42 1.42l2.89 2.87L15 21h6v-6z"})}),icOutlineTagFaces=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8s8 3.58 8 8s-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8S14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8S7 8.67 7 9.5S7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"})}),mdiFormTextbox=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17 7h5v10h-5v2a1 1 0 0 0 1 1h2v2h-2.5c-.55 0-1.5-.45-1.5-1c0 .55-.95 1-1.5 1H12v-2h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-2V2h2.5c.55 0 1.5.45 1.5 1c0-.55.95-1 1.5-1H20v2h-2a1 1 0 0 0-1 1v2M2 7h11v2H4v6h9v2H2V7m18 8V9h-3v6h3Z"})}),radixIconsFace=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 15 15",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M7.5.877a6.623 6.623 0 1 0 0 13.246A6.623 6.623 0 0 0 7.5.877M1.827 7.5a5.673 5.673 0 1 1 11.346 0a5.673 5.673 0 0 1-11.346 0m3.21 1.714a.5.5 0 1 0-.82.572A4 4 0 0 0 7.5 11.5c1.36 0 2.56-.679 3.283-1.714a.5.5 0 0 0-.82-.572A3 3 0 0 1 7.5 10.5a3 3 0 0 1-2.463-1.286m.338-2.364a.875.875 0 1 0 0-1.75a.875.875 0 0 0 0 1.75m5.125-.875a.875.875 0 1 1-1.75 0a.875.875 0 0 1 1.75 0",clipRule:"evenodd"})}),radixIconsHand=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 15 15",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M6.811 1.647c-.19 1.232-.128 2.238-.043 3.658l.049.823a.5.5 0 0 1-.992.115l-.077-.436c-.104-.642-.264-1.552-.57-2.36c-.316-.834-.73-1.406-1.244-1.587a.61.61 0 0 0-.675.15a.82.82 0 0 0-.196.744c.152.59.383 1.163.635 1.764l.068.162c.23.545.47 1.117.65 1.71v.002c.146.484.24.867.315 1.17l.08.322A.5.5 0 0 1 4 8.387a10 10 0 0 1-.68-.669l-.122-.13c-.15-.16-.28-.3-.414-.428c-.323-.309-.599-.48-.977-.516h-.003c-.242-.025-.389.02-.485.082c-.099.063-.198.178-.28.386c-.061.173-.023.518.155.857l.004.008c.204.408.548.839.984 1.316q.326.352.688.724l.01.011c.236.244.48.497.718.755c.832.903 1.68 1.97 1.866 3.217h6.046c.055-1.565.367-2.732.778-3.865c.158-.435.325-.85.496-1.277c.327-.817.668-1.669.988-2.75c.328-1.11.239-1.738.09-2.068c-.144-.321-.37-.422-.48-.444c-.243-.048-.343.013-.411.083c-.103.104-.2.304-.278.624a9 9 0 0 0-.159 1.022l-.003.028c-.038.32-.08.677-.163.948a.54.54 0 0 1-.17.274a.5.5 0 0 1-.366.118c-.289-.024-.46-.272-.466-.545c-.009-.393.023-.79.042-1.182c.036-.73.07-1.432.018-2.132V2.83c-.033-.499-.376-.827-.724-.906a.64.64 0 0 0-.466.06c-.132.076-.28.23-.378.53v.004c-.042.123-.084.36-.12.695a21 21 0 0 0-.085 1.082c-.02.326-.034.664-.048.968c-.017.383-.031.712-.048.891a.5.5 0 0 1-.061.205a.48.48 0 0 1-.424.26a.51.51 0 0 1-.454-.259c-.06-.11-.066-.24-.07-.366l-.005-.445c-.003-.342-.003-.729-.003-.838c0-1.044 0-2.056-.092-3.066c-.055-.403-.384-.64-.803-.644s-.765.227-.833.647m2.601-.285C9.215.448 8.4.008 7.654 0c-.79-.008-1.666.466-1.83 1.49v.003q-.062.397-.093.774c-.337-.593-.805-1.118-1.465-1.35a1.61 1.61 0 0 0-1.73.403a1.82 1.82 0 0 0-.446 1.667l.003.01c.172.671.431 1.306.683 1.908l.066.156c.18.427.352.838.497 1.252c-.375-.332-.82-.605-1.436-.665c-.414-.041-.8.027-1.125.236c-.324.208-.537.52-.674.87l-.003.009c-.203.55-.035 1.209.204 1.666c.269.536.691 1.05 1.139 1.54c.226.247.467.496.706.743l.007.007q.359.37.704.74C3.81 12.49 4.5 13.464 4.5 14.5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5c0-1.679.302-2.854.727-4.024c.138-.38.295-.77.46-1.184c.337-.843.711-1.779 1.043-2.9c.366-1.239.326-2.133.043-2.762c-.286-.638-.793-.935-1.197-1.015c-.448-.089-.84-.01-1.15.216l-.004-.07c-.063-.95-.731-1.638-1.499-1.813a1.64 1.64 0 0 0-1.188.17a1.6 1.6 0 0 0-.323.244",clipRule:"evenodd"})});function taskAbilityParser$1(He,Qe){if(!He)return{};const it=He.type==="workflow",lt=He.type==="i2vPro";let ut=!1;if(He&&"sceneId"in He&&(ut=He.sceneId==="anime-figure"),lt)return{i2vpro:!0};if(it){const dt=Qe?.enhancementPlugins?.handfix&&He.workflowName.startsWith(Qe.enhancementPlugins.handfix.workflowName+":"),xt=Qe?.enhancementPlugins?.["face-detailer"]&&He.workflowName.startsWith(Qe.enhancementPlugins["face-detailer"].workflowName+":"),ft=Object.keys(INPAINT_MODELS).some(vt=>He.workflowName===vt);return{handfix:dt,inpaint:ft,"face-detailer":xt,"anime-figure":ut}}else{const dt=He.enableADetailer??!1,xt=(He.upscale??1)>1,ft=(He.enlarge??1)>1,vt=!!He.magicPrompts;return{facefix:dt,hires:xt,upscale:ft,handfix:!1,"face-detailer":!1,"prompt-helper":vt,"anime-figure":ut}}}const IconMap$1={"face-detailer":radixIconsFace,handfix:radixIconsHand,upscale:icBaselineZoomOutMap,hires:SvgHires,facefix:icOutlineTagFaces,i2vpro:riVideoAiLine,inpaint:icBaselineEdit,"prompt-helper":mdiFormTextbox,"anime-figure":icOutlineTagFaces};function ArtworkTaskCapabilityItems$1(He){const{data:Qe}=useEnhancementPlugins(),it=taskAbilityParser$1(He.parsedParams,{enhancementPlugins:Qe}),lt=Object.entries(it).filter(([ut,dt])=>dt).map(([ut])=>{const dt=IconMap$1[ut];return jsxRuntimeExports.jsx(TaskAbility$1,{icon:jsxRuntimeExports.jsx(dt,{className:"size-4"}),highlight:ut==="i2vpro",navigateTo:$$3(ut).with("i2vpro",()=>"/generator/image/animation").with("inpaint",()=>"/generator/image/editor").with("anime-figure",()=>"/generator/preset/anime-figure").otherwise(()=>{}),label:jsxRuntimeExports.jsx(Text,{i18nKey:`artwork:parameter.task-capabilities.${ut}.label`,children:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:parameter.task-capabilities.unknown.label"})})},ut)});return lt.length<1?null:jsxRuntimeExports.jsx("section",{className:"flex flex-wrap items-center gap-2",children:lt})}function TaskAbility$1(He){const Qe=jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[He.icon,jsxRuntimeExports.jsx("span",{className:"text-sm",children:He.label})]}),it=cx("flex rounded-lg border  gap-1 items-center px-2 py-1",He.highlight?"border-purple-200 dark:bg-purple-500 bg-purple-500 text-white":"border-neutral-500 bg-neutral-100 dark:bg-neutral-800");return He.navigateTo?jsxRuntimeExports.jsx(Link,{to:He.navigateTo,className:it,children:Qe}):jsxRuntimeExports.jsx("div",{className:it,children:Qe})}function parseDisplayableParametersFromTask$1(He,Qe){if(!He)return;const it=isI2vProTask(He),lt=isT2I2VTask(He),ut=isWorkflowTask(He);if(it){const{output:dt,success:xt,issues:ft}=safeParse(TaskParametersI2vProSchema,He.parameters);if(xt)return{type:"i2vPro",...dt.i2vPro,sceneId:dt.sceneId??Qe?.task?.parameters?.sceneId,authorId:Qe?.authorId,hidePrompts:Qe?.hidePrompts,segmentedPrompts:Qe?.segmentedPrompts}}else if(lt){const{success:dt,output:xt,issues:ft}=safeParse(TaskParametersT2i2vSchema,He.parameters);if(dt)return{type:"t2i2v",...xt,model:xt.t2i2v.model,prompts:Qe?.prompts??xt.prompts??void 0,segmentedPrompts:Qe?.segmentedPrompts,hidePrompts:Qe?.hidePrompts,magicPrompts:Qe?.extra?.naturalPrompts,authorId:Qe?.authorId}}else if(ut){const{output:dt,success:xt,issues:ft}=safeParse(TaskParametersWorkflowSchema,He.parameters);if(xt)return{type:"workflow",...dt.inputs,workflowName:dt.workflowName,isPrivate:Qe?.isPrivate,workflowId:Qe?.extra.workflowId,authorId:Qe?.authorId}}else{const{success:dt,output:xt,issues:ft}=safeParse(TaskParametersGeneratorSchema,He.parameters);if(dt)return{type:"generator",...xt,sceneId:xt.sceneId??Qe?.task?.parameters?.sceneId,prompts:Qe?.prompts??xt.prompts??void 0,segmentedPrompts:Qe?.segmentedPrompts,hidePrompts:Qe?.hidePrompts,magicPrompts:getNaturalPrompts(Qe,He),authorId:Qe?.authorId}}}const TabChoices$1={prompts:"prompts"};function ArtworkParameterInfo$1(He){const{artwork:Qe,taskParameters:it}=He,lt=parseDisplayableParametersFromTask$1(it,Qe);return lt?.type==="workflow"?jsxRuntimeExports.jsx(ArtworkParametersForWorkflow$1,{parsedParams:lt}):lt?.type?jsxRuntimeExports.jsx(ArtworkParameterInfoGenerator$1,{parsedParams:lt,artwork:Qe,taskParameters:it}):null}function ArtworkParameterInfoGenerator$1(He){const{t:Qe}=useTranslation(["artwork","generation","action"]),{parsedParams:it}=He,{data:lt}=useUserInfo(),ut=lt?.id===it?.authorId,[dt,xt]=reactExports.useState(!1),vt=it?.type==="generator",kt=reactExports.useMemo(()=>{if(it?.type==="i2vPro")return!0;if(it?.hidePrompts)return!1;const $t=pickBy(omit(it,["prompts"]));return Object.keys($t).length>0},[it]),St=[[TabChoices$1.prompts,Qe("artwork:detail.tab.prompts")]],[Tt,Mt]=reactExports.useState(St[0][0]),Nt=reactExports.useMemo(()=>(!it?.hidePrompts||ut)&&!!it?.prompts,[ut,it?.hidePrompts,it?.prompts]),At=jsxRuntimeExports.jsx(ArtworkPromptsWithHidden$1,{prompts:it?.prompts,segmentedPrompts:it?.segmentedPrompts,shouldHide:it?.hidePrompts&&!ut});return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Tabs,{selectionFollowsFocus:!0,className:"border-b flex",value:Tt,onChange:($t,Dt)=>{Mt(Dt)},classes:{root:"min-h-0"},children:St.map(([$t,Dt])=>jsxRuntimeExports.jsx(Tab,{className:"normal-case",classes:{root:"font-medium py-1 min-h-[2rem] rounded-t-lg"},label:Dt,value:$t,onClick:()=>{track("image_prompts_click",{value:$t})}},$t))}),jsxRuntimeExports.jsxs("div",{className:cx("flex","absolute top-0 right-0"),children:[vt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{className:"capitalize",onClick:()=>{track("save_image_as_note_click"),lt?xt(!0):openSignModal(void 0,{fromPath:"notes-save"})},children:jsxRuntimeExports.jsxs("div",{className:"flex flex-row items-center gap-1 text-sm",children:[jsxRuntimeExports.jsx(icOutlineSave,{className:"text-sm"}),Qe("action:save")]})}),jsxRuntimeExports.jsx(UpsertNoteDialog,{open:dt,onClose:()=>xt(!1),openFrom:"image",prefilledData:{...getArtworkParameters(He.artwork,He.taskParameters),title:He.artwork.title,baseImage:He.artwork.media?UnFile.fromMedia(He.artwork.media):void 0}})]}),jsxRuntimeExports.jsx(Button,{className:cx("capitalize",Nt&&Tt===TabChoices$1.prompts?"block":"hidden"),onClick:()=>{Tt===TabChoices$1.prompts?copy(it?.prompts??"",{enableTrackValue:!0}):copy(it?.negativePrompts??"",{enableTrackValue:!0}),lt||openSignModal()},children:jsxRuntimeExports.jsxs("div",{className:"flex flex-row items-center gap-1 text-sm",children:[jsxRuntimeExports.jsx(materialSymbolsContentCopyOutline,{className:"text-sm"}),Qe("common:copy")]})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[At,kt&&jsxRuntimeExports.jsx(ArtworkParameter$1,{parsedParams:it}),jsxRuntimeExports.jsx(ArtworkTaskCapabilityItems$1,{parsedParams:it}),it?.type==="i2vPro"?jsxRuntimeExports.jsx(I2vTaskFrames,{mediaId:it.mediaId,tailMediaId:it.tailMediaId,className:"text-sm font-semibold"}):null]})]})}const ArtworkParameterItem$1=({title:He,value:Qe})=>Qe?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("dt",{className:"font-semibold text-sm leading-6",children:He}),jsxRuntimeExports.jsx("dd",{className:"text-sm text-primary/60 break-words leading-6 max-h-[9rem] overflow-auto",children:Qe})]}):null;function ArtworkParameter$1(He){const{t:Qe}=useTranslation(["common","artwork","generation"]),{parsedParams:it}=He,lt=it?.type;lt==="generator"&&it?.modelId;const[ut,dt]=useUncontrolled({defaultValue:lt==="i2vPro"});if(!it?.type)return null;const xt=(()=>{if(lt!=="generator")return[];const vt=it.styleMix?.enabled&&Number(it.styleMix.seed)?it.styleMix.seed:void 0,kt=it.qualityTag?formatQualityTag(it.qualityTag):void 0,St=it.magicPrompts,Tt=it.width&&it.height?`${it.width} x ${it.height}`:Qe("common:unknown");return[{key:"magic-prompts",label:Qe("generation:original-prompts.label"),value:St},{key:"style-mix",label:jsxRuntimeExports.jsx(StyleSeedLabel,{}),value:vt},{key:"quality-tag",label:Qe("generation:quality-tag.label"),value:kt},{key:"size",label:Qe("generation:size.label"),value:Tt},{key:"sampling-steps",label:Qe("generation:sampling-steps.label"),value:it.samplingSteps},{key:"sampling-methods",label:Qe("generation:sampling-method.label"),value:it.samplingMethod},{key:"cfgscale",label:Qe("generation:cfg-scale.label"),value:it.cfgScale},{key:"seed",label:Qe("generation:seed.label"),value:it.seed},{key:"negative",label:Qe("generation:negative-prompts.label"),value:it.negativePrompts}]})(),ft=(()=>{if(lt!=="i2vPro")return[];const vt=Qe([`generation:image-to-video.parameters.model.${getI18nKeyForI2vModelName(it.model)}.label`,"common:unknown"]);return[{key:"model",label:Qe("generation:image-to-video.parameters.model.label"),value:vt},{key:"mode",label:Qe("generation:image-to-video.parameters.mode.label"),value:it.mode},{key:"duration",label:Qe("generation:image-to-video.parameters.duration.label"),value:it.duration},{key:"camera",label:Qe("generation:image-to-video.parameters.camera.label"),value:it.cameraMovement}]})();return jsxRuntimeExports.jsxs("details",{open:ut,onToggle:vt=>{const St=vt.nativeEvent.newState==="open";dt(St),track("show_parameters_click",{type:St?"unfold":"fold"})},children:[jsxRuntimeExports.jsx("summary",{className:"bg-neutral-100 dark:bg-stone-700 rounded-full px-2 py-1 w-fit text-sm select-none cursor-pointer",children:Qe("artwork:parameter.show-parameters")}),jsxRuntimeExports.jsxs("dl",{className:"grid grid-cols-[fit-content(200px),minmax(0,1fr)] gap-x-4 ml-6 mt-1",children:[xt.map(vt=>jsxRuntimeExports.jsx(ArtworkParameterItem$1,{title:vt.label,value:vt.value},vt.key)),ft.map(vt=>jsxRuntimeExports.jsx(ArtworkParameterItem$1,{title:vt.label,value:vt.value},vt.key))]})]})}function ArtworkParametersForWorkflow$1(He){const{beingAdmin:Qe}=useMe(),{workflowId:it,workflowName:lt}=He.parsedParams,ut=Object.keys(INPAINT_MODELS).includes(lt),{data:dt,loading:xt}=useGetWorkflowForMarketByWorkflowId(ut?skipToken:it),ft=!xt&&!dt||!!dt?.isPrivate,vt=!xt&&(!ft||Qe),[{liked:kt,count:St,optimistic:Tt},Mt]=useLike(dt?.id,RefType.Artwork,dt);return it?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium mt-3",children:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:workflow.workflow-used"})}),jsxRuntimeExports.jsxs("div",{className:cx("grid grid-cols-[auto_1fr_auto] items-center gap-2 p-1 -m-1 has-[button:hover]:!bg-transparent rounded-xl text-sm",vt&&"hover:bg-black/5 dark:hover:bg-white/5"),children:[jsxRuntimeExports.jsxs(Link,{to:vt?createWorkflowUrl(dt?.id??"#"):"#",className:cx("col-span-2 grid grid-cols-subgrid items-center no-underline",!vt&&"cursor-default"),children:[jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:dt?.mediaId,className:cx("row-start-1 col-start-1 flex-none h-16 aspect-[1200/630] rounded-lg",xt&&"animate-pulse")}),ft&&!Qe&&jsxRuntimeExports.jsx(fluentEyeHide20Filled,{className:"row-start-1 col-start-1 place-self-center relative size-5"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{children:xt?jsxRuntimeExports.jsx(TextSkeleton$1,{className:"w-20"}):Qe?jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[ft&&jsxRuntimeExports.jsx(fluentEyeHide20Filled,{className:"size-5 text-amber-600 dark:text-amber-500"}),dt?.title]}):jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:workflow.messages.workflow-is-hidden"})}),jsxRuntimeExports.jsxs("p",{className:cx("flex items-center gap-1",ft&&!Qe&&"hidden"),children:[jsxRuntimeExports.jsx(UserAvatar,{user:dt?.author,className:"!size-6"}),getUserDisplayName(dt?.author)]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsxs("button",{className:cx("inline-flex items-center gap-1 p-1 -m-1 ml-0 pr-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-md",Tt&&"opacity-50",xt&&"invisible",ft&&!Qe&&"hidden"),onClick:Nt=>{Nt.stopPropagation(),Mt()},children:[jsxRuntimeExports.jsx(LikeHeart,{liked:kt??!1,className:"size-5"}),jsxRuntimeExports.jsx("span",{children:St})]}),jsxRuntimeExports.jsx("div",{className:"h-6"})]})]}),jsxRuntimeExports.jsx(ArtworkTaskCapabilityItems$1,{parsedParams:He.parsedParams})]}):null}function TextSkeleton$1(He){return jsxRuntimeExports.jsx("span",{...He,className:cx("inline-flex items-center prepend-zws",He.className),children:jsxRuntimeExports.jsx("span",{className:"flex-1 h-[1em] bg-zinc-300 rounded animate-pulse"})})}const filterTaskParameter$1=async He=>{const Qe=new Map(await Promise.all(Object.keys(He?.parameters?.lora??{}).map(async it=>[it,await client.getGenerationModelByVersionId({id:it})])));return produce(He,it=>{if(it?.parameters?.lora){const lt=it?.parameters?.lora;for(const ut of Object.keys(lt))Qe.get(ut)?.generationModelVersion==null&&delete lt[ut]}if(it?.parameters?.loraParameters){const lt=it?.parameters?.loraParameters;it.parameters.loraParameters=lt.filter(({versionId:ut})=>{Qe.get(ut)?.generationModelVersion!=null})}if(it?.outputs?.detailParameters?.lora){const lt=it?.outputs?.detailParameters?.lora;for(const ut of Object.keys(lt))Qe.get(ut)?.generationModelVersion==null&&delete lt[ut]}})};function ArtworkDeriveButtons(He){const{artwork:Qe,taskParameters:it,isSinglePage:lt,className:ut}=He,{t:dt}=useTranslation(["artwork"]),{onUseAsReferenceAction:xt}=useArtworkDetailContext(),ft=useIsMobile(),{data:vt}=useUserInfo(),kt=useNavigate(),[St]=reactExports.useState(Qe),Tt=async()=>{const Nt=St;trackArtwork("use_as_refer_btn_click",Nt);const At=await filterTaskParameter$1(it),$t=`/generator/image?${formatQs({importType:"use_as_reference",artwork:encodeArtworkForImport(Nt),task:encodeTaskForImport(At)})}`;if(!vt){openSignModal({oauthRedirectUrl:joinURL(location.origin,$t)},{fromPath:"refer"});return}if(it?.parameters?.sceneId==="anime-figure"){window.open("/generator/preset/anime-figure");return}try{if(!await UIDialog.confirm({dismissable:!0,heading:dt("artwork:use-as-reference-confirm.title"),content:dt("artwork:use-as-reference-confirm.desc")}))return;if(trackArtwork("use_as_refer",Nt),executeMarkArtwork({artworkId:Nt.id,type:MarkType.Inspire,target:!0}),xt)return xt({taskParameters:it,artwork:Nt});startEventGroup("generate_source"),kt($t)}catch(Bt){toast.error(Bt?.message)}},Mt=reactExports.useCallback(()=>{if(trackArtwork("animate_this_artwork_click",Qe,{mode:"i2vpro"}),!vt){openSignModal(lt?void 0:{oauthRedirectUrl:getOpenArtworkDetailQuery(Qe.id)});return}openImageToVideoSubmissionDialog({mediaId:Qe.mediaId,afterSubmission:Nt=>{kt(withQuery("/generator/image/animation",{task:encodeTaskForImport(Nt)}))},type:ft?"drawer":"dialog"})},[Qe,vt?.id,lt,ft]);return jsxRuntimeExports.jsxs("div",{className:cx("flex flex-row gap-2",ut,it?"block":"hidden"),children:[!isGeneratedByWorkflow(Qe)&&!isI2vProTask(it)&&jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",color:"theme",className:"rounded-full px-6 h-11 text-sm font-semibold text-white flex-1",onPress:Tt,busy:"auto",children:dt("artwork:use-as-reference.label")}),!isVideoTask(it)&&jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",color:"theme",className:"rounded-full px-6 h-11 text-sm font-semibold flex-1",onPress:Mt,children:dt("artwork:animate-this-artwork.label")})]})}const ArtworkDetailContent$1=({artwork:He,taskParameters:Qe,className:it,isSinglePage:lt})=>{const{t:ut}=useTranslation(["artwork","user","common","action"]),dt=useWorldCharacterExperiment();useNavigate(),reactExports.useState(He);const xt=useNarrowScreenForArtworkDetail(lt),ft=isI2vProTask(Qe)?void 0:Qe?.parameters.modelId;return jsxRuntimeExports.jsxs("div",{className:cx("flex-1 flex-shrink min-w-0 flex flex-col gap-5",it),children:[xt?null:jsxRuntimeExports.jsx(ArtworkDeriveButtons,{artwork:He,taskParameters:Qe,isSinglePage:lt}),jsxRuntimeExports.jsx(ArtworkParameterInfo$1,{artwork:He,taskParameters:Qe}),dt&&He.extra?.characterId&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium mt-3",children:ut("artwork:character.character-used")}),jsxRuntimeExports.jsx(ArtworkDetailContentCharacter$1,{characterId:He.extra?.characterId})]}),(He.loras?.length||ft)&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium mt-3",children:ut("artwork:model.model-lora-used")}),jsxRuntimeExports.jsx(ArtworkDetailContentModels$1,{loras:He.loras,modelId:ft})]}),jsxRuntimeExports.jsx(ArtworkDetailMembershipAdUnit,{imgClassName:"object-contain rounded-2xl",className:"rounded-2xl border hover:shadow-xl transition ease-out hover:border-neutral-400 dark:border-none"})]})};function ArtworkDetailImage$1(He){const{artwork:Qe}=He,it=getImageDownloadFileExt({artwork:Qe,media:Qe.media})==="mp4"?"video":"image";return jsxRuntimeExports.jsx("div",{className:styles$a["artwork-image-bg"],style:{aspectRatio:Qe.media?`${Qe.media.width} / ${Qe.media.height}`:void 0},children:jsxRuntimeExports.jsxs("div",{className:cx(styles$a["artwork-image-container"],it==="video"?styles$a.video:void 0),children:[jsxRuntimeExports.jsx(SingleMediaViewer,{scene:"artwork-detail",imgClassName:styles$a["artwork-image-element"],artworkId:Qe.id,originalUrl:getImagePublicUrl(Qe.mediaId),thumbnailUrl:getImageThumbnailUrl(Qe.mediaId),showFallbackThumbnail:!0,width:Qe.media?.width,height:Qe.media?.height,author:Qe.author,alt:getArtworkAlt(Qe),fileName:getImageDownloadFilename({artwork:Qe})+"."+getImageDownloadFileExt({artwork:Qe,media:Qe.media}),mediaType:it,skipDownloadConversion:isAnimatedArtwork(Qe),videoMediaId:Qe.videoMediaId,mediaId:Qe.mediaId,preferVideo:!0}),jsxRuntimeExports.jsx(CardCornerDebugInfo,{extra:Qe?.extra,paidCredit:Qe?.paidCredit,aesScore:Qe?.aesScore,children:lt=>jsxRuntimeExports.jsx("div",{className:"absolute top-2 left-2 bg-black/60 backdrop-blur rounded-xl px-2 py-1.5",children:lt})}),He.actions]})})}const ArtworkDetail$1=({artwork:He,isSinglePage:Qe,onUseAsReferenceAction:it,shouldExploreStyleTargetBlank:lt,onClose:ut,onLikeClickForRec:dt,trackingArgs:xt})=>{const{t:ft}=useTranslation(["artwork"]),{data:vt,refetch:kt}=useGetArtworkWithTaskDetail(He.id),{data:St}=useUserInfo(),{taskParameters:Tt,...Mt}=vt||He,Nt=St!=null&&St?.id===Mt?.author?.id,At=reactExports.useMemo(()=>({artwork:Mt,taskParameters:Tt,isSinglePage:Qe,onUseAsReferenceAction:it,shouldExploreStyleTargetBlank:lt,onClose:ut,onLikeClickForRec:dt,userIsAuthor:Nt,refetchArtwork:kt,trackingArgs:xt}),[Mt,Tt,Qe,it,lt,ut,dt,Nt,kt,xt]),$t=useNarrowScreenForArtworkDetail(Qe),Dt=jsxRuntimeExports.jsxs("div",{className:"absolute top-2 right-2 flex gap-x-2 gap-y-2 flex-wrap",onClick:Ft=>Ft.stopPropagation(),children:[!Qe&&jsxRuntimeExports.jsx(UILink,{href:getArtworkLink(Mt),target:"_blank",icon:jsxRuntimeExports.jsx(fluentOpen20Filled,{className:"size-5"}),className:cx("rounded-md flex items-center justify-center size-8 transition duration-100","text-white/50 bg-black/50 ","hover:text-white data-[pressed]:text-white hover:bg-black/80 data-[pressed]:bg-black/80")}),jsxRuntimeExports.jsx(ArtworkActionButton,{className:cx("ml-auto size-8 transition duration-100","text-white/50 bg-black/50 ","hover:text-white data-[pressed]:text-white hover:bg-black/80 data-[pressed]:bg-black/80"),artwork:Mt,taskParameters:Tt})]});return Mt?jsxRuntimeExports.jsxs(ArtworkDetailContext.Provider,{value:At,children:[jsxRuntimeExports.jsxs("main",{className:cx("bg-background w-full rounded-xl",styles$a["artwork-main-wrapper"],Qe&&styles$a["single-page"]),children:[jsxRuntimeExports.jsxs("div",{className:cx(styles$a["artwork-detail-content-container"]),children:[jsxRuntimeExports.jsx(ArtworkDetailImage$1,{artwork:Mt,actions:Dt}),jsxRuntimeExports.jsx(ArtworkDetailTitle,{artwork:Mt,isSinglePage:Qe,className:"py-4 min-w-0"}),jsxRuntimeExports.jsx(ArtworkDescriptionAndTags$1,{artwork:Mt}),$t?jsxRuntimeExports.jsx(ArtworkDeriveButtons,{artwork:Mt,taskParameters:Tt,isSinglePage:Qe,className:"mt-4"}):null]}),jsxRuntimeExports.jsxs("section",{className:"flex flex-col gap-2 [grid-area:description] p-4 bg-neutral-100 dark:bg-neutral-700 rounded-lg",children:[jsxRuntimeExports.jsx(ArtworkDetailAuthorInfo$1,{artwork:Mt}),jsxRuntimeExports.jsx(ArtworkDetailAuthorArtworks,{artwork:Mt,isSinglePage:Qe})]}),jsxRuntimeExports.jsx("section",{className:"[grid-area:comment] min-w-0",children:jsxRuntimeExports.jsx(ArtworkDetailCommentArea$1,{})}),jsxRuntimeExports.jsx(ArtworkDetailContent$1,{artwork:Mt,taskParameters:Tt,className:"[grid-area:detail]",isSinglePage:Qe})]}),Qe&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"px-5 pt-12 flex flex-col bg-background gap-10",children:[jsxRuntimeExports.jsx(ArtworkRelevantArtworksInline,{artworkId:Mt.id}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"font-medium text-xl mb-4",children:ft("artwork:recommended-users.title")}),jsxRuntimeExports.jsx(ArtworkRecommendedUsers,{})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"font-medium text-xl mb-4",children:ft("artwork:search-results.recommendation-section.heading")}),jsxRuntimeExports.jsx(ArtworkRecommendedArtworks,{trackingArgs:{scene:"artwork-relevant"}})]})]})})]}):null};function ArtworkDetailCommentArea$1(){const{artwork:He,userIsAuthor:Qe,isSinglePage:it}=reactExports.useContext(ArtworkDetailContext),[lt,ut]=reactExports.useState(!1);return He?jsxRuntimeExports.jsx("div",{className:cx("w-full bg-neutral-100 dark:bg-neutral-700 rounded-lg p-4",!it&&"rounded-bl-2xl"),children:jsxRuntimeExports.jsx(reactExports.Suspense,{children:jsxRuntimeExports.jsxs(CommentProvider,{topicId:He.id,refType:RefType.Artwork,initLoadSize:3,canDeleteMessage:()=>Qe,onLoadMore:()=>{ut(dt=>(dt||track("show_more_comments"),!0))},children:[jsxRuntimeExports.jsx("div",{className:"flex items-center pb-2",children:jsxRuntimeExports.jsxs("h3",{className:"font-medium text-base flex items-center",children:[jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:comment"}),(He.commentCount??0)>0&&jsxRuntimeExports.jsx("span",{className:"text-neutral-500 pl-2 text-xs",children:He.commentCount})]})}),jsxRuntimeExports.jsx(CommentComposer,{className:"mb-4 pb-4 border-b border-black/20 dark:border-white/20"}),jsxRuntimeExports.jsx(CommentList,{windowed:lt,loadMode:lt?"scroll":"button",style:{height:lt?440:void 0}})]})})}):null}const portrait="_portrait_hm1r7_8",styles={"artwork-detail-content-container":"_artwork-detail-content-container_hm1r7_1","artwork-image-bg":"_artwork-image-bg_hm1r7_6",portrait,"artwork-image-container":"_artwork-image-container_hm1r7_12","artwork-image-element":"_artwork-image-element_hm1r7_15","show-more-horizontal-gradient":"_show-more-horizontal-gradient_hm1r7_45","artwork-main-wrapper":"_artwork-main-wrapper_hm1r7_61","single-page":"_single-page_hm1r7_74"};function ArtworkDetailAuthorInfo(He){const{artwork:Qe,isSinglePage:it,className:lt}=He,{author:ut,id:dt,liked:xt,likedCount:ft}=Qe,{onClose:vt,onLikeClickForRec:kt,trackingArgs:St}=reactExports.useContext(ArtworkDetailContext),{data:Tt}=useUserInfo();return jsxRuntimeExports.jsxs("section",{className:cx("w-full flex flex-col gap-2",lt),children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("h1",{className:"font-bold text-2xl truncate",title:getArtworkTitle(Qe),children:getArtworkTitle(Qe)}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center",children:[jsxRuntimeExports.jsx(ArtworkDetailActions,{artwork:Qe,trackingArgs:{scene:"artwork-detail",modal:it?void 0:!0}}),jsxRuntimeExports.jsx(ArtworkLikeButton,{artworkId:dt,artwork:Qe,initialCount:ft,initialValue:xt,countStyle:{color:"inherit"},afterClick:kt,trackingArgs:{...St,scene:"artwork-detail"},oauthReturnOpensDetail:!it})]})]}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 items-center",children:ut&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"min-w-0",onClick:Mt=>{Mt.stopPropagation(),vt?.()},children:jsxRuntimeExports.jsx(UserLink,{size:32,user:ut,scene:"image"})}),Tt&&Tt.id!==ut.id?jsxRuntimeExports.jsx(UserFollowButton,{user:ut,userId:ut.id,followProps:{startIcon:null,variant:"outlined",className:"!rounded-full font-medium text-xs min-w-0 !px-2"},followingProps:{startIcon:null,className:"!rounded-full font-base text-xs min-w-0 !px-2",variant:"contained"},className:"shrink-0",scene:"artwork"}):null]})})]})}function ArtworkDescriptionAndTags(He){const{extra:Qe,tags:it}=He.artwork,lt=Qe?.description;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[lt&&jsxRuntimeExports.jsx(ArtworkDescription,{description:lt}),it&&it.length>0&&jsxRuntimeExports.jsx(ExpandableTagList,{type:"artwork",tags:it})]})}function ArtworkDescription(He){const{description:Qe}=He,it=reactExports.useRef(null),[lt,ut]=reactExports.useState(!1),[dt,xt]=reactExports.useState(!1),{t:ft}=useTranslation(["artwork"]);return reactExports.useEffect(()=>{Qe&&it.current&&xt(it.current.scrollHeight>it.current.clientHeight)},[Qe]),jsxRuntimeExports.jsxs("div",{className:"relative rounded-lg flex flex-col items-start gap-1 w-full",children:[jsxRuntimeExports.jsx("p",{ref:it,className:cx(lt?"table table-fixed break-words":"line-clamp-2 break-all","w-full","text-sm","text-left","whitespace-pre-line"),children:Qe}),dt&&!lt&&jsxRuntimeExports.jsx("button",{className:cx(styles["show-more-horizontal-gradient"],"grid grid-rows-[1fr_auto] grid-cols-[auto] justify-center absolute right-0 bottom-0"),onClick:()=>ut(vt=>!vt),children:jsxRuntimeExports.jsxs("span",{className:"row-span-full col-start-1 pl-2 pr-4 flex items-center",children:[lt?jsxRuntimeExports.jsx(icBaselineKeyboardArrowUp,{className:"size-5"}):jsxRuntimeExports.jsx(icBaselineKeyboardArrowDown,{className:"size-5"}),jsxRuntimeExports.jsx("span",{className:"text-xs opacity-75",children:ft(lt?"artwork:show.less":"artwork:show.more")})]})})]})}function ArtworkDetailContentCharacter(He){const{data:Qe,isValidating:it}=useCharacter(He.characterId);return jsxRuntimeExports.jsxs("button",{className:cx("flex items-center gap-2 p-1 -m-1 text-left rounded-xl","[&:not(&:has([data-capture-hover]:hover))]:hover:bg-black/10","dark:[&:not(&:has([data-capture-hover]:hover))]:hover:bg-white/10"),onClick:()=>{Qe&&dialogCharacterDetail(Qe.id)},children:[jsxRuntimeExports.jsx("div",{className:"flex-none grid size-16 overflow-hidden bg-zinc-300 dark:bg-zinc-600 rounded-lg ring-1 ring-black/10 dark:ring-white/10",children:jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:Qe?.mediaId,className:"row-start-1 col-start-1"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 content-center",children:[jsxRuntimeExports.jsx("div",{className:"px-1.5 py-0 flex items-center gap-2 text-white !w-fit !rounded bg-pink-500",children:jsxRuntimeExports.jsx("span",{className:"font-inter font-medium text-xs",children:"Character"})}),jsxRuntimeExports.jsx("span",{className:"flex-1 w-full truncate text-sm font-inter font-medium",children:Qe?.name})]})]})}function ArtworkDetailContentModels(He){const{modelId:Qe,loras:it=[void 0,void 0]}=He,{data:{model:lt}={},isValidating:ut}=useGenerationModelByVersionIdForArtwork(Qe),{t:dt}=useTranslation(["artwork"]),xt=(lt||ut)&&jsxRuntimeExports.jsx(ModelItemDisplay,{model:lt}),ft=it.length?it.map((vt,kt)=>jsxRuntimeExports.jsx(ModelItemDisplay,{model:vt},vt?.id||kt)):null;return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[xt,ft,!xt&&!ft&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ModelItemDisplay,{className:"row-start-1 col-start-1 invisible"}),jsxRuntimeExports.jsx("div",{className:"row-start-1 col-span-full grid place-content-center text-sm bg-background-light text-primary-light rounded-xl",children:dt("artwork:messages.no-model-info")})]})]})}function ModelItemDisplay(He){const{model:Qe}=He,it=isModelCoverWarned(Qe),lt=isModelEarlyAccess(Qe?.extra),ut=isAlphaTestModel(Qe?.extra),dt=Qe?.isPrivate&&!lt&&!ut;return jsxRuntimeExports.jsxs("a",{title:Qe?.title,href:Qe&&!dt?createModelUrl(Qe):void 0,className:cx("flex items-center gap-2 p-1 -m-1 text-left rounded-xl","[&:not(&:has([data-capture-hover]:hover))]:hover:bg-black/10","dark:[&:not(&:has([data-capture-hover]:hover))]:hover:bg-white/10",dt&&"pointer-events-none",He.className),style:He.style,onClick:xt=>(track("lora_click",{path:"image"}),xt.preventDefault(),dialogModelDetail(Qe)),children:[jsxRuntimeExports.jsx("div",{className:"flex-none grid size-16 overflow-hidden bg-zinc-300 dark:bg-zinc-600 rounded-lg ring-1 ring-black/10 dark:ring-white/10",children:it?jsxRuntimeExports.jsx(MediaContentRemovedIcon,{className:"row-start-1 col-start-1 place-self-center text-2xl"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(MediaPreview$1,{thumbnail:!0,mediaId:Qe?.mediaId,className:"row-start-1 col-start-1"}),dt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"row-start-1 col-start-1 relative bg-black/70"}),jsxRuntimeExports.jsx(icRoundLock,{className:"row-start-1 col-start-1 place-self-center relative text-xl text-white"})]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-1 items-center",children:[lt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(majesticonsLock,{className:"size-4"}),jsxRuntimeExports.jsx(MembershipIconCircled,{})]}),Qe&&jsxRuntimeExports.jsx(ModelTypeChip,{model:Qe,type:"compact"}),Qe&&Qe.isPrivate&&jsxRuntimeExports.jsx(AlphaTestModelChip,{model:Qe,type:"compact"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[Qe?jsxRuntimeExports.jsx("span",{className:"flex-1 w-full truncate text-sm font-medium",children:Qe.title}):jsxRuntimeExports.jsx(Skeleton,{variant:"text",className:"self-center w-[4em]"}),jsxRuntimeExports.jsx("span",{"data-capture-hover":"",className:"flex-none pl-0.5 pr-1 hover:bg-black/10 dark:hover:bg-white/10 rounded",children:Qe?jsxRuntimeExports.jsx(ModelLikeButton,{modelId:Qe.id,model:Qe,countClassName:"text-sm",scene:"artwork-detail"}):jsxRuntimeExports.jsx(Skeleton,{variant:"rounded",className:"mx-auto w-[3em] h-6"})})]})]})]})}const ArtworkPrompts=({prompts:He,segmentedPrompts:Qe})=>{const{t:it}=useTranslation(["common"]),lt=normalizeString(He||"");return He?jsxRuntimeExports.jsx("h2",{className:"text-sm font-normal leading-6 opacity-80 break-all",children:Qe?Qe?.map((ut,dt)=>jsxRuntimeExports.jsxs("span",{children:[ut.prefix,ut.content&&(ut.tagName?jsxRuntimeExports.jsx(Link,{to:createTagPageUrl("artwork",ut.tagName),children:ut.content}):ut.content),ut.suffix]},dt)):lt}):jsxRuntimeExports.jsxs("div",{className:"italic opacity-75",children:["(",it("common:not-set"),")"]})},ArtworkPromptsWithHidden=({prompts:He,segmentedPrompts:Qe,shouldHide:it})=>{const{t:lt}=useTranslation(["artwork"]);return jsxRuntimeExports.jsx("div",{className:cx("text-sm relative font-medium rounded-lg h-auto max-h-[9rem] py-2 px-3 border border-solid border-gray-100 overflow-auto leading-5 mt-4"),children:it?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"blur line-clamp-2 select-none",children:lorem}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center font-medium select-none",children:lt("artwork:hidden-by-author")})]}):jsxRuntimeExports.jsx(ArtworkPrompts,{prompts:He,segmentedPrompts:Qe})})},ArtworkNegativePrompts=({negativePrompts:He})=>jsxRuntimeExports.jsx("div",{className:cx("text-sm relative font-medium rounded-lg h-auto max-h-[9rem] py-2 px-3 border border-solid border-gray-100 overflow-auto leading-5 mt-4"),children:jsxRuntimeExports.jsx(ArtworkPrompts,{prompts:He})});function taskAbilityParser(He,Qe){const it=He?.type==="workflow";if(He?.type==="i2vPro")return{i2vpro:!0};if(it)return{handfix:Qe?.enhancementPlugins?.handfix&&He.workflowName.startsWith(Qe.enhancementPlugins.handfix.workflowName+":"),"face-detailer":Qe?.enhancementPlugins?.["face-detailer"]&&He.workflowName.startsWith(Qe.enhancementPlugins["face-detailer"].workflowName+":"),inpaint:Object.keys(INPAINT_MODELS).some(ut=>He.workflowName===ut)};if(He){const ut=He.enableADetailer??!1,dt=(He.upscale??1)>1,xt=(He.enlarge??1)>1,ft=!!He.magicPrompts;return{facefix:ut,hires:dt,upscale:xt,handfix:!1,"face-detailer":!1,"prompt-helper":ft}}return{}}const IconMap={"face-detailer":radixIconsFace,handfix:radixIconsHand,upscale:icBaselineZoomOutMap,hires:SvgHires,facefix:icOutlineTagFaces,i2vpro:riVideoAiLine,inpaint:icBaselineEdit,"prompt-helper":mdiFormTextbox};function ArtworkTaskCapabilityItems(He){const{data:Qe}=useEnhancementPlugins(),it=taskAbilityParser(He.parsedParams,{enhancementPlugins:Qe}),lt=Object.entries(it).filter(([ut,dt])=>dt).map(([ut])=>{const dt=IconMap[ut];return jsxRuntimeExports.jsx(TaskAbility,{icon:jsxRuntimeExports.jsx(dt,{className:"size-4"}),highlight:ut==="i2vpro",navigateTo:$$3(ut).with("i2vpro",()=>"/generator/image/animation").with("inpaint",()=>"/generator/image/editor").otherwise(()=>{}),label:jsxRuntimeExports.jsx(Text,{i18nKey:`artwork:parameter.task-capabilities.${ut}.label`,children:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:parameter.task-capabilities.unknown.label"})})},ut)});return lt.length<1?null:jsxRuntimeExports.jsx("section",{className:"flex flex-wrap items-center gap-2",children:lt})}function TaskAbility(He){const Qe=jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[He.icon,jsxRuntimeExports.jsx("span",{className:"text-sm",children:He.label})]}),it=cx("flex rounded-lg border  gap-1 items-center px-2 py-1",He.highlight?"border-purple-200 dark:bg-purple-500 bg-purple-500 text-white":"border-neutral-500 bg-neutral-100 dark:bg-neutral-800");return He.navigateTo?jsxRuntimeExports.jsx(Link,{to:He.navigateTo,className:it,children:Qe}):jsxRuntimeExports.jsx("div",{className:it,children:Qe})}function parseDisplayableParametersFromTask(He,Qe){if(!He)return;const it=isI2vProTask(He),lt=isT2I2VTask(He),ut=isWorkflowTask(He);if(it){const{output:dt,success:xt,issues:ft}=safeParse(TaskParametersI2vProSchema,He.parameters);if(xt)return{type:"i2vPro",...dt.i2vPro,authorId:Qe?.authorId,hidePrompts:Qe?.hidePrompts,segmentedPrompts:Qe?.segmentedPrompts}}else if(lt){const{success:dt,output:xt,issues:ft}=safeParse(TaskParametersT2i2vSchema,He.parameters);if(dt)return{type:"t2i2v",...xt,model:xt.t2i2v.model,prompts:Qe?.prompts??xt.prompts??void 0,segmentedPrompts:Qe?.segmentedPrompts,hidePrompts:Qe?.hidePrompts,magicPrompts:Qe?.extra?.naturalPrompts,authorId:Qe?.authorId}}else if(ut){const{output:dt,success:xt,issues:ft}=safeParse(TaskParametersWorkflowSchema,He.parameters);if(xt)return{type:"workflow",...dt.inputs,workflowName:dt.workflowName,isPrivate:Qe?.isPrivate,workflowId:Qe?.extra.workflowId,authorId:Qe?.authorId}}else{const{success:dt,output:xt,issues:ft}=safeParse(TaskParametersGeneratorSchema,He.parameters);if(dt)return{type:"generator",...xt,prompts:Qe?.prompts??xt.prompts??void 0,segmentedPrompts:Qe?.segmentedPrompts,hidePrompts:Qe?.hidePrompts,magicPrompts:getNaturalPrompts(Qe,He),authorId:Qe?.authorId}}}const TabChoices={prompts:"prompts",negativePrompts:"negativePrompts"};function ArtworkParameterInfo(He){const{artwork:Qe,taskParameters:it}=He,lt=parseDisplayableParametersFromTask(it,Qe);return lt?.type==="workflow"?jsxRuntimeExports.jsx(ArtworkParametersForWorkflow,{parsedParams:lt}):lt?.type?jsxRuntimeExports.jsx(ArtworkParameterInfoGenerator,{parsedParams:lt,artwork:Qe,taskParameters:it}):null}function ArtworkParameterInfoGenerator(He){const{t:Qe}=useTranslation(["artwork","generation","action"]),{parsedParams:it}=He,{data:lt}=useUserInfo(),ut=lt?.id===it?.authorId,[dt,xt]=reactExports.useState(!1),vt=it?.type==="generator",kt=reactExports.useMemo(()=>{if(it?.type==="i2vPro")return!0;if(it?.hidePrompts)return!1;const Dt=pickBy(omit(it,["prompts"]));return Object.keys(Dt).length>0},[it]),St=[[TabChoices.prompts,Qe("artwork:detail.tab.prompts")],[TabChoices.negativePrompts,Qe("generation:negative-prompts.label"),kt]],[Tt,Mt]=reactExports.useState(St[0][0]),Nt=reactExports.useMemo(()=>(!it?.hidePrompts||ut)&&!!it?.prompts,[ut,it?.hidePrompts,it?.prompts]),At=reactExports.useMemo(()=>!!it?.negativePrompts,[it]),$t=$$3({tab:Tt}).with({tab:TabChoices.prompts},()=>jsxRuntimeExports.jsx(ArtworkPromptsWithHidden,{prompts:it?.prompts,segmentedPrompts:it?.segmentedPrompts,shouldHide:it?.hidePrompts&&!ut})).with({tab:TabChoices.negativePrompts},()=>jsxRuntimeExports.jsx(ArtworkNegativePrompts,{negativePrompts:it?.negativePrompts})).otherwise(()=>null);return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Tabs,{selectionFollowsFocus:!0,className:"border-b flex",value:Tt,onChange:(Dt,Ft)=>{Mt(Ft)},classes:{root:"min-h-0"},children:St.map(([Dt,Ft,Bt])=>Bt!=null&&!Bt?null:jsxRuntimeExports.jsx(Tab,{className:"normal-case",classes:{root:"font-medium py-1 min-h-[2rem] rounded-t-lg"},label:Ft,value:Dt,onClick:()=>{track("image_prompts_click",{value:Dt})}},Dt))}),jsxRuntimeExports.jsxs("div",{className:cx("flex","absolute top-0 right-0"),children:[vt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{className:"capitalize",onClick:()=>{track("save_image_as_note_click"),lt?xt(!0):openSignModal(void 0,{fromPath:"notes-save"})},children:jsxRuntimeExports.jsxs("div",{className:"flex flex-row items-center gap-1 text-sm",children:[jsxRuntimeExports.jsx(icOutlineSave,{className:"text-sm"}),Qe("action:save")]})}),jsxRuntimeExports.jsx(UpsertNoteDialog,{open:dt,onClose:()=>xt(!1),openFrom:"image",prefilledData:{...getArtworkParameters(He.artwork,He.taskParameters),title:He.artwork.title,baseImage:He.artwork.media?UnFile.fromMedia(He.artwork.media):void 0}})]}),jsxRuntimeExports.jsx(Button,{className:cx("capitalize",Nt&&Tt===TabChoices.prompts||At&&Tt===TabChoices.negativePrompts?"block":"hidden"),onClick:()=>{Tt===TabChoices.prompts?copy(it?.prompts??"",{enableTrackValue:!0}):copy(it?.negativePrompts??"",{enableTrackValue:!0}),lt||openSignModal()},children:jsxRuntimeExports.jsxs("div",{className:"flex flex-row items-center gap-1 text-sm",children:[jsxRuntimeExports.jsx(materialSymbolsContentCopyOutline,{className:"text-sm"}),Qe("common:copy")]})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[$t,kt&&jsxRuntimeExports.jsx(ArtworkParameter,{parsedParams:it}),jsxRuntimeExports.jsx(ArtworkTaskCapabilityItems,{parsedParams:it}),it?.type==="i2vPro"?jsxRuntimeExports.jsx(I2vTaskFrames,{mediaId:it.mediaId,tailMediaId:it.tailMediaId,className:"text-sm font-semibold"}):null]})]})}const ArtworkParameterItem=({title:He,value:Qe})=>Qe?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("dt",{className:"font-semibold text-sm leading-6",children:He}),jsxRuntimeExports.jsx("dd",{className:"text-sm opacity-60 break-words leading-6",children:Qe})]}):null;function ArtworkParameter(He){const{t:Qe}=useTranslation(["common","artwork","generation"]),{parsedParams:it}=He,lt=it?.type,ut=lt==="generator"?it?.modelId:void 0,{data:{model:dt}={}}=useGenerationModelByVersionId(ut),[xt,ft]=useUncontrolled({defaultValue:lt==="i2vPro"});if(!it?.type)return null;const vt=(()=>{if(lt!=="generator")return[];const St=it.styleMix?.enabled&&Number(it.styleMix.seed)?it.styleMix.seed:void 0,Tt=it.qualityTag?formatQualityTag(it.qualityTag):void 0,Mt=it.magicPrompts,Nt=dt?dt.title:Qe("common:unknown"),At=it.width&&it.height?`${it.width} x ${it.height}`:Qe("common:unknown");return[{key:"magic-prompts",label:Qe("generation:original-prompts.label"),value:Mt},{key:"style-mix",label:jsxRuntimeExports.jsx(StyleSeedLabel,{}),value:St},{key:"quality-tag",label:Qe("generation:quality-tag.label"),value:Tt},{key:"model",label:Qe("generation:model.label"),value:Nt},{key:"size",label:Qe("generation:size.label"),value:At},{key:"sampling-steps",label:Qe("generation:sampling-steps.label"),value:it.samplingSteps},{key:"sampling-methods",label:Qe("generation:sampling-method.label"),value:it.samplingMethod},{key:"cfgscale",label:Qe("generation:cfg-scale.label"),value:it.cfgScale},{key:"seed",label:Qe("generation:seed.label"),value:it.seed}]})(),kt=(()=>{if(lt!=="i2vPro")return[];const St=Qe([`generation:image-to-video.parameters.model.${getI18nKeyForI2vModelName(it.model)}.label`,"common:unknown"]);return[{key:"model",label:Qe("generation:image-to-video.parameters.model.label"),value:St},{key:"mode",label:Qe("generation:image-to-video.parameters.mode.label"),value:it.mode},{key:"duration",label:Qe("generation:image-to-video.parameters.duration.label"),value:it.duration},{key:"camera",label:Qe("generation:image-to-video.parameters.camera.label"),value:it.cameraMovement}]})();return jsxRuntimeExports.jsxs("details",{open:xt,onToggle:St=>{const Mt=St.nativeEvent.newState==="open";ft(Mt),track("show_parameters_click",{type:Mt?"unfold":"fold"})},children:[jsxRuntimeExports.jsx("summary",{className:"bg-neutral-100 dark:bg-stone-700 rounded-full px-2 py-1 w-fit text-sm select-none cursor-pointer",children:Qe("artwork:parameter.show-parameters")}),jsxRuntimeExports.jsxs("dl",{className:"grid grid-cols-[fit-content(200px),minmax(0,1fr)] gap-x-4 ml-6 mt-1",children:[vt.map(St=>jsxRuntimeExports.jsx(ArtworkParameterItem,{title:St.label,value:St.value},St.key)),kt.map(St=>jsxRuntimeExports.jsx(ArtworkParameterItem,{title:St.label,value:St.value},St.key))]})]})}function ArtworkParametersForWorkflow(He){const{beingAdmin:Qe}=useMe(),{workflowId:it,workflowName:lt}=He.parsedParams,ut=Object.keys(INPAINT_MODELS).includes(lt),{data:dt,loading:xt}=useGetWorkflowForMarketByWorkflowId(ut?skipToken:it),ft=!xt&&!dt||!!dt?.isPrivate,vt=!xt&&(!ft||Qe),[{liked:kt,count:St,optimistic:Tt},Mt]=useLike(dt?.id,RefType.Artwork,dt);return it?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium mt-3",children:jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:workflow.workflow-used"})}),jsxRuntimeExports.jsxs("div",{className:cx("grid grid-cols-[auto_1fr_auto] items-center gap-2 p-1 -m-1 has-[button:hover]:!bg-transparent rounded-xl text-sm",vt&&"hover:bg-black/5 dark:hover:bg-white/5"),children:[jsxRuntimeExports.jsxs(Link,{to:vt?createWorkflowUrl(dt?.id??"#"):"#",className:cx("col-span-2 grid grid-cols-subgrid items-center no-underline",!vt&&"cursor-default"),children:[jsxRuntimeExports.jsx(MediaPreview$1,{mediaId:dt?.mediaId,className:cx("row-start-1 col-start-1 flex-none h-16 aspect-[1200/630] rounded-lg",xt&&"animate-pulse")}),ft&&!Qe&&jsxRuntimeExports.jsx(fluentEyeHide20Filled,{className:"row-start-1 col-start-1 place-self-center relative size-5"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{children:xt?jsxRuntimeExports.jsx(TextSkeleton,{className:"w-20"}):Qe?jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[ft&&jsxRuntimeExports.jsx(fluentEyeHide20Filled,{className:"size-5 text-amber-600 dark:text-amber-500"}),dt?.title]}):jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:workflow.messages.workflow-is-hidden"})}),jsxRuntimeExports.jsxs("p",{className:cx("flex items-center gap-1",ft&&!Qe&&"hidden"),children:[jsxRuntimeExports.jsx(UserAvatar,{user:dt?.author,className:"!size-6"}),getUserDisplayName(dt?.author)]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsxs("button",{className:cx("inline-flex items-center gap-1 p-1 -m-1 ml-0 pr-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-md",Tt&&"opacity-50",xt&&"invisible",ft&&!Qe&&"hidden"),onClick:Nt=>{Nt.stopPropagation(),Mt()},children:[jsxRuntimeExports.jsx(LikeHeart,{liked:kt??!1,className:"size-5"}),jsxRuntimeExports.jsx("span",{children:St})]}),jsxRuntimeExports.jsx("div",{className:"h-6"})]})]}),jsxRuntimeExports.jsx(ArtworkTaskCapabilityItems,{parsedParams:He.parsedParams})]}):null}function TextSkeleton(He){return jsxRuntimeExports.jsx("span",{...He,className:cx("inline-flex items-center prepend-zws",He.className),children:jsxRuntimeExports.jsx("span",{className:"flex-1 h-[1em] bg-zinc-300 rounded animate-pulse"})})}const filterTaskParameter=async He=>{const Qe=new Map(await Promise.all(Object.keys(He?.parameters?.lora??{}).map(async it=>[it,await client.getGenerationModelByVersionId({id:it})])));return produce(He,it=>{if(it?.parameters?.lora){const lt=it?.parameters?.lora;for(const ut of Object.keys(lt))Qe.get(ut)?.generationModelVersion==null&&delete lt[ut]}if(it?.parameters?.loraParameters){const lt=it?.parameters?.loraParameters;it.parameters.loraParameters=lt.filter(({versionId:ut})=>{Qe.get(ut)?.generationModelVersion!=null})}if(it?.outputs?.detailParameters?.lora){const lt=it?.outputs?.detailParameters?.lora;for(const ut of Object.keys(lt))Qe.get(ut)?.generationModelVersion==null&&delete lt[ut]}})},ArtworkDetailContent=({artwork:He,taskParameters:Qe,className:it,isSinglePage:lt})=>{const{t:ut}=useTranslation(["artwork","user","common","action"]),{onUseAsReferenceAction:dt}=useArtworkDetailContext(),xt=useWorldCharacterExperiment(),ft=useIsMobile(),vt=useNavigate(),[kt,St]=reactExports.useState(He),{data:Tt}=useUserInfo(),Mt=async()=>{const $t=kt;trackArtwork("use_as_refer_btn_click",$t);const Dt=await filterTaskParameter(Qe),Ft=`/generator/image?${formatQs({importType:"use_as_reference",artwork:encodeArtworkForImport($t),task:encodeTaskForImport(Dt)})}`;if(!Tt){openSignModal({oauthRedirectUrl:joinURL(location.origin,Ft)},{fromPath:"refer"});return}try{if(!await UIDialog.confirm({dismissable:!0,heading:ut("artwork:use-as-reference-confirm.title"),content:ut("artwork:use-as-reference-confirm.desc")}))return;if(trackArtwork("use_as_refer",$t),executeMarkArtwork({artworkId:$t.id,type:MarkType.Inspire,target:!0}),dt)return dt({taskParameters:Qe,artwork:$t});startEventGroup("generate_source"),vt(Ft)}catch(Bt){toast.error(Bt?.message)}},Nt=reactExports.useCallback(()=>{if(trackArtwork("animate_this_artwork_click",He,{mode:"i2vpro"}),!Tt){openSignModal(lt?void 0:{oauthRedirectUrl:getOpenArtworkDetailQuery(He.id)});return}openImageToVideoSubmissionDialog({mediaId:He.mediaId,afterSubmission:$t=>{vt(withQuery("/generator/image/animation",{task:encodeTaskForImport($t)}))},type:ft?"drawer":"dialog"})},[He,Tt?.id,lt,ft]),At=isI2vProTask(Qe)?void 0:Qe?.parameters.modelId;return jsxRuntimeExports.jsxs("div",{className:cx("flex-1 flex-shrink min-w-0 flex flex-col gap-5",it),children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-x-4 gap-y-2 flex-wrap",onClick:$t=>$t.stopPropagation(),children:[jsxRuntimeExports.jsxs("div",{className:cx("flex flex-col gap-2",Qe?"block":"hidden"),children:[!isGeneratedByWorkflow(He)&&!isI2vProTask(Qe)&&jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",color:"theme",className:"rounded-full px-6 h-11 text-sm font-semibold text-white",onPress:Mt,busy:"auto",children:ut("artwork:use-as-reference.label")}),!isVideoTask(Qe)&&jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",color:"theme",className:"rounded-full px-6 h-11 text-sm font-semibold",onPress:Nt,children:ut("artwork:animate-this-artwork.label")})]}),jsxRuntimeExports.jsx(ArtworkActionButton,{className:"ml-auto size-8",artwork:He,taskParameters:Qe}),!lt&&jsxRuntimeExports.jsx(UILink,{href:getArtworkLink(He),target:"_blank",variant:"ghost",icon:jsxRuntimeExports.jsx(fluentOpen20Filled,{className:"size-5"}),className:"rounded-md flex items-center justify-center size-8"})]}),jsxRuntimeExports.jsx(ArtworkParameterInfo,{artwork:He,taskParameters:Qe}),xt&&He.extra?.characterId&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium mt-3",children:ut("artwork:character.character-used")}),jsxRuntimeExports.jsx(ArtworkDetailContentCharacter,{characterId:He.extra?.characterId})]}),(He.loras?.length||At)&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium mt-3",children:ut("artwork:model.model-lora-used")}),jsxRuntimeExports.jsx(ArtworkDetailContentModels,{loras:He.loras,modelId:At})]}),jsxRuntimeExports.jsx(ArtworkDetailMembershipAdUnit,{imgClassName:"object-contain rounded-2xl",className:"rounded-2xl border hover:shadow-xl transition ease-out hover:border-neutral-400 dark:border-none"})]})};function ArtworkDetailImage(He){const{artwork:Qe}=He,{media:it}=Qe,ut=getAspectRatio(it)<1;return jsxRuntimeExports.jsx("div",{className:cx(styles["artwork-image-bg"],ut&&styles.portrait),children:jsxRuntimeExports.jsxs("div",{className:styles["artwork-image-container"],children:[jsxRuntimeExports.jsx(SingleMediaViewer,{scene:"artwork-detail",imgClassName:styles["artwork-image-element"],artworkId:Qe.id,originalUrl:getImagePublicUrl(Qe.mediaId),thumbnailUrl:getImageThumbnailUrl(Qe.mediaId),showFallbackThumbnail:!0,width:Qe.media?.width,height:Qe.media?.height,author:Qe.author,alt:getArtworkAlt(Qe),fileName:getImageDownloadFilename({artwork:Qe})+"."+getImageDownloadFileExt({artwork:Qe,media:Qe.media}),mediaType:getImageDownloadFileExt({artwork:Qe,media:Qe.media})==="mp4"?"video":"image",skipDownloadConversion:isAnimatedArtwork(Qe),videoMediaId:Qe.videoMediaId,mediaId:Qe.mediaId,preferVideo:!0}),jsxRuntimeExports.jsx(CardCornerDebugInfo,{extra:Qe?.extra,paidCredit:Qe?.paidCredit,aesScore:Qe?.aesScore,children:dt=>jsxRuntimeExports.jsx("div",{className:"absolute top-2 right-2 bg-black/60 backdrop-blur rounded-xl px-2 py-1.5",children:dt})})]})})}const ArtworkDetail=({artwork:He,isSinglePage:Qe,onUseAsReferenceAction:it,shouldExploreStyleTargetBlank:lt,onClose:ut,onLikeClickForRec:dt,trackingArgs:xt})=>{const{t:ft}=useTranslation(["artwork"]),{data:vt,refetch:kt}=useGetArtworkWithTaskDetail(He.id),{data:St}=useUserInfo(),{taskParameters:Tt,...Mt}=vt||He,Nt=St!=null&&St?.id===Mt?.author?.id,At=reactExports.useMemo(()=>({artwork:Mt,taskParameters:Tt,isSinglePage:Qe,onUseAsReferenceAction:it,shouldExploreStyleTargetBlank:lt,onClose:ut,onLikeClickForRec:dt,userIsAuthor:Nt,refetchArtwork:kt,trackingArgs:xt}),[Mt,Tt,Qe,it,lt,ut,dt,Nt,kt,xt]);return Mt?jsxRuntimeExports.jsxs(ArtworkDetailContext.Provider,{value:At,children:[jsxRuntimeExports.jsxs("main",{className:cx("bg-background w-full rounded-xl",styles["artwork-main-wrapper"],Qe&&styles["single-page"]),children:[jsxRuntimeExports.jsxs("div",{className:cx(styles["artwork-detail-content-container"]),children:[jsxRuntimeExports.jsx(ArtworkDetailImage,{artwork:Mt}),jsxRuntimeExports.jsx(ArtworkDetailAuthorInfo,{artwork:Mt,isSinglePage:Qe,className:"pt-4 min-w-0"})]}),jsxRuntimeExports.jsx("section",{className:"flex flex-col gap-2 [grid-area:description]",children:jsxRuntimeExports.jsx(ArtworkDescriptionAndTags,{artwork:Mt})}),jsxRuntimeExports.jsx("section",{className:"[grid-area:comment] min-w-0",children:jsxRuntimeExports.jsx(ArtworkDetailCommentArea,{})}),jsxRuntimeExports.jsx(ArtworkDetailContent,{artwork:Mt,taskParameters:Tt,className:"[grid-area:detail]",isSinglePage:Qe})]}),Qe&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"px-5 pt-12 flex flex-col bg-background gap-10",children:[jsxRuntimeExports.jsx(ArtworkRelevantArtworksInline,{artworkId:Mt.id}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"font-medium text-xl mb-4",children:ft("artwork:recommended-users.title")}),jsxRuntimeExports.jsx(ArtworkRecommendedUsers,{})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"font-medium text-xl mb-4",children:ft("artwork:search-results.recommendation-section.heading")}),jsxRuntimeExports.jsx(ArtworkRecommendedArtworks,{trackingArgs:{scene:"artwork-relevant"}})]})]})})]}):null};function ArtworkDetailCommentArea(){const{artwork:He,userIsAuthor:Qe,isSinglePage:it}=reactExports.useContext(ArtworkDetailContext),[lt,ut]=reactExports.useState(!1);return He?jsxRuntimeExports.jsx("div",{className:cx("w-full bg-neutral-100 dark:bg-neutral-700 rounded-lg p-4",!it&&"rounded-bl-2xl"),children:jsxRuntimeExports.jsx(reactExports.Suspense,{children:jsxRuntimeExports.jsxs(CommentProvider,{topicId:He.id,refType:RefType.Artwork,initLoadSize:3,canDeleteMessage:()=>Qe,onLoadMore:()=>{ut(dt=>(dt||track("show_more_comments"),!0))},children:[jsxRuntimeExports.jsx("div",{className:"flex items-center pb-2",children:jsxRuntimeExports.jsxs("h3",{className:"font-medium text-base flex items-center",children:[jsxRuntimeExports.jsx(Text,{i18nKey:"artwork:comment"}),(He.commentCount??0)>0&&jsxRuntimeExports.jsx("span",{className:"text-neutral-500 pl-2 text-xs",children:He.commentCount})]})}),jsxRuntimeExports.jsx(CommentComposer,{className:"mb-4 pb-4 border-b border-black/20 dark:border-white/20"}),jsxRuntimeExports.jsx(CommentList,{windowed:lt,loadMode:lt?"scroll":"button",style:{height:lt?440:void 0}})]})})}):null}const ARTWORK_DETAIL_EXPERIMENT_KEY="exp2509-artwork-detail-layout";function ArtworkDetailExperiment(He){const{value:Qe}=useExperimentParamValue(ARTWORK_DETAIL_EXPERIMENT_KEY);return Qe==="treatment"?jsxRuntimeExports.jsx(ArtworkDetail,{...He}):jsxRuntimeExports.jsx(ArtworkDetail$1,{...He})}const useListChatEditingScenes=modifyQueryHook(createQueryHook(ListChatEditingScenesDocument),{reduce:He=>He?.chatEditingScenes}),useGetChatEditingScene=modifyQueryHook(createQueryHook(GetChatEditingSceneDocument),{transform:He=>({sceneId:He}),reduce:He=>He?.chatEditingScene}),[useCreateChatEditingSceneTask,executeCreateChatEditingSceneTask]=createMutationHelper(CreateChatEditingSceneTaskDocument),BaseCursorPagingContext=reactExports.createContext({mutate:async()=>{}}),useBaseCursorPagingContext=()=>reactExports.useContext(BaseCursorPagingContext),BaseCursorPaging=He=>{const{before:Qe,after:it,onCursorChange:lt,useSWR:ut,getConnection:dt,extraArgs:xt,isPosSeq:ft,pageSize:vt,renderContainer:kt=({children:xr})=>jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:xr}),renderItem:St,PagingButton:Tt=CursorPagingButton,loading:Mt=jsxRuntimeExports.jsx(LoadingPage,{}),empty:Nt,renderError:At,pagingRef:$t,onDataChange:Dt=()=>{}}=He,Ft=ut({...getBaseCursorPagingArgs({before:Qe,after:it,pageSize:vt,isPosSeq:ft}),...xt}),Bt=Ft.data,Ot="mutate"in Ft?Ft.mutate:Ft.refetch,Qt="isValidating"in Ft?Ft.isValidating:Ft.loading,Wt=Ft.error;reactExports.useEffect(()=>{Dt(Bt)},[Bt]);const Xt=dt(Bt),Kt=reactExports.useMemo(()=>{const xr=getNodesFromConnection(Xt);return ft?xr:xr.reverse()},[Bt]),Jt=reactExports.useMemo(()=>({mutate:Ot,data:Bt}),[Ot,Bt]);reactExports.useImperativeHandle($t,()=>Jt,[Jt]);const hr=({before:xr,after:gr})=>{const br={before:xr,after:gr,...xt};lt?.(br)};return jsxRuntimeExports.jsx(BaseCursorPagingContext.Provider,{value:Jt,children:Kt.length>0?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[kt({children:Kt.map(St)}),jsxRuntimeExports.jsx(Tt,{pageInfo:Xt?.pageInfo,onChange:hr,isPosSeq:ft})]}):Qt?Mt:Wt&&At?.(Wt)||Nt})},WorkspaceDeleteConfirmDialog=({trigger:He,source:Qe,workspaceId:it,onSuccess:lt})=>{const[ut,dt]=reactExports.useState(!1),{t:xt}=useTranslation(["generation"]),ft=()=>{track("delete_workspace_click",{source:Qe}),dt(!0)},vt=async()=>{try{track("delete_workspace_connfirm_click",{source:Qe}),await client.deleteChatWorkspace({workspaceId:it}),toast.success(xt("generation:chat-editing.workspace.delete.success-toast")),dt(!1),lt?.(it)}catch(St){toast.error(St.message??"Failed to delete workspace")}},kt=Qe==="delete-start-point"?"start_point":"";return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[He(ft),jsxRuntimeExports.jsxs(UIDialog,{open:ut,children:[jsxRuntimeExports.jsx(UIDialogHeader,{heading:xt("generation:chat-editing.workspace.delete.confirm-dialog.title")}),jsxRuntimeExports.jsx(UIDialogContent,{children:jsxRuntimeExports.jsx(MarkdownRenderer,{className:"prose prose-sm prose-neutral dark:prose-invert",children:xt("generation:chat-editing.workspace.delete.confirm-dialog.content",{context:kt})})}),jsxRuntimeExports.jsxs(UIDialogFooter,{className:"sticky bottom-0 bg-white dark:bg-zinc-800 justify-end",children:[jsxRuntimeExports.jsx(UIButton$1,{onPress:()=>dt(!1),children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:cancel"})}),jsxRuntimeExports.jsx(UIButton$1,{variant:"filled",onPress:vt,children:jsxRuntimeExports.jsx(Text,{i18nKey:"action:confirm"})})]})]})]})},WorkspaceCard=({workspace:He,onClicked:Qe,onWorkspaceDelete:it})=>{const lt=reactExports.useCallback(()=>{Qe(He)},[Qe,He]);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(BaseArtworkItemPreviewCard,{id:He.id,mediaId:He.lastImage??He.initialImage,mediaFallback:jsxRuntimeExports.jsx(TaskPlaceholderImage,{className:"w-full h-full",id:He.id}),label:He.title??He.id,time:He.createdAt,border:"plain",onClick:lt,showLikeBtn:!0,likeBtn:jsxRuntimeExports.jsx(WorkspaceDeleteConfirmDialog,{source:"delete-button-clicked",workspaceId:He.id,onSuccess:it,trigger:ut=>jsxRuntimeExports.jsx(UIButton$1,{variant:"ghost",className:"p-4",onPress:ut,children:jsxRuntimeExports.jsx(icBaselineDeleteOutline,{className:"size-6"})})})})})},ChatWorkspaceSelectorPaging=({pageSize:He,cardProps:{onWorkspaceDelete:Qe,...it},...lt})=>{const[{before:ut,after:dt},xt]=useQs(),ft=reactExports.useRef(null),vt=kt=>{ft.current?.mutate(),Qe?.(kt)};return jsxRuntimeExports.jsx(BaseCursorPaging,{pagingRef:ft,useSWR:useChatWorkspaces,getConnection:kt=>kt,before:ut,after:dt,onCursorChange:xt,pageSize:He,renderItem:kt=>jsxRuntimeExports.jsx(WorkspaceCard,{workspace:kt,onWorkspaceDelete:vt,...it},kt.id),...lt})},NoChatWorkspaceTutorialSimple=()=>{const{t:He}=useTranslation(["generation"]),Qe=useEmbedded(),it=useNavigate(),lt=reactExports.useCallback(()=>{it("/")},[it]),ut=He("generation:chat-editing.workspace.selector.empty-tutorial-panel",{context:Qe?"embedded":""});return jsxRuntimeExports.jsx(Empty,{mioExpression:"welcome",action:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-stretch gap-4 my-4",children:[jsxRuntimeExports.jsx(StartChatEditingButtonLarger,{className:"h-12 text-base md:text-lg"}),jsxRuntimeExports.jsx(MarkdownRenderer,{as:"article",className:"prose prose-sm md:prose-sm prose-neutral dark:prose-invert mx-auto",children:ut}),!Qe&&jsxRuntimeExports.jsx(UIButton$1,{onPress:lt,className:"text-gray-500",variant:"outlined",size:"small",children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:chat-editing.workspace.creator.buttons.go-back"})})]})})},NoChatWorkspaceTutorial=()=>{const{t:He}=useTranslation(["generation"]),Qe=useEmbedded(),it=useNavigate(),lt=reactExports.useCallback(()=>{it("/")},[it]),ut=He("generation:chat-editing.workspace.selector.empty-tutorial",{context:Qe?"embedded":""});return jsxRuntimeExports.jsx(Empty,{mioExpression:"welcome",action:jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsx(MarkdownRenderer,{as:"article",className:"prose prose-base md:prose-lg prose-neutral dark:prose-invert mx-auto",children:ut}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-4",children:[jsxRuntimeExports.jsx(StartChatEditingButton,{}),!Qe&&jsxRuntimeExports.jsx(UIButton$1,{onPress:lt,children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:homepage"})})]})]})})},ChatWorkspaceSelectorPage=()=>{const He=isAppWebview();return jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-4 py-8 space-y-10 max-w-7xl h-full flex flex-col min-h-0",children:[He?null:jsxRuntimeExports.jsx(PresetToolbar,{}),jsxRuntimeExports.jsx(SelectorWorkspaceSection,{})]})},CHAT_WORKSPACE_EMPTY_PAGE_REDESIGN_EXPERIMENT_NAME="exp2509-chat-workspace-empty-page-redesign",SelectorWorkspaceSection=()=>{const{t:He}=useTranslation(["generation"]),{me:Qe}=useMe(),{data:it}=useChatWorkspaces(),lt=reactExports.useMemo(()=>Qe?it&&it.totalCount===0:!0,[it,Qe]),ut=useEmbeddedNavigate(),dt=reactExports.useCallback(ft=>{track("selected_workspace_click"),ut(EmbeddedRoutes.chatEditingWorkspace(ft.id))},[ut]),xt=useExperimentParam(CHAT_WORKSPACE_EMPTY_PAGE_REDESIGN_EXPERIMENT_NAME);return jsxRuntimeExports.jsxs("div",{className:"flex flex-col min-h-0 h-full gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[jsxRuntimeExports.jsx("h2",{className:"justify-start text-2xl font-semibold",children:He("generation:chat-editing.workspace.selector.title")}),!lt&&jsxRuntimeExports.jsx("div",{className:"justify-start md:justify-end flex-1 flex",children:jsxRuntimeExports.jsx(StartChatEditingButton,{})})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 min-h-0 overflow-auto",children:jsxRuntimeExports.jsx(ChatWorkspaceSelectorPaging,{pageSize:24,empty:xt==="treatment"?jsxRuntimeExports.jsx(NoChatWorkspaceTutorialSimple,{}):jsxRuntimeExports.jsx(NoChatWorkspaceTutorial,{}),renderContainer:({children:ft})=>jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 lg:gap-3 pb-4",children:ft}),cardProps:{onClicked:dt}})})]})},PresetToolbar=()=>{const{data:He}=useListChatEditingScenes({});return!He||He.length===0?null:jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx("h2",{className:"justify-start text-2xl font-semibold",children:jsxRuntimeExports.jsx(Text,{i18nKey:"generation:chat-editing-preset.label"})}),jsxRuntimeExports.jsx(HorizontalScrollable,{className:"flex min-w-full gap-2 py-1.5",children:He.map(Qe=>jsxRuntimeExports.jsx(Link,{className:cx("py-1 px-1.5 gap-1 rounded-lg","flex flex-row items-center","border border-zinc-400 dark:border-zinc-200","hover:no-underline"),to:`/generator/preset/${Qe.sceneId}`,children:jsxRuntimeExports.jsx("span",{className:"text-base px-2",children:jsxRuntimeExports.jsx(Text,{i18nKey:Qe.name})})},Qe.sceneId))})]})},fluentClipboard20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M7.085 3A1.5 1.5 0 0 1 8.5 2h3a1.5 1.5 0 0 1 1.415 1H14.5A1.5 1.5 0 0 1 16 4.5v12a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 4 16.5v-12A1.5 1.5 0 0 1 5.5 3zM8.5 3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1zM7.085 4H5.5a.5.5 0 0 0-.5.5v12a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5v-12a.5.5 0 0 0-.5-.5h-1.585A1.5 1.5 0 0 1 11.5 5h-3a1.5 1.5 0 0 1-1.415-1"})}),fluentDismissSquare24Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M8.22 8.22a.75.75 0 0 1 1.06 0L12 10.94l2.72-2.72a.75.75 0 1 1 1.06 1.06L13.06 12l2.72 2.72a.75.75 0 1 1-1.06 1.06L12 13.06l-2.72 2.72a.75.75 0 0 1-1.06-1.06L10.94 12L8.22 9.28a.75.75 0 0 1 0-1.06M6.25 3A3.25 3.25 0 0 0 3 6.25v11.5A3.25 3.25 0 0 0 6.25 21h11.5A3.25 3.25 0 0 0 21 17.75V6.25A3.25 3.25 0 0 0 17.75 3zM4.5 6.25c0-.966.784-1.75 1.75-1.75h11.5c.966 0 1.75.784 1.75 1.75v11.5a1.75 1.75 0 0 1-1.75 1.75H6.25a1.75 1.75 0 0 1-1.75-1.75z"})}),mdiCancel=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M12 2c5.5 0 10 4.5 10 10s-4.5 10-10 10S2 17.5 2 12S6.5 2 12 2m0 2c-1.9 0-3.6.6-4.9 1.7l11.2 11.2c1-1.4 1.7-3.1 1.7-4.9c0-4.4-3.6-8-8-8m4.9 14.3L5.7 7.1C4.6 8.4 4 10.1 4 12c0 4.4 3.6 8 8 8c1.9 0 3.6-.6 4.9-1.7Z"})}),mdiRefresh=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0 0 12 4a8 8 0 0 0-8 8a8 8 0 0 0 8 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18a6 6 0 0 1-6-6a6 6 0 0 1 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35Z"})}),createStateAtom=He=>atomWithImmer(He),DebugPanelContext=reactExports.createContext({});function DebugPanel(He){const[,Qe]=useLocalStorage({key:"enable-debug"}),[it,lt]=useLocalStorage({key:"api-base-url",defaultValue:config$1.apiUrl}),[ut,dt]=useLocalStorage({key:"gateway-base-url",defaultValue:config$1.gatewayUrl}),xt=reactExports.useMemo(()=>createStateAtom({apiBaseUrl:it,wsBaseUrl:ut}),[it,ut,He.open]),ft=useAtomValue(xt),vt=useAtomValue(bypassAdminAtom),kt=reactExports.useRef(vt);reactExports.useEffect(()=>{He.open&&(kt.current=vt)},[He.open]);const St=ft.apiBaseUrl!==it||ft.wsBaseUrl!==ut||vt!==kt.current;return jsxRuntimeExports.jsx(DebugPanelContext.Provider,{value:xt,children:jsxRuntimeExports.jsxs(ResponsiveDialog,{...He,className:"text-sm",dialogProps:{maxWidth:"sm",className:"overflow-visible"},children:[jsxRuntimeExports.jsxs(DialogTitle,{className:"flex items-center gap-4 border-b-4 [--strip-color:theme(colors.amber.600)]",style:{borderImage:"repeating-linear-gradient(135deg, transparent, transparent 4px, var(--strip-color) 4px, var(--strip-color) 8px) 4 / 0 0 4px 0"},children:[jsxRuntimeExports.jsx("span",{children:"Debug Panel"}),jsxRuntimeExports.jsx("div",{className:"ml-auto flex items-center gap-4 h-[1em]",children:jsxRuntimeExports.jsxs(IconButton,{className:cx("flex-none -mr-3",St&&"text-white bg-orange-500"),onClick:()=>{lt(ft.apiBaseUrl||config$1.apiUrl),dt(ft.wsBaseUrl||config$1.gatewayUrl),location.reload()},children:[jsxRuntimeExports.jsx("div",{className:cx("absolute inset-0 rounded-full bg-orange-500 animate-ping pointer-events-none",!St&&"hidden")}),jsxRuntimeExports.jsx(mdiRefresh,{className:"relative size-6"})]})})]}),jsxRuntimeExports.jsxs(DialogContent,{className:"p-8 flex flex-col gap-8",children:[jsxRuntimeExports.jsx(ApiBaseUrlSelect,{}),jsxRuntimeExports.jsx(WebsocketBaseUrlSelect,{}),jsxRuntimeExports.jsx(DebugSettings,{})]}),jsxRuntimeExports.jsx(DialogActions,{className:"justify-start",children:jsxRuntimeExports.jsx(Button,{variant:"outlined",color:"error",startIcon:jsxRuntimeExports.jsx(fluentDismissSquare24Regular,{className:"size-6"}),onClick:()=>Qe(!1),children:"Remove debug widget"})})]})})}function ApiBaseUrlSelect(){const[He,Qe]=useAtom(reactExports.useContext(DebugPanelContext)),[,it]=useLocalStorage({key:"api-base-url",defaultValue:config$1.apiUrl}),[lt,ut]=useLocalStorage({key:"api-base-url-hist",defaultValue:[]}),dt=()=>{const xt=He.apiBaseUrl||config$1.apiUrl;it(xt),ut(ft=>uniq([xt,...ft]).slice(0,10)),toast.success(`Changed to ${xt}. Refresh to take effect.`)};return jsxRuntimeExports.jsx(Autocomplete,{freeSolo:!0,options:compact(uniq(["https://capi.voids.top","https://papi-main.ring.mewtant.co","http://127.0.0.1:3011","http://dev.local:3011",config$1.apiUrl,...lt])),className:"flex-1",size:"small",renderInput:xt=>jsxRuntimeExports.jsx(TextField,{label:"API Base URL",...xt}),placeholder:config$1.apiUrl,value:He.apiBaseUrl,onInputChange:(xt,ft)=>{Qe(vt=>{vt.apiBaseUrl=ft})},onKeyUp:xt=>{xt.key==="Enter"&&dt()}})}function WebsocketBaseUrlSelect(){const[He,Qe]=useAtom(reactExports.useContext(DebugPanelContext)),[,it]=useLocalStorage({key:"gateway-base-url",defaultValue:config$1.gatewayUrl}),[lt,ut]=useLocalStorage({key:"gateway-base-url-hist",defaultValue:[]}),dt=()=>{const xt=He.wsBaseUrl||config$1.gatewayUrl;it(xt),ut(ft=>uniq([xt,...ft]).slice(0,10)),toast.success(`Changed to ${xt}. Refresh to take effect.`)};return jsxRuntimeExports.jsx(Autocomplete,{freeSolo:!0,options:compact(uniq(["wss://gw.pixai.art","wss://pixai-server-gateway-main.ring.mewtant.co","ws://127.0.0.1:3015","ws://dev.local:3015",config$1.gatewayUrl,...lt])),className:"flex-1",size:"small",renderInput:xt=>jsxRuntimeExports.jsx(TextField,{label:"WebSocket Base URL",...xt}),placeholder:config$1.gatewayUrl,value:He.wsBaseUrl,onInputChange:(xt,ft)=>{Qe(vt=>{vt.wsBaseUrl=ft})},onKeyUp:xt=>{xt.key==="Enter"&&dt()}})}function DebugSettings(){const He=getDeviceId(),{data:Qe,refetch:it}=useUserInfo(),lt=useToken(),[ut,dt]=useAtom(bypassAdminAtom),[xt,ft]=useLocalStorage({key:"debug::show-generated-content-debug-info",defaultValue:!1}),[vt,kt]=useAtom(turnstileSiteKeyTypeAtom);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("section",{className:"grid auto-rows-auto grid-cols-[auto_1fr] gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"contents",children:[jsxRuntimeExports.jsx("span",{children:"Device ID"}),jsxRuntimeExports.jsxs("p",{className:"inline-flex items-center overflow-hidden cursor-pointer",onClick:()=>copy(He??"",{scene:null}),children:[jsxRuntimeExports.jsx("code",{className:"grow-9 shrink truncate",children:He}),jsxRuntimeExports.jsx(fluentClipboard20Regular,{className:"flex-none ml-1 size-5"})]})]}),jsxRuntimeExports.jsxs("div",{className:"contents",children:[jsxRuntimeExports.jsx("span",{children:"User ID"}),jsxRuntimeExports.jsxs("code",{className:"inline-flex items-center cursor-pointer",onClick:()=>copy(Qe?.id??"",{scene:null}),children:[Qe?.id,jsxRuntimeExports.jsx(fluentClipboard20Regular,{className:"ml-1 size-5"})]})]}),jsxRuntimeExports.jsxs("div",{className:"contents",children:[jsxRuntimeExports.jsx("span",{children:"Token"}),jsxRuntimeExports.jsxs("form",{className:"flex w-full -my-1 rounded-md ring-1 ring-black/20 dark:ring-white/20 divide-x divide-black/20 dark:divide-white/20",onSubmit:St=>{St.preventDefault();const Mt=new FormData(St.currentTarget).get("token");Mt&&(setToken(Mt),it())},children:[jsxRuntimeExports.jsx("input",{name:"token",type:"text",defaultValue:lt,className:"flex-1 px-2 py-1 bg-transparent font-mono",onFocus:St=>St.target.select(),onChange:St=>{St.target.value=St.target.value.trim()},spellCheck:!1,autoCorrect:"off",autoCapitalize:"off"}),jsxRuntimeExports.jsx("button",{type:"button",className:"flex-none inline-grid place-content-center box-content h-full aspect-square",onClick:()=>copy(lt,{scene:null}),children:jsxRuntimeExports.jsx(fluentClipboard20Regular,{className:"size-5"})}),jsxRuntimeExports.jsx("button",{type:"submit",hidden:!0})]})]}),jsxRuntimeExports.jsxs("div",{className:"contents",children:[jsxRuntimeExports.jsx("span",{children:"Bypass Admin"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"mb-2 flex items-center h-5",children:jsxRuntimeExports.jsx(Switch,{checked:ut,className:"-ml-2",onChange:(St,Tt)=>{dt(Tt)}})}),jsxRuntimeExports.jsx("p",{className:"text-neutral-500 dark:text-neutral-400",children:"By enabling bypass admin, you will access as a regular user."})]})]}),jsxRuntimeExports.jsxs("div",{className:"contents",children:[jsxRuntimeExports.jsx("span",{children:"Content Debug Info"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"mb-2 flex items-center h-5",children:jsxRuntimeExports.jsx(Switch,{checked:xt,className:"-ml-2",onChange:(St,Tt)=>{ft(Tt)}})}),jsxRuntimeExports.jsx("p",{className:"text-neutral-500 dark:text-neutral-400",children:"Toggle visibility of debug info for generated content (tasks & artworks)."})]})]}),jsxRuntimeExports.jsxs("div",{className:"contents",children:[jsxRuntimeExports.jsx("span",{children:"Turnstile site key"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"mb-2 flex items-center h-5",children:jsxRuntimeExports.jsxs(Select,{value:vt||"no-override",onChange:St=>{kt(St.target.value==="no-override"?"":St.target.value)},size:"small",className:"w-full",classes:{select:"py-1.5 text-sm"},MenuProps:{MenuListProps:{dense:!0}},children:[jsxRuntimeExports.jsx(MenuItem$1,{value:"no-override",children:"No override"}),jsxRuntimeExports.jsx(MenuItem$1,{value:"test-always-pass",children:"Test: Always pass"}),jsxRuntimeExports.jsx(MenuItem$1,{value:"test-always-block",children:"Test: Always block"}),jsxRuntimeExports.jsx(MenuItem$1,{value:"test-force-interactive",children:"Test: Force interactive"})]})}),jsxRuntimeExports.jsx("p",{className:"text-neutral-500 dark:text-neutral-400",children:"Use test site key to force turnstile result. Test site key won't works with production api. Might need refresh to take effect."})]})]})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg text-neutral-600 dark:text-neutral-300",children:"Feature Flags"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-[200px_1fr] items-center justify-items-start gap-x-4 gap-y-1",children:[jsxRuntimeExports.jsx(FeatureFlag,{name:WORLD_CHARACTER_EXPERIMENT_NAME}),jsxRuntimeExports.jsx(FeatureFlag,{name:RECORD_SESSION_FOR_I2V_EXPERIMENT_NAME}),jsxRuntimeExports.jsx(FeatureFlag,{name:JPY_CURRENCY_EXPERIMENT_NAME}),jsxRuntimeExports.jsx(FeatureFlag,{name:LOGIN_CAPTCHA_EXPERIMENT_NAME,values:[captchaVariants.recaptcha,captchaVariants.turnstileInvisible,captchaVariants.turnstileNonInteractive,captchaVariants.turnstileManaged]}),jsxRuntimeExports.jsx(FeatureFlag,{name:CHAT_WORKSPACE_EMPTY_PAGE_REDESIGN_EXPERIMENT_NAME,values:["control","treatment"]}),jsxRuntimeExports.jsx(FeatureFlag,{name:AUGUST_EVENT_MEMBERSHIP_DEFAULT_MONTHLY_FEATURE_FLAG_KEY,values:["control","treatment"]}),jsxRuntimeExports.jsx(FeatureFlag,{name:ARTWORK_DETAIL_EXPERIMENT_KEY,values:["control","treatment"]}),jsxRuntimeExports.jsx(FeatureFlag,{name:"exp2509-mobileweb-bottom-nav-button-size",values:["control","treatment-a","treatment-b"]})]})]})]})}function FeatureFlag({name:He,storageKey:Qe="exp:"+He,values:it,clear:lt,revoke:ut}){const dt=useExperimentParam(He,void 0,{remoteOnly:!0}),[xt,ft]=useLocalStorage({key:Qe});function vt(kt,St){ft(St),St||localStorage.removeItem(Qe)}return useMount(()=>{ut&&vt(null,0)}),ut?null:jsxRuntimeExports.jsxs("div",{className:"contents",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-0.5 overflow-x-auto whitespace-nowrap max-w-full",children:[jsxRuntimeExports.jsx("code",{className:"text-sm",children:He}),jsxRuntimeExports.jsx("code",{className:"text-xs",title:"Remote value",children:dt})]}),$$3({values:it}).when(()=>lt,()=>jsxRuntimeExports.jsx(IconButton,{size:"small",onClick:()=>vt(null,0),children:jsxRuntimeExports.jsx(mdiCancel,{})})).with({values:N$4.array(N$4.any)},({values:kt})=>jsxRuntimeExports.jsx("div",{className:"overflow-x-auto max-w-full",children:jsxRuntimeExports.jsxs(ToggleButtonGroup,{exclusive:!0,size:"small",value:xt,onChange:vt,children:[jsxRuntimeExports.jsx(ToggleButton,{value:"",className:"px-4",children:jsxRuntimeExports.jsx(mdiCancel,{})}),kt.map(St=>jsxRuntimeExports.jsx(ToggleButton,{value:St,className:"text-nowrap",children:St},St))]})})).otherwise(()=>jsxRuntimeExports.jsx(Switch,{checked:!!xt,onChange:vt}))]})}function getApiEnvAppearance(He){return $$3(He).with({hostname:"localhost"},()=>({label:"Local",className:"text-blue-500"})).with({hostname:"pai-api-main.pixai.art"},()=>({label:"Staging",className:"text-green-500"})).with({hostname:"papi-main.ring.mewtant.co"},()=>({label:"Testing",className:"text-sky-500"})).with({hostname:N$4.when(Qe=>Qe.startsWith("pai-api")&&Qe.endsWith("pixai.art"))},()=>({label:"Staging Branch",className:"text-cyan-500"})).with({hostname:N$4.when(Qe=>Qe.endsWith("ring.mewtant.co"))},()=>({label:"Testing Branch",className:"text-purple-500"})).with({hostname:N$4.when(Qe=>Qe.endsWith("pixai.art"))},()=>({label:"Production",className:"text-pink-500"})).otherwise(()=>({label:"Unknown",className:"text-neutral-500"}))}function DebugWidget(){const{data:He}=useUserInfo(),[Qe,it]=useLocalStorage({key:"enable-debug"});useLocalStorage({key:"api-base-url",defaultValue:config$1.apiUrl});const lt=getAppEnv();reactExports.useEffect(()=>{(!lt.isProd||He?.isAdmin)&&Qe==null&&it(!0)},[He]);const[ut,dt]=reactExports.useState(!1),xt=getApiEnvAppearance(new URL(getApiUrl())),ft=jsxRuntimeExports.jsx(Tooltip,{title:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-bold",children:"click to show debug widget"}),jsxRuntimeExports.jsxs("div",{children:["API URL: ",getApiUrl()," ",jsxRuntimeExports.jsx("br",{}),"WebSocket URL: ",getWebsocketUrl()]}),jsxRuntimeExports.jsxs("div",{children:["commit: ",config$1.commitHash?.slice(0,8)]}),He?.isAdmin&&jsxRuntimeExports.jsx("div",{className:"text-yellow-500",children:"(You are admin. Operate with caution.)"})]}),children:jsxRuntimeExports.jsxs("button",{className:"fixed text-xs left-4 z-20 flex items-center gap-1 bg-white/90 dark:bg-neutral-900/90 rounded-xl px-2 py-1 bottom-24 mmd:bottom-4",onClick:()=>dt(!0),children:[jsxRuntimeExports.jsx(WsStatusIcon,{}),jsxRuntimeExports.jsx("span",{children:"app:"}),jsxRuntimeExports.jsx("span",{className:"text-red-500",children:lt.isProd?"production":"preview"}),jsxRuntimeExports.jsx("span",{children:"api:"}),jsxRuntimeExports.jsx("span",{className:xt.className,children:xt.label})]})});return Qe?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[ft,jsxRuntimeExports.jsx(DebugPanel,{open:ut,onClose:()=>dt(!1)})]}):null}function WsStatusIcon(){const He=useWsConnectionStatus({detailed:!0});return jsxRuntimeExports.jsx("div",{className:cx("rounded-lg size-2",He==="connected"&&"bg-green-500",He==="connecting"&&"bg-yellow-500",He==="closed"&&"bg-red-500"),title:"WS connection status: Green: connected / Yellow: connecting / Red: closed"})}const ErrorBoundaryContext=reactExports.createContext(null),initialState={didCatch:!1,error:null};class ErrorBoundary extends reactExports.Component{constructor(Qe){super(Qe),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=initialState}static getDerivedStateFromError(Qe){return{didCatch:!0,error:Qe}}resetErrorBoundary(){const{error:Qe}=this.state;if(Qe!==null){for(var it,lt,ut=arguments.length,dt=new Array(ut),xt=0;xt<ut;xt++)dt[xt]=arguments[xt];(it=(lt=this.props).onReset)===null||it===void 0||it.call(lt,{args:dt,reason:"imperative-api"}),this.setState(initialState)}}componentDidCatch(Qe,it){var lt,ut;(lt=(ut=this.props).onError)===null||lt===void 0||lt.call(ut,Qe,it)}componentDidUpdate(Qe,it){const{didCatch:lt}=this.state,{resetKeys:ut}=this.props;if(lt&&it.error!==null&&hasArrayChanged(Qe.resetKeys,ut)){var dt,xt;(dt=(xt=this.props).onReset)===null||dt===void 0||dt.call(xt,{next:ut,prev:Qe.resetKeys,reason:"keys"}),this.setState(initialState)}}render(){const{children:Qe,fallbackRender:it,FallbackComponent:lt,fallback:ut}=this.props,{didCatch:dt,error:xt}=this.state;let ft=Qe;if(dt){const vt={error:xt,resetErrorBoundary:this.resetErrorBoundary};if(reactExports.isValidElement(ut))ft=ut;else if(typeof it=="function")ft=it(vt);else if(lt)ft=reactExports.createElement(lt,vt);else throw xt}return reactExports.createElement(ErrorBoundaryContext.Provider,{value:{didCatch:dt,error:xt,resetErrorBoundary:this.resetErrorBoundary}},ft)}}function hasArrayChanged(){let He=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],Qe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return He.length!==Qe.length||He.some((it,lt)=>!Object.is(it,Qe[lt]))}const fluentErrorCircle20Regular=He=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 20 20",width:"1.2em",height:"1.2em",...He,children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M10 2a8 8 0 1 1 0 16a8 8 0 0 1 0-16m0 1a7 7 0 1 0 0 14a7 7 0 0 0 0-14m0 9.5a.75.75 0 1 1 0 1.5a.75.75 0 0 1 0-1.5M10 6a.5.5 0 0 1 .492.41l.008.09V11a.5.5 0 0 1-.992.09L9.5 11V6.5A.5.5 0 0 1 10 6"})});function ErrorPage(){const He=useRouteError();reactExports.useEffect(()=>{He&&captureException(He)},[He]);const Qe=reactExports.useMemo(()=>He?String(typeof He=="object"&&"message"in He?He.message:He):"No error detail",[He]),{t:it}=useTranslation(["common"]);return jsxRuntimeExports.jsx("div",{className:"min-h-screen grid place-content-center",children:jsxRuntimeExports.jsxs("div",{className:"max-w-screen-msm flex flex-col items-center gap-8 p-8",children:[jsxRuntimeExports.jsxs(ErrorBoundary,{fallback:jsxRuntimeExports.jsx("p",{children:"Something wrong"}),children:[jsxRuntimeExports.jsx(MioImage,{expression:"sad",className:"size-[200px] msm:size-[300px]"}),jsxRuntimeExports.jsx(MarkdownRenderer,{className:"prose prose-sm prose-neutral dark:prose-invert",children:it("common:app-crashed")}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[location.pathname!=="/"&&jsxRuntimeExports.jsx(UILink,{href:"/",variant:"outlined",className:"rounded-md",children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:homepage"})}),jsxRuntimeExports.jsx(UIButton$1,{variant:"outlined",onPress:()=>location.reload(),children:jsxRuntimeExports.jsx(Text,{i18nKey:"common:reload"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"max-w-full flex items-start gap-2 p-4 text-xs bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg",children:[jsxRuntimeExports.jsx(fluentErrorCircle20Regular,{className:"flex-none -my-0.5 -ml-1 inline-block size-5 text-neutral-500"}),jsxRuntimeExports.jsx("p",{className:"flex-1 font-mono",children:Qe})]})]})})}const ALLOWED_IMAGE_STITCHING_MODES=["kiss","hug"],eventRoutes={[GrowthEventName.SummerEvent2025]:"summer-2025",[GrowthEventName.AugustEvent2025]:"august-2025"};function mapEventRouteToEventName(He){switch(He){case eventRoutes[GrowthEventName.SummerEvent2025]:return GrowthEventName.SummerEvent2025;case eventRoutes[GrowthEventName.AugustEvent2025]:return GrowthEventName.AugustEvent2025}}function mapEventNameToComponent(He){switch(He){case GrowthEventName.SummerEvent2025:return reactExports.lazy(()=>__vitePreload(()=>import("./EventPage-zZC1W6VE.js"),__vite__mapDeps([30,5,3,4,1,31,2,6,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51]),import.meta.url));case GrowthEventName.AugustEvent2025:return reactExports.lazy(()=>__vitePreload(()=>import("./index-Cbqhs0-u.js"),__vite__mapDeps([52,5,3,4,1,41,34,35,32,33,53,2,6,31,54,55,56,49,50,36,44,38,37,42,40,43,45,46,47,48,57]),import.meta.url))}}function UserInfoTracker(){const{data:He}=useUserInfo(),{data:{membership:Qe,subscription:it}={},loading:lt}=useMyMembership(),{data:ut}=useMyQuota();return reactExports.useEffect(()=>{if(!lt)if(Qe?.tier!=null&&it?.interval!=null&&it.status===UserSubscriptionStatus.active){const dt=`${it.interval.toLowerCase()}-plan-${Qe.tier}`,xt=it.endAt?defaultDayjs.duration(defaultDayjs(it.endAt).diff(defaultDayjs())).days():"none";trackerSetUserProperties({lastPlan:dt,plan:dt,membershipLeft:xt.toString()})}else trackerSetUserProperties({plan:"free",membershipLeft:"none"})},[Qe?.tier,it?.endAt,it?.interval,lt]),reactExports.useEffect(()=>{He&&(trackerSetUserId(He.id),trackerSetUserProperties({followerCount:He.followerCount,followingCount:He.followingCount}))},[He?.followerCount,He?.followingCount,He?.id]),reactExports.useEffect(()=>{He&&He.isAdmin&&trackerSetUserProperties({isAdmin:He.isAdmin})},[He?.isAdmin]),reactExports.useEffect(()=>{ut!=null&&trackerSetUserProperties({creditsLeft:ut})},[ut]),reactExports.useEffect(()=>{trackerSetUserProperties({user_agent:navigator.userAgent})},[]),null}function UserPreferencesTracker(){const{data:He,loading:Qe}=useMyPreferences();return reactExports.useEffect(()=>{Qe||trackerSetUserProperties({showNsfw:He?.showNsfw,blurNsfw:He?.blurNsfw,ageVerificationStatus:He?.ageVerificationStatus===AgeVerificationStatus$1.Over18})},[He?.showNsfw,He?.blurNsfw,He?.ageVerificationStatus,Qe]),null}function UserPropertiesTracker(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(UserInfoTracker,{}),jsxRuntimeExports.jsx(UserPreferencesTracker,{})]})}const Root=()=>(useInitialQueryStringHandler(),useAutoTrackPageView(),reactExports.useEffect(()=>{endEventGroup(!0)},[]),useOpenDitModelReleaseFeedbackDialogEffect(),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DefaultMetaCanonicalURL,{}),jsxRuntimeExports.jsx(NavigationListener,{}),jsxRuntimeExports.jsx(DynamicCreateElementContainer,{children:jsxRuntimeExports.jsx(Outlet,{})}),jsxRuntimeExports.jsx(UserPropertiesTracker,{}),jsxRuntimeExports.jsx(IntercomController,{}),jsxRuntimeExports.jsx(NavigateToUserRevival,{})]}));function NavigationListener(){const He={},Qe=useMatches();for(const it of Qe){const lt=it.handle;lt.hideMembershipBanner!=null&&(He.hideMembershipBanner=lt.hideMembershipBanner),lt.hideAppFooter!=null&&(He.hideAppFooter=lt.hideAppFooter)}return setHeaderBanner(!He.hideMembershipBanner),setFooterDisplay(!He.hideAppFooter),null}function NavigateToUserRevival(){return useUserIsRevivable()?jsxRuntimeExports.jsx(Navigate,{to:"/user-revival"}):null}async function passProps(He,Qe){const it=await He;return{...it,Component:void 0,element:jsxRuntimeExports.jsx(it.Component,{...Qe})}}const routes=[{handle:{name:"root"},errorElement:jsxRuntimeExports.jsx(ErrorPage,{}),element:jsxRuntimeExports.jsx(Root,{}),children:[{handle:{name:"error"},path:"error",element:jsxRuntimeExports.jsx(ErrorPage,{})},{handle:{name:"login",track:{scene:"login"}},path:"login",lazy:()=>passProps(__vitePreload(()=>import("./SignPage-CV5cZKBK.js"),__vite__mapDeps([58,5,3,4,1,6,36,2,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url),{isLogin:!0})},{handle:{name:"sign-up",track:{scene:"sign-up"}},path:"sign-up",lazy:()=>__vitePreload(()=>import("./SignPage-CV5cZKBK.js"),__vite__mapDeps([58,5,3,4,1,6,36,2,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"verify-email"},path:"verify-email",lazy:()=>__vitePreload(()=>import("./VerifyEmail-CAdG--yM.js"),__vite__mapDeps([59,5,3,4,1,34,35,6,60,61,2,36,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"reset-password"},path:"reset-password",lazy:()=>__vitePreload(()=>import("./ResetPassword-DD44OLQE.js"),__vite__mapDeps([62,5,3,4,1,61,2,6,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"forget-password/reset"},path:"forget-password/reset",lazy:()=>passProps(__vitePreload(()=>import("./ResetPassword-DD44OLQE.js"),__vite__mapDeps([62,5,3,4,1,61,2,6,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url),{isForgetPassword:!0})},{handle:{name:"change-email"},path:"change-email",lazy:()=>__vitePreload(()=>import("./ChangeEmail-CVKJWKwK.js"),__vite__mapDeps([63,5,3,4,1,61,2,6,34,35,36,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"forget-password"},path:"forget-password",lazy:()=>__vitePreload(()=>import("./ForgetPassword-Bw4hDF-v.js"),__vite__mapDeps([64,5,3,4,1,2,6,61,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"user-revival"},path:"user-revival",lazy:()=>__vitePreload(()=>import("./UserRevivalPage-BEMIEgIj.js"),__vite__mapDeps([65,5,3,4,1,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"app-layout"},lazy:()=>__vitePreload(()=>import("./index-Ds8jOqME.js"),__vite__mapDeps([66,5,3,4,1,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url),children:[{handle:{name:"home",track:{scene:"home"}},path:"",lazy:()=>__vitePreload(()=>import("./HomePageWrapper-BPtgAhQv.js"),__vite__mapDeps([67,5,3,4,1,68,6,2,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"redeem"},path:"redeem",lazy:()=>__vitePreload(()=>import("./CodeRedeem-DhkeZqJ3.js"),__vite__mapDeps([69,5,3,4,1,6,36,2,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"bot/discord/landing"},path:"bot/discord/landing",lazy:()=>__vitePreload(()=>import("./DiscordBotEntrypoint-lsDasrgT.js"),__vite__mapDeps([70,5,3,4,1,2,6,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"profile/edit"},path:"profile/edit",lazy:()=>__vitePreload(()=>import("./ProfileEditPage-BFY2U6kd.js"),__vite__mapDeps([71,5,3,4,1,36,2,6,33,34,35,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url),children:[{handle:{name:"profile/edit/basic",track:{scene:"profile-edit",section:"basic"}},path:"basic",lazy:()=>__vitePreload(()=>import("./BasicProfile-Iq2K3Os8.js"),__vite__mapDeps([72,5,3,4,1,73,6,2,36,74,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"profile/edit/accounts",track:{scene:"profile-edit",section:"accounts"}},path:"accounts",lazy:()=>__vitePreload(()=>import("./Accounts-TrwfNUwO.js"),__vite__mapDeps([75,5,3,4,1,34,35,74,6,36,2,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"profile/edit/api",track:{scene:"profile-edit",section:"api"}},path:"api",lazy:()=>__vitePreload(()=>import("./ApiPlatform-9qvmRv0B.js"),__vite__mapDeps([76,5,3,4,1,36,2,6,77,78,74,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"profile/edit/security",track:{scene:"profile-edit",section:"security"}},path:"security",lazy:()=>__vitePreload(()=>import("./AccountSecurity-DcUY3l1S.js"),__vite__mapDeps([79,5,3,4,1,77,6,74,2,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"profile/edit/notification",track:{scene:"profile-edit",section:"notification"}},path:"notification",lazy:()=>__vitePreload(()=>import("./Notification-B01AvCtt.js"),__vite__mapDeps([80,5,3,4,1,74,6,2,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"profile/edit/safety",track:{scene:"profile-edit",section:"content"}},path:"safety",lazy:()=>__vitePreload(()=>import("./ContentSettings-hE-BLOTH.js"),__vite__mapDeps([81,5,3,4,1,6,2,34,35,74,36,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"profile/edit/misc",track:{scene:"profile-edit",section:"misc"}},path:"misc",lazy:()=>__vitePreload(()=>import("./MiscSettings-CGeKiSQp.js"),__vite__mapDeps([82,5,3,4,1,34,35,74,6,36,2,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{path:"",handle:{name:"profile/edit/"},loader:({request:He})=>createRedirect(He,"/profile/edit/basic")}]},{handle:{name:"user-referral",track:{scene:"user-referral"}},path:"user-referral",lazy:()=>__vitePreload(()=>import("./UserReferralPage-Cetrk9bt.js"),__vite__mapDeps([83,5,3,4,1,84,6,2,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"referral"},path:"referral",lazy:()=>__vitePreload(()=>import("./ReferralOnboardingPage-DcUBIgk0.js"),__vite__mapDeps([85,5,3,4,1,36,2,6,86,87,34,35,88,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"submit/upload",track:{scene:"upload-artwork"}},path:"submit/upload",lazy:()=>__vitePreload(()=>import("./ArtworkSubmitUploadPage-mUHQ2zon.js"),__vite__mapDeps([89,5,3,4,1,36,2,6,90,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"artwork-home"},path:"artworks",loader:()=>redirect("/")},{handle:{name:"artwork-detail",track:{scene:"artwork-detail"}},path:"artwork/:idSlug",lazy:()=>__vitePreload(()=>import("./ArtworkDetailPage-D5V4rIhb.js"),__vite__mapDeps([91,5,3,4,1,68,6,36,2,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"video-artwork-detail",track:{scene:"artwork-detail"}},path:"video/:idSlug",lazy:()=>__vitePreload(()=>import("./ArtworkDetailPage-D5V4rIhb.js"),__vite__mapDeps([91,5,3,4,1,68,6,36,2,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"artwork-relevant-artworks",track:{scene:"artwork-relevant"}},path:"artwork/:id/relevant",lazy:()=>__vitePreload(()=>import("./ArtworkRelevantArtworksPage-CNh7AKZ1.js"),__vite__mapDeps([92,5,3,4,1,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"tags-home"},path:"tags",lazy:()=>__vitePreload(()=>import("./TagListPage-D8IYDc4a.js"),__vite__mapDeps([93,5,3,4,1,6,2,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"artwork/tags"},path:"artwork/tags/:tag?",lazy:()=>passProps(__vitePreload(()=>import("./TagPage-UW8Er3a2.js"),__vite__mapDeps([94,5,3,4,1,95,6,33,96,36,2,34,35,97,98,99,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url),{type:"artwork"}),loader:({params:He})=>He.tag?null:redirect("/")},{handle:{name:"model-detail",track:{scene:"model-detail"}},path:"model/:modelIdSlug/:versionId?",lazy:()=>__vitePreload(()=>import("./ModelDetailPage-DYGQuOUP.js"),__vite__mapDeps([100,5,3,4,1,68,6,36,2,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"model/tags"},path:"model/tags/:tag?",lazy:()=>passProps(__vitePreload(()=>import("./TagPage-UW8Er3a2.js"),__vite__mapDeps([94,5,3,4,1,95,6,33,96,36,2,34,35,97,98,99,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url),{type:"model"}),loader:({params:He})=>He.tag?null:redirect("/")},{handle:{name:"market",track:{scene:"models"}},path:"market",lazy:()=>__vitePreload(()=>import("./MarketPage-pZFadfWN.js"),__vite__mapDeps([97,5,3,4,1,95,6,33,96,36,2,34,35,98,99,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"worlds"},path:"worlds",lazy:()=>__vitePreload(()=>import("./WorldsPage-D8VqTcBK.js"),__vite__mapDeps([101,5,3,4,1,36,2,6,102,34,35,99,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"world-detail"},path:"world/:id",lazy:()=>__vitePreload(()=>import("./WorldDetailPage-CGiMb4HW.js"),__vite__mapDeps([103,5,3,4,1,102,34,35,6,104,36,2,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"character-detail"},path:"character/:id",lazy:()=>__vitePreload(()=>import("./CharacterDetailPage-Cwne6wER.js"),__vite__mapDeps([105,5,3,4,1,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"market/submit"},path:"market/submit",lazy:()=>__vitePreload(()=>import("./ModelSubmitPage-rA_ODDYA.js"),__vite__mapDeps([106,5,3,4,1,34,35,6,2,33,36,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url),children:[{handle:{name:"market/submit/step-1"},path:"step-1",lazy:()=>__vitePreload(()=>import("./ModelUploadStepOne-gTml6LXE.js"),__vite__mapDeps([107,5,3,4,1,36,2,6,108,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"market/submit/step-2"},path:"step-2",lazy:()=>__vitePreload(()=>import("./ModelUploadStepTwo-XG3YzzgG.js"),__vite__mapDeps([109,5,3,4,1,36,2,6,108,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"market/submit/step-3"},path:"step-3",lazy:()=>__vitePreload(()=>import("./ModelUploadStepThree-CxObHiWC.js"),__vite__mapDeps([110,5,3,4,1,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)}]},{handle:{name:"ranking"},path:"ranking/:type?/:filterType?",lazy:()=>__vitePreload(()=>import("./RankingPage-DJAzgPg2.js"),__vite__mapDeps([111,5,3,4,1,36,2,6,96,34,35,33,112,49,50,113,42,31,40,43,44,45,46,47,48]),import.meta.url),loader:({request:He,params:Qe})=>{const it=Object.values(RankingContentType),lt=Object.values(RankingRangeType);let{type:ut,filterType:dt}=Qe;return ut&&!it.includes(ut)&&(ut=void 0),dt&&!lt.includes(dt)&&(dt=void 0),ut&&dt?null:createRedirect(He,`/ranking/${ut??RankingContentType.Artwork}/${dt??RankingRangeType.Today}`)}},{handle:{name:"search"},path:"search",lazy:()=>__vitePreload(()=>import("./SearchResultPage-C0w5BJlj.js"),__vite__mapDeps([114,5,3,4,1,36,2,6,95,33,96,34,35,115,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"train-lora",track:{scene:"train-lora"}},path:"train-lora",lazy:()=>__vitePreload(()=>import("./TrainLoraPage-BXeyTroo.js"),__vite__mapDeps([116,5,3,4,1,34,35,55,117,118,6,2,33,98,36,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"user-rank",hideAppFooter:!0},path:"user-rank",lazy:()=>__vitePreload(()=>import("./UserRankPage-Diw15Tu1.js"),__vite__mapDeps([119,5,3,4,1,2,6,31,34,35,118,33,36,42,40,43,44,45,46,47,48,49,50]),import.meta.url),loader:({request:He})=>createRedirect(He,"/")},{handle:{name:"membership-shortcut"},path:"membership",loader:()=>redirect("/membership/plans")},{handle:{name:"membership/plans",track:{scene:"membership"},hideMembershipBanner:!0},path:"membership/plans",lazy:()=>__vitePreload(()=>import("./MembershipPlansPage-CAYfpOGB.js"),__vite__mapDeps([120,5,3,4,1,31,2,6,34,35,36,53,86,87,33,42,40,43,44,45,46,47,48,49,50,121]),import.meta.url),loader:({request:He})=>{const Qe=new URL(He.url),it=Qe.searchParams.get("mode");return Qe.searchParams.delete("mode"),it?it==="packs"?(track("legacy_route",{pathname:"/membership/plans?mode=packs"}),Qe.pathname="/membership/credit-packs",redirect(Qe.href)):redirect(Qe.href):null}},{handle:{name:"membership/credit-packs",track:{scene:"credit-packs"},hideMembershipBanner:!0},path:"membership/credit-packs",lazy:()=>__vitePreload(()=>import("./MembershipPlansPage-CAYfpOGB.js"),__vite__mapDeps([120,5,3,4,1,31,2,6,34,35,36,53,86,87,33,42,40,43,44,45,46,47,48,49,50,121]),import.meta.url)},{handle:{name:"membership/current",hideMembershipBanner:!0},path:"membership/current",loader:({request:He})=>(track("legacy_route",{pathname:"/membership/current"}),createRedirect(He,"/me/credits"))},{handle:{name:"payment/subscription/landing",hideMembershipBanner:!0},path:"payment/subscription/landing",lazy:()=>__vitePreload(()=>import("./SubscriptionLanding-DVyhbKa7.js"),__vite__mapDeps([122,5,3,4,1,39,123,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"payment/result",hideMembershipBanner:!0},path:"payment/subscription/result",lazy:()=>__vitePreload(()=>import("./SubscriptionUpdateResult-Cx_onueK.js"),__vite__mapDeps([124,5,3,4,1,123,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"payment/landing",hideMembershipBanner:!0},path:"payment/landing",lazy:()=>__vitePreload(()=>import("./PaymentLanding-CZ195HHm.js"),__vite__mapDeps([125,5,3,4,1,39,123,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"bookmark-artwork"},path:":usernameRaw/collection/:collectionId",lazy:()=>__vitePreload(()=>import("./UserProfilePage-BCBnIA8O.js"),__vite__mapDeps([126,5,3,4,1,115,36,2,6,33,104,102,34,35,47,96,90,127,31,56,49,50,98,60,128,129,68,73,42,40,43,44,45,46,48,130]),import.meta.url)},{handle:{name:"profile",track:({params:He})=>$$3(He).with({tab:"tasks"},()=>({scene:"task-history",section:$$3(He.subTab).with("favorites",()=>"favorite").otherwise(()=>"all")})).with({tab:"credits"},()=>({scene:"member-credit-log"})).with({tab:"following"},()=>({scene:"following"})).with({tab:"follower"},()=>({scene:"followers"})).with({tab:"decoration"},()=>({scene:"decoration",section:He.subTab})).otherwise(()=>({}))},path:":usernameRaw/:tab?/:subTab?",lazy:()=>__vitePreload(()=>import("./UserProfilePage-BCBnIA8O.js"),__vite__mapDeps([126,5,3,4,1,115,36,2,6,33,104,102,34,35,47,96,90,127,31,56,49,50,98,60,128,129,68,73,42,40,43,44,45,46,48,130]),import.meta.url),loader:({request:He,params:Qe})=>$$3(Qe).with({usernameRaw:N$4.not(N$4.string.startsWith("@"))},()=>createRedirect(He,"/")).with({tab:"likes",subTab:ProfilePageTab.likedSdv1Model},()=>(track("legacy_route",{pathname:`/@:username/likes/${ProfilePageTab.likedSdv1Model}`}),createRedirect(He,`/${Qe.usernameRaw}/${Qe.tab}/${ProfilePageTab.likedModel}`))).with({tab:"likes",subTab:ProfilePageTab.likedLoraModel},()=>(track("legacy_route",{pathname:`/@:username/likes/${ProfilePageTab.likedLoraModel}`}),createRedirect(He,`/${Qe.usernameRaw}/${Qe.tab}/${ProfilePageTab.likedLora}`))).with({tab:ProfilePageTab.decorations,subTab:N$4.nullish.optional()},()=>(track("legacy_route",{pathname:"/@:username/decorations"}),createRedirect(He,`/${Qe.usernameRaw}/${Qe.tab}/${DecorationPageTab.Badge}`))).otherwise(()=>null)},{handle:{name:"me/*"},path:"me/*",lazy:()=>__vitePreload(()=>import("./MeRoute-CeVz45ST.js"),__vite__mapDeps([131,5,3,4,1,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"news-list",track:{scene:"news",section:"list"}},path:"news",lazy:()=>__vitePreload(()=>import("./NewsListPage-gdIwKXBs.js"),__vite__mapDeps([132,5,3,4,1,36,2,6,133,34,35,134,33,42,31,40,43,44,45,46,47,48,49,50,135]),import.meta.url)},{handle:{name:"news-detail",track:({params:He})=>({scene:"news",section:He.id})},path:"news/:id",lazy:()=>__vitePreload(()=>import("./NewsDetailPage-DHH91MtH.js"),__vite__mapDeps([136,5,3,4,1,36,2,6,137,40,34,35,133,33,42,31,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"contest",track:({params:He})=>({scene:"contest",section:He.id})},path:"contest/:id?",lazy:()=>__vitePreload(()=>import("./ContestPage-D7pDN-a6.js"),__vite__mapDeps([138,5,3,4,1,34,35,6,36,2,112,49,50,113,33,42,31,40,43,44,45,46,47,48]),import.meta.url)},{handle:{name:"events",track:({params:He})=>({scene:"event",section:He.eventRoute})},path:"event/:eventRoute",lazy:()=>__vitePreload(()=>import("./EventsPage-CblmSIHf.js"),__vite__mapDeps([139,5,3,4,1,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url),loader:({params:He})=>He.eventRoute&&mapEventRouteToEventName(He.eventRoute)?null:redirect("/")}]},{handle:{name:"generator"},path:"generator",loader:({request:He})=>createRedirect(He,"/pixai")},{handle:{name:"pixai",track:{scene:"generator-image"},hideMembershipBanner:!0},path:"pixai",lazy:()=>__vitePreload(()=>import("./MultiColumnSubmitPage-DYKH2et2.js"),__vite__mapDeps([140,5,3,4,1,31,2,6,141,47,36,33,34,35,117,118,37,142,143,46,28,134,144,98,145,77,42,40,43,44,45,48,49,50]),import.meta.url)},{handle:{name:"generator/image/:tab",track:({params:He})=>({scene:$$3(He.tab).with("editor",()=>"generator-edit").with("animation",()=>"generator-animation").with("enhancement",()=>"generator-enhance").otherwise(()=>{})}),hideMembershipBanner:!0},path:"generator/image/:tab",lazy:()=>__vitePreload(()=>import("./MultiColumnSubmitPage-DYKH2et2.js"),__vite__mapDeps([140,5,3,4,1,31,2,6,141,47,36,33,34,35,117,118,37,142,143,46,28,134,144,98,145,77,42,40,43,44,45,48,49,50]),import.meta.url),loader:({request:He,params:Qe})=>Qe.tab&&!ALLOWED_GENERATOR_TABS.includes(Qe.tab)?createRedirect(He,"/pixai"):null},{handle:{name:"generator/realtime",track:{scene:"realtime"},hideMembershipBanner:!0},path:"generator/realtime/:mode?",lazy:()=>__vitePreload(()=>import("./LCMRealtime-CjIgWAXP.js"),__vite__mapDeps([146,5,3,4,1,143,46,2,6,28,134,35,141,47,36,33,144,34,42,31,40,43,44,45,48,49,50]),import.meta.url),loader:({request:He,params:Qe})=>Qe.mode!=="drawing"?createRedirect(He,"/generator/realtime/drawing"):null},{handle:{name:"generator/workflow"},path:"generator/workflow/:workflowId?",lazy:()=>__vitePreload(()=>import("./WorkflowGeneratorPage-Bs0INI1F.js").then(He=>He.W),__vite__mapDeps([147,5,3,4,1,47,2,6,31,37,145,98,36,34,35,33,78,128,38,129]),import.meta.url)},{handle:{name:"generator/agent"},path:"generator/agent",lazy:()=>__vitePreload(()=>import("./AgentGeneratorPage-Dplqby9n.js"),__vite__mapDeps([148,5,3,4,1,2,6,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"generator/upscaler",track:{scene:"upscale"}},path:"generator/upscaler",lazy:()=>__vitePreload(()=>import("./UpscalePage-Bm0T08hh.js"),__vite__mapDeps([149,5,3,4,1,141,47,2,6,36,33,34,35,42,31,40,43,44,45,46,48,49,50]),import.meta.url)},{handle:{name:"generator/image-stitching"},path:"generator/image-stitching",loader:({request:He})=>(track("legacy_route",{pathname:"/generator/image-stitching"}),createRedirect(He,"/generator/stitching/kiss"))},{handle:{name:"generator/stitching/:mode",track:({params:He})=>({scene:"image-stitching",section:He.mode})},path:"generator/stitching/:mode",lazy:()=>__vitePreload(()=>import("./ImageStitchPage-Dv1493iR.js"),__vite__mapDeps([150,5,3,4,1,31,2,6,141,47,36,33,151,34,35,42,40,43,44,45,46,48,49,50]),import.meta.url),loader:({request:He,params:Qe})=>{const it=ALLOWED_IMAGE_STITCHING_MODES;return Qe.mode&&!it.includes(Qe.mode)?createRedirect(He,"/generator/stitching/kiss"):null}},{handle:{name:"generator/preset",track:({params:He})=>({scene:"chat-editing-preset",section:He.sceneId})},path:"generator/preset/:sceneId?",lazy:()=>__vitePreload(()=>import("./ChatEditingPresetPage-B0SgH-KA.js"),__vite__mapDeps([152,5,3,4,1,31,2,6,37,141,47,36,33,34,35,42,40,43,44,45,46,48,49,50]),import.meta.url)},{handle:{name:"generator/chat-editing",track:{scene:"chat-editing",section:"preview"}},path:"generator/chat-editing",lazy:()=>__vitePreload(()=>import("./ConversationalEditPage-DDIqJQBf.js"),__vite__mapDeps([153,5,3,4,1,36,2,6,31,33,34,35,54,129,142,55,141,47,42,40,43,44,45,46,48,49,50]),import.meta.url)},{handle:{name:"generator/chat-editing/creator"},path:"generator/chat-editing/creator",lazy:()=>__vitePreload(()=>import("./ConversationalEditPage-DDIqJQBf.js"),__vite__mapDeps([153,5,3,4,1,36,2,6,31,33,34,35,54,129,142,55,141,47,42,40,43,44,45,46,48,49,50]),import.meta.url)},{handle:{name:"generator/chat-editing/workspace/:workspaceId",track:{scene:"chat-editing",section:"panel"}},path:"generator/chat-editing/workspace/:workspaceId",lazy:()=>__vitePreload(()=>import("./ConversationalEditPage-DDIqJQBf.js"),__vite__mapDeps([153,5,3,4,1,36,2,6,31,33,34,35,54,129,142,55,141,47,42,40,43,44,45,46,48,49,50]),import.meta.url)},{handle:{name:"terms-layout"},lazy:()=>__vitePreload(()=>import("./TermsLayout-CWjdGcMu.js"),__vite__mapDeps([154,5,3,4,1,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url),children:[{handle:{name:"terms"},path:"terms",lazy:()=>__vitePreload(()=>import("./Terms-DQljyAu-.js"),__vite__mapDeps([155,5,3,4,1,156,6,2,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"privacy"},path:"privacy",lazy:()=>__vitePreload(()=>import("./Privacy-DZGOLhRm.js"),__vite__mapDeps([157,5,3,4,1,6,2,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"legal-for-payment"},path:"legal",lazy:()=>__vitePreload(()=>import("./LegalForPayment-Dt5mzLE1.js"),__vite__mapDeps([158,5,3,4,1,2,6,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"copyright"},path:"copyright",lazy:()=>__vitePreload(()=>import("./CopyrightPolicyPage-B0urCN5k.js"),__vite__mapDeps([159,5,3,4,1,6,2,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"feedback"},path:"feedback",lazy:()=>__vitePreload(()=>import("./Feedback-Ch5kQkNw.js"),__vite__mapDeps([160,5,3,4,1,156,34,35,6,2,36,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)}]},{handle:{name:"embedded-layout"},lazy:()=>__vitePreload(()=>import("./EmbeddedPage-By3spNz2.js"),__vite__mapDeps([161,5,3,4,1,41,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url),children:[{handle:{name:"embedded-event-page",track:({params:He})=>({scene:"event",section:He.eventRoute})},path:"embedded/event/:eventRoute",lazy:()=>__vitePreload(()=>import("./EmbeddedEventPage-DPeP2oLI.js"),__vite__mapDeps([162,5,3,4,1,36,2,6,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url),loader:({params:He})=>He.eventRoute&&mapEventRouteToEventName(He.eventRoute)?null:redirect("/")},{handle:{name:"embedded-referral-page"},path:"embedded/user-referral",lazy:()=>__vitePreload(()=>import("./EmbeddedReferralPage-YywyMZYf.js"),__vite__mapDeps([163,5,3,4,1,84,6,2,36,34,35,33,42,31,40,43,44,45,46,47,48,49,50]),import.meta.url)},{handle:{name:"embedded-chat-editing"},path:"embedded/chat-editing",lazy:()=>__vitePreload(()=>import("./EmbeddedConversationalEditPage-QcQZqjJG.js"),__vite__mapDeps([164,5,3,4,1,41,34,35,153,36,2,6,31,33,54,129,142,55,141,47,42,40,43,44,45,46,48,49,50]),import.meta.url)},{handle:{name:"embedded-chat-editing-creator"},path:"embedded/chat-editing/creator",lazy:()=>__vitePreload(()=>import("./EmbeddedConversationalEditPage-QcQZqjJG.js"),__vite__mapDeps([164,5,3,4,1,41,34,35,153,36,2,6,31,33,54,129,142,55,141,47,42,40,43,44,45,46,48,49,50]),import.meta.url)},{handle:{name:"embedded-chat-editing-workspace"},path:"embedded/chat-editing/workspace/:workspaceId",lazy:()=>__vitePreload(()=>import("./EmbeddedConversationalEditPage-QcQZqjJG.js"),__vite__mapDeps([164,5,3,4,1,41,34,35,153,36,2,6,31,33,54,129,142,55,141,47,42,40,43,44,45,46,48,49,50]),import.meta.url)},{handle:{name:"embedded-news"},path:"embedded/news/:id",lazy:()=>__vitePreload(()=>import("./EmbeddedNewsPage-DduqRqca.js"),__vite__mapDeps([165,5,3,4,1,137,40,2,6,34,35,36,33,42,31,43,44,45,46,47,48,49,50]),import.meta.url)}]},{handle:{name:"tasks"},path:"tasks",loader:({request:He})=>(track("legacy_route",{pathname:"/tasks"}),createRedirect(He,"/me/tasks"))},{handle:{name:"realtime"},path:"realtime",loader:({request:He})=>(track("legacy_route",{pathname:"/realtime"}),createRedirect(He,"/generator/realtime"))},{handle:{name:"submit"},path:"submit",loader:({request:He})=>(track("legacy_route",{pathname:"/submit"}),createRedirect(He,"/generator"))},{handle:{name:"submit/gen"},path:"submit/gen",loader:({request:He})=>(track("legacy_route",{pathname:"/submit/gen"}),createRedirect(He,"/pixai",{mode:"gen"}))},{handle:{name:"submit/fill"},path:"submit/fill",loader:({request:He})=>(track("legacy_route",{pathname:"/submit/fill"}),createRedirect(He,"/pixai",{mode:"fill"}))},{handle:{name:"catch-all"},path:"*",loader:()=>redirect("/")}]}],router=createBrowserRouter(routes,{basename:resolveLangBasename(),future:{v7_relativeSplatPath:!0}});function resolveLangBasename(){const{path:He,resolved:Qe}=resolveLocaleFromUrl();if(Qe){const it=new URL(window.location.href);return it.pathname=withBase(withoutBase(it.pathname,`/${He}`),`/${Qe}`),window.history.replaceState(null,"",it.href),`/${Qe}`}}function createRedirect(He,Qe,it={}){const lt=new URL(He.url);lt.pathname=Qe;for(const[ut,dt]of Object.entries(it))lt.searchParams.set(ut,dt);return redirect(lt.href)}const refetchQueries=He=>{baseApolloClient.refetchQueries({include:"active",onQueryUpdated:Qe=>{const it=Qe.options.context;return He==="focus"?it?.refetchOnFocus??defaultContext.refetchOnFocus:He==="online"?it?.refetchOnReconnect??defaultContext.refetchOnReconnect:!1}})};function ApolloClientProvider(He){return useWindowEvent("focus",()=>refetchQueries("focus")),useWindowEvent("online",()=>refetchQueries("online")),jsxRuntimeExports.jsx(ApolloProvider,{client:baseApolloClient,children:He.children})}const setVisibleDimensions=()=>{if(typeof window>"u")return;const He="visible-height",Qe="visible-width",it=()=>{document.documentElement.style.setProperty("--"+He,window.innerHeight+"px"),document.documentElement.style.setProperty("--"+Qe,window.innerWidth+"px")};it(),window.addEventListener("resize",it)},CRISP_TOKEN_ID_KEY=`${getApiUrl()}:crisp-token-id`;function cleanupObsoletedLocalStorageItems(){localStorage.removeItem("2506-enable-dit-model-hires"),localStorage.removeItem(`${PREFERENCE_STORAGE_KEY_PREFIX}allowPromptHelperSwitchForTsubaki`),localStorage.removeItem(CRISP_TOKEN_ID_KEY),localStorage.removeItem("exp:2506-enable-chat-editing")}setVisibleDimensions();cleanupObsoletedLocalStorageItems();function App(){const He=jsxRuntimeExports.jsx(LoadingPage,{fullscreen:!0});return jsxRuntimeExports.jsx(ApolloClientProvider,{children:jsxRuntimeExports.jsx(SWRConfig,{value:globalSWRConfig,children:jsxRuntimeExports.jsxs(UserPreferenceProvider,{children:[jsxRuntimeExports.jsx(SessionReplayExperiment,{}),jsxRuntimeExports.jsx(StyledEngineProvider,{children:jsxRuntimeExports.jsx(ColorModeProvider,{children:jsxRuntimeExports.jsx(IntercomMessengerProvider,{children:jsxRuntimeExports.jsxs(HelmetProvider,{children:[jsxRuntimeExports.jsx(DefaultHelmetTags,{}),jsxRuntimeExports.jsxs(reactExports.Suspense,{fallback:He,children:[jsxRuntimeExports.jsx(RouterProvider,{router,fallbackElement:He,future:{v7_startTransition:!0}}),reactDomExports.createPortal(jsxRuntimeExports.jsx(ToastContainer,{className:"z-[1400]"}),document.body),jsxRuntimeExports.jsx(DebugWidget,{}),jsxRuntimeExports.jsx(DayjsLocaleEffectApplier,{}),jsxRuntimeExports.jsx(MembershipPurplePinkGradient,{}),jsxRuntimeExports.jsx(UserInfoChangeHandler,{})]})]})})})})]})})})}function applyDebugSettingsFromQs(){const He=window.location.href,Qe=new URL(He),it=Qe.searchParams.get("withAPIURL"),lt=Qe.searchParams.get("enableDebug");let ut=!1;lt&&(lt==="true"||lt==="1"?localStorage.setItem("enable-debug","true"):localStorage.removeItem("enable-debug"),ut=!0),it&&(localStorage.setItem("api-base-url",JSON.stringify(decodeURIComponent(it))),ut=!0),ut&&(Qe.searchParams.delete("withAPIURL"),Qe.searchParams.delete("enableDebug"),window.history.replaceState({},"",Qe.toString()),window.location.reload())}const disabledDefaultIntegrations=["GlobalHandlers","BrowserApiErrors"];init$1({enabled:config$1.isProd,dsn:config$1.sentryDsn,release:config$1.commitHash,sendDefaultPii:!0,integrations:function(He){return[...He.filter(it=>!disabledDefaultIntegrations.includes(it.name)),thirdPartyErrorFilterIntegration({filterKeys:["pixai-web-app-key"],behaviour:"drop-error-if-exclusively-contains-third-party-frames"})]},ignoreErrors:["top.GLOBALS","originalCreateNotification","canvas.contentDocument","MyApp_RemoveAllHighlights","http://tt.epicplay.com","Can't find variable: ZiteReader","jigsaw is not defined","ComboSearch is not defined","http://loading.retry.widdit.com/","atomicFindClose","fb_xd_fragment","bmi_SafeAddOnload","EBCallBackMessageReceived","conduitPage","Script error.","user cancelled","must be logged in to access this resource","You must be logged in to perform this action: me","Non-Error exception captured with keys","FirebaseError","required to use the Firebase SDK","Network Error","NetworkError","Failed to fetch","Request timeout","AxiosError","Load failed","Task listing rate limit exceeded","Unexpected EOF","Unable to preload CSS","Importing a module script failed","Event `Event` (type=error) captured as exception","error loading dynamically imported module","Failed to register a ServiceWorker",".subscribePersonalEvents(...).pipe is not a function","findLastIndex is not a function","findLast is not a function"],denyUrls:[/pagead\/js/i,/graph\.facebook\.com/i,/connect\.facebook\.net\/en_US\/all\.js/i,/eatdifferent\.com\.woopra-ns\.com/i,/static\.woopra\.com\/js\/woopra\.js/i,/extensions\//i,/^chrome:\/\//i,/127\.0\.0\.1:4001\/isrunning/i,/webappstoolbarba\.texthelp\.com\//i,/metrics\.itunes\.apple\.com\.edgesuite\.net\//i],sampleRate:1});enableMapSet();applyDebugSettingsFromQs();client$1.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));export{UIInput as $,AppLayout as A,BaseArtworkItemPreviewCard as B,Countdown as C,useDailyQuestsDialog as D,DefaultMetaTitle as E,ArtworkListPage as F,openSignModal as G,executeVerifyCreditCoupon as H,CustomHeroTitleWithDescription as I,redirectToOAuth as J,useMyPreferences as K,LoadingPage as L,MetaTags as M,NotLogin as N,getExperienceLevelWithIcons as O,Preloader as P,useForm as Q,isNotEmpty as R,Sign as S,Text as T,UIButton$1 as U,executeUpdateUserInfo as V,executeSetPreferences as W,trackerSetUserProperties as X,UIForm as Y,UIFormTextField as Z,UIFormLabel as _,useUserInfo as a,copy as a$,UIFormDescription as a0,UIFormRadioGroup as a1,UIRadio as a2,useGetUserProfiles as a3,executeSetProfiles as a4,UITextArea as a5,getErrorCode as a6,usePromoEmailPref as a7,useGetMyExternalProfiles as a8,dialogConfirm as a9,usePushPrefs as aA,useIsomorphicLayoutEffect as aB,uploadMedia as aC,userHasMembership as aD,icBaselineEdit as aE,openMembershipMoreCreditsModal as aF,getPublicUrl as aG,useCampaignAds as aH,useDisableAutoPromptHelperPref as aI,useTsubakiPromptHelperPref as aJ,TSUBAKI_PROMPT_HELPER_VALUE as aK,UIDialog as aL,useShowNsfw as aM,useBlurNsfw as aN,useAgeVerificationStatus as aO,dialog as aP,useLocalStorage as aQ,trackerLogout as aR,experimentLogout as aS,useMyMembership as aT,sleep as aU,useBreakpoint as aV,useGetMyReferralCode as aW,executeGenerateReferralCode as aX,updateGetMyReferralCode as aY,withQuery as aZ,joinURL as a_,executeUnlinkExternal as aa,UserCancelled as ab,LoadingIcon as ac,OAuthButton as ad,OAuthProviders as ae,useToken as af,useMe as ag,useMyRoles as ah,useMyAccessTokens as ai,client as aj,Empty as ak,ResponsiveDialog as al,mutateMyAccessTokens as am,mutateMyWebhooks as an,useMyWebhooks as ao,MarkdownRenderer as ap,useListMyMFAList as aq,dialogMFA as ar,executeSetupMFA as as,BaseCursorPaging as at,useMySessions as au,useSWR$1 as av,isPushEnabled as aw,refreshPushToken as ax,setDisablePush as ay,withdrawPushToken as az,useLoadingCallback as b,getTagPageMetaDescription as b$,UIDialogResponsive as b0,useDynamicConstants as b1,icRoundIosShare as b2,UITooltipHelpIcon as b3,useGetUserReferralLogs as b4,getBaseCursorPagingArgs as b5,translateOrderOptionToQueryOrderBy as b6,OrderOption as b7,UIDialogHeader as b8,UIDialogContent as b9,useObservable as bA,withoutTrailingSlash as bB,useGetArtworkWithTaskDetail as bC,slugify as bD,getArtworkTitle as bE,getArtworkMetaTitle as bF,getArtworkMetaDescription as bG,MetaDescription as bH,MetaThumbnail as bI,MetaOgUrl as bJ,getErrorMessage as bK,isAnimatedArtwork as bL,ArtworkDetailExperiment as bM,getThumbnailUrl as bN,getMediaUrl as bO,getArtworkAlt as bP,useGetArtwork as bQ,getArtworkRelevantMetaTitle as bR,getArtworkRelevantMetaDescription as bS,ArtworkRelevantArtworks as bT,useListTags as bU,TagGalleryItem as bV,createTagPageUrl as bW,useOrderState as bX,normalizeSearch as bY,useGenerationModels as bZ,getTagPageMetaTitle as b_,TablePaginationActionsWrapper as ba,useGetUserInfoById as bb,getUserDisplayName as bc,useGetMyReferrerId as bd,executeSetReferrer as be,UIDialogFooter as bf,getReferralCodeFromLocalStorage as bg,useGetReferralCodeInfo as bh,openRegisterOnboardingDialog as bi,HorizontalScrollable as bj,CreditMeter as bk,startEventGroup as bl,UILink as bm,fluentHome24Regular as bn,icOutlineColorLens as bo,riVideoAiLine as bp,MembershipIconCircled as bq,usePresetModels as br,ModelControlLabel as bs,ModelBadge as bt,shouldModelBeBlurred as bu,shouldArtworkBeBlurred as bv,getArtworkLink as bw,SubmitForm as bx,openShareArtworkDialog as by,BehaviorSubject as bz,executeVerifyEmail as c,useWorld as c$,TagGallery as c0,StatefulArtworkGrid as c1,OrderSelect as c2,createTimeRange as c3,icBaselineSearch as c4,icBaselineClear as c5,useInitialPageCursor as c6,getPosSeqAndFeedForModelListQuery as c7,useGenerationModelsInfinite as c8,$globalSearching as c9,twMerge as cA,icBaselineCancel as cB,parseModelUrl as cC,useGenerationModelByVersionId as cD,getCanonicalURL as cE,withoutHost as cF,getModelMetaTitle as cG,getModelMetaDescription as cH,isModelCoverWarned as cI,ModelDetail as cJ,AdaptiveWorldCharacterCard as cK,materialSymbolsChevronRight as cL,useLocalizedField as cM,WorldTagList as cN,UserLink as cO,ExpandableTextWithDialog as cP,WorldCharacterCard as cQ,formatQs as cR,usePaginatedData as cS,mdiBookmarkCheck as cT,DropdownMenu as cU,icBaselineAdminPanelSettings as cV,dialogInspection as cW,WorldInputForm as cX,opAction as cY,WorldCharacterDetailHeader as cZ,WorldCharacterCommentArea as c_,useEvent$1 as ca,inView as cb,InvisibleNextPage as cc,useRefreshCount as cd,useIsMobile as ce,ModelFilter as cf,ModelTypeToModelFilters as cg,ModelFiltersToModelType as ch,useGenerationModel as ci,getIncompleteTrainingTasksFromModel as cj,isUserLora as ck,isLoraCategoryNotSet as cl,MediaPreview$1 as cm,mingcuteLockFill as cn,mingcuteCheckFill as co,CardCornerDebugInfo as cp,createModelUrl as cq,TrainingTaskStatus as cr,dialogEditModel as cs,getModelTypeChipConfig as ct,getModelEarlyAccessChipConfig as cu,getModelLoraBaseModelChipsConfig as cv,isLora as cw,BaseLikeButton as cx,LikeHeart as cy,mutateGenerationModel as cz,NormalInput as d,noop$3 as d$,useArtworkWithWorldCharacter as d0,SmallWorldCharacterCard as d1,CharacterDetailWithId as d2,ExternalModelImporterContext as d3,useModelSubmitForm as d4,dialogModelRequestEdit as d5,ModelUploadContextProvider as d6,ExternalModelImporterProvider as d7,ModelUploadContext as d8,ModelSubmitFormProvider as d9,MediaSelectPreviewPanelItemsProgressContext as dA,icBaselineDeleteOutline as dB,useImageItemListCount as dC,TaskOutputGrid as dD,getImageThumbnailUrl as dE,useListGenerationModelsWithTrainingTaskInfinite as dF,createSWRForGQL as dG,useImageItemListIsNotEmpty as dH,useDynamicTrainLoraModels as dI,useGetMeWithQuotaForCurrency as dJ,useImageItemListValue as dK,executeCreateTrainingTask as dL,NewLabel as dM,icBaselineKeyboardArrowUp as dN,icBaselineKeyboardArrowDown as dO,QuotaCost as dP,isUserMultiLora as dQ,CircularSpinner as dR,createImageItemListStateAtom as dS,MediaSelectPreviewPanelItemListContext as dT,MediaSelectPreviewPanelUploadProvider as dU,useImageItemList as dV,useDropzone as dW,icRoundPlus as dX,useGetMedia as dY,eachOfLimit$2 as dZ,updateGetMedia as d_,ModelInfoForm as da,ModelVersionForm as db,ModelAssetForm as dc,RankingContentType as dd,RankingRangeType as de,getRankingPageTitle as df,useAsync as dg,fetchListArtworks as dh,ArtworkGrid as di,getRankingPageGridTitle as dj,StyledSelect as dk,getDayToDisplayForRanking as dl,toCanvas as dm,ArtworkLikeButton as dn,fetchListUsers as dp,Kr as dq,UserFollowButton as dr,SiteNameWithDescription as ds,useListUsers as dt,UserCard as du,once$1 as dv,ArtworkPreviewCardSimple as dw,createCtx as dx,useSetImageItemList as dy,MediaSelectPreviewPanelItemsRefContext as dz,executeGenCode as e,useUserLikedGenerationModels as e$,object as e0,optional as e1,string as e2,pipe as e3,isoDate as e4,transform$1 as e5,safeParse as e6,useIPCountry as e7,icRoundLock as e8,PayPayLogo as e9,icBaselineChevronLeft as eA,StyledToggleButtonGroup as eB,ALL_FOLLOW_TYPES as eC,useGenerationModelsWithTrainingTask as eD,useEditItems as eE,executeDeleteArtwork as eF,removeCollectionItem as eG,addCollectionItem as eH,AddToCollectionButton as eI,dialogModerationEdit as eJ,ArtworkDetailDialog$1 as eK,useUserProfileContext as eL,fluentAdd20Regular as eM,getContentSafetyLabelForUserContent as eN,isOrderOptionPosSeq as eO,useBookmarkItems as eP,updateCollection as eQ,useListUserLikedArtworks as eR,ce$1 as eS,BadgeData as eT,useListUserCollectionCardSetProgress as eU,useTrackPageView as eV,DecorationPageTab as eW,useListUserDecorations as eX,executeToggleDecoration as eY,UITooltipResponsive as eZ,AvatarFrame as e_,useGrowthEvent as ea,GrowthEventName as eb,AugustEventEntryBanner as ec,MembershipPlansStateContextProvider as ed,MembershipIcon as ee,CreditsIcon as ef,useMembershipDiscountValidCountdownUpdate as eg,useMembershipPlansStatePageContextAtom as eh,useUserIsEligibleForDiscount as ei,useMembershipMonthlyDiscountedPrices as ej,useMembershipPlans as ek,MembershipCouponCodeBtn as el,getMembershipDiscountStylesByTier as em,useMembershipPriceCurrencyExperiment as en,MembershipPlansIntervalSwitch as eo,MembershipPlanCard as ep,useMyQuota as eq,CreditPackDiscountCountdownBannerForNewUser as er,ExtraPackItems as es,useAugustEventMembershipDefaultMonthly as et,NumberFlowGroup as eu,endEventGroup as ev,MioImage as ew,useGetOrderById as ex,FollowType as ey,useWorldCharacterExperiment as ez,useForm$1 as f,useQuests as f$,icBaselineFavoriteBorder as f0,parseDisplayableParametersFromTask$1 as f1,getI18nKeyForI2vModelName as f2,useCharacter as f3,icBaselineOpenInNew as f4,StyleSeedLabel as f5,StyleSeedContentDisplay as f6,I2vTaskFrames as f7,formatQualityTag as f8,isVideoTaskSummary as f9,getCharacterCollectionName as fA,CreateCollectionButton as fB,useBookmarkCharacterItems as fC,useListFiles as fD,useGetFileStatistics as fE,formatBytes as fF,fluentSpinnerIos20Filled as fG,CursorPagingButton as fH,useDebounce as fI,sha256 as fJ,uploadFileMultiPart as fK,UIButton as fL,executeDeleteFile as fM,useListUserTaskSummaries as fN,executeDeleteGenerationTask as fO,FitToggle as fP,useBookmark as fQ,ProfilePageTab as fR,getUserTitle as fS,getUserMetaDescription as fT,CollectionList as fU,isDefaultCollection as fV,icBaselineStar as fW,UserCreditView as fX,shouldNotHappen as fY,useGetUserWithExternalProfiles as fZ,createMapSubjectValueHook as f_,fluentSparkle20Filled as fa,CardCornerOverlay as fb,mdiEarth as fc,useTaskById as fd,isI2vProTask as fe,encodeTaskForImport as ff,useBaseCursorPagingContext as fg,getMediaIdsFromTask as fh,getVideoMediaIdFromTask as fi,TaskPlaceholderImage as fj,TaskStatus as fk,dialogInspectionForRAC as fl,getArtworkShareLink as fm,isTaskAllowedToPublishAsArtwork as fn,PublishTaskButton as fo,ChatWorkspaceCreatorButton as fp,CancelTaskButton as fq,RerunTaskButton as fr,getNaturalPrompts as fs,ExpandableContentBox as ft,DeleteTaskButton as fu,isAnimateDiffTask as fv,useFit as fw,useMyBookmarkItems as fx,useCollections as fy,CHARACTER_BOOKMARK_TYPE as fz,executeUpdateUserSensitiveInfos as g,GeneratedItemsContext as g$,executeClaimQuestReward as g0,useDailyClaim as g1,useUserFollowerCount as g2,useShowEmailVerificationDot as g3,userHasNotVerifiedEmail as g4,OutboundLink as g5,QuotaBalance as g6,QuotaHelpIcon as g7,UIMenuTrigger as g8,icBaselineMoreVert as g9,useMount as gA,localeAtom as gB,DEFAULT_LOCALE as gC,useGetNotification as gD,translateOrderOptionForArtworkListQuery as gE,useListContests as gF,isContestInProgress as gG,encodeInitialValuesForImport as gH,isContestEnded as gI,useCountdownTimer as gJ,useGetContest as gK,mapEventNameToComponent as gL,mapEventRouteToEventName as gM,TaskHistoryButtonPanel as gN,useImmerAtom as gO,useSetImmerAtom as gP,SingleImageViewer as gQ,getImageDownloadFilename as gR,useEnhancementPlugins as gS,useMyFreeGenerationEvents as gT,usePricingTask as gU,executeCreateGenerationTask as gV,openMembershipFeatureDialog as gW,TaskAndFavTabs as gX,GeneratorMode as gY,JoinMembershipBanner as gZ,GeneratorTabs as g_,UIMenu as ga,UIMenuItem as gb,icBaselineFlag as gc,dialogReport as gd,UserProfileContext as ge,useGetUserInfoByUsername as gf,getMediaIdsFromTaskSummaries as gg,fetchGetMedia as gh,UnFile as gi,getImageDownloadFileExt as gj,useMountedState as gk,useSetState as gl,SUPPORTED_LOCALES as gm,strictObject as gn,union as go,literal as gp,array as gq,picklist as gr,MediaStreamPlayer as gs,icBaselineClose as gt,getImagePublicUrl as gu,useHoverMediaQuery as gv,withBase as gw,withoutBase as gx,fetchListNotifications as gy,useUnreadNotificationNews as gz,updateGetUserInfo as h,DEFAULT_CLIPSKIP_VAL_FOR_NON_SDV1 as h$,getTaskAndMediaIds as h0,SelectedTaskContext as h1,getMediaIdx as h2,getTaskPublishedCount as h3,downloadFile as h4,useSetTaskInMyTasks as h5,useTaskSubmitFormContext as h6,ArtworkPromptsWithHidden$1 as h7,isTaskWithPromptHelper as h8,UITooltipTriggerWrapper as h9,ModelRefCountInDialog as hA,ModelVersionSelect as hB,icOutlineReportProblem as hC,updatePromptsWithTriggerWords as hD,icBaselineBookmarkAdded as hE,icOutlineBookmarkAdd as hF,UISpinnerLoading as hG,UISelect as hH,UISelectItem as hI,getBaseModelTypeFromLoraVersion as hJ,produce as hK,getLoraTypeFromModelVersion as hL,isLoraCompatWithModel as hM,icRoundWarning as hN,useMyBookmarkedGenerationModels as hO,GenerationSelectableDialogContextProvider as hP,GenerationSelectableDialogContent as hQ,icBaselineStore as hR,getMarketListOrderChoices as hS,getBookmarkListOrderChoices as hT,useMyBookmarkedGenerationModelsInfinite as hU,EmptyModelSearchResultsInDialog as hV,Yr as hW,ModelListContainerInDialog as hX,hash$1 as hY,GenerationSelectableDialogSearchWrapper as hZ,isBookmarkOrderOptionPosSeq as h_,dialogSurvey as ha,LastImportedItemContext as hb,faceDetectorClient as hc,atomWithImmer as hd,InitialValueLoadedContext as he,useModelVersion as hf,isModelCompatibleWithIPAdapter as hg,GeneratorControlSection as hh,ControlSectionMessage as hi,ControlSectionMessageType as hj,GeneratorControlsRefContext as hk,debug as hl,createCtxReducer as hm,getAspectRatio as hn,isValuesI2i as ho,isSDV1Model as hp,setModelVersion as hq,useGenerationModelVersions as hr,GenerationModelVersionStatus as hs,getModelLoraBaseModelChipConfig as ht,getModelTypeFromVersion as hu,dynamicCreateElement as hv,useHasOpenedMembershipForExcessiveLoras as hw,isMultiUnionLora as hx,removeTriggerWordsFromPrompts as hy,NsfwBlurForImage as hz,executeForgetPassword as i,ImageToVideoStateContextProvider as i$,DEFAULT_CLIPSKIP_VAL_FOR_SDV1 as i0,useVaeModels as i1,isModelCompatibleWithVae as i2,SamplingStepSelectInner as i3,SamplingMethodsSelectInner as i4,GeneratorContext as i5,CfgScaleSelectInner as i6,hasModelEnabledShiftValue as i7,ShiftValueInner as i8,hasModelEnabledRescaleCfg as i9,icBaselineDownload as iA,icRoundAccessTime as iB,icBaselineFileUpload as iC,useObjectUrl as iD,HelpIcon as iE,useModelSelectModeStorage as iF,ModelModeToggle as iG,ModelSelect as iH,ImageEditorContext as iI,getCompressedDimensions as iJ,icBaselineBrush as iK,icBaselineAutoAwesome as iL,icRoundMinus as iM,icBaselineLock as iN,ImageSizeControl as iO,TaskNotes as iP,useGetWorkflow as iQ,createWorkflowUrl as iR,createWorkflowEditorUrl as iS,FillEditorGenParamsContextProvider as iT,FillEditorContext as iU,createFillEditorContextUtils as iV,isVideoTask as iW,trackUserPreference as iX,ArtworkDetailActions as iY,useImageToVideoStateValue as iZ,VideoMedia as i_,UISwitch as ia,RescaleCFGInner as ib,WORKBENCH_OVERLAY_ID as ic,CharacterSelect as id,browserExports as ie,length as ig,number as ih,nullable as ii,nullish as ij,canvasToFile as ik,controlNetClient as il,TaskMediaPicker as im,parse as io,icBaselineExpandMore as ip,useUnmount as iq,hasModelDisabledCnet as ir,isXLModel as is,isSD3Model as it,isCnetsCompatWithIPAdapter as iu,isCnetsCompatWithModelType as iv,icBaselineAdd as iw,IPADAPATER_COMPAT_CONTROLNET_METHODS as ix,SDXL_COMPAT_CONTROLNET_METHODS as iy,SD3_COMPAT_CONTROLNET_METHODS as iz,MetaTitle as j,joinRelativeURL as j$,ImageToVideoFormStateContextProvider as j0,ChannelContext as j1,ImageItemListGroup as j2,ImageToVideoSubmit as j3,useAvaliableI2vModels as j4,showDemoVideo as j5,useSelectedI2vProModel as j6,useSelectedI2vLoRA as j7,useImageToVideoFormState as j8,useSetImageToVideoState as j9,fluentImageStack20Filled as jA,fluentChat24Filled as jB,fluentImageArrowForward24Filled as jC,PublishTaskForm as jD,createErrorClass as jE,SafeSubscriber as jF,icBaselineContentCopy as jG,icBaselineCircle as jH,isWebsocketConnected as jI,$taskUpdated as jJ,filter$3 as jK,fetchGetTaskById as jL,getToken as jM,WorkbenchLayout as jN,fetchToBlob as jO,SignModal as jP,asyncScopedObjectUrl as jQ,mdiImageMove as jR,isXLLora as jS,icBaselineAutoGraph as jT,executeUpsertWorkflow as jU,executeUpsertWorkflowVersion as jV,useInfinityListWorkflows as jW,fetchListUserTasks as jX,usePickAtomValue as jY,dynamicConfigClient as jZ,getVaeModels as j_,decodeTaskForImport as ja,decodeInitialValuesForImport as jb,WorkbenchLayoutBase as jc,GeneratorType as jd,ImageEditorContextProvider as je,GeneratedItemsContextProvider as jf,GeneratorControlsRefContextProvider as jg,LastImportedItemContextProvider as jh,InitialValueLoadedContextProvider as ji,ChannelContextProvider as jj,EmailVerifyBanner as jk,PromptsInputArea as jl,SelectedTaskContextProvider as jm,HoveredItemContextProvider as jn,GeneratorStage as jo,isWorkflowTask as jp,decodeArtworkForImport as jq,decodeCharacterForImport as jr,getBaseMediaIdFromTask as js,parseInitialTaskFormState as jt,GenerateButton as ju,genId as jv,generatorModeFromParamsTab as jw,BaseTaskSubmitForm as jx,GeneratorContextProvider as jy,icBaselineKeyboardArrowRight as jz,icBaselineCheck as k,isAppWebview as k$,fluentDismiss20Filled as k0,useGetFile as k1,usePaginationArgs as k2,ModelSelectDialog as k3,genUuid as k4,executeDeleteWorkflow as k5,ItemList as k6,fluentMoreVertical20Filled as k7,fluentWarning20Filled as k8,fluentAdd24Filled as k9,WorkbenchTrackingContext as kA,Header as kB,executeCreateChatEditingSceneTask as kC,useGetChatEditingScene as kD,useConversationalEditUIState as kE,useConversationalEditWorkspaceState as kF,fetchGetMyMembership as kG,openMembershipRequiredDialog as kH,isMac as kI,ConversationType as kJ,createConversationHistory as kK,usePresetToolSelectionState as kL,parseEnhancementDefaultArgs as kM,calculateTaskChain as kN,fluentWarning24Filled as kO,extractEnhancementPlugin as kP,useJSBridgeFn as kQ,copyToJsBridge as kR,defaultTaskFormValues as kS,useDynamicDefaultParameters as kT,EnlargerModelSelect as kU,getFlooredValue as kV,ImageUpscaleSliders as kW,getMaxEnlargableRatio as kX,getDefaultEnlargeRatio as kY,getMaxUpscaleRatio as kZ,getDefaultUpscaleRatio as k_,fluentDismiss24Filled as ka,i as kb,UploadImage as kc,fluentChevronDown20Filled as kd,useInfiniteListWorkflowVersions as ke,usePagedListWorkflowVersions as kf,fetchGetWorkflow as kg,updateGetTaskById as kh,refetchGetTaskById as ki,baseClient as kj,getFileSize as kk,TASK_PRIORITIES as kl,usePublicDynamicConfig as km,attemptParseJSON as kn,UIRadioGroup as ko,UISelectNative as kp,getCroppedImg as kq,UISlider as kr,Cropper as ks,useI2vGenerationSubmissionArgs as kt,parseI2vProTaskSubmitParams as ku,LoadingSkeletons as kv,icBaselineZoomIn as kw,openImageToVideoSubmissionDialog as kx,useListChatEditingScenes as ky,useEmbedded as kz,useAsyncFn as l,getValueFromDispatch as l$,invariant as l0,UITabList as l1,UITab as l2,StartChatEditingButton as l3,useEmbeddedNavigate as l4,EmbeddedRoutes as l5,ChatWorkspaceSelectorPaging as l6,fluentDatabaseSearch20Regular as l7,WorkspaceDeleteConfirmDialog as l8,downloadMediaToBridge as l9,fluentCheckmarkCircle24Filled as lA,Helmet as lB,modifyQueryHook as lC,createQueryHook as lD,createMutationHelper as lE,executeCreateGrowthEventTask as lF,matchTaskSubmitFormError as lG,useMembershipExtraPackages as lH,useCurrency as lI,isIOSWebview as lJ,createFetchQueryHelper as lK,mdUser as lL,BadgeGroups as lM,BadgeGroupName as lN,BadgeName as lO,checkTokenForArgs as lP,refetchGetMyQuota as lQ,record as lR,boolean as lS,isoTimestamp as lT,sortBoostsPriority as lU,formatPrice as lV,partial as lW,HlsStream as lX,useTrackWithPageViewParams as lY,getColorModeValue as lZ,icBaselineArrowForwardIos as l_,createWorkspace as la,ImageSource as lb,navigateToNativePage as lc,NativeNavigation as ld,ChatWorkspaceSelectorPage as le,useChatWorkspace as lf,useChatTaskReactionByWorkspace as lg,useWsConnectionStatus as lh,fetchListMyTasks as li,Logo as lj,AppFooter as lk,we$1 as ll,useSocialMedia as lm,callFromJsBridgeHandler as ln,getAppMetadata as lo,getProductListFromBridge as lp,isAppVersionGreaterThanOrEqualTo as lq,popBack as lr,AppDownloadButtons as ls,isT2I2VTask as lt,useInfiniteListArtworks as lu,useLike as lv,UseState as lw,useMembershipActions as lx,invokeProductPurchase as ly,gameIconsCrystalBars as lz,track as m,QRCode as m0,i18n as m1,loadPath as m2,genIdAsNumber as m3,INPAINT_MODELS as m4,useTagComplete as m5,PromptsCompletionProvider as m6,PromptsCompletionDisplay as m7,PromptsCompletionTextarea as m8,PromptsCompletionButton as m9,getCreateTaskTrackAttrs as ma,imageCaptioning as mb,radixIconsHand as mc,toTitleCase as md,taskParameterFieldsForTaskList as me,generateAssetIdsFromTask as mf,fluentCheckmarkCircle32Filled as mg,index$1 as mh,executeWithdrawAccount as n,logoutUser as o,cx as p,NumberFlow as q,refetchGetUserInfo as r,useUserArtworkLikedCount as s,toast as t,useQs as u,UserAvatar as v,formatNum as w,usePagedListArtworks as x,formatTime as y,usePagedListUserTasks as z};
