import{j as e}from"./vendor-motion-Bl2lDopP.js";import{r as x}from"./vendor-apollo-B9XqHIAo.js";import{p as y,T as t,aV as v,aW as I,l as k,aX as U,aY as K,m as p,aZ as D,a_ as T,a$ as z,t as b,ag as B,U as h,b0 as H,b1 as A,b2 as E,b3 as F,b4 as L,b5 as O,b6 as P,b7 as G,b8 as _,b9 as R,y as V,ba as W,bb as $,bc as Q,bd as Y,aL as q,be as X,$ as Z,bf as J}from"./index-JhqgbpkX.js";import{g as ee}from"./vendor-graphql-DeSYh9DC.js";import{u as g}from"./vendor-i18next-TC5y0B3W.js";import{d as N,a8 as j}from"./vendor-mui-DTp04zm4.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};r.SENTRY_RELEASE={id:"0ec442be81a4ee21bfcf5745e8ef10bc76836958"}}catch{}})();try{(function(){var r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},s=new r.Error().stack;s&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[s]="dc209c82-2436-4ec1-a59c-c8e8b7708bd4",r._sentryDebugIdIdentifier="sentry-dbid-dc209c82-2436-4ec1-a59c-c8e8b7708bd4")})()}catch{}(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};r._sentryModuleMetadata=r._sentryModuleMetadata||{},r._sentryModuleMetadata[new r.Error().stack]=function(s){for(var a=1;a<arguments.length;a++){var l=arguments[a];if(l!=null)for(var n in l)l.hasOwnProperty(n)&&(s[n]=l[n])}return s}({},r._sentryModuleMetadata[new r.Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}catch{}})();const re=r=>e.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...r,children:e.jsx("path",{fill:"currentColor",d:"M20 6h-2.18c.11-.31.18-.65.18-1a2.996 2.996 0 0 0-5.5-1.65l-.5.67l-.5-.68C10.96 2.54 10.05 2 9 2C7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1s-1-.45-1-1s.45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1s-1-.45-1-1s.45-1 1-1zm11 15H4v-2h16v2zm0-5H4V9c0-.55.45-1 1-1h4.08L7.6 10.02a.995.995 0 0 0 .22 1.4c.44.32 1.07.22 1.39-.22L12 7.4l2.79 3.8c.32.44.95.54 1.39.22c.45-.32.55-.95.22-1.4L14.92 8H19c.55 0 1 .45 1 1v5z"})}),se=r=>e.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...r,children:e.jsx("path",{fill:"currentColor",d:"M17 7h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c1.65 0 3 1.35 3 3s-1.35 3-3 3h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c2.76 0 5-2.24 5-5s-2.24-5-5-5zm-9 5c0 .55.45 1 1 1h6c.55 0 1-.45 1-1s-.45-1-1-1H9c-.55 0-1 .45-1 1zm2 3H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h3c.55 0 1-.45 1-1s-.45-1-1-1H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h3c.55 0 1-.45 1-1s-.45-1-1-1z"})}),M="https://images-ng.pixai.art/images/orig/d5bb6b14-b9ea-45b2-9548-a4491ac48a0b";function pe(r){const{t:s}=g(["user"]),a=s("user:referral.referral-page.hero-img-url")||M;return e.jsxs(e.Fragment,{children:[e.jsxs("hgroup",{className:y("flex flex-col gap-8 md:flex-row border-b py-4 relative",r.pageType==="normal"&&"grow"),children:[e.jsxs("div",{className:"flex flex-col h-full self-center basis-[60%]",children:[e.jsxs("h1",{className:"text-3xl font-medium md:pl-20",children:[e.jsx(t,{i18nKey:"user:referral.referral-page.title"}),e.jsx("span",{className:"block md:pl-6",children:e.jsx(t,{i18nKey:"user:referral.referral-page.subtitle"})})]}),e.jsx("div",{className:"hidden md:flex absolute gap-2 items-center justify-center bottom-0 -translate-y-1/2",children:e.jsx(C,{})})]}),e.jsx("img",{className:"max-md:max-h-60 md:h-80 self-center w-auto object-contain md:ml-auto",src:a,alt:"Hero Image"})]}),e.jsx(ae,{}),e.jsx("section",{className:y("md:hidden bg-background py-4 flex flex-col sticky bottom-0 gap-3 md:gap-2",r.pageType==="normal"?"w-[calc(100%+2rem)] sm:w-[calc(100%+3rem)] -translate-x-4 sm:-translate-x-6 px-4 sm:px-6":"w-[calc(100%+2rem)] -translate-x-4 px-4"),children:e.jsx(C,{})})]})}function C(){const{t:r}=g(["user"]),s=v("md","down"),[a,l]=x.useState(!1),{data:n,refetch:d}=I({}),[u,i]=k(async o=>{try{let c=n?.code;if(!n?.code){const w=await U({});c=w.data?.generateReferralCode?.code,K(w.data?.generateReferralCode),d()}if(!c)throw new Error(r("user:referral.referral-page.notice.code-not-exists"));p("referral_code_copy_click",{type:o});const S=o==="code"?c:D(T(window.location.origin,"/referral"),{refCode:c});z(S)}catch(c){b.error(c.message)}},[n?.code]),{me:f}=B(),m=x.useMemo(()=>f?.createdAt==null?!1:N().isSameOrBefore(N(f.createdAt).add(24,"hour")),[f]);return e.jsxs(e.Fragment,{children:[e.jsx(h,{size:s?"xl":"normal",variant:"filled",busy:u.loading,icon:!s&&e.jsx(se,{className:"size-4"}),onPress:()=>i("link"),children:e.jsx(t,{i18nKey:"user:referral.referral-page.copy-link.label"})}),m?e.jsx(oe,{className:"px-2 py-2 md:py-1"}):null,e.jsx(h,{size:s?"xl":"normal",variant:"ghost",className:"px-2 py-2 md:py-1",onPress:()=>{p("referral_history_open_click"),l(!0)},children:e.jsx(t,{i18nKey:"user:referral.referral-page.view-referrals.label"})}),e.jsx(H,{open:a,onClose:()=>l(!1),dismissable:!0,children:e.jsx(te,{})})]})}function ae(){const{data:r}=A(),s=r?.userReferral?.rewardCreditsPercentage??10;return e.jsxs("section",{className:"flex flex-col items-center justify-center my-4 md:my-8 md:mb-12",children:[e.jsx("h2",{className:"text-2xl font-semibold mt-2 mb-4 md:mb-8",children:e.jsx(t,{i18nKey:"user:referral.referral-page.how-it-works.title"})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("article",{className:"rounded-xl p-4 border shadow flex-1",children:[e.jsxs("h3",{className:"flex items-center gap-2 text-xl mb-2",children:[e.jsx(E,{className:"size-6"}),e.jsx(t,{i18nKey:"user:referral.referral-page.share-your-link.title"})]}),e.jsx("p",{className:"whitespace-pre-wrap",children:e.jsx(t,{i18nKey:"user:referral.referral-page.share-your-link.content"})})]}),e.jsxs("article",{className:"rounded-xl p-4 border shadow flex-1",children:[e.jsxs("h3",{className:"flex items-center gap-2 text-xl mb-2",children:[e.jsx(re,{className:"size-6"}),e.jsx(t,{i18nKey:"user:referral.referral-page.get-rewarded.title"})]}),e.jsx("p",{className:"whitespace-pre-wrap",children:e.jsx(t,{i18nKey:"user:referral.referral-page.get-rewarded.content",components:{help:e.jsx(F,{variant:"normal"})},values:{rewardPercentage:s}})})]})]})]})}function te(){const{t:r}=g(["user"]),s=r("user:referral.referral-page.hero-img-url")||M,[{before:a,after:l},n]=x.useState({}),{data:d}=I({}),{data:u,loading:i}=L({...O({before:a,after:l,pageSize:5}),orderBy:P(G.newest)}),f=d?.type==="kol",m=ee(u);return e.jsxs(e.Fragment,{children:[e.jsx(_,{heading:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-flex items-center gap-2",children:e.jsx(t,{i18nKey:"user:referral.referral-page.referral-list.title"})}),e.jsx("span",{className:"block text-neutral-500 dark:text-neutral-400 text-sm",children:e.jsx(t,{i18nKey:"user:referral.referral-page.referral-list.subtitle"})})]})}),e.jsx(R,{children:m.length===0&&!i?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("img",{className:"max-md:max-h-60 md:h-80 w-auto",src:s,alt:""}),e.jsx("h1",{children:e.jsx(t,{i18nKey:"user:referral.referral-page.referral-list.empty-placeholder"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("table",{className:"w-full divide-y divide-gray-200 dark:divide-neutral-700",children:e.jsxs("tbody",{className:y("divide-y divide-gray-200 dark:divide-neutral-700","[&_td]:px-4 [&_td]:py-1 [&_td]:text-sm"),children:[m.length<1&&i&&Array.from({length:5},(o,c)=>e.jsx(le,{},c)),m.map((o,c)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("p",{className:"inline-flex flex-col gap-1",children:[e.jsx(ne,{className:"font-medium",userId:o.userId}),e.jsx("span",{className:"text-neutral-600 dark:text-neutral-300 text-xs",children:V(o.updatedAt)})]})}),e.jsx("td",{children:f?e.jsxs("span",{className:"font-bold text-purple-600",children:["+",o.rewardCurrency," ",(o.reward??0)/(o.rewardBy??1)]}):e.jsxs("span",{className:"font-bold text-purple-600",children:["+",o.credits," ",e.jsx(t,{i18nKey:"user:credits"})]})})]},o.id))]})}),e.jsx(W,{pageInfo:u?.pageInfo,onCursorChange:n})]})})]})}function le(){return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})})]})}function ne(r){const{data:s}=$(r.userId);return e.jsx("span",{className:r.className,children:s?`@${Q(s)}`:e.jsx(j,{})})}function oe(r){const[s,a]=x.useState(!1),{data:l,loading:n}=Y({}),d=v("md","down");return n||l!=null?null:e.jsxs(e.Fragment,{children:[e.jsx(h,{...r,size:d?"xl":"normal",variant:"ghost",onPress:()=>{p("referral_code_manual_submit_open"),a(!0)},children:e.jsx(t,{i18nKey:"user:referral.referral-page.submit-referral-code.label"})}),e.jsx(q,{open:s,onClose:()=>a(!1),dismissable:!0,children:e.jsx(ie,{onClose:()=>a(!1)})})]})}function ie(r){const{t:s}=g(["user"]),[a,l]=x.useState(""),[n,d]=k(async i=>{i.preventDefault();try{p("referral_code_manual_submit_confirm",{code:a}),await X({code:a}),b.success(s("user:referral.referral-page.notice.set-referrer-success")),r.onClose()}catch(f){b.error(f.message)}},[a]),u=()=>{l(i=>i.trim())};return e.jsxs(e.Fragment,{children:[e.jsx(_,{heading:e.jsx(t,{i18nKey:"user:referral.referral-page.submit-referral-code.title"})}),e.jsxs("form",{onSubmit:d,children:[e.jsx(R,{children:e.jsx(Z,{className:"w-full font-mono tracking-wide placeholder-shown:font-sans placeholder-shown:tracking-normal",variant:"rounded-normal",placeholder:s("user:referral.referral-page.submit-referral-code.placeholder"),value:a,onChange:i=>l(i.target.value),required:!0,autoCapitalize:"none",autoCorrect:"off",spellCheck:"false",autoComplete:"off",onBlur:u,inputMode:"text",type:"text"})}),e.jsx(J,{children:e.jsx(h,{busy:n.loading,variant:"filled",type:"submit",children:e.jsx(t,{i18nKey:"action:submit"})})})]})]})}export{pe as U};
