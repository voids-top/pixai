const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/index-qPceTsh8.js","https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/index-BTMYyhc6.js","https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/index-CTvaRJPh.css","https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/imageUtil-NFh1c57i.js","https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/index-C-ypkS9u.js","https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/unFile-B3RwQvIR.js","https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/utils-CORjiwlf.js","https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/artwork-D9vxumxJ.js","https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/upload-DDvru8Za.js","https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/Slider-0j-9tQ0Y.js"])))=>i.map(i=>d[i]);
import{u as j,f as k,e as c,h as I,i as _,t as b,C as v,f4 as N,j as e,K as y,aa as C,L as E,fj as S,U as M,aS as P,$ as T,Q as U,B as z}from"./index-BTMYyhc6.js";import{U as F}from"./index-m6nh9vV8.js";import{u as D}from"./upload-DDvru8Za.js";import{i as L}from"./baseline-edit-CrCwmctU.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[t]="eecee6b9-3fdb-4faf-b34a-3c367ecc3a49",a._sentryDebugIdIdentifier="sentry-dbid-eecee6b9-3fdb-4faf-b34a-3c367ecc3a49")}catch{}})();{var x=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};x._sentryModuleMetadata=x._sentryModuleMetadata||{},x._sentryModuleMetadata[new Error().stack]=Object.assign({},x._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}const R=c.lazy(()=>P(()=>import("./index-qPceTsh8.js").then(a=>a.c),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url)),K=a=>{const{avatarHeight:t=160,avatarWidth:l=160}=a,{t:i}=j(["user"]),{data:r,mutate:g}=k(),[u,d]=c.useState(!1),n=c.useRef(null),[o,s]=I(async()=>{if(!n.current)return;const m=await n.current.getImage();if(m)try{const f=await D(m,{preserveFileType:!0});if(!f)return;await _.updateUserInfo({input:{avatarMediaId:f.mediaId}}),b.success("Success"),d(!1),g(),v("edit_avatar_success")}catch(f){b.error(`Failed to upload image: ${f==null?void 0:f.message}`)}},[]),p=N(r),h=["image/jpeg","image/png",...p?["image/gif"]:[]].join(",");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:y("flex flex-col gap-4 items-center",a.className),children:e.jsxs("div",{className:"group relative cursor-pointer",onClick:()=>{d(!0),v("click_edit_avatar")},children:[e.jsx(F,{user:r,style:{width:l,height:t,fontSize:24}}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-black bg-opacity-70 group-hover:opacity-100 transition opacity-0 flex justify-center items-center text-white",children:e.jsx(L,{className:"size-6"})})]})}),e.jsx(C,{open:u,fullWidth:!0,maxWidth:"md",onClose:()=>d(!1),children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"prose dark:prose-invert",children:e.jsx("h2",{children:i("user:change-profile-image")})}),e.jsx(R,{ref:n,allowedFileTypes:h,cropShape:"round"}),e.jsxs("div",{className:"w-full flex mt-2",children:[!p&&e.jsx("button",{className:"text-blue-600 text-sm self-end",onClick:()=>{S({trackingLocation:"avatar-gifs"})},children:i("user:profile.membership-supports-gif-image")}),e.jsx(M,{className:"ml-auto",variant:"filled",busy:o,onPress:s,children:i("user:submit-avatar")})]})]})})})]})},W=c.lazy(()=>P(()=>import("./index-qPceTsh8.js").then(a=>a.c),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url));function V(a){const{t}=j(["user","membership"]),{user:l,isMe:i,allowEdit:r,hoverToEdit:g,...u}=a,[d,n]=c.useState(!1),o=T(l==null?void 0:l.coverMedia),s=N(l),p=t("membership:profile-page.promotion-banner.image");if(!s||!o&&!i){if(i&&!s&&p){const h=t("membership:profile-page.promotion-banner.link"),m=t("membership:profile-page.promotion-banner.text");return e.jsxs(w,{image:p,...u,children:[m&&e.jsx("div",{className:"absolute w-full h-full bg-[#c7c7c7]/50 dark:bg-background/40"}),m&&e.jsx("span",{className:"absolute right-2 bottom-2 text-sm md:text-base mlg:text-xl text-white",style:{textShadow:"0px 4px 4px rgba(0, 0, 0, 0.25)",WebkitTextStroke:"1",WebkitTextStrokeColor:"white"},children:m}),h&&e.jsx(U,{to:h,className:"absolute w-full h-full cursor-pointer"})]})}return null}return e.jsx(w,{image:o,...u,children:i&&r&&e.jsxs(e.Fragment,{children:[e.jsx(z,{variant:o?"contained":"outlined",className:y("rounded-md",o?"text-black bg-white":"text-white border-white",g&&"invisible group-hover:visible"),onClick:()=>{v("banner_change_click"),n(!0)},children:t("user:profile-edit.change-banner.label")}),e.jsx(A,{open:d,onClose:()=>{n(!1)}})]})})}function A(a){const{t}=j(["user"]),{data:l,mutate:i}=k(),r=c.useRef(null),[g,u]=I(async()=>{var o;if(!r.current)return;v("banner_submit_click",{size:r.current.zoom});const n=await r.current.getImage();if(n)try{const s=await D(n,{preserveFileType:!0});if(!s)return;await _.updateUserInfo({input:{coverMediaId:s.mediaId}}),b.success("Success"),(o=a.onClose)==null||o.call(a),i()}catch(s){b.error(`Failed to upload image: ${s==null?void 0:s.message}`)}},[]),d=["image/jpeg","image/png"].join(",");return e.jsx(C,{open:a.open,fullWidth:!0,maxWidth:"md",onClose:a.onClose,children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"prose dark:prose-invert",children:e.jsx("h2",{children:t("user:profile-edit.change-banner.label")})}),e.jsx(W,{ref:r,allowedFileTypes:d,maxWidth:1500,maxHeight:500}),e.jsx("div",{className:"w-full flex justify-end",children:e.jsx(M,{variant:"filled",busy:g,onPress:u,children:t("user:submit-avatar")})})]})})})}function w(a){return e.jsxs("div",{className:y("flex items-center justify-center relative group",!a.image&&"bg-zinc-700",a.className),style:{aspectRatio:1311/232,...a.style},children:[a.image&&e.jsx("img",{className:"absolute object-cover w-full h-full mmd:rounded-t-lg",src:a.image,alt:"cover image",loading:"lazy",decoding:"async"}),a.children]})}export{K as E,V as P};
//# sourceMappingURL=ProfileCoverEdit-BgbxYO6s.js.map
