const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/gifsicle-utils-D8FKSZ_X.js","https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/index-BTMYyhc6.js","https://cdn.pixai.art/artifacts/app-2a97546287d4bdd7d7b76367efd818c8351c44e2/assets/index-CTvaRJPh.css"])))=>i.map(i=>d[i]);
import{g as Ne,c7 as Ae,e as p,hW as y,j as u,bS as Fe,U as Y,i9 as Ie,a0 as T,je as me,t as q,bU as We,bV as Te,K as ge,bW as Oe,u as Ze,aS as Le}from"./index-BTMYyhc6.js";import{i as Ue}from"./imageUtil-NFh1c57i.js";import{D as ke}from"./index-C-ypkS9u.js";import{a as $,b as ve}from"./unFile-B3RwQvIR.js";import{S as we}from"./Slider-0j-9tQ0Y.js";(function(){try{var i=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new Error().stack;n&&(i._sentryDebugIds=i._sentryDebugIds||{},i._sentryDebugIds[n]="afe1f109-a08e-41e7-9c24-9ae4cd4ec125",i._sentryDebugIdIdentifier="sentry-dbid-afe1f109-a08e-41e7-9c24-9ae4cd4ec125")}catch{}})();{var U=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};U._sentryModuleMetadata=U._sentryModuleMetadata||{},U._sentryModuleMetadata[new Error().stack]=Object.assign({},U._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}var se=!1,N,J,Q,B,G,xe,X,ee,te,ne,ye,oe,ie,Ce,be;function R(){if(!se){se=!0;var i=navigator.userAgent,n=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(i),e=/(Mac OS X)|(Windows)|(Linux)/.exec(i);if(oe=/\b(iPhone|iP[ao]d)/.exec(i),ie=/\b(iP[ao]d)/.exec(i),ne=/Android/i.exec(i),Ce=/FBAN\/\w+;/i.exec(i),be=/Mobile/i.exec(i),ye=!!/Win64/.exec(i),n){N=n[1]?parseFloat(n[1]):n[5]?parseFloat(n[5]):NaN,N&&document&&document.documentMode&&(N=document.documentMode);var t=/(?:Trident\/(\d+.\d+))/.exec(i);xe=t?parseFloat(t[1])+4:N,J=n[2]?parseFloat(n[2]):NaN,Q=n[3]?parseFloat(n[3]):NaN,B=n[4]?parseFloat(n[4]):NaN,B?(n=/(?:Chrome\/(\d+\.\d+))/.exec(i),G=n&&n[1]?parseFloat(n[1]):NaN):G=NaN}else N=J=Q=G=B=NaN;if(e){if(e[1]){var o=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(i);X=o?parseFloat(o[1].replace("_",".")):!0}else X=!1;ee=!!e[2],te=!!e[3]}else X=ee=te=!1}}var re={ie:function(){return R()||N},ieCompatibilityMode:function(){return R()||xe>N},ie64:function(){return re.ie()&&ye},firefox:function(){return R()||J},opera:function(){return R()||Q},webkit:function(){return R()||B},safari:function(){return re.webkit()},chrome:function(){return R()||G},windows:function(){return R()||ee},osx:function(){return R()||X},linux:function(){return R()||te},iphone:function(){return R()||oe},mobile:function(){return R()||oe||ie||ne||be},nativeApp:function(){return R()||Ce},android:function(){return R()||ne},ipad:function(){return R()||ie}},He=re,k=!!(typeof window<"u"&&window.document&&window.document.createElement),Be={canUseDOM:k,canUseWorkers:typeof Worker<"u",canUseEventListeners:k&&!!(window.addEventListener||window.attachEvent),canUseViewport:k&&!!window.screen,isInWorker:!k},Ge=Be,Se=Ge,Re;Se.canUseDOM&&(Re=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function Xe(i,n){if(!Se.canUseDOM||n&&!("addEventListener"in document))return!1;var e="on"+i,t=e in document;if(!t){var o=document.createElement("div");o.setAttribute(e,"return;"),t=typeof o[e]=="function"}return!t&&Re&&i==="wheel"&&(t=document.implementation.hasFeature("Events.wheel","3.0")),t}var Ke=Xe,Ve=He,Ye=Ke,ce=10,ue=40,de=800;function _e(i){var n=0,e=0,t=0,o=0;return"detail"in i&&(e=i.detail),"wheelDelta"in i&&(e=-i.wheelDelta/120),"wheelDeltaY"in i&&(e=-i.wheelDeltaY/120),"wheelDeltaX"in i&&(n=-i.wheelDeltaX/120),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(n=e,e=0),t=n*ce,o=e*ce,"deltaY"in i&&(o=i.deltaY),"deltaX"in i&&(t=i.deltaX),(t||o)&&i.deltaMode&&(i.deltaMode==1?(t*=ue,o*=ue):(t*=de,o*=de)),t&&!n&&(n=t<1?-1:1),o&&!e&&(e=o<1?-1:1),{spinX:n,spinY:e,pixelX:t,pixelY:o}}_e.getEventType=function(){return Ve.firefox()?"DOMMouseScroll":Ye("wheel")?"wheel":"mousewheel"};var qe=_e,$e=qe;const Je=Ne($e);function Qe(i,n,e,t,o,r){r===void 0&&(r=0);var a=O(i,n,r),s=a.width,c=a.height,d=Math.min(s,e),h=Math.min(c,t);return d>h*o?{width:h*o,height:h}:{width:d,height:d/o}}function et(i){return i.width>i.height?i.width/i.naturalWidth:i.height/i.naturalHeight}function L(i,n,e,t,o){o===void 0&&(o=0);var r=O(n.width,n.height,o),a=r.width,s=r.height;return{x:he(i.x,a,e.width,t),y:he(i.y,s,e.height,t)}}function he(i,n,e,t){var o=n*t/2-e/2;return V(i,-o,o)}function le(i,n){return Math.sqrt(Math.pow(i.y-n.y,2)+Math.pow(i.x-n.x,2))}function pe(i,n){return Math.atan2(n.y-i.y,n.x-i.x)*180/Math.PI}function tt(i,n,e,t,o,r,a){r===void 0&&(r=0),a===void 0&&(a=!0);var s=a?nt:ot,c=O(n.width,n.height,r),d=O(n.naturalWidth,n.naturalHeight,r),h={x:s(100,((c.width-e.width/o)/2-i.x/o)/c.width*100),y:s(100,((c.height-e.height/o)/2-i.y/o)/c.height*100),width:s(100,e.width/c.width*100/o),height:s(100,e.height/c.height*100/o)},l=Math.round(s(d.width,h.width*d.width/100)),f=Math.round(s(d.height,h.height*d.height/100)),C=d.width>=d.height*t,m=C?{width:Math.round(f*t),height:f}:{width:l,height:Math.round(l/t)},w=y(y({},m),{x:Math.round(s(d.width-m.width,h.x*d.width/100)),y:Math.round(s(d.height-m.height,h.y*d.height/100))});return{croppedAreaPercentages:h,croppedAreaPixels:w}}function nt(i,n){return Math.min(i,Math.max(0,n))}function ot(i,n){return n}function it(i,n,e,t,o,r){var a=O(n.width,n.height,e),s=V(t.width/a.width*(100/i.width),o,r),c={x:s*a.width/2-t.width/2-a.width*s*(i.x/100),y:s*a.height/2-t.height/2-a.height*s*(i.y/100)};return{crop:c,zoom:s}}function rt(i,n,e){var t=et(n);return e.height>e.width?e.height/(i.height*t):e.width/(i.width*t)}function at(i,n,e,t,o,r){e===void 0&&(e=0);var a=O(n.naturalWidth,n.naturalHeight,e),s=V(rt(i,n,t),o,r),c=t.height>t.width?t.height/i.height:t.width/i.width,d={x:((a.width-i.width)/2-i.x)*c,y:((a.height-i.height)/2-i.y)*c};return{crop:d,zoom:s}}function fe(i,n){return{x:(n.x+i.x)/2,y:(n.y+i.y)/2}}function st(i){return i*Math.PI/180}function O(i,n,e){var t=st(e);return{width:Math.abs(Math.cos(t)*i)+Math.abs(Math.sin(t)*n),height:Math.abs(Math.sin(t)*i)+Math.abs(Math.cos(t)*n)}}function V(i,n,e){return Math.min(Math.max(i,n),e)}function H(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return i.filter(function(e){return typeof e=="string"&&e.length>0}).join(" ").trim()}var ct=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,ut=1,dt=3,ht=1,De=function(i){Ae(n,i);function n(){var e=i!==null&&i.apply(this,arguments)||this;return e.imageRef=p.createRef(),e.videoRef=p.createRef(),e.containerPosition={x:0,y:0},e.containerRef=null,e.styleRef=null,e.containerRect=null,e.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},e.dragStartPosition={x:0,y:0},e.dragStartCrop={x:0,y:0},e.gestureZoomStart=0,e.gestureRotationStart=0,e.isTouching=!1,e.lastPinchDistance=0,e.lastPinchRotation=0,e.rafDragTimeout=null,e.rafPinchTimeout=null,e.wheelTimer=null,e.currentDoc=typeof document<"u"?document:null,e.currentWindow=typeof window<"u"?window:null,e.resizeObserver=null,e.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},e.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!e.containerRef)){var t=!0;e.resizeObserver=new window.ResizeObserver(function(o){if(t){t=!1;return}e.computeSizes()}),e.resizeObserver.observe(e.containerRef)}},e.preventZoomSafari=function(t){return t.preventDefault()},e.cleanEvents=function(){e.currentDoc&&(e.currentDoc.removeEventListener("mousemove",e.onMouseMove),e.currentDoc.removeEventListener("mouseup",e.onDragStopped),e.currentDoc.removeEventListener("touchmove",e.onTouchMove),e.currentDoc.removeEventListener("touchend",e.onDragStopped),e.currentDoc.removeEventListener("gesturemove",e.onGestureMove),e.currentDoc.removeEventListener("gestureend",e.onGestureEnd),e.currentDoc.removeEventListener("scroll",e.onScroll))},e.clearScrollEvent=function(){e.containerRef&&e.containerRef.removeEventListener("wheel",e.onWheel),e.wheelTimer&&clearTimeout(e.wheelTimer)},e.onMediaLoad=function(){var t=e.computeSizes();t&&(e.emitCropData(),e.setInitialCrop(t)),e.props.onMediaLoaded&&e.props.onMediaLoaded(e.mediaSize)},e.setInitialCrop=function(t){if(e.props.initialCroppedAreaPercentages){var o=it(e.props.initialCroppedAreaPercentages,e.mediaSize,e.props.rotation,t,e.props.minZoom,e.props.maxZoom),r=o.crop,a=o.zoom;e.props.onCropChange(r),e.props.onZoomChange&&e.props.onZoomChange(a)}else if(e.props.initialCroppedAreaPixels){var s=at(e.props.initialCroppedAreaPixels,e.mediaSize,e.props.rotation,t,e.props.minZoom,e.props.maxZoom),r=s.crop,a=s.zoom;e.props.onCropChange(r),e.props.onZoomChange&&e.props.onZoomChange(a)}},e.computeSizes=function(){var t,o,r,a,s,c,d=e.imageRef.current||e.videoRef.current;if(d&&e.containerRef){e.containerRect=e.containerRef.getBoundingClientRect(),e.saveContainerPosition();var h=e.containerRect.width/e.containerRect.height,l=((t=e.imageRef.current)===null||t===void 0?void 0:t.naturalWidth)||((o=e.videoRef.current)===null||o===void 0?void 0:o.videoWidth)||0,f=((r=e.imageRef.current)===null||r===void 0?void 0:r.naturalHeight)||((a=e.videoRef.current)===null||a===void 0?void 0:a.videoHeight)||0,C=d.offsetWidth<l||d.offsetHeight<f,m=l/f,w=void 0;if(C)switch(e.state.mediaObjectFit){default:case"contain":w=h>m?{width:e.containerRect.height*m,height:e.containerRect.height}:{width:e.containerRect.width,height:e.containerRect.width/m};break;case"horizontal-cover":w={width:e.containerRect.width,height:e.containerRect.width/m};break;case"vertical-cover":w={width:e.containerRect.height*m,height:e.containerRect.height};break}else w={width:d.offsetWidth,height:d.offsetHeight};e.mediaSize=y(y({},w),{naturalWidth:l,naturalHeight:f}),e.props.setMediaSize&&e.props.setMediaSize(e.mediaSize);var b=e.props.cropSize?e.props.cropSize:Qe(e.mediaSize.width,e.mediaSize.height,e.containerRect.width,e.containerRect.height,e.props.aspect,e.props.rotation);return(((s=e.state.cropSize)===null||s===void 0?void 0:s.height)!==b.height||((c=e.state.cropSize)===null||c===void 0?void 0:c.width)!==b.width)&&e.props.onCropSizeChange&&e.props.onCropSizeChange(b),e.setState({cropSize:b},e.recomputeCropPosition),e.props.setCropSize&&e.props.setCropSize(b),b}},e.saveContainerPosition=function(){if(e.containerRef){var t=e.containerRef.getBoundingClientRect();e.containerPosition={x:t.left,y:t.top}}},e.onMouseDown=function(t){e.currentDoc&&(t.preventDefault(),e.currentDoc.addEventListener("mousemove",e.onMouseMove),e.currentDoc.addEventListener("mouseup",e.onDragStopped),e.saveContainerPosition(),e.onDragStart(n.getMousePoint(t)))},e.onMouseMove=function(t){return e.onDrag(n.getMousePoint(t))},e.onScroll=function(t){e.currentDoc&&(t.preventDefault(),e.saveContainerPosition())},e.onTouchStart=function(t){e.currentDoc&&(e.isTouching=!0,!(e.props.onTouchRequest&&!e.props.onTouchRequest(t))&&(e.currentDoc.addEventListener("touchmove",e.onTouchMove,{passive:!1}),e.currentDoc.addEventListener("touchend",e.onDragStopped),e.saveContainerPosition(),t.touches.length===2?e.onPinchStart(t):t.touches.length===1&&e.onDragStart(n.getTouchPoint(t.touches[0]))))},e.onTouchMove=function(t){t.preventDefault(),t.touches.length===2?e.onPinchMove(t):t.touches.length===1&&e.onDrag(n.getTouchPoint(t.touches[0]))},e.onGestureStart=function(t){e.currentDoc&&(t.preventDefault(),e.currentDoc.addEventListener("gesturechange",e.onGestureMove),e.currentDoc.addEventListener("gestureend",e.onGestureEnd),e.gestureZoomStart=e.props.zoom,e.gestureRotationStart=e.props.rotation)},e.onGestureMove=function(t){if(t.preventDefault(),!e.isTouching){var o=n.getMousePoint(t),r=e.gestureZoomStart-1+t.scale;if(e.setNewZoom(r,o,{shouldUpdatePosition:!0}),e.props.onRotationChange){var a=e.gestureRotationStart+t.rotation;e.props.onRotationChange(a)}}},e.onGestureEnd=function(t){e.cleanEvents()},e.onDragStart=function(t){var o,r,a=t.x,s=t.y;e.dragStartPosition={x:a,y:s},e.dragStartCrop=y({},e.props.crop),(r=(o=e.props).onInteractionStart)===null||r===void 0||r.call(o)},e.onDrag=function(t){var o=t.x,r=t.y;e.currentWindow&&(e.rafDragTimeout&&e.currentWindow.cancelAnimationFrame(e.rafDragTimeout),e.rafDragTimeout=e.currentWindow.requestAnimationFrame(function(){if(e.state.cropSize&&!(o===void 0||r===void 0)){var a=o-e.dragStartPosition.x,s=r-e.dragStartPosition.y,c={x:e.dragStartCrop.x+a,y:e.dragStartCrop.y+s},d=e.props.restrictPosition?L(c,e.mediaSize,e.state.cropSize,e.props.zoom,e.props.rotation):c;e.props.onCropChange(d)}}))},e.onDragStopped=function(){var t,o;e.isTouching=!1,e.cleanEvents(),e.emitCropData(),(o=(t=e.props).onInteractionEnd)===null||o===void 0||o.call(t)},e.onWheel=function(t){if(e.currentWindow&&!(e.props.onWheelRequest&&!e.props.onWheelRequest(t))){t.preventDefault();var o=n.getMousePoint(t),r=Je(t).pixelY,a=e.props.zoom-r*e.props.zoomSpeed/200;e.setNewZoom(a,o,{shouldUpdatePosition:!0}),e.state.hasWheelJustStarted||e.setState({hasWheelJustStarted:!0},function(){var s,c;return(c=(s=e.props).onInteractionStart)===null||c===void 0?void 0:c.call(s)}),e.wheelTimer&&clearTimeout(e.wheelTimer),e.wheelTimer=e.currentWindow.setTimeout(function(){return e.setState({hasWheelJustStarted:!1},function(){var s,c;return(c=(s=e.props).onInteractionEnd)===null||c===void 0?void 0:c.call(s)})},250)}},e.getPointOnContainer=function(t,o){var r=t.x,a=t.y;if(!e.containerRect)throw new Error("The Cropper is not mounted");return{x:e.containerRect.width/2-(r-o.x),y:e.containerRect.height/2-(a-o.y)}},e.getPointOnMedia=function(t){var o=t.x,r=t.y,a=e.props,s=a.crop,c=a.zoom;return{x:(o+s.x)/c,y:(r+s.y)/c}},e.setNewZoom=function(t,o,r){var a=r===void 0?{}:r,s=a.shouldUpdatePosition,c=s===void 0?!0:s;if(!(!e.state.cropSize||!e.props.onZoomChange)){var d=V(t,e.props.minZoom,e.props.maxZoom);if(c){var h=e.getPointOnContainer(o,e.containerPosition),l=e.getPointOnMedia(h),f={x:l.x*d-h.x,y:l.y*d-h.y},C=e.props.restrictPosition?L(f,e.mediaSize,e.state.cropSize,d,e.props.rotation):f;e.props.onCropChange(C)}e.props.onZoomChange(d)}},e.getCropData=function(){if(!e.state.cropSize)return null;var t=e.props.restrictPosition?L(e.props.crop,e.mediaSize,e.state.cropSize,e.props.zoom,e.props.rotation):e.props.crop;return tt(t,e.mediaSize,e.state.cropSize,e.getAspect(),e.props.zoom,e.props.rotation,e.props.restrictPosition)},e.emitCropData=function(){var t=e.getCropData();if(t){var o=t.croppedAreaPercentages,r=t.croppedAreaPixels;e.props.onCropComplete&&e.props.onCropComplete(o,r),e.props.onCropAreaChange&&e.props.onCropAreaChange(o,r)}},e.emitCropAreaChange=function(){var t=e.getCropData();if(t){var o=t.croppedAreaPercentages,r=t.croppedAreaPixels;e.props.onCropAreaChange&&e.props.onCropAreaChange(o,r)}},e.recomputeCropPosition=function(){if(e.state.cropSize){var t=e.props.restrictPosition?L(e.props.crop,e.mediaSize,e.state.cropSize,e.props.zoom,e.props.rotation):e.props.crop;e.props.onCropChange(t),e.emitCropData()}},e.onKeyDown=function(t){var o=e.props,r=o.crop,a=o.onCropChange,s=o.keyboardStep,c=o.zoom,d=o.rotation,h=s;if(e.state.cropSize){t.shiftKey&&(h*=.2);var l=y({},r);switch(t.key){case"ArrowUp":l.y-=h,t.preventDefault();break;case"ArrowDown":l.y+=h,t.preventDefault();break;case"ArrowLeft":l.x-=h,t.preventDefault();break;case"ArrowRight":l.x+=h,t.preventDefault();break;default:return}e.props.restrictPosition&&(l=L(l,e.mediaSize,e.state.cropSize,c,d)),a(l)}},e}return n.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=ct,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef))},n.prototype.componentWillUnmount=function(){var e,t;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((t=this.styleRef.parentNode)===null||t===void 0||t.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},n.prototype.componentDidUpdate=function(e){var t,o,r,a,s,c,d,h,l;e.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):e.aspect!==this.props.aspect?this.computeSizes():e.objectFit!==this.props.objectFit?this.computeSizes():e.zoom!==this.props.zoom?this.recomputeCropPosition():((t=e.cropSize)===null||t===void 0?void 0:t.height)!==((o=this.props.cropSize)===null||o===void 0?void 0:o.height)||((r=e.cropSize)===null||r===void 0?void 0:r.width)!==((a=this.props.cropSize)===null||a===void 0?void 0:a.width)?this.computeSizes():(((s=e.crop)===null||s===void 0?void 0:s.x)!==((c=this.props.crop)===null||c===void 0?void 0:c.x)||((d=e.crop)===null||d===void 0?void 0:d.y)!==((h=this.props.crop)===null||h===void 0?void 0:h.y))&&this.emitCropAreaChange(),e.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),e.video!==this.props.video&&((l=this.videoRef.current)===null||l===void 0||l.load());var f=this.getObjectFit();f!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:f},this.computeSizes)},n.prototype.getAspect=function(){var e=this.props,t=e.cropSize,o=e.aspect;return t?t.width/t.height:o},n.prototype.getObjectFit=function(){var e,t,o,r;if(this.props.objectFit==="cover"){var a=this.imageRef.current||this.videoRef.current;if(a&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var s=this.containerRect.width/this.containerRect.height,c=((e=this.imageRef.current)===null||e===void 0?void 0:e.naturalWidth)||((t=this.videoRef.current)===null||t===void 0?void 0:t.videoWidth)||0,d=((o=this.imageRef.current)===null||o===void 0?void 0:o.naturalHeight)||((r=this.videoRef.current)===null||r===void 0?void 0:r.videoHeight)||0,h=c/d;return h<s?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},n.prototype.onPinchStart=function(e){var t=n.getTouchPoint(e.touches[0]),o=n.getTouchPoint(e.touches[1]);this.lastPinchDistance=le(t,o),this.lastPinchRotation=pe(t,o),this.onDragStart(fe(t,o))},n.prototype.onPinchMove=function(e){var t=this;if(!(!this.currentDoc||!this.currentWindow)){var o=n.getTouchPoint(e.touches[0]),r=n.getTouchPoint(e.touches[1]),a=fe(o,r);this.onDrag(a),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var s=le(o,r),c=t.props.zoom*(s/t.lastPinchDistance);t.setNewZoom(c,a,{shouldUpdatePosition:!1}),t.lastPinchDistance=s;var d=pe(o,r),h=t.props.rotation+(d-t.lastPinchRotation);t.props.onRotationChange&&t.props.onRotationChange(h),t.lastPinchRotation=d})}},n.prototype.render=function(){var e=this,t,o=this.props,r=o.image,a=o.video,s=o.mediaProps,c=o.transform,d=o.crop,h=d.x,l=d.y,f=o.rotation,C=o.zoom,m=o.cropShape,w=o.showGrid,b=o.style,A=b.containerStyle,D=b.cropAreaStyle,F=b.mediaStyle,_=o.classes,Z=_.containerClassName,I=_.cropAreaClassName,z=_.mediaClassName,E=(t=this.state.mediaObjectFit)!==null&&t!==void 0?t:this.getObjectFit();return p.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(g){return e.containerRef=g},"data-testid":"container",style:A,className:H("reactEasyCrop_Container",Z)},r?p.createElement("img",y({alt:"",className:H("reactEasyCrop_Image",E==="contain"&&"reactEasyCrop_Contain",E==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",E==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",z)},s,{src:r,ref:this.imageRef,style:y(y({},F),{transform:c||"translate(".concat(h,"px, ").concat(l,"px) rotate(").concat(f,"deg) scale(").concat(C,")")}),onLoad:this.onMediaLoad})):a&&p.createElement("video",y({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:H("reactEasyCrop_Video",E==="contain"&&"reactEasyCrop_Contain",E==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",E==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",z)},s,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:y(y({},F),{transform:c||"translate(".concat(h,"px, ").concat(l,"px) rotate(").concat(f,"deg) scale(").concat(C,")")}),controls:!1}),(Array.isArray(a)?a:[{src:a}]).map(function(x){return p.createElement("source",y({key:x.src},x))})),this.state.cropSize&&p.createElement("div",{style:y(y({},D),{width:this.state.cropSize.width,height:this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,"data-testid":"cropper",className:H("reactEasyCrop_CropArea",m==="round"&&"reactEasyCrop_CropAreaRound",w&&"reactEasyCrop_CropAreaGrid",I)}))},n.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:dt,minZoom:ut,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:ht},n.getMousePoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},n.getTouchPoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},n}(p.Component);const Ee=i=>u.jsxs("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...i,children:[u.jsx("path",{fill:"currentColor",d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5A6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14z"}),u.jsx("path",{fill:"currentColor",d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]}),Me=i=>u.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...i,children:u.jsx("path",{fill:"currentColor",d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5A6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14zM7 9h5v1H7z"})}),lt=i=>new Promise((n,e)=>{const t=new Image;t.addEventListener("load",()=>n(t)),t.addEventListener("error",o=>e(o)),t.setAttribute("crossOrigin","anonymous"),t.src=i});function ze(i){return i*Math.PI/180}function pt(i,n,e){const t=ze(e);return{width:Math.abs(Math.cos(t)*i)+Math.abs(Math.sin(t)*n),height:Math.abs(Math.sin(t)*i)+Math.abs(Math.cos(t)*n)}}async function Pe(i,n,e=0,t={horizontal:!1,vertical:!1}){const o=await lt(i),r=document.createElement("canvas"),a=r.getContext("2d");if(!a)return null;const s=ze(e),{width:c,height:d}=pt(o.width,o.height,e);r.width=c,r.height=d,a.translate(c/2,d/2),a.rotate(s),a.scale(t.horizontal?-1:1,t.vertical?-1:1),a.translate(-o.width/2,-o.height/2),a.drawImage(o,0,0);const h=document.createElement("canvas"),l=h.getContext("2d");return l?(h.width=n.width,h.height=n.height,l.drawImage(r,n.x,n.y,n.width,n.height,0,0,n.width,n.height),new Promise(f=>h.toBlob(C=>f(C)))):null}const K=200,ae=async i=>{const n=document.createElement("img");n.src=URL.createObjectURL(i),n.style.display="none",document.body.appendChild(n),await new Promise(t=>{n.onload=()=>{t()}});const e={width:n.width,height:n.height};return document.body.removeChild(n),e},ft=p.forwardRef(function(n,e){const{allowedFileTypes:t="image/png, image/jpeg",maxHeight:o=K,maxWidth:r=K,cropShape:a}=n,[s,c]=p.useState(!1),{t:d}=Ze(["action"]),[h,l]=p.useState(1),[f,C]=p.useState(1),[m,w]=p.useState(3),[b,A]=p.useState({x:0,y:0}),[D,F]=p.useState(!1),[_,Z]=p.useState(null),I=$(_),[z,E]=p.useState(null),x=$(z),g=Math.max(r,o),M=p.useCallback(async v=>{const S=await ae(v),P=Math.min(1,Number((Math.min(S.width,S.height)/g).toFixed(2))),j=Math.max(1,Number((Math.max(S.width,S.height)/g).toFixed(2)));C(P),w(j),l(P),Z(v),F(v.type==="image/gif"),W(void 0,{width:S.width,height:S.height,x:0,y:0})},[g]),W=p.useCallback(me(async(v,S)=>{if(_)try{c(!0);const P=D?await Le(async()=>{const{cropGif:j}=await import("./gifsicle-utils-D8FKSZ_X.js");return{cropGif:j}},__vite__mapDeps([0,1,2]),import.meta.url).then(({cropGif:j})=>j(_,S)):await ve(_,j=>Pe(j,S));P&&(E(P),c(!1))}catch(P){q.error("Failed to crop image: ",P.message)}},1e3),[D,_]);return p.useImperativeHandle(e,()=>({getImage:async()=>{let v=null;return D?v=z:v=await Ue(z,{maxWidthOrHeight:g,maxSizeMB:1,useWebWorker:!0,fileType:"image/png"}),v},zoom:h}),[z,D,g,h]),u.jsxs("div",{children:[u.jsxs("div",{className:"flex flex-wrap w-full p-8 gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h3",{children:d("action:drag-and-move-hint")}),I?u.jsx(ke,{onDrop:v=>{M(v[0])},noClick:!0,noKeyboard:!0,children:({getRootProps:v,getInputProps:S})=>u.jsxs("div",{...v(),className:"relative h-[250px] w-[250px] m-[25px]",children:[u.jsx(De,{image:I,crop:b,zoom:h,maxZoom:m,minZoom:f,aspect:r/o,showGrid:!1,onCropChange:A,onCropComplete:W,onZoomChange:P=>{l(Number(P.toFixed(2)))},cropShape:a}),u.jsx("input",{...S()})]})}):u.jsx("div",{style:{width:250,height:250}})]}),u.jsxs("div",{className:"flex-1 relative",children:[u.jsx("h3",{children:d("action:preview")}),u.jsxs("div",{className:"w-full h-full mt-4 flex items-center justify-center relative",children:[x&&u.jsx("img",{width:r,height:o,src:x,className:ge("object-cover",a==="round"&&"rounded-full")}),s&&u.jsx("div",{className:"absolute w-full h-full bg-stone-800/80 top-0 left-0 flex items-center justify-center text-xl text-white backdrop-blur-sm",children:"Loading…"})]})]})]}),x&&u.jsxs("div",{className:"w-full flex gap-2 items-center",children:[u.jsx(Me,{className:"size-6"}),u.jsx(we,{disabled:s,className:"flex-1",value:h,step:.01,min:f,max:m,onChange:(v,S)=>{typeof S=="number"&&l(Number(S.toFixed(2)))}}),u.jsx(Ee,{className:"size-6"})]}),u.jsx("div",{children:u.jsx("input",{disabled:s,type:"file",onChange:v=>{if(!(!v.target.files||v.target.files.length===0))return M(v.target.files[0])},accept:t})})]})});function mt(i){const{maxHeight:n=K,maxWidth:e=K,cropShape:t}=i,o=i.file,[r,a]=p.useState(),[s,c]=p.useState(1),[d,h]=p.useState(1),[l,f]=p.useState(3),[C,m]=p.useState(!1),[w,b]=p.useState(null),A=$(w),D=Math.max(e,n),[F,_]=p.useState({x:0,y:0}),Z=p.useCallback(async x=>{m(!1);const g=await ae(x),M=Math.min(1,Number((Math.min(g.width,g.height)/D).toFixed(2))),W=Math.max(1,Number((Math.max(g.width,g.height)/D).toFixed(2)));h(M),f(W),c(M),setTimeout(()=>{m(!0)},300)},[D]);p.useEffect(()=>{Z(o);const x=URL.createObjectURL(o);return a(x),()=>{URL.revokeObjectURL(x)}},[o]);const I=p.useCallback(me(async(x,g)=>{if(o)try{const M=await ve(o,W=>Pe(W,g));M&&b(M)}catch(M){q.error("Failed to crop image: ",M.message)}},1e3),[o]),z=p.useCallback(()=>{w?(i.resolve(w),i.close()):q.error("Result not exists")},[w]),E=p.useCallback(()=>{i.resolve(void 0),i.close()},[]);return u.jsxs(u.Fragment,{children:[u.jsx(We,{heading:u.jsx(T,{i18nKey:"action:drag-and-move-hint"})}),u.jsxs(Te,{children:[u.jsxs("div",{className:"flex flex-wrap w-full gap-6",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h3",{children:u.jsx(T,{i18nKey:"action:drag-and-move-hint"})}),u.jsx("div",{className:"relative mt-1",style:{width:e,height:n},children:C&&u.jsx(De,{image:r,crop:F,zoom:s,maxZoom:l,minZoom:d,aspect:e/n,showGrid:!1,onCropChange:_,onCropComplete:I,onZoomChange:x=>{c(Number(x.toFixed(2)))},cropShape:t})})]}),u.jsxs("div",{className:"flex-1 relative",children:[u.jsx("h3",{children:u.jsx(T,{i18nKey:"action:preview"})}),u.jsx("div",{className:"flex items-center justify-center relative mt-1",style:{width:e,height:n},children:A&&u.jsx("img",{width:e,height:n,src:A,className:ge("object-cover",t==="round"&&"rounded-full")})})]})]}),u.jsxs("div",{className:"w-full flex gap-2 items-center mt-4",children:[u.jsx(Me,{className:"size-6"}),u.jsx(we,{className:"flex-1",value:s,step:.01,min:d,max:l,onChange:(x,g)=>{typeof g=="number"&&c(Number(g.toFixed(2)))}}),u.jsx(Ee,{className:"size-6"})]})]}),u.jsxs(Oe,{children:[u.jsx(Y,{onPress:E,variant:"outlined",children:u.jsx(T,{i18nKey:"action:crop.skip-crop.label"})}),u.jsx(Y,{onPress:z,variant:"filled",children:u.jsx(T,{i18nKey:"action:confirm"})})]})]})}async function je(i){return Fe.create({dismissable:!0,children:({resolve:n,closeDialog:e})=>u.jsx(mt,{file:i.file,resolve:n,close:e}),className:"max-w-screen-mlg"})}function gt(i){return i.media?u.jsx(Y,{variant:"filled",busy:"auto",onPress:async()=>{const n=await Ie(i.media);if(!n)return;const e=await je({file:n});e&&i.action(e)},children:u.jsx(T,{i18nKey:"action:crop.adjust-crop.label"})}):null}const bt=Object.freeze(Object.defineProperty({__proto__:null,CropCurrentImageForUploadButton:gt,default:ft,dialogCropImage:je,getFileSize:ae},Symbol.toStringTag,{value:"Module"}));export{gt as C,Pe as a,De as b,bt as c,je as d,ae as g,Ee as i};
//# sourceMappingURL=index-qPceTsh8.js.map
