import{j as r}from"./vendor-motion-Bl2lDopP.js";import{r as c}from"./vendor-apollo-B9XqHIAo.js";import{u as y,a as b,b as h,m as u,G as w,H as x,t as v,j as _,I as C,U as M}from"./index-JhqgbpkX.js";import{u as j}from"./vendor-i18next-TC5y0B3W.js";import{d as T}from"./vendor-react-router-Bm0RsDwP.js";import{q as E,v as I,O as k}from"./vendor-mui-DTp04zm4.js";import"./vendor-graphql-DeSYh9DC.js";import"./vendor-amplitude-core-CQMkGYFj.js";import"./vendor-firebase-BKQqa5bK.js";import"./vendor-axios-CFwfAwt2.js";import"./vendor-lodash-992l3ZN7.js";import"./vendor-sentry-BZZLy1DV.js";import"./vendor-react-aria-BW9JtD2p.js";import"./vendor-markdown-1uD3znr6.js";import"./i18n-resources-43uzMSBc.js";import"./vendor-hls-cbDBXQj9.js";import"./vendor-tldraw-CaaMemrL.js";import"./vendor-fabric-Bg02ktlP.js";import"./vendor-radix-ui-DX5JiNHB.js";import"./vendor-photoswipe-UqzIRFho.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"0ec442be81a4ee21bfcf5745e8ef10bc76836958"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},o=new e.Error().stack;o&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[o]="4f12e1a4-0c50-4831-80a6-25d09edb1c90",e._sentryDebugIdIdentifier="sentry-dbid-4f12e1a4-0c50-4831-80a6-25d09edb1c90")})()}catch{}(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=function(o){for(var s=1;s<arguments.length;s++){var t=arguments[s];if(t!=null)for(var a in t)t.hasOwnProperty(a)&&(o[a]=t[a])}return o}({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}catch{}})();const N=e=>typeof e!="string"||e.length<8?!1:/[A-Za-z0-9]+/.test(e),D=()=>{const{t:e}=j(["user","common"]),[{code:o,to:s}]=y(),[t,a]=c.useState(()=>o||""),[n,i]=c.useState(""),{data:d}=b(),f=T(),[m,p]=h(async l=>{if(l.preventDefault(),u("redeem_code_submit_click",{code:t}),!!t){if(!d?.id)return w();if(!N(t))return i(e("user:code-redemption.redeem-code.notice.invalid"));try{await x({couponCode:t}),v.success(e("user:code-redemption.redeem-code.notice.success")),u("redeem_code_submit_success",{code:t}),setTimeout(()=>{f(s??`/@${d.username}/credits`)},3e3)}catch(g){i(e("user:code-redemption.redeem-code.notice.failure",{message:g?.message}))}}},[d?.id,t]);return r.jsxs("main",{className:"w-full flex flex-col max-w-lg mx-auto min-h-[calc(var(--visible-height)-var(--app-header-height)-84px)]",children:[r.jsx(_,{content:e("common:meta.title.code-redemption")}),r.jsx(C,{className:"mt-44",title:e("user:code-redemption.redeem-code.hero.title")}),r.jsxs("form",{onSubmit:p,className:"w-full flex flex-col gap-4",children:[r.jsxs(E,{variant:"standard",error:!!n,className:"mt-16",children:[n?r.jsx(I,{severity:"warning",className:"mb-4",children:n}):null,r.jsx(k,{value:t,onChange:l=>{n&&i(""),a(l.target.value)},id:"code-input",type:"text",autoComplete:"off",autoCapitalize:"off",spellCheck:!1,required:!0,placeholder:e("user:code-redemption.redeem-code.input-placeholder")})]}),r.jsx(M,{variant:"filled",size:"large",type:"submit",busy:m,disabled:!t,children:e("user:code-redemption.redeem-code.action-label")})]})]})},J=D;export{J as Component};
