import{j as e}from"./vendor-motion-Bl2lDopP.js";import{r as c}from"./vendor-apollo-B9XqHIAo.js";import{cK as R,p as v,m as w,cL as G,ce as B,cM as y,aG as P,cN as H,w as z,cO as K,cP as U,P as F,cQ as V,u as A,cR as q,cS as S,aj as W,ak as b}from"./index-JhqgbpkX.js";import{L as N,d as Y}from"./vendor-react-router-Bm0RsDwP.js";import{u as Z,W as J,m as D}from"./WorldFollowButton-BYKmQ9zF.js";import{I as T,ag as X,ah as _}from"./vendor-mui-DTp04zm4.js";import{u as k}from"./vendor-i18next-TC5y0B3W.js";import{S as ee}from"./SearchForm-BZr1F1ci.js";import{w as L}from"./vendor-firebase-BKQqa5bK.js";import{g as E}from"./vendor-graphql-DeSYh9DC.js";import"./vendor-amplitude-core-CQMkGYFj.js";import"./vendor-axios-CFwfAwt2.js";import"./vendor-lodash-992l3ZN7.js";import"./vendor-sentry-BZZLy1DV.js";import"./vendor-react-aria-BW9JtD2p.js";import"./vendor-markdown-1uD3znr6.js";import"./i18n-resources-43uzMSBc.js";import"./vendor-hls-cbDBXQj9.js";import"./vendor-tldraw-CaaMemrL.js";import"./vendor-fabric-Bg02ktlP.js";import"./vendor-radix-ui-DX5JiNHB.js";import"./vendor-photoswipe-UqzIRFho.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};s.SENTRY_RELEASE={id:"0ec442be81a4ee21bfcf5745e8ef10bc76836958"}}catch{}})();try{(function(){var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new s.Error().stack;r&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[r]="a64565f7-7c99-4729-bfe8-1c5e3e9c2b18",s._sentryDebugIdIdentifier="sentry-dbid-a64565f7-7c99-4729-bfe8-1c5e3e9c2b18")})()}catch{}(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};s._sentryModuleMetadata=s._sentryModuleMetadata||{},s._sentryModuleMetadata[new s.Error().stack]=function(r){for(var a=1;a<arguments.length;a++){var o=arguments[a];if(o!=null)for(var l in o)o.hasOwnProperty(l)&&(r[l]=o[l])}return r}({},s._sentryModuleMetadata[new s.Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}catch{}})();const se=s=>e.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...s,children:e.jsx("path",{fill:"currentColor",d:"m14 18l-6-6l6-6l1.4 1.4l-4.6 4.6l4.6 4.6L14 18Z"})});function te({artworks:s,showControlButton:r}){const a=c.useRef(null);return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"flex gap-3 overflow-x-auto scrollbar-hidden",ref:a,children:s.map((o,l)=>e.jsx(R,{artwork:o,character:o.character,size:"medium",mobileSize:"medium",scene:"character"},`character-${l}`))}),r&&e.jsx($,{className:"mt-[24.5px] mr-[15%] justify-end gap-6",controller:a,step:240,scene:"character"})]})}function $({controller:s,step:r,className:a,iconClassName:o,scene:l}){const[m,f]=c.useState(!1),[i,p]=c.useState(!1);return c.useEffect(()=>{function d(){const h=s.current;if(h){const u=h.scrollLeft>0;f(u);const M=h.scrollLeft+h.clientWidth<h.scrollWidth;p(M)}}d();const n=s.current,g=new ResizeObserver(d);return n&&(n.addEventListener("scroll",d,{passive:!0}),g.observe(n)),()=>{n&&(n.removeEventListener("scroll",d),g.unobserve(n))}},[s]),e.jsxs("div",{className:v("flex",a),children:[e.jsx(T,{className:v("shadow",o),size:"small",disabled:!m,onClick:()=>{s.current?.scrollBy({left:-r,behavior:"smooth"}),setTimeout(()=>w("wc_chter_navi",{cate:"backward",location:i?void 0:"lastpage",scene:l}),0)},children:e.jsx(se,{})}),e.jsx(T,{className:v("shadow",o),size:"small",disabled:!i,onClick:()=>{s.current?.scrollBy({left:r,behavior:"smooth"}),setTimeout(()=>w("wc_chter_navi",{cate:"forward",location:i?void 0:"lastpage",scene:l}),0)},children:e.jsx(G,{})})]})}const C=()=>{w("wc_world_enter",{scene:"world"}),setTimeout(()=>{window.scrollTo(0,0)},100)};function re({world:s,tags:r}){const{t:a}=k("worlds"),{characters:o,loading:l}=Z(s.id),[m,f]=c.useState(0),i=c.useRef(null),p=y(s.locales,"name",s.name),d=y(s.locales,"description",s.description);return e.jsxs("div",{className:"flex gap-5 rounded-2xl ring-1 ring-black/10 dark:ring-white/10 hover:shadow-[0_4px_20px_0_rgba(0,0,0,0.15)] transition-all p-3",children:[e.jsx("div",{className:"min-w-[50%] max-w-[50%] h-auto justify-center items-center flex rounded-2xl overflow-hidden",children:e.jsx(N,{className:"w-full h-full",to:`/world/${s.id}`,onClick:C,children:e.jsx("img",{className:"w-full h-full rounded-2xl object-cover",src:P(s.media)})})}),e.jsxs("div",{className:"w-full min-w-0",children:[e.jsxs("div",{className:"flex justify-between gap-4 mb-2 min-w-0 overflow-hidden",children:[e.jsx(N,{className:"text-3xl font-semibold font-roboto leading-10 truncate",to:`/world/${s.id}`,onClick:C,children:p}),e.jsx(J,{className:"text-center rounded-xl transition-all",followingClassName:"px-2 rounded-xl text-gray-500 bg-background-light hover:bg-gray-200",notFollowingClassName:"px-9 hover:bg-purple-600 bg-theme-primary text-white text-base font-semibold leading-none shadow-none",world:s,scene:"world",onClick:n=>{s.followedByMe&&!n?f(-1):!s.followedByMe&&n?f(1):f(0)}})]}),e.jsxs("div",{className:"flex items-start justify-between gap-6",children:[r.length>0?e.jsx(H,{tags:r}):e.jsx("div",{}),e.jsxs("div",{className:"flex py-1 gap-1 items-center text-base leading-none font-semibold text-[#666666]",children:[e.jsx(D,{}),e.jsx("span",{children:z(s.followerCount+m,{uppercase:!0})})]})]}),e.jsx("div",{className:"mt-4 mb-3",children:e.jsx(K,{user:s.user,size:24})}),e.jsx(U,{className:"mr-24 text-black dark:text-white",lines:4,title:a("worlds:world.introduction"),text:d}),e.jsxs("div",{className:"flex justify-between mt-5 mb-3 items-center",children:[e.jsx("div",{className:"text-xl font-semibold font-roboto leading-tight",children:a("worlds:world.character")}),e.jsx($,{className:"gap-3",controller:i,step:120,scene:"world"})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto scrollbar-hidden",ref:i,children:l?e.jsx(F,{className:"my-10 mx-auto",inline:!0}):o.map((n,g)=>e.jsx(V,{artwork:n,character:n.character,size:"small",scene:"world"},`character-${g}`))})]})]})}function ae({world:s}){const r=y(s.locales,"name",s.name);return e.jsx(N,{to:`/world/${s.id}`,onClick:C,children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("img",{className:"w-full h-[243px] object-cover rounded-md",src:P(s.media)}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-lg font-semibold leading-snug truncate",children:r}),e.jsxs("div",{className:"flex gap-1 items-center text-sm leading-[100%] font-semibold",children:[e.jsx(D,{}),e.jsx("span",{children:z(s.followerCount,{uppercase:!0})})]})]})]})})}function I(s){return B()?e.jsx(ae,{...s}):e.jsx(re,{...s})}function le(){const[{type:s,keyword:r}]=A(),{t:a}=k(["worlds"]),o=Y();return e.jsx(ee,{keyword:r,placeholder:a("worlds:search.search-placeholder"),onSubmit:l=>{const m={keyword:l,type:s};w("search",{value:l,type:s,scene:"wnc"}),o(`/worlds/?${q(m)}`)},scene:"w&c",button:"inline"})}const oe=()=>{const{t:s}=k(["worlds","artwork"]),r=B(),[{keyword:a},o]=A(),[l,m]=c.useState(0),f=c.useCallback((t,x)=>{m(x)},[]),{items:i,hasMore:p,loading:d,loadMore:n,totalCount:g,reset:h}=S({fetcher:W.listWorldCharacters,getArgs:t=>({first:36,after:t?.artworks.pageInfo?.endCursor,type:L.Character,keyword:a,feed:"trending"}),getItems:t=>E(t.artworks).reverse(),getHasMore:t=>t.artworks?.pageInfo.hasNextPage??!1,getTotalCount:t=>t.artworks?.totalCount??void 0}),{items:u,hasMore:M,loading:ne,loadMore:Q,totalCount:ie,reset:O}=S({fetcher:W.listWorldCharacters,getArgs:t=>({first:36,after:t?.artworks.pageInfo?.endCursor,type:L.World,keyword:a,feed:"trending"}),getItems:t=>E(t.artworks).reverse(),getHasMore:t=>t.artworks?.pageInfo.hasNextPage??!1,getTotalCount:t=>t.artworks?.totalCount??void 0});return c.useEffect(()=>{h(),O(),n(),Q()},[a]),d?e.jsx(F,{}):e.jsxs("div",{className:"flex flex-col lg:pl-7 lg:mb-8",children:[e.jsx("h1",{className:"text-center text-3xl lg:text-6xl font-normal font-rhodium pt-5 pb-3",children:s("worlds:hero.title")}),e.jsx("h2",{className:"text-center font-inter font-medium leading-none uppercase tracking-widest text-[13px]",children:e.jsx("span",{children:s("worlds:hero.subtitle")})}),e.jsx("div",{className:"w-full mx-auto max-w-3xl mt-4 mb-9 lg:mt-6 lg:mb-[60px]",children:e.jsx(le,{})}),a?e.jsxs(e.Fragment,{children:[e.jsxs(X,{className:"mb-6",value:l,onChange:f,children:[e.jsx(_,{className:"font-roboto",label:s("worlds:world.character")}),e.jsx(_,{label:s("worlds:world.world")})]}),l===0&&e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[i.length===0&&e.jsx(b,{}),i.map((t,x)=>e.jsx(R,{artwork:t,character:t.character,size:"medium",mobileSize:"large",scene:"character"},`character-${x}`))]}),l===1&&e.jsxs("div",{className:"flex flex-col gap-4",children:[u.length===0&&e.jsx(b,{description:s("artwork:search-results.empty-without-keyword")}),u.map(({world:t,tags:x},j)=>e.jsx(I,{world:t,tags:x},j))]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"gap-6 mb-9 lg:mb-[60px]",children:[e.jsx("h3",{className:"text-base lg:text-2xl font-semibold font-roboto leading-[30px] mb-3 lg:mb-6",children:s("worlds:trending-characters")}),i.length===0&&e.jsx(b,{description:s("artwork:search-results.empty-without-keyword")}),e.jsx(te,{artworks:i,showControlButton:!r})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base lg:text-2xl font-semibold font-roboto leading-[30px] mb-3 lg:mb-6",children:s("worlds:world.heading")}),e.jsxs("ul",{className:"flex flex-col gap-5 lg:gap-4",children:[u.length===0&&e.jsx(b,{}),u.map(({world:t,tags:x},j)=>e.jsx("li",{children:e.jsx(I,{world:t,tags:x})},`world-${j}`))]})]})]})]})},Le=oe;export{Le as Component};
