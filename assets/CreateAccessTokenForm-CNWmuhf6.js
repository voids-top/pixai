import{j as e}from"./vendor-motion-Bl2lDopP.js";import{r as y}from"./vendor-apollo-B9XqHIAo.js";import{f as v,b as k,aj as C,jG as E,U as x}from"./index-JhqgbpkX.js";import{u as I}from"./vendor-i18next-TC5y0B3W.js";import{u as A}from"./useCopyToClipboard-BBBtjKLj.js";import{Q as g,y as _,I as D,ar as M,as as P,at as N,d as m,v as S}from"./vendor-mui-DTp04zm4.js";import"./vendor-graphql-DeSYh9DC.js";import"./vendor-amplitude-core-CQMkGYFj.js";import"./vendor-react-router-Bm0RsDwP.js";import"./vendor-firebase-BKQqa5bK.js";import"./vendor-axios-CFwfAwt2.js";import"./vendor-lodash-992l3ZN7.js";import"./vendor-sentry-BZZLy1DV.js";import"./vendor-react-aria-BW9JtD2p.js";import"./vendor-markdown-1uD3znr6.js";import"./i18n-resources-43uzMSBc.js";import"./vendor-hls-cbDBXQj9.js";import"./vendor-tldraw-CaaMemrL.js";import"./vendor-fabric-Bg02ktlP.js";import"./vendor-radix-ui-DX5JiNHB.js";import"./vendor-photoswipe-UqzIRFho.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};r.SENTRY_RELEASE={id:"0ec442be81a4ee21bfcf5745e8ef10bc76836958"}}catch{}})();try{(function(){var r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new r.Error().stack;n&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[n]="653b62ff-f7c9-45f4-821f-0dda4315a47d",r._sentryDebugIdIdentifier="sentry-dbid-653b62ff-f7c9-45f4-821f-0dda4315a47d")})()}catch{}(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};r._sentryModuleMetadata=r._sentryModuleMetadata||{},r._sentryModuleMetadata[new r.Error().stack]=function(n){for(var t=1;t<arguments.length;t++){var o=arguments[t];if(o!=null)for(var a in o)o.hasOwnProperty(a)&&(n[a]=o[a])}return n}({},r._sentryModuleMetadata[new r.Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}catch{}})();const te=({onCancel:r,onSuccess:n})=>{const{t}=I(["user","common","action"]),{values:{name:o,expireTime:a},handleChange:u,getValues:h}=v(()=>({name:"",expireTime:m().add(1,"month")})),[d,s]=y.useState(null),[f,b]=y.useState(),[,j]=A(),[w,T]=k(async()=>{s(null);const c=await h();if(!c)return;const{name:i,expireTime:p}=c;if(!i)return s(t("user:profile.platform.token.create.error.name-required"));if(i.length<1||i.length>50)return s(t("user:profile.platform.token.create.error.name-length-invalid"));if(!p)return s(t("user:profile.platform.token.create.error.expire-time-required"));try{const l=await C.createAccessToken({input:{name:i,expireTime:p.toISOString()}});b(l.createAccessToken?.secret)}catch(l){l instanceof Error&&s(l.message)}},[]);return e.jsxs("div",{className:"p-8 max-w-full flex flex-col gap-8",children:[e.jsx("h1",{className:"font-semibold text-2xl",children:t("user:profile.platform.token.create.form.title")}),f?e.jsxs(e.Fragment,{children:[e.jsx(g,{label:t("user:profile.platform.token.create.form.secret"),value:f,slotProps:{input:{readOnly:!0,endAdornment:e.jsx(_,{position:"end",children:e.jsx(D,{onClick:()=>j(f),children:e.jsx(E,{className:"size-6"})})})}}}),e.jsx("div",{className:"w-full flex justify-end",children:e.jsx(x,{onPress:n,children:t("common:done")})})]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{label:t("user:profile.platform.token.create.form.name"),value:o,onChange:u("name"),slotProps:{htmlInput:{maxLength:50,maxRows:1}},error:!!d}),e.jsx(M,{dateAdapter:P,children:e.jsx(N,{label:t("user:profile.platform.token.create.form.expire-time"),value:a,maxDate:m().add(2,"years"),minDate:m(),onChange:u("expireTime")})}),d?e.jsx(S,{severity:"error",children:d}):null,e.jsx("div",{className:"w-full flex justify-end",children:e.jsx(x,{busy:w,onPress:T,children:t("action:submit")})})]})]})};export{te as default};
