import{j as e}from"./vendor-motion-Bl2lDopP.js";import{as as h,b as k,l$ as N,m0 as E,d as T,U as M,k as F}from"./index-JhqgbpkX.js";import{r as n}from"./vendor-apollo-B9XqHIAo.js";import{s as g,au as _,av as l,B as p,q as Q,t as R,v as A,al as $,am as L,an as B}from"./vendor-mui-DTp04zm4.js";import{u as D}from"./vendor-i18next-TC5y0B3W.js";import"./vendor-amplitude-core-CQMkGYFj.js";import"./vendor-react-router-Bm0RsDwP.js";import"./vendor-firebase-BKQqa5bK.js";import"./vendor-axios-CFwfAwt2.js";import"./vendor-lodash-992l3ZN7.js";import"./vendor-graphql-DeSYh9DC.js";import"./vendor-sentry-BZZLy1DV.js";import"./vendor-react-aria-BW9JtD2p.js";import"./vendor-markdown-1uD3znr6.js";import"./i18n-resources-43uzMSBc.js";import"./vendor-hls-cbDBXQj9.js";import"./vendor-tldraw-CaaMemrL.js";import"./vendor-fabric-Bg02ktlP.js";import"./vendor-radix-ui-DX5JiNHB.js";import"./vendor-photoswipe-UqzIRFho.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"0ec442be81a4ee21bfcf5745e8ef10bc76836958"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new t.Error().stack;a&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[a]="3df78f21-17ff-4281-b77d-ce0831cafb6f",t._sentryDebugIdIdentifier="sentry-dbid-3df78f21-17ff-4281-b77d-ce0831cafb6f")})()}catch{}(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t._sentryModuleMetadata=t._sentryModuleMetadata||{},t._sentryModuleMetadata[new t.Error().stack]=function(a){for(var o=1;o<arguments.length;o++){var s=arguments[o];if(s!=null)for(var i in s)s.hasOwnProperty(i)&&(a[i]=s[i])}return a}({},t._sentryModuleMetadata[new t.Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}catch{}})();const P=g(_)(({theme:t})=>({[`&.${l.alternativeLabel}`]:{top:10,left:"calc(-50% + 16px)",right:"calc(50% + 16px)"},[`&.${l.active}`]:{[`& .${l.line}`]:{borderColor:"var(--primary)"}},[`&.${l.completed}`]:{[`& .${l.line}`]:{borderColor:"var(--primary)"}},[`& .${l.line}`]:{borderColor:t.palette.mode==="dark"?t.palette.grey[800]:"#eaeaf0",borderTopWidth:3,borderRadius:1}})),O=g("div")(({theme:t,ownerState:a})=>({color:t.palette.mode==="dark"?t.palette.grey[700]:"#eaeaf0",display:"flex",height:22,alignItems:"center",...a.active&&{color:"var(--primary)"},"& .QontoStepIcon-completedIcon":{color:"var(--primary)",zIndex:1,fontSize:18},"& .QontoStepIcon-circle":{width:8,height:8,borderRadius:"50%",backgroundColor:"currentColor"}}));function q(t){const{active:a,completed:o,className:s}=t;return e.jsx(O,{ownerState:{active:a},className:s,children:o?e.jsx(F,{className:"QontoStepIcon-completedIcon"}):e.jsx("div",{className:"QontoStepIcon-circle"})})}const ce=({onCancel:t,onSuccess:a})=>{const{t:o}=D(["action","user"]),[s,i]=n.useState(),[u,d]=n.useState(),[m,f]=n.useState(0),[v,x]=n.useState(""),[y,j]=n.useState(),w=n.useCallback(async()=>{d(void 0);const r=await h({input:{type:"otp"}});r.data?.setupMFA?.url&&(j(r.data?.setupMFA?.recoveryCode),i(r.data?.setupMFA.url))},[]);n.useEffect(()=>{const r=setTimeout(()=>{w()},300);return()=>clearTimeout(r)},[]);const[C,S]=k(async()=>{d(void 0);const r=await N(x);if(!r){d(new Error(o("user:profile.mfa.otp.step2.error.empty")));return}try{await h({input:{type:"otp",code:r}}),f(2)}catch(c){d(new Error(c.message))}},[]),b=[{label:o("user:profile.mfa.otp.step1.label"),content:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:o("user:profile.mfa.otp.step1.description")}),e.jsx("div",{className:"w-full flex justify-center",children:s&&e.jsx("div",{className:"border rounded-lg max-w-sm p-4",children:e.jsx(E,{value:s})})}),e.jsxs("p",{className:"mt-4 w-full flex justify-end gap-4",children:[e.jsx(p,{onClick:t,children:o("action:cancel")}),e.jsx(p,{variant:"contained",color:"primary",onClick:()=>f(1),children:o("user:profile.mfa.otp.step1.next")})]})]})},{label:o("user:profile.mfa.otp.step2.label"),content:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:o("user:profile.mfa.otp.step2.description")}),e.jsxs(Q,{variant:"standard",sx:{maxWidth:"200px"},children:[e.jsx(R,{shrink:!0,children:o("user:profile.mfa.otp.step2.code")}),e.jsx(T,{value:v,onChange:r=>x(r.target.value)})]}),u&&e.jsx(A,{severity:"warning",className:"my-4",children:u.message}),e.jsxs("p",{className:"mt-4 w-full flex justify-end gap-4",children:[e.jsx(p,{onClick:()=>f(0),children:o("user:profile.mfa.otp.step1.back")}),e.jsx(M,{variant:"filled",color:"normal",disabled:C,onPress:S,children:o("user:profile.mfa.otp.step2.next")})]})]})},{label:o("user:profile.mfa.otp.step3.label"),content:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-4 gap-1 list-decimal",children:y&&y.map((r,c)=>e.jsx("li",{className:"font-mono",children:r},c))}),e.jsx("p",{className:"mt-4 w-full flex justify-end gap-4",children:e.jsx(p,{variant:"contained",color:"primary",onClick:a,children:o("user:profile.mfa.otp.step3.next")})})]})}],I=b[m].content;return e.jsxs("div",{className:"p-8 max-w-full flex flex-col gap-8",children:[e.jsx("h1",{className:"font-semibold text-2xl",children:o("user:profile.mfa.otp.title")}),e.jsx($,{alternativeLabel:!0,activeStep:m,connector:e.jsx(P,{}),children:b.map(({label:r},c)=>e.jsx(L,{children:e.jsx(B,{slots:{stepIcon:q},children:r})},c))}),I]})};export{ce as default};
