import{j as r}from"./vendor-motion-Bl2lDopP.js";import{c as h}from"./confetti.module-84Rp1PKD.js";import{r as c}from"./vendor-apollo-B9XqHIAo.js";import{L as _,P as k,a as T}from"./PixchanImages-CHScxbbG.js";import{u as y,aT as j,m,ev as I,aZ as E}from"./index-JhqgbpkX.js";import{$ as M}from"./vendor-firebase-BKQqa5bK.js";import{N as P,d as N}from"./vendor-react-router-Bm0RsDwP.js";import{u as v}from"./vendor-i18next-TC5y0B3W.js";import"./vendor-graphql-DeSYh9DC.js";import"./vendor-amplitude-core-CQMkGYFj.js";import"./vendor-mui-DTp04zm4.js";import"./vendor-axios-CFwfAwt2.js";import"./vendor-lodash-992l3ZN7.js";import"./vendor-sentry-BZZLy1DV.js";import"./vendor-react-aria-BW9JtD2p.js";import"./vendor-markdown-1uD3znr6.js";import"./i18n-resources-43uzMSBc.js";import"./vendor-hls-cbDBXQj9.js";import"./vendor-tldraw-CaaMemrL.js";import"./vendor-fabric-Bg02ktlP.js";import"./vendor-radix-ui-DX5JiNHB.js";import"./vendor-photoswipe-UqzIRFho.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"0ec442be81a4ee21bfcf5745e8ef10bc76836958"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="7f77006f-5039-4959-a4df-b5b768aacfb1",e._sentryDebugIdIdentifier="sentry-dbid-7f77006f-5039-4959-a4df-b5b768aacfb1")})()}catch{}(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=function(t){for(var i=1;i<arguments.length;i++){var n=arguments[i];if(n!=null)for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])}return t}({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}catch{}})();const S=()=>{const[e,t]=c.useState(!1),i=c.useRef(!1),[{itemId:n,interval:s,currency:a,price:l,discountType:p}]=y(),u=c.useRef(!1),{data:{subscription:o,membership:b}={}}=j({pollInterval:e?0:5e3}),d=o?.status,f=d==="active",x=d==="inactive",w=d==="canceled",g=c.useCallback(()=>{m("order_payment_success",{type:s,cate:"normal",number:b?.tier,currency:a,provider:o?.provider,price:l,discountType:p}),I("member_source")},[b?.tier,o?.provider,s,a,p,l]);return c.useEffect(()=>{f&&!i.current&&(h({particleCount:100,scalar:1.5,angle:60,spread:60,origin:{x:0,y:.8},startVelocity:100}),h({particleCount:100,scalar:1.5,angle:120,spread:60,origin:{x:1,y:.8},startVelocity:100}),g())},[f,g]),c.useEffect(()=>{!e&&o&&o.status!=="pending"&&t(!0)},[!!o]),(!n||!s)&&!u.current?r.jsx(P,{to:"/membership/plans",replace:!0}):r.jsx("div",{className:"mt-8 relative py-32 flex flex-col items-center",children:r.jsxs("section",{className:"flex flex-wrap items-center justify-center gap-4",children:[r.jsx(_,{status:f?"success":x||w?"failed":"loading",imgClassName:"w-2/3 aspect-square object-center object-contain mx-auto"}),r.jsxs("div",{className:"flex flex-col items-start gap-2 ml-4 flex-1",children:[r.jsx(R,{subscription:o}),r.jsx(L,{subscription:o})]})]})})},ne=S;function R(e){const{t}=v(["membership"]),i=e.subscription?.status,{title:n,content:s}=M(null).when(()=>e.subscription,()=>({title:t(`membership:landing-page.membership.${i}.title`),content:t(`membership:landing-page.membership.${i}.content`)})).when(()=>i==="pending"&&e.subscription?.invoice?.hostedInvoiceUrl,()=>({title:t("membership:landing-page.membership.actions-needed.title"),content:t("membership:landing-page.membership.actions-needed.content")})).otherwise(()=>({title:t("membership:landing-page.membership.pending.title"),content:t("membership:landing-page.membership.pending.content")}));return r.jsx(k,{title:n,content:s})}function L(e){const[{initialValues:t,submitTask:i}]=y(),{t:n}=v(["membership"]),s=N(),a=e.subscription?.status,l=e.subscription?.invoice?.hostedInvoiceUrl,p=c.useMemo(()=>{if(a==="active")return{label:n("membership:landing-page.action.gen-image"),linkTo:E("/pixai",{initialValues:t,submitTask:i}),action:()=>{m("generate_image_click",{scene:"success"})}};if(a==="pending"&&l)return{label:n("membership:landing-page.action.further-action"),linkTo:l,action:()=>{m("payment_continue_click")}}},[a,t,i]),u=c.useMemo(()=>{if(!(a==="pending"&&l))return a==="active"?{label:n("membership:landing-page.action.back-to-home"),linkTo:"/",action:()=>{m("back_home_click",{scene:"success"})}}:{label:n("membership:landing-page.action.go-back"),action:()=>{m("payment_go_back_click"),s(-1)}}},[a]);return!a||a==="pending"&&!l?null:r.jsx(T,{primaryBtnProps:p,secondaryBtnProps:u})}export{ne as Component};
