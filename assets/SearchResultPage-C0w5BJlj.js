import{j as e}from"./vendor-motion-Bl2lDopP.js";import{r as i}from"./vendor-apollo-B9XqHIAo.js";import{L as C}from"./vendor-react-router-Bm0RsDwP.js";import{b as E,dp as I,L as v,ak as k,dq as B,cO as P,dr as R,a as z,u as G,b7 as h,m as A,M as q,ds as F,c2 as D,cL as U,c1 as $,P as T,dt as Q,bj as _,du as H,bZ as K,bY as Y,b6 as V,dv as W,G as Z}from"./index-JhqgbpkX.js";import{B as J,M as L}from"./ModelGrid-pbezVJd1.js";import{M as X}from"./ModelCard-BbPEsrCH.js";import{g as M}from"./vendor-graphql-DeSYh9DC.js";import{U as ee}from"./UserRecentArtworksPreviewList-Bcd_RU58.js";import{q as S}from"./vendor-lodash-992l3ZN7.js";import{u as se}from"./vendor-i18next-TC5y0B3W.js";import{ag as re,ah as oe}from"./vendor-mui-DTp04zm4.js";import"./vendor-amplitude-core-CQMkGYFj.js";import"./vendor-firebase-BKQqa5bK.js";import"./vendor-axios-CFwfAwt2.js";import"./vendor-sentry-BZZLy1DV.js";import"./vendor-react-aria-BW9JtD2p.js";import"./vendor-markdown-1uD3znr6.js";import"./i18n-resources-43uzMSBc.js";import"./vendor-hls-cbDBXQj9.js";import"./vendor-tldraw-CaaMemrL.js";import"./vendor-fabric-Bg02ktlP.js";import"./vendor-radix-ui-DX5JiNHB.js";import"./vendor-photoswipe-UqzIRFho.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};s.SENTRY_RELEASE={id:"0ec442be81a4ee21bfcf5745e8ef10bc76836958"}}catch{}})();try{(function(){var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new s.Error().stack;a&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[a]="2d6376d5-984c-44f4-a678-8cc1f9206414",s._sentryDebugIdIdentifier="sentry-dbid-2d6376d5-984c-44f4-a678-8cc1f9206414")})()}catch{}(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};s._sentryModuleMetadata=s._sentryModuleMetadata||{},s._sentryModuleMetadata[new s.Error().stack]=function(a){for(var d=1;d<arguments.length;d++){var r=arguments[d];if(r!=null)for(var n in r)r.hasOwnProperty(n)&&(a[n]=r[n])}return a}({},s._sentryModuleMetadata[new s.Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}catch{}})();const te=({keyword:s})=>{const[a,d]=i.useState([]),[r,n]=i.useState(),[c,u]=i.useState(!0),m=i.useRef(),b=20,[x,f]=E(async p=>{try{if(p==null)return;const g=(await I({before:m.current,last:b,keyword:p})).data?.users,w=M(g).reverse();d(y=>S([...y,...w],"id")),n(g?.totalCount),u(!!g?.pageInfo?.hasPreviousPage),m.current=g?.pageInfo?.startCursor}catch(o){console.error("user follow list",o)}},[]);return i.useEffect(()=>{d([]),n(void 0),u(!0),m.current=void 0,f(s)},[s,f]),a.length===0?x?e.jsx(v,{}):e.jsx(k,{}):e.jsx("div",{className:"flex flex-col gap-8",children:e.jsx(B,{totalCount:r,data:a,className:"w-full min-h-screen",endReached:()=>{c&&f()},itemContent:(p,o)=>e.jsxs("div",{className:"w-full flex flex-col gap-4 my-4 pr-4",children:[e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsx(P,{user:o,showUserName:!0,size:44}),e.jsx(R,{userId:o.id,initialValue:o.followedByMe,initialCount:o.followerCount})]}),e.jsx(ee,{userId:o.id})]})})})},t={All:"all",Artwork:"artwork",User:"user",Model:"model"};function Te(){const{t:s}=se(["common","artwork","action","user"]),{data:a,loading:d}=z(),[{q:r,sort:n,showSignUpModal:c,type:u},m]=G(),b=[{label:s("common:visibility.all"),value:t.All},{label:s("user:profile-sub-tab.artwork"),value:t.Artwork},{label:s("artwork:generation.model"),value:t.Model},{label:s("user:user"),value:t.User}],x=[{value:h.mostLiked,label:s("common:order-option.most-liked")},{value:h.newest,label:s("common:order-option.newest")}],f=[{value:h.trending,label:s("common:order-option.random")},{label:s("common:order-option.daily-ranking"),value:h.dailyRanking},...x],p=[{value:h.trending,label:s("common:order-option.trending")},{value:h.mostUsed,label:s("common:order-option.most-used")},...x],o=i.useMemo(()=>Object.values(t).includes(u)?u:t.All,[u]),g=i.useMemo(()=>o===t.Artwork||o===t.Model,[o]),w=i.useMemo(()=>o===t.Artwork||o===t.All,[o]),y=i.useMemo(()=>o===t.All,[o]),N=W(async()=>{Z()});i.useEffect(()=>{Number(c)&&(d||a||(m(l=>({...l,showSignUpModal:null})),N()))},[a,m,N,d,c]);const O=e.jsx(re,{value:o,className:"border-b",variant:"scrollable",allowScrollButtonsMobile:!0,scrollButtons:"auto",children:b.map(l=>e.jsx(oe,{className:"px-4 font-medium text-lg relative no-underline hover:bg-tab-hover active:bg-tab-hover rounded-t-lg whitespace-nowrap",onClick:()=>{A("home_search_tab_click",{tab:l.value}),m(j=>({...j,sort:l.value===t.User||l.value===t.All?null:l.value===t.Artwork?f[0].value:p[0].value,type:l.value}))},value:l.value,label:e.jsx("span",{className:"normal-case",children:l.label})},l.value))});return e.jsxs("div",{className:"justify-center items-center flex flex-col md:px-6",children:[e.jsx(q,{title:r?s("common:meta.title.search-with-keywords",{keywords:r}):s("common:meta.title.search"),description:r?s("common:meta.description.search-with-keywords",{keywords:r}):s("common:meta.description.search")}),e.jsx(F,{descComponent:"h3"}),e.jsxs("div",{className:"max-w-full w-full",children:[e.jsxs("div",{className:"flex flex-row items-center md:justify-start justify-between gap-4 mt-4 mb-1 h-12",children:[e.jsx("h2",{className:"lg:text-2xl font-bold",children:s("artwork:search-results.title-with-keywords",{keywords:r})}),g&&e.jsx(D,{choices:o===t.Artwork?f:p,onChange:l=>{A("order_click",{value:l,scene:"search"}),m(j=>({...j,sort:l}))},value:n,alwaysCollapse:!0})]}),O,e.jsxs("div",{className:"pt-4",children:[w&&e.jsxs(e.Fragment,{children:[y&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between leading-[30px] mb-3 lg:mb-6",children:[e.jsx("h3",{className:"text-base lg:text-2xl font-semibold font-roboto",children:s("user:user")}),e.jsxs(C,{to:`/search?type=${t.User}&q=${r}`,className:"flex items-center rounded-md py-2 px-4 lg:rounded-lg bg-neutral-200 hover:bg-neutral-300 text-black font-semibold text-sm lg:leading-normal cursor-pointer transition-all",children:[s("action:load-more"),e.jsx(U,{})]})]}),e.jsx(ne,{keyword:r})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between leading-[30px] mb-3 lg:mb-6",children:[e.jsx("h3",{className:"text-base lg:text-2xl font-semibold font-roboto",children:s("common:ranking.model.label")}),e.jsxs(C,{to:`/search?type=${t.Model}&q=${r}`,className:"flex items-center rounded-md py-2 px-4 lg:rounded-lg bg-neutral-200 hover:bg-neutral-300 text-black font-semibold text-sm lg:leading-normal cursor-pointer transition-all",children:[s("action:load-more"),e.jsx(U,{})]})]}),e.jsx(ae,{keyword:r,order:n})]})]}),e.jsxs("div",{children:[o===t.All&&e.jsx("h3",{className:"text-base lg:text-2xl font-semibold font-roboto leading-[30px] mb-3 lg:mb-6",children:s("common:ranking.artwork.label")}),e.jsx($,{q:r,order:n,trackingArgs:{scene:"search",feed:n}})]})]}),o===t.User&&e.jsx(i.Suspense,{fallback:e.jsx(T,{}),children:e.jsx(te,{keyword:r})}),o===t.Model&&e.jsx(i.Suspense,{fallback:e.jsx(T,{}),children:e.jsx(J,{scene:"search",order:n,keyword:r,renderContent:l=>e.jsx(L,{scene:"search",...l}),renderLoading:()=>e.jsx(L,{loading:!0})})})]})]})]})}function ne({keyword:s}){const{data:d,loading:r}=Q({last:20,keyword:s}),n=i.useMemo(()=>S(M(d).reverse(),"id"),[d]);return n.length===0||!s?r?e.jsx(v,{}):e.jsx(k,{}):e.jsx(_,{className:"flex gap-4 mb-4 lg:mb-6",children:n.map(c=>e.jsx(H,{user:c,className:"min-w-40"},c.id))})}function ae({keyword:s,order:a}){const{data:r,isLoading:n}=K({first:24,keyword:typeof s=="string"?Y(s):void 0,orderBy:V(a),feed:"meilisearch"}),c=i.useMemo(()=>S(M(r).reverse(),"id"),[r]);return c.length===0?n?e.jsx(v,{}):e.jsx(k,{}):e.jsx(_,{className:"flex gap-4 mt-2 mb-4 lg:mb-6 lg:h-80 h-40",children:c.map(u=>e.jsx(X,{model:u,link:!0},u.id))})}export{Te as Component};
