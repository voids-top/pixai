import{e as c,a1 as _,aP as A,cA as D,fY as E,j as t,K as I,a0 as b}from"./index-BTMYyhc6.js";import{a as P}from"./index-Cpf8OWOQ.js";import{M as F}from"./MediaPreview-CrisSWrJ.js";import{Y as K}from"./GeneratorStage-DJGZB2wF.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[a]="6b5d6cbc-5b7d-4dfd-beb8-0190f5e4cfb9",s._sentryDebugIdIdentifier="sentry-dbid-6b5d6cbc-5b7d-4dfd-beb8-0190f5e4cfb9")}catch{}})();{var f=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};f._sentryModuleMetadata=f._sentryModuleMetadata||{},f._sentryModuleMetadata[new Error().stack]=Object.assign({},f._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}const k="grid grid-cols-[repeat(auto-fill,minmax(var(--item-width),1fr))] gap-[--gap-size]";function B(s){const{renderItem:a=({content:e})=>e,itemWidth:i=120,gapSize:l=4,...M}=s,{data:n,isLoading:p,isValidating:u,setSize:x}=K(),m=c.useMemo(()=>{var e;return p||!!((e=n==null?void 0:n.at(-1))!=null&&e.pageInfo.hasPreviousPage)},[n,p]),g=c.useMemo(()=>{const e=_(n==null?void 0:n.flatMap(r=>A(r).reverse().flatMap(o=>{var y,j;return((j=(y=o.outputs)==null?void 0:y.batch)==null?void 0:j.length)>0?o.outputs.batch.map(v=>v.deletedAt?void 0:v.mediaId):o.media})));return m&&u&&e.push(...Array.from({length:3})),e},[n,m,u]),[N,S]=c.useState(null),[h,z]=c.useState(null),w=c.useRef(h);w.current=h;const d=D(w,{root:N});return E(()=>{!u&&(d!=null&&d.isIntersecting)&&x(e=>e+1)},100,[d==null?void 0:d.isIntersecting,u,x]),t.jsx("div",{...M,style:{...s.style,"--item-width":typeof i=="number"?i+"px":i,"--gap-size":l+"px"},children:t.jsx(P,{scrollerRef:S,data:g,context:{havingMore:m,empty:!p&&g.length===0,setFooter:z},itemContent:(e,r)=>{if(r==null)return t.jsx("div",{className:"w-full aspect-square",style:{opacity:1-1/3*(3-(g.length-e))},children:t.jsx("div",{className:"size-full bg-black/20 dark:bg-white/20 rounded animate-pulse"})});const o=typeof r=="string"?r:r.id;return a({content:t.jsx(F,{mediaId:o,media:typeof r=="string"?void 0:r,thumbnail:!0,preferStill:!0,className:"w-full aspect-square rounded ring-1 ring-black/10 dark:ring-black/20"},o),mediaId:o})},listClassName:I(k,"m-[--gap-size]"),components:{Footer:R}})})}function R(s){var l;const{havingMore:a,empty:i}=s.context??{};return t.jsxs("div",{ref:(l=s.context)==null?void 0:l.setFooter,className:I("pb-[--gap-size] text-sm text-center text-neutral-500",k),children:[t.jsx("div",{className:"row-start-1 col-start-1 w-full aspect-square"}),t.jsx("div",{className:"row-start-1 col-start-1 col-span-full flex justify-center items-center",children:a?t.jsx(b,{i18nKey:"common:hint.loading"}):i?t.jsx(b,{i18nKey:"artwork:search-results.empty-without-keyword"}):t.jsx(b,{i18nKey:"common:list-reached-the-end"})})]})}export{B as T};
//# sourceMappingURL=TaskOutputGrid-BsjhBE4B.js.map
