var it=Object.defineProperty;var ot=(e,n,t)=>n in e?it(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var M=(e,n,t)=>ot(e,typeof n!="symbol"?n+"":n,t);import{la as lt,lb as ct,j as a,ai as w,W as dt,u as U,T as ht,B as L,F as ut,K as O,b9 as ft,e as x,fY as ge,d5 as ve,k_ as pt,gs as gt,R as A,ag as D,h as vt,b2 as N,cQ as mt,aI as bt,a3 as _e,a4 as J,a7 as qe,i as me,hA as xt,hB as wt,cY as Se,bo as ke,ir as Ct,lc as yt,f as Ue,d0 as jt,a6 as _t,C as V,t as he,ld as St,H as kt,jI as Et,a5 as de,b8 as Bt,fy as Tt,D as Rt}from"./index-BTMYyhc6.js";import{i as Mt,d as Pt}from"./utils-CORjiwlf.js";import{f as j,m as Nt,d as At,l as Lt,B as Ot}from"./util-BeU8Prtb.js";import{c as Dt,a as zt}from"./imageUtil-NFh1c57i.js";import{U as ne,a as Ft,b as It}from"./unFile-B3RwQvIR.js";import{S as Ve}from"./Slider-0j-9tQ0Y.js";import{_ as Ge}from"./objectDestructuringEmpty-BTFSYSYG.js";import{i as Ht}from"./baseline-arrow-downward-DqsrtYvs.js";import{i as Ee,S as qt,m as Ut,a as Vt}from"./baseline-circle-DKv3JZ6t.js";import{i as Gt}from"./baseline-delete-outline-B3-PwQHh.js";import{c as We}from"./contextState-BhHzyxk5.js";import{B as $e}from"./ButtonGroup-DYBxluzJ.js";import{C as Wt,s as $t,u as Zt}from"./index-COYvdw4o.js";import{C as Xt}from"./GenerationModeNavigation-nSoy0Q7r.js";import{Q as Yt}from"./QuotaBalance-DP6pnxJ0.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="0471c8ff-54be-4e97-9966-c5409ef00e66",e._sentryDebugIdIdentifier="sentry-dbid-0471c8ff-54be-4e97-9966-c5409ef00e66")}catch{}})();{var Q=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};Q._sentryModuleMetadata=Q._sentryModuleMetadata||{},Q._sentryModuleMetadata[new Error().stack]=Object.assign({},Q._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}var Kt=lt(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function Qt(e,n){return new Promise(function(t,r){var c=new ct({next:function(l){t(l),c.unsubscribe()},error:r,complete:function(){r(new Kt)}});e.subscribe(c)})}const Jt=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"M7 14c-1.66 0-3 1.34-3 3c0 1.31-1.16 2-2 2c.92 1.22 2.49 2 4 2c2.21 0 4-1.79 4-4c0-1.66-1.34-3-3-3zm13.71-9.37l-1.34-1.34a.996.996 0 0 0-1.41 0L9 12.25L11.75 15l8.96-8.96a.996.996 0 0 0 0-1.41z"})});var W=255,H=100,X=e=>{var{r:n,g:t,b:r,a:c}=e,l=Math.max(n,t,r),p=l-Math.min(n,t,r),o=p?l===n?(t-r)/p:l===t?2+(r-n)/p:4+(n-t)/p:0;return{h:60*(o<0?o+6:o),s:l?p/l*H:0,v:l/W*H,a:c}},Ze=e=>{var{h:n,s:t,l:r,a:c}=be(e);return"hsla("+n+", "+t+"%, "+r+"%, "+c+")"},ee=e=>{var{h:n,s:t,l:r,a:c}=e;return t*=(r<50?r:H-r)/H,{h:n,s:t>0?2*t/(r+t)*H:0,v:r+t,a:c}},be=e=>{var{h:n,s:t,v:r,a:c}=e,l=(200-t)*r/H;return{h:n,s:l>0&&l<200?t*r/H/(l<=H?l:200-l)*H:0,l:l/2,a:c}},Xe=e=>{var{r:n,g:t,b:r}=e,c=n<<16|t<<8|r;return"#"+(l=>new Array(7-l.length).join("0")+l)(c.toString(16))},Ye=e=>{var{r:n,g:t,b:r,a:c}=e,l=typeof c=="number"&&(c*255|256).toString(16).slice(1);return""+Xe({r:n,g:t,b:r,a:c})+(l||"")},G=e=>X(er(e)),er=e=>{var n=e.replace("#","");/^#?/.test(e)&&n.length===3&&(e="#"+n.charAt(0)+n.charAt(0)+n.charAt(1)+n.charAt(1)+n.charAt(2)+n.charAt(2));var t=new RegExp("[A-Za-z0-9]{2}","g"),[r,c,l=0,p]=e.match(t).map(o=>parseInt(o,16));return{r,g:c,b:l,a:(p??255)/W}},K=e=>{var{h:n,s:t,v:r,a:c}=e,l=n/60,p=t/H,o=r/H,s=Math.floor(l)%6,i=l-Math.floor(l),h=W*o*(1-p),d=W*o*(1-p*i),m=W*o*(1-p*(1-i));o*=W;var u={};switch(s){case 0:u.r=o,u.g=m,u.b=h;break;case 1:u.r=d,u.g=o,u.b=h;break;case 2:u.r=h,u.g=o,u.b=m;break;case 3:u.r=h,u.g=d,u.b=o;break;case 4:u.r=m,u.g=h,u.b=o;break;case 5:u.r=o,u.g=h,u.b=d;break}return u.r=Math.round(u.r),u.g=Math.round(u.g),u.b=Math.round(u.b),w({},u,{a:c})},tr=e=>{var{r:n,g:t,b:r,a:c}=K(e);return"rgba("+n+", "+t+", "+r+", "+c+")"},rr=e=>{var{r:n,g:t,b:r}=e;return{r:n,g:t,b:r}},ar=e=>{var{h:n,s:t,l:r}=e;return{h:n,s:t,l:r}},ie=e=>Xe(K(e)),sr=e=>Ye(K(e)),nr=e=>{var{h:n,s:t,v:r}=e;return{h:n,s:t,v:r}},F=e=>{var n,t,r,c,l,p,o,s;return typeof e=="string"&&oe(e)?(p=G(e),o=e):typeof e!="string"&&(p=e),p&&(r=nr(p),l=be(p),c=K(p),s=Ye(c),o=ie(p),t=ar(l),n=rr(c)),{rgb:n,hsl:t,hsv:r,rgba:c,hsla:l,hsva:p,hex:o,hexa:s}},oe=e=>/^#?([A-Fa-f0-9]{3,4}){1,2}$/.test(e);const ir=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM7.5 18c-.83 0-1.5-.67-1.5-1.5S6.67 15 7.5 15s1.5.67 1.5 1.5S8.33 18 7.5 18zm0-9C6.67 9 6 8.33 6 7.5S6.67 6 7.5 6S9 6.67 9 7.5S8.33 9 7.5 9zm4.5 4.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5s1.5.67 1.5 1.5s-.67 1.5-1.5 1.5zm4.5 4.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5s1.5.67 1.5 1.5s-.67 1.5-1.5 1.5zm0-9c-.83 0-1.5-.67-1.5-1.5S15.67 6 16.5 6s1.5.67 1.5 1.5S17.33 9 16.5 9z"})}),or=dt(Ve)(()=>({"& .MuiSlider-thumb":{height:16,width:16,backgroundColor:"#7c3aed","&:hover":{boxShadow:"0px 0px 0px 4px #7c3aed66"},"&.Mui-active":{boxShadow:"0px 0px 0px 8px #7c3aed66"}},"& .MuiSlider-track":{height:8,borderRadius:"24px 0 0 24px",border:"none",backgroundColor:"#c084fc"},"& .MuiSlider-rail":{height:8,borderRadius:4,backgroundColor:"#bfbfbf"}}));function lr({value:e,onChange:n,showExtraLabel:t}){const{t:r}=U(["generation"]);return a.jsx(ht,{multiline:!0,value:e,onChange:n,minRows:1,maxRows:3,className:"w-full",InputLabelProps:{shrink:!0},label:a.jsxs(a.Fragment,{children:[r("generation:lcm.params.prompts.label"),t&&a.jsx("span",{className:"ml-4 text-theme-primary text-[1.25em]",children:"Start here!"})]})})}function cr({value:e,onClick:n}){const{t}=U(["generation"]);return a.jsxs(L,{disableRipple:!0,variant:"outlined",className:"flex items-center gap-1 px-2",onClick:n,children:[a.jsx("h4",{className:"mr-1",children:t("generation:lcm.params.reroll.label")}),a.jsx(ir,{})]})}function dr({value:e,onChange:n,className:t}){const{t:r}=U(["generation"]);return a.jsxs(ut,{className:O("w-full flex flex-row grow items-center gap-4",t),fullWidth:!0,size:"small",children:[a.jsx(ft,{className:"whitespace-nowrap text-black dark:text-white !text-sm",children:r("generation:lcm.params.strength.label")}),a.jsx(or,{size:"small",value:e,onChange:n,min:.25,max:1,step:.01,valueLabelDisplay:"auto",valueLabelFormat:c=>c.toFixed(2)})]})}const hr=({status:e})=>{const{t:n}=U(["generation"]),[t,r]=x.useState(!1),c=x.useRef(e);c.current=e;const[l,p]=x.useState(0),o=x.useRef(0),s=x.useRef(),i=x.useCallback(()=>{c.current==="rendering"&&(p(Date.now()-o.current),s.current=requestAnimationFrame(i))},[]);return x.useEffect(()=>(r(!1),e==="rendering"?(o.current=Date.now(),s.current=requestAnimationFrame(i)):p(0),()=>cancelAnimationFrame(s.current)),[e,i]),ge(()=>{e==="idle"&&r(!0)},850,[e,l]),a.jsx("div",{className:"absolute top-0 left-0 right-0 flex justify-center overflow-hidden pointer-events-none",children:a.jsxs("div",{className:O("flex items-center justify-center gap-2 px-5 py-1","rounded-b-lg border-b border-l border-r border-gray-200 dark:border-gray-600 bg-background","transition-transform duration-200 ease-in-out transform",t?"-translate-y-full":"translate-y-0"),children:[a.jsx("div",{className:O("rounded-full w-3 h-3",e==="debouncing"&&"bg-amber-400",e==="rendering"&&"bg-sky-400 cursor-wait",e==="idle"&&"bg-emerald-400")}),a.jsxs("span",{className:"text-sm text-primary tabular-nums",children:[e==="debouncing"&&n("generation:lcm.status.debouncing"),e==="rendering"&&n("generation:lcm.status.rendering",{elapsed:(l/1e3).toFixed(3)}),e==="idle"&&n("generation:lcm.status.idle")]})]})})};function ur(e){const n=e;return n.__esModule?n.default:e}const fr=ur(ve),pr=x.forwardRef(function(n,t){var r;return x.createElement(fr,w({},n,{ref:t,style:{pointerEvents:"none",...n.style},PaperProps:{...n.PaperProps,style:{pointerEvents:"auto",...(r=n.PaperProps)===null||r===void 0?void 0:r.style}}}))});function Z(e){if(typeof window>"u")return e;const n=x.useRef(null);return x.useLayoutEffect(()=>{n.current=e}),x.useCallback((...t)=>{var r;(r=n.current)===null||r===void 0||r.call(n,...t)},[])}const Be={};function gr(e,n){Be[e]||(Be[e]=!0,console.error("[material-ui-popup-state] WARNING",n))}const vr={isOpen:!1,setAnchorElUsed:!1,anchorEl:void 0,anchorPosition:void 0,hovered:!1,focused:!1,_openEventType:null,_childPopupState:null,_deferNextOpen:!1,_deferNextClose:!1};function te({parentPopupState:e,popupId:n,variant:t,disableAutoFocus:r}){const c=x.useRef(!0);x.useEffect(()=>(c.current=!0,()=>{c.current=!1}),[]);const[l,p]=x.useState(vr),o=x.useCallback(f=>{c.current&&p(f)},[]),s=x.useCallback(f=>o(b=>({...b,setAnchorElUsed:!0,anchorEl:f??void 0})),[]),i=Z(f=>(l.isOpen?m(f):h(f),l)),h=Z(f=>{const b=f instanceof Element?void 0:f,S=f instanceof Element?f:(f==null?void 0:f.currentTarget)instanceof Element?f.currentTarget:void 0;if((b==null?void 0:b.type)==="touchstart"){o(B=>({...B,_deferNextOpen:!0}));return}const k=b==null?void 0:b.clientX,_=b==null?void 0:b.clientY,E=typeof k=="number"&&typeof _=="number"?{left:k,top:_}:void 0,R=B=>{if(!f&&!B.setAnchorElUsed&&t!=="dialog"&&gr("missingEventOrAnchorEl","eventOrAnchorEl should be defined if setAnchorEl is not used"),e){if(!e.isOpen)return B;setTimeout(()=>e._setChildPopupState(g))}const T={...B,isOpen:!0,anchorPosition:E,hovered:(b==null?void 0:b.type)==="mouseover"||B.hovered,focused:(b==null?void 0:b.type)==="focus"||B.focused,_openEventType:b==null?void 0:b.type};return b!=null&&b.currentTarget?B.setAnchorElUsed||(T.anchorEl=b==null?void 0:b.currentTarget):S&&(T.anchorEl=S),T};o(B=>B._deferNextOpen?(setTimeout(()=>o(R),0),{...B,_deferNextOpen:!1}):R(B))}),d=f=>{const{_childPopupState:b}=f;return setTimeout(()=>{b==null||b.close(),e==null||e._setChildPopupState(null)}),{...f,isOpen:!1,hovered:!1,focused:!1}},m=Z(f=>{const b=f instanceof Element?void 0:f;if((b==null?void 0:b.type)==="touchstart"){o(S=>({...S,_deferNextClose:!0}));return}o(S=>S._deferNextClose?(setTimeout(()=>o(d),0),{...S,_deferNextClose:!1}):d(S))}),u=x.useCallback((f,b)=>{f?h(b):m(b)},[]),y=Z(f=>{const{relatedTarget:b}=f;o(S=>S.hovered&&!(b instanceof Element&&ue(b,g))?S.focused?{...S,hovered:!1}:d(S):S)}),C=Z(f=>{if(!f)return;const{relatedTarget:b}=f;o(S=>S.focused&&!(b instanceof Element&&ue(b,g))?S.hovered?{...S,focused:!1}:d(S):S)}),v=x.useCallback(f=>o(b=>({...b,_childPopupState:f})),[]),g={...l,setAnchorEl:s,popupId:n,variant:t,open:h,close:m,toggle:i,setOpen:u,onBlur:C,onMouseLeave:y,disableAutoFocus:r??!!(l.hovered||l.focused),_setChildPopupState:v};return g}function Ke({isOpen:e,popupId:n,variant:t}){return{...t==="popover"?{"aria-haspopup":!0,"aria-controls":e&&n!=null?n:void 0}:t==="popper"?{"aria-describedby":e&&n!=null?n:void 0}:void 0}}function mr(e){return{...Ke(e),onClick:e.open,onTouchStart:e.open}}function br(e){const{open:n,onMouseLeave:t}=e;return{...Ke(e),onTouchStart:n,onMouseOver:n,onMouseLeave:t}}function Qe({isOpen:e,anchorEl:n,anchorPosition:t,close:r,popupId:c,onMouseLeave:l,disableAutoFocus:p,_openEventType:o}){return{id:c,anchorEl:n,anchorPosition:t,anchorReference:o==="contextmenu"?"anchorPosition":"anchorEl",open:e,onClose:r,onMouseLeave:l,...p&&{disableAutoFocus:!0,disableEnforceFocus:!0,disableRestoreFocus:!0}}}function xr(e,{popupId:n}){if(!n)return null;const t=typeof e.getRootNode=="function"?e.getRootNode():document;return typeof t.getElementById=="function"?t.getElementById(n):null}function ue(e,n){const{anchorEl:t,_childPopupState:r}=n;return Te(t,e)||Te(xr(e,n),e)||r!=null&&ue(e,r)}function Te(e,n){if(!e)return!1;for(;n;){if(n===e)return!0;n=n.parentElement}return!1}(function(){j.fabric.Object.ENLIVEN_PROPS.push("eraser");var e=j.fabric.Object.prototype._drawClipPath,n=j.fabric.Object.prototype.needsItsOwnCache,t=j.fabric.Object.prototype.toObject,r=j.fabric.Object.prototype.getSvgCommons,c=j.fabric.Object.prototype._createBaseClipPathSVGMarkup,l=j.fabric.Object.prototype._createBaseSVGMarkup;j.fabric.Object.prototype.cacheProperties.push("eraser"),j.fabric.Object.prototype.stateProperties.push("eraser"),j.fabric.util.object.extend(j.fabric.Object.prototype,{erasable:!0,eraser:void 0,needsItsOwnCache:function(){return n.call(this)||!!this.eraser},_drawClipPath:function(s,i){if(e.call(this,s,i),this.eraser){var h=this._getNonTransformedDimensions();this.eraser.isType("eraser")&&this.eraser.set({width:h.x,height:h.y}),e.call(this,s,this.eraser)}},toObject:function(s){var i=t.call(this,["erasable"].concat(s));return this.eraser&&!this.eraser.excludeFromExport&&(i.eraser=this.eraser.toObject(s)),i},getSvgCommons:function(){return r.call(this)+(this.eraser?'mask="url(#'+this.eraser.clipPathId+')" ':"")},_createEraserSVGMarkup:function(s){return this.eraser?(this.eraser.clipPathId="MASK_"+j.fabric.Object.__uid++,['<mask id="',this.eraser.clipPathId,'" >',this.eraser.toSVG(s),"</mask>",`
`].join("")):""},_createBaseClipPathSVGMarkup:function(s,i){return[this._createEraserSVGMarkup(i&&i.reviver),c.call(this,s,i)].join("")},_createBaseSVGMarkup:function(s,i){return[this._createEraserSVGMarkup(i&&i.reviver),l.call(this,s,i)].join("")}});var p=j.fabric.Group.prototype._restoreObjectsState;j.fabric.util.object.extend(j.fabric.Group.prototype,{_addEraserPathToObjects:function(s){this._objects.forEach(function(i){j.fabric.EraserBrush.prototype._addPathToObjectEraser.call(j.fabric.EraserBrush.prototype,i,s)})},applyEraserToObjects:function(){var s=this,i=this.eraser;if(i){delete this.eraser;var h=s.calcTransformMatrix();i.clone(function(d){var m=s.clipPath;d.getObjects("path").forEach(function(u){var y=j.fabric.util.multiplyTransformMatrices(h,u.calcTransformMatrix());j.fabric.util.applyTransformToObject(u,y),m?m.clone(function(C){var v=j.fabric.EraserBrush.prototype.applyClipPathToPath.call(j.fabric.EraserBrush.prototype,u,C,h);s._addEraserPathToObjects(v)},["absolutePositioned","inverted"]):s._addEraserPathToObjects(u)})})}},_restoreObjectsState:function(){return this.erasable===!0&&this.applyEraserToObjects(),p.call(this)}}),j.fabric.Eraser=j.fabric.util.createClass(j.fabric.Group,{type:"eraser",originX:"center",originY:"center",drawObject:function(s){s.save(),s.fillStyle="black",s.fillRect(-this.width/2,-this.height/2,this.width,this.height),s.restore(),this.callSuper("drawObject",s)},_getBounds:function(){},_toSVG:function(s){var i=["<g ","COMMON_PARTS",` >
`],h=-this.width/2,d=-this.height/2,m=["<rect ",'fill="white" ','x="',h,'" y="',d,'" width="',this.width,'" height="',this.height,`" />
`].join("");i.push("		",m);for(var u=0,y=this._objects.length;u<y;u++)i.push("		",this._objects[u].toSVG(s));return i.push(`</g>
`),i}}),j.fabric.Eraser.fromObject=function(s,i){var h=s.objects;j.fabric.util.enlivenObjects(h,function(d){var m=j.fabric.util.object.clone(s,!0);delete m.objects,j.fabric.util.enlivenObjectEnlivables(s,m,function(){i&&i(new j.fabric.Eraser(d,m,!0))})})};var o=j.fabric.Canvas.prototype._renderOverlay;j.fabric.util.object.extend(j.fabric.Canvas.prototype,{isErasing:function(){return this.isDrawingMode&&this.freeDrawingBrush&&this.freeDrawingBrush.type==="eraser"&&this.freeDrawingBrush._isErasing},_renderOverlay:function(s){o.call(this,s),this.isErasing()&&!this.freeDrawingBrush.inverted&&this.freeDrawingBrush._render()}}),j.fabric.EraserBrush=j.fabric.util.createClass(j.fabric.PencilBrush,{type:"eraser",inverted:!1,_isErasing:!1,_isErasable:function(s){return s.erasable!==!1},_prepareCollectionTraversal:function(s,i,h){s.forEachObject(function(d){d.forEachObject&&d.erasable==="deep"?this._prepareCollectionTraversal(d,i,h):!this.inverted&&d.erasable&&d.visible?(d.visible=!1,s.dirty=!0,h.visibility.push(d),h.collection.push(s)):this.inverted&&d.visible&&(d.erasable&&d.eraser?(d.eraser.inverted=!0,d.dirty=!0,s.dirty=!0,h.eraser.push(d),h.collection.push(s)):(d.visible=!1,s.dirty=!0,h.visibility.push(d),h.collection.push(s)))},this)},preparePattern:function(){this._patternCanvas||(this._patternCanvas=j.fabric.util.createCanvasElement());var s=this._patternCanvas;s.width=this.canvas.width,s.height=this.canvas.height;var i=s.getContext("2d");if(this.canvas._isRetinaScaling()){var h=this.canvas.getRetinaScaling();this.canvas.__initRetinaScaling(h,s,i)}var d=this.canvas.backgroundImage,m=d&&this._isErasable(d),u=this.canvas.overlayImage,y=u&&this._isErasable(u);if(!this.inverted&&(d&&!m||this.canvas.backgroundColor))m&&(this.canvas.backgroundImage=void 0),this.canvas._renderBackground(i),m&&(this.canvas.backgroundImage=d);else if(this.inverted&&d&&m){var C=this.canvas.backgroundColor;this.canvas.backgroundColor=void 0,this.canvas._renderBackground(i),this.canvas.backgroundColor=C}i.save(),i.transform.apply(i,this.canvas.viewportTransform);var v={visibility:[],eraser:[],collection:[]};if(this._prepareCollectionTraversal(this.canvas,i,v),this.canvas._renderObjects(i,this.canvas._objects),v.visibility.forEach(function(g){g.visible=!0}),v.eraser.forEach(function(g){g.eraser.inverted=!1,g.dirty=!0}),v.collection.forEach(function(g){g.dirty=!0}),i.restore(),!this.inverted&&(u&&!y||this.canvas.overlayColor))y&&(this.canvas.overlayImage=void 0),o.call(this.canvas,i),y&&(this.canvas.overlayImage=u);else if(this.inverted&&u&&y){var C=this.canvas.overlayColor;this.canvas.overlayColor=void 0,o.call(this.canvas,i),this.canvas.overlayColor=C}},_setBrushStyles:function(s){this.callSuper("_setBrushStyles",s),s.strokeStyle="black"},_saveAndTransform:function(s){this.callSuper("_saveAndTransform",s),this._setBrushStyles(s),s.globalCompositeOperation=s===this.canvas.getContext()?"destination-out":"source-over"},needsFullRender:function(){return!0},onMouseDown:function(s,i){this.canvas._isMainEvent(i.e)&&(this._prepareForDrawing(s),this._captureDrawingPath(s),this.preparePattern(),this._isErasing=!0,this.canvas.fire("erasing:start"),this._render())},_render:function(){var s;this.inverted||(s=this.canvas.getContext(),this.callSuper("_render",s)),s=this.canvas.contextTop,this.canvas.clearContext(s),this.callSuper("_render",s),s.save();var i=this.canvas.getRetinaScaling(),h=1/i;s.scale(h,h),s.globalCompositeOperation="source-in",s.drawImage(this._patternCanvas,0,0),s.restore()},createPath:function(s){var i=this.callSuper("createPath",s);return i.globalCompositeOperation=this.inverted?"source-over":"destination-out",i.stroke=this.inverted?"white":"black",i},applyClipPathToPath:function(s,i,h){var d=j.fabric.util.invertTransform(s.calcTransformMatrix()),m=i.calcTransformMatrix(),u=i.absolutePositioned?d:j.fabric.util.multiplyTransformMatrices(d,h);return i.absolutePositioned=!1,j.fabric.util.applyTransformToObject(i,j.fabric.util.multiplyTransformMatrices(u,m)),s.clipPath=s.clipPath?j.fabric.util.mergeClipPaths(i,s.clipPath):i,s},clonePathWithClipPath:function(s,i,h){var d=i.calcTransformMatrix(),m=i.clipPath,u=this;s.clone(function(y){m.clone(function(C){h(u.applyClipPathToPath(y,C,d))},["absolutePositioned","inverted"])})},_addPathToObjectEraser:function(s,i){var h=this;if(s.forEachObject&&s.erasable==="deep"){var d=s._objects.filter(function(u){return u.erasable});d.length>0&&s.clipPath?this.clonePathWithClipPath(i,s,function(u){d.forEach(function(y){h._addPathToObjectEraser(y,u)})}):d.length>0&&d.forEach(function(u){h._addPathToObjectEraser(u,i)});return}var m=s.eraser;m||(m=new j.fabric.Eraser,s.eraser=m),i.clone(function(u){var y=j.fabric.util.multiplyTransformMatrices(j.fabric.util.invertTransform(s.calcTransformMatrix()),u.calcTransformMatrix());j.fabric.util.applyTransformToObject(u,y),m.addWithUpdate(u),s.set("dirty",!0),s.fire("erasing:end",{path:u}),s.group&&Array.isArray(h.__subTargets)&&h.__subTargets.push(s)})},applyEraserToCanvas:function(s){var i=this.canvas,h={};return["backgroundImage","overlayImage"].forEach(function(d){var m=i[d];m&&m.erasable&&(this._addPathToObjectEraser(m,s),h[d]=m)},this),h},_finalizeAndAddPath:function(){var s=this.canvas.contextTop,i=this.canvas;s.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate)),i.clearContext(i.contextTop),this._isErasing=!1;var h=this._points&&this._points.length>1?this.convertPointsToSVGPath(this._points):null;if(!h||this._isEmptySVGPath(h)){i.fire("erasing:end"),i.requestRenderAll();return}var d=this.createPath(h);d.setCoords(),i.fire("before:path:created",{path:d});var m=this.applyEraserToCanvas(d),u=this;this.__subTargets=[];var y=[];i.forEachObject(function(C){C.erasable&&C.intersectsWithObject(d,!0,!0)&&(u._addPathToObjectEraser(C,d),y.push(C))}),i.fire("erasing:end",{path:d,targets:y,subTargets:this.__subTargets,drawables:m}),delete this.__subTargets,i.requestRenderAll(),this._resetShadow(),i.fire("path:created",{path:d})}})})();const Re=pt.debug("pixai:NotAnEditor"),Me="draw";class wr extends Nt(Ot){constructor(t,r){super();M(this,"canvasEl");M(this,"containerEl");M(this,"inpaintColor");M(this,"_brushSize");M(this,"_drawingType");M(this,"_drawingBrush");M(this,"_pencilColor");M(this,"_eraserBrush");M(this,"_shape");M(this,"_shapeColor");M(this,"_editMode");M(this,"_disposeEditMode");M(this,"_baseImage");M(this,"_baseFile");M(this,"_unFileUrls");M(this,"_drawGroupOptions");M(this,"_shiftHeld");M(this,"_disposeContainerListeners");M(this,"_disposeDocumentListeners");this.canvasEl=t,this.containerEl=r,this.inpaintColor="#f008",this._brushSize=10,this._drawingType="pencil",this._pencilColor="#000",this._shape="rect",this._shapeColor="#000",this._editMode="draw",this._disposeEditMode=void 0,this._unFileUrls=new Map,this._drawGroupOptions={},this._shiftHeld=!1,this._disposeContainerListeners=[],this._disposeDocumentListeners=[]}async init(t){const r=new j.fabric.Canvas(this.canvasEl,t);r.preserveObjectStacking=!0,this._canvas=r,t.width&&t.height&&this.setSize(t.width,t.height),this._drawingType=t.drawingType??(t.drawingType="pencil"),t.drawingType==="inpaint"?(this._drawingBrush=new j.fabric.PatternBrush(r),this._drawingBrush.source=this._getInpaintPatternSrc()):this._drawingBrush=new j.fabric.PencilBrush(r),this._eraserBrush=new j.fabric.EraserBrush(r),this.setMode("draw"),t.baseImage&&await this._loadImage(t.baseImage),this.resetHistory(),r.on("object:modified",l=>{Re("object:modified %o",l),this.recordHistory()}),r.on("path:created",l=>{if(Re("path:created %o",l),!l.path)return;const p=l.path;this._editMode==="draw"&&this.setDrawGroup(p),this.recordHistory()}),this._addContainerListener("keydown",l=>{(l.key==="Backspace"||l.key==="Delete")&&this.deleteSelection()},{passive:!0});const c=l=>{this._shiftHeld!==l.shiftKey&&(this._shiftHeld=l.shiftKey,this.emit("shiftHeldChange",this._shiftHeld))};this._addDocumentListener("keydown",c,{passive:!0}),this._addDocumentListener("keyup",c,{passive:!0})}dispose(){this.removeAllListeners(),this._disposeContainerListeners.forEach(t=>t()),this._disposeDocumentListeners.forEach(t=>t()),this._canvas&&(this._unFileUrls.forEach((t,r)=>r.revokeUrl()),this._unFileUrls.clear(),this._canvas.dispose())}_addContainerListener(t,r,c){this.containerEl.addEventListener(t,r,c),this._disposeContainerListeners.push(()=>this.containerEl.removeEventListener(t,r))}_addDocumentListener(t,r,c){document.addEventListener(t,r,c),this._disposeDocumentListeners.push(()=>document.removeEventListener(t,r))}get drawingType(){return this._drawingType}get baseFile(){return this._baseFile}_setFreeDrawingCursor(){const t=this.canvas.freeDrawingCursor,r=this.canvas.getZoom(),c=this._brushSize*r,l=c/2+1;return this.canvas.freeDrawingCursor=["url('data:image/svg+xml;utf8,",`<svg xmlns="http://www.w3.org/2000/svg" width="${c+2}" height="${c+2}">`,`<circle cx="${l}" cy="${l}" r="${c/2}" stroke="white" fill="none" stroke-width="2"/>`,`<circle cx="${l}" cy="${l}" r="${c/2-1}" stroke="black" fill="none" stroke-width="2"/>`,`</svg>') ${l} ${l}, crosshair`].join(""),()=>{this.canvas.freeDrawingCursor=t}}_setDrawMode(){this.canvas.isDrawingMode=!0;const t=this._drawingBrush;this.canvas.freeDrawingBrush=t,t.width=this._brushSize,t.color=this._drawingType==="inpaint"?this.inpaintColor:this._pencilColor;const r=this._setFreeDrawingCursor();return()=>r()}_setEraseMode(){this.canvas.isDrawingMode=!0;const t=this._eraserBrush;this.canvas.freeDrawingBrush=t,t.width=this._brushSize;const r=this._setFreeDrawingCursor();return()=>r()}_setShapeMode(){this.canvas.isDrawingMode=!1;const t=this.canvas.defaultCursor;this.canvas.defaultCursor="crosshair",this.canvas.selection=!1,this.canvas.skipTargetFind=!0,this.canvas.discardActiveObject(),this.canvas.requestRenderAll();const r=o=>{if(!o.absolutePointer)return;const{x:s,y:i}=o.absolutePointer,h={left:s,top:i,width:0,height:0,naShapeSX:s,naShapeSY:i,fill:this._shapeColor};let d;const m=this._shape;switch(m){case"rect":d=new j.fabric.Rect(h);break;case"ellipse":d=new j.fabric.Ellipse({...h,originX:"left",originY:"top"});break;case"triangle":d=new j.fabric.Triangle(h);break;default:throw new Error(`Unknown shape ${m}`)}this.canvas.add(d),this.setDrawGroup(d),this.canvas.setActiveObject(d),this.canvas.requestRenderAll()},c=()=>{const o=this.canvas.getActiveObject();if(!o)return;const{naShapeSX:s,naShapeSY:i}=o;let{naShapeCX:h,naShapeCY:d}=o;if(s==null||i==null||h==null||d==null)return;if(!this._shiftHeld){const v=Math.abs(h-s),g=Math.abs(d-i);v>g?h=s+Math.sign(h-s)*g:d=i+Math.sign(d-i)*v}const m=Math.min(s,h),u=Math.min(i,d),y=Math.abs(h-s),C=Math.abs(d-i);o instanceof j.fabric.Ellipse?o.set({left:m,top:u,rx:y/2,ry:C/2}):o.set({left:m,top:u,width:y,height:C}),o.setCoords(),this.canvas.requestRenderAll()},l=o=>{if(!o.absolutePointer)return;const{x:s,y:i}=o.absolutePointer,h=this.canvas.getActiveObject();if(!h)return;const{naShapeSX:d,naShapeSY:m}=h;d==null||m==null||(h.set({naShapeCX:s,naShapeCY:i}),c())},p=o=>{const s=this.canvas.getActiveObject();if(s){if(s.naShapeCX==null||s.naShapeCY==null){this.canvas.discardActiveObject(),this.canvas.remove(s),this.canvas.skipTargetFind=!1;const i=this.canvas.findTarget(o.e,!0);this.canvas.skipTargetFind=!0,i&&(this.setMode("select"),this.canvas.setActiveObject(i)),this.canvas.requestRenderAll();return}s.set({naShapeSX:void 0,naShapeSY:void 0,naShapeCX:void 0,naShapeCY:void 0}),s.setCoords(),this.canvas.discardActiveObject(),this.canvas.requestRenderAll(),this.recordHistory()}};return this.canvas.on("mouse:down",r),this.canvas.on("mouse:move",l),this.canvas.on("mouse:up",p),this.on("shiftHeldChange",c),()=>{this.canvas.defaultCursor=t,this.canvas.selection=!0,this.canvas.skipTargetFind=!1,this.canvas.off("mouse:down",r),this.canvas.off("mouse:move",l),this.canvas.off("mouse:up",p),this.off("shiftHeldChange",c)}}_setSelectMode(){this.canvas.isDrawingMode=!1}_getInpaintPatternSrc(){const r=window.document.createElement("canvas"),c=new j.fabric.Group([new j.fabric.Rect({width:5,height:5,fill:"#888",left:0,top:0}),new j.fabric.Rect({width:5,height:5,fill:"#888",left:5,top:5}),new j.fabric.Rect({width:5,height:5,fill:"#fff",left:0,top:5}),new j.fabric.Rect({width:5,height:5,fill:"#fff",left:5,top:0})]);r.width=5*2,r.height=5*2;const l=r.getContext("2d");if(!l)throw new Error('"CanvasRenderingContext2D" is expected to be available');return c.render(l),r}setMode(t){switch(this._disposeEditMode&&this._disposeEditMode(),this._editMode=t,t){case"draw":this._disposeEditMode=this._setDrawMode();break;case"erase":this._disposeEditMode=this._setEraseMode();break;case"shape":this._disposeEditMode=this._setShapeMode();break;case"select":this._disposeEditMode=this._setSelectMode();break}this.emit("editModeChange",t)}setSize(t,r){const c=this.containerEl.getBoundingClientRect(),l=c.width/t,p=c.height/r,o=Math.min(l,p),s=o;this.canvas.setDimensions({width:t*o,height:r*o}),this.canvas.setViewportTransform([s,0,0,s,0,0])}setBrushSize(t){this._brushSize=t,this._drawingBrush.width=t,this._eraserBrush.width=t,this.canvas.isDrawingMode&&this._setFreeDrawingCursor()}setPencilColor(t){this._drawingBrush.color=t,this._pencilColor=t}setShapeColor(t){this._shapeColor=t}setBackgroundColor(t){this.canvas.setBackgroundColor(t,()=>{this.canvas.requestRenderAll()})}setShape(t){this._shape=t}_loadFile(t,r){this._unFileUrls.has(t)||this._unFileUrls.set(t,t.createUrl());const c=this._unFileUrls.get(t);return new Promise(l=>{j.fabric.Image.fromURL(c,l,{...r,naUnFile:t})})}async _loadImage(t){this._baseFile=t;const r=await this._loadFile(t,{name:"image",crossOrigin:"anonymous",erasable:!1});this._baseImage=r,r.width&&r.height&&this.setSize(r.width,r.height),this.canvas.insertAt(r,0,!1),this.canvas.requestRenderAll()}resizeImageToFitCanvas(t=this._baseImage){if(console.info("resizeImageToFitCanvas",{image:t}),!t)return;const{width:r=0,height:c=0}=t,{width:l=0,height:p=0}=this.canvas,o=l/r,s=p/c,i=Math.min(o,s),h=(l-r*i)/2,d=(p-c*i)/2;t.scale(i),t.set({left:h,top:d}),t.setCoords(),this.canvas.requestRenderAll()}async addDrawImage(t){const r=await this._loadFile(t,{crossOrigin:"anonymous",erasable:!1});return this.canvas.add(r),this.setDrawGroup(r),this.resizeImageToFitCanvas(r),this.recordHistory(),r}selectObject(t){this.setMode("select"),this.canvas.discardActiveObject(),this.canvas.setActiveObject(t),this.canvas.requestRenderAll()}async cloneSelection(){const t=this.canvas.getActiveObjects();if(t.length===0)return;this.canvas.discardActiveObject();const r=await Promise.all(t.map(l=>new Promise(p=>l.clone(p))));for(const l of r)l.set({left:l.left+10,top:l.top+10}),l.setCoords();this.canvas.add(...r);const c=new j.fabric.ActiveSelection(r,{canvas:this.canvas});this.canvas.setActiveObject(c),this.canvas.requestRenderAll(),this.recordHistory()}deleteSelection(){const t=this.canvas.getActiveObjects();t.length!==0&&(this.canvas.discardActiveObject(),this.canvas.remove(...t),this.canvas.requestRenderAll(),this.recordHistory())}_getDrawGroupObjects(){return this.canvas.getObjects().filter(t=>t.naGroup===Me)}setDrawGroup(t){t.set(this._drawGroupOptions),t.set({naGroup:Me})}clearDrawings(){this.canvas.remove(...this._getDrawGroupObjects()),this.canvas.requestRenderAll()}on(t,r){return super.on(t,r)}afterRestoreState(){this.canvas.getObjects().map(t=>{At(t)&&t.name==="image"&&(this._baseImage=t)})}afterResetHistory(){const t=new Set;this.canvas.getObjects().forEach(r=>{r.naUnFile&&t.add(r.naUnFile)});for(const[r]of this._unFileUrls)t.has(r)||(r.revokeUrl(),this._unFileUrls.delete(r))}toCanvas(){return this.canvas.renderAll(),this.canvas.toCanvasElement(1/this.canvas.getZoom())}async getImage(){if(this._getDrawGroupObjects().length===0)return this._baseFile;const t=await Dt(this.toCanvas(),"canvas.png");if(!t)throw new Error("Failed to convert canvas to file");return ne.fromFile(t)}async getInpaintMaskImage(){if(this._drawingType!=="inpaint")throw new Error('"getInpaintMaskImage" can only be called in a canvas with drawingType set to "inpaint"');const t=this._getDrawGroupObjects();if(t.length===0)return;const r=await Promise.all(t.map(p=>new Promise(o=>p.clone(o)))),c=await new Promise(p=>this.canvas.cloneWithoutData(p));await new Promise(p=>c.setBackgroundColor("#000",p)),c.setZoom(this.canvas.getZoom()),c.add(...r),r.forEach(p=>{Lt(p)&&(p.stroke="#fff")}),c.renderAll();const l=c.toCanvasElement(1/this.canvas.getZoom(),{width:this.canvas.width,height:this.canvas.height});return l.style.border="1px solid black",l}}const Cr=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"M3 17h18v-2H3v2zm0 3h18v-1H3v1zm0-7h18v-3H3v3zm0-9v4h18V4H3z"})}),fe=({value:e,onChange:n})=>{const{t}=U(["generation","action"]);return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm text-primary-light",children:t("generation:image-edit.brush-size")}),a.jsxs("div",{className:"flex gap-8",children:[a.jsx(Ve,{size:"small",className:"max-w-[200px]",value:e,onChange:(r,c)=>{n(+c)},min:5,max:100,step:1,valueLabelDisplay:"auto"}),a.jsx(gt,{size:"small",type:"number",className:"w-[60px]",value:e,onChange:r=>{const c=+r.target.value;n(c)},inputProps:{min:5,max:100}})]})]})},Na=({value:e,onChange:n,className:t})=>{const[r,c]=x.useState();return a.jsxs(a.Fragment,{children:[a.jsx(L,{className:O("px-0",t),onClick:l=>{c(l.currentTarget)},children:a.jsx(Cr,{className:"size-6"})}),a.jsx(ve,{open:!!r,anchorEl:r,onClose:()=>{c(void 0)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:a.jsx("div",{className:"w-[300px] px-8 py-4",children:a.jsx(fe,{value:e,onChange:n})})})]})};var yr=["prefixCls","className","color","colors","style","rectProps","onChange","addonAfter","addonBefore","rectRender"],xe=A.forwardRef((e,n)=>{var{prefixCls:t="w-color-swatch",className:r,color:c,colors:l=[],style:p,rectProps:o={},onChange:s,addonAfter:i,addonBefore:h,rectRender:d}=e,m=D(e,yr),u=w({"--swatch-background-color":"rgb(144, 19, 254)",background:"var(--swatch-background-color)",height:15,width:15,marginRight:5,marginBottom:5,cursor:"pointer",position:"relative",outline:"none",borderRadius:2},o.style),y=(C,v)=>{s&&s(G(C),F(G(C)),v)};return a.jsxs("div",w({ref:n},m,{className:[t,r||""].filter(Boolean).join(" "),style:w({display:"flex",flexWrap:"wrap",position:"relative"},p),children:[h&&A.isValidElement(h)&&h,l&&Array.isArray(l)&&l.map((C,v)=>{var g="",f="";typeof C=="string"&&(g=C,f=C),typeof C=="object"&&C.color&&(g=C.title||C.color,f=C.color);var b=c&&c.toLocaleLowerCase()===f.toLocaleLowerCase(),S=d&&d({title:g,color:f,checked:!!b,style:w({},u,{background:f}),onClick:_=>y(f,_)});if(S)return a.jsx(x.Fragment,{children:S},v);var k=o.children&&A.isValidElement(o.children)?A.cloneElement(o.children,{color:f,checked:b}):null;return a.jsx("div",w({tabIndex:0,title:g,onClick:_=>y(f,_)},o,{children:k,style:w({},u,{background:f})}),v)}),i&&A.isValidElement(i)&&i]}))});xe.displayName="Swatch";var jr={marginRight:0,marginBottom:0,borderRadius:0,boxSizing:"border-box",height:25,width:25};function _r(e){var{style:n,title:t,checked:r,color:c,onClick:l,rectProps:p}=e,o=x.useRef(null),s=x.useCallback(()=>{o.current.style.zIndex="2",o.current.style.outline="#fff solid 2px",o.current.style.boxShadow="rgb(0 0 0 / 25%) 0 0 5px 2px"},[]),i=x.useCallback(()=>{r||(o.current.style.zIndex="0",o.current.style.outline="initial",o.current.style.boxShadow="initial")},[r]),h=r?{zIndex:1,outline:"#fff solid 2px",boxShadow:"rgb(0 0 0 / 25%) 0 0 5px 2px"}:{zIndex:0};return a.jsx("div",w({ref:o,title:t},p,{onClick:l,onMouseEnter:s,onMouseLeave:i,style:w({},n,{marginRight:0,marginBottom:0,borderRadius:0,boxSizing:"border-box",height:25,width:25},jr,h,p==null?void 0:p.style)}))}var Sr=["prefixCls","placement","className","style","color","colors","rectProps","onChange","rectRender"],kr=["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],P=function(e){return e.Left="L",e.LeftTop="LT",e.LeftBottom="LB",e.Right="R",e.RightTop="RT",e.RightBottom="RB",e.Top="T",e.TopRight="TR",e.TopLeft="TL",e.Bottom="B",e.BottomLeft="BL",e.BottomRight="BR",e}({}),Je=A.forwardRef((e,n)=>{var{prefixCls:t="w-color-github",placement:r=P.TopRight,className:c,style:l,color:p,colors:o=kr,rectProps:s={},onChange:i,rectRender:h}=e,d=D(e,Sr),m=typeof p=="string"&&oe(p)?G(p):p,u=p?ie(m):"",y=S=>i&&i(F(S)),C=w({"--github-border":"1px solid rgba(0, 0, 0, 0.2)","--github-background-color":"#fff","--github-box-shadow":"rgb(0 0 0 / 15%) 0px 3px 12px","--github-arrow-border-color":"rgba(0, 0, 0, 0.15)",width:200,borderRadius:4,background:"var(--github-background-color)",boxShadow:"var(--github-box-shadow)",border:"var(--github-border)",position:"relative",padding:5},l),v={borderStyle:"solid",position:"absolute"},g=w({},v),f=w({},v);/^T/.test(r)&&(g.borderWidth="0 8px 8px",g.borderColor="transparent transparent var(--github-arrow-border-color)",f.borderWidth="0 7px 7px",f.borderColor="transparent transparent var(--github-background-color)"),r===P.TopRight&&(g.top=-8,f.top=-7),r===P.Top&&(g.top=-8,f.top=-7),r===P.TopLeft&&(g.top=-8,f.top=-7),/^B/.test(r)&&(g.borderWidth="8px 8px 0",g.borderColor="var(--github-arrow-border-color) transparent transparent",f.borderWidth="7px 7px 0",f.borderColor="var(--github-background-color) transparent transparent",r===P.BottomRight&&(g.top="100%",f.top="100%"),r===P.Bottom&&(g.top="100%",f.top="100%"),r===P.BottomLeft&&(g.top="100%",f.top="100%")),/^(B|T)/.test(r)&&((r===P.Top||r===P.Bottom)&&(g.left="50%",g.marginLeft=-8,f.left="50%",f.marginLeft=-7),(r===P.TopRight||r===P.BottomRight)&&(g.right=10,f.right=11),(r===P.TopLeft||r===P.BottomLeft)&&(g.left=7,f.left=8)),/^L/.test(r)&&(g.borderWidth="8px 8px 8px 0",g.borderColor="transparent var(--github-arrow-border-color) transparent transparent",f.borderWidth="7px 7px 7px 0",f.borderColor="transparent var(--github-background-color) transparent transparent",g.left=-8,f.left=-7),/^R/.test(r)&&(g.borderWidth="8px 0 8px 8px",g.borderColor="transparent transparent transparent var(--github-arrow-border-color)",f.borderWidth="7px 0 7px 7px",f.borderColor="transparent transparent transparent var(--github-background-color)",g.right=-8,f.right=-7),/^(L|R)/.test(r)&&((r===P.RightTop||r===P.LeftTop)&&(g.top=5,f.top=6),(r===P.Left||r===P.Right)&&(g.top="50%",f.top="50%",g.marginTop=-8,f.marginTop=-7),(r===P.LeftBottom||r===P.RightBottom)&&(g.top="100%",f.top="100%",g.marginTop=-21,f.marginTop=-20));var b=S=>{var k=w({},(Ge(S),S)),_=h&&h(w({},k));return _||a.jsx(_r,w({},k,{rectProps:s}))};return a.jsx(xe,w({ref:n,className:[t,c].filter(Boolean).join(" "),colors:o,color:u,rectRender:b},d,{onChange:y,style:C,rectProps:{style:{marginRight:0,marginBottom:0,borderRadius:0,height:25,width:25}},addonBefore:a.jsxs(x.Fragment,{children:[a.jsx("div",{style:g}),a.jsx("div",{style:f})]})}))});Je.displayName="Github";function Pe(e){var n=x.useRef(e);return x.useEffect(()=>{n.current=e}),x.useCallback((t,r)=>n.current&&n.current(t,r),[])}var Y=e=>"touches"in e,Ne=e=>{!Y(e)&&e.preventDefault&&e.preventDefault()},Ae=function(n,t,r){return t===void 0&&(t=0),r===void 0&&(r=1),n>r?r:n<t?t:n},Le=(e,n)=>{var t=e.getBoundingClientRect(),r=Y(n)?n.touches[0]:n;return{left:Ae((r.pageX-(t.left+window.pageXOffset))/t.width),top:Ae((r.pageY-(t.top+window.pageYOffset))/t.height),width:t.width,height:t.height,x:r.pageX-(t.left+window.pageXOffset),y:r.pageY-(t.top+window.pageYOffset)}},Er=["prefixCls","className","onMove","onDown"],we=A.forwardRef((e,n)=>{var{prefixCls:t="w-color-interactive",className:r,onMove:c,onDown:l}=e,p=D(e,Er),o=x.useRef(null),s=x.useRef(!1),[i,h]=x.useState(!1),d=Pe(c),m=Pe(l),u=f=>s.current&&!Y(f)?!1:(s.current=Y(f),!0),y=x.useCallback(f=>{Ne(f);var b=Y(f)?f.touches.length>0:f.buttons>0;b&&o.current?d&&d(Le(o.current,f),f):h(!1)},[d]),C=x.useCallback(()=>h(!1),[]),v=x.useCallback(f=>{var b=f?window.addEventListener:window.removeEventListener;b(s.current?"touchmove":"mousemove",y),b(s.current?"touchend":"mouseup",C)},[]);x.useEffect(()=>(v(i),()=>{i&&v(!1)}),[i,v]);var g=x.useCallback(f=>{Ne(f.nativeEvent),u(f.nativeEvent)&&(m&&m(Le(o.current,f.nativeEvent),f.nativeEvent),h(!0))},[m]);return a.jsx("div",w({},p,{className:[t,r||""].filter(Boolean).join(" "),style:w({},p.style,{touchAction:"none"}),ref:o,tabIndex:0,onMouseDown:g,onTouchStart:g}))});we.displayName="Interactive";var Br=e=>{var{className:n,color:t,left:r,top:c,prefixCls:l}=e,p={position:"absolute",top:c,left:r},o={"--saturation-pointer-box-shadow":"rgb(255 255 255) 0px 0px 0px 1.5px, rgb(0 0 0 / 30%) 0px 0px 1px 1px inset, rgb(0 0 0 / 40%) 0px 0px 1px 2px",width:6,height:6,transform:"translate(-3px, -3px)",boxShadow:"var(--saturation-pointer-box-shadow)",borderRadius:"50%",backgroundColor:t};return x.useMemo(()=>a.jsx("div",{className:l+"-pointer "+(n||""),style:p,children:a.jsx("div",{className:l+"-fill",style:o})}),[c,r,t,n,l])},Tr=["prefixCls","radius","pointer","className","hue","style","hsva","onChange"],et=A.forwardRef((e,n)=>{var t,{prefixCls:r="w-color-saturation",radius:c=0,pointer:l,className:p,hue:o=0,style:s,hsva:i,onChange:h}=e,d=D(e,Tr),m=w({width:200,height:200,borderRadius:c},s,{position:"relative"}),u=(C,v)=>{h&&i&&h({h:i.h,s:C.left*100,v:(1-C.top)*100,a:i.a})},y=x.useMemo(()=>{if(!i)return null;var C={top:100-i.v+"%",left:i.s+"%",color:Ze(i)};return l&&typeof l=="function"?l(w({prefixCls:r},C)):a.jsx(Br,w({prefixCls:r},C))},[i,l,r]);return a.jsx(we,w({className:[r,p||""].filter(Boolean).join(" ")},d,{style:w({position:"absolute",inset:0,cursor:"crosshair",backgroundImage:"linear-gradient(0deg, #000, transparent), linear-gradient(90deg, #fff, hsl("+((t=i==null?void 0:i.h)!=null?t:o)+", 100%, 50%))"},m),ref:n,onMove:u,onDown:u,children:y}))});et.displayName="Saturation";var Rr=["className","prefixCls","left","top","style","fillProps"],Mr=e=>{var{className:n,prefixCls:t,left:r,top:c,style:l,fillProps:p}=e,o=D(e,Rr),s=w({},l,{position:"absolute",left:r,top:c}),i=w({width:18,height:18,boxShadow:"var(--alpha-pointer-box-shadow)",borderRadius:"50%",backgroundColor:"var(--alpha-pointer-background-color)"},p==null?void 0:p.style,{transform:r?"translate(-9px, -1px)":"translate(-1px, -9px)"});return a.jsx("div",w({className:t+"-pointer "+(n||""),style:s},o,{children:a.jsx("div",w({className:t+"-fill"},p,{style:i}))}))},Pr=["prefixCls","className","hsva","background","bgProps","innerProps","pointerProps","radius","width","height","direction","style","onChange","pointer"],Nr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVQ4T2NkYGAQYcAP3uCTZhw1gGGYhAGBZIA/nYDCgBDAm9BGDWAAJyRCgLaBCAAgXwixzAS0pgAAAABJRU5ErkJggg==",se=A.forwardRef((e,n)=>{var{prefixCls:t="w-color-alpha",className:r,hsva:c,background:l,bgProps:p={},innerProps:o={},pointerProps:s={},radius:i=0,width:h,height:d=16,direction:m="horizontal",style:u,onChange:y,pointer:C}=e,v=D(e,Pr),g=E=>{y&&y(w({},c,{a:m==="horizontal"?E.left:E.top}),E)},f=Ze(Object.assign({},c,{a:1})),b="linear-gradient(to "+(m==="horizontal"?"right":"bottom")+", rgba(244, 67, 54, 0) 0%, "+f+" 100%)",S={};m==="horizontal"?S.left=c.a*100+"%":S.top=c.a*100+"%";var k=w({"--alpha-background-color":"#fff","--alpha-pointer-background-color":"rgb(248, 248, 248)","--alpha-pointer-box-shadow":"rgb(0 0 0 / 37%) 0px 1px 4px 0px",borderRadius:i,background:"url("+Nr+") left center",backgroundColor:"var(--alpha-background-color)"},{width:h,height:d},u,{position:"relative"}),_=C&&typeof C=="function"?C(w({prefixCls:t},s,S)):a.jsx(Mr,w({},s,{prefixCls:t},S));return a.jsxs("div",w({},v,{className:[t,t+"-"+m,r||""].filter(Boolean).join(" "),style:k,ref:n,children:[a.jsx("div",w({},p,{style:w({inset:0,position:"absolute",background:l||b,borderRadius:i},p.style)})),a.jsx(we,w({},o,{style:w({},o.style,{inset:0,zIndex:1,position:"absolute"}),onMove:g,onDown:g,children:_}))]}))});se.displayName="Alpha";var Ar=["prefixCls","className","hue","onChange","direction"],tt=A.forwardRef((e,n)=>{var{prefixCls:t="w-color-hue",className:r,hue:c=0,onChange:l,direction:p="horizontal"}=e,o=D(e,Ar);return a.jsx(se,w({ref:n,className:t+" "+(r||"")},o,{direction:p,background:"linear-gradient(to "+(p==="horizontal"?"right":"bottom")+", rgb(255, 0, 0) 0%, rgb(255, 255, 0) 17%, rgb(0, 255, 0) 33%, rgb(0, 255, 255) 50%, rgb(0, 0, 255) 67%, rgb(255, 0, 255) 83%, rgb(255, 0, 0) 100%)",hsva:{h:c,s:100,v:100,a:c/360},onChange:(s,i)=>{l&&l({h:p==="horizontal"?360*i.left:360*i.top})}}))});tt.displayName="Hue";var Lr=["prefixCls","placement","label","value","className","style","labelStyle","inputStyle","onChange","onBlur"],Or=e=>/^#?([A-Fa-f0-9]{3,4}){1,2}$/.test(e),Dr=e=>Number(String(e).replace(/%/g,"")),$=A.forwardRef((e,n)=>{var{prefixCls:t="w-color-editable-input",placement:r="bottom",label:c,value:l,className:p,style:o,labelStyle:s,inputStyle:i,onChange:h,onBlur:d}=e,m=D(e,Lr),[u,y]=x.useState(l),C=x.useRef(!1);x.useEffect(()=>{e.value!==u&&(C.current||y(e.value))},[e.value]);function v(k,_){var E=(_||k.target.value).trim().replace(/^#/,"");Or(E)&&h&&h(k,E);var R=Dr(E);isNaN(R)||h&&h(k,R),y(E)}function g(k){C.current=!1,y(e.value),d&&d(k)}var f={};r==="bottom"&&(f.flexDirection="column"),r==="top"&&(f.flexDirection="column-reverse"),r==="left"&&(f.flexDirection="row-reverse");var b=w({"--editable-input-label-color":"rgb(153, 153, 153)","--editable-input-box-shadow":"rgb(204 204 204) 0px 0px 0px 1px inset","--editable-input-color":"#666",position:"relative",alignItems:"center",display:"flex",fontSize:11},f,o),S=w({width:"100%",paddingTop:2,paddingBottom:2,paddingLeft:3,paddingRight:3,fontSize:11,background:"transparent",boxSizing:"border-box",border:"none",color:"var(--editable-input-color)",boxShadow:"var(--editable-input-box-shadow)"},i);return a.jsxs("div",{className:[t,p||""].filter(Boolean).join(" "),style:b,children:[a.jsx("input",w({ref:n,value:u,onChange:v,onBlur:g,autoComplete:"off",onFocus:()=>C.current=!0},m,{style:S})),c&&a.jsx("span",{style:w({color:"var(--editable-input-label-color)",textTransform:"capitalize"},s),children:c})]})});$.displayName="EditableInput";var zr=["prefixCls","hsva","placement","rProps","gProps","bProps","aProps","className","style","onChange"],Ce=A.forwardRef((e,n)=>{var{prefixCls:t="w-color-editable-input-rgba",hsva:r,placement:c="bottom",rProps:l={},gProps:p={},bProps:o={},aProps:s={},className:i,style:h,onChange:d}=e,m=D(e,zr),u=r?K(r):{};function y(v){var g=Number(v.target.value);g&&g>255&&(v.target.value="255"),g&&g<0&&(v.target.value="0")}var C=(v,g,f)=>{typeof v=="number"&&(g==="a"&&(v<0&&(v=0),v>100&&(v=100),d&&d(F(X(w({},u,{a:v/100}))))),v>255&&(v=255,f.target.value="255"),v<0&&(v=0,f.target.value="0"),g==="r"&&d&&d(F(X(w({},u,{r:v})))),g==="g"&&d&&d(F(X(w({},u,{g:v})))),g==="b"&&d&&d(F(X(w({},u,{b:v})))))};return a.jsxs("div",w({ref:n,className:[t,i||""].filter(Boolean).join(" ")},m,{style:w({fontSize:11,display:"flex"},h),children:[a.jsx($,w({label:"R",value:u.r||0,onBlur:y,placement:c,onChange:(v,g)=>C(g,"r",v)},l,{style:w({},l.style)})),a.jsx($,w({label:"G",value:u.g||0,onBlur:y,placement:c,onChange:(v,g)=>C(g,"g",v)},p,{style:w({marginLeft:5},l.style)})),a.jsx($,w({label:"B",value:u.b||0,onBlur:y,placement:c,onChange:(v,g)=>C(g,"b",v)},o,{style:w({marginLeft:5},o.style)})),s&&a.jsx($,w({label:"A",value:u.a?parseInt(String(u.a*100),10):0,onBlur:y,placement:c,onChange:(v,g)=>C(g,"a",v)},s,{style:w({marginLeft:5},s.style)}))]}))});Ce.displayName="EditableInputRGBA";var Fr=["prefixCls","hsva","hProps","sProps","lProps","aProps","className","onChange"],rt=A.forwardRef((e,n)=>{var{prefixCls:t="w-color-editable-input-hsla",hsva:r,hProps:c={},sProps:l={},lProps:p={},aProps:o={},className:s,onChange:i}=e,h=D(e,Fr),d=r?be(r):{h:0,s:0,l:0,a:0},m=(u,y,C)=>{typeof u=="number"&&(y==="h"&&(u<0&&(u=0),u>360&&(u=360),i&&i(F(ee(w({},d,{h:u}))))),y==="s"&&(u<0&&(u=0),u>100&&(u=100),i&&i(F(ee(w({},d,{s:u}))))),y==="l"&&(u<0&&(u=0),u>100&&(u=100),i&&i(F(ee(w({},d,{l:u}))))),y==="a"&&(u<0&&(u=0),u>1&&(u=1),i&&i(F(ee(w({},d,{a:u}))))))};return a.jsx(Ce,w({ref:n,hsva:r,rProps:w({label:"H",value:Math.round(d.h)},c,{onChange:(u,y)=>m(y,"h")}),gProps:w({label:"S",value:Math.round(d.s)+"%"},l,{onChange:(u,y)=>m(y,"s")}),bProps:w({label:"L",value:Math.round(d.l)+"%"},p,{onChange:(u,y)=>m(y,"l")}),aProps:w({label:"A",value:Math.round(d.a*100)/100},o,{onChange:(u,y)=>m(y,"a")}),className:[t,s||""].filter(Boolean).join(" ")},h))});rt.displayName="EditableInputHSLA";var Ir=["style"];function Hr(e){var{style:n}=e,t=D(e,Ir),r=x.useRef(null),c=x.useCallback(()=>{r.current.style.backgroundColor="var(--chrome-arrow-background-color)"},[]),l=x.useCallback(()=>{r.current.style.backgroundColor="transparent"},[]);return a.jsx("div",w({ref:r,style:w({marginLeft:5,cursor:"pointer",transition:"background-color .3s",borderRadius:2},n)},t,{onMouseEnter:c,onMouseLeave:l,children:a.jsx("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24",style:{display:"block"},children:a.jsx("path",{d:"M373.888 576h276.224c9.322667 0 14.293333 11.178667 9.173333 18.773333l-1.258666 1.557334-138.112 146.858666a10.709333 10.709333 0 0 1-14.293334 1.365334l-1.536-1.365334-138.112-146.858666c-6.592-6.997333-2.666667-18.645333 5.973334-20.16l1.941333-0.170667h276.224-276.224z m146.026667-295.189333l138.112 146.858666c7.04 7.509333 2.069333 20.330667-7.914667 20.330667H373.888c-9.984 0-14.976-12.821333-7.914667-20.330667l138.112-146.858666a10.730667 10.730667 0 0 1 15.829334 0z",fill:"var(--chrome-arrow-fill)"})})}))}var qr=["prefixCls","className","style","color","inputType","rectProps","onChange"],I=function(e){return e.HEXA="hexa",e.RGBA="rgba",e.HSLA="hsla",e}({}),at=A.forwardRef((e,n)=>{var{prefixCls:t="w-color-chrome",className:r,style:c,color:l,inputType:p=I.RGBA,rectProps:o={},onChange:s}=e,i=D(e,qr),h=typeof l=="string"&&oe(l)?G(l):l||{h:0,s:0,l:0,a:0},d=b=>s&&s(F(b)),[m,u]=x.useState(p),y=()=>{m===I.RGBA&&u(I.HSLA),m===I.HSLA&&u(I.HEXA),m===I.HEXA&&u(I.RGBA)},C={paddingTop:6},v={textAlign:"center",paddingTop:4,paddingBottom:4},g=w({"--chrome-arrow-fill":"#333","--chrome-arrow-background-color":"#e8e8e8",borderRadius:0,flexDirection:"column",width:230,padding:0},c),f={"--chrome-alpha-box-shadow":"rgb(0 0 0 / 25%) 0px 0px 1px inset",borderRadius:"50%",background:tr(h),boxShadow:"var(--chrome-alpha-box-shadow)"};return a.jsx(Je,w({ref:n,color:h,style:g,colors:void 0,className:[t,r].filter(Boolean).join(" "),placement:P.TopLeft},i,{addonAfter:a.jsxs(x.Fragment,{children:[a.jsx(et,{hsva:h,style:{width:"100%",height:130},onChange:b=>{d(w({},h,b,{a:h.a}))}}),a.jsxs("div",{style:{padding:15,display:"flex",alignItems:"center"},children:[a.jsx(se,{width:24,height:24,hsva:h,radius:2,style:{marginRight:15,borderRadius:"50%"},bgProps:{style:{background:"transparent"}},innerProps:{style:f},pointer:()=>a.jsx(x.Fragment,{})}),a.jsxs("div",{style:{flex:1},children:[a.jsx(tt,{hue:h.h,style:{width:"100%"},bgProps:{style:{borderRadius:2}},onChange:b=>{d(w({},h,b))}}),a.jsx(se,{hsva:h,style:{marginTop:10},bgProps:{style:{borderRadius:2}},onChange:b=>{d(w({},h,b))}})]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",padding:"0 15px 15px 15px",userSelect:"none"},children:[a.jsxs("div",{style:{flex:1},children:[m==I.RGBA&&a.jsx(Ce,{hsva:h,rProps:{labelStyle:C,inputStyle:v},gProps:{labelStyle:C,inputStyle:v},bProps:{labelStyle:C,inputStyle:v},aProps:{labelStyle:C,inputStyle:v},onChange:b=>d(b.hsva)}),m===I.HEXA&&a.jsx($,{label:"HEX",labelStyle:C,inputStyle:v,value:h.a>0&&h.a<1?sr(h).toLocaleUpperCase():ie(h).toLocaleUpperCase(),onChange:(b,S)=>{typeof S=="string"&&d(G(/^#/.test(S)?S:"#"+S))}}),m===I.HSLA&&a.jsx(rt,{hsva:h,hProps:{labelStyle:C,inputStyle:v},sProps:{labelStyle:C,inputStyle:v},lProps:{labelStyle:C,inputStyle:v},aProps:{labelStyle:C,inputStyle:v},onChange:b=>d(b.hsva)})]}),a.jsx(Hr,{onClick:y})]})]}),rectRender:()=>a.jsx(x.Fragment,{})}))});at.displayName="Chrome";function Ur(e){var{style:n,title:t,checked:r,color:c,onClick:l,rectProps:p}=e,o=x.useRef(null),s=x.useCallback(()=>{o.current.style.transform="scale(1.2)"},[]),i=x.useCallback(()=>{o.current.style.transform="scale(1)"},[]),h=w({"--circle-point-background-color":"#fff",height:r?"100%":0,width:r?"100%":0,borderRadius:"50%",backgroundColor:"var(--circle-point-background-color)",boxSizing:"border-box",transition:"height 100ms ease 0s, width 100ms ease 0s"},p.style);return a.jsx("div",{ref:o,onClick:l,onMouseEnter:s,onMouseLeave:i,title:t,style:w({},n,{display:"flex",alignItems:"center",justifyContent:"center",width:28,height:28,padding:3,borderRadius:"50%",marginRight:12,marginBottom:12,boxSizing:"border-box",transform:"scale(1)",boxShadow:c+" 0px 0px "+(r?5:0)+"px",transition:"transform 100ms ease 0s, box-shadow 100ms ease 0s"}),children:a.jsx("div",w({},p,{style:h}))})}var Vr=["prefixCls","className","color","colors","rectProps","onChange"],st=A.forwardRef((e,n)=>{var{prefixCls:t="w-color-circle",className:r,color:c,colors:l=[],rectProps:p={},onChange:o}=e,s=D(e,Vr),i=typeof c=="string"&&oe(c)?G(c):c||{},h=c?ie(i):"";return a.jsx(xe,w({ref:n,colors:l,color:h},s,{className:[t,r].filter(Boolean).join(" "),rectRender:d=>{var m=w({},(Ge(d),d));return a.jsx(Ur,w({},m,{rectProps:p}))},onChange:d=>{o&&o(F(d))}}))});st.displayName="Circle";const Gr=["#28282880","#58585880","#D8D8D880","#F8F8F880","#AB464280","#DC965680","#F7CA8880","#A1B56C80","#86C1B980","#7CAFC280","#BA8BAF80","#A1694680"],re=x.forwardRef(function({hex:n,swatches:t=Gr,alpha:r=!0,onChange:c,popoverProps:l,parentPopupState:p,...o},s){var h;const i=te({parentPopupState:p,variant:"popover",popupId:"color-picker"});return a.jsxs(a.Fragment,{children:[a.jsx(L,{...o,...mr(i),ref:s,variant:"outlined",size:"small",style:{backgroundColor:n,...o.style}}),a.jsxs(ve,{anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...l,slotProps:{paper:{...(h=l==null?void 0:l.slotProps)==null?void 0:h.paper,className:"border border-gray-300 rounded-none bg-transparent overflow-visible"}},...Qe(i),children:[a.jsx(at,{className:"[&>:first-child]:!hidden [&>:nth-child(2)]:!hidden [&>:last-child_span]:!hidden",style:{border:"none",boxShadow:"none"},color:n,inputType:I.HEXA,onChange:d=>{c(r?d.hexa:d.hex,d)}}),a.jsx(st,{className:"pl-[12px] justify-between bg-white [&>*]:!w-[24px] [&>*]:!h-[24px]",style:{width:230},colors:t,color:n,onChange:d=>{c(r?d.hexa:d.hex,d)}})]})]})}),Wr=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"m4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8l-8 8z"})}),Oe=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"M2 4h20v16H2z"})}),$r=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16a8.002 8.002 0 0 1 7.6-5.5c1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"})}),Zr=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88c3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"})}),Xr=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"M16 13h-3V3h-2v10H8l4 4l4-4zM4 19v2h16v-2H4z"})}),Yr=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"M8 11h3v10h2V11h3l-4-4l-4 4zM4 3v2h16V3H4z"})}),Kr=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"M21.02 5H19V2.98c0-.54-.44-.98-.98-.98h-.03c-.55 0-.99.44-.99.98V5h-2.01c-.54 0-.98.44-.99.98v.03c0 .55.44.99.99.99H17v2.01c0 .54.44.99.99.98h.03c.54 0 .98-.44.98-.98V7h2.02c.54 0 .98-.44.98-.98v-.04c0-.54-.44-.98-.98-.98zM16 9.01V8h-1.01c-.53 0-1.03-.21-1.41-.58c-.37-.38-.58-.88-.58-1.44c0-.36.1-.69.27-.98H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8.28c-.3.17-.64.28-1.02.28A2 2 0 0 1 16 9.01zM15.96 19H6a.5.5 0 0 1-.4-.8l1.98-2.63c.21-.28.62-.26.82.02L10 18l2.61-3.48c.2-.26.59-.27.79-.01l2.95 3.68c.26.33.03.81-.39.81z"})}),Qr=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"m13.775 22l-3.625-7.8L6 20V2l14 11h-7.1l3.6 7.725L13.775 22Z"})}),Jr=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"M7 21q-.825 0-1.413-.588T5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.588 1.413T17 21H7Zm2-4h2V8H9v9Zm4 0h2V8h-2v9Z"})}),ea=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"M9 16q-2.925 0-4.963-2.038T2 9q0-2.925 2.038-4.963T9 2q2.925 0 4.963 2.038T16 9q0 2.925-2.038 4.963T9 16Zm-1 4v-2.05q.25.025.5.038T9 18q3.75 0 6.375-2.625T18 9q0-.25-.013-.5T17.95 8H20q.825 0 1.413.588T22 10v10q0 .825-.588 1.413T20 22H10q-.825 0-1.413-.588T8 20Z"})}),De=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"M1 21h22L12 2"})}),ta=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsxs("g",{fill:"none",children:[a.jsx("path",{fill:"currentColor",d:"m5.505 11.41l.53.53l-.53-.53ZM3 14.952h-.75H3ZM9.048 21v.75V21ZM11.41 5.505l-.53-.53l.53.53Zm1.831 12.34a.75.75 0 0 0 1.06-1.061l-1.06 1.06ZM7.216 9.697a.75.75 0 1 0-1.06 1.061l1.06-1.06Zm10.749 2.362l-5.905 5.905l1.06 1.06l5.905-5.904l-1.06-1.06Zm-11.93-.12l5.905-5.905l-1.06-1.06l-5.905 5.904l1.06 1.06Zm0 6.025c-.85-.85-1.433-1.436-1.812-1.933c-.367-.481-.473-.79-.473-1.08h-1.5c0 .749.312 1.375.78 1.99c.455.596 1.125 1.263 1.945 2.083l1.06-1.06Zm-1.06-7.086c-.82.82-1.49 1.488-1.945 2.084c-.468.614-.78 1.24-.78 1.99h1.5c0-.29.106-.6.473-1.08c.38-.498.962-1.083 1.812-1.933l-1.06-1.06Zm7.085 7.086c-.85.85-1.435 1.433-1.933 1.813c-.48.366-.79.472-1.08.472v1.5c.75 0 1.376-.312 1.99-.78c.596-.455 1.264-1.125 2.084-1.945l-1.06-1.06Zm-7.085 1.06c.82.82 1.487 1.49 2.084 1.945c.614.468 1.24.78 1.989.78v-1.5c-.29 0-.599-.106-1.08-.473c-.497-.38-1.083-.962-1.933-1.812l-1.06 1.06Zm12.99-12.99c.85.85 1.433 1.436 1.813 1.933c.366.481.472.79.472 1.08h1.5c0-.749-.312-1.375-.78-1.99c-.455-.596-1.125-1.263-1.945-2.083l-1.06 1.06Zm1.06 7.086c.82-.82 1.49-1.488 1.945-2.084c.468-.614.78-1.24.78-1.99h-1.5c0 .29-.106.6-.473 1.08c-.38.498-.962 1.083-1.812 1.933l1.06 1.06Zm0-8.146c-.82-.82-1.487-1.49-2.084-1.945c-.614-.468-1.24-.78-1.989-.78v1.5c.29 0 .599.106 1.08.473c.497.38 1.083.962 1.933 1.812l1.06-1.06Zm-7.085 1.06c.85-.85 1.435-1.433 1.933-1.812c.48-.367.79-.473 1.08-.473v-1.5c-.75 0-1.376.312-1.99.78c-.596.455-1.264 1.125-2.084 1.945l1.06 1.06Zm2.362 10.749L7.216 9.698l-1.06 1.061l7.085 7.085l1.06-1.06Z"}),a.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:1.5,d:"M9 21h12"})]})}),ra={tool:"draw",pencilColor:"#356be1ff",brushSize:20,shape:"ellipse",shapeColor:"#356be1ff",backgroundColor:"#ffffffff",canUndo:!1,canRedo:!1},[le,aa]=We(ra);le.displayName="LCMRealtimeCanvasContext";const[ye,sa]=We({editorRef:{current:void 0}}),ae=["#282828","#585858","#D8D8D8","#F8F8F8","#AB4642","#DC9656","#F7CA88","#A1B56C","#86C1B9","#7CAFC2","#BA8BAF","#A16946"],ze={circle:{radius:65,fill:"#F7CA88",left:50,top:50},triangle:{width:200,height:215,fill:"#282828",left:250,top:200}},na=({editorRef:e,onImageChange:n,loading:t})=>{const[r,c]=x.useContext(le),[,l]=x.useContext(ye),{t:p}=U(["generation","action","common"]),o=x.useRef(null),s=x.useRef(null),i=x.useRef(),[h,d]=x.useState(null),{pencilColor:m,brushSize:u,shape:y,shapeColor:C,backgroundColor:v,tool:g}=r,f=x.useRef(v),b=async(R=!1)=>{var q;if(!n)return;if(R){if(f.current===v)return;f.current=v}const B=(q=i.current)==null?void 0:q.toCanvas();if(!B)return;const T=document.createElement("canvas");T.width=B.width,T.height=B.height;const z=T.getContext("2d");z.fillStyle=v,z.fillRect(0,0,B.width,B.height),z.drawImage(B,0,0),T.toBlob(ce=>{n==null||n(ce)})},[,S]=vt(async()=>{i.current&&(i.current.dispose(),i.current=void 0,l({editorRef:{current:void 0}}));const R=o.current;if(!R)return;const B=s.current;if(!B)return;const T=new wr(R,B);if(i.current=T,await T.init({width:512,height:512,baseImage:r.baseImage}),T.setMode(g),T.setPencilColor(m),T.setBrushSize(u),T.setShape(y),T.setShapeColor(C),T.setBackgroundColor(v),T.on("editModeChange",z=>c(q=>({...q,mode:z}))),T.on("stateChange",()=>{c(z=>({...z,canRedo:T.canRedo(),canUndo:T.canUndo()})),b()}),T.canvas.on("selection:created",()=>d(T==null?void 0:T.canvas.getActiveObject())),T.canvas.on("selection:updated",()=>d(T==null?void 0:T.canvas.getActiveObject())),T.canvas.on("selection:cleared",()=>d(null)),d(T==null?void 0:T.canvas.getActiveObject()),!r.baseImage){const z=new j.fabric.Triangle(ze.triangle),q=new j.fabric.Circle(ze.circle);T.canvas.add(z,q),T.setDrawGroup(z),T.setDrawGroup(q)}b()},[r.baseImage,g,m,u,y,C,v]);x.useEffect(()=>(S(),l({editorRef:i}),()=>{i.current&&(i.current.dispose(),i.current=void 0,l({editorRef:{current:void 0}}))}),[r.baseImage]),x.useEffect(()=>{if(!s.current)return;const R=new ResizeObserver(()=>{var B;(B=i.current)==null||B.setSize(512,512)});return R.observe(s.current),()=>R.disconnect()},[]);const k=i.current,_=h?(h instanceof j.fabric.ActiveSelection?h.getObjects():[h]).reduce((R,B)=>{if("_element"in B)return R;const T=B.get("fill")||B.get("stroke");return typeof T!="string"?R:R?T===R?T:"#000":T},null):null,E=R=>{if(h){for(const B of h instanceof j.fabric.ActiveSelection?h.getObjects():[h])"_element"in B||(B.get("fill")?B.set("fill",R):B.get("stroke")&&B.set("stroke",R));k==null||k.canvas.requestRenderAll(),k==null||k.recordHistory()}};return ge(()=>b(!0),100,[v]),x.useImperativeHandle(e,()=>k,[k]),a.jsxs("div",{className:O("flex focus:outline-none relative w-full max-h-full sm:[&>.canvas-container]:ml-auto bg-neutral-100 dark:bg-neutral-700"),ref:s,tabIndex:1e3,children:[a.jsx("canvas",{ref:o,className:"h-full w-full"}),h&&a.jsx("div",{className:"absolute bottom-2 left-0 right-0 grid place-items-center pointer-events-none",children:a.jsxs($e,{variant:"outlined",className:"bg-background pointer-events-auto",children:[a.jsx(N,{title:p("generation:image-edit.bring-forward"),children:a.jsx(L,{className:"px-0",onClick:()=>{h.bringForward(),k==null||k.recordHistory()},children:a.jsx(Wr,{className:"size-6"})})}),a.jsx(N,{title:p("generation:image-edit.send-backward"),children:a.jsx(L,{className:"px-0",onClick:()=>{h.sendBackwards(),k==null||k.recordHistory()},children:a.jsx(Ht,{className:"size-6"})})}),a.jsx(N,{title:p("generation:image-edit.bring-to-front"),children:a.jsx(L,{className:"px-0",onClick:()=>{h.bringToFront(),k==null||k.recordHistory()},children:a.jsx(Yr,{className:"size-6"})})}),a.jsx(N,{title:p("generation:image-edit.send-to-back"),children:a.jsx(L,{className:"px-0",onClick:()=>{h.sendToBack(),k==null||k.recordHistory()},children:a.jsx(Xr,{className:"size-6"})})}),_&&a.jsx(N,{title:p("generation:image-edit.selection-color"),children:a.jsx(re,{className:"min-w-0 w-10",swatches:ae,hex:_,onChange:R=>E(R),popoverProps:{anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"}}})}),a.jsx(N,{title:p("generation:image-edit.clone"),children:a.jsx(L,{className:"px-0",onClick:()=>k==null?void 0:k.cloneSelection(),children:a.jsx(mt,{className:"size-6"})})}),a.jsx(N,{title:p("generation:image-edit.delete"),children:a.jsx(L,{className:"px-0",onClick:()=>k==null?void 0:k.deleteSelection(),children:a.jsx(Gt,{className:"size-6"})})})]})}),t&&a.jsx("div",{className:"bg-background absolute inset-0 flex justify-center items-center",children:a.jsx(bt,{})})]})};function ia(e){const n=x.useRef(null),[t,r]=x.useContext(le),[c,l]=x.useContext(ye),{editorRef:p}=c,o=p.current,{pencilColor:s,brushSize:i,shape:h,shapeColor:d,backgroundColor:m,tool:u,canRedo:y,canUndo:C}=t,{t:v}=U(["generation","action","common"]),g=te({variant:"popover",popupId:"lcm-popover-draw"}),f=te({variant:"popover",popupId:"lcm-popover-erase"}),b=te({variant:"popover",popupId:"lcm-popover-shape"}),S={draw:{icon:a.jsx(Jt,{className:O("size-6","stroke-background-secondary")}),color:s,popupState:g,popover:a.jsxs("div",{className:"flex flex-col gap-4 w-[240px] px-6 py-4",children:[a.jsx("div",{children:a.jsx(fe,{value:i,onChange:_=>{r(E=>({...E,brushSize:_})),o==null||o.setBrushSize(_)}})}),a.jsxs("div",{className:"flex justify-between items-center w-full",children:[a.jsx("div",{className:"text-sm text-primary-light",children:v("generation:image-edit.brush-color")}),a.jsx(re,{className:"w-20 h-8",parentPopupState:g,swatches:ae,hex:s,onChange:_=>{r(E=>({...E,pencilColor:_})),o==null||o.setPencilColor(_)}})]})]})},erase:{icon:a.jsx(ta,{className:"size-6"}),popupState:f,popover:a.jsx("div",{className:"w-[240px] px-6 py-4",children:a.jsx(fe,{value:i,onChange:_=>{r(E=>({...E,brushSize:_})),o==null||o.setBrushSize(_)}})})},select:{icon:a.jsx(Qr,{className:"w-6 h-6"})},shape:{icon:h==="ellipse"?a.jsx(Ee,{className:"stroke-background-secondary size-6"}):h==="rect"?a.jsx(Oe,{className:"stroke-background-secondary size-6"}):h==="triangle"?a.jsx(De,{className:"stroke-background-secondary size-6"}):a.jsx(ea,{className:"stroke-background-secondary size-6"}),color:d,popupState:b,popover:a.jsxs("div",{className:"flex flex-col gap-4 w-[240px] px-6 py-4",children:[a.jsxs("div",{className:"flex justify-between items-center w-full",children:[a.jsx("div",{className:"text-sm text-primary-light",children:v("generation:image-edit.shape-color")}),a.jsx(re,{className:"w-20 h-8",parentPopupState:b,swatches:ae,hex:d,onChange:_=>{r(E=>({...E,shapeColor:_})),o==null||o.setShapeColor(_)}})]}),a.jsxs("div",{className:"flex justify-between items-center w-full",children:[a.jsx("div",{className:"text-sm text-primary-light",children:v("generation:image-edit.shapes.label")}),a.jsxs(_e,{size:"small",exclusive:!0,value:h,onChange:(_,E)=>{E&&(r(R=>({...R,shape:E})),o==null||o.setShape(E))},children:[a.jsx(J,{value:"ellipse",children:a.jsx(N,{title:v("generation:image-edit.shapes.ellipse"),children:a.jsx(Ee,{className:"size-6"})})}),a.jsx(J,{value:"rect",children:a.jsx(N,{title:v("generation:image-edit.shapes.rectangle"),children:a.jsx(Oe,{className:"size-6"})})}),a.jsx(J,{value:"triangle",children:a.jsx(N,{title:v("generation:image-edit.shapes.triangle"),children:a.jsx("div",{children:a.jsx(De,{className:"size-6"})})})})]})]})]})}},k=()=>{const _=n.current;_&&_.click()};return a.jsxs(a.Fragment,{children:[a.jsx(_e,{size:"small",exclusive:!0,orientation:e.orientation,value:u,onChange:(_,E)=>{E&&(r(R=>({...R,tool:E})),o==null||o.setMode(E))},children:Object.entries(S).flatMap(([_,E],R)=>{if(!E)return null;const B=a.jsx(J,{...E.popupState?br(E.popupState):{},value:_,style:{backgroundColor:u===_?E.color:void 0},className:"dark:bg-neutral-600 dark:hover:bg-neutral-500",children:a.jsx(N,{title:v(`generation:image-edit.${_}`),arrow:!0,placement:"right",children:a.jsx("div",{children:E.icon})})},_);if(E.popover){const T=a.jsx(pr,{...E.popupState&&u===_?Qe(E.popupState):{open:!1},keepMounted:!0,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},children:E.popover},`${_}-popover`);return R===0?[B,T]:[T,B]}return[B]})}),a.jsx(L,{variant:"outlined",onClick:k,className:"px-0 min-w-10 dark:bg-neutral-600 dark:hover:bg-neutral-500",children:a.jsx(N,{title:v("generation:image-edit.upload-image"),arrow:!0,placement:"right",children:a.jsx(Kr,{className:"size-[28px]"})})}),a.jsxs($e,{orientation:e.orientation,variant:"outlined",children:[a.jsx(L,{className:"px-0 dark:bg-neutral-600 dark:hover:bg-neutral-500",disabled:!C,onClick:()=>o==null?void 0:o.undo(),children:a.jsx(N,{title:v("generation:image-edit.undo"),arrow:!0,placement:"right",children:a.jsx(Zr,{className:"size-[28px]"})})}),a.jsx(L,{className:"px-0 dark:bg-neutral-600 dark:hover:bg-neutral-500",disabled:!y,onClick:()=>o==null?void 0:o.redo(),children:a.jsx(N,{title:v("generation:image-edit.redo"),arrow:!0,placement:"right",children:a.jsx($r,{className:"size-[28px]"})})}),a.jsx(L,{className:"px-0 dark:bg-neutral-600 dark:hover:bg-neutral-500",onClick:async()=>{try{await qe({title:v("generation:image-edit.clear-confirm.title"),description:v("generation:image-edit.clear-confirm.content")})}catch{return}o==null||o.clearDrawings(),o==null||o.resetHistory(),o==null||o.canvas.discardActiveObject(),r(_=>({..._,baseImage:void 0}))},children:a.jsx(N,{title:v("generation:image-edit.clear"),arrow:!0,placement:"right",children:a.jsx(Jr,{className:"size-[28px]"})})})]}),a.jsx(N,{title:v("generation:image-edit.background-color"),arrow:!0,placement:"right",children:a.jsx(re,{className:"flex-shrink-0 min-w-0 w-10 h-10",swatches:ae,hex:m,alpha:!1,onChange:_=>{r(E=>({...E,backgroundColor:_})),o==null||o.setBackgroundColor(_)}})}),a.jsx("input",{ref:n,type:"file",accept:"image/*",hidden:!0,onChange:async _=>{const[E]=_.target.files||[];if(!E||!o)return;const R=await o.addDrawImage(ne.fromFile(E));o.selectObject(R),_.target.value=""}})]})}const Fe=e=>e.status==="completed"||e.status==="failed",pe=async(e,n)=>{if(n){const{task:t}=await me.getTaskById({id:e});return t&&Fe(t)?t:(await ke(3e3),pe(e,n))}if(xt()){const t=wt.pipe(Se(r=>r.id===e),Se(r=>Fe(r)));return Qt(t)}return await ke(3e3),pe(e,!0)},oa=async e=>{const{createGenerationTask:n}=await me.createGenerationTask({parameters:e});if(n!=null&&n.id)return pe(n.id)},je=Ct.create({baseURL:"https://inference.pixai.art/lcm/v1"});je.interceptors.request.use(e=>{const n=yt();return n&&e.headers.set("Authorization",`Bearer ${n}`),e});function la(e,n){const t={prompt:e.prompts,negative_prompt:e.negativePrompts,seed:e.seed,strength:e.strength,image:e.image,user_id:e.userId};return je.postForm("/img2img",t,{...n})}function Aa(e,n){const t={prompt:e.prompts,image:e.image,negative_prompt:e.negativePrompts,seed:e.seed,num_outputs:e.numOutputs,height:e.height,width:e.width,user_id:e.userId};return je.postForm("/pose2image",t,{...n})}const ca=e=>a.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e,children:a.jsx("path",{fill:"currentColor",d:"m10 19l-2.5-5.5L2 11l5.5-2.5L10 3l2.5 5.5L18 11l-5.5 2.5L10 19Zm8 2l-1.25-2.75L14 17l2.75-1.25L18 13l1.25 2.75L22 17l-2.75 1.25L18 21Z"})}),da=3;function Ie(){return Math.floor(Math.random()*1e10)}const ha=()=>{const[e,n]=x.useState(()=>Ie()),t=x.useCallback(()=>{n(Ie())},[]);return[e,t]},ua="worst quality, low quality, jpeg artifacts, blurry, monochrome, extra digits, bad anatomy",fa="masterpiece, best quality, 1girl, moon in the sky, dark skirt, umbrella",pa=.65,La=()=>{const e=x.useMemo(()=>a.jsx(a.Fragment,{children:a.jsx(sa,{children:a.jsx(aa,{children:a.jsx(ga,{})})})}),[]);return a.jsx(Wt,{scene:"realtime",headerSlot:a.jsx(Xt,{value:$t.Realtime}),main:a.jsx("div",{className:"px-3 msm:pl-[72px] lg:pr-[72px] mlg:overflow-y-auto",children:e})})};function ga(){const{data:e,isValidating:n}=Ue(),[t,r]=x.useState(pa),[c,l]=x.useState(fa),[p,o]=x.useState(ua),[s,i]=ha(),h=x.useRef(null),[d,m]=x.useState(null),[u,y]=x.useState(),C=Ft(u),v=x.useRef(null),[g,f]=x.useState("idle"),[b,S]=jt("generator::lcm-anonymous-generated-times",0),k=x.useRef({open:()=>{},close:()=>{}}),_=_t("sm"),E=x.useCallback(async()=>{if(!d||!c){f("idle");return}try{v.current&&v.current.abort();const R=new AbortController;v.current=R,f("rendering"),V("lcm_inference_start",{prompts:c,negativePrompts:p,strength:t,seed:s},{destinations:["getway"]});const z=`data:image/webp;base64,${(await la({prompts:c,negativePrompts:p,seed:s,strength:t.toString(),image:d,userId:e==null?void 0:e.id},{signal:R.signal})).data.data[0].b64_image}`,q=await Mt(z),ce=new File([q],`pixai-realtime_${Date.now()}.webp`,{type:"image/webp"});y(ne.fromFile(ce)),e!=null&&e.id||S(nt=>nt+1)}catch(R){if(R.name==="CanceledError")return;he.error("Something went wrong: "+R);return}finally{f("idle"),v.current=null}},[d,c,p,t,s,e==null?void 0:e.id]);return ge(E,500,[d,c,p,t,s,e==null?void 0:e.id]),x.useEffect(()=>{c&&f("debouncing")},[d,c,p,t,s]),x.useEffect(()=>{!(e!=null&&e.id)&&b>da&&k.current.open(),e!=null&&e.id&&k.current.close()},[b,e==null?void 0:e.id,n]),a.jsxs(a.Fragment,{children:[a.jsxs("section",{className:"w-full flex flex-wrap gap-2 msm:pb-3 pt-4",children:[a.jsx("div",{className:"rounded-t-xl grow",children:a.jsx(lr,{value:c,onChange:R=>l(R.target.value)})}),a.jsxs("div",{className:"px-2 flex gap-4 basis-[480px] grow md:grow-0 self-start md:pt-2",children:[a.jsx(dr,{value:t,onChange:(R,B)=>{typeof B=="number"&&B>=.25&&r(B)}}),a.jsx("div",{className:"ml-auto shrink-0",children:a.jsx(cr,{value:s,onClick:()=>{i(),V("lcm_regenerate_seed",void 0,{destinations:["getway"]})}})})]}),a.jsx("div",{className:"msm:fixed w-full msm:w-auto left-1 top-[132px] p-2 rounded-t-md msm:rounded-b-md",children:a.jsx("div",{className:"flex msm:flex-col gap-2 overflow-x-auto max-w-[calc(100vw-40px)]",children:a.jsx(ia,{orientation:_?"horizontal":"vertical"})})})]}),a.jsxs("div",{className:"flex flex-col msm:flex-row w-[calc(100vw-24px)] sm:w-full sm:h-[calc(100vh-48px-84px-114px)] items-start",children:[a.jsx("div",{className:O("min-w-0 w-full max-h-full","border border-gray-300 dark:border-gray-500 aspect-1 grow-1 basis-1/2 flex"),children:a.jsx(na,{editorRef:h,onImageChange:m})}),a.jsxs("div",{className:"w-full max-h-full aspect-1 grow-1 basis-1/2 relative flex",children:[a.jsxs("div",{className:"border bg-neutral-100 dark:bg-neutral-700 border-gray-300 dark:border-gray-500 w-full flex",children:[C?a.jsx(qt,{scene:"lcm-realtime",imgClassName:O("w-auto h-full object-contain sm:object-[0%_center]"),fileName:u.name,originalUrl:C,thumbnailUrl:C,width:512,height:512,pswpOptions:{initialZoomLevel:1.5,showHideAnimationType:"fade"}}):g==="idle"?a.jsx("div",{className:"w-full h-full bg-neutral-100 dark:bg-neutral-700"}):a.jsx("div",{className:O("bg-contain bg-no-repeat bg-center sm:bg-[0%_center] bg-neutral-100 h-full w-full",g==="rendering"&&"animate-pulse")}),C&&a.jsx(va,{className:"absolute bottom-0 right-0 justify-end",output:u,setOutput:y,parameters:{prompts:c,strength:t,seed:s}})]}),a.jsx(hr,{status:g})]})]}),a.jsx(St,{ref:k,disableClose:!0})]})}const He={negativePrompts:"worst quality, large head, low quality, extra digits, bad eye,  EasyNegativeV2,  ng_deepnegative_v1_75t",samplingSteps:20,samplingMethod:"DPM++ 2M Karras",cfgScale:6,width:512,height:512,clipSkip:2,modelId:"1648918127446573124",mediaId:"STUB",strength:.55,upscale:1.5,enableTile:!1,controlNets:[]};function va(e){const{data:n}=Ue(),{t}=U(["generation"]),{output:r,setOutput:c,parameters:l}=e,[,p]=x.useContext(le),[o]=x.useContext(ye),s=x.useCallback(async()=>{V("lcm_use_base_click");try{if(await qe({title:t("generation:image-edit.clear-confirm.title"),description:t("generation:image-edit.clear-confirm.content")}),V("lcm_use_base_confirm_click"),o.editorRef.current&&r)p(f=>({...f,baseImage:r}));else throw new Error("Editor not found")}catch(g){if(g===kt)return;he.error(g.message);return}},[r]),i=x.useCallback(()=>{r&&(V("lcm_download",{...l},{destinations:["getway"]}),It(r,g=>Pt(g,r.name)))},[r,l]),{value:h}=Et(async()=>{if(!r)return;const g=await r.getDimensions();return zt({...g,maxEdge:768})},[r]),{data:d,isValidating:m}=Zt({...He,...h}),u=async()=>{if(!r)return"no output image";if(!h)return"failed to get dimensions";const g=await r.toMedia({onCompressed(S){c(S)}});if(!g)return"failed to upload media";const f=await oa({...He,...h,prompts:l==null?void 0:l.prompts,mediaId:g.id});if(!(f!=null&&f.id))return"failed to create task";if(!f.outputs.mediaId)return"no output media id";const{media:b}=await me.getMedia({id:f.outputs.mediaId});if(!b)return"failed to get output media";c(ne.fromMedia(b))},[y,C]=x.useState(!1),v=async()=>{if(!y){if(!n)return Rt(null,{fromPath:"lcm_enhance"});V("lcm_enhance_click");try{C(!0);const g=await u();if(g)throw new Error(g)}catch(g){g instanceof Error&&he.error(g.message)}finally{C(!1)}V("lcm_enhance_success")}};return a.jsxs("section",{className:O("flex flex-wrap items-center gap-4 p-2",e.className),children:[a.jsxs(de,{className:O("p-2 text-black rounded-lg bg-gray-100 rounded-tl-lg hover:bg-gray-200 font-semibold text-xs","transition-colors duration-200 ease-in-out shadow"),onClick:s,children:[a.jsx(Ut,{className:"mr-2"}),t("generation:image-operation.use-base-image")]}),a.jsxs(de,{className:O("p-2 text-black bg-gray-100  rounded-lg bg-gray-10 hover:bg-gray-200 font-semibold text-xs","transition-colors duration-200 ease-in-out shadow"),onClick:i,children:[a.jsx(Vt,{className:"mr-2"}),t("generation:image-operation.download-image")]}),a.jsxs(de,{className:O("flex",y?"text-black/60 cursor-default":"text-black","p-2 bg-gray-100  rounded-lg bg-gray-10 hover:bg-gray-200 font-semibold text-xs","transition-colors duration-200 ease-in-out shadow"),onClick:v,children:[y?a.jsx("span",{className:"pr-2 flex items-center",children:a.jsx(Bt,{size:"12px"})}):a.jsx(ca,{className:"mr-2"}),t("generation:image-operation.enhance.label"),n&&a.jsx(Tt,{className:"pl-2",children:a.jsx(Yt,{value:(d==null?void 0:d.actualPrice)??0,loading:m,className:"!text-inherit font-normal text-xs",iconClassName:"hidden"})})]})]})}export{Na as B,re as C,hr as L,wr as N,Zr as a,$r as b,La as c,Ie as g,ie as h,Jt as i,Aa as p};
//# sourceMappingURL=LCMRealtime-CnTFsb2j.js.map
