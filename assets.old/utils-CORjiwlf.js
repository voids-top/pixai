import{i as l}from"./artwork-D9vxumxJ.js";import{c as u}from"./imageUtil-NFh1c57i.js";import{eb as w,ec as g,dp as p}from"./index-BTMYyhc6.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="5246c3f9-5dc0-43d6-88c4-2f4d0d1b2f7c",e._sentryDebugIdIdentifier="sentry-dbid-5246c3f9-5dc0-43d6-88c4-2f4d0d1b2f7c")}catch{}})();{var d=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};d._sentryModuleMetadata=d._sentryModuleMetadata||{},d._sentryModuleMetadata[new Error().stack]=Object.assign({},d._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:pixai-web-app-key":!0})}async function v(e,n=new Image){return new Promise((t,r)=>{n.onload=()=>t(n),n.onerror=r,n.src=e})}async function b(e){return(await fetch(e,{method:"GET"})).blob()}async function x(e){const n=await b(e);return URL.createObjectURL(n)}async function E(e){const t=await(await fetch(e)).blob();return new Promise((r,i)=>{try{const o=new FileReader;o.onload=function(){r(this.result)},o.readAsDataURL(t)}catch(o){i(o)}})}async function T(e,n,t){var s;const i=await(await fetch(e,{method:"GET"})).blob();let o=n,a="";if(!(t!=null&&t.skipConversion)&&n.endsWith(".webp")){o=n.replace(".webp",".png");const f=await h(i,o);if(!f)throw new Error("conversion error: file is invalid");a=URL.createObjectURL(f)}else a=URL.createObjectURL(new Blob([i]));const c=document.createElement("a");c.href=a,c.setAttribute("download",`${o}`),document.body.appendChild(c),c.click(),(s=c.parentNode)==null||s.removeChild(c)}async function h(e,n){const t=new Image,r=()=>new Promise((i,o)=>{t.onload=()=>i(t),t.onerror=o,t.src=URL.createObjectURL(e)});try{const i=await r();let o;if(typeof window.OffscreenCanvas=="function"){o=new OffscreenCanvas(i.width,i.height);const a=o.getContext("2d");if(!a)throw new Error("ctx not initialized");a.drawImage(i,0,0,i.width,i.height)}else{o=document.createElement("canvas");const a=o.getContext("2d");if(o.width=i.width,o.height=i.height,!a)throw new Error("ctx not initialized");a.drawImage(i,0,0,i.width,i.height)}return u(o,n)}catch(i){console.log("cannot download image: ",i)}}function A(e){if(e)return`AI art ${e.title} generated for keywords ${e.prompts}`}function D({artwork:e,task:n,mediaIdx:t}){return e?`pixai-${e.id}${e.title?"-"+e.title:""}`:n?t!=null?`pixai-${n.id}-${t}`:`pixai-${n.id}`:"pixai-image"}function R({task:e,artwork:n,media:t}){var r;return w(e)||n!=null&&n.videoMediaId?"mp4":g(e)||l(n)?"webp":((t==null?void 0:t.imageType)??((r=e==null?void 0:e.media)==null?void 0:r.imageType))||"png"}function U(e){return p(location.href,{artworkId:e,openDetail:"true"})}export{D as a,R as b,h as c,T as d,U as e,E as f,A as g,x as h,b as i,v as l};
//# sourceMappingURL=utils-CORjiwlf.js.map
